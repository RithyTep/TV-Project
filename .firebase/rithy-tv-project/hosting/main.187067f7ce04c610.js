"use strict";(self.webpackChunkTV_Project=self.webpackChunkTV_Project||[]).push([[179],{2011:(Ft,Be,z)=>{z.d(Be,{Dh:()=>Le,GT:()=>ue,cc:()=>Ue,hO:()=>tt,on:()=>ee,pX:()=>ye,xv:()=>Ce});var h=z(4650),X=z(9260),V=z(4976);Ft=z.hmd(Ft);const de=["ngOnDestroy"],ye=(ze,qe,st,Ye={})=>new Proxy(ze,{get:(He,je)=>st.runOutsideAngular(()=>{var at;if(ze[je])return!(null===(at=Ye?.spy)||void 0===at)&&at.get&&Ye.spy.get(je,ze[je]),ze[je];if(de.indexOf(je)>-1)return()=>{};const Je=qe.toPromise().then(wt=>{const At=wt&&wt[je];return"function"==typeof At?At.bind(wt):At&&At.then?At.then(cn=>st.run(()=>cn)):st.run(()=>At)});return new Proxy(()=>{},{get:(wt,At)=>Je[At],apply:(wt,At,cn)=>Je.then(xt=>{var _n;const Rt=xt&&xt(...cn);return!(null===(_n=Ye?.spy)||void 0===_n)&&_n.apply&&Ye.spy.apply(je,cn,Rt),Rt})})})}),ue=(ze,qe)=>{qe.forEach(st=>{Object.getOwnPropertyNames(st.prototype||st).forEach(Ye=>{Object.defineProperty(ze.prototype,Ye,Object.getOwnPropertyDescriptor(st.prototype||st,Ye))})})};class Oe{constructor(qe){return qe}}const Le=new h.OlP("angularfire2.app.options"),Ce=new h.OlP("angularfire2.app.name");function ee(ze,qe,st){const He="object"==typeof st&&st||{};He.name=He.name||"string"==typeof st&&st||"[DEFAULT]";const at=X.Z.apps.filter(Je=>Je&&Je.name===He.name)[0]||qe.runOutsideAngular(()=>X.Z.initializeApp(ze,He));try{JSON.stringify(ze)!==JSON.stringify(at.options)&&J("error",`${at.name} Firebase App already initialized with different options${Ft.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch{}return new Oe(at)}const J=(ze,...qe)=>{(0,h.X6Q)()&&typeof console<"u"&&console[ze](...qe)},le={provide:Oe,useFactory:ee,deps:[Le,h.R0b,[new h.FiY,Ce]]};let tt=(()=>{class ze{constructor(st){X.Z.registerVersion("angularfire",V.q4.full,"core"),X.Z.registerVersion("angularfire",V.q4.full,"app-compat"),X.Z.registerVersion("angular",h.q4F.full,st.toString())}static initializeApp(st,Ye){return{ngModule:ze,providers:[{provide:Le,useValue:st},{provide:Ce,useValue:Ye}]}}}return ze.\u0275fac=function(st){return new(st||ze)(h.LFG(h.Lbi))},ze.\u0275mod=h.oAB({type:ze}),ze.\u0275inj=h.cJS({providers:[le]}),ze})();function Ue(ze,qe,st,Ye,He){const[,je,at]=globalThis.\u0275AngularfireInstanceCache.find(Je=>Je[0]===ze)||[];if(je)return function lt(ze,qe){try{return ze.toString()===qe.toString()}catch{return ze===qe}}(He,at)||(Se("error",`${qe} was already initialized on the ${st} Firebase App with different settings.${Et?" You may need to reload as Firebase is not HMR aware.":""}`),Se("warn",{is:He,was:at})),je;{const Je=Ye();return globalThis.\u0275AngularfireInstanceCache.push([ze,Je,He]),Je}}const Et=!!Ft.hot,Se=(ze,...qe)=>{(0,h.X6Q)()&&typeof console<"u"&&console[ze](...qe)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},4976:(Ft,Be,z)=>{z.d(Be,{q4:()=>Yi,iC:()=>Wu,HU:()=>nl,vb:()=>dh,JM:()=>Gc,u3:()=>wg});var h=z(4650),X=z(259),V=z(5861),de=z(6881),ye=z(2090),ue=z(4859),Oe=z(1877);const Le=(D,A)=>A.some(L=>D instanceof L);let Ce,ee;const tt=new WeakMap,Ue=new WeakMap,lt=new WeakMap,Et=new WeakMap,Se=new WeakMap;let st={get(D,A,L){if(D instanceof IDBTransaction){if("done"===A)return Ue.get(D);if("objectStoreNames"===A)return D.objectStoreNames||lt.get(D);if("store"===A)return L.objectStoreNames[1]?void 0:L.objectStore(L.objectStoreNames[0])}return at(D[A])},set:(D,A,L)=>(D[A]=L,!0),has:(D,A)=>D instanceof IDBTransaction&&("done"===A||"store"===A)||A in D};function je(D){return"function"==typeof D?function He(D){return D!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function le(){return ee||(ee=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(D)?function(...A){return D.apply(Je(this),A),at(tt.get(this))}:function(...A){return at(D.apply(Je(this),A))}:function(A,...L){const H=D.call(Je(this),A,...L);return lt.set(H,A.sort?A.sort():[A]),at(H)}}(D):(D instanceof IDBTransaction&&function qe(D){if(Ue.has(D))return;const A=new Promise((L,H)=>{const Q=()=>{D.removeEventListener("complete",ae),D.removeEventListener("error",ve),D.removeEventListener("abort",ve)},ae=()=>{L(),Q()},ve=()=>{H(D.error||new DOMException("AbortError","AbortError")),Q()};D.addEventListener("complete",ae),D.addEventListener("error",ve),D.addEventListener("abort",ve)});Ue.set(D,A)}(D),Le(D,function J(){return Ce||(Ce=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(D,st):D)}function at(D){if(D instanceof IDBRequest)return function ze(D){const A=new Promise((L,H)=>{const Q=()=>{D.removeEventListener("success",ae),D.removeEventListener("error",ve)},ae=()=>{L(at(D.result)),Q()},ve=()=>{H(D.error),Q()};D.addEventListener("success",ae),D.addEventListener("error",ve)});return A.then(L=>{L instanceof IDBCursor&&tt.set(L,D)}).catch(()=>{}),Se.set(A,D),A}(D);if(Et.has(D))return Et.get(D);const A=je(D);return A!==D&&(Et.set(D,A),Se.set(A,D)),A}const Je=D=>Se.get(D),cn=["get","getKey","getAll","getAllKeys","count"],xt=["put","add","delete","clear"],_n=new Map;function Rt(D,A){var L;if(!(D instanceof IDBDatabase)||A in D||"string"!=typeof A)return;if(_n.get(A))return _n.get(A);const H=A.replace(/FromIndex$/,""),Q=A!==H,ae=xt.includes(H);if(!(H in(Q?IDBIndex:IDBObjectStore).prototype)||!ae&&!cn.includes(H))return;const ve=function(et){return(L=L||(0,V.Z)(function*(ht,...St){const Pt=this.transaction(ht,ae?"readwrite":"readonly");let un=Pt.store;return Q&&(un=un.index(St.shift())),(yield Promise.all([un[H](...St),ae&&Pt.done]))[0]})).apply(this,arguments)};return _n.set(A,ve),ve}var ro,es,ts,Hs,_e,Ee,Ie,pe,it,Ze,jt,Dt,ci,Vt,Tn,si;!function Ye(D){st=D(st)}(D=>({...D,get:(A,L,H)=>Rt(A,L)||D.get(A,L,H),has:(A,L)=>!!Rt(A,L)||D.has(A,L)}));const Li="@firebase/installations",gi="0.6.4",Oi=1e4,tr=`w:${gi}`,bi="FIS_v2",Bt="https://firebaseinstallations.googleapis.com/v1",vs=36e5,Ii=new ye.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function ni(D){return D instanceof ye.ZR&&D.code.includes("request-failed")}function Mn({projectId:D}){return`${Bt}/projects/${D}/installations`}function Gt(D){return{token:D.token,requestStatus:2,expiresIn:mr(D.expiresIn),creationTime:Date.now()}}function zt(D,A){return(ro=ro||(0,V.Z)(function*(L,H){const ae=(yield H.json()).error;return Ii.create("request-failed",{requestName:L,serverCode:ae.code,serverMessage:ae.message,serverStatus:ae.status})})).apply(this,arguments)}function nr({apiKey:D}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":D})}function wi(D){return(es=es||(0,V.Z)(function*(A){const L=yield A();return L.status>=500&&L.status<600?A():L})).apply(this,arguments)}function mr(D){return Number(D.replace("s","000"))}function zn(D){return new Promise(A=>{setTimeout(A,D)})}const sn=/^[cdef][\w-]{21}$/,so="";function En(){try{const D=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(D),D[0]=112+D[0]%16;const L=function Or(D){return function di(D){return btoa(String.fromCharCode(...D)).replace(/\+/g,"-").replace(/\//g,"_")}(D).substr(0,22)}(D);return sn.test(L)?L:so}catch{return so}}function Wi(D){return`${D.appName}!${D.appId}`}const ir=new Map;function ns(D,A){const L=Wi(D);ws(L,A),function ne(D,A){const L=function $(){return!Z&&"BroadcastChannel"in self&&(Z=new BroadcastChannel("[Firebase] FID Change"),Z.onmessage=D=>{ws(D.data.key,D.data.fid)}),Z}();L&&L.postMessage({key:D,fid:A}),function j(){0===ir.size&&Z&&(Z.close(),Z=null)}()}(L,A)}function ws(D,A){const L=ir.get(D);if(L)for(const H of L)H(A)}let Z=null;const U="firebase-installations-database",ie=1,Re="firebase-installations-store";let ut=null;function tn(){return ut||(ut=function wt(D,A,{blocked:L,upgrade:H,blocking:Q,terminated:ae}={}){const ve=indexedDB.open(D,A),Ne=at(ve);return H&&ve.addEventListener("upgradeneeded",et=>{H(at(ve.result),et.oldVersion,et.newVersion,at(ve.transaction))}),L&&ve.addEventListener("blocked",()=>L()),Ne.then(et=>{ae&&et.addEventListener("close",()=>ae()),Q&&et.addEventListener("versionchange",()=>Q())}).catch(()=>{}),Ne}(U,ie,{upgrade:(D,A)=>{0===A&&D.createObjectStore(Re)}})),ut}function Yt(D,A){return(Hs=Hs||(0,V.Z)(function*(L,H){const Q=Wi(L),ve=(yield tn()).transaction(Re,"readwrite"),Ne=ve.objectStore(Re),et=yield Ne.get(Q);return yield Ne.put(H,Q),yield ve.done,(!et||et.fid!==H.fid)&&ns(L,H.fid),H})).apply(this,arguments)}function dn(D){return(_e=_e||(0,V.Z)(function*(A){const L=Wi(A),Q=(yield tn()).transaction(Re,"readwrite");yield Q.objectStore(Re).delete(L),yield Q.done})).apply(this,arguments)}function Ut(D,A){return(Ee=Ee||(0,V.Z)(function*(L,H){const Q=Wi(L),ve=(yield tn()).transaction(Re,"readwrite"),Ne=ve.objectStore(Re),et=yield Ne.get(Q),ht=H(et);return void 0===ht?yield Ne.delete(Q):yield Ne.put(ht,Q),yield ve.done,ht&&(!et||et.fid!==ht.fid)&&ns(L,ht.fid),ht})).apply(this,arguments)}function qn(D){return(Ie=Ie||(0,V.Z)(function*(A){let L;const H=yield Ut(A.appConfig,Q=>{const ae=function On(D){return Qe(D||{fid:En(),registrationStatus:0})}(Q),ve=function Hr(D,A){if(0===A.registrationStatus){if(!navigator.onLine)return{installationEntry:A,registrationPromise:Promise.reject(Ii.create("app-offline"))};const L={fid:A.fid,registrationStatus:1,registrationTime:Date.now()},H=function is(D,A){return(pe=pe||(0,V.Z)(function*(L,H){try{const Q=yield function oa(D,A){return(ts=ts||(0,V.Z)(function*({appConfig:L,heartbeatServiceProvider:H},{fid:Q}){const ae=Mn(L),ve=nr(L),Ne=H.getImmediate({optional:!0});if(Ne){const Pt=yield Ne.getHeartbeatsHeader();Pt&&ve.append("x-firebase-client",Pt)}const ht={method:"POST",headers:ve,body:JSON.stringify({fid:Q,authVersion:bi,appId:L.appId,sdkVersion:tr})},St=yield wi(()=>fetch(ae,ht));if(St.ok){const Pt=yield St.json();return{fid:Pt.fid||Q,registrationStatus:2,refreshToken:Pt.refreshToken,authToken:Gt(Pt.authToken)}}throw yield zt("Create Installation",St)})).apply(this,arguments)}(L,H);return Yt(L.appConfig,Q)}catch(Q){throw ni(Q)&&409===Q.customData.serverCode?yield dn(L.appConfig):yield Yt(L.appConfig,{fid:H.fid,registrationStatus:0}),Q}})).apply(this,arguments)}(D,L);return{installationEntry:L,registrationPromise:H}}return 1===A.registrationStatus?{installationEntry:A,registrationPromise:xe(D)}:{installationEntry:A}}(A,ae);return L=ve.registrationPromise,ve.installationEntry});return H.fid===so?{installationEntry:yield L}:{installationEntry:H,registrationPromise:L}})).apply(this,arguments)}function xe(D){return(it=it||(0,V.Z)(function*(A){let L=yield fe(A.appConfig);for(;1===L.registrationStatus;)yield zn(100),L=yield fe(A.appConfig);if(0===L.registrationStatus){const{installationEntry:H,registrationPromise:Q}=yield qn(A);return Q||H}return L})).apply(this,arguments)}function fe(D){return Ut(D,A=>{if(!A)throw Ii.create("installation-not-found");return Qe(A)})}function Qe(D){return function Tt(D){return 1===D.registrationStatus&&D.registrationTime+Oi<Date.now()}(D)?{fid:D.fid,registrationStatus:0}:D}function It(D,A){return(Ze=Ze||(0,V.Z)(function*({appConfig:L,heartbeatServiceProvider:H},Q){const ae=function $t(D,{fid:A}){return`${Mn(D)}/${A}/authTokens:generate`}(L,Q),ve=function ui(D,{refreshToken:A}){const L=nr(D);return L.append("Authorization",function zi(D){return`${bi} ${D}`}(A)),L}(L,Q),Ne=H.getImmediate({optional:!0});if(Ne){const Pt=yield Ne.getHeartbeatsHeader();Pt&&ve.append("x-firebase-client",Pt)}const ht={method:"POST",headers:ve,body:JSON.stringify({installation:{sdkVersion:tr,appId:L.appId}})},St=yield wi(()=>fetch(ae,ht));if(St.ok)return Gt(yield St.json());throw yield zt("Generate Auth Token",St)})).apply(this,arguments)}function Lt(D){return(jt=jt||(0,V.Z)(function*(A,L=!1){let H;const Q=yield Ut(A.appConfig,ve=>{if(!ei(ve))throw Ii.create("not-registered");const Ne=ve.authToken;if(!L&&function Pr(D){return 2===D.requestStatus&&!function oo(D){const A=Date.now();return A<D.creationTime||D.creationTime+D.expiresIn<A+vs}(D)}(Ne))return ve;if(1===Ne.requestStatus)return H=function Rn(D,A){return(Dt=Dt||(0,V.Z)(function*(L,H){let Q=yield kn(L.appConfig);for(;1===Q.authToken.requestStatus;)yield zn(100),Q=yield kn(L.appConfig);const ae=Q.authToken;return 0===ae.requestStatus?Lt(L,H):ae})).apply(this,arguments)}(A,L),ve;{if(!navigator.onLine)throw Ii.create("app-offline");const et=function $a(D){const A={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},D),{authToken:A})}(ve);return H=function Xe(D,A){return(ci=ci||(0,V.Z)(function*(L,H){try{const Q=yield It(L,H),ae=Object.assign(Object.assign({},H),{authToken:Q});return yield Yt(L.appConfig,ae),Q}catch(Q){if(!ni(Q)||401!==Q.customData.serverCode&&404!==Q.customData.serverCode){const ae=Object.assign(Object.assign({},H),{authToken:{requestStatus:0}});yield Yt(L.appConfig,ae)}else yield dn(L.appConfig);throw Q}})).apply(this,arguments)}(A,et),et}});return H?yield H:Q.authToken})).apply(this,arguments)}function kn(D){return Ut(D,A=>{if(!ei(A))throw Ii.create("not-registered");return function rs(D){return 1===D.requestStatus&&D.requestTime+Oi<Date.now()}(A.authToken)?Object.assign(Object.assign({},A),{authToken:{requestStatus:0}}):A})}function ei(D){return void 0!==D&&2===D.registrationStatus}function Es(D){return Ii.create("missing-app-config-values",{valueName:D})}const en="installations",la=D=>{const A=D.getProvider("app").getImmediate(),L=function oi(D){if(!D||!D.options)throw Es("App Configuration");if(!D.name)throw Es("App Name");const A=["projectId","apiKey","appId"];for(const L of A)if(!D.options[L])throw Es(L);return{appName:D.name,projectId:D.options.projectId,apiKey:D.options.apiKey,appId:D.options.appId}}(A);return{app:A,appConfig:L,heartbeatServiceProvider:(0,de._getProvider)(A,"heartbeat"),_delete:()=>Promise.resolve()}},Po=D=>{const A=D.getProvider("app").getImmediate(),L=(0,de._getProvider)(A,en).getImmediate();return{getId:()=>function vt(D){return(Vt=Vt||(0,V.Z)(function*(A){const L=A,{installationEntry:H,registrationPromise:Q}=yield qn(L);return Q?Q.catch(console.error):Lt(L).catch(console.error),H.fid})).apply(this,arguments)}(L),getToken:Q=>function yn(D){return(Tn=Tn||(0,V.Z)(function*(A,L=!1){const H=A;return yield function ii(D){return(si=si||(0,V.Z)(function*(A){const{registrationPromise:L}=yield qn(A);L&&(yield L)})).apply(this,arguments)}(H),(yield Lt(H,L)).token})).apply(this,arguments)}(L,Q)}};var js;(function Ha(){(0,de._registerComponent)(new ue.wA(en,la,"PUBLIC")),(0,de._registerComponent)(new ue.wA("installations-internal",Po,"PRIVATE"))})(),(0,de.registerVersion)(Li,gi),(0,de.registerVersion)(Li,gi,"esm2017");const ca="@firebase/remote-config",Ir=new ye.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class Cd{constructor(A,L,H,Q){this.client=A,this.storage=L,this.storageCache=H,this.logger=Q}isCachedDataFresh(A,L){if(!L)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const H=Date.now()-L,Q=H<=A;return this.logger.debug(`Config fetch cache check. Cache age millis: ${H}. Cache max age millis (minimumFetchIntervalMillis setting): ${A}. Is cache hit: ${Q}.`),Q}fetch(A){var L=this;return(0,V.Z)(function*(){const[H,Q]=yield Promise.all([L.storage.getLastSuccessfulFetchTimestampMillis(),L.storage.getLastSuccessfulFetchResponse()]);if(Q&&L.isCachedDataFresh(A.cacheMaxAgeMillis,H))return Q;A.eTag=Q&&Q.eTag;const ae=yield L.client.fetch(A),ve=[L.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===ae.status&&ve.push(L.storage.setLastSuccessfulFetchResponse(ae)),yield Promise.all(ve),ae})()}}function Dd(D=navigator){return D.languages&&D.languages[0]||D.language}class Yf{constructor(A,L,H,Q,ae,ve){this.firebaseInstallations=A,this.sdkVersion=L,this.namespace=H,this.projectId=Q,this.apiKey=ae,this.appId=ve}fetch(A){var L=this;return(0,V.Z)(function*(){const[H,Q]=yield Promise.all([L.firebaseInstallations.getId(),L.firebaseInstallations.getToken()]),ve=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${L.projectId}/namespaces/${L.namespace}:fetch?key=${L.apiKey}`,Ne={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":A.eTag||"*"},et={sdk_version:L.sdkVersion,app_instance_id:H,app_instance_id_token:Q,app_id:L.appId,language_code:Dd()},ht={method:"POST",headers:Ne,body:JSON.stringify(et)},St=fetch(ve,ht),Pt=new Promise((on,Fi)=>{A.signal.addEventListener(()=>{const wo=new Error("The operation was aborted.");wo.name="AbortError",Fi(wo)})});let un;try{yield Promise.race([St,Pt]),un=yield St}catch(on){let Fi="fetch-client-network";throw"AbortError"===on?.name&&(Fi="fetch-timeout"),Ir.create(Fi,{originalErrorMessage:on?.message})}let Nt=un.status;const Zn=un.headers.get("ETag")||void 0;let Dr,Ei;if(200===un.status){let on;try{on=yield un.json()}catch(Fi){throw Ir.create("fetch-client-parse",{originalErrorMessage:Fi?.message})}Dr=on.entries,Ei=on.state}if("INSTANCE_STATE_UNSPECIFIED"===Ei?Nt=500:"NO_CHANGE"===Ei?Nt=304:("NO_TEMPLATE"===Ei||"EMPTY_CONFIG"===Ei)&&(Dr={}),304!==Nt&&200!==Nt)throw Ir.create("fetch-status",{httpStatus:Nt});return{status:Nt,eTag:Zn,config:Dr}})()}}class bu{constructor(A,L){this.client=A,this.storage=L}fetch(A){var L=this;return(0,V.Z)(function*(){const H=(yield L.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return L.attemptFetch(A,H)})()}attemptFetch(A,{throttleEndTimeMillis:L,backoffCount:H}){var Q=this;return(0,V.Z)(function*(){yield function Zf(D,A){return new Promise((L,H)=>{const Q=Math.max(A-Date.now(),0),ae=setTimeout(L,Q);D.addEventListener(()=>{clearTimeout(ae),H(Ir.create("fetch-throttle",{throttleEndTimeMillis:A}))})})}(A.signal,L);try{const ae=yield Q.client.fetch(A);return yield Q.storage.deleteThrottleMetadata(),ae}catch(ae){if(!function _c(D){if(!(D instanceof ye.ZR&&D.customData))return!1;const A=Number(D.customData.httpStatus);return 429===A||500===A||503===A||504===A}(ae))throw ae;const ve={throttleEndTimeMillis:Date.now()+(0,ye.$s)(H),backoffCount:H+1};return yield Q.storage.setThrottleMetadata(ve),Q.attemptFetch(A,ve)}})()}}class Ad{constructor(A,L,H,Q,ae){this.app=A,this._client=L,this._storageCache=H,this._storage=Q,this._logger=ae,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function yc(D,A){const L=D.target.error||void 0;return Ir.create(A,{originalErrorMessage:L&&L?.message})}const Fo="app_namespace_store";class Xf{constructor(A,L,H,Q=function Qf(){return new Promise((D,A)=>{try{const L=indexedDB.open("firebase_remote_config",1);L.onerror=H=>{A(yc(H,"storage-open"))},L.onsuccess=H=>{D(H.target.result)},L.onupgradeneeded=H=>{0===H.oldVersion&&H.target.result.createObjectStore(Fo,{keyPath:"compositeKey"})}}catch(L){A(Ir.create("storage-open",{originalErrorMessage:L?.message}))}})}()){this.appId=A,this.appName=L,this.namespace=H,this.openDbPromise=Q}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(A){return this.set("last_fetch_status",A)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(A){return this.set("last_successful_fetch_timestamp_millis",A)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(A){return this.set("last_successful_fetch_response",A)}getActiveConfig(){return this.get("active_config")}setActiveConfig(A){return this.set("active_config",A)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(A){return this.set("active_config_etag",A)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(A){return this.set("throttle_metadata",A)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(A){var L=this;return(0,V.Z)(function*(){const H=yield L.openDbPromise;return new Promise((Q,ae)=>{const Ne=H.transaction([Fo],"readonly").objectStore(Fo),et=L.createCompositeKey(A);try{const ht=Ne.get(et);ht.onerror=St=>{ae(yc(St,"storage-get"))},ht.onsuccess=St=>{const Pt=St.target.result;Q(Pt?Pt.value:void 0)}}catch(ht){ae(Ir.create("storage-get",{originalErrorMessage:ht?.message}))}})})()}set(A,L){var H=this;return(0,V.Z)(function*(){const Q=yield H.openDbPromise;return new Promise((ae,ve)=>{const et=Q.transaction([Fo],"readwrite").objectStore(Fo),ht=H.createCompositeKey(A);try{const St=et.put({compositeKey:ht,value:L});St.onerror=Pt=>{ve(yc(Pt,"storage-set"))},St.onsuccess=()=>{ae()}}catch(St){ve(Ir.create("storage-set",{originalErrorMessage:St?.message}))}})})()}delete(A){var L=this;return(0,V.Z)(function*(){const H=yield L.openDbPromise;return new Promise((Q,ae)=>{const Ne=H.transaction([Fo],"readwrite").objectStore(Fo),et=L.createCompositeKey(A);try{const ht=Ne.delete(et);ht.onerror=St=>{ae(yc(St,"storage-delete"))},ht.onsuccess=()=>{Q()}}catch(ht){ae(Ir.create("storage-delete",{originalErrorMessage:ht?.message}))}})})()}createCompositeKey(A){return[this.appId,this.appName,this.namespace,A].join()}}class da{constructor(A){this.storage=A}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var A=this;return(0,V.Z)(function*(){const L=A.storage.getLastFetchStatus(),H=A.storage.getLastSuccessfulFetchTimestampMillis(),Q=A.storage.getActiveConfig(),ae=yield L;ae&&(A.lastFetchStatus=ae);const ve=yield H;ve&&(A.lastSuccessfulFetchTimestampMillis=ve);const Ne=yield Q;Ne&&(A.activeConfig=Ne)})()}setLastFetchStatus(A){return this.lastFetchStatus=A,this.storage.setLastFetchStatus(A)}setLastSuccessfulFetchTimestampMillis(A){return this.lastSuccessfulFetchTimestampMillis=A,this.storage.setLastSuccessfulFetchTimestampMillis(A)}setActiveConfig(A){return this.activeConfig=A,this.storage.setActiveConfig(A)}}function xu(){return(js=js||(0,V.Z)(function*(){if(!(0,ye.hl)())return!1;try{return yield(0,ye.eu)()}catch{return!1}})).apply(this,arguments)}!function Jf(){(0,de._registerComponent)(new ue.wA("remote-config",function D(A,{instanceIdentifier:L}){const H=A.getProvider("app").getImmediate(),Q=A.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Ir.create("registration-window");if(!(0,ye.hl)())throw Ir.create("indexed-db-unavailable");const{projectId:ae,apiKey:ve,appId:Ne}=H.options;if(!ae)throw Ir.create("registration-project-id");if(!ve)throw Ir.create("registration-api-key");if(!Ne)throw Ir.create("registration-app-id");const et=new Xf(Ne,H.name,L=L||"firebase"),ht=new da(et),St=new Oe.Yd(ca);St.logLevel=Oe.in.ERROR;const Pt=new Yf(Q,de.SDK_VERSION,L,ae,ve,Ne),un=new bu(Pt,et),Nt=new Cd(un,et,ht,St),Zn=new Ad(H,Nt,ht,et,St);return function os(D){const A=(0,ye.m9)(D);A._initializePromise||(A._initializePromise=A._storageCache.loadFromStorage().then(()=>{A._isInitializationComplete=!0}))}(Zn),Zn},"PUBLIC").setMultipleInstances(!0)),(0,de.registerVersion)(ca,"0.4.4"),(0,de.registerVersion)(ca,"0.4.4","esm2017")}();const em=(D,A)=>A.some(L=>D instanceof L);let Tl,vc;const Tu=new WeakMap,Ga=new WeakMap,Pi=new WeakMap,bc=new WeakMap,wc=new WeakMap;let za={get(D,A,L){if(D instanceof IDBTransaction){if("done"===A)return Ga.get(D);if("objectStoreNames"===A)return D.objectStoreNames||Pi.get(D);if("store"===A)return L.objectStoreNames[1]?void 0:L.objectStore(L.objectStoreNames[0])}return jr(D[A])},set:(D,A,L)=>(D[A]=L,!0),has:(D,A)=>D instanceof IDBTransaction&&("done"===A||"store"===A)||A in D};function Iu(D){return"function"==typeof D?function kd(D){return D!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function nm(){return vc||(vc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(D)?function(...A){return D.apply(sr(this),A),jr(Tu.get(this))}:function(...A){return jr(D.apply(sr(this),A))}:function(A,...L){const H=D.call(sr(this),A,...L);return Pi.set(H,A.sort?A.sort():[A]),jr(H)}}(D):(D instanceof IDBTransaction&&function Il(D){if(Ga.has(D))return;const A=new Promise((L,H)=>{const Q=()=>{D.removeEventListener("complete",ae),D.removeEventListener("error",ve),D.removeEventListener("abort",ve)},ae=()=>{L(),Q()},ve=()=>{H(D.error||new DOMException("AbortError","AbortError")),Q()};D.addEventListener("complete",ae),D.addEventListener("error",ve),D.addEventListener("abort",ve)});Ga.set(D,A)}(D),em(D,function tm(){return Tl||(Tl=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(D,za):D)}function jr(D){if(D instanceof IDBRequest)return function In(D){const A=new Promise((L,H)=>{const Q=()=>{D.removeEventListener("success",ae),D.removeEventListener("error",ve)},ae=()=>{L(jr(D.result)),Q()},ve=()=>{H(D.error),Q()};D.addEventListener("success",ae),D.addEventListener("error",ve)});return A.then(L=>{L instanceof IDBCursor&&Tu.set(L,D)}).catch(()=>{}),wc.set(A,D),A}(D);if(bc.has(D))return bc.get(D);const A=Iu(D);return A!==D&&(bc.set(D,A),wc.set(A,D)),A}const sr=D=>wc.get(D);function Md(D,A,{blocked:L,upgrade:H,blocking:Q,terminated:ae}={}){const ve=indexedDB.open(D,A),Ne=jr(ve);return H&&ve.addEventListener("upgradeneeded",et=>{H(jr(ve.result),et.oldVersion,et.newVersion,jr(ve.transaction))}),L&&ve.addEventListener("blocked",()=>L()),Ne.then(et=>{ae&&et.addEventListener("close",()=>ae()),Q&&et.addEventListener("versionchange",()=>Q())}).catch(()=>{}),Ne}function Cs(D,{blocked:A}={}){const L=indexedDB.deleteDatabase(D);return A&&L.addEventListener("blocked",()=>A()),jr(L).then(()=>{})}const Ld=["get","getKey","getAll","getAllKeys","count"],Bo=["put","add","delete","clear"],Ec=new Map;function Wa(D,A){var L;if(!(D instanceof IDBDatabase)||A in D||"string"!=typeof A)return;if(Ec.get(A))return Ec.get(A);const H=A.replace(/FromIndex$/,""),Q=A!==H,ae=Bo.includes(H);if(!(H in(Q?IDBIndex:IDBObjectStore).prototype)||!ae&&!Ld.includes(H))return;const ve=function(et){return(L=L||(0,V.Z)(function*(ht,...St){const Pt=this.transaction(ht,ae?"readwrite":"readonly");let un=Pt.store;return Q&&(un=un.index(St.shift())),(yield Promise.all([un[H](...St),ae&&Pt.done]))[0]})).apply(this,arguments)};return Ec.set(A,ve),ve}var nn,Su,Od,xc,Pd,Nd,Cu,Sl,Ws,De,fn,Fd,Bd,or,Ud,Cl,ar,Du,Au,Dl;!function gr(D){za=D(za)}(D=>({...D,get:(A,L,H)=>Wa(A,L)||D.get(A,L,H),has:(A,L)=>!!Wa(A,L)||D.has(A,L)}));const fi="/firebase-messaging-sw.js",_r="/firebase-cloud-messaging-push-scope",Ds="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Rl="https://fcmregistrations.googleapis.com/v1",co="google.c.a.c_id",Vd="google.c.a.c_l",Ru="google.c.a.ts",kl="google.c.a.e";var As=(()=>{return(D=As||(As={})).PUSH_RECEIVED="push-received",D.NOTIFICATION_CLICKED="notification-clicked",As;var D})();function as(D){const A=new Uint8Array(D);return btoa(String.fromCharCode(...A)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Tc(D){const L=(D+"=".repeat((4-D.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),H=atob(L),Q=new Uint8Array(H.length);for(let ae=0;ae<H.length;++ae)Q[ae]=H.charCodeAt(ae);return Q}const Cr="fcm_token_details_db",rm=5,$d="fcm_token_object_Store",jd="firebase-messaging-database",sm=1,uo="firebase-messaging-store";let ha=null;function Ic(){return ha||(ha=Md(jd,sm,{upgrade:(D,A)=>{0===A&&D.createObjectStore(uo)}})),ha}function Gd(D){return(Su=Su||(0,V.Z)(function*(A){const L=ai(A),Q=yield(yield Ic()).transaction(uo).objectStore(uo).get(L);if(Q)return Q;{const ae=yield function Ml(D){return(nn=nn||(0,V.Z)(function*(A){var L;if("databases"in indexedDB&&!(yield indexedDB.databases()).map(Ne=>Ne.name).includes(Cr))return null;let H=null;return(yield Md(Cr,rm,{upgrade:function(ve,Ne,et,ht){return(L=L||(0,V.Z)(function*(St,Pt,un,Nt){var Zn;if(Pt<2||!St.objectStoreNames.contains($d))return;const Dr=Nt.objectStore($d),Ei=yield Dr.index("fcmSenderId").get(A);if(yield Dr.clear(),Ei)if(2===Pt){const on=Ei;if(!on.auth||!on.p256dh||!on.endpoint)return;H={token:on.fcmToken,createTime:null!==(Zn=on.createTime)&&void 0!==Zn?Zn:Date.now(),subscriptionOptions:{auth:on.auth,p256dh:on.p256dh,endpoint:on.endpoint,swScope:on.swScope,vapidKey:"string"==typeof on.vapidKey?on.vapidKey:as(on.vapidKey)}}}else if(3===Pt){const on=Ei;H={token:on.fcmToken,createTime:on.createTime,subscriptionOptions:{auth:as(on.auth),p256dh:as(on.p256dh),endpoint:on.endpoint,swScope:on.swScope,vapidKey:as(on.vapidKey)}}}else if(4===Pt){const on=Ei;H={token:on.fcmToken,createTime:on.createTime,subscriptionOptions:{auth:as(on.auth),p256dh:as(on.p256dh),endpoint:on.endpoint,swScope:on.swScope,vapidKey:as(on.vapidKey)}}}})).apply(this,arguments)}})).close(),yield Cs(Cr),yield Cs("fcm_vapid_details_db"),yield Cs("undefined"),function Hd(D){if(!D||!D.subscriptionOptions)return!1;const{subscriptionOptions:A}=D;return"number"==typeof D.createTime&&D.createTime>0&&"string"==typeof D.token&&D.token.length>0&&"string"==typeof A.auth&&A.auth.length>0&&"string"==typeof A.p256dh&&A.p256dh.length>0&&"string"==typeof A.endpoint&&A.endpoint.length>0&&"string"==typeof A.swScope&&A.swScope.length>0&&"string"==typeof A.vapidKey&&A.vapidKey.length>0}(H)?H:null})).apply(this,arguments)}(A.appConfig.senderId);if(ae)return yield Si(A,ae),ae}})).apply(this,arguments)}function Si(D,A){return(Od=Od||(0,V.Z)(function*(L,H){const Q=ai(L),ve=(yield Ic()).transaction(uo,"readwrite");return yield ve.objectStore(uo).put(H,Q),yield ve.done,H})).apply(this,arguments)}function ai({appConfig:D}){return D.appId}const yr=new ye.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function Ll(D,A){return(Pd=Pd||(0,V.Z)(function*(L,H){const Q=yield Ol(L),ae=Sc(H),ve={method:"POST",headers:Q,body:JSON.stringify(ae)};let Ne;try{Ne=yield(yield fetch(fa(L.appConfig),ve)).json()}catch(et){throw yr.create("token-subscribe-failed",{errorInfo:et?.toString()})}if(Ne.error)throw yr.create("token-subscribe-failed",{errorInfo:Ne.error.message});if(!Ne.token)throw yr.create("token-subscribe-no-token");return Ne.token})).apply(this,arguments)}function ku(D,A){return(Cu=Cu||(0,V.Z)(function*(L,H){const ae={method:"DELETE",headers:yield Ol(L)};try{const Ne=yield(yield fetch(`${fa(L.appConfig)}/${H}`,ae)).json();if(Ne.error)throw yr.create("token-unsubscribe-failed",{errorInfo:Ne.error.message})}catch(ve){throw yr.create("token-unsubscribe-failed",{errorInfo:ve?.toString()})}})).apply(this,arguments)}function fa({projectId:D}){return`${Rl}/projects/${D}/registrations`}function Ol(D){return(Sl=Sl||(0,V.Z)(function*({appConfig:A,installations:L}){const H=yield L.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":A.apiKey,"x-goog-firebase-installations-auth":`FIS ${H}`})})).apply(this,arguments)}function Sc({p256dh:D,auth:A,endpoint:L,vapidKey:H}){const Q={web:{endpoint:L,auth:A,p256dh:D}};return H!==Ds&&(Q.web.applicationPubKey=H),Q}const Mu=6048e5;function Cc(D){return(Ws=Ws||(0,V.Z)(function*(A){const L=yield function Vo(D,A){return(Bd=Bd||(0,V.Z)(function*(L,H){return(yield L.pushManager.getSubscription())||L.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Tc(H)})})).apply(this,arguments)}(A.swRegistration,A.vapidKey),H={vapidKey:A.vapidKey,swScope:A.swRegistration.scope,endpoint:L.endpoint,auth:as(L.getKey("auth")),p256dh:as(L.getKey("p256dh"))},Q=yield Gd(A.firebaseDependencies);if(Q){if(function am(D,A){return A.vapidKey===D.vapidKey&&A.endpoint===D.endpoint&&A.auth===D.auth&&A.p256dh===D.p256dh}(Q.subscriptionOptions,H))return Date.now()>=Q.createTime+Mu?function Nl(D,A){return(fn=fn||(0,V.Z)(function*(L,H){try{const Q=yield function zd(D,A){return(Nd=Nd||(0,V.Z)(function*(L,H){const Q=yield Ol(L),ae=Sc(H.subscriptionOptions),ve={method:"PATCH",headers:Q,body:JSON.stringify(ae)};let Ne;try{Ne=yield(yield fetch(`${fa(L.appConfig)}/${H.token}`,ve)).json()}catch(et){throw yr.create("token-update-failed",{errorInfo:et?.toString()})}if(Ne.error)throw yr.create("token-update-failed",{errorInfo:Ne.error.message});if(!Ne.token)throw yr.create("token-update-no-token");return Ne.token})).apply(this,arguments)}(L.firebaseDependencies,H),ae=Object.assign(Object.assign({},H),{token:Q,createTime:Date.now()});return yield Si(L.firebaseDependencies,ae),Q}catch(Q){throw yield function Pl(D){return(De=De||(0,V.Z)(function*(A){const L=yield Gd(A.firebaseDependencies);L&&(yield ku(A.firebaseDependencies,L.token),yield function Uo(D){return(xc=xc||(0,V.Z)(function*(A){const L=ai(A),Q=(yield Ic()).transaction(uo,"readwrite");yield Q.objectStore(uo).delete(L),yield Q.done})).apply(this,arguments)}(A.firebaseDependencies));const H=yield A.swRegistration.pushManager.getSubscription();return!H||H.unsubscribe()})).apply(this,arguments)}(L),Q}})).apply(this,arguments)}(A,{token:Q.token,createTime:Date.now(),subscriptionOptions:H}):Q.token;try{yield ku(A.firebaseDependencies,Q.token)}catch(ae){console.warn(ae)}return ma(A.firebaseDependencies,H)}return ma(A.firebaseDependencies,H)})).apply(this,arguments)}function ma(D,A){return(Fd=Fd||(0,V.Z)(function*(L,H){const ae={token:yield Ll(L,H),createTime:Date.now(),subscriptionOptions:H};return yield Si(L,ae),ae.token})).apply(this,arguments)}function Wd(D){const A={from:D.from,collapseKey:D.collapse_key,messageId:D.fcmMessageId};return function Lu(D,A){if(!A.notification)return;D.notification={};const L=A.notification.title;L&&(D.notification.title=L);const H=A.notification.body;H&&(D.notification.body=H);const Q=A.notification.image;Q&&(D.notification.image=Q);const ae=A.notification.icon;ae&&(D.notification.icon=ae)}(A,D),function mg(D,A){A.data&&(D.data=A.data)}(A,D),function lm(D,A){var L,H,Q,ae,ve;if(!(A.fcmOptions||null!==(L=A.notification)&&void 0!==L&&L.click_action))return;D.fcmOptions={};const Ne=null!==(Q=null===(H=A.fcmOptions)||void 0===H?void 0:H.link)&&void 0!==Q?Q:null===(ae=A.notification)||void 0===ae?void 0:ae.click_action;Ne&&(D.fcmOptions.link=Ne);const et=null===(ve=A.fcmOptions)||void 0===ve?void 0:ve.analytics_label;et&&(D.fcmOptions.analyticsLabel=et)}(A,D),A}function Dc(D,A){const L=[];for(let H=0;H<D.length;H++)L.push(D.charAt(H)),H<A.length&&L.push(A.charAt(H));return L.join("")}function Ka(D){return yr.create("missing-app-config-values",{valueName:D})}Dc("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Dc("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Pu{constructor(A,L,H){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const Q=function Ou(D){if(!D||!D.options)throw Ka("App Configuration Object");if(!D.name)throw Ka("App Name");const A=["projectId","apiKey","appId","messagingSenderId"],{options:L}=D;for(const H of A)if(!L[H])throw Ka(H);return{appName:D.name,projectId:L.projectId,apiKey:L.apiKey,appId:L.appId,senderId:L.messagingSenderId}}(A);this.firebaseDependencies={app:A,appConfig:Q,installations:L,analyticsProvider:H}}_delete(){return Promise.resolve()}}function Fl(D,A){return(ar=ar||(0,V.Z)(function*(L,H){if(!navigator)throw yr.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw yr.create("permission-blocked");return yield function ho(D,A){return(Cl=Cl||(0,V.Z)(function*(L,H){H?L.vapidKey=H:L.vapidKey||(L.vapidKey=Ds)})).apply(this,arguments)}(L,H?.vapidKey),yield function pa(D,A){return(Ud=Ud||(0,V.Z)(function*(L,H){if(!H&&!L.swRegistration&&(yield function $o(D){return(or=or||(0,V.Z)(function*(A){try{A.swRegistration=yield navigator.serviceWorker.register(fi,{scope:_r}),A.swRegistration.update().catch(()=>{})}catch(L){throw yr.create("failed-service-worker-registration",{browserErrorMessage:L?.message})}})).apply(this,arguments)}(L)),H||!L.swRegistration){if(!(H instanceof ServiceWorkerRegistration))throw yr.create("invalid-sw-registration");L.swRegistration=H}})).apply(this,arguments)}(L,H?.serviceWorkerRegistration),Cc(L)})).apply(this,arguments)}function Ac(D,A){return(Au=Au||(0,V.Z)(function*(L,H){const Q=H.data;if(!Q.isFirebaseMessaging)return;L.onMessageHandler&&Q.messageType===As.PUSH_RECEIVED&&("function"==typeof L.onMessageHandler?L.onMessageHandler(Wd(Q)):L.onMessageHandler.next(Wd(Q)));const ae=Q.data;(function cm(D){return"object"==typeof D&&!!D&&co in D})(ae)&&"1"===ae[kl]&&(yield function Bl(D,A,L){return(Du=Du||(0,V.Z)(function*(H,Q,ae){const ve=function um(D){switch(D){case As.NOTIFICATION_CLICKED:return"notification_open";case As.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(Q);(yield H.firebaseDependencies.analyticsProvider.get()).logEvent(ve,{message_id:ae[co],message_name:ae[Vd],message_time:ae[Ru],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}(L,Q.messageType,ae))})).apply(this,arguments)}const Rc="@firebase/messaging",e0=D=>{const A=new Pu(D.getProvider("app").getImmediate(),D.getProvider("installations-internal").getImmediate(),D.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",L=>Ac(A,L)),A},dm=D=>{const A=D.getProvider("messaging").getImmediate();return{getToken:H=>Fl(A,H)}};function Fu(){return(Dl=Dl||(0,V.Z)(function*(){try{yield(0,ye.eu)()}catch{return!1}return typeof window<"u"&&(0,ye.hl)()&&(0,ye.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}var jo,Bu,Uu,kc,Zd,Vu,$u,_a,Xd;!function Nu(){(0,de._registerComponent)(new ue.wA("messaging",e0,"PUBLIC")),(0,de._registerComponent)(new ue.wA("messaging-internal",dm,"PRIVATE")),(0,de.registerVersion)(Rc,"0.12.4"),(0,de.registerVersion)(Rc,"0.12.4","esm2017")}();const Ya="analytics",Jd="firebase_id",eh="origin",Za=6e4,ya="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",po="https://www.googletagmanager.com/gtag/js",ri=new Oe.Yd("@firebase/analytics"),Dn=new ye.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function Qa(D){if(!D.startsWith(po)){const A=Dn.create("invalid-gtag-resource",{gtagURL:D});return ri.warn(A.message),""}return D}function Mc(D){return Promise.all(D.map(A=>A.catch(L=>L)))}const rh=30,gm=new class pm{constructor(A={},L=1e3){this.throttleMetadata=A,this.intervalMillis=L}getThrottleMetadata(A){return this.throttleMetadata[A]}setThrottleMetadata(A,L){this.throttleMetadata[A]=L}deleteThrottleMetadata(A){delete this.throttleMetadata[A]}};function qi(D){return new Headers({Accept:"application/json","x-goog-api-key":D})}function Oc(D){return(kc=kc||(0,V.Z)(function*(A,L=gm,H){const{appId:Q,apiKey:ae,measurementId:ve}=A.options;if(!Q)throw Dn.create("no-app-id");if(!ae){if(ve)return{measurementId:ve,appId:Q};throw Dn.create("no-api-key")}const Ne=L.getThrottleMetadata(Q)||{backoffCount:0,throttleEndTimeMillis:Date.now()},et=new _m;return setTimeout((0,V.Z)(function*(){et.abort()}),void 0!==H?H:Za),sh({appId:Q,apiKey:ae,measurementId:ve},Ne,et,L)})).apply(this,arguments)}function sh(D,A,L){return(Zd=Zd||(0,V.Z)(function*(H,{throttleEndTimeMillis:Q,backoffCount:ae},ve,Ne=gm){var et;const{appId:ht,measurementId:St}=H;try{yield function Ks(D,A){return new Promise((L,H)=>{const Q=Math.max(A-Date.now(),0),ae=setTimeout(L,Q);D.addEventListener(()=>{clearTimeout(ae),H(Dn.create("fetch-throttle",{throttleEndTimeMillis:A}))})})}(ve,Q)}catch(Pt){if(St)return ri.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${St} provided in the "measurementId" field in the local Firebase config. [${Pt?.message}]`),{appId:ht,measurementId:St};throw Pt}try{const Pt=yield function Gu(D){return(Uu=Uu||(0,V.Z)(function*(A){var L;const{appId:H,apiKey:Q}=A,ae={method:"GET",headers:qi(Q)},ve=ya.replace("{app-id}",H),Ne=yield fetch(ve,ae);if(200!==Ne.status&&304!==Ne.status){let et="";try{const ht=yield Ne.json();null!==(L=ht.error)&&void 0!==L&&L.message&&(et=ht.error.message)}catch{}throw Dn.create("config-fetch-failed",{httpStatus:Ne.status,responseMessage:et})}return Ne.json()})).apply(this,arguments)}(H);return Ne.deleteThrottleMetadata(ht),Pt}catch(Pt){const un=Pt;if(!function va(D){if(!(D instanceof ye.ZR&&D.customData))return!1;const A=Number(D.customData.httpStatus);return 429===A||500===A||503===A||504===A}(un)){if(Ne.deleteThrottleMetadata(ht),St)return ri.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${St} provided in the "measurementId" field in the local Firebase config. [${un?.message}]`),{appId:ht,measurementId:St};throw Pt}const Nt=503===Number(null===(et=un?.customData)||void 0===et?void 0:et.httpStatus)?(0,ye.$s)(ae,Ne.intervalMillis,rh):(0,ye.$s)(ae,Ne.intervalMillis),Zn={throttleEndTimeMillis:Date.now()+Nt,backoffCount:ae+1};return Ne.setThrottleMetadata(ht,Zn),ri.debug(`Calling attemptFetch again in ${Nt} millis`),sh(H,Zn,ve,Ne)}})).apply(this,arguments)}class _m{constructor(){this.listeners=[]}addEventListener(A){this.listeners.push(A)}abort(){this.listeners.forEach(A=>A())}}let Vl,Wn;function us(D,A,L,H,Q,ae,ve){return(_a=_a||(0,V.Z)(function*(Ne,et,ht,St,Pt,un,Nt){var Zn;const Dr=Oc(Ne);Dr.then(Ms=>{ht[Ms.measurementId]=Ms.appId,Ne.options.measurementId&&Ms.measurementId!==Ne.options.measurementId&&ri.warn(`The measurement ID in the local Firebase config (${Ne.options.measurementId}) does not match the measurement ID fetched from the server (${Ms.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(Ms=>ri.error(Ms)),et.push(Dr);const Ei=function Yn(){return($u=$u||(0,V.Z)(function*(){if(!(0,ye.hl)())return ri.warn(Dn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,ye.eu)()}catch(D){return ri.warn(Dn.create("indexeddb-unavailable",{errorInfo:D?.toString()}).message),!1}return!0})).apply(this,arguments)}().then(Ms=>{if(Ms)return St.getId()}),[on,Fi]=yield Promise.all([Dr,Ei]);(function ju(D){const A=window.document.getElementsByTagName("script");for(const L of Object.values(A))if(L.src&&L.src.includes(po)&&L.src.includes(D))return L;return null})(un)||function Ln(D,A){const L=function nh(D,A){let L;return window.trustedTypes&&(L=window.trustedTypes.createPolicy(D,A)),L}("firebase-js-sdk-policy",{createScriptURL:Qa}),H=document.createElement("script"),Q=`${po}?l=${D}&id=${A}`;H.src=L?L?.createScriptURL(Q):Q,H.async=!0,document.head.appendChild(H)}(un,on.measurementId),Wn&&(Pt("consent","default",Wn),function Fr(D){Wn=D}(void 0)),Pt("js",new Date);const wo=null!==(Zn=Nt?.config)&&void 0!==Zn?Zn:{};return wo[eh]="firebase",wo.update=!0,null!=Fi&&(wo[Jd]=Fi),Pt("config",on.measurementId,wo),Vl&&(Pt("set",Vl),function Ct(D){Vl=D}(void 0)),on.measurementId})).apply(this,arguments)}class vm{constructor(A){this.app=A}_delete(){return delete Gr[this.app.options.appId],Promise.resolve()}}let Gr={},lr=[];const ah={};let ba,zr,Fc="dataLayer",Bc="gtag",wa=!1;function bm(D,A,L){!function bt(){const D=[];if((0,ye.ru)()&&D.push("This is a browser extension environment."),(0,ye.zI)()||D.push("Cookies are not available."),D.length>0){const A=D.map((H,Q)=>`(${Q+1}) ${H}`).join(" "),L=Dn.create("invalid-analytics-context",{errorInfo:A});ri.warn(L.message)}}();const H=D.options.appId;if(!H)throw Dn.create("no-app-id");if(!D.options.apiKey){if(!D.options.measurementId)throw Dn.create("no-api-key");ri.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${D.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Gr[H])throw Dn.create("already-exists",{id:H});if(!wa){!function pg(D){let A=[];Array.isArray(window[D])?A=window[D]:window[D]=A}(Fc);const{wrappedGtag:ae,gtagCore:ve}=function gg(D,A,L,H,Q){let ae=function(...ve){window[H].push(arguments)};return window[Q]&&"function"==typeof window[Q]&&(ae=window[Q]),window[Q]=function Lc(D,A,L,H){var Q;return function ae(ve){return(Q=Q||(0,V.Z)(function*(Ne,...et){try{if("event"===Ne){const[ht,St]=et;yield function ih(D,A,L,H,Q){return(Bu=Bu||(0,V.Z)(function*(ae,ve,Ne,et,ht){try{let St=[];if(ht&&ht.send_to){let Pt=ht.send_to;Array.isArray(Pt)||(Pt=[Pt]);const un=yield Mc(Ne);for(const Nt of Pt){const Zn=un.find(Ei=>Ei.measurementId===Nt),Dr=Zn&&ve[Zn.appId];if(!Dr){St=[];break}St.push(Dr)}}0===St.length&&(St=Object.values(ve)),yield Promise.all(St),ae("event",et,ht||{})}catch(St){ri.error(St)}})).apply(this,arguments)}(D,A,L,ht,St)}else if("config"===Ne){const[ht,St]=et;yield function mm(D,A,L,H,Q,ae){return(jo=jo||(0,V.Z)(function*(ve,Ne,et,ht,St,Pt){const un=ht[St];try{if(un)yield Ne[un];else{const Zn=(yield Mc(et)).find(Dr=>Dr.measurementId===St);Zn&&(yield Ne[Zn.appId])}}catch(Nt){ri.error(Nt)}ve("config",St,Pt)})).apply(this,arguments)}(D,A,L,H,ht,St)}else if("consent"===Ne){const[ht]=et;D("consent","update",ht)}else if("get"===Ne){const[ht,St,Pt]=et;D("get",ht,St,Pt)}else if("set"===Ne){const[ht]=et;D("set",ht)}else D(Ne,...et)}catch(ht){ri.error(ht)}})).apply(this,arguments)}}(ae,D,A,L),{gtagCore:ae,wrappedGtag:window[Q]}}(Gr,lr,ah,Fc,Bc);zr=ae,ba=ve,wa=!0}return Gr[H]=us(D,lr,ah,A,ba,Fc,L),new vm(D)}function Ea(){return(Xd=Xd||(0,V.Z)(function*(){if((0,ye.ru)()||!(0,ye.zI)()||!(0,ye.hl)())return!1;try{return yield(0,ye.eu)()}catch{return!1}})).apply(this,arguments)}const qs="@firebase/analytics";!function jl(){(0,de._registerComponent)(new ue.wA(Ya,(A,{options:L})=>bm(A.getProvider("app").getImmediate(),A.getProvider("installations-internal").getImmediate(),L),"PUBLIC")),(0,de._registerComponent)(new ue.wA("analytics-internal",function D(A){try{const L=A.getProvider(Ya).getImmediate();return{logEvent:(H,Q,ae)=>function vg(D,A,L,H){D=(0,ye.m9)(D),function Pc(D,A,L,H,Q){return(Vu=Vu||(0,V.Z)(function*(ae,ve,Ne,et,ht){if(ht&&ht.global)ae("event",Ne,et);else{const St=yield ve;ae("event",Ne,Object.assign(Object.assign({},et),{send_to:St}))}})).apply(this,arguments)}(zr,Gr[D.app.options.appId],A,L,H).catch(Q=>ri.error(Q))}(L,H,Q,ae)}}catch(L){throw Dn.create("interop-component-reg-failed",{reason:L})}},"PRIVATE")),(0,de.registerVersion)(qs,"0.10.0"),(0,de.registerVersion)(qs,"0.10.0","esm2017")}();var Ys=z(4408),Kr=z(7565);const Ni=new class el extends Kr.v{}(class Ja extends Ys.o{constructor(A,L){super(A,L),this.scheduler=A,this.work=L}schedule(A,L=0){return L>0?super.schedule(A,L):(this.delay=L,this.state=A,this.scheduler.flush(this),this)}execute(A,L){return L>0||this.closed?super.execute(A,L):this._execute(A,L)}requestAsyncId(A,L,H=0){return null!=H&&H>0||null==H&&this.delay>0?super.requestAsyncId(A,L,H):(A.flush(this),0)}});var uh=z(4986),Di=z(9751),go=z(8505),Go=z(9468),_i=z(5363);const Yi=new h.GfV("7.6.1"),Gl="__angularfire_symbol__analyticsIsSupportedValue",zu="__angularfire_symbol__analyticsIsSupported",xa="__angularfire_symbol__remoteConfigIsSupportedValue",Rs="__angularfire_symbol__remoteConfigIsSupported",_o="__angularfire_symbol__messagingIsSupportedValue",yi="__angularfire_symbol__messagingIsSupported";function Gc(D,A,L){if(A){if(1===A.length)return A[0];const ae=A.filter(ve=>ve.app===L);if(1===ae.length)return ae[0]}return L.container.getProvider(D).getImmediate({optional:!0})}globalThis[zu]||(globalThis[zu]=Ea().then(D=>globalThis[Gl]=D).catch(()=>globalThis[Gl]=!1)),globalThis[yi]||(globalThis[yi]=Fu().then(D=>globalThis[_o]=D).catch(()=>globalThis[_o]=!1)),globalThis[Rs]||(globalThis[Rs]=xu().then(D=>globalThis[xa]=D).catch(()=>globalThis[xa]=!1));const dh=(D,A)=>{const L=A?[A]:(0,X.C6)(),H=[];return L.forEach(Q=>{Q.container.getProvider(D).instances.forEach(ve=>{H.includes(ve)||H.push(ve)})}),H};function yo(){}class tl{constructor(A,L=Ni){this.zone=A,this.delegate=L}now(){return this.delegate.now()}schedule(A,L,H){const Q=this.zone;return this.delegate.schedule(function(ve){Q.runGuarded(()=>{A.apply(this,[ve])})},L,H)}}class Zt{constructor(A){this.zone=A,this.task=null}call(A,L){const H=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",yo,{},yo,yo)),L.pipe((0,go.b)({next:H,complete:H,error:H})).subscribe(A).add(H)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let nl=(()=>{class D{constructor(L){this.ngZone=L,this.outsideAngular=L.runOutsideAngular(()=>new tl(Zone.current)),this.insideAngular=L.run(()=>new tl(Zone.current,uh.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return D.\u0275fac=function(L){return new(L||D)(h.LFG(h.R0b))},D.\u0275prov=h.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})();function Ta(){const D=globalThis.\u0275AngularFireScheduler;if(!D)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return D}function zo(D){return Ta().ngZone.run(()=>D())}function Wu(D){return Ta(),function fh(D){return function(L){return(L=L.lift(new Zt(D.ngZone))).pipe((0,Go.R)(D.outsideAngular),(0,_i.Q)(D.insideAngular))}}(Ta())(D)}const Ku=(D,A)=>function(){const H=arguments;return A&&setTimeout(()=>{"scheduled"===A.state&&A.invoke()},10),zo(()=>D.apply(void 0,H))},wg=(D,A)=>function(){let L;const H=arguments;for(let ae=0;ae<arguments.length;ae++)"function"==typeof H[ae]&&(A&&(L||(L=zo(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",yo,{},yo,yo)))),H[ae]=Ku(H[ae],L));const Q=function vo(D){return Ta().ngZone.runOutsideAngular(()=>D())}(()=>D.apply(this,H));if(!A){if(Q instanceof Di.y){const ae=Ta();return Q.pipe((0,Go.R)(ae.outsideAngular),(0,_i.Q)(ae.insideAngular))}return zo(()=>Q)}return Q instanceof Di.y?Q.pipe(Wu):Q instanceof Promise?zo(()=>new Promise((ae,ve)=>Q.then(Ne=>zo(()=>ae(Ne)),Ne=>zo(()=>ve(Ne))))):"function"==typeof Q&&L?function(){return setTimeout(()=>{L&&"scheduled"===L.state&&L.invoke()},10),Q.apply(this,arguments)}:zo(()=>Q)}},1389:(Ft,Be,z)=>{z.d(Be,{$:()=>Si,A:()=>dn,D:()=>On,I:()=>kd,J:()=>Cs,L:()=>fn,N:()=>Sd,P:()=>wm,Q:()=>Al,R:()=>Fc,U:()=>Rl,V:()=>co,W:()=>Vd,X:()=>Ds,Y:()=>As,Z:()=>as,_:()=>$d,a:()=>Za,a0:()=>Uo,a1:()=>ai,a2:()=>yr,a3:()=>Ol,a4:()=>Sc,a5:()=>Mu,a6:()=>Cc,a7:()=>Pl,a8:()=>Nl,a9:()=>ma,aA:()=>Xe,aB:()=>yi,aC:()=>lo,aD:()=>No,aE:()=>xa,aF:()=>Ni,aG:()=>el,aH:()=>In,aL:()=>ri,aO:()=>kl,aa:()=>Vo,ab:()=>am,ac:()=>Wd,ad:()=>mg,ae:()=>lm,af:()=>cm,ai:()=>Ou,aj:()=>Ka,ak:()=>Pu,an:()=>sm,ao:()=>qa,aq:()=>Bu,ar:()=>fm,as:()=>Pr,at:()=>wu,au:()=>_c,av:()=>It,aw:()=>un,ax:()=>jc,ay:()=>Ad,az:()=>$t,b:()=>Jd,c:()=>Uc,d:()=>Vc,e:()=>vg,f:()=>Di,g:()=>Yi,h:()=>Go,i:()=>va,j:()=>zu,k:()=>Ei,l:()=>wa,m:()=>wo,o:()=>mh,p:()=>ut,r:()=>$l,s:()=>zr,u:()=>bm});var Oe,Le,Ce,ee,J,le,tt,Ue,lt,Et,Se,ze,qe,st,Ye,He,je,at,Je,wt,At,cn,xt,_n,Rt,ro,es,ts,Hs,_e,Ee,Ie,pe,it,Ze,jt,Dt,ci,Vt,Tn,si,Gn,Mi,Li,gi,Oi,tr,bi,Bt,vs,sa,Pn,$r,Ii,ni,Mn,Gt,nr,ui,wi,mr,zi,oa,zn,di,sn,so,En,Or,Wi,ir,ns,Ki,bs,ws,ne,Z,$,j,U,ie,h=z(5861),X=z(2090),V=z(6881),de=z(7582),ye=z(1877),ue=z(4859);const ut={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},dn={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const On=function Ut(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend."}},Hr=function qn(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},is=new X.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),fe=new ye.Yd("@firebase/auth");function Tt(R,...y){fe.logLevel<=ye.in.ERROR&&fe.error(`Auth (${V.SDK_VERSION}): ${R}`,...y)}function It(R,...y){throw kn(R,...y)}function $t(R,...y){return kn(R,...y)}function Lt(R,y,b){const x=Object.assign(Object.assign({},Hr()),{[y]:b});return new X.LL("auth","Firebase",x).create(y,{appName:R.name})}function Rn(R,y,b){if(!(y instanceof b))throw b.name!==y.constructor.name&&It(R,"argument-error"),Lt(R,"argument-error",`Type of ${y.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function kn(R,...y){if("string"!=typeof R){const b=y[0],x=[...y.slice(1)];return x[0]&&(x[0].appName=R.name),R._errorFactory.create(b,...x)}return is.create(R,...y)}function Xe(R,y,...b){if(!R)throw kn(y,...b)}function ei(R){const y="INTERNAL ASSERTION FAILED: "+R;throw Tt(y),new Error(y)}function Pr(R,y){R||ei(y)}function oo(){var R;return typeof self<"u"&&(null===(R=self.location)||void 0===R?void 0:R.href)||""}function $a(){return"http:"===rs()||"https:"===rs()}function rs(){var R;return typeof self<"u"&&(null===(R=self.location)||void 0===R?void 0:R.protocol)||null}class ii{constructor(y,b){this.shortDelay=y,this.longDelay=b,Pr(b>y,"Short delay should be less than long delay!"),this.isMobile=(0,X.uI)()||(0,X.b$)()}get(){return function vt(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&($a()||(0,X.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Nr(R,y){Pr(R.emulator,"Emulator should always be set here");const{url:b}=R.emulator;return y?`${b}${y.startsWith("/")?y.slice(1):y}`:b}class ao{static initialize(y,b,x){this.fetchImpl=y,b&&(this.headersImpl=b),x&&(this.responseImpl=x)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void ei("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void ei("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void ei("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Tr={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},aa=new ii(3e4,6e4);function hn(R,y){return R.tenantId&&!y.tenantId?Object.assign(Object.assign({},y),{tenantId:R.tenantId}):y}function oi(R,y,b,x){return(Oe=Oe||(0,h.Z)(function*(O,F,q,re,me={}){return Es(O,me,(0,h.Z)(function*(){let Fe={},Ht={};re&&("GET"===F?Ht=re:Fe={body:JSON.stringify(re)});const kt=(0,X.xO)(Object.assign({key:O.config.apiKey},Ht)).slice(1),Wt=yield O._getAdditionalHeaders();return Wt["Content-Type"]="application/json",O.languageCode&&(Wt["X-Firebase-Locale"]=O.languageCode),ao.fetch()(wl(O,O.config.apiHost,q,kt),Object.assign({method:F,headers:Wt,referrerPolicy:"no-referrer"},Fe))}))})).apply(this,arguments)}function Es(R,y,b){return(Le=Le||(0,h.Z)(function*(x,O,F){x._canInitEmulator=!1;const q=Object.assign(Object.assign({},Tr),O);try{const re=new la(x),me=yield Promise.race([F(),re.promise]);re.clearNetworkTimeout();const Fe=yield me.json();if("needConfirmation"in Fe)throw Po(x,"account-exists-with-different-credential",Fe);if(me.ok&&!("errorMessage"in Fe))return Fe;{const Ht=me.ok?Fe.errorMessage:Fe.error.message,[kt,Wt]=Ht.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===kt)throw Po(x,"credential-already-in-use",Fe);if("EMAIL_EXISTS"===kt)throw Po(x,"email-already-in-use",Fe);if("USER_DISABLED"===kt)throw Po(x,"user-disabled",Fe);const Nn=q[kt]||kt.toLowerCase().replace(/[_\s]+/g,"-");if(Wt)throw Lt(x,Nn,Wt);It(x,Nn)}}catch(re){if(re instanceof X.ZR)throw re;It(x,"network-request-failed",{message:String(re)})}})).apply(this,arguments)}function en(R,y,b,x){return(Ce=Ce||(0,h.Z)(function*(O,F,q,re,me={}){const Fe=yield oi(O,F,q,re,me);return"mfaPendingCredential"in Fe&&It(O,"multi-factor-auth-required",{_serverResponse:Fe}),Fe})).apply(this,arguments)}function wl(R,y,b,x){const O=`${y}${b}?${x}`;return R.config.emulator?Nr(R.config,O):`${R.config.apiScheme}://${O}`}class la{constructor(y){this.auth=y,this.timer=null,this.promise=new Promise((b,x)=>{this.timer=setTimeout(()=>x($t(this.auth,"network-request-failed")),aa.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Po(R,y,b){const x={appName:R.name};b.email&&(x.email=b.email),b.phoneNumber&&(x.phoneNumber=b.phoneNumber);const O=$t(R,y,x);return O.customData._tokenResponse=b,O}function ss(R){if(R)try{const y=new Date(Number(R));if(!isNaN(y.getTime()))return y.toUTCString()}catch{}}function ja(R){return 1e3*Number(R)}function ti(R){const[y,b,x]=R.split(".");if(void 0===y||void 0===b||void 0===x)return Tt("JWT malformed, contained fewer than 3 sections"),null;try{const O=(0,X.tV)(b);return O?JSON.parse(O):(Tt("Failed to decode base64 JWT payload"),null)}catch(O){return Tt("Caught error parsing JWT payload as JSON",O?.toString()),null}}function Ts(R,y){return(Ue=Ue||(0,h.Z)(function*(b,x,O=!1){if(O)return x;try{return yield x}catch(F){throw F instanceof X.ZR&&function Ir({code:R}){return"auth/user-disabled"===R||"auth/user-token-expired"===R}(F)&&b.auth.currentUser===b&&(yield b.auth.signOut()),F}})).apply(this,arguments)}class pc{constructor(y){this.user=y,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(y){var b;if(y){const x=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),x}{this.errorBackoff=3e4;const O=(null!==(b=this.user.stsTokenManager.expirationTime)&&void 0!==b?b:0)-Date.now()-3e5;return Math.max(0,O)}}schedule(y=!1){var b=this;if(!this.isRunning)return;const x=this.getInterval(y);this.timerId=setTimeout((0,h.Z)(function*(){yield b.iteration()}),x)}iteration(){var y=this;return(0,h.Z)(function*(){try{yield y.user.getIdToken(!0)}catch(b){return void("auth/network-request-failed"===b?.code&&y.schedule(!0))}y.schedule()})()}}class xl{constructor(y,b){this.createdAt=y,this.lastLoginAt=b,this._initializeTime()}_initializeTime(){this.lastSignInTime=ss(this.lastLoginAt),this.creationTime=ss(this.createdAt)}_copy(y){this.createdAt=y.createdAt,this.lastLoginAt=y.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Is(R){return(lt=lt||(0,h.Z)(function*(y){var b;const x=y.auth,O=yield y.getIdToken(),F=yield Ts(y,function El(R,y){return(le=le||(0,h.Z)(function*(b,x){return oi(b,"POST","/v1/accounts:lookup",x)})).apply(this,arguments)}(x,{idToken:O}));Xe(F?.users.length,x,"internal-error");const q=F.users[0];y._notifyReloadListener(q);const re=null!==(b=q.providerUserInfo)&&void 0!==b&&b.length?function Sr(R){return R.map(y=>{var{providerId:b}=y,x=(0,de._T)(y,["providerId"]);return{providerId:b,uid:x.rawId||"",displayName:x.displayName||null,email:x.email||null,phoneNumber:x.phoneNumber||null,photoURL:x.photoUrl||null}})}(q.providerUserInfo):[],me=function dg(R,y){return[...R.filter(x=>!y.some(O=>O.providerId===x.providerId)),...y]}(y.providerData,re),kt=!!y.isAnonymous&&!(y.email&&q.passwordHash||me?.length),Wt={uid:q.localId,displayName:q.displayName||null,photoURL:q.photoUrl||null,email:q.email||null,emailVerified:q.emailVerified||!1,phoneNumber:q.phoneNumber||null,tenantId:q.tenantId||null,providerData:me,metadata:new xl(q.createdAt,q.lastLoginAt),isAnonymous:kt};Object.assign(y,Wt)})).apply(this,arguments)}class ua{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(y){Xe(y.idToken,"internal-error"),Xe(typeof y.idToken<"u","internal-error"),Xe(typeof y.refreshToken<"u","internal-error");const b="expiresIn"in y&&typeof y.expiresIn<"u"?Number(y.expiresIn):function xs(R){const y=ti(R);return Xe(y,"internal-error"),Xe(typeof y.exp<"u","internal-error"),Xe(typeof y.iat<"u","internal-error"),Number(y.exp)-Number(y.iat)}(y.idToken);this.updateTokensAndExpiration(y.idToken,y.refreshToken,b)}getToken(y,b=!1){var x=this;return(0,h.Z)(function*(){return Xe(!x.accessToken||x.refreshToken,y,"user-token-expired"),b||!x.accessToken||x.isExpired?x.refreshToken?(yield x.refresh(y,x.refreshToken),x.accessToken):null:x.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(y,b){var x=this;return(0,h.Z)(function*(){const{accessToken:O,refreshToken:F,expiresIn:q}=yield function Gs(R,y){return(Se=Se||(0,h.Z)(function*(b,x){const O=yield Es(b,{},(0,h.Z)(function*(){const F=(0,X.xO)({grant_type:"refresh_token",refresh_token:x}).slice(1),{tokenApiHost:q,apiKey:re}=b.config,me=wl(b,q,"/v1/token",`key=${re}`),Fe=yield b._getAdditionalHeaders();return Fe["Content-Type"]="application/x-www-form-urlencoded",ao.fetch()(me,{method:"POST",headers:Fe,body:F})}));return{accessToken:O.access_token,expiresIn:O.expires_in,refreshToken:O.refresh_token}})).apply(this,arguments)}(y,b);x.updateTokensAndExpiration(O,F,Number(q))})()}updateTokensAndExpiration(y,b,x){this.refreshToken=b||null,this.accessToken=y||null,this.expirationTime=Date.now()+1e3*x}static fromJSON(y,b){const{refreshToken:x,accessToken:O,expirationTime:F}=b,q=new ua;return x&&(Xe("string"==typeof x,"internal-error",{appName:y}),q.refreshToken=x),O&&(Xe("string"==typeof O,"internal-error",{appName:y}),q.accessToken=O),F&&(Xe("number"==typeof F,"internal-error",{appName:y}),q.expirationTime=F),q}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(y){this.accessToken=y.accessToken,this.refreshToken=y.refreshToken,this.expirationTime=y.expirationTime}_clone(){return Object.assign(new ua,this.toJSON())}_performRefresh(){return ei("not implemented")}}function os(R,y){Xe("string"==typeof R||typeof R>"u","internal-error",{appName:y})}class zs{constructor(y){var{uid:b,auth:x,stsTokenManager:O}=y,F=(0,de._T)(y,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new pc(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=b,this.auth=x,this.stsTokenManager=O,this.accessToken=O.accessToken,this.displayName=F.displayName||null,this.email=F.email||null,this.emailVerified=F.emailVerified||!1,this.phoneNumber=F.phoneNumber||null,this.photoURL=F.photoURL||null,this.isAnonymous=F.isAnonymous||!1,this.tenantId=F.tenantId||null,this.providerData=F.providerData?[...F.providerData]:[],this.metadata=new xl(F.createdAt||void 0,F.lastLoginAt||void 0)}getIdToken(y){var b=this;return(0,h.Z)(function*(){const x=yield Ts(b,b.stsTokenManager.getToken(b.auth,y));return Xe(x,b.auth,"internal-error"),b.accessToken!==x&&(b.accessToken=x,yield b.auth._persistUserIfCurrent(b),b.auth._notifyListenersIfCurrent(b)),x})()}getIdTokenResult(y){return function ca(R){return(tt=tt||(0,h.Z)(function*(y,b=!1){const x=(0,X.m9)(y),O=yield x.getIdToken(b),F=ti(O);Xe(F&&F.exp&&F.auth_time&&F.iat,x.auth,"internal-error");const q="object"==typeof F.firebase?F.firebase:void 0,re=q?.sign_in_provider;return{claims:F,token:O,authTime:ss(ja(F.auth_time)),issuedAtTime:ss(ja(F.iat)),expirationTime:ss(ja(F.exp)),signInProvider:re||null,signInSecondFactor:q?.sign_in_second_factor||null}})).apply(this,arguments)}(this,y)}reload(){return function pr(R){return(Et=Et||(0,h.Z)(function*(y){const b=(0,X.m9)(y);yield Is(b),yield b.auth._persistUserIfCurrent(b),b.auth._notifyListenersIfCurrent(b)})).apply(this,arguments)}(this)}_assign(y){this!==y&&(Xe(this.uid===y.uid,this.auth,"internal-error"),this.displayName=y.displayName,this.photoURL=y.photoURL,this.email=y.email,this.emailVerified=y.emailVerified,this.phoneNumber=y.phoneNumber,this.isAnonymous=y.isAnonymous,this.tenantId=y.tenantId,this.providerData=y.providerData.map(b=>Object.assign({},b)),this.metadata._copy(y.metadata),this.stsTokenManager._assign(y.stsTokenManager))}_clone(y){const b=new zs(Object.assign(Object.assign({},this),{auth:y,stsTokenManager:this.stsTokenManager._clone()}));return b.metadata._copy(this.metadata),b}_onReload(y){Xe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=y,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(y){this.reloadListener?this.reloadListener(y):this.reloadUserInfo=y}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(y,b=!1){var x=this;return(0,h.Z)(function*(){let O=!1;y.idToken&&y.idToken!==x.stsTokenManager.accessToken&&(x.stsTokenManager.updateFromServerResponse(y),O=!0),b&&(yield Is(x)),yield x.auth._persistUserIfCurrent(x),O&&x.auth._notifyListenersIfCurrent(x)})()}delete(){var y=this;return(0,h.Z)(function*(){const b=yield y.getIdToken();return yield Ts(y,function Ha(R,y){return(ee=ee||(0,h.Z)(function*(b,x){return oi(b,"POST","/v1/accounts:delete",x)})).apply(this,arguments)}(y.auth,{idToken:b})),y.stsTokenManager.clearRefreshToken(),y.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(y=>Object.assign({},y)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(y,b){var x,O,F,q,re,me,Fe,Ht;const kt=null!==(x=b.displayName)&&void 0!==x?x:void 0,Wt=null!==(O=b.email)&&void 0!==O?O:void 0,Nn=null!==(F=b.phoneNumber)&&void 0!==F?F:void 0,cr=null!==(q=b.photoURL)&&void 0!==q?q:void 0,Ls=null!==(re=b.tenantId)&&void 0!==re?re:void 0,ur=null!==(me=b._redirectEventId)&&void 0!==me?me:void 0,Kl=null!==(Fe=b.createdAt)&&void 0!==Fe?Fe:void 0,ph=null!==(Ht=b.lastLoginAt)&&void 0!==Ht?Ht:void 0,{uid:qu,emailVerified:rl,isAnonymous:gh,providerData:_h,stsTokenManager:qc}=b;Xe(qu&&qc,y,"internal-error");const yh=ua.fromJSON(this.name,qc);Xe("string"==typeof qu,y,"internal-error"),os(kt,y.name),os(Wt,y.name),Xe("boolean"==typeof rl,y,"internal-error"),Xe("boolean"==typeof gh,y,"internal-error"),os(Nn,y.name),os(cr,y.name),os(Ls,y.name),os(ur,y.name),os(Kl,y.name),os(ph,y.name);const Yc=new zs({uid:qu,auth:y,email:Wt,emailVerified:rl,displayName:kt,isAnonymous:gh,photoURL:cr,phoneNumber:Nn,tenantId:Ls,stsTokenManager:yh,createdAt:Kl,lastLoginAt:ph});return _h&&Array.isArray(_h)&&(Yc.providerData=_h.map(sl=>Object.assign({},sl))),ur&&(Yc._redirectEventId=ur),Yc}static _fromIdTokenResponse(y,b,x=!1){return(0,h.Z)(function*(){const O=new ua;O.updateFromServerResponse(b);const F=new zs({uid:b.localId,auth:y,stsTokenManager:O,isAnonymous:x});return yield Is(F),F})()}}const Ss=new Map;function lo(R){Pr(R instanceof Function,"Expected a class definition");let y=Ss.get(R);return y?(Pr(y instanceof R,"Instance stored in cache mismatched with class"),y):(y=new R,Ss.set(R,y),y)}const Sd=(()=>{class R{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,h.Z)(function*(){return!0})()}_set(b,x){var O=this;return(0,h.Z)(function*(){O.storage[b]=x})()}_get(b){var x=this;return(0,h.Z)(function*(){const O=x.storage[b];return void 0===O?null:O})()}_remove(b){var x=this;return(0,h.Z)(function*(){delete x.storage[b]})()}_addListener(b,x){}_removeListener(b,x){}}return R.type="NONE",R})();function No(R,y,b){return`firebase:${R}:${y}:${b}`}class gc{constructor(y,b,x){this.persistence=y,this.auth=b,this.userKey=x;const{config:O,name:F}=this.auth;this.fullUserKey=No(this.userKey,O.apiKey,F),this.fullPersistenceKey=No("persistence",O.apiKey,F),this.boundEventHandler=b._onStorageEvent.bind(b),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(y){return this.persistence._set(this.fullUserKey,y.toJSON())}getCurrentUser(){var y=this;return(0,h.Z)(function*(){const b=yield y.persistence._get(y.fullUserKey);return b?zs._fromJSON(y.auth,b):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(y){var b=this;return(0,h.Z)(function*(){if(b.persistence===y)return;const x=yield b.getCurrentUser();return yield b.removeCurrentUser(),b.persistence=y,x?b.setCurrentUser(x):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(y,b,x="authUser"){return(0,h.Z)(function*(){var O,F;if(!b.length)return new gc(lo(Sd),y,x);const q=(yield Promise.all(b.map(function(kt){return(O=O||(0,h.Z)(function*(Wt){if(yield Wt._isAvailable())return Wt})).apply(this,arguments)}))).filter(kt=>kt);let re=q[0]||lo(Sd);const me=No(x,y.config.apiKey,y.name);let Fe=null;for(const kt of b)try{const Wt=yield kt._get(me);if(Wt){const Nn=zs._fromJSON(y,Wt);kt!==re&&(Fe=Nn),re=kt;break}}catch{}const Ht=q.filter(kt=>kt._shouldAllowMigration);return re._shouldAllowMigration&&Ht.length?(re=Ht[0],Fe&&(yield re._set(me,Fe.toJSON())),yield Promise.all(b.map(function(kt){return(F=F||(0,h.Z)(function*(Wt){if(Wt!==re)try{yield Wt._remove(me)}catch{}})).apply(this,arguments)})),new gc(re,y,x)):new gc(re,y,x)})()}}function qf(R){const y=R.toLowerCase();if(y.includes("opera/")||y.includes("opr/")||y.includes("opios/"))return"Opera";if(Zf(y))return"IEMobile";if(y.includes("msie")||y.includes("trident/"))return"IE";if(y.includes("edge/"))return"Edge";if(Cd(y))return"Firefox";if(y.includes("silk/"))return"Silk";if(bu(y))return"Blackberry";if(hg(y))return"Webos";if(Dd(y))return"Safari";if((y.includes("chrome/")||Yf(y))&&!y.includes("edge/"))return"Chrome";if(_c(y))return"Android";{const x=R.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===x?.length)return x[1]}return"Other"}function Cd(R=(0,X.z$)()){return/firefox\//i.test(R)}function Dd(R=(0,X.z$)()){const y=R.toLowerCase();return y.includes("safari/")&&!y.includes("chrome/")&&!y.includes("crios/")&&!y.includes("android")}function Yf(R=(0,X.z$)()){return/crios\//i.test(R)}function Zf(R=(0,X.z$)()){return/iemobile/i.test(R)}function _c(R=(0,X.z$)()){return/android/i.test(R)}function bu(R=(0,X.z$)()){return/blackberry/i.test(R)}function hg(R=(0,X.z$)()){return/webos/i.test(R)}function wu(R=(0,X.z$)()){return/iphone|ipad|ipod/i.test(R)||/macintosh/i.test(R)&&/mobile/i.test(R)}function Ad(R=(0,X.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(R)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(R)}function Eu(R=(0,X.z$)()){return wu(R)||_c(R)||hg(R)||bu(R)||/windows phone/i.test(R)||Zf(R)}function Qf(R,y=[]){let b;switch(R){case"Browser":b=qf((0,X.z$)());break;case"Worker":b=`${qf((0,X.z$)())}-${R}`;break;default:b=R}const x=y.length?y.join(","):"FirebaseCore-web";return`${b}/JsCore/${V.SDK_VERSION}/${x}`}function da(R,y){return(qe=qe||(0,h.Z)(function*(b,x){return oi(b,"GET","/v2/recaptchaConfig",hn(b,x))})).apply(this,arguments)}function Jf(R){return void 0!==R&&void 0!==R.getResponse}function Rd(R){return void 0!==R&&void 0!==R.enterprise}class xu{constructor(y){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===y.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=y.recaptchaKey.split("/")[3],this.emailPasswordEnabled=y.recaptchaEnforcementState.some(b=>"EMAIL_PASSWORD_PROVIDER"===b.provider&&"OFF"!==b.enforcementState)}}function Tl(R){return new Promise((y,b)=>{const x=document.createElement("script");x.setAttribute("src",R),x.onload=y,x.onerror=O=>{const F=$t("internal-error");F.customData=O,b(F)},x.type="text/javascript",x.charset="UTF-8",function em(){var R,y;return null!==(y=null===(R=document.getElementsByTagName("head"))||void 0===R?void 0:R[0])&&void 0!==y?y:document}().appendChild(x)})}function vc(R){return`__${R}${Math.floor(1e6*Math.random())}`}const Tu="NO_RECAPTCHA";class Ga{constructor(y){this.type="recaptcha-enterprise",this.auth=In(y)}verify(y="verify",b=!1){var x=this;return(0,h.Z)(function*(){var O;function q(re,me,Fe){const Ht=window.grecaptcha;Rd(Ht)?Ht.enterprise.ready(()=>{Ht.enterprise.execute(re,{action:y}).then(kt=>{me(kt)}).catch(()=>{me(Tu)})}):Fe(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((re,me)=>{(function F(re){return(O=O||(0,h.Z)(function*(me){var Fe;if(!b){if(null==me.tenantId&&null!=me._agentRecaptchaConfig)return me._agentRecaptchaConfig.siteKey;if(null!=me.tenantId&&void 0!==me._tenantRecaptchaConfigs[me.tenantId])return me._tenantRecaptchaConfigs[me.tenantId].siteKey}return new Promise(function(Ht,kt){return(Fe=Fe||(0,h.Z)(function*(Wt,Nn){da(me,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(cr=>{if(void 0!==cr.recaptchaKey){const Ls=new xu(cr);return null==me.tenantId?me._agentRecaptchaConfig=Ls:me._tenantRecaptchaConfigs[me.tenantId]=Ls,Wt(Ls.siteKey)}Nn(new Error("recaptcha Enterprise site key undefined"))}).catch(cr=>{Nn(cr)})})).apply(this,arguments)})})).apply(this,arguments)})(x.auth).then(Fe=>{if(!b&&Rd(window.grecaptcha))q(Fe,re,me);else{if(typeof window>"u")return void me(new Error("RecaptchaVerifier is only supported in browser"));Tl("https://www.google.com/recaptcha/enterprise.js?render="+Fe).then(()=>{q(Fe,re,me)}).catch(Ht=>{me(Ht)})}}).catch(Fe=>{me(Fe)})})})()}}function Pi(R,y,b){return(st=st||(0,h.Z)(function*(x,O,F,q=!1){const re=new Ga(x);let me;try{me=yield re.verify(F)}catch{me=yield re.verify(F,!0)}const Fe=Object.assign({},O);return Object.assign(Fe,q?{captchaResp:me}:{captchaResponse:me}),Object.assign(Fe,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(Fe,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),Fe})).apply(this,arguments)}class bc{constructor(y){this.auth=y,this.queue=[]}pushCallback(y,b){const x=F=>new Promise((q,re)=>{try{q(y(F))}catch(me){re(me)}});x.onAbort=b,this.queue.push(x);const O=this.queue.length-1;return()=>{this.queue[O]=()=>Promise.resolve()}}runMiddleware(y){var b=this;return(0,h.Z)(function*(){if(b.auth.currentUser===y)return;const x=[];try{for(const O of b.queue)yield O(y),O.onAbort&&x.push(O.onAbort)}catch(O){x.reverse();for(const F of x)try{F()}catch{}throw b.auth._errorFactory.create("login-blocked",{originalMessage:O?.message})}})()}}class wc{constructor(y,b,x,O){this.app=y,this.heartbeatServiceProvider=b,this.appCheckServiceProvider=x,this.config=O,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Il(this),this.idTokenSubscription=new Il(this),this.beforeStateQueue=new bc(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=is,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=y.name,this.clientVersion=O.sdkClientVersion}_initializeWithPersistence(y,b){var x=this;return b&&(this._popupRedirectResolver=lo(b)),this._initializationPromise=this.queue((0,h.Z)(function*(){var O,F;if(!x._deleted&&(x.persistenceManager=yield gc.create(x,y),!x._deleted)){if(null!==(O=x._popupRedirectResolver)&&void 0!==O&&O._shouldInitProactively)try{yield x._popupRedirectResolver._initialize(x)}catch{}yield x.initializeCurrentUser(b),x.lastNotifiedUid=(null===(F=x.currentUser)||void 0===F?void 0:F.uid)||null,!x._deleted&&(x._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var y=this;return(0,h.Z)(function*(){if(y._deleted)return;const b=yield y.assertedPersistence.getCurrentUser();if(y.currentUser||b){if(y.currentUser&&b&&y.currentUser.uid===b.uid)return y._currentUser._assign(b),void(yield y.currentUser.getIdToken());yield y._updateCurrentUser(b,!0)}})()}initializeCurrentUser(y){var b=this;return(0,h.Z)(function*(){var x;const O=yield b.assertedPersistence.getCurrentUser();let F=O,q=!1;if(y&&b.config.authDomain){yield b.getOrInitRedirectPersistenceManager();const re=null===(x=b.redirectUser)||void 0===x?void 0:x._redirectEventId,me=F?._redirectEventId,Fe=yield b.tryRedirectSignIn(y);(!re||re===me)&&Fe?.user&&(F=Fe.user,q=!0)}if(!F)return b.directlySetCurrentUser(null);if(!F._redirectEventId){if(q)try{yield b.beforeStateQueue.runMiddleware(F)}catch(re){F=O,b._popupRedirectResolver._overrideRedirectResult(b,()=>Promise.reject(re))}return F?b.reloadAndSetCurrentUserOrClear(F):b.directlySetCurrentUser(null)}return Xe(b._popupRedirectResolver,b,"argument-error"),yield b.getOrInitRedirectPersistenceManager(),b.redirectUser&&b.redirectUser._redirectEventId===F._redirectEventId?b.directlySetCurrentUser(F):b.reloadAndSetCurrentUserOrClear(F)})()}tryRedirectSignIn(y){var b=this;return(0,h.Z)(function*(){let x=null;try{x=yield b._popupRedirectResolver._completeRedirectFn(b,y,!0)}catch{yield b._setRedirectUser(null)}return x})()}reloadAndSetCurrentUserOrClear(y){var b=this;return(0,h.Z)(function*(){try{yield Is(y)}catch(x){if("auth/network-request-failed"!==x?.code)return b.directlySetCurrentUser(null)}return b.directlySetCurrentUser(y)})()}useDeviceLanguage(){this.languageCode=function yn(){if(typeof navigator>"u")return null;const R=navigator;return R.languages&&R.languages[0]||R.language||null}()}_delete(){var y=this;return(0,h.Z)(function*(){y._deleted=!0})()}updateCurrentUser(y){var b=this;return(0,h.Z)(function*(){const x=y?(0,X.m9)(y):null;return x&&Xe(x.auth.config.apiKey===b.config.apiKey,b,"invalid-user-token"),b._updateCurrentUser(x&&x._clone(b))})()}_updateCurrentUser(y,b=!1){var x=this;return(0,h.Z)(function*(){if(!x._deleted)return y&&Xe(x.tenantId===y.tenantId,x,"tenant-id-mismatch"),b||(yield x.beforeStateQueue.runMiddleware(y)),x.queue((0,h.Z)(function*(){yield x.directlySetCurrentUser(y),x.notifyAuthListeners()}))})()}signOut(){var y=this;return(0,h.Z)(function*(){return yield y.beforeStateQueue.runMiddleware(null),(y.redirectPersistenceManager||y._popupRedirectResolver)&&(yield y._setRedirectUser(null)),y._updateCurrentUser(null,!0)})()}setPersistence(y){var b=this;return this.queue((0,h.Z)(function*(){yield b.assertedPersistence.setPersistence(lo(y))}))}initializeRecaptchaConfig(){var y=this;return(0,h.Z)(function*(){const b=yield da(y,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),x=new xu(b);null==y.tenantId?y._agentRecaptchaConfig=x:y._tenantRecaptchaConfigs[y.tenantId]=x,x.emailPasswordEnabled&&new Ga(y).verify()})()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(y){this._errorFactory=new X.LL("auth","Firebase",y())}onAuthStateChanged(y,b,x){return this.registerStateListener(this.authStateSubscription,y,b,x)}beforeAuthStateChanged(y,b){return this.beforeStateQueue.pushCallback(y,b)}onIdTokenChanged(y,b,x){return this.registerStateListener(this.idTokenSubscription,y,b,x)}toJSON(){var y;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(y=this._currentUser)||void 0===y?void 0:y.toJSON()}}_setRedirectUser(y,b){var x=this;return(0,h.Z)(function*(){const O=yield x.getOrInitRedirectPersistenceManager(b);return null===y?O.removeCurrentUser():O.setCurrentUser(y)})()}getOrInitRedirectPersistenceManager(y){var b=this;return(0,h.Z)(function*(){if(!b.redirectPersistenceManager){const x=y&&lo(y)||b._popupRedirectResolver;Xe(x,b,"argument-error"),b.redirectPersistenceManager=yield gc.create(b,[lo(x._redirectPersistence)],"redirectUser"),b.redirectUser=yield b.redirectPersistenceManager.getCurrentUser()}return b.redirectPersistenceManager})()}_redirectUserForId(y){var b=this;return(0,h.Z)(function*(){var x,O;return b._isInitialized&&(yield b.queue((0,h.Z)(function*(){}))),(null===(x=b._currentUser)||void 0===x?void 0:x._redirectEventId)===y?b._currentUser:(null===(O=b.redirectUser)||void 0===O?void 0:O._redirectEventId)===y?b.redirectUser:null})()}_persistUserIfCurrent(y){var b=this;return(0,h.Z)(function*(){if(y===b.currentUser)return b.queue((0,h.Z)(function*(){return b.directlySetCurrentUser(y)}))})()}_notifyListenersIfCurrent(y){y===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var y,b;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const x=null!==(b=null===(y=this.currentUser)||void 0===y?void 0:y.uid)&&void 0!==b?b:null;this.lastNotifiedUid!==x&&(this.lastNotifiedUid=x,this.authStateSubscription.next(this.currentUser))}registerStateListener(y,b,x,O){if(this._deleted)return()=>{};const F="function"==typeof b?b:b.next.bind(b),q=this._isInitialized?Promise.resolve():this._initializationPromise;return Xe(q,this,"internal-error"),q.then(()=>F(this.currentUser)),"function"==typeof b?y.addObserver(b,x,O):y.addObserver(b)}directlySetCurrentUser(y){var b=this;return(0,h.Z)(function*(){b.currentUser&&b.currentUser!==y&&b._currentUser._stopProactiveRefresh(),y&&b.isProactiveRefreshEnabled&&y._startProactiveRefresh(),b.currentUser=y,y?yield b.assertedPersistence.setCurrentUser(y):yield b.assertedPersistence.removeCurrentUser()})()}queue(y){return this.operations=this.operations.then(y,y),this.operations}get assertedPersistence(){return Xe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(y){!y||this.frameworks.includes(y)||(this.frameworks.push(y),this.frameworks.sort(),this.clientVersion=Qf(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var y=this;return(0,h.Z)(function*(){var b;const x={"X-Client-Version":y.clientVersion};y.app.options.appId&&(x["X-Firebase-gmpid"]=y.app.options.appId);const O=yield null===(b=y.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===b?void 0:b.getHeartbeatsHeader();O&&(x["X-Firebase-Client"]=O);const F=yield y._getAppCheckToken();return F&&(x["X-Firebase-AppCheck"]=F),x})()}_getAppCheckToken(){var y=this;return(0,h.Z)(function*(){var b;const x=yield null===(b=y.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===b?void 0:b.getToken();return x?.error&&function Qe(R,...y){fe.logLevel<=ye.in.WARN&&fe.warn(`Auth (${V.SDK_VERSION}): ${R}`,...y)}(`Error while retrieving App Check token: ${x.error}`),x?.token})()}}function In(R){return(0,X.m9)(R)}class Il{constructor(y){this.auth=y,this.observer=null,this.addObserver=(0,X.ne)(b=>this.observer=b)}get next(){return Xe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function kd(R,y,b){const x=In(R);Xe(x._canInitEmulator,x,"emulator-config-failed"),Xe(/^https?:\/\//.test(y),x,"invalid-emulator-scheme");const O=!!b?.disableWarnings,F=Iu(y),{host:q,port:re}=function jr(R){const y=Iu(R),b=/(\/\/)?([^?#/]+)/.exec(R.substr(y.length));if(!b)return{host:"",port:null};const x=b[2].split("@").pop()||"",O=/^(\[[^\]]+\])(:|$)/.exec(x);if(O){const F=O[1];return{host:F,port:sr(x.substr(F.length+1))}}{const[F,q]=x.split(":");return{host:F,port:sr(q)}}}(y);x.config.emulator={url:`${F}//${q}${null===re?"":`:${re}`}/`},x.settings.appVerificationDisabledForTesting=!0,x.emulatorConfig=Object.freeze({host:q,port:re,protocol:F.replace(":",""),options:Object.freeze({disableWarnings:O})}),O||function Md(){function R(){const y=document.createElement("p"),b=y.style;y.innerText="Running in emulator mode. Do not use with production credentials.",b.position="fixed",b.width="100%",b.backgroundColor="#ffffff",b.border=".1em solid #000000",b.color="#b50000",b.bottom="0px",b.left="0px",b.margin="0px",b.zIndex="10000",b.textAlign="center",y.classList.add("firebase-emulator-warning"),document.body.appendChild(y)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",R):R())}()}function Iu(R){const y=R.indexOf(":");return y<0?"":R.substr(0,y+1)}function sr(R){if(!R)return null;const y=Number(R);return isNaN(y)?null:y}class Cs{constructor(y,b){this.providerId=y,this.signInMethod=b}toJSON(){return ei("not implemented")}_getIdTokenResponse(y){return ei("not implemented")}_linkToIdToken(y,b){return ei("not implemented")}_getReauthenticationResolver(y){return ei("not implemented")}}function Ld(R,y){return(Ye=Ye||(0,h.Z)(function*(b,x){return oi(b,"POST","/v1/accounts:resetPassword",hn(b,x))})).apply(this,arguments)}function Bo(R,y){return(He=He||(0,h.Z)(function*(b,x){return oi(b,"POST","/v1/accounts:update",x)})).apply(this,arguments)}function Wa(R,y){return(at=at||(0,h.Z)(function*(b,x){return en(b,"POST","/v1/accounts:signInWithPassword",hn(b,x))})).apply(this,arguments)}function nn(R,y){return(Je=Je||(0,h.Z)(function*(b,x){return oi(b,"POST","/v1/accounts:sendOobCode",hn(b,x))})).apply(this,arguments)}function Od(R,y){return(At=At||(0,h.Z)(function*(b,x){return nn(b,x)})).apply(this,arguments)}function xc(R,y){return(cn=cn||(0,h.Z)(function*(b,x){return nn(b,x)})).apply(this,arguments)}class Sl extends Cs{constructor(y,b,x,O=null){super("password",x),this._email=y,this._password=b,this._tenantId=O}static _fromEmailAndPassword(y,b){return new Sl(y,b,"password")}static _fromEmailAndCode(y,b,x=null){return new Sl(y,b,"emailLink",x)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(y){const b="string"==typeof y?JSON.parse(y):y;if(b?.email&&b?.password){if("password"===b.signInMethod)return this._fromEmailAndPassword(b.email,b.password);if("emailLink"===b.signInMethod)return this._fromEmailAndCode(b.email,b.password,b.tenantId)}return null}_getIdTokenResponse(y){var b=this;return(0,h.Z)(function*(){var x;switch(b.signInMethod){case"password":const F={returnSecureToken:!0,email:b._email,password:b._password,clientType:"CLIENT_TYPE_WEB"};if(null!==(x=y._getRecaptchaConfig())&&void 0!==x&&x.emailPasswordEnabled){const q=yield Pi(y,F,"signInWithPassword");return Wa(y,q)}var O;return Wa(y,F).catch(function(q){return(O=O||(0,h.Z)(function*(re){if("auth/missing-recaptcha-token"===re.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const me=yield Pi(y,F,"signInWithPassword");return Wa(y,me)}return Promise.reject(re)})).apply(this,arguments)});case"emailLink":return function Nd(R,y){return(_n=_n||(0,h.Z)(function*(b,x){return en(b,"POST","/v1/accounts:signInWithEmailLink",hn(b,x))})).apply(this,arguments)}(y,{email:b._email,oobCode:b._password});default:It(y,"internal-error")}})()}_linkToIdToken(y,b){var x=this;return(0,h.Z)(function*(){switch(x.signInMethod){case"password":return Bo(y,{idToken:b,returnSecureToken:!0,email:x._email,password:x._password});case"emailLink":return function Cu(R,y){return(Rt=Rt||(0,h.Z)(function*(b,x){return en(b,"POST","/v1/accounts:signInWithEmailLink",hn(b,x))})).apply(this,arguments)}(y,{idToken:b,email:x._email,oobCode:x._password});default:It(y,"internal-error")}})()}_getReauthenticationResolver(y){return this._getIdTokenResponse(y)}}function Ws(R,y){return(ro=ro||(0,h.Z)(function*(b,x){return en(b,"POST","/v1/accounts:signInWithIdp",hn(b,x))})).apply(this,arguments)}class fn extends Cs{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(y){const b=new fn(y.providerId,y.signInMethod);return y.idToken||y.accessToken?(y.idToken&&(b.idToken=y.idToken),y.accessToken&&(b.accessToken=y.accessToken),y.nonce&&!y.pendingToken&&(b.nonce=y.nonce),y.pendingToken&&(b.pendingToken=y.pendingToken)):y.oauthToken&&y.oauthTokenSecret?(b.accessToken=y.oauthToken,b.secret=y.oauthTokenSecret):It("argument-error"),b}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(y){const b="string"==typeof y?JSON.parse(y):y,{providerId:x,signInMethod:O}=b,F=(0,de._T)(b,["providerId","signInMethod"]);if(!x||!O)return null;const q=new fn(x,O);return q.idToken=F.idToken||void 0,q.accessToken=F.accessToken||void 0,q.secret=F.secret,q.nonce=F.nonce,q.pendingToken=F.pendingToken||null,q}_getIdTokenResponse(y){return Ws(y,this.buildRequest())}_linkToIdToken(y,b){const x=this.buildRequest();return x.idToken=b,Ws(y,x)}_getReauthenticationResolver(y){const b=this.buildRequest();return b.autoCreate=!1,Ws(y,b)}buildRequest(){const y={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)y.pendingToken=this.pendingToken;else{const b={};this.idToken&&(b.id_token=this.idToken),this.accessToken&&(b.access_token=this.accessToken),this.secret&&(b.oauth_token_secret=this.secret),b.providerId=this.providerId,this.nonce&&!this.pendingToken&&(b.nonce=this.nonce),y.postBody=(0,X.xO)(b)}return y}}const Ud={USER_NOT_FOUND:"user-not-found"};class ar extends Cs{constructor(y){super("phone","phone"),this.params=y}static _fromVerification(y,b){return new ar({verificationId:y,verificationCode:b})}static _fromTokenResponse(y,b){return new ar({phoneNumber:y,temporaryProof:b})}_getIdTokenResponse(y){return function Bd(R,y){return(ts=ts||(0,h.Z)(function*(b,x){return en(b,"POST","/v1/accounts:signInWithPhoneNumber",hn(b,x))})).apply(this,arguments)}(y,this._makeVerificationRequest())}_linkToIdToken(y,b){return function or(R,y){return(Hs=Hs||(0,h.Z)(function*(b,x){const O=yield en(b,"POST","/v1/accounts:signInWithPhoneNumber",hn(b,x));if(O.temporaryProof)throw Po(b,"account-exists-with-different-credential",O);return O})).apply(this,arguments)}(y,Object.assign({idToken:b},this._makeVerificationRequest()))}_getReauthenticationResolver(y){return function Cl(R,y){return(_e=_e||(0,h.Z)(function*(b,x){return en(b,"POST","/v1/accounts:signInWithPhoneNumber",hn(b,Object.assign(Object.assign({},x),{operation:"REAUTH"})),Ud)})).apply(this,arguments)}(y,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:y,phoneNumber:b,verificationId:x,verificationCode:O}=this.params;return y&&b?{temporaryProof:y,phoneNumber:b}:{sessionInfo:x,code:O}}toJSON(){const y={providerId:this.providerId};return this.params.phoneNumber&&(y.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(y.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(y.verificationCode=this.params.verificationCode),this.params.verificationId&&(y.verificationId=this.params.verificationId),y}static fromJSON(y){"string"==typeof y&&(y=JSON.parse(y));const{verificationId:b,verificationCode:x,phoneNumber:O,temporaryProof:F}=y;return x||b||O||F?new ar({verificationId:b,verificationCode:x,phoneNumber:O,temporaryProof:F}):null}}class Dl{constructor(y){var b,x,O,F,q,re;const me=(0,X.zd)((0,X.pd)(y)),Fe=null!==(b=me.apiKey)&&void 0!==b?b:null,Ht=null!==(x=me.oobCode)&&void 0!==x?x:null,kt=function Du(R){switch(R){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(O=me.mode)&&void 0!==O?O:null);Xe(Fe&&Ht&&kt,"argument-error"),this.apiKey=Fe,this.operation=kt,this.code=Ht,this.continueUrl=null!==(F=me.continueUrl)&&void 0!==F?F:null,this.languageCode=null!==(q=me.languageCode)&&void 0!==q?q:null,this.tenantId=null!==(re=me.tenantId)&&void 0!==re?re:null}static parseLink(y){const b=function Au(R){const y=(0,X.zd)((0,X.pd)(R)).link,b=y?(0,X.zd)((0,X.pd)(y)).deep_link_id:null,x=(0,X.zd)((0,X.pd)(R)).deep_link_id;return(x?(0,X.zd)((0,X.pd)(x)).link:null)||x||b||y||R}(y);try{return new Dl(b)}catch{return null}}}let Al=(()=>{class R{constructor(){this.providerId=R.PROVIDER_ID}static credential(b,x){return Sl._fromEmailAndPassword(b,x)}static credentialWithLink(b,x){const O=Dl.parseLink(x);return Xe(O,"argument-error"),Sl._fromEmailAndCode(b,O.code,O.tenantId)}}return R.PROVIDER_ID="password",R.EMAIL_PASSWORD_SIGN_IN_METHOD="password",R.EMAIL_LINK_SIGN_IN_METHOD="emailLink",R})();class fi{constructor(y){this.providerId=y,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(y){this.defaultLanguageCode=y}setCustomParameters(y){return this.customParameters=y,this}getCustomParameters(){return this.customParameters}}class _r extends fi{constructor(){super(...arguments),this.scopes=[]}addScope(y){return this.scopes.includes(y)||this.scopes.push(y),this}getScopes(){return[...this.scopes]}}class Ds extends _r{static credentialFromJSON(y){const b="string"==typeof y?JSON.parse(y):y;return Xe("providerId"in b&&"signInMethod"in b,"argument-error"),fn._fromParams(b)}credential(y){return this._credential(Object.assign(Object.assign({},y),{nonce:y.rawNonce}))}_credential(y){return Xe(y.idToken||y.accessToken,"argument-error"),fn._fromParams(Object.assign(Object.assign({},y),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(y){return Ds.oauthCredentialFromTaggedObject(y)}static credentialFromError(y){return Ds.oauthCredentialFromTaggedObject(y.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:y}){if(!y)return null;const{oauthIdToken:b,oauthAccessToken:x,oauthTokenSecret:O,pendingToken:F,nonce:q,providerId:re}=y;if(!x&&!O&&!b&&!F||!re)return null;try{return new Ds(re)._credential({idToken:b,accessToken:x,nonce:q,pendingToken:F})}catch{return null}}}let Rl=(()=>{class R extends _r{constructor(){super("facebook.com")}static credential(b){return fn._fromParams({providerId:R.PROVIDER_ID,signInMethod:R.FACEBOOK_SIGN_IN_METHOD,accessToken:b})}static credentialFromResult(b){return R.credentialFromTaggedObject(b)}static credentialFromError(b){return R.credentialFromTaggedObject(b.customData||{})}static credentialFromTaggedObject({_tokenResponse:b}){if(!b||!("oauthAccessToken"in b)||!b.oauthAccessToken)return null;try{return R.credential(b.oauthAccessToken)}catch{return null}}}return R.FACEBOOK_SIGN_IN_METHOD="facebook.com",R.PROVIDER_ID="facebook.com",R})(),co=(()=>{class R extends _r{constructor(){super("google.com"),this.addScope("profile")}static credential(b,x){return fn._fromParams({providerId:R.PROVIDER_ID,signInMethod:R.GOOGLE_SIGN_IN_METHOD,idToken:b,accessToken:x})}static credentialFromResult(b){return R.credentialFromTaggedObject(b)}static credentialFromError(b){return R.credentialFromTaggedObject(b.customData||{})}static credentialFromTaggedObject({_tokenResponse:b}){if(!b)return null;const{oauthIdToken:x,oauthAccessToken:O}=b;if(!x&&!O)return null;try{return R.credential(x,O)}catch{return null}}}return R.GOOGLE_SIGN_IN_METHOD="google.com",R.PROVIDER_ID="google.com",R})(),Vd=(()=>{class R extends _r{constructor(){super("github.com")}static credential(b){return fn._fromParams({providerId:R.PROVIDER_ID,signInMethod:R.GITHUB_SIGN_IN_METHOD,accessToken:b})}static credentialFromResult(b){return R.credentialFromTaggedObject(b)}static credentialFromError(b){return R.credentialFromTaggedObject(b.customData||{})}static credentialFromTaggedObject({_tokenResponse:b}){if(!b||!("oauthAccessToken"in b)||!b.oauthAccessToken)return null;try{return R.credential(b.oauthAccessToken)}catch{return null}}}return R.GITHUB_SIGN_IN_METHOD="github.com",R.PROVIDER_ID="github.com",R})();class kl extends Cs{constructor(y,b){super(y,y),this.pendingToken=b}_getIdTokenResponse(y){return Ws(y,this.buildRequest())}_linkToIdToken(y,b){const x=this.buildRequest();return x.idToken=b,Ws(y,x)}_getReauthenticationResolver(y){const b=this.buildRequest();return b.autoCreate=!1,Ws(y,b)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(y){const b="string"==typeof y?JSON.parse(y):y,{providerId:x,signInMethod:O,pendingToken:F}=b;return x&&O&&F&&x===O?new kl(x,F):null}static _create(y,b){return new kl(y,b)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class As extends fi{constructor(y){Xe(y.startsWith("saml."),"argument-error"),super(y)}static credentialFromResult(y){return As.samlCredentialFromTaggedObject(y)}static credentialFromError(y){return As.samlCredentialFromTaggedObject(y.customData||{})}static credentialFromJSON(y){const b=kl.fromJSON(y);return Xe(b,"argument-error"),b}static samlCredentialFromTaggedObject({_tokenResponse:y}){if(!y)return null;const{pendingToken:b,providerId:x}=y;if(!b||!x)return null;try{return kl._create(x,b)}catch{return null}}}let as=(()=>{class R extends _r{constructor(){super("twitter.com")}static credential(b,x){return fn._fromParams({providerId:R.PROVIDER_ID,signInMethod:R.TWITTER_SIGN_IN_METHOD,oauthToken:b,oauthTokenSecret:x})}static credentialFromResult(b){return R.credentialFromTaggedObject(b)}static credentialFromError(b){return R.credentialFromTaggedObject(b.customData||{})}static credentialFromTaggedObject({_tokenResponse:b}){if(!b)return null;const{oauthAccessToken:x,oauthTokenSecret:O}=b;if(!x||!O)return null;try{return R.credential(x,O)}catch{return null}}}return R.TWITTER_SIGN_IN_METHOD="twitter.com",R.PROVIDER_ID="twitter.com",R})();function Tc(R,y){return(Ee=Ee||(0,h.Z)(function*(b,x){return en(b,"POST","/v1/accounts:signUp",hn(b,x))})).apply(this,arguments)}class Cr{constructor(y){this.user=y.user,this.providerId=y.providerId,this._tokenResponse=y._tokenResponse,this.operationType=y.operationType}static _fromIdTokenResponse(y,b,x,O=!1){return(0,h.Z)(function*(){const F=yield zs._fromIdTokenResponse(y,x,O),q=rm(x);return new Cr({user:F,providerId:q,_tokenResponse:x,operationType:b})})()}static _forOperation(y,b,x){return(0,h.Z)(function*(){yield y._updateTokensIfNecessary(x,!0);const O=rm(x);return new Cr({user:y,providerId:O,_tokenResponse:x,operationType:b})})()}}function rm(R){return R.providerId?R.providerId:"phoneNumber"in R?"phone":null}function $d(R){return(Ie=Ie||(0,h.Z)(function*(y){var b;const x=In(y);if(yield x._initializationPromise,null!==(b=x.currentUser)&&void 0!==b&&b.isAnonymous)return new Cr({user:x.currentUser,providerId:null,operationType:"signIn"});const O=yield Tc(x,{returnSecureToken:!0}),F=yield Cr._fromIdTokenResponse(x,"signIn",O,!0);return yield x._updateCurrentUser(F.user),F})).apply(this,arguments)}class Ml extends X.ZR{constructor(y,b,x,O){var F;super(b.code,b.message),this.operationType=x,this.user=O,Object.setPrototypeOf(this,Ml.prototype),this.customData={appName:y.name,tenantId:null!==(F=y.tenantId)&&void 0!==F?F:void 0,_serverResponse:b.customData._serverResponse,operationType:x}}static _fromErrorAndOperation(y,b,x,O){return new Ml(y,b,x,O)}}function Hd(R,y,b,x){return("reauthenticate"===y?b._getReauthenticationResolver(R):b._getIdTokenResponse(R)).catch(F=>{throw"auth/multi-factor-auth-required"===F.code?Ml._fromErrorAndOperation(R,F,y,x):F})}function jd(R){return new Set(R.map(({providerId:y})=>y).filter(y=>!!y))}function sm(R,y){return(pe=pe||(0,h.Z)(function*(b,x){const O=(0,X.m9)(b);yield ha(!0,O,x);const{providerUserInfo:F}=yield function rr(R,y){return(J=J||(0,h.Z)(function*(b,x){return oi(b,"POST","/v1/accounts:update",x)})).apply(this,arguments)}(O.auth,{idToken:yield O.getIdToken(),deleteProvider:[x]}),q=jd(F||[]);return O.providerData=O.providerData.filter(re=>q.has(re.providerId)),q.has("phone")||(O.phoneNumber=null),yield O.auth._persistUserIfCurrent(O),O})).apply(this,arguments)}function uo(R,y){return(it=it||(0,h.Z)(function*(b,x,O=!1){const F=yield Ts(b,x._linkToIdToken(b.auth,yield b.getIdToken()),O);return Cr._forOperation(b,"link",F)})).apply(this,arguments)}function ha(R,y,b){return(Ze=Ze||(0,h.Z)(function*(x,O,F){yield Is(O);const re=!1===x?"provider-already-linked":"no-such-provider";Xe(jd(O.providerData).has(F)===x,O.auth,re)})).apply(this,arguments)}function Ic(R,y){return(jt=jt||(0,h.Z)(function*(b,x,O=!1){const{auth:F}=b,q="reauthenticate";try{const re=yield Ts(b,Hd(F,q,x,b),O);Xe(re.idToken,F,"internal-error");const me=ti(re.idToken);Xe(me,F,"internal-error");const{sub:Fe}=me;return Xe(b.uid===Fe,F,"user-mismatch"),Cr._forOperation(b,q,re)}catch(re){throw"auth/user-not-found"===re?.code&&It(F,"user-mismatch"),re}})).apply(this,arguments)}function Gd(R,y){return(Dt=Dt||(0,h.Z)(function*(b,x,O=!1){const F="signIn",q=yield Hd(b,F,x),re=yield Cr._fromIdTokenResponse(b,F,q);return O||(yield b._updateCurrentUser(re.user)),re})).apply(this,arguments)}function Si(R,y){return(ci=ci||(0,h.Z)(function*(b,x){return Gd(In(b),x)})).apply(this,arguments)}function Uo(R,y){return(Vt=Vt||(0,h.Z)(function*(b,x){const O=(0,X.m9)(b);return yield ha(!1,O,x.providerId),uo(O,x)})).apply(this,arguments)}function ai(R,y){return(Tn=Tn||(0,h.Z)(function*(b,x){return Ic((0,X.m9)(b),x)})).apply(this,arguments)}function yr(R,y){return(Gn=Gn||(0,h.Z)(function*(b,x){const O=In(b),F=yield function om(R,y){return(si=si||(0,h.Z)(function*(b,x){return en(b,"POST","/v1/accounts:signInWithCustomToken",hn(b,x))})).apply(this,arguments)}(O,{token:x,returnSecureToken:!0}),q=yield Cr._fromIdTokenResponse(O,"signIn",F);return yield O._updateCurrentUser(q.user),q})).apply(this,arguments)}class Ll{constructor(y,b){this.factorId=y,this.uid=b.mfaEnrollmentId,this.enrollmentTime=new Date(b.enrolledAt).toUTCString(),this.displayName=b.displayName}static _fromServerResponse(y,b){return"phoneInfo"in b?zd._fromServerResponse(y,b):"totpInfo"in b?ku._fromServerResponse(y,b):It(y,"internal-error")}}class zd extends Ll{constructor(y){super("phone",y),this.phoneNumber=y.phoneInfo}static _fromServerResponse(y,b){return new zd(b)}}class ku extends Ll{constructor(y){super("totp",y)}static _fromServerResponse(y,b){return new ku(b)}}function fa(R,y,b){var x;Xe((null===(x=b.url)||void 0===x?void 0:x.length)>0,R,"invalid-continue-uri"),Xe(typeof b.dynamicLinkDomain>"u"||b.dynamicLinkDomain.length>0,R,"invalid-dynamic-link-domain"),y.continueUrl=b.url,y.dynamicLinkDomain=b.dynamicLinkDomain,y.canHandleCodeInApp=b.handleCodeInApp,b.iOS&&(Xe(b.iOS.bundleId.length>0,R,"missing-ios-bundle-id"),y.iOSBundleId=b.iOS.bundleId),b.android&&(Xe(b.android.packageName.length>0,R,"missing-android-pkg-name"),y.androidInstallApp=b.android.installApp,y.androidMinimumVersionCode=b.android.minimumVersion,y.androidPackageName=b.android.packageName)}function Ol(R,y,b){return(Mi=Mi||(0,h.Z)(function*(x,O,F){var q;const re=In(x),me={requestType:"PASSWORD_RESET",email:O,clientType:"CLIENT_TYPE_WEB"};if(null!==(q=re._getRecaptchaConfig())&&void 0!==q&&q.emailPasswordEnabled){const Ht=yield Pi(re,me,"getOobCode",!0);F&&fa(re,Ht,F),yield Od(re,Ht)}else{var Fe;F&&fa(re,me,F),yield Od(re,me).catch(function(Ht){return(Fe=Fe||(0,h.Z)(function*(kt){if("auth/missing-recaptcha-token"!==kt.code)return Promise.reject(kt);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const Wt=yield Pi(re,me,"getOobCode",!0);F&&fa(re,Wt,F),yield Od(re,Wt)}})).apply(this,arguments)})}})).apply(this,arguments)}function Sc(R,y,b){return(Li=Li||(0,h.Z)(function*(x,O,F){yield Ld((0,X.m9)(x),{oobCode:O,newPassword:F})})).apply(this,arguments)}function Mu(R,y){return(gi=gi||(0,h.Z)(function*(b,x){yield function Ec(R,y){return(je=je||(0,h.Z)(function*(b,x){return oi(b,"POST","/v1/accounts:update",hn(b,x))})).apply(this,arguments)}((0,X.m9)(b),{oobCode:x})})).apply(this,arguments)}function Cc(R,y){return(Oi=Oi||(0,h.Z)(function*(b,x){const O=(0,X.m9)(b),F=yield Ld(O,{oobCode:x}),q=F.requestType;switch(Xe(q,O,"internal-error"),q){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Xe(F.newEmail,O,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Xe(F.mfaInfo,O,"internal-error");default:Xe(F.email,O,"internal-error")}let re=null;return F.mfaInfo&&(re=Ll._fromServerResponse(In(O),F.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===F.requestType?F.newEmail:F.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===F.requestType?F.email:F.newEmail)||null,multiFactorInfo:re},operation:q}})).apply(this,arguments)}function Pl(R,y){return(tr=tr||(0,h.Z)(function*(b,x){const{data:O}=yield Cc((0,X.m9)(b),x);return O.email})).apply(this,arguments)}function Nl(R,y,b){return(bi=bi||(0,h.Z)(function*(x,O,F){var q;const re=In(x),me={returnSecureToken:!0,email:O,password:F,clientType:"CLIENT_TYPE_WEB"};let Fe;if(null!==(q=re._getRecaptchaConfig())&&void 0!==q&&q.emailPasswordEnabled){const Nn=yield Pi(re,me,"signUpPassword");Fe=Tc(re,Nn)}else{var Ht;Fe=Tc(re,me).catch(function(Nn){return(Ht=Ht||(0,h.Z)(function*(cr){if("auth/missing-recaptcha-token"===cr.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const Ls=yield Pi(re,me,"signUpPassword");return Tc(re,Ls)}return Promise.reject(cr)})).apply(this,arguments)})}const kt=yield Fe.catch(Nn=>Promise.reject(Nn)),Wt=yield Cr._fromIdTokenResponse(re,"signIn",kt);return yield re._updateCurrentUser(Wt.user),Wt})).apply(this,arguments)}function ma(R,y,b){return Si((0,X.m9)(R),Al.credential(y,b))}function Vo(R,y,b){return(Bt=Bt||(0,h.Z)(function*(x,O,F){var q;const re=In(x),me={requestType:"EMAIL_SIGNIN",email:O,clientType:"CLIENT_TYPE_WEB"};function Fe(kt,Wt){Xe(Wt.handleCodeInApp,re,"argument-error"),Wt&&fa(re,kt,Wt)}if(null!==(q=re._getRecaptchaConfig())&&void 0!==q&&q.emailPasswordEnabled){const kt=yield Pi(re,me,"getOobCode",!0);Fe(kt,F),yield xc(re,kt)}else{var Ht;Fe(me,F),yield xc(re,me).catch(function(kt){return(Ht=Ht||(0,h.Z)(function*(Wt){if("auth/missing-recaptcha-token"!==Wt.code)return Promise.reject(Wt);{console.log("Email link sign-in is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const Nn=yield Pi(re,me,"getOobCode",!0);Fe(Nn,F),yield xc(re,Nn)}})).apply(this,arguments)})}})).apply(this,arguments)}function am(R,y){return"EMAIL_SIGNIN"===Dl.parseLink(y)?.operation}function Wd(R,y,b){return(vs=vs||(0,h.Z)(function*(x,O,F){const q=(0,X.m9)(x),re=Al.credentialWithLink(O,F||oo());return Xe(re._tenantId===(q.tenantId||null),q,"tenant-id-mismatch"),Si(q,re)})).apply(this,arguments)}function mg(R,y){return(Pn=Pn||(0,h.Z)(function*(b,x){const F={identifier:x,continueUri:$a()?oo():"http://localhost"},{signinMethods:q}=yield function Lu(R,y){return(sa=sa||(0,h.Z)(function*(b,x){return oi(b,"POST","/v1/accounts:createAuthUri",hn(b,x))})).apply(this,arguments)}((0,X.m9)(b),F);return q||[]})).apply(this,arguments)}function lm(R,y){return($r=$r||(0,h.Z)(function*(b,x){const O=(0,X.m9)(b),q={requestType:"VERIFY_EMAIL",idToken:yield b.getIdToken()};x&&fa(O.auth,q,x);const{email:re}=yield function Su(R,y){return(wt=wt||(0,h.Z)(function*(b,x){return nn(b,x)})).apply(this,arguments)}(O.auth,q);re!==b.email&&(yield b.reload())})).apply(this,arguments)}function cm(R,y,b){return(Ii=Ii||(0,h.Z)(function*(x,O,F){const q=(0,X.m9)(x),me={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield x.getIdToken(),newEmail:O};F&&fa(q.auth,me,F);const{email:Fe}=yield function Pd(R,y){return(xt=xt||(0,h.Z)(function*(b,x){return nn(b,x)})).apply(this,arguments)}(q.auth,me);Fe!==x.email&&(yield x.reload())})).apply(this,arguments)}function Ou(R,y){return(Mn=Mn||(0,h.Z)(function*(b,{displayName:x,photoURL:O}){if(void 0===x&&void 0===O)return;const F=(0,X.m9)(b),re={idToken:yield F.getIdToken(),displayName:x,photoUrl:O,returnSecureToken:!0},me=yield Ts(F,function Dc(R,y){return(ni=ni||(0,h.Z)(function*(b,x){return oi(b,"POST","/v1/accounts:update",x)})).apply(this,arguments)}(F.auth,re));F.displayName=me.displayName||null,F.photoURL=me.photoUrl||null;const Fe=F.providerData.find(({providerId:Ht})=>"password"===Ht);Fe&&(Fe.displayName=F.displayName,Fe.photoURL=F.photoURL),yield F._updateTokensIfNecessary(me)})).apply(this,arguments)}function Ka(R,y){return $o((0,X.m9)(R),y,null)}function Pu(R,y){return $o((0,X.m9)(R),null,y)}function $o(R,y,b){return(Gt=Gt||(0,h.Z)(function*(x,O,F){const{auth:q}=x,me={idToken:yield x.getIdToken(),returnSecureToken:!0};O&&(me.email=O),F&&(me.password=F);const Fe=yield Ts(x,Bo(q,me));yield x._updateTokensIfNecessary(Fe,!0)})).apply(this,arguments)}class ho{constructor(y,b,x={}){this.isNewUser=y,this.providerId=b,this.profile=x}}class Fl extends ho{constructor(y,b,x,O){super(y,b,x),this.username=O}}class Bl extends ho{constructor(y,b){super(y,"facebook.com",b)}}class um extends Fl{constructor(y,b){super(y,"github.com",b,"string"==typeof b?.login?b?.login:null)}}class Ac extends ho{constructor(y,b){super(y,"google.com",b)}}class Rc extends Fl{constructor(y,b,x){super(y,"twitter.com",b,x)}}function qa(R){const{user:y,_tokenResponse:b}=R;return y.isAnonymous&&!b?{providerId:null,isNewUser:!1,profile:null}:function pa(R){var y,b;if(!R)return null;const{providerId:x}=R,O=R.rawUserInfo?JSON.parse(R.rawUserInfo):{},F=R.isNewUser||"identitytoolkit#SignupNewUserResponse"===R.kind;if(!x&&R?.idToken){const q=null===(b=null===(y=ti(R.idToken))||void 0===y?void 0:y.firebase)||void 0===b?void 0:b.sign_in_provider;if(q)return new ho(F,"anonymous"!==q&&"custom"!==q?q:null)}if(!x)return null;switch(x){case"facebook.com":return new Bl(F,O);case"github.com":return new um(F,O);case"google.com":return new Ac(F,O);case"twitter.com":return new Rc(F,O,R.screenName||null);case"custom":case"anonymous":return new ho(F,null);default:return new ho(F,x,O)}}(b)}class Ho{constructor(y,b,x){this.type=y,this.credential=b,this.auth=x}static _fromIdtoken(y,b){return new Ho("enroll",y,b)}static _fromMfaPendingCredential(y){return new Ho("signin",y)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(y){var b,x;if(y?.multiFactorSession){if(null!==(b=y.multiFactorSession)&&void 0!==b&&b.pendingCredential)return Ho._fromMfaPendingCredential(y.multiFactorSession.pendingCredential);if(null!==(x=y.multiFactorSession)&&void 0!==x&&x.idToken)return Ho._fromIdtoken(y.multiFactorSession.idToken)}return null}}class jo{constructor(y,b,x){this.session=y,this.hints=b,this.signInResolver=x}static _fromError(y,b){var x;const O=In(y),F=b.customData._serverResponse,q=(F.mfaInfo||[]).map(me=>Ll._fromServerResponse(O,me));Xe(F.mfaPendingCredential,O,"internal-error");const re=Ho._fromMfaPendingCredential(F.mfaPendingCredential);return new jo(re,q,function(me){return(x=x||(0,h.Z)(function*(Fe){const Ht=yield Fe._process(O,re);delete F.mfaInfo,delete F.mfaPendingCredential;const kt=Object.assign(Object.assign({},F),{idToken:Ht.idToken,refreshToken:Ht.refreshToken});switch(b.operationType){case"signIn":const Wt=yield Cr._fromIdTokenResponse(O,b.operationType,kt);return yield O._updateCurrentUser(Wt.user),Wt;case"reauthenticate":return Xe(b.user,O,"internal-error"),Cr._forOperation(b.user,b.operationType,kt);default:It(O,"internal-error")}})).apply(this,arguments)})}resolveSignIn(y){var b=this;return(0,h.Z)(function*(){return b.signInResolver(y)})()}}function Bu(R,y){var b;const x=(0,X.m9)(R),O=y;return Xe(y.customData.operationType,x,"argument-error"),Xe(null===(b=O.customData._serverResponse)||void 0===b?void 0:b.mfaPendingCredential,x,"argument-error"),jo._fromError(x,O)}class fo{constructor(y){this.user=y,this.enrolledFactors=[],y._onReload(b=>{b.mfaInfo&&(this.enrolledFactors=b.mfaInfo.map(x=>Ll._fromServerResponse(y.auth,x)))})}static _fromUser(y){return new fo(y)}getSession(){var y=this;return(0,h.Z)(function*(){return Ho._fromIdtoken(yield y.user.getIdToken(),y.user.auth)})()}enroll(y,b){var x=this;return(0,h.Z)(function*(){const O=y,F=yield x.getSession(),q=yield Ts(x.user,O._process(x.user.auth,F,b));return yield x.user._updateTokensIfNecessary(q),x.user.reload()})()}unenroll(y){var b=this;return(0,h.Z)(function*(){const x="string"==typeof y?y:y.uid,O=yield b.user.getIdToken();try{const F=yield Ts(b.user,function Qd(R,y){return oi(R,"POST","/v2/accounts/mfaEnrollment:withdraw",hn(R,y))}(b.user.auth,{idToken:O,mfaEnrollmentId:x}));b.enrolledFactors=b.enrolledFactors.filter(({uid:q})=>q!==x),yield b.user._updateTokensIfNecessary(F),yield b.user.reload()}catch(F){throw F}})()}}const mo=new WeakMap;function fm(R){const y=(0,X.m9)(R);return mo.has(y)||mo.set(y,fo._fromUser(y)),mo.get(y)}const ga="__sak";class $u{constructor(y,b){this.storageRetriever=y,this.type=b}_isAvailable(){try{return this.storage?(this.storage.setItem(ga,"1"),this.storage.removeItem(ga),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(y,b){return this.storage.setItem(y,JSON.stringify(b)),Promise.resolve()}_get(y){const b=this.storage.getItem(y);return Promise.resolve(b?JSON.parse(b):null)}_remove(y){return this.storage.removeItem(y),Promise.resolve()}get storage(){return this.storageRetriever()}}const Jd=(()=>{class R extends $u{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(b,x)=>this.onStorageEvent(b,x),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function _a(){const R=(0,X.z$)();return Dd(R)||wu(R)}()&&function fg(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=Eu(),this._shouldAllowMigration=!0}forAllChangedKeys(b){for(const x of Object.keys(this.listeners)){const O=this.storage.getItem(x),F=this.localCache[x];O!==F&&b(x,F,O)}}onStorageEvent(b,x=!1){if(!b.key)return void this.forAllChangedKeys((re,me,Fe)=>{this.notifyListeners(re,Fe)});const O=b.key;if(x?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const re=this.storage.getItem(O);if(b.newValue!==re)null!==b.newValue?this.storage.setItem(O,b.newValue):this.storage.removeItem(O);else if(this.localCache[O]===b.newValue&&!x)return}const F=()=>{const re=this.storage.getItem(O);!x&&this.localCache[O]===re||this.notifyListeners(O,re)},q=this.storage.getItem(O);!function Fo(){return(0,X.w1)()&&10===document.documentMode}()||q===b.newValue||b.newValue===b.oldValue?F():setTimeout(F,10)}notifyListeners(b,x){this.localCache[b]=x;const O=this.listeners[b];if(O)for(const F of Array.from(O))F(x&&JSON.parse(x))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((b,x,O)=>{this.onStorageEvent(new StorageEvent("storage",{key:b,oldValue:x,newValue:O}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(b,x){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[b]||(this.listeners[b]=new Set,this.localCache[b]=this.storage.getItem(b)),this.listeners[b].add(x)}_removeListener(b,x){this.listeners[b]&&(this.listeners[b].delete(x),0===this.listeners[b].size&&delete this.listeners[b]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(b,x){var O=()=>super._set,F=this;return(0,h.Z)(function*(){yield O().call(F,b,x),F.localCache[b]=JSON.stringify(x)})()}_get(b){var x=()=>super._get,O=this;return(0,h.Z)(function*(){const F=yield x().call(O,b);return O.localCache[b]=JSON.stringify(F),F})()}_remove(b){var x=()=>super._remove,O=this;return(0,h.Z)(function*(){yield x().call(O,b),delete O.localCache[b]})()}}return R.type="LOCAL",R})(),Za=(()=>{class R extends $u{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(b,x){}_removeListener(b,x){}}return R.type="SESSION",R})();let po=(()=>{class R{constructor(b){this.eventTarget=b,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(b){const x=this.receivers.find(F=>F.isListeningto(b));if(x)return x;const O=new R(b);return this.receivers.push(O),O}isListeningto(b){return this.eventTarget===b}handleEvent(b){var x=this;return(0,h.Z)(function*(){var O;const F=b,{eventId:q,eventType:re,data:me}=F.data,Fe=x.handlersMap[re];if(!Fe?.size)return;F.ports[0].postMessage({status:"ack",eventId:q,eventType:re});const Ht=Array.from(Fe).map(function(Wt){return(O=O||(0,h.Z)(function*(Nn){return Nn(F.origin,me)})).apply(this,arguments)}),kt=yield function ya(R){var y;return Promise.all(R.map(function(b){return(y=y||(0,h.Z)(function*(x){try{return{fulfilled:!0,value:yield x}}catch(O){return{fulfilled:!1,reason:O}}})).apply(this,arguments)}))}(Ht);F.ports[0].postMessage({status:"done",eventId:q,eventType:re,response:kt})})()}_subscribe(b,x){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[b]||(this.handlersMap[b]=new Set),this.handlersMap[b].add(x)}_unsubscribe(b,x){this.handlersMap[b]&&x&&this.handlersMap[b].delete(x),(!x||0===this.handlersMap[b].size)&&delete this.handlersMap[b],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return R.receivers=[],R})();function ri(R="",y=10){let b="";for(let x=0;x<y;x++)b+=Math.floor(10*Math.random());return R+b}class th{constructor(y){this.target=y,this.handlers=new Set}removeMessageHandler(y){y.messageChannel&&(y.messageChannel.port1.removeEventListener("message",y.onMessage),y.messageChannel.port1.close()),this.handlers.delete(y)}_send(y,b,x=50){var O=this;return(0,h.Z)(function*(){const F=typeof MessageChannel<"u"?new MessageChannel:null;if(!F)throw new Error("connection_unavailable");let q,re;return new Promise((me,Fe)=>{const Ht=ri("",20);F.port1.start();const kt=setTimeout(()=>{Fe(new Error("unsupported_event"))},x);re={messageChannel:F,onMessage(Wt){const Nn=Wt;if(Nn.data.eventId===Ht)switch(Nn.data.status){case"ack":clearTimeout(kt),q=setTimeout(()=>{Fe(new Error("timeout"))},3e3);break;case"done":clearTimeout(q),me(Nn.data.response);break;default:clearTimeout(kt),clearTimeout(q),Fe(new Error("invalid_response"))}}},O.handlers.add(re),F.port1.addEventListener("message",re.onMessage),O.target.postMessage({eventType:y,eventId:Ht,data:b},[F.port2])}).finally(()=>{re&&O.removeMessageHandler(re)})})()}}function Dn(){return window}function Mc(){return typeof Dn().WorkerGlobalScope<"u"&&"function"==typeof Dn().importScripts}const mm="firebaseLocalStorageDb",ih=1,Lc="firebaseLocalStorage",gg="fbase_key";class ju{constructor(y){this.request=y}toPromise(){return new Promise((y,b)=>{this.request.addEventListener("success",()=>{y(this.request.result)}),this.request.addEventListener("error",()=>{b(this.request.error)})})}}function rh(R,y){return R.transaction([Lc],y?"readwrite":"readonly").objectStore(Lc)}function pm(){const R=indexedDB.open(mm,ih);return new Promise((y,b)=>{R.addEventListener("error",()=>{b(R.error)}),R.addEventListener("upgradeneeded",()=>{const x=R.result;try{x.createObjectStore(Lc,{keyPath:gg})}catch(O){b(O)}}),R.addEventListener("success",(0,h.Z)(function*(){const x=R.result;x.objectStoreNames.contains(Lc)?y(x):(x.close(),yield function Ul(){const R=indexedDB.deleteDatabase(mm);return new ju(R).toPromise()}(),y(yield pm()))}))})}function gm(R,y,b){return(ui=ui||(0,h.Z)(function*(x,O,F){const q=rh(x,!0).put({[gg]:O,value:F});return new ju(q).toPromise()})).apply(this,arguments)}function Gu(R,y){const b=rh(R,!0).delete(y);return new ju(b).toPromise()}const va=(()=>{class R{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var b=this;return(0,h.Z)(function*(){return b.db||(b.db=yield pm()),b.db})()}_withRetries(b){var x=this;return(0,h.Z)(function*(){let O=0;for(;;)try{const F=yield x._openDb();return yield b(F)}catch(F){if(O++>3)throw F;x.db&&(x.db.close(),x.db=void 0)}})()}initializeServiceWorkerMessaging(){var b=this;return(0,h.Z)(function*(){return Mc()?b.initializeReceiver():b.initializeSender()})()}initializeReceiver(){var b=this;return(0,h.Z)(function*(){var x,O;b.receiver=po._getInstance(function pg(){return Mc()?self:null}()),b.receiver._subscribe("keyChanged",function(F,q){return(x=x||(0,h.Z)(function*(re,me){return{keyProcessed:(yield b._poll()).includes(me.key)}})).apply(this,arguments)}),b.receiver._subscribe("ping",function(F,q){return(O=O||(0,h.Z)(function*(re,me){return["keyChanged"]})).apply(this,arguments)})})()}initializeSender(){var b=this;return(0,h.Z)(function*(){var x,O;if(b.activeServiceWorker=yield function nh(){return(nr=nr||(0,h.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}(),!b.activeServiceWorker)return;b.sender=new th(b.activeServiceWorker);const F=yield b.sender._send("ping",{},800);F&&null!==(x=F[0])&&void 0!==x&&x.fulfilled&&null!==(O=F[0])&&void 0!==O&&O.value.includes("keyChanged")&&(b.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(b){var x=this;return(0,h.Z)(function*(){if(x.sender&&x.activeServiceWorker&&function Ln(){var R;return(null===(R=navigator?.serviceWorker)||void 0===R?void 0:R.controller)||null}()===x.activeServiceWorker)try{yield x.sender._send("keyChanged",{key:b},x.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,h.Z)(function*(){try{if(!indexedDB)return!1;const b=yield pm();return yield gm(b,ga,"1"),yield Gu(b,ga),!0}catch{}return!1})()}_withPendingWrite(b){var x=this;return(0,h.Z)(function*(){x.pendingWrites++;try{yield b()}finally{x.pendingWrites--}})()}_set(b,x){var O=this;return(0,h.Z)(function*(){return O._withPendingWrite((0,h.Z)(function*(){return yield O._withRetries(F=>gm(F,b,x)),O.localCache[b]=x,O.notifyServiceWorker(b)}))})()}_get(b){var x=this;return(0,h.Z)(function*(){const O=yield x._withRetries(F=>function qi(R,y){return(wi=wi||(0,h.Z)(function*(b,x){const O=rh(b,!1).get(x),F=yield new ju(O).toPromise();return void 0===F?null:F.value})).apply(this,arguments)}(F,b));return x.localCache[b]=O,O})()}_remove(b){var x=this;return(0,h.Z)(function*(){return x._withPendingWrite((0,h.Z)(function*(){return yield x._withRetries(O=>Gu(O,b)),delete x.localCache[b],x.notifyServiceWorker(b)}))})()}_poll(){var b=this;return(0,h.Z)(function*(){const x=yield b._withRetries(q=>{const re=rh(q,!1).getAll();return new ju(re).toPromise()});if(!x)return[];if(0!==b.pendingWrites)return[];const O=[],F=new Set;for(const{fbase_key:q,value:re}of x)F.add(q),JSON.stringify(b.localCache[q])!==JSON.stringify(re)&&(b.notifyListeners(q,re),O.push(q));for(const q of Object.keys(b.localCache))b.localCache[q]&&!F.has(q)&&(b.notifyListeners(q,null),O.push(q));return O})()}notifyListeners(b,x){this.localCache[b]=x;const O=this.listeners[b];if(O)for(const F of Array.from(O))F(x)}startPolling(){var b=this;this.stopPolling(),this.pollTimer=setInterval((0,h.Z)(function*(){return b._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(b,x){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[b]||(this.listeners[b]=new Set,this._get(b)),this.listeners[b].add(x)}_removeListener(b,x){this.listeners[b]&&(this.listeners[b].delete(x),0===this.listeners[b].size&&delete this.listeners[b]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return R.type="LOCAL",R})(),Nc=1e12;class ym{constructor(y){this.auth=y,this.counter=Nc,this._widgets=new Map}render(y,b){const x=this.counter;return this._widgets.set(x,new cs(y,this.auth.name,b||{})),this.counter++,x}reset(y){var b;const x=y||Nc;null===(b=this._widgets.get(x))||void 0===b||b.delete(),this._widgets.delete(x)}getResponse(y){var b;return(null===(b=this._widgets.get(y||Nc))||void 0===b?void 0:b.getResponse())||""}execute(y){var b=this;return(0,h.Z)(function*(){var x;return null===(x=b._widgets.get(y||Nc))||void 0===x||x.execute(),""})()}}class cs{constructor(y,b,x){this.params=x,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const O="string"==typeof y?document.getElementById(y):y;Xe(O,"argument-error",{appName:b}),this.container=O,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Wn(R){const y=[],b="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let x=0;x<R;x++)y.push(b.charAt(Math.floor(Math.random()*b.length)));return y.join("")}(50);const{callback:y,"expired-callback":b}=this.params;if(y)try{y(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,b)try{b()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Fr=vc("rcb"),Ct=new ii(3e4,6e4);class us{constructor(){var y;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(y=Dn().grecaptcha)||void 0===y||!y.render)}load(y,b=""){return Xe(function vm(R){return R.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(R)}(b),y,"argument-error"),this.shouldResolveImmediately(b)&&Jf(Dn().grecaptcha)?Promise.resolve(Dn().grecaptcha):new Promise((x,O)=>{const F=Dn().setTimeout(()=>{O($t(y,"network-request-failed"))},Ct.get());Dn()[Fr]=()=>{Dn().clearTimeout(F),delete Dn()[Fr];const re=Dn().grecaptcha;if(!re||!Jf(re))return void O($t(y,"internal-error"));const me=re.render;re.render=(Fe,Ht)=>{const kt=me(Fe,Ht);return this.counter++,kt},this.hostLanguage=b,x(re)},Tl(`https://www.google.com/recaptcha/api.js??${(0,X.xO)({onload:Fr,render:"explicit",hl:b})}`).catch(()=>{clearTimeout(F),O($t(y,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(y){var b;return!(null===(b=Dn().grecaptcha)||void 0===b||!b.render)&&(y===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Gr{load(y){return(0,h.Z)(function*(){return new ym(y)})()}clearedOneInstance(){}}const lr="recaptcha",ah={theme:"light",type:"image"};class Fc{constructor(y,b=Object.assign({},ah),x){this.parameters=b,this.type=lr,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=In(x),this.isInvisible="invisible"===this.parameters.size,Xe(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const O="string"==typeof y?document.getElementById(y):y;Xe(O,this.auth,"argument-error"),this.container=O,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Gr:new us,this.validateStartingState()}verify(){var y=this;return(0,h.Z)(function*(){y.assertNotDestroyed();const b=yield y.render(),x=y.getAssertedRecaptcha();return x.getResponse(b)||new Promise(F=>{const q=re=>{re&&(y.tokenChangeListeners.delete(q),F(re))};y.tokenChangeListeners.add(q),y.isInvisible&&x.execute(b)})})()}render(){try{this.assertNotDestroyed()}catch(y){return Promise.reject(y)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(y=>{throw this.renderPromise=null,y})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(y=>{this.container.removeChild(y)})}validateStartingState(){Xe(!this.parameters.sitekey,this.auth,"argument-error"),Xe(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Xe(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(y){return b=>{if(this.tokenChangeListeners.forEach(x=>x(b)),"function"==typeof y)y(b);else if("string"==typeof y){const x=Dn()[y];"function"==typeof x&&x(b)}}}assertNotDestroyed(){Xe(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var y=this;return(0,h.Z)(function*(){if(yield y.init(),!y.widgetId){let b=y.container;if(!y.isInvisible){const x=document.createElement("div");b.appendChild(x),b=x}y.widgetId=y.getAssertedRecaptcha().render(b,y.parameters)}return y.widgetId})()}init(){var y=this;return(0,h.Z)(function*(){Xe($a()&&!Mc(),y.auth,"internal-error"),yield function Bc(){let R=null;return new Promise(y=>{"complete"!==document.readyState?(R=()=>y(),window.addEventListener("load",R)):y()}).catch(y=>{throw R&&window.removeEventListener("load",R),y})}(),y.recaptcha=yield y._recaptchaLoader.load(y.auth,y.auth.languageCode||void 0);const b=yield function Xf(R){return(ze=ze||(0,h.Z)(function*(y){return(yield oi(y,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}(y.auth);Xe(b,y.auth,"internal-error"),y.parameters.sitekey=b})()}getAssertedRecaptcha(){return Xe(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class ba{constructor(y,b){this.verificationId=y,this.onConfirmation=b}confirm(y){const b=ar._fromVerification(this.verificationId,y);return this.onConfirmation(b)}}function zr(R,y,b){return(mr=mr||(0,h.Z)(function*(x,O,F){const q=In(x),re=yield bt(q,O,(0,X.m9)(F));return new ba(re,me=>Si(q,me))})).apply(this,arguments)}function wa(R,y,b){return(zi=zi||(0,h.Z)(function*(x,O,F){const q=(0,X.m9)(x);yield ha(!1,q,"phone");const re=yield bt(q.auth,O,(0,X.m9)(F));return new ba(re,me=>Uo(q,me))})).apply(this,arguments)}function $l(R,y,b){return(oa=oa||(0,h.Z)(function*(x,O,F){const q=(0,X.m9)(x),re=yield bt(q.auth,O,(0,X.m9)(F));return new ba(re,me=>ai(q,me))})).apply(this,arguments)}function bt(R,y,b){return(zn=zn||(0,h.Z)(function*(x,O,F){var q;const re=yield F.verify();try{let me;if(Xe("string"==typeof re,x,"argument-error"),Xe(F.type===lr,x,"argument-error"),me="string"==typeof O?{phoneNumber:O}:O,"session"in me){const Fe=me.session;if("phoneNumber"in me)return Xe("enroll"===Fe.type,x,"internal-error"),(yield function Uu(R,y){return oi(R,"POST","/v2/accounts/mfaEnrollment:start",hn(R,y))}(x,{idToken:Fe.credential,phoneEnrollmentInfo:{phoneNumber:me.phoneNumber,recaptchaToken:re}})).phoneSessionInfo.sessionInfo;{Xe("signin"===Fe.type,x,"internal-error");const Ht=(null===(q=me.multiFactorHint)||void 0===q?void 0:q.uid)||me.multiFactorUid;return Xe(Ht,x,"missing-multi-factor-info"),(yield function _m(R,y){return oi(R,"POST","/v2/accounts/mfaSignIn:start",hn(R,y))}(x,{mfaPendingCredential:Fe.credential,mfaEnrollmentId:Ht,phoneSignInInfo:{recaptchaToken:re}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:Fe}=yield function Fd(R,y){return(es=es||(0,h.Z)(function*(b,x){return oi(b,"POST","/v1/accounts:sendVerificationCode",hn(b,x))})).apply(this,arguments)}(x,{phoneNumber:me.phoneNumber,recaptchaToken:re});return Fe}}finally{F._reset()}})).apply(this,arguments)}function bm(R,y){return(di=di||(0,h.Z)(function*(b,x){yield uo((0,X.m9)(b),x)})).apply(this,arguments)}let wm=(()=>{class R{constructor(b){this.providerId=R.PROVIDER_ID,this.auth=In(b)}verifyPhoneNumber(b,x){return bt(this.auth,b,(0,X.m9)(x))}static credential(b,x){return ar._fromVerification(b,x)}static credentialFromResult(b){return R.credentialFromTaggedObject(b)}static credentialFromError(b){return R.credentialFromTaggedObject(b.customData||{})}static credentialFromTaggedObject({_tokenResponse:b}){if(!b)return null;const{phoneNumber:x,temporaryProof:O}=b;return x&&O?ar._fromTokenResponse(x,O):null}}return R.PROVIDER_ID="phone",R.PHONE_SIGN_IN_METHOD="phone",R})();function Wr(R,y){return y?lo(y):(Xe(R._popupRedirectResolver,R,"argument-error"),R._popupRedirectResolver)}class Ea extends Cs{constructor(y){super("custom","custom"),this.params=y}_getIdTokenResponse(y){return Ws(y,this._buildIdpRequest())}_linkToIdToken(y,b){return Ws(y,this._buildIdpRequest(b))}_getReauthenticationResolver(y){return Ws(y,this._buildIdpRequest())}_buildIdpRequest(y){const b={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return y&&(b.idToken=y),b}}function Ci(R){return Gd(R.auth,new Ea(R),R.bypassAuthState)}function yg(R){const{auth:y,user:b}=R;return Xe(b,y,"internal-error"),Ic(b,new Ea(R),R.bypassAuthState)}function lh(R){return(sn=sn||(0,h.Z)(function*(y){const{auth:b,user:x}=y;return Xe(x,b,"internal-error"),uo(x,new Ea(y),y.bypassAuthState)})).apply(this,arguments)}class Xa{constructor(y,b,x,O,F=!1){this.auth=y,this.resolver=x,this.user=O,this.bypassAuthState=F,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(b)?b:[b]}execute(){var b,y=this;return new Promise(function(x,O){return(b=b||(0,h.Z)(function*(F,q){y.pendingPromise={resolve:F,reject:q};try{y.eventManager=yield y.resolver._initialize(y.auth),yield y.onExecution(),y.eventManager.registerConsumer(y)}catch(re){y.reject(re)}})).apply(this,arguments)})}onAuthEvent(y){var b=this;return(0,h.Z)(function*(){const{urlResponse:x,sessionId:O,postBody:F,tenantId:q,error:re,type:me}=y;if(re)return void b.reject(re);const Fe={auth:b.auth,requestUri:x,sessionId:O,tenantId:q||void 0,postBody:F||void 0,user:b.user,bypassAuthState:b.bypassAuthState};try{b.resolve(yield b.getIdpTask(me)(Fe))}catch(Ht){b.reject(Ht)}})()}onError(y){this.reject(y)}getIdpTask(y){switch(y){case"signInViaPopup":case"signInViaRedirect":return Ci;case"linkViaPopup":case"linkViaRedirect":return lh;case"reauthViaPopup":case"reauthViaRedirect":return yg;default:It(this.auth,"internal-error")}}resolve(y){Pr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(y),this.unregisterAndCleanUp()}reject(y){Pr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(y),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Hl=new ii(2e3,1e4);function Uc(R,y,b){return(so=so||(0,h.Z)(function*(x,O,F){const q=In(x);Rn(x,O,fi);const re=Wr(q,F);return new qs(q,"signInViaPopup",O,re).executeNotNull()})).apply(this,arguments)}function vg(R,y,b){return(En=En||(0,h.Z)(function*(x,O,F){const q=(0,X.m9)(x);Rn(q.auth,O,fi);const re=Wr(q.auth,F);return new qs(q.auth,"reauthViaPopup",O,re,q).executeNotNull()})).apply(this,arguments)}function Vc(R,y,b){return(Or=Or||(0,h.Z)(function*(x,O,F){const q=(0,X.m9)(x);Rn(q.auth,O,fi);const re=Wr(q.auth,F);return new qs(q.auth,"linkViaPopup",O,re,q).executeNotNull()})).apply(this,arguments)}let qs=(()=>{class R extends Xa{constructor(b,x,O,F,q){super(b,x,F,q),this.provider=O,this.authWindow=null,this.pollId=null,R.currentPopupAction&&R.currentPopupAction.cancel(),R.currentPopupAction=this}executeNotNull(){var b=this;return(0,h.Z)(function*(){const x=yield b.execute();return Xe(x,b.auth,"internal-error"),x})()}onExecution(){var b=this;return(0,h.Z)(function*(){Pr(1===b.filter.length,"Popup operations only handle one event");const x=ri();b.authWindow=yield b.resolver._openPopup(b.auth,b.provider,b.filter[0],x),b.authWindow.associatedEvent=x,b.resolver._originValidation(b.auth).catch(O=>{b.reject(O)}),b.resolver._isIframeWebStorageSupported(b.auth,O=>{O||b.reject($t(b.auth,"web-storage-unsupported"))}),b.pollUserCancellation()})()}get eventId(){var b;return(null===(b=this.authWindow)||void 0===b?void 0:b.associatedEvent)||null}cancel(){this.reject($t(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,R.currentPopupAction=null}pollUserCancellation(){const b=()=>{var x,O;this.pollId=null!==(O=null===(x=this.authWindow)||void 0===x?void 0:x.window)&&void 0!==O&&O.closed?window.setTimeout(()=>{this.pollId=null,this.reject($t(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(b,Hl.get())};b()}}return R.currentPopupAction=null,R})();const ch="pendingRedirect",jl=new Map;class Ys extends Xa{constructor(y,b,x=!1){super(y,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],b,void 0,x),this.eventId=null}execute(){var y=()=>super.execute,b=this;return(0,h.Z)(function*(){let x=jl.get(b.auth._key());if(!x){try{const F=(yield function Ja(R,y){return(Wi=Wi||(0,h.Z)(function*(b,x){const O=uh(x),F=$c(b);if(!(yield F._isAvailable()))return!1;const q="true"===(yield F._get(O));return yield F._remove(O),q})).apply(this,arguments)}(b.resolver,b.auth))?yield y().call(b):null;x=()=>Promise.resolve(F)}catch(O){x=()=>Promise.reject(O)}jl.set(b.auth._key(),x)}return b.bypassAuthState||jl.set(b.auth._key(),()=>Promise.resolve(null)),x()})()}onAuthEvent(y){var b=()=>super.onAuthEvent,x=this;return(0,h.Z)(function*(){if("signInViaRedirect"===y.type)return b().call(x,y);if("unknown"!==y.type){if(y.eventId){const O=yield x.auth._redirectUserForId(y.eventId);if(O)return x.user=O,b().call(x,y);x.resolve(null)}}else x.resolve(null)})()}onExecution(){return(0,h.Z)(function*(){})()}cleanUp(){}}function Kr(R,y){return(ir=ir||(0,h.Z)(function*(b,x){return $c(b)._set(uh(x),"true")})).apply(this,arguments)}function el(){jl.clear()}function Ni(R,y){jl.set(R._key(),y)}function $c(R){return lo(R._redirectPersistence)}function uh(R){return No(ch,R.config.apiKey,R.name)}function Di(R,y,b){return function go(R,y,b){return(ns=ns||(0,h.Z)(function*(x,O,F){const q=In(x);Rn(x,O,fi),yield q._initializationPromise;const re=Wr(q,F);return yield Kr(re,q),re._openRedirect(q,O,"signInViaRedirect")})).apply(this,arguments)}(R,y,b)}function Go(R,y,b){return function _i(R,y,b){return(Ki=Ki||(0,h.Z)(function*(x,O,F){const q=(0,X.m9)(x);Rn(q.auth,O,fi),yield q.auth._initializationPromise;const re=Wr(q.auth,F);yield Kr(re,q.auth);const me=yield Rs(q);return re._openRedirect(q.auth,O,"reauthViaRedirect",me)})).apply(this,arguments)}(R,y,b)}function Yi(R,y,b){return function Gl(R,y,b){return(bs=bs||(0,h.Z)(function*(x,O,F){const q=(0,X.m9)(x);Rn(q.auth,O,fi),yield q.auth._initializationPromise;const re=Wr(q.auth,F);yield ha(!1,q,O.providerId),yield Kr(re,q.auth);const me=yield Rs(q);return re._openRedirect(q.auth,O,"linkViaRedirect",me)})).apply(this,arguments)}(R,y,b)}function zu(R,y){return(ws=ws||(0,h.Z)(function*(b,x){return yield In(b)._initializationPromise,xa(b,x,!1)})).apply(this,arguments)}function xa(R,y){return(ne=ne||(0,h.Z)(function*(b,x,O=!1){const F=In(b),q=Wr(F,x),me=yield new Ys(F,q,O).execute();return me&&!O&&(delete me.user._redirectEventId,yield F._persistUserIfCurrent(me.user),yield F._setRedirectUser(null,x)),me})).apply(this,arguments)}function Rs(R){return(Z=Z||(0,h.Z)(function*(y){const b=ri(`${y.uid}:::`);return y._redirectEventId=b,yield y.auth._setRedirectUser(y),yield y.auth._persistUserIfCurrent(y),b})).apply(this,arguments)}class yi{constructor(y){this.auth=y,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(y){this.consumers.add(y),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,y)&&(this.sendToConsumer(this.queuedRedirectEvent,y),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(y){this.consumers.delete(y)}onEvent(y){if(this.hasEventBeenHandled(y))return!1;let b=!1;return this.consumers.forEach(x=>{this.isEventForConsumer(y,x)&&(b=!0,this.sendToConsumer(y,x),this.saveEventToCache(y))}),this.hasHandledPotentialRedirect||!function Hc(R){switch(R.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return bg(R);default:return!1}}(y)||(this.hasHandledPotentialRedirect=!0,b||(this.queuedRedirectEvent=y,b=!0)),b}sendToConsumer(y,b){var x;if(y.error&&!bg(y)){const O=(null===(x=y.error.code)||void 0===x?void 0:x.split("auth/")[1])||"internal-error";b.onError($t(this.auth,O))}else b.onAuthEvent(y)}isEventForConsumer(y,b){const x=null===b.eventId||!!y.eventId&&y.eventId===b.eventId;return b.filter.includes(y.type)&&x}hasEventBeenHandled(y){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(ks(y))}saveEventToCache(y){this.cachedEventUids.add(ks(y)),this.lastProcessedEventTime=Date.now()}}function ks(R){return[R.type,R.eventId,R.sessionId,R.tenantId].filter(y=>y).join("-")}function bg({type:R,error:y}){return"unknown"===R&&"auth/no-auth-event"===y?.code}function jc(R){return($=$||(0,h.Z)(function*(y,b={}){return oi(y,"GET","/v1/projects",b)})).apply(this,arguments)}const Gc=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,dh=/^https?/;function tl(R){const y=oo(),{protocol:b,hostname:x}=new URL(y);if(R.startsWith("chrome-extension://")){const q=new URL(R);return""===q.hostname&&""===x?"chrome-extension:"===b&&R.replace("chrome-extension://","")===y.replace("chrome-extension://",""):"chrome-extension:"===b&&q.hostname===x}if(!dh.test(b))return!1;if(Gc.test(R))return x===R;const O=R.replace(/\./g,"\\.");return new RegExp("^(.+\\."+O+"|"+O+")$","i").test(x)}const Zt=new ii(3e4,6e4);function nl(){const R=Dn().___jsl;if(R?.H)for(const y of Object.keys(R.H))if(R.H[y].r=R.H[y].r||[],R.H[y].L=R.H[y].L||[],R.H[y].r=[...R.H[y].L],R.CP)for(let b=0;b<R.CP.length;b++)R.CP[b]=null}let vo=null;const hh=new ii(5e3,15e3),bo="__/auth/iframe",Wu="emulator/auth/iframe",fh={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ku=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function wg(R){const y=R.config;Xe(y.authDomain,R,"auth-domain-config-required");const b=y.emulator?Nr(y,Wu):`https://${R.config.authDomain}/${bo}`,x={apiKey:y.apiKey,appName:R.name,v:V.SDK_VERSION},O=Ku.get(R.config.apiHost);O&&(x.eid=O);const F=R._getFrameworks();return F.length&&(x.fw=F.join(",")),`${b}?${(0,X.xO)(x).slice(1)}`}const A={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},L=500,H=600,Q="_blank",ae="http://localhost";class ve{constructor(y){this.window=y,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const ht="__/auth/handler",St="emulator/auth/handler",Pt=encodeURIComponent("fac");function un(R,y,b,x,O,F){return(ie=ie||(0,h.Z)(function*(q,re,me,Fe,Ht,kt){Xe(q.config.authDomain,q,"auth-domain-config-required"),Xe(q.config.apiKey,q,"invalid-api-key");const Wt={apiKey:q.config.apiKey,appName:q.name,authType:me,redirectUrl:Fe,v:V.SDK_VERSION,eventId:Ht};if(re instanceof fi){re.setDefaultLanguage(q.languageCode),Wt.providerId=re.providerId||"",(0,X.xb)(re.getCustomParameters())||(Wt.customParameters=JSON.stringify(re.getCustomParameters()));for(const[ur,Kl]of Object.entries(kt||{}))Wt[ur]=Kl}if(re instanceof _r){const ur=re.getScopes().filter(Kl=>""!==Kl);ur.length>0&&(Wt.scopes=ur.join(","))}q.tenantId&&(Wt.tid=q.tenantId);const Nn=Wt;for(const ur of Object.keys(Nn))void 0===Nn[ur]&&delete Nn[ur];const cr=yield q._getAppCheckToken(),Ls=cr?`#${Pt}=${encodeURIComponent(cr)}`:"";return`${function Nt({config:R}){return R.emulator?Nr(R,St):`https://${R.authDomain}/${ht}`}(q)}?${(0,X.xO)(Nn).slice(1)}${Ls}`})).apply(this,arguments)}const Zn="webStorageSupport",Ei=class Dr{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Za,this._completeRedirectFn=xa,this._overrideRedirectResult=Ni}_openPopup(y,b,x,O){var F=this;return(0,h.Z)(function*(){var q;Pr(null===(q=F.eventManagers[y._key()])||void 0===q?void 0:q.manager,"_initialize() not called before _openPopup()");const re=yield un(y,b,x,oo(),O);return function Ne(R,y,b,x=L,O=H){const F=Math.max((window.screen.availHeight-O)/2,0).toString(),q=Math.max((window.screen.availWidth-x)/2,0).toString();let re="";const me=Object.assign(Object.assign({},A),{width:x.toString(),height:O.toString(),top:F,left:q}),Fe=(0,X.z$)().toLowerCase();b&&(re=Yf(Fe)?Q:b),Cd(Fe)&&(y=y||ae,me.scrollbars="yes");const Ht=Object.entries(me).reduce((Wt,[Nn,cr])=>`${Wt}${Nn}=${cr},`,"");if(function yc(R=(0,X.z$)()){var y;return wu(R)&&!(null===(y=window.navigator)||void 0===y||!y.standalone)}(Fe)&&"_self"!==re)return function et(R,y){const b=document.createElement("a");b.href=R,b.target=y;const x=document.createEvent("MouseEvent");x.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),b.dispatchEvent(x)}(y||"",re),new ve(null);const kt=window.open(y||"",re,Ht);Xe(kt,R,"popup-blocked");try{kt.focus()}catch{}return new ve(kt)}(y,re,ri())})()}_openRedirect(y,b,x,O){var F=this;return(0,h.Z)(function*(){return yield F._originValidation(y),function Qa(R){Dn().location.href=R}(yield un(y,b,x,oo(),O)),new Promise(()=>{})})()}_initialize(y){const b=y._key();if(this.eventManagers[b]){const{manager:O,promise:F}=this.eventManagers[b];return O?Promise.resolve(O):(Pr(F,"If manager is not set, promise should be"),F)}const x=this.initAndGetManager(y);return this.eventManagers[b]={promise:x},x.catch(()=>{delete this.eventManagers[b]}),x}initAndGetManager(y){var b=this;return(0,h.Z)(function*(){const x=yield function D(R){return(U=U||(0,h.Z)(function*(y){const b=yield function zo(R){return vo=vo||function Ta(R){return new Promise((y,b)=>{var x,O,F;function q(){nl(),gapi.load("gapi.iframes",{callback:()=>{y(gapi.iframes.getContext())},ontimeout:()=>{nl(),b($t(R,"network-request-failed"))},timeout:Zt.get()})}if(null!==(O=null===(x=Dn().gapi)||void 0===x?void 0:x.iframes)&&void 0!==O&&O.Iframe)y(gapi.iframes.getContext());else{if(null===(F=Dn().gapi)||void 0===F||!F.load){const re=vc("iframefcb");return Dn()[re]=()=>{gapi.load?q():b($t(R,"network-request-failed"))},Tl(`https://apis.google.com/js/api.js?onload=${re}`).catch(me=>b(me))}q()}}).catch(y=>{throw vo=null,y})}(R),vo}(y),x=Dn().gapi;return Xe(x,y,"internal-error"),b.open({where:document.body,url:wg(y),messageHandlersFilter:x.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:fh,dontclear:!0},O=>{var F;return new Promise(function(q,re){return(F=F||(0,h.Z)(function*(me,Fe){yield O.restyle({setHideOnLeave:!1});const Ht=$t(y,"network-request-failed"),kt=Dn().setTimeout(()=>{Fe(Ht)},hh.get());function Wt(){Dn().clearTimeout(kt),me(O)}O.ping(Wt).then(Wt,()=>{Fe(Ht)})})).apply(this,arguments)})})})).apply(this,arguments)}(y),O=new yi(y);return x.register("authEvent",F=>(Xe(F?.authEvent,y,"invalid-auth-event"),{status:O.onEvent(F.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),b.eventManagers[y._key()]={manager:O},b.iframes[y._key()]=x,O})()}_isIframeWebStorageSupported(y,b){this.iframes[y._key()].send(Zn,{type:Zn},O=>{var F;const q=null===(F=O?.[0])||void 0===F?void 0:F[Zn];void 0!==q&&b(!!q),It(y,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(y){const b=y._key();return this.originValidationPromises[b]||(this.originValidationPromises[b]=function yo(R){return(j=j||(0,h.Z)(function*(y){if(y.config.emulator)return;const{authorizedDomains:b}=yield jc(y);for(const x of b)try{if(tl(x))return}catch{}It(y,"unauthorized-domain")})).apply(this,arguments)}(y)),this.originValidationPromises[b]}get _shouldInitProactively(){return Eu()||Dd()||wu()}};class on{constructor(y){this.factorId=y}_process(y,b,x){switch(b.type){case"enroll":return this._finalizeEnroll(y,b.credential,x);case"signin":return this._finalizeSignIn(y,b.credential);default:return ei("unexpected MultiFactorSessionType")}}}class Fi extends on{constructor(y){super("phone"),this.credential=y}static _fromCredential(y){return new Fi(y)}_finalizeEnroll(y,b,x){return function kc(R,y){return oi(R,"POST","/v2/accounts/mfaEnrollment:finalize",hn(R,y))}(y,{idToken:b,displayName:x,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(y,b){return function Vl(R,y){return oi(R,"POST","/v2/accounts/mfaSignIn:finalize",hn(R,y))}(y,{mfaPendingCredential:b,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let wo=(()=>{class R{constructor(){}static assertion(b){return Fi._fromCredential(b)}}return R.FACTOR_ID="phone",R})();var Wl="@firebase/auth";class il{constructor(y){this.auth=y,this.internalListeners=new Map}getUid(){var y;return this.assertAuthConfigured(),(null===(y=this.auth.currentUser)||void 0===y?void 0:y.uid)||null}getToken(y){var b=this;return(0,h.Z)(function*(){return b.assertAuthConfigured(),yield b.auth._initializationPromise,b.auth.currentUser?{accessToken:yield b.auth.currentUser.getIdToken(y)}:null})()}addAuthTokenListener(y){if(this.assertAuthConfigured(),this.internalListeners.has(y))return;const b=this.auth.onIdTokenChanged(x=>{y(x?.stsTokenManager.accessToken||null)});this.internalListeners.set(y,b),this.updateProactiveRefresh()}removeAuthTokenListener(y){this.assertAuthConfigured();const b=this.internalListeners.get(y);b&&(this.internalListeners.delete(y),b(),this.updateProactiveRefresh())}assertAuthConfigured(){Xe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Tm=(0,X.Pz)("authIdTokenMaxAge")||300;let xg=null;const t0=R=>{var y;return function(b){return(y=y||(0,h.Z)(function*(x){const O=x&&(yield x.getIdTokenResult()),F=O&&((new Date).getTime()-Date.parse(O.issuedAtTime))/1e3;if(F&&F>Tm)return;const q=O?.token;xg!==q&&(xg=q,yield fetch(R,{method:q?"POST":"DELETE",headers:q?{Authorization:`Bearer ${q}`}:{}}))})).apply(this,arguments)}};function mh(R=(0,V.getApp)()){const y=(0,V._getProvider)(R,"auth");if(y.isInitialized())return y.getImmediate();const b=function za(R,y){const b=(0,V._getProvider)(R,"auth");if(b.isInitialized()){const O=b.getImmediate(),F=b.getOptions();if((0,X.vZ)(F,y??{}))return O;It(O,"already-initialized")}return b.initialize({options:y})}(R,{popupRedirectResolver:Ei,persistence:[va,Jd,Za]}),x=(0,X.Pz)("authTokenSyncURL");if(x){const F=t0(x);(function Fu(R,y,b){(0,X.m9)(R).beforeAuthStateChanged(y,b)})(b,F,()=>F(b.currentUser)),function Nu(R,y,b,x){(0,X.m9)(R).onIdTokenChanged(y,b,x)}(b,q=>F(q))}const O=(0,X.q4)("auth");return O&&kd(b,`http://${O}`),b}!function xm(R){(0,V._registerComponent)(new ue.wA("auth",(y,{options:b})=>{const x=y.getProvider("app").getImmediate(),O=y.getProvider("heartbeat"),F=y.getProvider("app-check-internal"),{apiKey:q,authDomain:re}=x.options;Xe(q&&!q.includes(":"),"invalid-api-key",{appName:x.name});const me={apiKey:q,authDomain:re,clientPlatform:R,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Qf(R)},Fe=new wc(x,O,F,me);return function gr(R,y){const b=y?.persistence||[],x=(Array.isArray(b)?b:[b]).map(lo);y?.errorMap&&R._updateErrorMap(y.errorMap),R._initializeWithPersistence(x,y?.popupRedirectResolver)}(Fe,b),Fe},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((y,b,x)=>{y.getProvider("auth-internal").initialize()})),(0,V._registerComponent)(new ue.wA("auth-internal",y=>{const b=In(y.getProvider("auth").getImmediate());return new il(b)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,V.registerVersion)(Wl,"0.23.2",function Kc(R){switch(R){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(R)),(0,V.registerVersion)(Wl,"0.23.2","esm2017")}("Browser")},2090:(Ft,Be,z)=>{z.d(Be,{$s:()=>ns,BH:()=>je,G6:()=>Hs,L:()=>Ce,LL:()=>Ze,P0:()=>st,Pz:()=>He,Sg:()=>at,UG:()=>At,US:()=>ue,ZB:()=>le,ZR:()=>it,aH:()=>Ye,b$:()=>_n,eu:()=>Ee,hl:()=>_e,jU:()=>cn,m9:()=>ws,ne:()=>Mn,pd:()=>Ii,q4:()=>qe,r3:()=>gi,ru:()=>xt,tV:()=>ee,uI:()=>wt,vZ:()=>Bt,w1:()=>ro,xO:()=>Pn,xb:()=>tr,z$:()=>Je,zI:()=>Ie,zd:()=>$r});const de=function(ne){const Z=[];let $=0;for(let j=0;j<ne.length;j++){let U=ne.charCodeAt(j);U<128?Z[$++]=U:U<2048?(Z[$++]=U>>6|192,Z[$++]=63&U|128):55296==(64512&U)&&j+1<ne.length&&56320==(64512&ne.charCodeAt(j+1))?(U=65536+((1023&U)<<10)+(1023&ne.charCodeAt(++j)),Z[$++]=U>>18|240,Z[$++]=U>>12&63|128,Z[$++]=U>>6&63|128,Z[$++]=63&U|128):(Z[$++]=U>>12|224,Z[$++]=U>>6&63|128,Z[$++]=63&U|128)}return Z},ue={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(ne,Z){if(!Array.isArray(ne))throw Error("encodeByteArray takes an array as a parameter");this.init_();const $=Z?this.byteToCharMapWebSafe_:this.byteToCharMap_,j=[];for(let U=0;U<ne.length;U+=3){const ie=ne[U],Re=U+1<ne.length,ut=Re?ne[U+1]:0,tn=U+2<ne.length,Yt=tn?ne[U+2]:0;let qn=(15&ut)<<2|Yt>>6,On=63&Yt;tn||(On=64,Re||(qn=64)),j.push($[ie>>2],$[(3&ie)<<4|ut>>4],$[qn],$[On])}return j.join("")},encodeString(ne,Z){return this.HAS_NATIVE_SUPPORT&&!Z?btoa(ne):this.encodeByteArray(de(ne),Z)},decodeString(ne,Z){return this.HAS_NATIVE_SUPPORT&&!Z?atob(ne):function(ne){const Z=[];let $=0,j=0;for(;$<ne.length;){const U=ne[$++];if(U<128)Z[j++]=String.fromCharCode(U);else if(U>191&&U<224){const ie=ne[$++];Z[j++]=String.fromCharCode((31&U)<<6|63&ie)}else if(U>239&&U<365){const tn=((7&U)<<18|(63&ne[$++])<<12|(63&ne[$++])<<6|63&ne[$++])-65536;Z[j++]=String.fromCharCode(55296+(tn>>10)),Z[j++]=String.fromCharCode(56320+(1023&tn))}else{const ie=ne[$++],Re=ne[$++];Z[j++]=String.fromCharCode((15&U)<<12|(63&ie)<<6|63&Re)}}return Z.join("")}(this.decodeStringToByteArray(ne,Z))},decodeStringToByteArray(ne,Z){this.init_();const $=Z?this.charToByteMapWebSafe_:this.charToByteMap_,j=[];for(let U=0;U<ne.length;){const ie=$[ne.charAt(U++)],ut=U<ne.length?$[ne.charAt(U)]:0;++U;const Yt=U<ne.length?$[ne.charAt(U)]:64;++U;const Ut=U<ne.length?$[ne.charAt(U)]:64;if(++U,null==ie||null==ut||null==Yt||null==Ut)throw new Oe;j.push(ie<<2|ut>>4),64!==Yt&&(j.push(ut<<4&240|Yt>>2),64!==Ut&&j.push(Yt<<6&192|Ut))}return j},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let ne=0;ne<this.ENCODED_VALS.length;ne++)this.byteToCharMap_[ne]=this.ENCODED_VALS.charAt(ne),this.charToByteMap_[this.byteToCharMap_[ne]]=ne,this.byteToCharMapWebSafe_[ne]=this.ENCODED_VALS_WEBSAFE.charAt(ne),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[ne]]=ne,ne>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(ne)]=ne,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(ne)]=ne)}}};class Oe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Ce=function(ne){return function(ne){const Z=de(ne);return ue.encodeByteArray(Z,!0)}(ne).replace(/\./g,"")},ee=function(ne){try{return ue.decodeString(ne,!0)}catch(Z){console.error("base64Decode failed: ",Z)}return null};function le(ne,Z){if(!(Z instanceof Object))return Z;switch(Z.constructor){case Date:return new Date(Z.getTime());case Object:void 0===ne&&(ne={});break;case Array:ne=[];break;default:return Z}for(const $ in Z)!Z.hasOwnProperty($)||!tt($)||(ne[$]=le(ne[$],Z[$]));return ne}function tt(ne){return"__proto__"!==ne}const ze=()=>{try{return function Ue(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const ne=process.env.__FIREBASE_DEFAULTS__;return ne?JSON.parse(ne):void 0})()||(()=>{if(typeof document>"u")return;let ne;try{ne=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const Z=ne&&ee(ne[1]);return Z&&JSON.parse(Z)})()}catch(ne){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${ne}`)}},qe=ne=>{var Z,$;return null===($=null===(Z=ze())||void 0===Z?void 0:Z.emulatorHosts)||void 0===$?void 0:$[ne]},st=ne=>{const Z=qe(ne);if(!Z)return;const $=Z.lastIndexOf(":");if($<=0||$+1===Z.length)throw new Error(`Invalid host ${Z} with no separate hostname and port!`);const j=parseInt(Z.substring($+1),10);return"["===Z[0]?[Z.substring(1,$-1),j]:[Z.substring(0,$),j]},Ye=()=>{var ne;return null===(ne=ze())||void 0===ne?void 0:ne.config},He=ne=>{var Z;return null===(Z=ze())||void 0===Z?void 0:Z[`_${ne}`]};class je{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((Z,$)=>{this.resolve=Z,this.reject=$})}wrapCallback(Z){return($,j)=>{$?this.reject($):this.resolve(j),"function"==typeof Z&&(this.promise.catch(()=>{}),1===Z.length?Z($):Z($,j))}}}function at(ne,Z){if(ne.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const j=Z||"demo-project",U=ne.iat||0,ie=ne.sub||ne.user_id;if(!ie)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const Re=Object.assign({iss:`https://securetoken.google.com/${j}`,aud:j,iat:U,exp:U+3600,auth_time:U,sub:ie,user_id:ie,firebase:{sign_in_provider:"custom",identities:{}}},ne);return[Ce(JSON.stringify({alg:"none",type:"JWT"})),Ce(JSON.stringify(Re)),""].join(".")}function Je(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function wt(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Je())}function At(){var ne;const Z=null===(ne=ze())||void 0===ne?void 0:ne.forceEnvironment;if("node"===Z)return!0;if("browser"===Z)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function cn(){return"object"==typeof self&&self.self===self}function xt(){const ne="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof ne&&void 0!==ne.id}function _n(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function ro(){const ne=Je();return ne.indexOf("MSIE ")>=0||ne.indexOf("Trident/")>=0}function Hs(){return!At()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _e(){try{return"object"==typeof indexedDB}catch{return!1}}function Ee(){return new Promise((ne,Z)=>{try{let $=!0;const j="validate-browser-context-for-indexeddb-analytics-module",U=self.indexedDB.open(j);U.onsuccess=()=>{U.result.close(),$||self.indexedDB.deleteDatabase(j),ne(!0)},U.onupgradeneeded=()=>{$=!1},U.onerror=()=>{var ie;Z((null===(ie=U.error)||void 0===ie?void 0:ie.message)||"")}}catch($){Z($)}})}function Ie(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class it extends Error{constructor(Z,$,j){super($),this.code=Z,this.customData=j,this.name="FirebaseError",Object.setPrototypeOf(this,it.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ze.prototype.create)}}class Ze{constructor(Z,$,j){this.service=Z,this.serviceName=$,this.errors=j}create(Z,...$){const j=$[0]||{},U=`${this.service}/${Z}`,ie=this.errors[Z],Re=ie?function jt(ne,Z){return ne.replace(Dt,($,j)=>{const U=Z[j];return null!=U?String(U):`<${j}?>`})}(ie,j):"Error";return new it(U,`${this.serviceName}: ${Re} (${U}).`,j)}}const Dt=/\{\$([^}]+)}/g;function gi(ne,Z){return Object.prototype.hasOwnProperty.call(ne,Z)}function tr(ne){for(const Z in ne)if(Object.prototype.hasOwnProperty.call(ne,Z))return!1;return!0}function Bt(ne,Z){if(ne===Z)return!0;const $=Object.keys(ne),j=Object.keys(Z);for(const U of $){if(!j.includes(U))return!1;const ie=ne[U],Re=Z[U];if(vs(ie)&&vs(Re)){if(!Bt(ie,Re))return!1}else if(ie!==Re)return!1}for(const U of j)if(!$.includes(U))return!1;return!0}function vs(ne){return null!==ne&&"object"==typeof ne}function Pn(ne){const Z=[];for(const[$,j]of Object.entries(ne))Array.isArray(j)?j.forEach(U=>{Z.push(encodeURIComponent($)+"="+encodeURIComponent(U))}):Z.push(encodeURIComponent($)+"="+encodeURIComponent(j));return Z.length?"&"+Z.join("&"):""}function $r(ne){const Z={};return ne.replace(/^\?/,"").split("&").forEach(j=>{if(j){const[U,ie]=j.split("=");Z[decodeURIComponent(U)]=decodeURIComponent(ie)}}),Z}function Ii(ne){const Z=ne.indexOf("?");if(!Z)return"";const $=ne.indexOf("#",Z);return ne.substring(Z,$>0?$:void 0)}function Mn(ne,Z){const $=new Gt(ne,Z);return $.subscribe.bind($)}class Gt{constructor(Z,$){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=$,this.task.then(()=>{Z(this)}).catch(j=>{this.error(j)})}next(Z){this.forEachObserver($=>{$.next(Z)})}error(Z){this.forEachObserver($=>{$.error(Z)}),this.close(Z)}complete(){this.forEachObserver(Z=>{Z.complete()}),this.close()}subscribe(Z,$,j){let U;if(void 0===Z&&void 0===$&&void 0===j)throw new Error("Missing Observer.");U=function nr(ne,Z){if("object"!=typeof ne||null===ne)return!1;for(const $ of Z)if($ in ne&&"function"==typeof ne[$])return!0;return!1}(Z,["next","error","complete"])?Z:{next:Z,error:$,complete:j},void 0===U.next&&(U.next=ui),void 0===U.error&&(U.error=ui),void 0===U.complete&&(U.complete=ui);const ie=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?U.error(this.finalError):U.complete()}catch{}}),this.observers.push(U),ie}unsubscribeOne(Z){void 0===this.observers||void 0===this.observers[Z]||(delete this.observers[Z],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(Z){if(!this.finalized)for(let $=0;$<this.observers.length;$++)this.sendOne($,Z)}sendOne(Z,$){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[Z])try{$(this.observers[Z])}catch(j){typeof console<"u"&&console.error&&console.error(j)}})}close(Z){this.finalized||(this.finalized=!0,void 0!==Z&&(this.finalError=Z),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ui(){}const En=1e3,Or=2,Wi=144e5,ir=.5;function ns(ne,Z=En,$=Or){const j=Z*Math.pow($,ne),U=Math.round(ir*j*(Math.random()-.5)*2);return Math.min(Wi,j+U)}function ws(ne){return ne&&ne._delegate?ne._delegate:ne}},381:(Ft,Be,z)=>{var h=z(4650);let X=null;function V(){return X}class ye{}const ue=new h.OlP("DocumentToken");let Oe=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=h.Yz7({token:n,factory:function(){return function Le(){return(0,h.LFG)(ee)}()},providedIn:"platform"}),n})();const Ce=new h.OlP("Location Initialized");let ee=(()=>{class n extends Oe{constructor(t){super(),this._doc=t,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return V().getBaseHref(this._doc)}onPopState(t){const i=V().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=V().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){J()?this._history.pushState(t,i,r):this._location.hash=r}replaceState(t,i,r){J()?this._history.replaceState(t,i,r):this._location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(ue))},n.\u0275prov=h.Yz7({token:n,factory:function(){return function le(){return new ee((0,h.LFG)(ue))}()},providedIn:"platform"}),n})();function J(){return!!window.history.pushState}function tt(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function Ue(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function lt(n){return n&&"?"!==n[0]?"?"+n:n}let Et=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=h.Yz7({token:n,factory:function(){return(0,h.f3M)(ze)},providedIn:"root"}),n})();const Se=new h.OlP("appBaseHref");let ze=(()=>{class n extends Et{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??(0,h.f3M)(ue).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return tt(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+lt(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+lt(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+lt(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(Oe),h.LFG(Se,8))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),qe=(()=>{class n extends Et{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=tt(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+lt(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+lt(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(Oe),h.LFG(Se,8))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac}),n})(),st=(()=>{class n{constructor(t){this._subject=new h.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function at(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(Ue(je(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+lt(i))}normalize(t){return n.stripTrailingSlash(function He(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,je(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+lt(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+lt(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}}return n.normalizeQueryParams=lt,n.joinWithSlash=tt,n.stripTrailingSlash=Ue,n.\u0275fac=function(t){return new(t||n)(h.LFG(Et))},n.\u0275prov=h.Yz7({token:n,factory:function(){return function Ye(){return new st((0,h.LFG)(Et))}()},providedIn:"root"}),n})();function je(n){return n.replace(/\/index.html$/,"")}class Tr{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let aa=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new Tr(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const c=i.get(s);i.move(c,o),hn(c,r)}});for(let r=0,s=i.length;r<s;r++){const c=i.get(r).context;c.index=r,c.count=s,c.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{hn(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(h.Y36(h.s_b),h.Y36(h.Rgc),h.Y36(h.ZZ4))},n.\u0275dir=h.lG2({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function hn(n,e){n.context.$implicit=e.item}let Es=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new en,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){wl("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){wl("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(h.Y36(h.s_b),h.Y36(h.Rgc))},n.\u0275dir=h.lG2({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class en{constructor(){this.$implicit=null,this.ngIf=null}}function wl(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${(0,h.AaK)(e)}'.`)}class Ts{createSubscription(e,t){return e.subscribe({next:t,error:i=>{throw i}})}dispose(e){e.unsubscribe()}}class Ir{createSubscription(e,t){return e.then(t,i=>{throw i})}dispose(e){}}const pc=new Ir,xl=new Ts;let Is=(()=>{class n{constructor(t){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,i=>this._updateLatestValue(t,i))}_selectStrategy(t){if((0,h.QGY)(t))return pc;if((0,h.F4k)(t))return xl;throw function xs(n,e){return new h.vHH(2100,!1)}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,i){t===this._obj&&(this._latestValue=i,this._ref.markForCheck())}}return n.\u0275fac=function(t){return new(t||n)(h.Y36(h.sBO,16))},n.\u0275pipe=h.Yjl({name:"async",type:n,pure:!1,standalone:!0}),n})(),Ad=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({}),n})();const yc="browser",Fo="server";function Xf(n){return n===Fo}let xu=(()=>{class n{}return n.\u0275prov=(0,h.Yz7)({token:n,providedIn:"root",factory:()=>new em((0,h.LFG)(ue),window)}),n})();class em{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function vc(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=Tl(this.window.history)||Tl(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function Tl(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class Cc extends ye{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Pl extends Cc{static makeCurrent(){!function de(n){X||(X=n)}(new Pl)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function ma(){return Nl=Nl||document.querySelector("base"),Nl?Nl.getAttribute("href"):null}();return null==t?null:function am(n){Vo=Vo||document.createElement("a"),Vo.setAttribute("href",n);const e=Vo.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Nl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function $a(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let Vo,Nl=null;const Wd=new h.OlP("TRANSITION_ID"),mg=[{provide:h.ip1,useFactory:function Lu(n,e,t){return()=>{t.get(h.CZH).donePromise.then(()=>{const i=V(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[Wd,ue,h.zs3],multi:!0}];let cm=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac}),n})();const Dc=new h.OlP("EventManagerPlugins");let Ou=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(Dc),h.LFG(h.R0b))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac}),n})();class Ka{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=V().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let Pu=(()=>{class n{constructor(){this.usageCount=new Map}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)0===this.changeUsageCount(i,-1)&&this.onStyleRemoved(i)}onStyleRemoved(t){}onStyleAdded(t){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(t,i){const r=this.usageCount;let s=r.get(t)??0;return s+=i,s>0?r.set(t,s):r.delete(t),s}ngOnDestroy(){for(const t of this.getAllStyles())this.onStyleRemoved(t);this.usageCount.clear()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac}),n})(),$o=(()=>{class n extends Pu{constructor(t){super(),this.doc=t,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.forEach(s=>s.remove()),i.delete(t)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}addStyleToHost(t,i){const r=this.doc.createElement("style");r.textContent=i,t.appendChild(r);const s=this.styleRef.get(i);s?s.push(r):this.styleRef.set(i,[r])}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(ue))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac}),n})();const pa={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},ho=/%COMP%/g,qa=new h.OlP("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function Nu(n,e){return e.flat(100).map(t=>t.replace(ho,n))}function Fu(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let ls=(()=>{class n{constructor(t,i,r,s){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestory=s,this.rendererByCompId=new Map,this.defaultRenderer=new Kd(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;const r=this.getOrCreateRenderer(t,i);return r instanceof Bu?r.applyToHost(t):r instanceof jo&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.eventManager,c=this.sharedStylesHost,d=this.removeStylesOnCompDestory;switch(i.encapsulation){case h.ifc.Emulated:s=new Bu(o,c,i,this.appId,d);break;case h.ifc.ShadowDom:return new Ho(o,c,t,i);default:s=new jo(o,c,i,d)}s.onDestroy=()=>r.delete(i.id),r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(Ou),h.LFG($o),h.LFG(h.AFp),h.LFG(qa))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac}),n})();class Kd{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(pa[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(hm(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(hm(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=pa[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=pa[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(h.JOm.DashCase|h.JOm.Important)?e.style.setProperty(t,i,r&h.JOm.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&h.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,Fu(i)):this.eventManager.addEventListener(e,t,Fu(i))}}function hm(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class Ho extends Kd{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=Nu(r.id,r.styles);for(const o of s){const c=document.createElement("style");c.textContent=o,this.shadowRoot.appendChild(c)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class jo extends Kd{constructor(e,t,i,r,s=i.id){super(e),this.sharedStylesHost=t,this.removeStylesOnCompDestory=r,this.rendererUsageCount=0,this.styles=Nu(s,i.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class Bu extends jo{constructor(e,t,i,r,s){const o=r+"-"+i.id;super(e,t,i,s,o),this.contentAttr=function e0(n){return"_ngcontent-%COMP%".replace(ho,n)}(o),this.hostAttr=function dm(n){return"_nghost-%COMP%".replace(ho,n)}(o)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let Uu=(()=>{class n extends Ka{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(ue))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac}),n})();const kc=["alt","control","meta","shift"],Zd={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Vu={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let Qd=(()=>{class n extends Ka{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>V().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),o="code."),kc.forEach(m=>{const g=i.indexOf(m);g>-1&&(i.splice(g,1),o+=m+".")}),o+=s,0!=i.length||0===s.length)return null;const d={};return d.domEventName=r,d.fullKey=o,d}static matchEventFullKeyCode(t,i){let r=Zd[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),kc.forEach(o=>{o!==r&&(0,Vu[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(ue))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac}),n})();const Jd=(0,h.eFA)(h._c5,"browser",[{provide:h.Lbi,useValue:yc},{provide:h.g9A,useValue:function _a(){Pl.makeCurrent()},multi:!0},{provide:ue,useFactory:function Hu(){return(0,h.RDi)(document),document},deps:[]}]),eh=new h.OlP(""),Za=[{provide:h.rWj,useClass:class lm{addToWindow(e){h.dqk.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},h.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),h.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),h.dqk.frameworkStabilizers||(h.dqk.frameworkStabilizers=[]),h.dqk.frameworkStabilizers.push(i=>{const r=h.dqk.getAllAngularTestabilities();let s=r.length,o=!1;const c=function(d){o=o||d,s--,0==s&&i(o)};r.forEach(function(d){d.whenStable(c)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?V().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:h.lri,useClass:h.dDg,deps:[h.R0b,h.eoX,h.rWj]},{provide:h.dDg,useClass:h.dDg,deps:[h.R0b,h.eoX,h.rWj]}],ya=[{provide:h.zSh,useValue:"root"},{provide:h.qLn,useFactory:function Xd(){return new h.qLn},deps:[]},{provide:Dc,useClass:Uu,multi:!0,deps:[ue,h.R0b,h.Lbi]},{provide:Dc,useClass:Qd,multi:!0,deps:[ue]},{provide:ls,useClass:ls,deps:[Ou,$o,h.AFp,qa]},{provide:h.FYo,useExisting:ls},{provide:Pu,useExisting:$o},{provide:$o,useClass:$o,deps:[ue]},{provide:Ou,useClass:Ou,deps:[Dc,h.R0b]},{provide:class nm{},useClass:cm,deps:[]},[]];let po=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:h.AFp,useValue:t.appId},{provide:Wd,useExisting:h.AFp},mg]}}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(eh,12))},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({providers:[...ya,...Za],imports:[Ad,h.hGG]}),n})(),Mc=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(ue))},n.\u0275prov=h.Yz7({token:n,factory:function(t){let i=null;return i=t?new t:function Qa(){return new Mc((0,h.LFG)(ue))}(),i},providedIn:"root"}),n})();typeof window<"u"&&window;var Wn=z(8996),Fr=z(3269);function Ct(...n){const e=(0,Fr.yG)(n);return(0,Wn.D)(n,e)}var Yn=z(7579);class us extends Yn.x{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}const Gr=(0,z(3888).d)(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});var lr=z(9751);const{isArray:ah}=Array,{getPrototypeOf:Fc,prototype:Bc,keys:ba}=Object;var $l=z(4671),bt=z(4004);const{isArray:bm}=Array;function Wr(n){return(0,bt.U)(e=>function wm(n,e){return bm(e)?n(...e):n(e)}(n,e))}var Ci=z(5403),yg=z(9672);function lh(...n){const e=(0,Fr.yG)(n),t=(0,Fr.jO)(n),{args:i,keys:r}=function zr(n){if(1===n.length){const e=n[0];if(ah(e))return{args:e,keys:null};if(function wa(n){return n&&"object"==typeof n&&Fc(n)===Bc}(e)){const t=ba(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}(n);if(0===i.length)return(0,Wn.D)([],e);const s=new lr.y(function Xa(n,e,t=$l.y){return i=>{Hl(e,()=>{const{length:r}=n,s=new Array(r);let o=r,c=r;for(let d=0;d<r;d++)Hl(e,()=>{const m=(0,Wn.D)(n[d],e);let g=!1;m.subscribe((0,Ci.x)(i,v=>{s[d]=v,g||(g=!0,c--),c||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>function Ea(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}(r,o):$l.y));return t?s.pipe(Wr(t)):s}function Hl(n,e,t){n?(0,yg.f)(t,n,e):e()}var Uc=z(8189);function Vc(...n){return function vg(){return(0,Uc.J)(1)}()((0,Wn.D)(n,(0,Fr.yG)(n)))}var qs=z(8421);function ch(n){return new lr.y(e=>{(0,qs.Xf)(n()).subscribe(e)})}var jl=z(9635),Ys=z(576);function Ja(n,e){const t=(0,Ys.m)(n)?n:()=>n,i=r=>r.error(t());return new lr.y(e?r=>e.schedule(i,0,r):i)}var Kr=z(515),el=z(727),Ni=z(4482);function $c(){return(0,Ni.e)((n,e)=>{let t=null;n._refCount++;const i=(0,Ci.x)(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class uh extends lr.y{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,(0,Ni.A)(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new el.w0;const t=this.getSubject();e.add(this.source.subscribe((0,Ci.x)(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=el.w0.EMPTY)}return e}refCount(){return $c()(this)}}function Di(n,e){return(0,Ni.e)((t,i)=>{let r=null,s=0,o=!1;const c=()=>o&&!r&&i.complete();t.subscribe((0,Ci.x)(i,d=>{r?.unsubscribe();let m=0;const g=s++;(0,qs.Xf)(n(d,g)).subscribe(r=(0,Ci.x)(i,v=>i.next(e?e(d,v,g,m++):v),()=>{r=null,c()}))},()=>{o=!0,c()}))})}function go(n){return n<=0?()=>Kr.E:(0,Ni.e)((e,t)=>{let i=0;e.subscribe((0,Ci.x)(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function Go(...n){const e=(0,Fr.yG)(n);return(0,Ni.e)((t,i)=>{(e?Vc(n,t,e):Vc(n,t)).subscribe(i)})}function _i(n,e){return(0,Ni.e)((t,i)=>{let r=0;t.subscribe((0,Ci.x)(i,s=>n.call(e,s,r++)&&i.next(s)))})}var Yi=z(5577);function Gl(n){return(0,Ni.e)((e,t)=>{let i=!1;e.subscribe((0,Ci.x)(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function zu(n=xa){return(0,Ni.e)((e,t)=>{let i=!1;e.subscribe((0,Ci.x)(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function xa(){return new Gr}function Rs(n,e){const t=arguments.length>=2;return i=>i.pipe(n?_i((r,s)=>n(r,s,i)):$l.y,go(1),t?Gl(e):zu(()=>new Gr))}function _o(n,e){return(0,Ys.m)(e)?(0,Yi.z)(n,e,1):(0,Yi.z)(n,1)}var yi=z(8505);function ks(n){return(0,Ni.e)((e,t)=>{let s,i=null,r=!1;i=e.subscribe((0,Ci.x)(t,void 0,void 0,o=>{s=(0,qs.Xf)(n(o,ks(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function Hc(n,e){return(0,Ni.e)(function bg(n,e,t,i,r){return(s,o)=>{let c=t,d=e,m=0;s.subscribe((0,Ci.x)(o,g=>{const v=m++;d=c?n(d,g,v):(c=!0,g),i&&o.next(d)},r&&(()=>{c&&o.next(d),o.complete()})))}}(n,e,arguments.length>=2,!0))}function jc(n){return n<=0?()=>Kr.E:(0,Ni.e)((e,t)=>{let i=[];e.subscribe((0,Ci.x)(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function Gc(n,e){const t=arguments.length>=2;return i=>i.pipe(n?_i((r,s)=>n(r,s,i)):$l.y,jc(1),t?Gl(e):zu(()=>new Gr))}function yo(n){return(0,bt.U)(()=>n)}function tl(n){return(0,Ni.e)((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const Zt="primary",nl=Symbol("RouteTitle");class Ta{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function vo(n){return new Ta(n)}function zo(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],c=n[s];if(o.startsWith(":"))r[o.substring(1)]=c;else if(o!==c.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function bo(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!Wu(n[r],e[r]))return!1;return!0}function Wu(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function fh(n){return Array.prototype.concat.apply([],n)}function Ku(n){return n.length>0?n[n.length-1]:null}function D(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function A(n){return(0,h.CqO)(n)?n:(0,h.QGY)(n)?(0,Wn.D)(Promise.resolve(n)):Ct(n)}const L=!1,H={exact:function Ne(n,e,t){if(!Ei(n.segments,e.segments)||!Pt(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!Ne(n.children[i],e.children[i],t))return!1;return!0},subset:ht},Q={exact:function ve(n,e){return bo(n,e)},subset:function et(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Wu(n[t],e[t]))},ignored:()=>!0};function ae(n,e,t){return H[t.paths](n.root,e.root,t.matrixParams)&&Q[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function ht(n,e,t){return St(n,e,e.segments,t)}function St(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!Ei(r,t)||e.hasChildren()||!Pt(r,t,i))}if(n.segments.length===t.length){if(!Ei(n.segments,t)||!Pt(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!ht(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(Ei(n.segments,r)&&Pt(n.segments,r,i)&&n.children[Zt])&&St(n.children[Zt],e,s,i)}}function Pt(n,e,t){return e.every((i,r)=>Q[t](n[r].parameters,i.parameters))}class un{constructor(e=new Nt([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=vo(this.queryParams)),this._queryParamMap}toString(){return Ms.serialize(this)}}class Nt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,D(t,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return zc(this)}}class Zn{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=vo(this.parameters)),this._parameterMap}toString(){return Eg(this)}}function Ei(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let Fi=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=h.Yz7({token:n,factory:function(){return new wo},providedIn:"root"}),n})();class wo{parse(e){const t=new O(e);return new un(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Wc(e.root,!0)}`,i=function xg(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${Wl(t)}=${Wl(r)}`).join("&"):`${Wl(t)}=${Wl(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function Em(n){return encodeURI(n)}(e.fragment)}`:""}`}}const Ms=new wo;function zc(n){return n.segments.map(e=>Eg(e)).join("/")}function Wc(n,e){if(!n.hasChildren())return zc(n);if(e){const t=n.children[Zt]?Wc(n.children[Zt],!1):"",i=[];return D(n.children,(r,s)=>{s!==Zt&&i.push(`${s}:${Wc(r,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function on(n,e){let t=[];return D(n.children,(i,r)=>{r===Zt&&(t=t.concat(e(i,r)))}),D(n.children,(i,r)=>{r!==Zt&&(t=t.concat(e(i,r)))}),t}(n,(i,r)=>r===Zt?[Wc(n.children[Zt],!1)]:[`${r}:${Wc(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Zt]?`${zc(n)}/${t[0]}`:`${zc(n)}/(${t.join("//")})`}}function zl(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Wl(n){return zl(n).replace(/%3B/gi,";")}function il(n){return zl(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Kc(n){return decodeURIComponent(n)}function xm(n){return Kc(n.replace(/\+/g,"%20"))}function Eg(n){return`${il(n.path)}${function Tm(n){return Object.keys(n).map(e=>`;${il(e)}=${il(n[e])}`).join("")}(n.parameters)}`}const t0=/^[^\/()?;=#]+/;function mh(n){const e=n.match(t0);return e?e[0]:""}const R=/^[^=?&#]+/,b=/^[^&#]+/;class O{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Nt([],{}):new Nt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Zt]=new Nt(e,t)),i}parseSegment(){const e=mh(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new h.vHH(4009,L);return this.capture(e),new Zn(Kc(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=mh(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=mh(this.remaining);r&&(i=r,this.capture(i))}e[Kc(t)]=Kc(i)}parseQueryParam(e){const t=function y(n){const e=n.match(R);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function x(n){const e=n.match(b);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=xm(t),s=xm(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=mh(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new h.vHH(4010,L);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Zt);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[Zt]:new Nt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new h.vHH(4011,L)}}function F(n){return n.segments.length>0?new Nt([],{[Zt]:n}):n}function q(n){const e={};for(const i of Object.keys(n.children)){const s=q(n.children[i]);(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function re(n){if(1===n.numberOfChildren&&n.children[Zt]){const e=n.children[Zt];return new Nt(n.segments.concat(e.segments),e.children)}return n}(new Nt(n.segments,e))}function me(n){return n instanceof un}const Fe=!1;function Nn(n,e,t,i,r){if(0===t.length)return ur(e.root,e.root,e.root,i,r);const s=function qu(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new ph(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const c={};return D(s.outlets,(d,m)=>{c[m]="string"==typeof d?d.split("/"):d}),[...r,{outlets:c}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((c,d)=>{0==d&&"."===c||(0==d&&""===c?t=!0:".."===c?e++:""!=c&&r.push(c))}),r):[...r,s]},[]);return new ph(t,e,i)}(t);return s.toRoot()?ur(e.root,e.root,new Nt([],{}),i,r):function o(d){const m=function _h(n,e,t,i){if(n.isAbsolute)return new rl(e.root,!0,0);if(-1===i)return new rl(t,t===e.root,0);return function qc(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new h.vHH(4005,Fe&&"Invalid number of '../'");r=i.segments.length}return new rl(i,!1,r-s)}(t,i+(cr(n.commands[0])?0:1),n.numberOfDoubleDots)}(s,e,n.snapshot?._urlSegment,d),g=m.processChildren?sl(m.segmentGroup,m.index,s.commands):Yc(m.segmentGroup,m.index,s.commands);return ur(e.root,m.segmentGroup,g,i,r)}(n.snapshot?._lastPathIndex)}function cr(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Ls(n){return"object"==typeof n&&null!=n&&n.outlets}function ur(n,e,t,i,r){let o,s={};i&&D(i,(d,m)=>{s[m]=Array.isArray(d)?d.map(g=>`${g}`):`${d}`}),o=n===e?t:Kl(n,e,t);const c=F(q(o));return new un(c,s,r)}function Kl(n,e,t){const i={};return D(n.children,(r,s)=>{i[s]=r===e?t:Kl(r,e,t)}),new Nt(n.segments,i)}class ph{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&cr(i[0]))throw new h.vHH(4003,Fe&&"Root segment cannot have matrix parameters");const r=i.find(Ls);if(r&&r!==Ku(i))throw new h.vHH(4004,Fe&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class rl{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function Yc(n,e,t){if(n||(n=new Nt([],{})),0===n.segments.length&&n.hasChildren())return sl(n,e,t);const i=function n0(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],c=t[i];if(Ls(c))break;const d=`${c}`,m=i<t.length-1?t[i+1]:null;if(r>0&&void 0===d)break;if(d&&m&&"object"==typeof m&&void 0===m.outlets){if(!r0(d,m,o))return s;i+=2}else{if(!r0(d,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new Nt(n.segments.slice(0,i.pathIndex),{});return s.children[Zt]=new Nt(n.segments.slice(i.pathIndex),n.children),sl(s,0,r)}return i.match&&0===r.length?new Nt(n.segments,{}):i.match&&!n.hasChildren()?Im(n,e,t):i.match?sl(n,0,r):Im(n,e,t)}function sl(n,e,t){if(0===t.length)return new Nt(n.segments,{});{const i=function yh(n){return Ls(n[0])?n[0].outlets:{[Zt]:n}}(t),r={};if(!i[Zt]&&n.children[Zt]&&1===n.numberOfChildren&&0===n.children[Zt].segments.length){const s=sl(n.children[Zt],e,t);return new Nt(n.segments,s.children)}return D(i,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=Yc(n.children[o],e,s))}),D(n.children,(s,o)=>{void 0===i[o]&&(r[o]=s)}),new Nt(n.segments,r)}}function Im(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(Ls(s)){const d=Sm(s.outlets);return new Nt(i,d)}if(0===r&&cr(t[0])){i.push(new Zn(n.segments[e].path,TE(t[0]))),r++;continue}const o=Ls(s)?s.outlets[Zt]:`${s}`,c=r<t.length-1?t[r+1]:null;o&&c&&cr(c)?(i.push(new Zn(o,TE(c))),r+=2):(i.push(new Zn(o,{})),r++)}return new Nt(i,{})}function Sm(n){const e={};return D(n,(t,i)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[i]=Im(new Nt([],{}),0,t))}),e}function TE(n){const e={};return D(n,(t,i)=>e[i]=`${t}`),e}function r0(n,e,t){return n==t.path&&bo(e,t.parameters)}const Cm="imperative";class ol{constructor(e,t){this.id=e,this.url=t}}class s0 extends ol{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Zc extends ol{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Dm extends ol{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Yu extends ol{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=16}}class Am extends ol{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class vh extends ol{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class KC extends ol{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class qC extends ol{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class bL extends ol{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class YC extends ol{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class o0{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class ZC{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class IE{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Tg{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class a0{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class SE{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class l0{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let QC=(()=>{class n{createUrlTree(t,i,r,s,o,c){return Nn(t||i.root,r,s,o,c)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac}),n})(),JC=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=h.Yz7({token:n,factory:function(e){return QC.\u0275fac(e)},providedIn:"root"}),n})();class DE{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=c0(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=c0(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=Ia(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return Ia(e,this._root).map(t=>t.value)}}function c0(n,e){if(n===e.value)return e;for(const t of e.children){const i=c0(n,t);if(i)return i}return null}function Ia(n,e){if(n===e.value)return[e];for(const t of e.children){const i=Ia(n,t);if(i.length)return i.unshift(e),i}return[]}class Zs{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function bh(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class AE extends DE{constructor(e,t){super(e),this.snapshot=t,u0(this,e)}toString(){return this.snapshot.toString()}}function RE(n,e){const t=function eD(n,e){const o=new Ig([],{},{},"",{},Zt,e,null,n.root,-1,{});return new LE("",new Zs(o,[]))}(n,e),i=new us([new Zn("",{})]),r=new us({}),s=new us({}),o=new us({}),c=new us(""),d=new Qu(i,r,o,c,s,Zt,e,t.root);return d.snapshot=t.root,new AE(new Zs(d,[]),t)}class Qu{constructor(e,t,i,r,s,o,c,d){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=c,this.title=this.data?.pipe((0,bt.U)(m=>m[nl]))??Ct(void 0),this._futureSnapshot=d}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,bt.U)(e=>vo(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,bt.U)(e=>vo(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function kE(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function ME(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class Ig{get title(){return this.data?.[nl]}constructor(e,t,i,r,s,o,c,d,m,g,v){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=c,this.routeConfig=d,this._urlSegment=m,this._lastPathIndex=g,this._resolve=v}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=vo(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=vo(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class LE extends DE{constructor(e,t){super(t),this.url=e,u0(this,t)}toString(){return OE(this._root)}}function u0(n,e){e.value._routerState=n,e.children.forEach(t=>u0(n,t))}function OE(n){const e=n.children.length>0?` { ${n.children.map(OE).join(", ")} } `:"";return`${n.value}${e}`}function wh(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,bo(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),bo(e.params,t.params)||n.params.next(t.params),function hh(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!bo(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),bo(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function Sa(n,e){const t=bo(n.params,e.params)&&function Dr(n,e){return Ei(n,e)&&n.every((t,i)=>bo(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||Sa(n.parent,e.parent))}function Eh(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function PE(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return Eh(n,i,r);return Eh(n,i)})}(n,e,t);return new Zs(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(c=>Eh(n,c)),o}}const i=function NE(n){return new Qu(new us(n.url),new us(n.params),new us(n.queryParams),new us(n.fragment),new us(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>Eh(n,s));return new Zs(i,r)}}const FE="ngNavigationCancelingError";function tD(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=me(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=nD(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function nD(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[FE]=!0,i.cancellationCode=e,t&&(i.url=t),i}function Sg(n){return Cg(n)&&me(n.url)}function Cg(n){return n&&n[FE]}class wL{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Dg,this.attachRef=null}}let Dg=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new wL,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const km=!1;let Ag=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Zt,this.activateEvents=new h.vpe,this.deactivateEvents=new h.vpe,this.attachEvents=new h.vpe,this.detachEvents=new h.vpe,this.parentContexts=(0,h.f3M)(Dg),this.location=(0,h.f3M)(h.s_b),this.changeDetector=(0,h.f3M)(h.sBO),this.environmentInjector=(0,h.f3M)(h.lqb)}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new h.vHH(4012,km);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new h.vHH(4012,km);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new h.vHH(4012,km);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new h.vHH(4013,km);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,d=new iD(t,c,r.injector);if(i&&function rD(n){return!!n.resolveComponentFactory}(i)){const m=i.resolveComponentFactory(o);this.activated=r.createComponent(m,r.length,d)}else this.activated=r.createComponent(o,{index:r.length,injector:d,environmentInjector:i??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=h.lG2({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[h.TTD]}),n})();class iD{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===Qu?this.route:e===Dg?this.childContexts:this.parent.get(e,t)}}let d0=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=h.Xpm({type:n,selectors:[["ng-component"]],standalone:!0,features:[h.jDz],decls:1,vars:0,template:function(t,i){1&t&&h._UZ(0,"router-outlet")},dependencies:[Ag],encapsulation:2}),n})();function h0(n,e){return n.providers&&!n._injector&&(n._injector=(0,h.MMx)(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Rg(n){const e=n.children&&n.children.map(Rg),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Zt&&(t.component=d0),t}function Wo(n){return n.outlet||Zt}function UE(n,e){const t=n.filter(i=>Wo(i)===e);return t.push(...n.filter(i=>Wo(i)!==e)),t}function Mm(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class VE{constructor(e,t,i,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),wh(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=bh(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),D(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=bh(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),c=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:c})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=bh(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(e,t,i){const r=bh(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new SE(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Tg(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(wh(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const c=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(c.contexts),o.attachRef=c.componentRef,o.route=c.route.value,o.outlet&&o.outlet.attach(c.componentRef,c.route.value),wh(c.route.value),this.activateChildRoutes(e,null,o.children)}else{const c=Mm(r.snapshot),d=c?.get(h._Vd)??null;o.attachRef=null,o.route=r,o.resolver=d,o.injector=c,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class cD{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class p0{constructor(e,t){this.component=e,this.route=t}}function Lm(n,e,t){const i=n._root;return xh(i,e?e._root:null,t,[i.value])}function Xu(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||(0,h.Z0I)(n)?e.get(n):n:i}function xh(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=bh(e);return n.children.forEach(o=>{(function $E(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,c=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const d=function xL(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!Ei(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Ei(n.url,e.url)||!bo(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Sa(n,e)||!bo(n.queryParams,e.queryParams);default:return!Sa(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);d?r.canActivateChecks.push(new cD(i)):(s.data=o.data,s._resolvedData=o._resolvedData),xh(n,e,s.component?c?c.children:null:t,i,r),d&&c&&c.outlet&&c.outlet.isActivated&&r.canDeactivateChecks.push(new p0(c.outlet.component,o))}else o&&Om(e,c,r),r.canActivateChecks.push(new cD(i)),xh(n,null,s.component?c?c.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),D(s,(o,c)=>Om(o,t.getContext(c),r)),r}function Om(n,e,t){const i=bh(n),r=n.value;D(i,(s,o)=>{Om(s,r.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new p0(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function Th(n){return"function"==typeof n}function ql(n){return n instanceof Gr||"EmptyError"===n?.name}const kg=Symbol("INITIAL_VALUE");function Qc(){return Di(n=>lh(n.map(e=>e.pipe(go(1),Go(kg)))).pipe((0,bt.U)(e=>{for(const t of e)if(!0!==t){if(t===kg)return kg;if(!1===t||t instanceof un)return t}return!0}),_i(e=>e!==kg),go(1)))}function E0(n){return(0,jl.z)((0,yi.b)(e=>{if(me(e))throw tD(0,e)}),(0,bt.U)(e=>!0===e))}const x0={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function zE(n,e,t,i,r){const s=T0(n,e,t);return s.matched?function Ih(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?Ct(r.map(o=>{const c=Xu(o,n);return A(function v0(n){return n&&Th(n.canMatch)}(c)?c.canMatch(e,t):n.runInContext(()=>c(e,t)))})).pipe(Qc(),E0()):Ct(!0)}(i=h0(e,i),e,t).pipe((0,bt.U)(o=>!0===o?s:{...x0})):Ct(s)}function T0(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...x0}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||zo)(t,n,e);if(!r)return{...x0};const s={};D(r.posParams,(c,d)=>{s[d]=c.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function Sh(n,e,t,i){if(t.length>0&&function gD(n,e,t){return t.some(i=>I0(n,e,i)&&Wo(i)!==Zt)}(n,t,i)){const s=new Nt(e,function WE(n,e,t,i){const r={};r[Zt]=i,i._sourceSegment=n,i._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&Wo(s)!==Zt){const o=new Nt([],{});o._sourceSegment=n,o._segmentIndexShift=e.length,r[Wo(s)]=o}return r}(n,e,i,new Nt(t,n.children)));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:[]}}if(0===t.length&&function KE(n,e,t){return t.some(i=>I0(n,e,i))}(n,t,i)){const s=new Nt(n.segments,function pD(n,e,t,i,r){const s={};for(const o of i)if(I0(n,t,o)&&!r[Wo(o)]){const c=new Nt([],{});c._sourceSegment=n,c._segmentIndexShift=e.length,s[Wo(o)]=c}return{...r,...s}}(n,e,t,i,n.children));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}const r=new Nt(n.segments,n.children);return r._sourceSegment=n,r._segmentIndexShift=e.length,{segmentGroup:r,slicedSegments:t}}function I0(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function qE(n,e,t,i){return!!(Wo(n)===i||i!==Zt&&I0(e,t,n))&&("**"===n.path||T0(e,n,t).matched)}function Ch(n,e,t){return 0===e.length&&!n.children[t]}const Og=!1;class Yl{constructor(e){this.segmentGroup=e||null}}class Dh{constructor(e){this.urlTree=e}}function Pm(n){return Ja(new Yl(n))}function S0(n){return Ja(new Dh(n))}class YE{constructor(e,t,i,r,s){this.injector=e,this.configLoader=t,this.urlSerializer=i,this.urlTree=r,this.config=s,this.allowRedirects=!0}apply(){const e=Sh(this.urlTree.root,[],[],this.config).segmentGroup,t=new Nt(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,Zt).pipe((0,bt.U)(s=>this.createUrlTree(q(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(ks(s=>{if(s instanceof Dh)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof Yl?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,Zt).pipe((0,bt.U)(r=>this.createUrlTree(q(r),e.queryParams,e.fragment))).pipe(ks(r=>{throw r instanceof Yl?this.noMatchError(r):r}))}noMatchError(e){return new h.vHH(4002,Og)}createUrlTree(e,t,i){const r=F(e);return new un(r,t,i)}expandSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe((0,bt.U)(s=>new Nt([],s))):this.expandSegment(e,i,t,i.segments,r,!0)}expandChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return(0,Wn.D)(r).pipe(_o(s=>{const o=i.children[s],c=UE(t,s);return this.expandSegmentGroup(e,c,o,s).pipe((0,bt.U)(d=>({segment:d,outlet:s})))}),Hc((s,o)=>(s[o.outlet]=o.segment,s),{}),Gc())}expandSegment(e,t,i,r,s,o){return(0,Wn.D)(i).pipe(_o(c=>this.expandSegmentAgainstRoute(e,t,i,c,r,s,o).pipe(ks(m=>{if(m instanceof Yl)return Ct(null);throw m}))),Rs(c=>!!c),ks((c,d)=>{if(ql(c))return Ch(t,r,s)?Ct(new Nt([],{})):Pm(t);throw c}))}expandSegmentAgainstRoute(e,t,i,r,s,o,c){return qE(r,t,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,o):c&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o):Pm(t):Pm(t)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?S0(s):this.lineralizeSegments(i,s).pipe((0,Yi.z)(o=>{const c=new Nt(o,{});return this.expandSegment(e,c,t,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:c,consumedSegments:d,remainingSegments:m,positionalParamSegments:g}=T0(t,r,s);if(!c)return Pm(t);const v=this.applyRedirectCommands(d,r.redirectTo,g);return r.redirectTo.startsWith("/")?S0(v):this.lineralizeSegments(r,v).pipe((0,Yi.z)(E=>this.expandSegment(e,t,i,E.concat(m),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s){return"**"===i.path?(e=h0(i,e),i.loadChildren?(i._loadedRoutes?Ct({routes:i._loadedRoutes,injector:i._loadedInjector}):this.configLoader.loadChildren(e,i)).pipe((0,bt.U)(c=>(i._loadedRoutes=c.routes,i._loadedInjector=c.injector,new Nt(r,{})))):Ct(new Nt(r,{}))):zE(t,i,r,e).pipe(Di(({matched:o,consumedSegments:c,remainingSegments:d})=>o?this.getChildConfig(e=i._injector??e,i,r).pipe((0,Yi.z)(g=>{const v=g.injector??e,E=g.routes,{segmentGroup:T,slicedSegments:C}=Sh(t,c,d,E),k=new Nt(T.segments,T.children);if(0===C.length&&k.hasChildren())return this.expandChildren(v,E,k).pipe((0,bt.U)(W=>new Nt(c,W)));if(0===E.length&&0===C.length)return Ct(new Nt(c,{}));const P=Wo(i)===s;return this.expandSegment(v,k,E,C,P?Zt:s,!0).pipe((0,bt.U)(Y=>new Nt(c.concat(Y.segments),Y.children)))})):Pm(t)))}getChildConfig(e,t,i){return t.children?Ct({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Ct({routes:t._loadedRoutes,injector:t._loadedInjector}):function mD(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?Ct(!0):Ct(r.map(o=>{const c=Xu(o,n);return A(function _0(n){return n&&Th(n.canLoad)}(c)?c.canLoad(e,t):n.runInContext(()=>c(e,t)))})).pipe(Qc(),E0())}(e,t,i).pipe((0,Yi.z)(r=>r?this.configLoader.loadChildren(e,t).pipe((0,yi.b)(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function yD(n){return Ja(nD(Og,3))}())):Ct({routes:[],injector:e})}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return Ct(i);if(r.numberOfChildren>1||!r.children[Zt])return e.redirectTo,Ja(new h.vHH(4e3,Og));r=r.children[Zt]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new un(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return D(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const c=r.substring(1);i[s]=t[c]}else i[s]=r}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return D(t.children,(c,d)=>{o[d]=this.createSegmentGroup(e,c,i,r)}),new Nt(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new h.vHH(4001,Og);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}class C0{}class Nm{constructor(e,t,i,r,s,o,c){this.injector=e,this.rootComponentType=t,this.config=i,this.urlTree=r,this.url=s,this.paramsInheritanceStrategy=o,this.urlSerializer=c}recognize(){const e=Sh(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,Zt).pipe((0,bt.U)(t=>{if(null===t)return null;const i=new Ig([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Zt,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Zs(i,t),s=new LE(this.url,r);return this.inheritParamsAndData(s._root),s}))}inheritParamsAndData(e){const t=e.value,i=kE(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r)}processChildren(e,t,i){return(0,Wn.D)(Object.keys(i.children)).pipe(_o(r=>{const s=i.children[r],o=UE(t,r);return this.processSegmentGroup(e,o,s,r)}),Hc((r,s)=>r&&s?(r.push(...s),r):null),function dh(n,e=!1){return(0,Ni.e)((t,i)=>{let r=0;t.subscribe((0,Ci.x)(i,s=>{const o=n(s,r++);(o||e)&&i.next(s),!o&&i.complete()}))})}(r=>null!==r),Gl(null),Gc(),(0,bt.U)(r=>{if(null===r)return null;const s=QE(r);return function wD(n){n.sort((e,t)=>e.value.outlet===Zt?-1:t.value.outlet===Zt?1:e.value.outlet.localeCompare(t.value.outlet))}(s),s}))}processSegment(e,t,i,r,s){return(0,Wn.D)(t).pipe(_o(o=>this.processSegmentAgainstRoute(o._injector??e,o,i,r,s)),Rs(o=>!!o),ks(o=>{if(ql(o))return Ch(i,r,s)?Ct([]):Ct(null);throw o}))}processSegmentAgainstRoute(e,t,i,r,s){if(t.redirectTo||!qE(t,i,r,s))return Ct(null);let o;if("**"===t.path){const c=r.length>0?Ku(r).parameters:{},d=ex(i)+r.length;o=Ct({snapshot:new Ig(r,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,al(t),Wo(t),t.component??t._loadedComponent??null,t,JE(i),d,tx(t)),consumedSegments:[],remainingSegments:[]})}else o=zE(i,t,r,e).pipe((0,bt.U)(({matched:c,consumedSegments:d,remainingSegments:m,parameters:g})=>{if(!c)return null;const v=ex(i)+d.length;return{snapshot:new Ig(d,g,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,al(t),Wo(t),t.component??t._loadedComponent??null,t,JE(i),v,tx(t)),consumedSegments:d,remainingSegments:m}}));return o.pipe(Di(c=>{if(null===c)return Ct(null);const{snapshot:d,consumedSegments:m,remainingSegments:g}=c;e=t._injector??e;const v=t._loadedInjector??e,E=function ED(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(t),{segmentGroup:T,slicedSegments:C}=Sh(i,m,g,E.filter(P=>void 0===P.redirectTo));if(0===C.length&&T.hasChildren())return this.processChildren(v,E,T).pipe((0,bt.U)(P=>null===P?null:[new Zs(d,P)]));if(0===E.length&&0===C.length)return Ct([new Zs(d,[])]);const k=Wo(t)===s;return this.processSegment(v,E,T,C,k?Zt:s).pipe((0,bt.U)(P=>null===P?null:[new Zs(d,P)]))}))}}function xD(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function QE(n){const e=[],t=new Set;for(const i of n){if(!xD(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=QE(i.children);e.push(new Zs(i.value,r))}return e.filter(i=>!t.has(i))}function JE(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function ex(n){let e=n,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function al(n){return n.data||{}}function tx(n){return n.resolve||{}}function A0(n){return"string"==typeof n.title||null===n.title}function R0(n){return Di(e=>{const t=n(e);return t?(0,Wn.D)(t).pipe((0,bt.U)(()=>e)):Ct(e)})}const Ah=new h.OlP("ROUTES");let M0=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,h.f3M)(h.Sil)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Ct(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=A(t.loadComponent()).pipe((0,bt.U)(rx),(0,yi.b)(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),tl(()=>{this.componentLoaders.delete(t)})),r=new uh(i,()=>new Yn.x).pipe($c());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Ct({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe((0,bt.U)(c=>{this.onLoadEndListener&&this.onLoadEndListener(i);let d,m,g=!1;Array.isArray(c)?m=c:(d=c.create(t).injector,m=fh(d.get(Ah,[],h.XFs.Self|h.XFs.Optional)));return{routes:m.map(Rg),injector:d}}),tl(()=>{this.childrenLoaders.delete(i)})),o=new uh(s,()=>new Yn.x).pipe($c());return this.childrenLoaders.set(i,o),o}loadModuleFactoryOrRoutes(t){return A(t()).pipe((0,bt.U)(rx),(0,Yi.z)(i=>i instanceof h.YKP||Array.isArray(i)?Ct(i):(0,Wn.D)(this.compiler.compileModuleAsync(i))))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function rx(n){return function Ca(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let Ng=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Yn.x,this.configLoader=(0,h.f3M)(M0),this.environmentInjector=(0,h.f3M)(h.lqb),this.urlSerializer=(0,h.f3M)(Fi),this.rootContexts=(0,h.f3M)(Dg),this.navigationId=0,this.afterPreactivation=()=>Ct(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new ZC(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new o0(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t){return this.transitions=new us({id:0,targetPageId:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Cm,restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(_i(i=>0!==i.id),(0,bt.U)(i=>({...i,extractedUrl:t.urlHandlingStrategy.extract(i.rawUrl)})),Di(i=>{let r=!1,s=!1;return Ct(i).pipe((0,yi.b)(o=>{this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Di(o=>{const c=t.browserUrlTree.toString(),d=!t.navigated||o.extractedUrl.toString()!==c||c!==t.currentUrlTree.toString();if(!d&&"reload"!==(o.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const g="";return this.events.next(new Yu(o.id,t.serializeUrl(i.rawUrl),g,0)),t.rawUrlTree=o.rawUrl,o.resolve(null),Kr.E}if(t.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return sx(o.source)&&(t.browserUrlTree=o.extractedUrl),Ct(o).pipe(Di(g=>{const v=this.transitions?.getValue();return this.events.next(new s0(g.id,this.urlSerializer.serialize(g.extractedUrl),g.source,g.restoredState)),v!==this.transitions?.getValue()?Kr.E:Promise.resolve(g)}),function ZE(n,e,t,i){return Di(r=>function vD(n,e,t,i,r){return new YE(n,e,t,i,r).apply()}(n,e,t,r.extractedUrl,i).pipe((0,bt.U)(s=>({...r,urlAfterRedirects:s}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,t.config),(0,yi.b)(g=>{this.currentNavigation={...this.currentNavigation,finalUrl:g.urlAfterRedirects},i.urlAfterRedirects=g.urlAfterRedirects}),function TD(n,e,t,i,r){return(0,Yi.z)(s=>function D0(n,e,t,i,r,s,o="emptyOnly"){return new Nm(n,e,t,i,r,o,s).recognize().pipe(Di(c=>null===c?function bD(n){return new lr.y(e=>e.error(n))}(new C0):Ct(c)))}(n,e,t,s.urlAfterRedirects,i.serialize(s.urlAfterRedirects),i,r).pipe((0,bt.U)(o=>({...s,targetSnapshot:o}))))}(this.environmentInjector,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),(0,yi.b)(g=>{if(i.targetSnapshot=g.targetSnapshot,"eager"===t.urlUpdateStrategy){if(!g.extras.skipLocationChange){const E=t.urlHandlingStrategy.merge(g.urlAfterRedirects,g.rawUrl);t.setBrowserUrl(E,g)}t.browserUrlTree=g.urlAfterRedirects}const v=new vh(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot);this.events.next(v)}));if(d&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:g,extractedUrl:v,source:E,restoredState:T,extras:C}=o,k=new s0(g,this.urlSerializer.serialize(v),E,T);this.events.next(k);const P=RE(v,this.rootComponentType).snapshot;return Ct(i={...o,targetSnapshot:P,urlAfterRedirects:v,extras:{...C,skipLocationChange:!1,replaceUrl:!1}})}{const g="";return this.events.next(new Yu(o.id,t.serializeUrl(i.extractedUrl),g,1)),t.rawUrlTree=o.rawUrl,o.resolve(null),Kr.E}}),(0,yi.b)(o=>{const c=new KC(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(c)}),(0,bt.U)(o=>i={...o,guards:Lm(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),function Mg(n,e){return(0,Yi.z)(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?Ct({...t,guardsResult:!0}):function hD(n,e,t,i){return(0,Wn.D)(n).pipe((0,Yi.z)(r=>function fD(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||0===s.length)return Ct(!0);const o=s.map(c=>{const d=Mm(e)??r,m=Xu(c,d);return A(function uD(n){return n&&Th(n.canDeactivate)}(m)?m.canDeactivate(n,e,t,i):d.runInContext(()=>m(n,e,t,i))).pipe(Rs())});return Ct(o).pipe(Qc())}(r.component,r.route,t,e,i)),Rs(r=>!0!==r,!0))}(o,i,r,n).pipe((0,Yi.z)(c=>c&&function HE(n){return"boolean"==typeof n}(c)?function b0(n,e,t,i){return(0,Wn.D)(e).pipe(_o(r=>Vc(function Ju(n,e){return null!==n&&e&&e(new IE(n)),Ct(!0)}(r.route.parent,i),function Lg(n,e){return null!==n&&e&&e(new a0(n)),Ct(!0)}(r.route,i),function w0(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function g0(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>ch(()=>Ct(o.guards.map(d=>{const m=Mm(o.node)??t,g=Xu(d,m);return A(function y0(n){return n&&Th(n.canActivateChild)}(g)?g.canActivateChild(i,n):m.runInContext(()=>g(i,n))).pipe(Rs())})).pipe(Qc())));return Ct(s).pipe(Qc())}(n,r.path,t),function GE(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return Ct(!0);const r=i.map(s=>ch(()=>{const o=Mm(e)??t,c=Xu(s,o);return A(function TL(n){return n&&Th(n.canActivate)}(c)?c.canActivate(e,n):o.runInContext(()=>c(e,n))).pipe(Rs())}));return Ct(r).pipe(Qc())}(n,r.route,t))),Rs(r=>!0!==r,!0))}(i,s,n,e):Ct(c)),(0,bt.U)(c=>({...t,guardsResult:c})))})}(this.environmentInjector,o=>this.events.next(o)),(0,yi.b)(o=>{if(i.guardsResult=o.guardsResult,me(o.guardsResult))throw tD(0,o.guardsResult);const c=new qC(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(c)}),_i(o=>!!o.guardsResult||(t.restoreHistory(o),this.cancelNavigationTransition(o,"",3),!1)),R0(o=>{if(o.guards.canActivateChecks.length)return Ct(o).pipe((0,yi.b)(c=>{const d=new bL(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}),Di(c=>{let d=!1;return Ct(c).pipe(function IL(n,e){return(0,Yi.z)(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return Ct(t);let s=0;return(0,Wn.D)(r).pipe(_o(o=>function SL(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!A0(r)&&(s[nl]=r.title),function nx(n,e,t,i){const r=function CL(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return Ct({});const s={};return(0,Wn.D)(r).pipe((0,Yi.z)(o=>function ix(n,e,t,i){const r=Mm(e)??i,s=Xu(n,r);return A(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(n[o],e,t,i).pipe(Rs(),(0,yi.b)(c=>{s[o]=c}))),jc(1),yo(s),ks(o=>ql(o)?Kr.E:Ja(o)))}(s,n,e,i).pipe((0,bt.U)(o=>(n._resolvedData=o,n.data=kE(n,t).resolve,r&&A0(r)&&(n.data[nl]=r.title),null)))}(o.route,i,n,e)),(0,yi.b)(()=>s++),jc(1),(0,Yi.z)(o=>s===r.length?Ct(t):Kr.E))})}(t.paramsInheritanceStrategy,this.environmentInjector),(0,yi.b)({next:()=>d=!0,complete:()=>{d||(t.restoreHistory(c),this.cancelNavigationTransition(c,"",2))}}))}),(0,yi.b)(c=>{const d=new YC(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}))}),R0(o=>{const c=d=>{const m=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&m.push(this.configLoader.loadComponent(d.routeConfig).pipe((0,yi.b)(g=>{d.component=g}),(0,bt.U)(()=>{})));for(const g of d.children)m.push(...c(g));return m};return lh(c(o.targetSnapshot.root)).pipe(Gl(),go(1))}),R0(()=>this.afterPreactivation()),(0,bt.U)(o=>{const c=function Rm(n,e,t){const i=Eh(n,e._root,t?t._root:void 0);return new AE(i,e)}(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return i={...o,targetRouterState:c}}),(0,yi.b)(o=>{t.currentUrlTree=o.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(o.urlAfterRedirects,o.rawUrl),t.routerState=o.targetRouterState,"deferred"===t.urlUpdateStrategy&&(o.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,o),t.browserUrlTree=o.urlAfterRedirects)}),((n,e,t)=>(0,bt.U)(i=>(new VE(e,i.targetRouterState,i.currentRouterState,t).activate(n),i)))(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o)),go(1),(0,yi.b)({next:o=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new Zc(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{r=!0}}),tl(()=>{r||s||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),ks(o=>{if(s=!0,Cg(o)){Sg(o)||(t.navigated=!0,t.restoreHistory(i,!0));const c=new Dm(i.id,this.urlSerializer.serialize(i.extractedUrl),o.message,o.cancellationCode);if(this.events.next(c),Sg(o)){const d=t.urlHandlingStrategy.merge(o.url,t.rawUrlTree),m={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||sx(i.source)};t.scheduleNavigation(d,Cm,null,m,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{t.restoreHistory(i,!0);const c=new Am(i.id,this.urlSerializer.serialize(i.extractedUrl),o,i.targetSnapshot??void 0);this.events.next(c);try{i.resolve(t.errorHandler(o))}catch(d){i.reject(d)}}return Kr.E}))}))}cancelNavigationTransition(t,i,r){const s=new Dm(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function sx(n){return n!==Cm}let ox=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===Zt);return i}getResolvedTitleForRoute(t){return t.data[nl]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=h.Yz7({token:n,factory:function(){return(0,h.f3M)(ID)},providedIn:"root"}),n})(),ID=(()=>{class n extends ox{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(Mc))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ax=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=h.Yz7({token:n,factory:function(){return(0,h.f3M)(CD)},providedIn:"root"}),n})();class SD{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let CD=(()=>{class n extends SD{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=h.n5z(n)))(i||n)}}(),n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const mn=new h.OlP("",{providedIn:"root",factory:()=>({})});let lx=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=h.Yz7({token:n,factory:function(){return(0,h.f3M)(cx)},providedIn:"root"}),n})(),cx=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function AD(n){throw n}function RD(n,e,t){return e.parse("/")}const ux={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},kD={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ds=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,h.f3M)(h.c2e),this.isNgZoneEnabled=!1,this.options=(0,h.f3M)(mn,{optional:!0})||{},this.errorHandler=this.options.errorHandler||AD,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||RD,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,h.f3M)(lx),this.routeReuseStrategy=(0,h.f3M)(ax),this.urlCreationStrategy=(0,h.f3M)(JC),this.titleStrategy=(0,h.f3M)(ox),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=fh((0,h.f3M)(Ah,{optional:!0})??[]),this.navigationTransitions=(0,h.f3M)(Ng),this.urlSerializer=(0,h.f3M)(Fi),this.location=(0,h.f3M)(st),this.isNgZoneEnabled=(0,h.f3M)(h.R0b)instanceof h.R0b&&h.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new un,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=RE(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId??0},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Cm,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const d={...r};delete d.navigationId,delete d.\u0275routerPageId,0!==Object.keys(d).length&&(s.state=d)}const c=this.parseUrl(t);this.scheduleNavigation(c,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(t){this.config=t.map(Rg),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:c,preserveFragment:d}=i,m=d?this.currentUrlTree.fragment:o;let g=null;switch(c){case"merge":g={...this.currentUrlTree.queryParams,...s};break;case"preserve":g=this.currentUrlTree.queryParams;break;default:g=s||null}return null!==g&&(g=this.removeEmptyProps(g)),this.urlCreationStrategy.createUrlTree(r,this.routerState,this.currentUrlTree,t,g,m??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=me(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,Cm,null,i)}navigate(t,i={skipLocationChange:!1}){return function MD(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new h.vHH(4008,false)}}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...ux}:!1===i?{...kD}:i,me(t))return ae(this.currentUrlTree,t,r);const s=this.parseUrl(t);return ae(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let c,d,m,g;return o?(c=o.resolve,d=o.reject,m=o.promise):m=new Promise((v,E)=>{c=v,d=E}),g="computed"===this.canceledNavigationResolution?r&&r.\u0275routerPageId?r.\u0275routerPageId:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:g,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:c,reject:d,promise:m,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),m.catch(v=>Promise.reject(v))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const o={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",o)}else{const s={...i.extras.state,...this.generateNgRouterState(i.id,i.targetPageId)};this.location.go(r,"",s)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-(this.browserPageId??this.currentPageId);0!==s?this.location.historyGo(s):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===s&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class O0{}let P0=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(_i(t=>t instanceof Zc),_o(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=(0,h.MMx)(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,c=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(c,s.children??s._loadedRoutes))}return(0,Wn.D)(r).pipe((0,Uc.J)())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):Ct(null);const s=r.pipe((0,Yi.z)(o=>null===o?Ct(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));if(i.loadComponent&&!i._loadedComponent){const o=this.loader.loadComponent(i);return(0,Wn.D)([s,o]).pipe((0,Uc.J)())}return s})}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(ds),h.LFG(h.Sil),h.LFG(h.lqb),h.LFG(O0),h.LFG(M0))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Um=new h.OlP("");let hx=(()=>{class n{constructor(t,i,r,s,o={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof s0?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Zc&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof l0&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new l0(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return n.\u0275fac=function(t){h.$Z()},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac}),n})();var Ko=(()=>((Ko=Ko||{})[Ko.COMPLETE=0]="COMPLETE",Ko[Ko.FAILED=1]="FAILED",Ko[Ko.REDIRECTING=2]="REDIRECTING",Ko))();const Vm=!1;function ed(n,e){return{\u0275kind:n,\u0275providers:e}}const F0=new h.OlP("",{providedIn:"root",factory:()=>!1});function $m(){const n=(0,h.f3M)(h.zs3);return e=>{const t=n.get(h.z2F);if(e!==t.components[0])return;const i=n.get(ds),r=n.get(fx);1===n.get(Bg)&&i.initialNavigation(),n.get(mx,null,h.XFs.Optional)?.setUpPreloading(),n.get(Um,null,h.XFs.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const fx=new h.OlP(Vm?"bootstrap done indicator":"",{factory:()=>new Yn.x}),Bg=new h.OlP(Vm?"initial navigation":"",{providedIn:"root",factory:()=>1});function ND(){let n=[];return n=Vm?[{provide:h.Xts,multi:!0,useFactory:()=>{const e=(0,h.f3M)(ds);return()=>e.events.subscribe(t=>{console.group?.(`Router Event: ${t.constructor.name}`),console.log(function CE(n){if(!("type"in n))return`Unknown Router Event: ${n.constructor.name}`;switch(n.type){case 14:return`ActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state}, shouldActivate: ${n.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 2:return`NavigationCancel(id: ${n.id}, url: '${n.url}')`;case 16:return`NavigationSkipped(id: ${n.id}, url: '${n.url}')`;case 1:return`NavigationEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${n.id}, url: '${n.url}', error: ${n.error})`;case 0:return`NavigationStart(id: ${n.id}, url: '${n.url}')`;case 6:return`ResolveEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 5:return`ResolveStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 10:return`RouteConfigLoadEnd(path: ${n.route.path})`;case 9:return`RouteConfigLoadStart(path: ${n.route.path})`;case 4:return`RoutesRecognized(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 15:return`Scroll(anchor: '${n.anchor}', position: '${n.position?`${n.position[0]}, ${n.position[1]}`:null}')`}}(t)),console.log(t),console.groupEnd?.()})}}]:[],ed(1,n)}const mx=new h.OlP(Vm?"router preloader":"");function FD(n){return ed(0,[{provide:mx,useExisting:P0},{provide:O0,useExisting:n}])}const Mh=!1,VD=new h.OlP(Mh?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),B0=[st,{provide:Fi,useClass:wo},ds,Dg,{provide:Qu,useFactory:function N0(n){return n.routerState.root},deps:[ds]},M0,Mh?{provide:F0,useValue:!0}:[]];function $D(){return new h.PXZ("Router",ds)}let HD=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[B0,Mh&&i?.enableTracing?ND().\u0275providers:[],{provide:Ah,multi:!0,useValue:t},{provide:VD,useFactory:_x,deps:[[ds,new h.FiY,new h.tp0]]},{provide:mn,useValue:i||{}},i?.useHash?{provide:Et,useClass:qe}:{provide:Et,useClass:ze},{provide:Um,useFactory:()=>{const n=(0,h.f3M)(xu),e=(0,h.f3M)(h.R0b),t=(0,h.f3M)(mn),i=(0,h.f3M)(Ng),r=(0,h.f3M)(Fi);return t.scrollOffset&&n.setOffset(t.scrollOffset),new hx(r,i,n,e,t)}},i?.preloadingStrategy?FD(i.preloadingStrategy).\u0275providers:[],{provide:h.PXZ,multi:!0,useFactory:$D},i?.initialNavigation?GD(i):[],[{provide:yx,useFactory:$m},{provide:h.tb,multi:!0,useExisting:yx}]]}}static forChild(t){return{ngModule:n,providers:[{provide:Ah,multi:!0,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(VD,8))},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({imports:[d0]}),n})();function _x(n){if(Mh&&n)throw new h.vHH(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function GD(n){return["disabled"===n.initialNavigation?ed(3,[{provide:h.ip1,multi:!0,useFactory:()=>{const e=(0,h.f3M)(ds);return()=>{e.setUpLocationChangeListener()}}},{provide:Bg,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?ed(2,[{provide:Bg,useValue:0},{provide:h.ip1,multi:!0,deps:[h.zs3],useFactory:e=>{const t=e.get(Ce,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(ds),s=e.get(fx);(function RL(n,e){n.events.pipe(_i(t=>t instanceof Zc||t instanceof Dm||t instanceof Am||t instanceof Yu),(0,bt.U)(t=>t instanceof Zc||t instanceof Yu?Ko.COMPLETE:t instanceof Dm&&(0===t.code||1===t.code)?Ko.REDIRECTING:Ko.FAILED),_i(t=>t!==Ko.REDIRECTING),go(1)).subscribe(()=>{e()})})(r,()=>{i(!0)}),e.get(Ng).afterPreactivation=()=>(i(!0),s.closed?Ct(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const yx=new h.OlP(Mh?"Router Initializer":"");let Vg=(()=>{var n;class e{constructor(){this.showLoading=!0}ngOnInit(){setTimeout(()=>{this.showLoading=!1},1e3)}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275cmp=h.Xpm({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(i,r){1&i&&h._UZ(0,"router-outlet")},dependencies:[Ag]}),e})();var Te=z(5861);function U0(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var i,r,s,o,c,jm={exports:{}};i=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,jm.exports=c={buildAbsoluteURL:function(d,m,g){if(g=g||{},d=d.trim(),!(m=m.trim())){if(!g.alwaysNormalize)return d;var v=c.parseURL(d);if(!v)throw new Error("Error trying to parse base URL.");return v.path=c.normalizePath(v.path),c.buildURLFromParts(v)}var E=c.parseURL(m);if(!E)throw new Error("Error trying to parse relative URL.");if(E.scheme)return g.alwaysNormalize?(E.path=c.normalizePath(E.path),c.buildURLFromParts(E)):m;var T=c.parseURL(d);if(!T)throw new Error("Error trying to parse base URL.");if(!T.netLoc&&T.path&&"/"!==T.path[0]){var C=r.exec(T.path);T.netLoc=C[1],T.path=C[2]}T.netLoc&&!T.path&&(T.path="/");var k={scheme:T.scheme,netLoc:E.netLoc,path:null,params:E.params,query:E.query,fragment:E.fragment};if(!E.netLoc&&(k.netLoc=T.netLoc,"/"!==E.path[0]))if(E.path){var P=T.path,G=P.substring(0,P.lastIndexOf("/")+1)+E.path;k.path=c.normalizePath(G)}else k.path=T.path,E.params||(k.params=T.params,E.query||(k.query=T.query));return null===k.path&&(k.path=g.alwaysNormalize?c.normalizePath(E.path):E.path),c.buildURLFromParts(k)},parseURL:function(d){var m=i.exec(d);return m?{scheme:m[1]||"",netLoc:m[2]||"",path:m[3]||"",params:m[4]||"",query:m[5]||"",fragment:m[6]||""}:null},normalizePath:function(d){for(d=d.split("").reverse().join("").replace(s,"");d.length!==(d=d.replace(o,"")).length;);return d.split("").reverse().join("")},buildURLFromParts:function(d){return d.scheme+d.netLoc+d.path+d.params+d.query+d.fragment}};var $g=jm.exports;function Hg(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function hs(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?Hg(Object(t),!0).forEach(function(i){V0(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Hg(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function V0(n,e,t){return e=function zD(n){var e=function $0(n,e){if("object"!=typeof n||null===n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var i=t.call(n,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function vr(){return vr=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},vr.apply(this,arguments)}const Jt=Number.isFinite||function(n){return"number"==typeof n&&isFinite(n)};let N=function(n){return n.MEDIA_ATTACHING="hlsMediaAttaching",n.MEDIA_ATTACHED="hlsMediaAttached",n.MEDIA_DETACHING="hlsMediaDetaching",n.MEDIA_DETACHED="hlsMediaDetached",n.BUFFER_RESET="hlsBufferReset",n.BUFFER_CODECS="hlsBufferCodecs",n.BUFFER_CREATED="hlsBufferCreated",n.BUFFER_APPENDING="hlsBufferAppending",n.BUFFER_APPENDED="hlsBufferAppended",n.BUFFER_EOS="hlsBufferEos",n.BUFFER_FLUSHING="hlsBufferFlushing",n.BUFFER_FLUSHED="hlsBufferFlushed",n.MANIFEST_LOADING="hlsManifestLoading",n.MANIFEST_LOADED="hlsManifestLoaded",n.MANIFEST_PARSED="hlsManifestParsed",n.LEVEL_SWITCHING="hlsLevelSwitching",n.LEVEL_SWITCHED="hlsLevelSwitched",n.LEVEL_LOADING="hlsLevelLoading",n.LEVEL_LOADED="hlsLevelLoaded",n.LEVEL_UPDATED="hlsLevelUpdated",n.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",n.LEVELS_UPDATED="hlsLevelsUpdated",n.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",n.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",n.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",n.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",n.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",n.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",n.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",n.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",n.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",n.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",n.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",n.CUES_PARSED="hlsCuesParsed",n.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",n.INIT_PTS_FOUND="hlsInitPtsFound",n.FRAG_LOADING="hlsFragLoading",n.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",n.FRAG_LOADED="hlsFragLoaded",n.FRAG_DECRYPTED="hlsFragDecrypted",n.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",n.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",n.FRAG_PARSING_METADATA="hlsFragParsingMetadata",n.FRAG_PARSED="hlsFragParsed",n.FRAG_BUFFERED="hlsFragBuffered",n.FRAG_CHANGED="hlsFragChanged",n.FPS_DROP="hlsFpsDrop",n.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",n.ERROR="hlsError",n.DESTROYING="hlsDestroying",n.KEY_LOADING="hlsKeyLoading",n.KEY_LOADED="hlsKeyLoaded",n.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",n.BACK_BUFFER_REACHED="hlsBackBufferReached",n}({}),an=function(n){return n.NETWORK_ERROR="networkError",n.MEDIA_ERROR="mediaError",n.KEY_SYSTEM_ERROR="keySystemError",n.MUX_ERROR="muxError",n.OTHER_ERROR="otherError",n}({}),Me=function(n){return n.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",n.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",n.KEY_SYSTEM_NO_SESSION="keySystemNoSession",n.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",n.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",n.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",n.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",n.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",n.MANIFEST_LOAD_ERROR="manifestLoadError",n.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",n.MANIFEST_PARSING_ERROR="manifestParsingError",n.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",n.LEVEL_EMPTY_ERROR="levelEmptyError",n.LEVEL_LOAD_ERROR="levelLoadError",n.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",n.LEVEL_PARSING_ERROR="levelParsingError",n.LEVEL_SWITCH_ERROR="levelSwitchError",n.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",n.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",n.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",n.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",n.FRAG_LOAD_ERROR="fragLoadError",n.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",n.FRAG_DECRYPT_ERROR="fragDecryptError",n.FRAG_PARSING_ERROR="fragParsingError",n.FRAG_GAP="fragGap",n.REMUX_ALLOC_ERROR="remuxAllocError",n.KEY_LOAD_ERROR="keyLoadError",n.KEY_LOAD_TIMEOUT="keyLoadTimeOut",n.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",n.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",n.BUFFER_APPEND_ERROR="bufferAppendError",n.BUFFER_APPENDING_ERROR="bufferAppendingError",n.BUFFER_STALLED_ERROR="bufferStalledError",n.BUFFER_FULL_ERROR="bufferFullError",n.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",n.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",n.INTERNAL_EXCEPTION="internalException",n.INTERNAL_ABORTED="aborted",n.UNKNOWN="unknown",n}({});const Xc=function(){},H0={trace:Xc,debug:Xc,log:Xc,warn:Xc,info:Xc,error:Xc};let Gm=H0;const ce=Gm,j0=/^(\d+)x(\d+)$/,G0=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Ui{constructor(e){"string"==typeof e&&(e=Ui.parseAttrList(e));for(const t in e)e.hasOwnProperty(t)&&("X-"===t.substring(0,2)&&(this.clientAttrs=this.clientAttrs||[],this.clientAttrs.push(t)),this[t]=e[t])}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;const i=new Uint8Array(t.length/2);for(let r=0;r<t.length/2;r++)i[r]=parseInt(t.slice(2*r,2*r+2),16);return i}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const i=this[e];return i?parseFloat(i):t}enumeratedString(e){return this[e]}bool(e){return"YES"===this[e]}decimalResolution(e){const t=j0.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const i={};for(G0.lastIndex=0;null!==(t=G0.exec(e));){let s=t[2];0===s.indexOf('"')&&s.lastIndexOf('"')===s.length-1&&(s=s.slice(1,-1)),i[t[1].trim()]=s}return i}}function YD(n){return"SCTE35-OUT"===n||"SCTE35-IN"===n}class z0{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const i=t.attr;for(const r in i)if(Object.prototype.hasOwnProperty.call(e,r)&&e[r]!==i[r]){ce.warn(`DATERANGE tag attribute: "${r}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=r;break}e=vr(new Ui({}),i,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const i=new Date(this.attr["END-DATE"]);Jt(i.getTime())&&(this._endDate=i)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return null!==e?new Date(this._startDate.getTime()+1e3*e):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(Jt(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&Jt(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class jg{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var hi={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class Gg{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[hi.AUDIO]:null,[hi.VIDEO]:null,[hi.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const i=e.split("@",2),r=[];r[0]=1===i.length?t?t.byteRangeEndOffset:0:parseInt(i[1]),r[1]=parseInt(i[0])+r[0],this._byteRange=r}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=$g.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class W0 extends Gg{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new jg,this.urlId=0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const i=Object.keys(this.levelkeys);if(1===i.length)return this._decryptdata=this.levelkeys[i[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime||!Jt(this.programDateTime))return null;const e=Jt(this.duration)?this.duration:0;return this.programDateTime+1e3*e}get encrypted(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),i=t.length;if(i>1||1===i&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()}setElementaryStreamInfo(e,t,i,r,s,o=!1){const{elementaryStreams:c}=this,d=c[e];d?(d.startPTS=Math.min(d.startPTS,t),d.endPTS=Math.max(d.endPTS,i),d.startDTS=Math.min(d.startDTS,r),d.endDTS=Math.max(d.endDTS,s)):c[e]={startPTS:t,endPTS:i,startDTS:r,endDTS:s,partial:o}}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[hi.AUDIO]=null,e[hi.VIDEO]=null,e[hi.AUDIOVIDEO]=null}}class ZD extends Gg{constructor(e,t,i,r,s){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new jg,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=r;const o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,s),s&&(this.fragOffset=s.fragOffset+s.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}class XD{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e)return this.advanced=!0,void(this.updated=!0);const t=this.lastPartSn-e.lastPartSn,i=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!i||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||0===t&&i>0,this.misses=this.updated||this.advanced?Math.floor(.6*e.misses):e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return!!this.fragments.length&&Jt(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?1e3*(this.driftEnd-this.driftStart)/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function K0(n){return Uint8Array.from(atob(n),e=>e.charCodeAt(0))}function vx(n){return Uint8Array.from(unescape(encodeURIComponent(n)),e=>e.charCodeAt(0))}var Ai={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Qs={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function bx(n){switch(n){case Qs.FAIRPLAY:return Ai.FAIRPLAY;case Qs.PLAYREADY:return Ai.PLAYREADY;case Qs.WIDEVINE:return Ai.WIDEVINE;case Qs.CLEARKEY:return Ai.CLEARKEY}}var wx_WIDEVINE="edef8ba979d64acea3c827dcd51d21ed";function Ex(n){switch(n){case Ai.FAIRPLAY:return Qs.FAIRPLAY;case Ai.PLAYREADY:return Qs.PLAYREADY;case Ai.WIDEVINE:return Qs.WIDEVINE;case Ai.CLEARKEY:return Qs.CLEARKEY}}function Z0(n){const{drmSystems:e,widevineLicenseUrl:t}=n,i=e?[Ai.FAIRPLAY,Ai.WIDEVINE,Ai.PLAYREADY,Ai.CLEARKEY].filter(r=>!!e[r]):[];return!i[Ai.WIDEVINE]&&t&&i.push(Ai.WIDEVINE),i}const zm=typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;function Oh(n,e,t){return Uint8Array.prototype.slice?n.slice(e,t):new Uint8Array(Array.prototype.slice.call(n,e,t))}const Wm=(n,e)=>e+10<=n.length&&73===n[e]&&68===n[e+1]&&51===n[e+2]&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128,eA=(n,e)=>e+10<=n.length&&51===n[e]&&68===n[e+1]&&73===n[e+2]&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128,Km=(n,e)=>{const t=e;let i=0;for(;Wm(n,e);)i+=10,i+=qm(n,e+6),eA(n,e+10)&&(i+=10),e+=i;if(i>0)return n.subarray(t,t+i)},qm=(n,e)=>{let t=0;return t=(127&n[e])<<21,t|=(127&n[e+1])<<14,t|=(127&n[e+2])<<7,t|=127&n[e+3],t},xx=(n,e)=>Wm(n,e)&&qm(n,e+6)+10<=n.length-e,Kg=n=>n&&"PRIV"===n.key&&"com.apple.streaming.transportStreamTimestamp"===n.info,Zl=n=>{const e=String.fromCharCode(n[0],n[1],n[2],n[3]),t=qm(n,4);return{type:e,size:t,data:n.subarray(10,10+t)}},Ym=n=>{let e=0;const t=[];for(;Wm(n,e);){const i=qm(n,e+6);e+=10;const r=e+i;for(;e+8<r;){const s=Zl(n.subarray(e)),o=qg(s);o&&t.push(o),e+=s.size+10}eA(n,e)&&(e+=10)}return t},qg=n=>"PRIV"===n.type?Zm(n):"W"===n.type[0]?Ix(n):tA(n),Zm=n=>{if(n.size<2)return;const e=cl(n.data,!0),t=new Uint8Array(n.data.subarray(e.length+1));return{key:n.type,info:e,data:t.buffer}},tA=n=>{if(n.size<2)return;if("TXXX"===n.type){let t=1;const i=cl(n.data.subarray(t),!0);t+=i.length+1;const r=cl(n.data.subarray(t));return{key:n.type,info:i,data:r}}const e=cl(n.data.subarray(1));return{key:n.type,data:e}},Ix=n=>{if("WXXX"===n.type){if(n.size<2)return;let t=1;const i=cl(n.data.subarray(t),!0);t+=i.length+1;const r=cl(n.data.subarray(t));return{key:n.type,info:i,data:r}}const e=cl(n.data);return{key:n.type,data:e}},Sx=n=>{if(8===n.data.byteLength){const e=new Uint8Array(n.data);let i=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return i/=45,1&e[3]&&(i+=47721858.84),Math.round(i)}},cl=(n,e=!1)=>{const t=function Qm(){return!Q0&&typeof self.TextDecoder<"u"&&(Q0=new self.TextDecoder("utf-8")),Q0}();if(t){const m=t.decode(n);if(e){const g=m.indexOf("\0");return-1!==g?m.substring(0,g):m}return m.replace(/\0/g,"")}const i=n.length;let r,s,o,c="",d=0;for(;d<i;){if(r=n[d++],0===r&&e)return c;if(0!==r&&3!==r)switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c+=String.fromCharCode(r);break;case 12:case 13:s=n[d++],c+=String.fromCharCode((31&r)<<6|63&s);break;case 14:s=n[d++],o=n[d++],c+=String.fromCharCode((15&r)<<12|(63&s)<<6|(63&o)<<0)}}return c};let Q0;const ul_hexDump=function(n){let e="";for(let t=0;t<n.length;t++){let i=n[t].toString(16);i.length<2&&(i="0"+i),e+=i}return e},X0=Math.pow(2,32)-1,nA=[].push,Cx={video:1,audio:2,id3:3,text:4};function qr(n){return String.fromCharCode.apply(null,n)}function Dx(n,e){const t=n[e]<<8|n[e+1];return t<0?65536+t:t}function pn(n,e){const t=Ax(n,e);return t<0?4294967296+t:t}function Ax(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}function J0(n,e,t){n[e]=t>>24,n[e+1]=t>>16&255,n[e+2]=t>>8&255,n[e+3]=255&t}function Bn(n,e){const t=[];if(!e.length)return t;const i=n.byteLength;for(let r=0;r<i;){const s=pn(n,r),c=s>1?r+s:i;if(qr(n.subarray(r+4,r+8))===e[0])if(1===e.length)t.push(n.subarray(r+8,c));else{const d=Bn(n.subarray(r+8,c),e.slice(1));d.length&&nA.apply(t,d)}r=c}return t}function ev(n){const e=[],t=n[0];let i=8;const r=pn(n,i);i+=4,i+=0===t?8:16,i+=2;let c=n.length+0;const d=Dx(n,i);i+=2;for(let m=0;m<d;m++){let g=i;const v=pn(n,g);g+=4;const E=2147483647&v;if((2147483648&v)>>>31==1)return ce.warn("SIDX has hierarchical references (not supported)"),null;const C=pn(n,g);g+=4,e.push({referenceSize:E,subsegmentDuration:C,info:{duration:C/r,start:c,end:c+E-1}}),c+=E,g+=4,i=g}return{earliestPresentationTime:0,timescale:r,version:t,referencesCount:d,references:e}}function Rx(n){const e=[],t=Bn(n,["moov","trak"]);for(let r=0;r<t.length;r++){const s=t[r],o=Bn(s,["tkhd"])[0];if(o){let c=o[0],d=0===c?12:20;const m=pn(o,d),g=Bn(s,["mdia","mdhd"])[0];if(g){c=g[0],d=0===c?12:20;const v=pn(g,d),E=Bn(s,["mdia","hdlr"])[0];if(E){const T=qr(E.subarray(8,12)),C={soun:hi.AUDIO,vide:hi.VIDEO}[T];if(C){const k=Bn(s,["mdia","minf","stbl","stsd"])[0];let P;k&&(P=qr(k.subarray(12,16))),e[m]={timescale:v,type:C},e[C]={timescale:v,id:m,codec:P}}}}}}return Bn(n,["moov","mvex","trex"]).forEach(r=>{const s=pn(r,4),o=e[s];o&&(o.default={duration:pn(r,12),flags:pn(r,20)})}),e}function kx(n){const e=Bn(n,["schm"])[0];if(e){const t=qr(e.subarray(4,8));if("cbcs"===t||"cenc"===t)return Bn(n,["schi","tenc"])[0]}return ce.error("[eme] missing 'schm' box"),null}function sA(n){const e=pn(n,0);let t=8;1&e&&(t+=4),4&e&&(t+=4);let i=0;const r=pn(n,4);for(let s=0;s<r;s++)256&e&&(i+=pn(n,t),t+=4),512&e&&(t+=4),1024&e&&(t+=4),2048&e&&(t+=4);return i}function td(n,e){const t=new Uint8Array(n.length+e.length);return t.set(n),t.set(e,n.length),t}function nv(n,e){const t=[],i=e.samples,r=e.timescale,s=e.id;let o=!1;return Bn(i,["moof"]).map(d=>{const m=d.byteOffset-8;Bn(d,["traf"]).map(v=>{const E=Bn(v,["tfdt"]).map(T=>{const C=T[0];let k=pn(T,4);return 1===C&&(k*=Math.pow(2,32),k+=pn(T,8)),k/r})[0];return void 0!==E&&(n=E),Bn(v,["tfhd"]).map(T=>{const C=pn(T,4),k=16777215&pn(T,0);let W=0;const te=0!=(16&k);let oe=0;const Ae=0!=(32&k);let we=8;C===s&&(0!=(1&k)&&(we+=8),0!=(2&k)&&(we+=4),0!=(8&k)&&(W=pn(T,we),we+=4),te&&(oe=pn(T,we),we+=4),Ae&&(we+=4),"video"===e.type&&(o=function Mx(n){if(!n)return!1;const e=n.indexOf("."),t=e<0?n:n.substring(0,e);return"hvc1"===t||"hev1"===t||"dvh1"===t||"dvhe"===t}(e.codec)),Bn(v,["trun"]).map(Ge=>{const rt=Ge[0],Pe=16777215&pn(Ge,0),Xt=0!=(1&Pe);let yt=0;const Fn=0!=(4&Pe),Lr=0!=(256&Pe);let pi=0;const ct=0!=(512&Pe);let pt=0;const $e=0!=(1024&Pe),dt=0!=(2048&Pe);let wn=0;const Hn=pn(Ge,4);let xn=8;Xt&&(yt=pn(Ge,xn),xn+=4),Fn&&(xn+=4);let vi=yt+m;for(let jn=0;jn<Hn;jn++){if(Lr?(pi=pn(Ge,xn),xn+=4):pi=W,ct?(pt=pn(Ge,xn),xn+=4):pt=oe,$e&&(xn+=4),dt&&(wn=0===rt?pn(Ge,xn):Ax(Ge,xn),xn+=4),e.type===hi.VIDEO){let ia=0;for(;ia<pt;){const ra=pn(i,vi);vi+=4,lA(o,i[vi])&&cA(i.subarray(vi,vi+ra),o?2:1,n+wn/r,t),vi+=ra,ia+=ra+4}}n+=pi/r}}))})})}),t}function lA(n,e){if(n){const t=e>>1&63;return 39===t||40===t}return 6==(31&e)}function cA(n,e,t,i){const r=iv(n);let s=0;s+=e;let o=0,c=0,d=!1,m=0;for(;s<r.length;){o=0;do{if(s>=r.length)break;m=r[s++],o+=m}while(255===m);c=0;do{if(s>=r.length)break;m=r[s++],c+=m}while(255===m);const g=r.length-s;if(!d&&4===o&&s<r.length){if(d=!0,181===r[s++]){const E=Dx(r,s);if(s+=2,49===E){const T=pn(r,s);if(s+=4,1195456820===T){const C=r[s++];if(3===C){const k=r[s++],G=64&k,Y=G?2+3*(31&k):0,W=new Uint8Array(Y);if(G){W[0]=k;for(let te=1;te<Y;te++)W[te]=r[s++]}i.push({type:C,payloadType:o,pts:t,bytes:W})}}}}}else if(5===o&&c<g){if(d=!0,c>16){const v=[];for(let C=0;C<16;C++){const k=r[s++].toString(16);v.push(1==k.length?"0"+k:k),(3===C||5===C||7===C||9===C)&&v.push("-")}const E=c-16,T=new Uint8Array(E);for(let C=0;C<E;C++)T[C]=r[s++];i.push({payloadType:o,pts:t,uuid:v.join(""),userData:cl(T),userDataBytes:T})}}else if(c<g)s+=c;else if(c>g)break}}function iv(n){const e=n.byteLength,t=[];let i=1;for(;i<e-2;)0===n[i]&&0===n[i+1]&&3===n[i+2]?(t.push(i+2),i+=2):i++;if(0===t.length)return n;const r=e-t.length,s=new Uint8Array(r);let o=0;for(i=0;i<r;o++,i++)o===t[0]&&(o++,t.shift()),s[i]=n[o];return s}let Ph={};class Xm{static clearKeyUriToKeyIdMap(){Ph={}}constructor(e,t,i,r=[1],s=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=i,this.keyFormatVersions=r,this.iv=s,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&"AES-128"!==e}isSupported(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case Qs.FAIRPLAY:case Qs.WIDEVINE:case Qs.PLAYREADY:case Qs.CLEARKEY:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!=typeof e&&("AES-128"===this.method&&!this.iv&&ce.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const i=function dl(n){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=n>>8*(15-t)&255;return e}(e);return new Xm(this.method,this.uri,"identity",this.keyFormatVersions,i)}const t=function JD(n){const e=n.split(":");let t=null;if("data"===e[0]&&2===e.length){const i=e[1].split(";"),r=i[i.length-1].split(",");if(2===r.length){const o=r[1];"base64"===r[0]?(i.splice(-1,1),t=K0(o)):t=function ll(n){const e=vx(n).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}(o)}}return t}(this.uri);if(t)switch(this.keyFormat){case Qs.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case Qs.PLAYREADY:{const i=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=function uA(n,e,t){if(16!==n.byteLength)throw new RangeError("Invalid system id");let i,r,s;if(e){i=1,r=new Uint8Array(16*e.length);for(let c=0;c<e.length;c++){const d=e[c];if(16!==d.byteLength)throw new RangeError("Invalid key");r.set(d,16*c)}}else i=0,r=new Uint8Array;i>0?(s=new Uint8Array(4),e.length>0&&new DataView(s.buffer).setUint32(0,e.length,!1)):s=new Uint8Array;const o=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(o.buffer).setUint32(0,t.byteLength,!1),function Yg(n,...e){const t=e.length;let i=8,r=t;for(;r--;)i+=e[r].byteLength;const s=new Uint8Array(i);for(s[0]=i>>24&255,s[1]=i>>16&255,s[2]=i>>8&255,s[3]=255&i,s.set(n,4),r=0,i=8;r<t;r++)s.set(e[r],i),i+=e[r].byteLength;return s}([112,115,115,104],new Uint8Array([i,0,0,0]),n,s,r,o,t||new Uint8Array)}(i,null,t);const r=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),s=String.fromCharCode.apply(null,Array.from(r)),o=s.substring(s.indexOf("<"),s.length),m=(new DOMParser).parseFromString(o,"text/xml").getElementsByTagName("KID")[0];if(m){const g=m.childNodes[0]?m.childNodes[0].nodeValue:m.getAttribute("VALUE");if(g){const v=K0(g).subarray(0,16);(function q0(n){const e=function(i,r,s){const o=i[r];i[r]=i[s],i[s]=o};e(n,0,3),e(n,1,2),e(n,4,5),e(n,6,7)})(v),this.keyId=v}}break}default:{let i=t.subarray(0,16);if(16!==i.length){const r=new Uint8Array(16);r.set(i,16-i.length),i=r}this.keyId=i;break}}if(!this.keyId||16!==this.keyId.byteLength){let i=Ph[this.uri];if(!i){const r=Object.keys(Ph).length%Number.MAX_SAFE_INTEGER;i=new Uint8Array(16),new DataView(i.buffer,12,4).setUint32(0,r),Ph[this.uri]=i}this.keyId=i}return this}}const Nh=/\{\$([a-zA-Z0-9-_]+)\}/g;function Yr(n){return Nh.test(n)}function br(n,e,t){if(null!==n.variableList||n.hasVariableRefs)for(let i=t.length;i--;){const r=t[i],s=e[r];s&&(e[r]=Fh(n,s))}}function Fh(n,e){if(null!==n.variableList||n.hasVariableRefs){const t=n.variableList;return e.replace(Nh,i=>{const r=i.substring(2,i.length-1),s=t?.[r];return void 0===s?(n.playlistParsingError||(n.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),i):s})}return e}function xo(n,e,t){let r,s,i=n.variableList;if(i||(n.variableList=i={}),"QUERYPARAM"in e){r=e.QUERYPARAM;try{const o=new self.URL(t).searchParams;if(!o.has(r))throw new Error(`"${r}" does not match any query parameter in URI: "${t}"`);s=o.get(r)}catch(o){n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else r=e.NAME,s=e.VALUE;r in i?n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):i[r]=s||""}function rv(n,e,t){const i=e.IMPORT;if(t&&i in t){let r=n.variableList;r||(n.variableList=r={}),r[i]=t[i]}else n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}function Ql(){if(!(typeof self>"u"))return self.MediaSource||self.WebKitMediaSource}const Bh={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}},nd=Ql();function Jc(n,e){var t;return null!=(t=nd?.isTypeSupported(`${e||"video"}/mp4;codecs="${n}"`))&&t}const id=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,rd=/#EXT-X-MEDIA:(.*)/g,Vh=/^#EXT(?:INF|-X-TARGETDURATION):/m,sd=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),Lx=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class qo{static findGroup(e,t){for(let i=0;i<e.length;i++){const r=e[i];if(r.id===t)return r}}static convertAVC1ToAVCOTI(e){const t=e.split(".");if(t.length>2){let i=t.shift()+".";return i+=parseInt(t.shift()).toString(16),i+=("000"+parseInt(t.shift()).toString(16)).slice(-4),i}return e}static resolve(e,t){return $g.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return Vh.test(e)}static parseMasterPlaylist(e,t){const r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:Yr(e)},s=[];let o;for(id.lastIndex=0;null!=(o=id.exec(e));)if(o[1]){var c;const m=new Ui(o[1]);br(r,m,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const g=Fh(r,o[2]),v={attrs:m,bitrate:m.decimalInteger("AVERAGE-BANDWIDTH")||m.decimalInteger("BANDWIDTH"),name:m.NAME,url:qo.resolve(g,t)},E=m.decimalResolution("RESOLUTION");E&&(v.width=E.width,v.height=E.height),Ox((m.CODECS||"").split(/[ ,]+/).filter(T=>T),v),v.videoCodec&&-1!==v.videoCodec.indexOf("avc1")&&(v.videoCodec=qo.convertAVC1ToAVCOTI(v.videoCodec)),null!=(c=v.unknownCodecs)&&c.length||s.push(v),r.levels.push(v)}else if(o[3]){const g=o[4];switch(o[3]){case"SESSION-DATA":{const v=new Ui(g);br(r,v,["DATA-ID","LANGUAGE","VALUE","URI"]);const E=v["DATA-ID"];E&&(null===r.sessionData&&(r.sessionData={}),r.sessionData[E]=v);break}case"SESSION-KEY":{const v=sv(g,t,r);v.encrypted&&v.isSupported()?(null===r.sessionKeys&&(r.sessionKeys=[]),r.sessionKeys.push(v)):ce.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${g}"`);break}case"DEFINE":{const v=new Ui(g);br(r,v,["NAME","VALUE","QUERYPARAM"]),xo(r,v,t)}break;case"CONTENT-STEERING":{const v=new Ui(g);br(r,v,["SERVER-URI","PATHWAY-ID"]),r.contentSteering={uri:qo.resolve(v["SERVER-URI"],t),pathwayId:v["PATHWAY-ID"]||"."};break}case"START":r.startTimeOffset=ov(g)}}return r.levels=s.length>0&&s.length<r.levels.length?s:r.levels,0===r.levels.length&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(e,t,i){let r;const s={},o=i.levels,c={AUDIO:o.map(m=>({id:m.attrs.AUDIO,audioCodec:m.audioCodec})),SUBTITLES:o.map(m=>({id:m.attrs.SUBTITLES,textCodec:m.textCodec})),"CLOSED-CAPTIONS":[]};let d=0;for(rd.lastIndex=0;null!==(r=rd.exec(e));){const m=new Ui(r[1]),g=m.TYPE;if(g){const v=c[g],E=s[g]||[];s[g]=E,br(i,m,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const T={attrs:m,bitrate:0,id:d++,groupId:m["GROUP-ID"]||"",instreamId:m["INSTREAM-ID"],name:m.NAME||m.LANGUAGE||"",type:g,default:m.bool("DEFAULT"),autoselect:m.bool("AUTOSELECT"),forced:m.bool("FORCED"),lang:m.LANGUAGE,url:m.URI?qo.resolve(m.URI,t):""};if(null!=v&&v.length){const C=qo.findGroup(v,T.groupId)||v[0];av(T,C,"audioCodec"),av(T,C,"textCodec")}E.push(T)}}return s}static parseLevelPlaylist(e,t,i,r,s,o){const c=new XD(t),d=c.fragments;let P,G,Y,m=null,g=0,v=0,E=0,T=0,C=null,k=new W0(r,t),W=-1,te=!1;for(sd.lastIndex=0,c.m3u8=e,c.hasVariableRefs=Yr(e);null!==(P=sd.exec(e));){te&&(te=!1,k=new W0(r,t),k.start=E,k.sn=g,k.cc=T,k.level=i,m&&(k.initSegment=m,k.rawProgramDateTime=m.rawProgramDateTime,m.rawProgramDateTime=null));const Ge=P[1];if(Ge){k.duration=parseFloat(Ge);const rt=(" "+P[2]).slice(1);k.title=rt||null,k.tagList.push(rt?["INF",Ge,rt]:["INF",Ge])}else if(P[3]){if(Jt(k.duration)){k.start=E,Y&&Nx(k,Y,c),k.sn=g,k.level=i,k.cc=T,k.urlId=s,d.push(k);const rt=(" "+P[3]).slice(1);k.relurl=Fh(c,rt),lv(k,C),C=k,E+=k.duration,g++,v=0,te=!0}}else if(P[4]){const rt=(" "+P[4]).slice(1);C?k.setByteRange(rt,C):k.setByteRange(rt)}else if(P[5])k.rawProgramDateTime=(" "+P[5]).slice(1),k.tagList.push(["PROGRAM-DATE-TIME",k.rawProgramDateTime]),-1===W&&(W=d.length);else{if(P=P[0].match(Lx),!P){ce.warn("No matches on slow regex match for level playlist!");continue}for(G=1;G<P.length&&!(typeof P[G]<"u");G++);const rt=(" "+P[G]).slice(1),Pe=(" "+P[G+1]).slice(1),Xt=P[G+2]?(" "+P[G+2]).slice(1):"";switch(rt){case"PLAYLIST-TYPE":c.type=Pe.toUpperCase();break;case"MEDIA-SEQUENCE":g=c.startSN=parseInt(Pe);break;case"SKIP":{const yt=new Ui(Pe);br(c,yt,["RECENTLY-REMOVED-DATERANGES"]);const Fn=yt.decimalInteger("SKIPPED-SEGMENTS");if(Jt(Fn)){c.skippedSegments=Fn;for(let pi=Fn;pi--;)d.unshift(null);g+=Fn}const Lr=yt.enumeratedString("RECENTLY-REMOVED-DATERANGES");Lr&&(c.recentlyRemovedDateranges=Lr.split("\t"));break}case"TARGETDURATION":c.targetduration=Math.max(parseInt(Pe),1);break;case"VERSION":c.version=parseInt(Pe);break;case"EXTM3U":break;case"ENDLIST":c.live=!1;break;case"#":(Pe||Xt)&&k.tagList.push(Xt?[Pe,Xt]:[Pe]);break;case"DISCONTINUITY":T++,k.tagList.push(["DIS"]);break;case"GAP":k.gap=!0,k.tagList.push([rt]);break;case"BITRATE":k.tagList.push([rt,Pe]);break;case"DATERANGE":{const yt=new Ui(Pe);br(c,yt,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),br(c,yt,yt.clientAttrs);const Fn=new z0(yt,c.dateRanges[yt.ID]);Fn.isValid||c.skippedSegments?c.dateRanges[Fn.id]=Fn:ce.warn(`Ignoring invalid DATERANGE tag: "${Pe}"`),k.tagList.push(["EXT-X-DATERANGE",Pe]);break}case"DEFINE":{const yt=new Ui(Pe);br(c,yt,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in yt?rv(c,yt,o):xo(c,yt,t)}break;case"DISCONTINUITY-SEQUENCE":T=parseInt(Pe);break;case"KEY":{const yt=sv(Pe,t,c);if(yt.isSupported()){if("NONE"===yt.method){Y=void 0;break}Y||(Y={}),Y[yt.keyFormat]&&(Y=vr({},Y)),Y[yt.keyFormat]=yt}else ce.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${Pe}"`);break}case"START":c.startTimeOffset=ov(Pe);break;case"MAP":{const yt=new Ui(Pe);if(br(c,yt,["BYTERANGE","URI"]),k.duration){const Fn=new W0(r,t);cv(Fn,yt,i,Y),m=Fn,k.initSegment=m,m.rawProgramDateTime&&!k.rawProgramDateTime&&(k.rawProgramDateTime=m.rawProgramDateTime)}else cv(k,yt,i,Y),m=k,te=!0;break}case"SERVER-CONTROL":{const yt=new Ui(Pe);c.canBlockReload=yt.bool("CAN-BLOCK-RELOAD"),c.canSkipUntil=yt.optionalFloat("CAN-SKIP-UNTIL",0),c.canSkipDateRanges=c.canSkipUntil>0&&yt.bool("CAN-SKIP-DATERANGES"),c.partHoldBack=yt.optionalFloat("PART-HOLD-BACK",0),c.holdBack=yt.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const yt=new Ui(Pe);c.partTarget=yt.decimalFloatingPoint("PART-TARGET");break}case"PART":{let yt=c.partList;yt||(yt=c.partList=[]);const Fn=v>0?yt[yt.length-1]:void 0,Lr=v++,pi=new Ui(Pe);br(c,pi,["BYTERANGE","URI"]);const ct=new ZD(pi,k,t,Lr,Fn);yt.push(ct),k.duration+=ct.duration;break}case"PRELOAD-HINT":{const yt=new Ui(Pe);br(c,yt,["URI"]),c.preloadHint=yt;break}case"RENDITION-REPORT":{const yt=new Ui(Pe);br(c,yt,["URI"]),c.renditionReports=c.renditionReports||[],c.renditionReports.push(yt);break}default:ce.warn(`line parsed but not handled: ${P}`)}}}C&&!C.relurl?(d.pop(),E-=C.duration,c.partList&&(c.fragmentHint=C)):c.partList&&(lv(k,C),k.cc=T,c.fragmentHint=k,Y&&Nx(k,Y,c));const oe=d.length,Ae=d[0],we=d[oe-1];if(E+=c.skippedSegments*c.targetduration,E>0&&oe&&we){c.averagetargetduration=E/oe;const Ge=we.sn;c.endSN="initSegment"!==Ge?Ge:0,c.live||(we.endList=!0),Ae&&(c.startCC=Ae.cc)}else c.endSN=0,c.startCC=0;return c.fragmentHint&&(E+=c.fragmentHint.duration),c.totalduration=E,c.endCC=T,W>0&&function Px(n,e){let t=n[e];for(let i=e;i--;){const r=n[i];if(!r)return;r.programDateTime=t.programDateTime-1e3*r.duration,t=r}}(d,W),c}}function sv(n,e,t){var i,r;const s=new Ui(n);br(t,s,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const o=null!=(i=s.METHOD)?i:"",c=s.URI,d=s.hexadecimalInteger("IV"),m=s.KEYFORMATVERSIONS,g=null!=(r=s.KEYFORMAT)?r:"identity";c&&s.IV&&!d&&ce.error(`Invalid IV: ${s.IV}`);const v=c?qo.resolve(c,e):"",E=(m||"1").split("/").map(Number).filter(Number.isFinite);return new Xm(o,v,g,E,d)}function ov(n){const t=new Ui(n).decimalFloatingPoint("TIME-OFFSET");return Jt(t)?t:null}function Ox(n,e){["video","audio","text"].forEach(t=>{const i=n.filter(r=>function Uh(n,e){const t=Bh[e];return!!t&&!0===t[n.slice(0,4)]}(r,t));if(i.length){const r=i.filter(s=>0===s.lastIndexOf("avc1",0)||0===s.lastIndexOf("mp4a",0));e[`${t}Codec`]=r.length>0?r[0]:i[0],n=n.filter(s=>-1===i.indexOf(s))}}),e.unknownCodecs=n}function av(n,e,t){const i=e[t];i&&(n[t]=i)}function lv(n,e){n.rawProgramDateTime?n.programDateTime=Date.parse(n.rawProgramDateTime):null!=e&&e.programDateTime&&(n.programDateTime=e.endProgramDateTime),Jt(n.programDateTime)||(n.programDateTime=null,n.rawProgramDateTime=null)}function cv(n,e,t,i){n.relurl=e.URI,e.BYTERANGE&&n.setByteRange(e.BYTERANGE),n.level=t,n.sn="initSegment",i&&(n.levelkeys=i),n.initSegment=null}function Nx(n,e,t){n.levelkeys=e;const{encryptedFragments:i}=t;(!i.length||i[i.length-1].levelkeys!==e)&&Object.keys(e).some(r=>e[r].isCommonEncryption)&&i.push(n)}var Qn={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},ln={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function Fx(n){const{type:e}=n;switch(e){case Qn.AUDIO_TRACK:return ln.AUDIO;case Qn.SUBTITLE_TRACK:return ln.SUBTITLE;default:return ln.MAIN}}function Zg(n,e){let t=n.url;return(void 0===t||0===t.indexOf("data:"))&&(t=e.url),t}class uv{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.LEVEL_LOADING,this.onLevelLoading,this),e.on(N.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(N.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.LEVEL_LOADING,this.onLevelLoading,this),e.off(N.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(N.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,o=new(t.pLoader||t.loader)(t);return this.loaders[e.type]=o,o}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:i}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Qn.MANIFEST,url:i,deliveryDirectives:null})}onLevelLoading(e,t){const{id:i,level:r,url:s,deliveryDirectives:o}=t;this.load({id:i,level:r,responseType:"text",type:Qn.LEVEL,url:s,deliveryDirectives:o})}onAudioTrackLoading(e,t){const{id:i,groupId:r,url:s,deliveryDirectives:o}=t;this.load({id:i,groupId:r,level:null,responseType:"text",type:Qn.AUDIO_TRACK,url:s,deliveryDirectives:o})}onSubtitleTrackLoading(e,t){const{id:i,groupId:r,url:s,deliveryDirectives:o}=t;this.load({id:i,groupId:r,level:null,responseType:"text",type:Qn.SUBTITLE_TRACK,url:s,deliveryDirectives:o})}load(e){var t;const i=this.hls.config;let s,r=this.getInternalLoader(e);if(r){const m=r.context;if(m&&m.url===e.url)return void ce.trace("[playlist-loader]: playlist request ongoing");ce.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}if(s=e.type===Qn.MANIFEST?i.manifestLoadPolicy.default:vr({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),null!=(t=e.deliveryDirectives)&&t.part){let m;if(e.type===Qn.LEVEL&&null!==e.level?m=this.hls.levels[e.level].details:e.type===Qn.AUDIO_TRACK&&null!==e.id?m=this.hls.audioTracks[e.id].details:e.type===Qn.SUBTITLE_TRACK&&null!==e.id&&(m=this.hls.subtitleTracks[e.id].details),m){const g=m.partTarget,v=m.targetduration;if(g&&v){const E=1e3*Math.max(3*g,.8*v);s=vr({},s,{maxTimeToFirstByteMs:Math.min(E,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(E,s.maxTimeToFirstByteMs)})}}}const o=s.errorRetry||s.timeoutRetry||{};r.load(e,{loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},{onSuccess:(m,g,v,E)=>{const T=this.getInternalLoader(v);this.resetInternalLoader(v.type);const C=m.data;0===C.indexOf("#EXTM3U")?(g.parsing.start=performance.now(),qo.isMediaPlaylist(C)?this.handleTrackOrLevelPlaylist(m,g,v,E||null,T):this.handleMasterPlaylist(m,g,v,E)):this.handleManifestParsingError(m,v,new Error("no EXTM3U delimiter"),E||null,g)},onError:(m,g,v,E)=>{this.handleNetworkError(g,v,!1,m,E)},onTimeout:(m,g,v)=>{this.handleNetworkError(g,v,!0,void 0,m)}})}handleMasterPlaylist(e,t,i,r){const s=this.hls,o=e.data,c=Zg(e,i),d=qo.parseMasterPlaylist(o,c);if(d.playlistParsingError)return void this.handleManifestParsingError(e,i,d.playlistParsingError,r,t);const{contentSteering:m,levels:g,sessionData:v,sessionKeys:E,startTimeOffset:T,variableList:C}=d;this.variableList=C;const{AUDIO:k=[],SUBTITLES:P,"CLOSED-CAPTIONS":G}=qo.parseMasterPlaylistMedia(o,c,d);k.length&&!k.some(W=>!W.url)&&g[0].audioCodec&&!g[0].attrs.AUDIO&&(ce.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),k.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Ui({}),bitrate:0,url:""})),s.trigger(N.MANIFEST_LOADED,{levels:g,audioTracks:k,subtitles:P,captions:G,contentSteering:m,url:c,stats:t,networkDetails:r,sessionData:v,sessionKeys:E,startTimeOffset:T,variableList:C})}handleTrackOrLevelPlaylist(e,t,i,r,s){const o=this.hls,{id:c,level:d,type:m}=i,g=Zg(e,i),v=Jt(c)?c:0,E=Jt(d)?d:v,T=Fx(i),C=qo.parseLevelPlaylist(e.data,g,E,T,v,this.variableList);if(m===Qn.MANIFEST){const k={attrs:new Ui({}),bitrate:0,details:C,name:"",url:g};o.trigger(N.MANIFEST_LOADED,{levels:[k],audioTracks:[],url:g,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),i.levelDetails=C,this.handlePlaylistLoaded(C,e,t,i,r,s)}handleManifestParsingError(e,t,i,r,s){this.hls.trigger(N.ERROR,{type:an.NETWORK_ERROR,details:Me.MANIFEST_PARSING_ERROR,fatal:t.type===Qn.MANIFEST,url:e.url,err:i,error:i,reason:i.message,response:e,context:t,networkDetails:r,stats:s})}handleNetworkError(e,t,i=!1,r,s){let o=`A network ${i?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${e.type}`;e.type===Qn.LEVEL?o+=`: ${e.level} id: ${e.id}`:(e.type===Qn.AUDIO_TRACK||e.type===Qn.SUBTITLE_TRACK)&&(o+=` id: ${e.id} group-id: "${e.groupId}"`);const c=new Error(o);ce.warn(`[playlist-loader]: ${o}`);let d=Me.UNKNOWN,m=!1;const g=this.getInternalLoader(e);switch(e.type){case Qn.MANIFEST:d=i?Me.MANIFEST_LOAD_TIMEOUT:Me.MANIFEST_LOAD_ERROR,m=!0;break;case Qn.LEVEL:d=i?Me.LEVEL_LOAD_TIMEOUT:Me.LEVEL_LOAD_ERROR,m=!1;break;case Qn.AUDIO_TRACK:d=i?Me.AUDIO_TRACK_LOAD_TIMEOUT:Me.AUDIO_TRACK_LOAD_ERROR,m=!1;break;case Qn.SUBTITLE_TRACK:d=i?Me.SUBTITLE_TRACK_LOAD_TIMEOUT:Me.SUBTITLE_LOAD_ERROR,m=!1}g&&this.resetInternalLoader(e.type);const v={type:an.NETWORK_ERROR,details:d,fatal:m,url:e.url,loader:g,context:e,error:c,networkDetails:t,stats:s};r&&(v.response=hs({url:t?.url||e.url,data:void 0},r)),this.hls.trigger(N.ERROR,v)}handlePlaylistLoaded(e,t,i,r,s,o){const c=this.hls,{type:d,level:m,id:g,groupId:v,deliveryDirectives:E}=r,T=Zg(t,r),C=Fx(r),k="number"==typeof r.level&&C===ln.MAIN?m:void 0;if(!e.fragments.length){const G=new Error("No Segments found in Playlist");return void c.trigger(N.ERROR,{type:an.NETWORK_ERROR,details:Me.LEVEL_EMPTY_ERROR,fatal:!1,url:T,error:G,reason:G.message,response:t,context:r,level:k,parent:C,networkDetails:s,stats:i})}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const P=e.playlistParsingError;if(P)c.trigger(N.ERROR,{type:an.NETWORK_ERROR,details:Me.LEVEL_PARSING_ERROR,fatal:!1,url:T,error:P,reason:P.message,response:t,context:r,level:k,parent:C,networkDetails:s,stats:i});else switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),d){case Qn.MANIFEST:case Qn.LEVEL:c.trigger(N.LEVEL_LOADED,{details:e,level:k||0,id:g||0,stats:i,networkDetails:s,deliveryDirectives:E});break;case Qn.AUDIO_TRACK:c.trigger(N.AUDIO_TRACK_LOADED,{details:e,id:g||0,groupId:v||"",stats:i,networkDetails:s,deliveryDirectives:E});break;case Qn.SUBTITLE_TRACK:c.trigger(N.SUBTITLE_TRACK_LOADED,{details:e,id:g||0,groupId:v||"",stats:i,networkDetails:s,deliveryDirectives:E})}}}function Qg(n,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=n,e.dispatchEvent(t)}function Bx(n,e){const t=n.mode;if("disabled"===t&&(n.mode="hidden"),n.cues&&!n.cues.getCueById(e.id))try{if(n.addCue(e),!n.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(i){ce.debug(`[texttrack-utils]: ${i}`);try{const r=new self.TextTrackCue(e.startTime,e.endTime,e.text);r.id=e.id,n.addCue(r)}catch(r){ce.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${r}`)}}"disabled"===t&&(n.mode=t)}function Xl(n){const e=n.mode;if("disabled"===e&&(n.mode="hidden"),n.cues)for(let t=n.cues.length;t--;)n.removeCue(n.cues[t]);"disabled"===e&&(n.mode=e)}function $h(n,e,t,i){const r=n.mode;if("disabled"===r&&(n.mode="hidden"),n.cues&&n.cues.length>0){const s=function hA(n,e,t){const i=[],r=function dv(n,e){if(e<n[0].startTime)return 0;const t=n.length-1;if(e>n[t].endTime)return-1;let i=0,r=t;for(;i<=r;){const s=Math.floor((r+i)/2);if(e<n[s].startTime)r=s-1;else{if(!(e>n[s].startTime&&i<t))return s;i=s+1}}return n[i].startTime-e<e-n[r].startTime?i:r}(n,e);if(r>-1)for(let s=r,o=n.length;s<o;s++){const c=n[s];if(c.startTime>=e&&c.endTime<=t)i.push(c);else if(c.startTime>t)return i}return i}(n.cues,e,t);for(let o=0;o<s.length;o++)(!i||i(s[o]))&&n.removeCue(s[o])}"disabled"===r&&(n.mode=r)}var To_emsg="https://aomedia.org/emsg/ID3";function Xg(){if(!(typeof self>"u"))return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}const Jm=(()=>{const n=Xg();try{new n(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function ep(n,e){return n.getTime()/1e3-e}function Ux(n){return Uint8Array.from(n.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class Vx{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(N.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(N.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(N.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(N.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(Xl(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const i=e[t];if("metadata"===i.kind&&"id3"===i.label)return Qg(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:i,enableID3MetadataCues:r}}}=this;if(!i&&!r)return;const{samples:s}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=Xg();for(let c=0;c<s.length;c++){const d=s[c].type;if(d===To_emsg&&!i||!r)continue;const m=Ym(s[c].data);if(m){const g=s[c].pts;let v=g+s[c].duration;v>Jm&&(v=Jm),v-g<=0&&(v=g+.25);for(let T=0;T<m.length;T++){const C=m[T];if(!Kg(C)){this.updateId3CueEnds(g,d);const k=new o(g,v,"");k.value=C,d&&(k.type=d),this.id3Track.addCue(k)}}}}}updateId3CueEnds(e,t){var i;const r=null==(i=this.id3Track)?void 0:i.cues;if(r)for(let s=r.length;s--;){const o=r[s];o.type===t&&o.startTime<e&&o.endTime===Jm&&(o.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:i,type:r}){const{id3Track:s,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:c,enableID3MetadataCues:d}}=o;if(s&&(c||d)){let m;m="audio"===r?g=>"org.id3"===g.type&&d:"video"===r?g=>g.type===To_emsg&&c:g=>"org.id3"===g.type&&d||g.type===To_emsg&&c,$h(s,t,i,m)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:i,id3Track:r}=this,{dateRanges:s}=t,o=Object.keys(s);if(r){const g=Object.keys(i).filter(v=>!o.includes(v));for(let v=g.length;v--;){const E=g[v];Object.keys(i[E].cues).forEach(T=>{r.removeCue(i[E].cues[T])}),delete i[E]}}const c=t.fragments[t.fragments.length-1];if(0===o.length||!Jt(c?.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const d=c.programDateTime/1e3-c.start,m=Xg();for(let g=0;g<o.length;g++){const v=o[g],E=s[v],T=i[v],C=T?.cues||{};let k=T?.durationKnown||!1;const P=ep(E.startDate,d);let G=Jm;const Y=E.endDate;if(Y)G=ep(Y,d),k=!0;else if(E.endOnNext&&!k){const te=o.reduce((oe,Ae)=>{const we=s[Ae];return we.class===E.class&&we.id!==Ae&&we.startDate>E.startDate&&oe.push(we),oe},[]).sort((oe,Ae)=>oe.startDate.getTime()-Ae.startDate.getTime())[0];te&&(G=ep(te.startDate,d),k=!0)}const W=Object.keys(E.attr);for(let te=0;te<W.length;te++){const oe=W[te];if("ID"===(n=oe)||"CLASS"===n||"START-DATE"===n||"DURATION"===n||"END-DATE"===n||"END-ON-NEXT"===n)continue;let Ae=C[oe];if(Ae)k&&!T.durationKnown&&(Ae.endTime=G);else{let we=E.attr[oe];Ae=new m(P,G,""),YD(oe)&&(we=Ux(we)),Ae.value={key:oe,data:we},Ae.type="com.apple.quicktime.HLS",Ae.id=v,this.id3Track.addCue(Ae),C[oe]=Ae}}i[v]={cues:C,dateRange:E,durationKnown:k}}var n}}class fv{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(null===e)return null;const{holdBack:t,partHoldBack:i,targetduration:r}=e,{liveSyncDuration:s,liveSyncDurationCount:o,lowLatencyMode:c}=this.config,d=this.hls.userConfig;let m=c&&i||t;return(d.liveSyncDuration||d.liveSyncDurationCount||0===m)&&(m=void 0!==s?s:o*r),m+Math.min(1*this.stallCount,r)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,i=this.levelDetails;if(null===e||null===t||null===i)return null;const r=i.edge,c=r-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(r-i.totalduration,e-t-this.edgeStalled),c)}get drift(){const{levelDetails:e}=this;return null===e?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;return null===e?0:Math.max(e.age-3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration),0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const i=e.buffered.length;return(i?e.buffered.end(i-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(N.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(N.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(N.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(N.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(N.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(N.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(N.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(N.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(N.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(N.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var i;t.details===Me.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(i=this.levelDetails)&&i.live&&ce.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const i=this.computeLatency();if(null===i)return;this._latency=i;const{lowLatencyMode:r,maxLiveSyncPlaybackRate:s}=this.config;if(!r||1===s)return;const o=this.targetLatency;if(null===o)return;const c=i-o,d=Math.min(this.maxLatency,o+t.targetduration);if(t.live&&c<d&&c>.05&&this.forwardBufferLength>1){const g=Math.min(2,Math.max(1,s)),v=Math.round(2/(1+Math.exp(-.75*c-this.edgeStalled))*20)/20;e.playbackRate=Math.min(g,Math.max(1,v))}else 1!==e.playbackRate&&0!==e.playbackRate&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return null===e?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return null===e?null:e-this.currentTime}}const tp=["NONE","TYPE-0","TYPE-1",null];var np_No="",np_Yes="YES",np_v2="v2";class mv{constructor(e,t,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=i}addDirectives(e){const t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Hh{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.unknownCodecs=e.unknownCodecs,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>t).join(",").replace(/\.[^.,]+/g,"")}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get attrs(){return this._attrs[this._urlId]}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get uri(){return this.url[this._urlId]||""}get urlId(){return this._urlId}set urlId(e){const t=e%this.url.length;this._urlId!==t&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=t)}get audioGroupId(){var e;return null==(e=this.audioGroupIds)?void 0:e[this.urlId]}get textGroupId(){var e;return null==(e=this.textGroupIds)?void 0:e[this.urlId]}addFallback(e){this.url.push(e.url),this._attrs.push(e.attrs)}}function Jg(n,e){const t=e.startPTS;if(Jt(t)){let r,i=0;e.sn>n.sn?(i=t-n.start,r=n):(i=n.start-t,r=e),r.duration!==i&&(r.duration=i)}else e.start=e.sn>n.sn?n.cc===e.cc&&n.minEndPTS?n.start+(n.minEndPTS-n.start):n.start+n.duration:Math.max(n.start-e.duration,0)}function Hx(n,e,t,i,r,s){i-t<=0&&(ce.warn("Fragment should have a positive duration",e),i=t+e.duration,s=r+e.duration);let c=t,d=i;const m=e.startPTS,g=e.endPTS;if(Jt(m)){const P=Math.abs(m-t);e.deltaPTS=Jt(e.deltaPTS)?Math.max(P,e.deltaPTS):P,c=Math.max(t,m),t=Math.min(t,m),r=Math.min(r,e.startDTS),d=Math.min(i,g),i=Math.max(i,g),s=Math.max(s,e.endDTS)}const v=t-e.start;0!==e.start&&(e.start=t),e.duration=i-e.start,e.startPTS=t,e.maxStartPTS=c,e.startDTS=r,e.endPTS=i,e.minEndPTS=d,e.endDTS=s;const E=e.sn;if(!n||E<n.startSN||E>n.endSN)return 0;let T;const C=E-n.startSN,k=n.fragments;for(k[C]=e,T=C;T>0;T--)Jg(k[T],k[T-1]);for(T=C;T<k.length-1;T++)Jg(k[T],k[T+1]);return n.fragmentHint&&Jg(k[k.length-1],n.fragmentHint),n.PTSKnown=n.alignedSliding=!0,v}function gv(n,e){const t=e.startSN+e.skippedSegments-n.startSN,i=n.fragments;t<0||t>=i.length||e_(e,i[t].start)}function e_(n,e){if(e){const t=n.fragments;for(let i=n.skippedSegments;i<t.length;i++)t[i].start+=e;n.fragmentHint&&(n.fragmentHint.start+=e)}}function _v(n,e,t){var i;return null!=n&&n.details?yv(null==(i=n.details)?void 0:i.partList,e,t):null}function yv(n,e,t){if(n)for(let i=n.length;i--;){const r=n[i];if(r.index===t&&r.fragment.sn===e)return r}return null}function ip(n){switch(n.details){case Me.FRAG_LOAD_TIMEOUT:case Me.KEY_LOAD_TIMEOUT:case Me.LEVEL_LOAD_TIMEOUT:case Me.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function vv(n,e){const t=ip(e);return n.default[(t?"timeout":"error")+"Retry"]}function jh(n,e){const t="linear"===n.backoff?1:Math.pow(2,e);return Math.min(t*n.retryDelayMs,n.maxRetryDelayMs)}function Jl(n){return hs(hs({},n),{errorRetry:null,timeoutRetry:null})}function t_(n,e,t,i){return!!n&&e<n.maxNumRetry&&(function fA(n){return 0===n&&!1===navigator.onLine||!!n&&(n<400||n>499)}(i)||!!t)}const n_={search:function(n,e){let t=0,i=n.length-1,r=null,s=null;for(;t<=i;){r=(t+i)/2|0,s=n[r];const o=e(s);if(o>0)t=r+1;else{if(!(o<0))return s;i=r-1}}return null}};function ad(n,e,t=0,i=0){let r=null;if(n?r=e[n.sn-e[0].sn+1]||null:0===t&&0===e[0].start&&(r=e[0]),r&&0===bv(t,i,r))return r;const s=n_.search(e,bv.bind(null,t,i));return!s||s===n&&r?r:s}function bv(n=0,e=0,t){if(t.start<=n&&t.start+t.duration>n)return 0;const i=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-i<=n?1:t.start-i>n&&t.start?-1:0}function wv(n,e,t){const i=1e3*Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return(t.endProgramDateTime||0)-i>n}const NL=3e5;function mA(n,e,t){if(performance.now()-n.lastErrorPerfMs>NL)return!0;const i=n.details;if(e.details===Me.FRAG_GAP&&i&&e.frag){const s=ad(null,i.fragments,e.frag.start);if(s&&!s.gap)return!0}if(t&&n.errors.length<t.errors.length){const r=n.errors[n.errors.length-1];if(i&&r.frag&&e.frag&&Math.abs(r.frag.start-e.frag.start)>3*i.targetduration)return!0}return!1}class dr{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=ce.log.bind(ce,`${t}:`),this.warn=ce.warn.bind(ce,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){clearTimeout(this.timer),this.timer=-1}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t){const i=t?.renditionReports;if(i){let r=-1;for(let s=0;s<i.length;s++){const o=i[s];let c;try{c=new self.URL(o.URI,t.url).href}catch(d){ce.warn(`Could not construct new URL for Rendition Report: ${d}`),c=o.URI||""}if(c===e){r=s;break}c===e.substring(0,c.length)&&(r=s)}if(-1!==r){const s=i[r],o=parseInt(s["LAST-MSN"])||t?.lastPartSn;let c=parseInt(s["LAST-PART"])||t?.lastPartIndex;if(this.hls.config.lowLatencyMode){const d=Math.min(t.age-t.partTarget,t.targetduration);c>=0&&d>t.partTarget&&(c+=1)}return new mv(o,c>=0?c:void 0,np_No)}}}loadPlaylist(e){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return-1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,i){const{details:r,stats:s}=t,o=self.performance.now(),c=s.loading.first?Math.max(0,o-s.loading.first):0;if(r.advancedDateTime=Date.now()-c,r.live||null!=i&&i.live){if(r.reloaded(i),i&&this.log(`live playlist ${e} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:r.updated?"UPDATED":"MISSED"}`),i&&r.fragments.length>0&&function jx(n,e){let t=null;const i=n.fragments;for(let d=i.length-1;d>=0;d--){const m=i[d].initSegment;if(m){t=m;break}}n.fragmentHint&&delete n.fragmentHint.endPTS;let s,r=0;if(function pv(n,e,t){const i=e.skippedSegments,r=Math.max(n.startSN,e.startSN)-e.startSN,s=(n.fragmentHint?1:0)+(i?e.endSN:Math.min(n.endSN,e.endSN))-e.startSN,o=e.startSN-n.startSN,c=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,d=n.fragmentHint?n.fragments.concat(n.fragmentHint):n.fragments;for(let m=r;m<=s;m++){const g=d[o+m];let v=c[m];i&&!v&&m<i&&(v=e.fragments[m]=g),g&&v&&t(g,v)}}(n,e,(d,m)=>{d.relurl&&(r=d.cc-m.cc),Jt(d.startPTS)&&Jt(d.endPTS)&&(m.start=m.startPTS=d.startPTS,m.startDTS=d.startDTS,m.maxStartPTS=d.maxStartPTS,m.endPTS=d.endPTS,m.endDTS=d.endDTS,m.minEndPTS=d.minEndPTS,m.duration=d.endPTS-d.startPTS,m.duration&&(s=m),e.PTSKnown=e.alignedSliding=!0),m.elementaryStreams=d.elementaryStreams,m.loader=d.loader,m.stats=d.stats,m.urlId=d.urlId,d.initSegment&&(m.initSegment=d.initSegment,t=d.initSegment)}),t&&(e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments).forEach(m=>{var g;(!m.initSegment||m.initSegment.relurl===(null==(g=t)?void 0:g.relurl))&&(m.initSegment=t)}),e.skippedSegments)if(e.deltaUpdateFailed=e.fragments.some(d=>!d),e.deltaUpdateFailed){ce.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let d=e.skippedSegments;d--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}else e.canSkipDateRanges&&(e.dateRanges=function Gx(n,e,t){const i=vr({},n);return t&&t.forEach(r=>{delete i[r]}),Object.keys(e).forEach(r=>{const s=new z0(e[r].attr,i[r]);s.isValid?i[r]=s:ce.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[r].attr)}"`)}),i}(n.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));const o=e.fragments;if(r){ce.warn("discontinuity sliding from playlist, take drift into account");for(let d=0;d<o.length;d++)o[d].cc+=r}e.skippedSegments&&(e.startCC=e.fragments[0].cc),function zx(n,e,t){if(n&&e){let i=0;for(let r=0,s=n.length;r<=s;r++){const o=n[r],c=e[r+i];o&&c&&o.index===c.index&&o.fragment.sn===c.fragment.sn?t(o,c):i--}}}(n.partList,e.partList,(d,m)=>{m.elementaryStreams=d.elementaryStreams,m.stats=d.stats}),s?Hx(e,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):gv(n,e),o.length&&(e.totalduration=e.edge-o[0].start),e.driftStartTime=n.driftStartTime,e.driftStart=n.driftStart;const c=e.advancedDateTime;if(e.advanced&&c){const d=e.edge;e.driftStart||(e.driftStartTime=c,e.driftStart=d),e.driftEndTime=c,e.driftEnd=d}else e.driftEndTime=n.driftEndTime,e.driftEnd=n.driftEnd,e.advancedDateTime=n.advancedDateTime}(i,r),!this.canLoad||!r.live)return;let d,m,g;if(r.canBlockReload&&r.endSN&&r.advanced){const P=this.hls.config.lowLatencyMode,G=r.lastPartSn,Y=r.endSN,W=r.lastPartIndex,oe=G===Y;-1!==W?(m=oe?Y+1:G,g=oe?P?0:W:W+1):m=Y+1;const we=r.age;let rt=Math.min(we+r.ageHeader-r.partTarget,1.5*r.targetduration);if(rt>0){if(i&&rt>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${rt} with playlist age: ${r.age}`),rt=0;else{const Pe=Math.floor(rt/r.targetduration);m+=Pe,void 0!==g&&(g+=Math.round(rt%r.targetduration/r.partTarget)),this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${we.toFixed(2)}s goal: ${rt} skip sn ${Pe} to part ${g}`)}r.tuneInGoal=rt}if(d=this.getDeliveryDirectives(r,t.deliveryDirectives,m,g),P||!oe)return void this.loadPlaylist(d)}else(r.canBlockReload||r.canSkipUntil)&&(d=this.getDeliveryDirectives(r,t.deliveryDirectives,m,g));const v=this.hls.mainForwardBufferInfo,C=function Wx(n,e=1/0){let t=1e3*n.targetduration;if(n.updated){const i=n.fragments;if(i.length&&4*t>e){const s=1e3*i[i.length-1].duration;s<t&&(t=s)}}else t/=2;return Math.round(t)}(r,1e3*(r.edge-(v?v.end-v.len:0)));r.updated&&o>this.requestScheduled+C&&(this.requestScheduled=s.loading.start),void 0!==m&&r.canBlockReload?this.requestScheduled=s.loading.first+C-(1e3*r.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+C<o?this.requestScheduled=o:this.requestScheduled-o<=0&&(this.requestScheduled+=C);let k=this.requestScheduled-o;k=Math.max(0,k),this.log(`reload live playlist ${e} in ${Math.round(k)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(d),k)}else this.clearTimer()}getDeliveryDirectives(e,t,i,r){let s=function $x(n,e){const{canSkipUntil:t,canSkipDateRanges:i,endSN:r}=n;return t&&(void 0!==e?e-r:0)<t?i?np_v2:np_Yes:np_No}(e,i);return null!=t&&t.skip&&e.deltaUpdateFailed&&(i=t.msn,r=t.part,s=np_No),new mv(i,r,s)}checkRetry(e){const t=e.details,i=ip(e),r=e.errorAction,{action:s,retryCount:o=0,retryConfig:c}=r||{},d=!!r&&!!c&&(5===s||!r.resolved&&2===s);if(d){var m;if(this.requestScheduled=-1,o>=c.maxNumRetry)return!1;if(i&&null!=(m=e.context)&&m.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${c.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const g=jh(c,o);this.timer=self.setTimeout(()=>this.loadPlaylist(),g),this.warn(`Retrying playlist loading ${o+1}/${c.maxNumRetry} after "${t}" in ${g}ms`)}e.levelRetry=!0,r.resolved=!0}return d}}let i_;class pA extends dr{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(N.LEVEL_LOADED,this.onLevelLoaded,this),e.on(N.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(N.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(N.FRAG_LOADED,this.onFragLoaded,this),e.on(N.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(N.LEVEL_LOADED,this.onLevelLoaded,this),e.off(N.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(N.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(N.FRAG_LOADED,this.onFragLoaded,this),e.off(N.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}startLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.startLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[]}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const i=[],r={};let s;t.levels.forEach(o=>{var c;const d=o.attrs;-1!==(null==(c=o.audioCodec)?void 0:c.indexOf("mp4a.40.34"))&&(i_||(i_=/chrome|firefox/i.test(navigator.userAgent)),i_&&(o.audioCodec=void 0));const{AUDIO:m,CODECS:g,"FRAME-RATE":v,"PATHWAY-ID":E,RESOLUTION:T,SUBTITLES:C}=d,P=`${E||"."}-${o.bitrate}-${T}-${v}-${g}`;s=r[P],s?s.addFallback(o):(s=new Hh(o),r[P]=s,i.push(s)),r_(s,"audio",m),r_(s,"text",C)}),this.filterAndSortMediaOptions(i,t)}filterAndSortMediaOptions(e,t){let i=[],r=[],s=!1,o=!1,c=!1,d=e.filter(({audioCodec:T,videoCodec:C,width:k,height:P,unknownCodecs:G})=>(s||(s=!(!k||!P)),o||(o=!!C),c||(c=!!T),!(null!=G&&G.length)&&(!T||Jc(T,"audio"))&&(!C||Jc(C,"video"))));if((s||o)&&c&&(d=d.filter(({videoCodec:T,width:C,height:k})=>!!T||!(!C||!k))),0===d.length)return void Promise.resolve().then(()=>{if(this.hls){const T=new Error("no level with compatible codecs found in manifest");this.hls.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Me.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:T,reason:T.message})}});t.audioTracks&&(i=t.audioTracks.filter(T=>!T.audioCodec||Jc(T.audioCodec,"audio")),Ev(i)),t.subtitles&&(r=t.subtitles,Ev(r));const m=d.slice(0);d.sort((T,C)=>T.attrs["HDCP-LEVEL"]!==C.attrs["HDCP-LEVEL"]?(T.attrs["HDCP-LEVEL"]||"")>(C.attrs["HDCP-LEVEL"]||"")?1:-1:T.bitrate!==C.bitrate?T.bitrate-C.bitrate:T.attrs["FRAME-RATE"]!==C.attrs["FRAME-RATE"]?T.attrs.decimalFloatingPoint("FRAME-RATE")-C.attrs.decimalFloatingPoint("FRAME-RATE"):T.attrs.SCORE!==C.attrs.SCORE?T.attrs.decimalFloatingPoint("SCORE")-C.attrs.decimalFloatingPoint("SCORE"):s&&T.height!==C.height?T.height-C.height:0);let g=m[0];if(this.steering&&(d=this.steering.filterParsedLevels(d),d.length!==m.length))for(let T=0;T<m.length;T++)if(m[T].pathwayId===d[0].pathwayId){g=m[T];break}this._levels=d;for(let T=0;T<d.length;T++)if(d[T]===g){this._firstLevel=T,this.log(`manifest loaded, ${d.length} level(s) found, first bitrate: ${g.bitrate}`);break}const E={levels:d,audioTracks:i,subtitleTracks:r,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:c,video:o,altAudio:!(c&&!o)&&i.some(T=>!!T.url)};this.hls.trigger(N.MANIFEST_PARSED,E),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return 0===this._levels.length?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(0===t.length)return;if(e<0||e>=t.length){const g=new Error("invalid level idx"),v=e<0;if(this.hls.trigger(N.ERROR,{type:an.OTHER_ERROR,details:Me.LEVEL_SWITCH_ERROR,level:e,fatal:v,error:g,reason:g.message}),v)return;e=Math.min(e,t.length-1)}const i=this.currentLevelIndex,r=this.currentLevel,s=r?r.attrs["PATHWAY-ID"]:void 0,o=t[e],c=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,i===e&&o.details&&r&&s===c)return;this.log(`Switching to level ${e}${c?" with Pathway "+c:""} from level ${i}${s?" with Pathway "+s:""}`);const d=vr({},o,{level:e,maxBitrate:o.maxBitrate,attrs:o.attrs,uri:o.uri,urlId:o.urlId});delete d._attrs,delete d._urlId,this.hls.trigger(N.LEVEL_SWITCHING,d);const m=o.details;if(!m||m.live){const g=this.switchParams(o.uri,r?.details);this.loadPlaylist(g)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(void 0===this._startLevel){const e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===Qn.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragLoaded(e,{frag:t}){if(void 0!==t&&t.type===ln.MAIN){const i=this._levels[t.level];void 0!==i&&(i.loadError=0)}}onLevelLoaded(e,t){var i;const{level:r,details:s}=t,o=this._levels[r];var c;if(!o)return this.warn(`Invalid level index ${r}`),void(null!=(c=t.deliveryDirectives)&&c.skip&&(s.deltaUpdateFailed=!0));r===this.currentLevelIndex?(0===o.fragmentError&&(o.loadError=0),this.playlistLoaded(r,t,o.details)):null!=(i=t.deliveryDirectives)&&i.skip&&(s.deltaUpdateFailed=!0)}onAudioTrackSwitched(e,t){const i=this.currentLevel;if(!i)return;const r=this.hls.audioTracks[t.id].groupId;if(i.audioGroupIds&&i.audioGroupId!==r){let s=-1;for(let o=0;o<i.audioGroupIds.length;o++)if(i.audioGroupIds[o]===r){s=o;break}-1!==s&&s!==i.urlId&&(i.urlId=s,this.canLoad&&this.startLoad())}}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,i=this.currentLevel;if(i&&this.shouldLoadPlaylist(i)){const r=i.urlId;let s=i.uri;if(e)try{s=e.addDirectives(s)}catch(c){this.warn(`Could not construct new URL with HLS Delivery Directives: ${c}`)}const o=i.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${void 0!==e?.msn?" at sn "+e.msn+" part "+e.part:""} with${o?" Pathway "+o:""} URI ${r+1}/${i.url.length} ${s}`),this.clearTimer(),this.hls.trigger(N.LEVEL_LOADING,{url:s,level:t,id:r,deliveryDirectives:e||null})}}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}removeLevel(e,t){const i=(s,o)=>o!==t,r=this._levels.filter((s,o)=>o!==e||(s.url.length>1&&void 0!==t?(s.url=s.url.filter(i),s.audioGroupIds&&(s.audioGroupIds=s.audioGroupIds.filter(i)),s.textGroupIds&&(s.textGroupIds=s.textGroupIds.filter(i)),s.urlId=0,!0):(this.steering&&this.steering.removeLevel(s),!1)));this.hls.trigger(N.LEVELS_UPDATED,{levels:r})}onLevelsUpdated(e,{levels:t}){t.forEach((i,r)=>{const{details:s}=i;null!=s&&s.fragments&&s.fragments.forEach(o=>{o.level=r})}),this._levels=t}}function r_(n,e,t){t&&("audio"===e?(n.audioGroupIds||(n.audioGroupIds=[]),n.audioGroupIds[n.url.length-1]=t):"text"===e&&(n.textGroupIds||(n.textGroupIds=[]),n.textGroupIds[n.url.length-1]=t))}function Ev(n){const e={};n.forEach(t=>{const i=t.groupId||"";t.id=e[i]=e[i]||0,e[i]++})}class Yx{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(N.BUFFER_APPENDED,this.onBufferAppended,this),e.on(N.FRAG_BUFFERED,this.onFragBuffered,this),e.on(N.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(N.BUFFER_APPENDED,this.onBufferAppended,this),e.off(N.FRAG_BUFFERED,this.onFragBuffered,this),e.off(N.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const i=this.activePartLists[t];if(i)for(let r=i.length;r--;){const s=i[r];if(!s)break;const o=s.end;if(s.start<=e&&null!==o&&e<=o)return s}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:i}=this,r=Object.keys(i);for(let s=r.length;s--;){const o=i[r[s]];if(o?.body.type===t&&o.buffered){const c=o.body;if(c.start<=e&&e<=c.end)return c}}return null}detectEvictedFragments(e,t,i,r){this.timeRanges&&(this.timeRanges[e]=t);const s=r?.fragment.sn||-1;Object.keys(this.fragments).forEach(o=>{const c=this.fragments[o];if(!c||s>=c.body.sn)return;if(!c.buffered&&!c.loaded)return void(c.body.type===i&&this.removeFragment(c.body));const d=c.range[e];d&&d.time.some(m=>{const g=!this.isTimeBuffered(m.startPTS,m.endPTS,t);return g&&this.removeFragment(c.body),g})})}detectPartialFragments(e){const t=this.timeRanges,{frag:i,part:r}=e;if(!t||"initSegment"===i.sn)return;const s=Da(i),o=this.fragments[s];if(!o||o.buffered&&i.gap)return;const c=!i.relurl;Object.keys(t).forEach(d=>{const m=i.elementaryStreams[d];m&&(o.range[d]=this.getBufferedTimes(i,r,c||!0===m.partial,t[d]))}),o.loaded=null,Object.keys(o.range).length?(o.buffered=!0,(o.body.endList=i.endList||o.body.endList)&&(this.endListFragments[o.body.type]=o),rp(o)||this.removeParts(i.sn-1,i.type)):this.removeFragment(o.body)}removeParts(e,t){const i=this.activePartLists[t];i&&(this.activePartLists[t]=i.filter(r=>r.fragment.sn>=e))}fragBuffered(e,t){const i=Da(e);let r=this.fragments[i];!r&&t&&(r=this.fragments[i]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,r.buffered=!0)}getBufferedTimes(e,t,i,r){const s={time:[],partial:i},o=e.start,c=e.end,d=e.minEndPTS||c,m=e.maxStartPTS||o;for(let g=0;g<r.length;g++){const v=r.start(g)-this.bufferPadding,E=r.end(g)+this.bufferPadding;if(m>=v&&d<=E){s.time.push({startPTS:Math.max(o,r.start(g)),endPTS:Math.min(c,r.end(g))});break}if(o<E&&c>v)s.partial=!0,s.time.push({startPTS:Math.max(o,r.start(g)),endPTS:Math.min(c,r.end(g))});else if(c<=v)break}return s}getPartialFragment(e){let i,r,s,t=null,o=0;const{bufferPadding:c,fragments:d}=this;return Object.keys(d).forEach(m=>{const g=d[m];g&&rp(g)&&(r=g.body.start-c,s=g.body.end+c,e>=r&&e<=s&&(i=Math.min(e-r,s-e),o<=i&&(t=g.body,o=i)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return void 0!==t&&(t.buffered||rp(t))}getState(e){const t=Da(e),i=this.fragments[t];return i?i.buffered?rp(i)?"PARTIAL":"OK":"APPENDING":"NOT_LOADED"}isTimeBuffered(e,t,i){let r,s;for(let o=0;o<i.length;o++){if(r=i.start(o)-this.bufferPadding,s=i.end(o)+this.bufferPadding,e>=r&&t<=s)return!0;if(t<=r)return!1}return!1}onFragLoaded(e,t){const{frag:i,part:r}=t;if("initSegment"===i.sn||i.bitrateTest)return;const s=r?null:t,o=Da(i);this.fragments[o]={body:i,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:i,part:r,timeRanges:s}=t;if("initSegment"===i.sn)return;const o=i.type;if(r){let c=this.activePartLists[o];c||(this.activePartLists[o]=c=[]),c.push(r)}this.timeRanges=s,Object.keys(s).forEach(c=>{this.detectEvictedFragments(c,s[c],o,r)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Da(e);return!!this.fragments[t]}hasParts(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)}removeFragmentsInRange(e,t,i,r,s){r&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const c=this.fragments[o];if(!c)return;const d=c.body;d.type!==i||r&&!d.gap||d.start<t&&d.end>e&&(c.buffered||s)&&this.removeFragment(d)})}removeFragment(e){const t=Da(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const i=this.activePartLists[e.type];if(i){const r=e.sn;this.activePartLists[e.type]=i.filter(s=>s.fragment.sn!==r)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function rp(n){var e,t,i;return n.buffered&&(n.body.gap||(null==(e=n.range.video)?void 0:e.partial)||(null==(t=n.range.audio)?void 0:t.partial)||(null==(i=n.range.audiovideo)?void 0:i.partial))}function Da(n){return`${n.type}_${n.level}_${n.urlId}_${n.sn}`}const Zx=Math.pow(2,17);class gA{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const i=e.url;if(!i)return Promise.reject(new hl({type:an.NETWORK_ERROR,details:Me.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a "+(i?"part list":"url")),networkDetails:null}));this.abort();const r=this.config,s=r.fLoader,o=r.loader;return new Promise((c,d)=>{if(this.loader&&this.loader.destroy(),e.gap){if(e.tagList.some(T=>"GAP"===T[0]))return void d(Qx(e));e.gap=!1}const m=this.loader=e.loader=s?new s(r):new o(r),g=xv(e),v=Jl(r.fragLoadPolicy.default),E={loadPolicy:v,timeout:v.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:Zx};e.stats=m.stats,m.load(g,E,{onSuccess:(T,C,k,P)=>{this.resetLoader(e,m);let G=T.data;k.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(G.slice(0,16)),G=G.slice(16)),c({frag:e,part:null,payload:G,networkDetails:P})},onError:(T,C,k,P)=>{this.resetLoader(e,m),d(new hl({type:an.NETWORK_ERROR,details:Me.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:hs({url:i,data:void 0},T),error:new Error(`HTTP Error ${T.code} ${T.text}`),networkDetails:k,stats:P}))},onAbort:(T,C,k)=>{this.resetLoader(e,m),d(new hl({type:an.NETWORK_ERROR,details:Me.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:k,stats:T}))},onTimeout:(T,C,k)=>{this.resetLoader(e,m),d(new hl({type:an.NETWORK_ERROR,details:Me.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${E.timeout}ms`),networkDetails:k,stats:T}))},onProgress:(T,C,k,P)=>{t&&t({frag:e,part:null,payload:k,networkDetails:P})}})})}loadPart(e,t,i){this.abort();const r=this.config,s=r.fLoader,o=r.loader;return new Promise((c,d)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap)return void d(Qx(e,t));const m=this.loader=e.loader=s?new s(r):new o(r),g=xv(e,t),v=Jl(r.fragLoadPolicy.default),E={loadPolicy:v,timeout:v.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Zx};t.stats=m.stats,m.load(g,E,{onSuccess:(T,C,k,P)=>{this.resetLoader(e,m),this.updateStatsFromPart(e,t);const G={frag:e,part:t,payload:T.data,networkDetails:P};i(G),c(G)},onError:(T,C,k,P)=>{this.resetLoader(e,m),d(new hl({type:an.NETWORK_ERROR,details:Me.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:hs({url:g.url,data:void 0},T),error:new Error(`HTTP Error ${T.code} ${T.text}`),networkDetails:k,stats:P}))},onAbort:(T,C,k)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,m),d(new hl({type:an.NETWORK_ERROR,details:Me.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:k,stats:T}))},onTimeout:(T,C,k)=>{this.resetLoader(e,m),d(new hl({type:an.NETWORK_ERROR,details:Me.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${E.timeout}ms`),networkDetails:k,stats:T}))}})})}updateStatsFromPart(e,t){const i=e.stats,r=t.stats,s=r.total;if(i.loaded+=r.loaded,s){const d=Math.round(e.duration/t.duration),m=Math.min(Math.round(i.loaded/s),d),v=(d-m)*Math.round(i.loaded/m);i.total=i.loaded+v}else i.total=Math.max(i.loaded,i.total);const o=i.loading,c=r.loading;o.start?o.first+=c.first-c.start:(o.start=c.start,o.first=c.first),o.end=c.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function xv(n,e=null){const t=e||n,i={frag:n,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},r=t.byteRangeStartOffset,s=t.byteRangeEndOffset;if(Jt(r)&&Jt(s)){var o;let c=r,d=s;if("initSegment"===n.sn&&"AES-128"===(null==(o=n.decryptdata)?void 0:o.method)){const m=s-r;m%16&&(d=s+(16-m%16)),0!==r&&(i.resetIV=!0,c=r-16)}i.rangeStart=c,i.rangeEnd=d}return i}function Qx(n,e){const t=new Error(`GAP ${n.gap?"tag":"attribute"} found`),i={type:an.MEDIA_ERROR,details:Me.FRAG_GAP,fatal:!1,frag:n,error:t,networkDetails:null};return e&&(i.part=e),(e||n).stats.aborted=!0,new hl(i)}class hl extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class FL{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const t in this.keyUriToKeyInfo){const i=this.keyUriToKeyInfo[t].loader;if(i){if(e&&e!==i.context.frag.type)return;i.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=Me.KEY_LOAD_ERROR,i,r,s){return new hl({type:an.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:s,error:i,networkDetails:r})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:i,cc:r}=e;for(let s=0;s<t.length;s++){const o=t[s];if(r<=o.cc&&("initSegment"===i||"initSegment"===o.sn||i<o.sn)){this.emeController.selectKeySystemFormat(o).then(c=>{o.setKeyFormat(c)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var i,r;t&&e.setKeyFormat(t);const s=e.decryptdata;if(!s){const m=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,Me.KEY_LOAD_ERROR,m))}const o=s.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,Me.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));let c=this.keyUriToKeyInfo[o];if(null!=(i=c)&&i.decryptdata.key)return s.key=c.decryptdata.key,Promise.resolve({frag:e,keyInfo:c});var d;if(null!=(r=c)&&r.keyLoadPromise)switch(null==(d=c.mediaKeySessionContext)?void 0:d.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return c.keyLoadPromise.then(m=>(s.key=m.keyInfo.decryptdata.key,{frag:e,keyInfo:c}))}switch(c=this.keyUriToKeyInfo[o]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===s.keyFormat?this.loadKeyHTTP(c,e):this.loadKeyEME(c,e);case"AES-128":return this.loadKeyHTTP(c,e);default:return Promise.reject(this.createKeyLoadError(e,Me.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(e,t){const i={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const r=this.emeController.loadKey(i);if(r)return(e.keyLoadPromise=r.then(s=>(e.mediaKeySessionContext=s,i))).catch(s=>{throw e.keyLoadPromise=null,s})}return Promise.resolve(i)}loadKeyHTTP(e,t){const i=this.config,s=new(0,i.loader)(i);return t.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((o,c)=>{const d={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},m=i.keyLoadPolicy.default;s.load(d,{loadPolicy:m,timeout:m.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},{onSuccess:(E,T,C,k)=>{const{frag:P,keyInfo:G,url:Y}=C;if(!P.decryptdata||G!==this.keyUriToKeyInfo[Y])return c(this.createKeyLoadError(P,Me.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),k));G.decryptdata.key=P.decryptdata.key=new Uint8Array(E.data),P.keyLoader=null,G.loader=null,o({frag:P,keyInfo:G})},onError:(E,T,C,k)=>{this.resetLoader(T),c(this.createKeyLoadError(t,Me.KEY_LOAD_ERROR,new Error(`HTTP Error ${E.code} loading key ${E.text}`),C,hs({url:d.url,data:void 0},E)))},onTimeout:(E,T,C)=>{this.resetLoader(T),c(this.createKeyLoadError(t,Me.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),C))},onAbort:(E,T,C)=>{this.resetLoader(T),c(this.createKeyLoadError(t,Me.INTERNAL_ABORTED,new Error("key loading aborted"),C))}})})}resetLoader(e){const{frag:t,keyInfo:i,url:r}=e,s=i.loader;t.keyLoader===s&&(t.keyLoader=null,i.loader=null),delete this.keyUriToKeyInfo[r],s&&s.destroy()}}class Tv{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}const Iv={length:0,start:()=>0,end:()=>0};class Un{static isBuffered(e,t){try{if(e){const i=Un.getBuffered(e);for(let r=0;r<i.length;r++)if(t>=i.start(r)&&t<=i.end(r))return!0}}catch{}return!1}static bufferInfo(e,t,i){try{if(e){const r=Un.getBuffered(e),s=[];let o;for(o=0;o<r.length;o++)s.push({start:r.start(o),end:r.end(o)});return this.bufferedInfo(s,t,i)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,i){t=Math.max(0,t),e.sort(function(m,g){return m.start-g.start||g.end-m.end});let r=[];if(i)for(let m=0;m<e.length;m++){const g=r.length;if(g){const v=r[g-1].end;e[m].start-v<i?e[m].end>v&&(r[g-1].end=e[m].end):r.push(e[m])}else r.push(e[m])}else r=e;let o,s=0,c=t,d=t;for(let m=0;m<r.length;m++){const g=r[m].start,v=r[m].end;if(t+i>=g&&t<v)c=g,d=v,s=d-t;else if(t+i<g){o=g;break}}return{len:s,start:c||0,end:d||0,nextStart:o}}static getBuffered(e){try{return e.buffered}catch(t){return ce.log("failed to get media.buffered",t),Iv}}}class Sv{constructor(e,t,i,r=0,s=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=e,this.sn=t,this.id=i,this.size=r,this.part=s,this.partial=o}}function Aa(n,e){let t=null;for(let i=0,r=n.length;i<r;i++){const s=n[i];if(s&&s.cc===e){t=s;break}}return t}function Cv(n,e){if(n){const t=n.start+e;n.start=n.startPTS=t,n.endPTS=t+n.duration}}function o_(n,e){const t=e.fragments;for(let i=0,r=t.length;i<r;i++)Cv(t[i],n);e.fragmentHint&&Cv(e.fragmentHint,n),e.alignedSliding=!0}function Xx(n,e){if(!n.hasProgramDateTime||!e.hasProgramDateTime)return;const t=n.fragments,i=e.fragments;if(!t.length||!i.length)return;const s=i[Math.round(i.length/2)-1],o=Aa(t,s.cc)||t[Math.round(t.length/2)-1],c=s.programDateTime,d=o.programDateTime;null!==c&&null!==d&&o_((d-c)/1e3-(o.start-s.start),n)}class Dv{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class sp{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}class Jx{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),i=new Uint32Array(4);for(let r=0;r<4;r++)i[r]=t.getUint32(4*r);return i}initTable(){const e=this.sBox,t=this.invSBox,i=this.subMix,r=i[0],s=i[1],o=i[2],c=i[3],d=this.invSubMix,m=d[0],g=d[1],v=d[2],E=d[3],T=new Uint32Array(256);let C=0,k=0,P=0;for(P=0;P<256;P++)T[P]=P<128?P<<1:P<<1^283;for(P=0;P<256;P++){let G=k^k<<1^k<<2^k<<3^k<<4;G=G>>>8^255&G^99,e[C]=G,t[G]=C;const Y=T[C],W=T[Y],te=T[W];let oe=257*T[G]^16843008*G;r[C]=oe<<24|oe>>>8,s[C]=oe<<16|oe>>>16,o[C]=oe<<8|oe>>>24,c[C]=oe,oe=16843009*te^65537*W^257*Y^16843008*C,m[G]=oe<<24|oe>>>8,g[G]=oe<<16|oe>>>16,v[G]=oe<<8|oe>>>24,E[G]=oe,C?(C=Y^T[T[T[te^Y]]],k^=T[T[k]]):C=k=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let i=!0,r=0;for(;r<t.length&&i;)i=t[r]===this.key[r],r++;if(i)return;this.key=t;const s=this.keySize=t.length;if(4!==s&&6!==s&&8!==s)throw new Error("Invalid aes key size="+s);const o=this.ksRows=4*(s+6+1);let c,d;const m=this.keySchedule=new Uint32Array(o),g=this.invKeySchedule=new Uint32Array(o),v=this.sBox,E=this.rcon,T=this.invSubMix,C=T[0],k=T[1],P=T[2],G=T[3];let Y,W;for(c=0;c<o;c++)c<s?Y=m[c]=t[c]:(W=Y,c%s==0?(W=W<<8|W>>>24,W=v[W>>>24]<<24|v[W>>>16&255]<<16|v[W>>>8&255]<<8|v[255&W],W^=E[c/s|0]<<24):s>6&&c%s==4&&(W=v[W>>>24]<<24|v[W>>>16&255]<<16|v[W>>>8&255]<<8|v[255&W]),m[c]=Y=(m[c-s]^W)>>>0);for(d=0;d<o;d++)c=o-d,W=3&d?m[c]:m[c-4],g[d]=d<4||c<=4?W:C[v[W>>>24]]^k[v[W>>>16&255]]^P[v[W>>>8&255]]^G[v[255&W]],g[d]=g[d]>>>0}networkToHostOrderSwap(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}decrypt(e,t,i){const r=this.keySize+6,s=this.invKeySchedule,o=this.invSBox,c=this.invSubMix,d=c[0],m=c[1],g=c[2],v=c[3],E=this.uint8ArrayToUint32Array_(i);let T=E[0],C=E[1],k=E[2],P=E[3];const G=new Int32Array(e),Y=new Int32Array(G.length);let W,te,oe,Ae,we,Ge,rt,Pe,Xt,yt,Fn,Lr,pi,ct;const pt=this.networkToHostOrderSwap;for(;t<G.length;){for(Xt=pt(G[t]),yt=pt(G[t+1]),Fn=pt(G[t+2]),Lr=pt(G[t+3]),we=Xt^s[0],Ge=Lr^s[1],rt=Fn^s[2],Pe=yt^s[3],pi=4,ct=1;ct<r;ct++)W=d[we>>>24]^m[Ge>>16&255]^g[rt>>8&255]^v[255&Pe]^s[pi],te=d[Ge>>>24]^m[rt>>16&255]^g[Pe>>8&255]^v[255&we]^s[pi+1],oe=d[rt>>>24]^m[Pe>>16&255]^g[we>>8&255]^v[255&Ge]^s[pi+2],Ae=d[Pe>>>24]^m[we>>16&255]^g[Ge>>8&255]^v[255&rt]^s[pi+3],we=W,Ge=te,rt=oe,Pe=Ae,pi+=4;W=o[we>>>24]<<24^o[Ge>>16&255]<<16^o[rt>>8&255]<<8^o[255&Pe]^s[pi],te=o[Ge>>>24]<<24^o[rt>>16&255]<<16^o[Pe>>8&255]<<8^o[255&we]^s[pi+1],oe=o[rt>>>24]<<24^o[Pe>>16&255]<<16^o[we>>8&255]<<8^o[255&Ge]^s[pi+2],Ae=o[Pe>>>24]<<24^o[we>>16&255]<<16^o[Ge>>8&255]<<8^o[255&rt]^s[pi+3],Y[t]=pt(W^T),Y[t+1]=pt(Ae^C),Y[t+2]=pt(oe^k),Y[t+3]=pt(te^P),T=Xt,C=yt,k=Fn,P=Lr,t+=4}return Y.buffer}}class Av{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const i=self.crypto;i&&(this.subtle=i.subtle||i.webkitSubtle)}catch{}null===this.subtle&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const i=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?function bA(n){const e=n.byteLength,t=e&&new DataView(n.buffer).getUint8(e-1);return t?Oh(n,0,e-t):n}(i):i}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,i){return this.useSoftware?new Promise((r,s)=>{this.softwareDecrypt(new Uint8Array(e),t,i);const o=this.flush();o?r(o.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,i)}softwareDecrypt(e,t,i){const{currentIV:r,currentResult:s,remainderData:o}=this;this.logOnce("JS AES decrypt"),o&&(e=td(o,e),this.remainderData=null);const c=this.getValidChunk(e);if(!c.length)return null;r&&(i=r);let d=this.softwareDecrypter;d||(d=this.softwareDecrypter=new Jx),d.expandKey(t);const m=s;return this.currentResult=d.decrypt(c.buffer,0,i),this.currentIV=Oh(c,-16).buffer,m||null}webCryptoDecrypt(e,t,i){const r=this.subtle;return(this.key!==t||!this.fastAesKey)&&(this.key=t,this.fastAesKey=new sp(r,t)),this.fastAesKey.expandKey().then(s=>r?(this.logOnce("WebCrypto AES decrypt"),new Dv(r,new Uint8Array(i)).decrypt(e.buffer,s)):Promise.reject(new Error("web crypto not initialized"))).catch(s=>(ce.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${s.name}: ${s.message}`),this.onWebCryptoError(e,t,i)))}onWebCryptoError(e,t,i){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,i);const r=this.flush();if(r)return r.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const i=e.length-e.length%16;return i!==e.length&&(t=Oh(e,0,i),this.remainderData=Oh(e,i)),t}logOnce(e){this.logEnabled&&(ce.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}class Gh extends Tv{constructor(e,t,i,r,s){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state="STOPPED",this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=s,this.logPrefix=r,this.log=ce.log.bind(ce,`${r}:`),this.warn=ce.warn.bind(ce,`${r}:`),this.hls=e,this.fragmentLoader=new gA(e.config),this.keyLoader=i,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Av(e.config),e.on(N.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state="STOPPED"}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const i=t.partList;if(null!=i&&i.length){const s=i[i.length-1];return Un.isBuffered(this.media,s.start+s.duration/2)}return this.fragmentTracker.isEndListAppended(t.fragments[t.fragments.length-1].type)}getLevelDetails(){var e;if(this.levels&&null!==this.levelLastLoaded)return null==(e=this.levels[this.levelLastLoaded])?void 0:e.details}onMediaAttached(e,t){const i=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),i.addEventListener("seeking",this.onvseeking),i.addEventListener("ended",this.onvended);const r=this.config;this.levels&&r.autoStartLoad&&"STOPPED"===this.state&&this.startLoad(r.startPosition)}onMediaDetaching(){const e=this.media;null!=e&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:i,mediaBuffer:r,state:s}=this,o=i?i.currentTime:0,c=Un.bufferInfo(r||i,o,e.maxBufferHole);if(this.log(`media seeking to ${Jt(o)?o.toFixed(3):o}, state: ${s}`),"ENDED"===this.state)this.resetLoadingState();else if(t){const d=e.maxFragLookUpTolerance,m=t.start-d,g=t.start+t.duration+d;if(!c.len||g<c.start||m>c.end){const v=o>g;(o<m||v)&&(v&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}i&&(this.fragmentTracker.removeFragmentsInRange(o,1/0,this.playlistType,!0),this.lastCurrentTime=o),!this.loadedmetadata&&!c.len&&(this.nextLoadPosition=this.startPosition=o),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.stopLoad(),super.onHandlerDestroying()}onHandlerDestroyed(){this.state="STOPPED",this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,i){this._loadFragForPlayback(e,t,i)}_loadFragForPlayback(e,t,i){this._doFragLoad(e,t,i,s=>{if(this.fragContextChanged(e))return this.warn(`Fragment ${e.sn}${s.part?" p: "+s.part.index:""} of level ${e.level} was dropped during download.`),void this.fragmentTracker.removeFragment(e);e.stats.chunkCount++,this._handleFragmentLoadProgress(s)}).then(s=>{if(!s)return;const o=this.state;this.fragContextChanged(e)?("FRAG_LOADING"===o||!this.fragCurrent&&"PARSING"===o)&&(this.fragmentTracker.removeFragment(e),this.state="IDLE"):("payload"in s&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(N.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s))}).catch(s=>{"STOPPED"===this.state||"ERROR"===this.state||(this.warn(s),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:i}=this;if("APPENDING"===i.getState(e)){const o=this.getFwdBufferInfo(this.mediaBuffer,e.type),c=Math.max(e.duration,o?o.len:this.config.maxBufferLength);this.reduceMaxBufferLength(c)&&i.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?i.removeAllFragments():i.hasParts(e.type)&&(i.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),"PARTIAL"===i.getState(e)&&i.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,i=null){e-t&&this.hls.trigger(N.BUFFER_FLUSHING,{startOffset:e,endOffset:t,type:i})}_loadInitSegment(e,t){this._doFragLoad(e,t).then(i=>{if(!i||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return i}).then(i=>{const{hls:r}=this,{payload:s}=i,o=e.decryptdata;if(s&&s.byteLength>0&&o&&o.key&&o.iv&&"AES-128"===o.method){const c=self.performance.now();return this.decrypter.decrypt(new Uint8Array(s),o.key.buffer,o.iv.buffer).catch(d=>{throw r.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Me.FRAG_DECRYPT_ERROR,fatal:!1,error:d,reason:d.message,frag:e}),d}).then(d=>{const m=self.performance.now();return r.trigger(N.FRAG_DECRYPTED,{frag:e,payload:d,stats:{tstart:c,tdecrypt:m}}),i.payload=d,i})}return i}).then(i=>{const{fragCurrent:r,hls:s,levels:o}=this;if(!o)throw new Error("init load aborted, missing levels");const c=e.stats;this.state="IDLE",t.fragmentError=0,e.data=new Uint8Array(i.payload),c.parsing.start=c.buffering.start=self.performance.now(),c.parsing.end=c.buffering.end=self.performance.now(),i.frag===r&&s.trigger(N.FRAG_BUFFERED,{stats:c,frag:r,part:null,id:e.type}),this.tick()}).catch(i=>{"STOPPED"===this.state||"ERROR"===this.state||(this.warn(i),this.resetFragmentLoading(e))})}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.level!==t.level||e.sn!==t.sn||e.urlId!==t.urlId}fragBufferedComplete(e,t){var i,r,s,o;const c=this.mediaBuffer?this.mediaBuffer:this.media;this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===ln.MAIN?"level":"track"} ${e.level} (frag:[${(null!=(i=e.startPTS)?i:NaN).toFixed(3)}-${(null!=(r=e.endPTS)?r:NaN).toFixed(3)}] > buffer:${c?function(n){let e="";const t=n.length;for(let i=0;i<t;i++)e+=`[${n.start(i).toFixed(3)}-${n.end(i).toFixed(3)}]`;return e}(Un.getBuffered(c)):"(detached)"})`),this.state="IDLE",c&&(!this.loadedmetadata&&e.type==ln.MAIN&&c.buffered.length&&(null==(s=this.fragCurrent)?void 0:s.sn)===(null==(o=this.fragPrevious)?void 0:o.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:i,part:r,partsLoaded:s}=e,o=!s||0===s.length||s.some(d=>!d),c=new Sv(i.level,i.sn,i.stats.chunkCount+1,0,r?r.index:-1,!o);t.flush(c)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,i=null,r){var s;const o=t?.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let c=null;if(!e.encrypted||null!=(s=e.decryptdata)&&s.key?!e.encrypted&&o.encryptedFragments.length&&this.keyLoader.loadClear(e,o.encryptedFragments):(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${"[stream-controller]"===this.logPrefix?"level":"track"} ${e.level}`),this.state="KEY_LOADING",this.fragCurrent=e,c=this.keyLoader.load(e).then(g=>{if(!this.fragContextChanged(g.frag))return this.hls.trigger(N.KEY_LOADED,g),"KEY_LOADING"===this.state&&(this.state="IDLE"),g}),this.hls.trigger(N.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(c=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))),i=Math.max(e.start,i||0),this.config.lowLatencyMode&&"initSegment"!==e.sn){const g=o.partList;if(g&&r){i>e.end&&o.fragmentHint&&(e=o.fragmentHint);const v=this.getNextPart(g,e,i);if(v>-1){const E=g[v];let T;return this.log(`Loading part sn: ${e.sn} p: ${E.index} cc: ${e.cc} of playlist [${o.startSN}-${o.endSN}] parts [0-${v}-${g.length-1}] ${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=E.start+E.duration,this.state="FRAG_LOADING",T=c?c.then(C=>!C||this.fragContextChanged(C.frag)?null:this.doFragPartsLoad(e,E,t,r)).catch(C=>this.handleFragLoadError(C)):this.doFragPartsLoad(e,E,t,r).catch(C=>this.handleFragLoadError(C)),this.hls.trigger(N.FRAG_LOADING,{frag:e,part:E,targetBufferTime:i}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):T}if(!e.url||this.loadedEndOfParts(g,i))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${o?"of ["+o.startSN+"-"+o.endSN+"] ":""}${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(i.toFixed(3))}`),Jt(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state="FRAG_LOADING";const d=this.config.progressive;let m;return m=d&&c?c.then(g=>!g||this.fragContextChanged(g?.frag)?null:this.fragmentLoader.load(e,r)).catch(g=>this.handleFragLoadError(g)):Promise.all([this.fragmentLoader.load(e,d?r:void 0),c]).then(([g])=>(!d&&g&&r&&r(g),g)).catch(g=>this.handleFragLoadError(g)),this.hls.trigger(N.FRAG_LOADING,{frag:e,targetBufferTime:i}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):m}doFragPartsLoad(e,t,i,r){return new Promise((s,o)=>{var c;const d=[],m=null==(c=i.details)?void 0:c.partList,g=v=>{this.fragmentLoader.loadPart(e,v,r).then(E=>{d[v.index]=E;const T=E.part;this.hls.trigger(N.FRAG_LOADED,E);const C=_v(i,e.sn,v.index+1)||yv(m,e.sn,v.index+1);if(!C)return s({frag:e,part:T,partsLoaded:d});g(C)}).catch(o)};g(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===Me.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(N.ERROR,t)}else this.hls.trigger(N.ERROR,{type:an.OTHER_ERROR,details:Me.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||"PARSING"!==this.state)return void(!this.fragCurrent&&"STOPPED"!==this.state&&"ERROR"!==this.state&&(this.state="IDLE"));const{frag:i,part:r,level:s}=t,o=self.performance.now();i.stats.parsing.end=o,r&&(r.stats.parsing.end=o),this.updateLevelTiming(i,r,s,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:i}=this,{level:r,sn:s,part:o}=e;if(null==t||!t[r])return this.warn(`Levels object was unset while buffering fragment ${s} of level ${r}. The current chunk will not be buffered.`),null;const c=t[r],d=o>-1?_v(c,s,o):null,m=d?d.fragment:function Kx(n,e,t){if(null==n||!n.details)return null;const i=n.details;let r=i.fragments[e-i.startSN];return r||(r=i.fragmentHint,r&&r.sn===e)?r:e<i.startSN&&t&&t.sn===e?t:null}(c,s,i);return m?(i&&i!==m&&(m.stats=i.stats),{frag:m,part:d,level:c}):null}bufferFragmentData(e,t,i,r,s){var o;if(!e||"PARSING"!==this.state)return;const{data1:c,data2:d}=e;let m=c;if(c&&d&&(m=td(c,d)),null!=(o=m)&&o.length&&(this.hls.trigger(N.BUFFER_APPENDING,{type:e.type,frag:t,part:i,chunkMeta:r,parent:t.type,data:m}),e.dropped&&e.independent&&!i)){if(s)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Un.isBuffered(t,t.currentTime))return void this.flushMainBuffer(0,e.start);const i=t.currentTime,r=Un.bufferInfo(t,i,0),o=Math.min(2*this.config.maxFragLookUpTolerance,.25*e.duration),c=Math.max(Math.min(e.start-o,r.end-o),i+o);e.start-c>o&&this.flushMainBuffer(c,e.start)}getFwdBufferInfo(e,t){const i=this.getLoadPosition();return Jt(i)?this.getFwdBufferInfoAtPos(e,i,t):null}getFwdBufferInfoAtPos(e,t,i){const{config:{maxBufferHole:r}}=this,s=Un.bufferInfo(e,t,r);if(0===s.len&&void 0!==s.nextStart){const o=this.fragmentTracker.getBufferedFrag(t,i);if(o&&s.nextStart<o.end)return Un.bufferInfo(e,t,Math.max(s.nextStart,r))}return s}getMaxBufferLength(e){const{config:t}=this;let i;return i=e?Math.max(8*t.maxBufferSize/e,t.maxBufferLength):t.maxBufferLength,Math.min(i,t.maxMaxBufferLength)}reduceMaxBufferLength(e){const t=this.config;return t.maxMaxBufferLength>=(e||t.maxBufferLength)&&(t.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${t.maxMaxBufferLength}s`),!0)}getAppendedFrag(e,t=ln.MAIN){const i=this.fragmentTracker.getAppendedFrag(e,ln.MAIN);return i&&"fragment"in i?i.fragment:i}getNextFragment(e,t){const i=t.fragments,r=i.length;if(!r)return null;const{config:s}=this,o=i[0].start;let c;if(t.live){const d=s.initialLiveManifestSize;if(r<d)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${d})`),null;!t.PTSKnown&&!this.startFragRequested&&-1===this.startPosition&&(c=this.getInitialLiveFragment(t,i),this.startPosition=c?this.hls.liveSyncPosition||c.start:e)}else e<=o&&(c=i[0]);return c||(c=this.getFragmentAtPosition(e,s.lowLatencyMode?t.partEnd:t.fragmentEnd,t)),this.mapToInitFragWhenRequired(c)}isLoopLoading(e,t){const i=this.fragmentTracker.getState(e);return("OK"===i||"PARTIAL"===i&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,i,r,s){const o=e.gap,c=this.getNextFragment(this.nextLoadPosition,t);if(null===c)return c;if(e=c,o&&e&&!e.gap&&i.nextStart){const d=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,i.nextStart,r);if(null!==d&&i.len+d.len>=s)return this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment}getNextPart(e,t,i){let r=-1,s=!1,o=!0;for(let c=0,d=e.length;c<d;c++){const m=e[c];if(o=o&&!m.independent,r>-1&&i<m.start)break;const g=m.loaded;g?r=-1:(s||m.independent||o)&&m.fragment===t&&(r=c),s=g}return r}loadedEndOfParts(e,t){const i=e[e.length-1];return i&&t>i.start&&i.loaded}getInitialLiveFragment(e,t){const i=this.fragPrevious;let r=null;if(i){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),r=function od(n,e,t){if(null===e||!Array.isArray(n)||!n.length||!Jt(e))return null;if(e<(n[0].programDateTime||0))return null;if(e>=(n[n.length-1].endProgramDateTime||0))return null;t=t||0;for(let s=0;s<n.length;++s){const o=n[s];if(wv(e,t,o))return o}return null}(t,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){const s=i.sn+1;if(s>=e.startSN&&s<=e.endSN){const o=t[s-e.startSN];i.cc===o.cc&&(r=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}r||(r=function PL(n,e){return n_.search(n,t=>t.cc<e?1:t.cc>e?-1:0)}(t,i.cc),r&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`))}}else{const s=this.hls.liveSyncPosition;null!==s&&(r=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r}getFragmentAtPosition(e,t,i){const{config:r}=this;let{fragPrevious:s}=this,{fragments:o,endSN:c}=i;const{fragmentHint:d}=i,m=r.maxFragLookUpTolerance,g=i.partList,v=!!(r.lowLatencyMode&&null!=g&&g.length&&d);let E;if(v&&d&&!this.bitrateTest&&(o=o.concat(d),c=d.sn),E=e<t?ad(s,o,e,e>t-m?0:m):o[o.length-1],E){const T=E.sn-i.startSN,C=this.fragmentTracker.getState(E);if(("OK"===C||"PARTIAL"===C&&E.gap)&&(s=E),s&&E.sn===s.sn&&(!v||g[0].fragment.sn>E.sn)&&s&&E.level===s.level){const P=o[T+1];E=E.sn<c&&"OK"!==this.fragmentTracker.getState(P)?P:null}}return E}synchronizeToLiveEdge(e){const{config:t,media:i}=this;if(!i)return;const r=this.hls.liveSyncPosition,s=i.currentTime,c=e.edge,d=s>=e.fragments[0].start-t.maxFragLookUpTolerance&&s<=c;null!==r&&i.duration>r&&(s<r||!d)&&(!d&&i.readyState<4||s<c-(void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration))&&(this.loadedmetadata||(this.nextLoadPosition=r),i.readyState&&(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${c}, reset currentTime to : ${r.toFixed(3)}`),i.currentTime=r))}alignPlaylists(e,t){const{levels:i,levelLastLoaded:r,fragPrevious:s}=this,o=null!==r?i[r]:null,c=e.fragments.length;if(!c)return this.warn("No fragments in live playlist"),0;const d=e.fragments[0].start,m=!t,g=e.alignedSliding&&Jt(d);if(m||!g&&!d){!function _A(n,e,t){e&&(function yA(n,e,t){if(function Ra(n,e,t){return!(!e.details||!(t.endCC>t.startCC||n&&n.cc<t.startCC))}(n,t,e)){const i=function ka(n,e,t=0){const i=n.fragments,r=e.fragments;if(!r.length||!i.length)return void ce.log("No fragments to align");const s=Aa(i,r[0].cc);if(s&&(!s||s.startPTS))return s;ce.log("No frag in previous level to align on")}(t.details,e);i&&Jt(i.start)&&(ce.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),o_(i.start,e))}}(n,t,e),!t.alignedSliding&&e.details&&function vA(n,e){if(!e.fragments.length||!n.hasProgramDateTime||!e.hasProgramDateTime)return;const t=e.fragments[0].programDateTime,i=n.fragments[0].programDateTime,r=(i-t)/1e3+e.fragments[0].start;r&&Jt(r)&&(ce.log(`Adjusting PTS using programDateTime delta ${i-t}ms, sliding:${r.toFixed(3)} ${n.url} `),o_(r,n))}(t,e.details),!t.alignedSliding&&e.details&&!t.skippedSegments&&gv(e.details,t))}(s,o,e);const v=e.fragments[0].start;return this.log(`Live playlist sliding: ${v.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${s?s.sn:"na"} fragments: ${c}`),v}return d}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)}setStartPosition(e,t){let i=this.startPosition;if(i<t&&(i=-1),-1===i||-1===this.lastCurrentTime){const r=null!==this.startTimeOffset,s=r?this.startTimeOffset:e.startTimeOffset;null!==s&&Jt(s)?(i=t+s,s<0&&(i+=e.totalduration),i=Math.min(Math.max(t,i),t+e.totalduration),this.log(`Start time offset ${s} found in ${r?"multivariant":"media"} playlist, adjust startPosition to ${i}`),this.startPosition=i):e.live?i=this.hls.liveSyncPosition||t:this.startPosition=i=0,this.lastCurrentTime=i}this.nextLoadPosition=i}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&"initSegment"!==e.sn&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&"FRAG_LOADING_WAITING_RETRY"!==this.state)&&(this.state="IDLE")}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const v=this.getCurrentContext(t.chunkMeta);v&&(t.frag=v.frag)}const i=t.frag;if(!i||i.type!==e||!this.levels)return;var r;if(this.fragContextChanged(i))return void this.warn(`Frag load error must match current frag to retry ${i.url} > ${null==(r=this.fragCurrent)?void 0:r.url}`);const s=t.details===Me.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(i,!0);const o=t.errorAction,{action:c,retryCount:d=0,retryConfig:m}=o||{};if(o&&5===c&&m){var g;this.resetStartWhenNotLoaded(null!=(g=this.levelLastLoaded)?g:i.level);const v=jh(m,d);this.warn(`Fragment ${i.sn} of ${e} ${i.level} errored with ${t.details}, retrying loading ${d+1}/${m.maxNumRetry} in ${v}ms`),o.resolved=!0,this.retryDate=self.performance.now()+v,this.state="FRAG_LOADING_WAITING_RETRY"}else m&&o?(this.resetFragmentErrors(e),d<m.maxNumRetry?s||(o.resolved=!0):ce.warn(`${t.details} reached or exceeded max retry (${d})`)):this.state=2===o?.action?"WAITING_LEVEL":"ERROR";this.tickImmediate()}reduceLengthAndFlushBuffer(e){if("PARSING"===this.state||"PARSED"===this.state){const t=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,t),r=i&&i.len>.5;r&&this.reduceMaxBufferLength(i.len);const s=!r;return s&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${t} buffer`),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),s}return!1}resetFragmentErrors(e){e===ln.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),"STOPPED"!==this.state&&(this.state="IDLE")}afterBufferFlushed(e,t,i){if(!e)return;const r=Un.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,i),"ENDED"===this.state&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state="IDLE"}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=this.levels?this.levels[e].details:null;null!=t&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){var t;this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(null!=(t=this.levelLastLoaded)?t:e.level),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,i,r){var s;const o=i.details;if(o){if(Object.keys(e.elementaryStreams).reduce((d,m)=>{const g=e.elementaryStreams[m];if(g){const v=g.endPTS-g.startPTS;if(v<=0)return this.warn(`Could not parse fragment ${e.sn} ${m} duration reliably (${v})`),d||!1;const E=r?0:Hx(o,e,g.startPTS,g.endPTS,g.startDTS,g.endDTS);return this.hls.trigger(N.LEVEL_PTS_UPDATED,{details:o,level:i,drift:E,type:m,frag:e,start:g.startPTS,end:g.endPTS}),!0}return d},!1))i.fragmentError=0;else if(null===(null==(s=this.transmuxer)?void 0:s.error)){const d=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(0===i.fragmentError&&(i.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(d.message),this.hls.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Me.FRAG_PARSING_ERROR,fatal:!1,error:d,frag:e,reason:`Found no media in msn ${e.sn} of level "${i.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state="PARSED",this.hls.trigger(N.FRAG_PARSED,{frag:e,part:t})}else this.warn("level.details undefined")}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){var t,i,r;"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(null!=(t=null!=(i=this.levelLastLoaded)?i:null==(r=this.fragCurrent)?void 0:r.level)?t:0),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function tT(){return self.SourceBuffer||self.WebKitSourceBuffer}function Ma(n="",e=9e4){return{type:n,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class kv{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,i,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,i){}demux(e,t){this.cachedData&&(e=td(this.cachedData,e),this.cachedData=null);let s,i=Km(e,0),r=i?i.length:0;const o=this._audioTrack,c=this._id3Track,d=i?(n=>{const e=Ym(n);for(let t=0;t<e.length;t++){const i=e[t];if(Kg(i))return Sx(i)}})(i):void 0,m=e.length;for((null===this.basePTS||0===this.frameIndex&&Jt(d))&&(this.basePTS=sT(d,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),i&&i.length>0&&c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:"org.id3",duration:Number.POSITIVE_INFINITY});r<m;){if(this.canParse(e,r)){const g=this.appendFrame(o,e,r);g?(this.frameIndex++,this.lastPTS=g.sample.pts,r+=g.length,s=r):r=m}else xx(e,r)?(i=Km(e,r),c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:"org.id3",duration:Number.POSITIVE_INFINITY}),r+=i.length,s=r):r++;if(r===m&&s!==m){const g=Oh(e,s);this.cachedData=this.cachedData?td(this.cachedData,g):g}}return{audioTrack:o,videoTrack:Ma(),id3Track:c,textTrack:Ma()}}demuxSampleAes(e,t,i){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Ma(),id3Track:this._id3Track,textTrack:Ma()}}destroy(){}}const sT=(n,e,t)=>Jt(n)?90*n:9e4*e+(t?9e4*t.baseTime/t.timescale:0);function Mv(n,e){return 255===n[e]&&240==(246&n[e+1])}function Lv(n,e){return 1&n[e+1]?7:9}function l_(n,e){return(3&n[e+3])<<11|n[e+4]<<3|(224&n[e+5])>>>5}function c_(n,e){return e+1<n.length&&Mv(n,e)}function TA(n,e){if(c_(n,e)){const t=Lv(n,e);if(e+t>=n.length)return!1;const i=l_(n,e);if(i<=t)return!1;const r=e+i;return r===n.length||c_(n,r)}return!1}function aT(n,e,t,i,r){if(!n.samplerate){const s=function oT(n,e,t,i){let r,s,o,c;const d=navigator.userAgent.toLowerCase(),m=i,g=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];r=1+((192&e[t+2])>>>6);const v=(60&e[t+2])>>>2;if(!(v>g.length-1))return o=(1&e[t+2])<<2,o|=(192&e[t+3])>>>6,ce.log(`manifest codec:${i}, ADTS type:${r}, samplingIndex:${v}`),/firefox/i.test(d)?v>=6?(r=5,c=new Array(4),s=v-3):(r=2,c=new Array(2),s=v):-1!==d.indexOf("android")?(r=2,c=new Array(2),s=v):(r=5,c=new Array(4),i&&(-1!==i.indexOf("mp4a.40.29")||-1!==i.indexOf("mp4a.40.5"))||!i&&v>=6?s=v-3:((i&&-1!==i.indexOf("mp4a.40.2")&&(v>=6&&1===o||/vivaldi/i.test(d))||!i&&1===o)&&(r=2,c=new Array(2)),s=v)),c[0]=r<<3,c[0]|=(14&v)>>1,c[1]|=(1&v)<<7,c[1]|=o<<3,5===r&&(c[1]|=(14&s)>>1,c[2]=(1&s)<<7,c[2]|=8,c[3]=0),{config:c,samplerate:g[v],channelCount:o,codec:"mp4a.40."+r,manifestCodec:m};n.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Me.FRAG_PARSING_ERROR,fatal:!0,reason:`invalid ADTS sampling index:${v}`})}(e,t,i,r);if(!s)return;n.config=s.config,n.samplerate=s.samplerate,n.channelCount=s.channelCount,n.codec=s.codec,n.manifestCodec=s.manifestCodec,ce.log(`parsed codec:${n.codec}, rate:${s.samplerate}, channels:${s.channelCount}`)}}function lT(n){return 9216e4/n}function cT(n,e,t,i,r){const o=i+r*lT(n.samplerate),c=function IA(n,e){const t=Lv(n,e);if(e+t<=n.length){const i=l_(n,e)-t;if(i>0)return{headerLength:t,frameLength:i}}}(e,t);let d;if(c){const{frameLength:v,headerLength:E}=c,T=E+v,C=Math.max(0,t+T-e.length);C?(d=new Uint8Array(T-E),d.set(e.subarray(t+E,e.length),0)):d=e.subarray(t+E,t+T);const k={unit:d,pts:o};return C||n.samples.push(k),{sample:k,length:T,missing:C}}const m=e.length-t;return d=new Uint8Array(m),d.set(e.subarray(t,e.length),0),{sample:{unit:d,pts:o},length:m,missing:-1}}const CA=/\/emsg[-/]ID3/i;let u_=null;const AA=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],RA=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],kA=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],MA=[0,1,1,4];function uT(n,e,t,i,r){if(t+24>e.length)return;const s=dT(e,t);if(s&&t+s.frameLength<=e.length){const c=i+r*(9e4*s.samplesPerFrame/s.sampleRate),d={unit:e.subarray(t,t+s.frameLength),pts:c,dts:c};return n.config=[],n.channelCount=s.channelCount,n.samplerate=s.sampleRate,n.samples.push(d),{sample:d,length:s.frameLength,missing:0}}}function dT(n,e){const t=n[e+1]>>3&3,i=n[e+1]>>1&3,r=n[e+2]>>4&15,s=n[e+2]>>2&3;if(1!==t&&0!==r&&15!==r&&3!==s){const c=n[e+3]>>6,m=1e3*AA[14*(3===t?3-i:3===i?3:4)+r-1],v=RA[3*(3===t?0:2===t?1:2)+s],E=3===c?1:2,T=kA[t][i],C=MA[i],k=8*T*C,P=Math.floor(T*m/v+(n[e+2]>>1&1))*C;if(null===u_){const W=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);u_=W?parseInt(W[1]):0}return!!u_&&u_<=87&&2===i&&m>=224e3&&0===c&&(n[e+3]=128|n[e+3]),{sampleRate:v,channelCount:E,frameLength:P,samplesPerFrame:k}}}function d_(n,e){return 255===n[e]&&224==(224&n[e+1])&&0!=(6&n[e+1])}function Ov(n,e){return e+1<n.length&&d_(n,e)}function fT(n,e){if(e+1<n.length&&d_(n,e)){const i=dT(n,e);let r=4;null!=i&&i.frameLength&&(r=i.frameLength);const s=e+r;return s===n.length||Ov(n,s)}return!1}class Pv{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,i=e.byteLength-t,r=new Uint8Array(4),s=Math.min(4,t);if(0===s)throw new Error("no bytes available");r.set(e.subarray(i,i+s)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=8*s,this.bytesAvailable-=s}skipBits(e){let t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(t=(e-=this.bitsAvailable)>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const i=this.word>>>32-t;if(e>32&&ce.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return t=e-t,t>0&&this.bitsAvailable?i<<t|this.readBits(t):i}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let r,t=8,i=8;for(let s=0;s<e;s++)0!==i&&(r=this.readEG(),i=(t+r+256)%256),t=0===i?t:i}readSPS(){let s,o,c,e=0,t=0,i=0,r=0;const d=this.readUByte.bind(this),m=this.readBits.bind(this),g=this.readUEG.bind(this),v=this.readBoolean.bind(this),E=this.skipBits.bind(this),T=this.skipEG.bind(this),C=this.skipUEG.bind(this),k=this.skipScalingList.bind(this);d();const P=d();if(m(5),E(3),d(),C(),100===P||110===P||122===P||244===P||44===P||83===P||86===P||118===P||128===P){const Ae=g();if(3===Ae&&E(1),C(),C(),E(1),v())for(o=3!==Ae?8:12,c=0;c<o;c++)v()&&k(c<6?16:64)}C();const G=g();if(0===G)g();else if(1===G)for(E(1),T(),T(),s=g(),c=0;c<s;c++)T();C(),E(1);const Y=g(),W=g(),te=m(1);0===te&&E(1),E(1),v()&&(e=g(),t=g(),i=g(),r=g());let oe=[1,1];if(v()&&v())switch(d()){case 1:oe=[1,1];break;case 2:oe=[12,11];break;case 3:oe=[10,11];break;case 4:oe=[16,11];break;case 5:oe=[40,33];break;case 6:oe=[24,11];break;case 7:oe=[20,11];break;case 8:oe=[32,11];break;case 9:oe=[80,33];break;case 10:oe=[18,11];break;case 11:oe=[15,11];break;case 12:oe=[64,33];break;case 13:oe=[160,99];break;case 14:oe=[4,3];break;case 15:oe=[3,2];break;case 16:oe=[2,1];break;case 255:oe=[d()<<8|d(),d()<<8|d()]}return{width:Math.ceil(16*(Y+1)-2*e-2*t),height:(2-te)*(W+1)*16-(te?2:4)*(i+r),pixelRatio:oe}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class mT{constructor(e,t,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new Av(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,i){const r=e[t].unit;if(r.length<=16)return;const s=r.subarray(16,r.length-r.length%16),o=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(o).then(c=>{const d=new Uint8Array(c);r.set(d,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,i)})}decryptAacSamples(e,t,i){for(;;t++){if(t>=e.length)return void i();if(!(e[t].unit.length<32||(this.decryptAacSample(e,t,i),this.decrypter.isSync())))return}}getAvcEncryptedData(e){const t=16*Math.floor((e.length-48)/160)+16,i=new Int8Array(t);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)i.set(e.subarray(s,s+16),r);return i}getAvcDecryptedUnit(e,t){const i=new Uint8Array(t);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)e.set(i.subarray(r,r+16),s);return e}decryptAvcSample(e,t,i,r,s){const o=iv(s.data),c=this.getAvcEncryptedData(o);this.decryptBuffer(c.buffer).then(d=>{s.data=this.getAvcDecryptedUnit(o,d),this.decrypter.isSync()||this.decryptAvcSamples(e,t,i+1,r)})}decryptAvcSamples(e,t,i,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,i=0){if(t>=e.length)return void r();const s=e[t].units;for(;!(i>=s.length);i++){const o=s[i];if(!(o.data.length<=48||1!==o.type&&5!==o.type||(this.decryptAvcSample(e,t,i,r,o),this.decrypter.isSync())))return}}}}const Zr=188;class ec{constructor(e,t,i){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=e,this.config=t,this.typeSupported=i}static probe(e){const t=ec.syncOffset(e);return t>0&&ce.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),-1!==t}static syncOffset(e){const t=e.length;let i=Math.min(940,e.length-Zr)+1,r=0;for(;r<i;){let s=!1,o=-1,c=0;for(let d=r;d<t;d+=Zr){if(71!==e[d]){if(c)return-1;break}if(c++,-1===o&&(o=d,0!==o&&(i=Math.min(o+18612,e.length-Zr)+1)),s||(s=0===h_(e,d)),s&&c>1&&(0===o&&c>2||d+Zr>i))return o}r++}return-1}static createTrack(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:Cx[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}}resetInitSegment(e,t,i,r){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=ec.createTrack("video"),this._audioTrack=ec.createTrack("audio",r),this._id3Track=ec.createTrack("id3"),this._txtTrack=ec.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=i,this._duration=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_avcTrack:t,_id3Track:i}=this;e&&(e.pesData=null),t&&(t.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null}demux(e,t,i=!1,r=!1){let s;i||(this.sampleAes=null);const o=this._avcTrack,c=this._audioTrack,d=this._id3Track,m=this._txtTrack;let g=o.pid,v=o.pesData,E=c.pid,T=d.pid,C=c.pesData,k=d.pesData,P=null,G=this.pmtParsed,Y=this._pmtId,W=e.length;if(this.remainderData&&(W=(e=td(this.remainderData,e)).length,this.remainderData=null),W<Zr&&!r)return this.remainderData=e,{audioTrack:c,videoTrack:o,id3Track:d,textTrack:m};const te=Math.max(0,ec.syncOffset(e));W-=(W-te)%Zr,W<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,W,e.buffer.byteLength-W));let oe=0;for(let we=te;we<W;we+=Zr)if(71===e[we]){const Ge=!!(64&e[we+1]),rt=h_(e,we);let Xt;if((48&e[we+3])>>4>1){if(Xt=we+5+e[we+4],Xt===we+Zr)continue}else Xt=we+4;switch(rt){case g:Ge&&(v&&(s=zh(v))&&this.parseAVCPES(o,m,s,!1),v={data:[],size:0}),v&&(v.data.push(e.subarray(Xt,we+Zr)),v.size+=we+Zr-Xt);break;case E:if(Ge){if(C&&(s=zh(C)))switch(c.segmentCodec){case"aac":this.parseAACPES(c,s);break;case"mp3":this.parseMPEGPES(c,s)}C={data:[],size:0}}C&&(C.data.push(e.subarray(Xt,we+Zr)),C.size+=we+Zr-Xt);break;case T:Ge&&(k&&(s=zh(k))&&this.parseID3PES(d,s),k={data:[],size:0}),k&&(k.data.push(e.subarray(Xt,we+Zr)),k.size+=we+Zr-Xt);break;case 0:Ge&&(Xt+=e[Xt]+1),Y=this._pmtId=Nv(e,Xt);break;case Y:{Ge&&(Xt+=e[Xt]+1);const yt=ld(e,Xt,this.typeSupported,i);g=yt.avc,g>0&&(o.pid=g),E=yt.audio,E>0&&(c.pid=E,c.segmentCodec=yt.segmentCodec),T=yt.id3,T>0&&(d.pid=T),null!==P&&!G&&(ce.warn(`MPEG-TS PMT found at ${we} after unknown PID '${P}'. Backtracking to sync byte @${te} to parse all TS packets.`),P=null,we=te-188),G=this.pmtParsed=!0;break}case 17:case 8191:break;default:P=rt}}else oe++;if(oe>0){const we=new Error(`Found ${oe} TS packet/s that do not start with 0x47`);this.observer.emit(N.ERROR,N.ERROR,{type:an.MEDIA_ERROR,details:Me.FRAG_PARSING_ERROR,fatal:!1,error:we,reason:we.message})}o.pesData=v,c.pesData=C,d.pesData=k;const Ae={audioTrack:c,videoTrack:o,id3Track:d,textTrack:m};return r&&this.extractRemainingSamples(Ae),Ae}flush(){const{remainderData:e}=this;let t;return this.remainderData=null,t=e?this.demux(e,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:i,id3Track:r,textTrack:s}=e,o=i.pesData,c=t.pesData,d=r.pesData;let m;if(o&&(m=zh(o))?(this.parseAVCPES(i,s,m,!0),i.pesData=null):i.pesData=o,c&&(m=zh(c))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,m);break;case"mp3":this.parseMPEGPES(t,m)}t.pesData=null}else null!=c&&c.size&&ce.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=c;d&&(m=zh(d))?(this.parseID3PES(r,m),r.pesData=null):r.pesData=d}demuxSampleAes(e,t,i){const r=this.demux(e,i,!0,!this.config.progressive),s=this.sampleAes=new mT(this.observer,this.config,t);return this.decrypt(r,s)}decrypt(e,t){return new Promise(i=>{const{audioTrack:r,videoTrack:s}=e;r.samples&&"aac"===r.segmentCodec?t.decryptAacSamples(r.samples,0,()=>{s.samples?t.decryptAvcSamples(s.samples,0,0,()=>{i(e)}):i(e)}):s.samples&&t.decryptAvcSamples(s.samples,0,0,()=>{i(e)})})}destroy(){this._duration=0}parseAVCPES(e,t,i,r){const s=this.parseAVCNALu(e,i.data);let c,o=this.avcSample,d=!1;i.data=null,o&&s.length&&!e.audFound&&(ap(o,e),o=this.avcSample=op(!1,i.pts,i.dts,"")),s.forEach(m=>{var g;switch(m.type){case 1:{let E=!1;c=!0;const T=m.data;if(d&&T.length>4){const C=new Pv(T).readSliceType();(2===C||4===C||7===C||9===C)&&(E=!0)}var v;E&&null!=(v=o)&&v.frame&&!o.key&&(ap(o,e),o=this.avcSample=null),o||(o=this.avcSample=op(!0,i.pts,i.dts,"")),o.frame=!0,o.key=E;break}case 5:c=!0,null!=(g=o)&&g.frame&&!o.key&&(ap(o,e),o=this.avcSample=null),o||(o=this.avcSample=op(!0,i.pts,i.dts,"")),o.key=!0,o.frame=!0;break;case 6:c=!0,cA(m.data,1,i.pts,t.samples);break;case 7:if(c=!0,d=!0,!e.sps){const E=m.data,C=new Pv(E).readSPS();e.width=C.width,e.height=C.height,e.pixelRatio=C.pixelRatio,e.sps=[E],e.duration=this._duration;const k=E.subarray(1,4);let P="avc1.";for(let G=0;G<3;G++){let Y=k[G].toString(16);Y.length<2&&(Y="0"+Y),P+=Y}e.codec=P}break;case 8:c=!0,e.pps||(e.pps=[m.data]);break;case 9:c=!1,e.audFound=!0,o&&ap(o,e),o=this.avcSample=op(!1,i.pts,i.dts,"");break;case 12:c=!0;break;default:c=!1,o&&(o.debug+="unknown NAL "+m.type+" ")}o&&c&&o.units.push(m)}),r&&o&&(ap(o,e),this.avcSample=null)}getLastNalUnit(e){var t;let r,i=this.avcSample;if((!i||0===i.units.length)&&(i=e[e.length-1]),null!=(t=i)&&t.units){const s=i.units;r=s[s.length-1]}return r}parseAVCNALu(e,t){const i=t.byteLength;let r=e.naluState||0;const s=r,o=[];let d,m,g,c=0,v=-1,E=0;for(-1===r&&(v=0,E=31&t[0],r=0,c=1);c<i;)if(d=t[c++],r)if(1!==r)if(d)if(1===d){if(v>=0){const T={data:t.subarray(v,c-r-1),type:E};o.push(T)}else{const T=this.getLastNalUnit(e.samples);if(T&&(s&&c<=4-s&&T.state&&(T.data=T.data.subarray(0,T.data.byteLength-s)),m=c-r-1,m>0)){const C=new Uint8Array(T.data.byteLength+m);C.set(T.data,0),C.set(t.subarray(0,m),T.data.byteLength),T.data=C,T.state=0}}c<i?(g=31&t[c],v=c,E=g,r=0):r=-1}else r=0;else r=3;else r=d?0:2;else r=d?0:1;if(v>=0&&r>=0){const T={data:t.subarray(v,i),type:E,state:r};o.push(T)}if(0===o.length){const T=this.getLastNalUnit(e.samples);if(T){const C=new Uint8Array(T.data.byteLength+t.byteLength);C.set(T.data,0),C.set(t,T.data.byteLength),T.data=C}}return e.naluState=r,o}parseAACPES(e,t){let i=0;const r=this.aacOverFlow;let o,c,d,s=t.data;if(r){this.aacOverFlow=null;const v=r.missing,E=r.sample.unit.byteLength;if(-1===v){const T=new Uint8Array(E+s.byteLength);T.set(r.sample.unit,0),T.set(s,E),s=T}else{const T=E-v;r.sample.unit.set(s.subarray(0,v),T),e.samples.push(r.sample),i=r.missing}}for(o=i,c=s.length;o<c-1&&!c_(s,o);o++);if(o!==i){let v;const E=o<c-1;v=E?`AAC PES did not start with ADTS header,offset:${o}`:"No ADTS header found in AAC PES";const T=new Error(v);if(ce.warn(`parsing error: ${v}`),this.observer.emit(N.ERROR,N.ERROR,{type:an.MEDIA_ERROR,details:Me.FRAG_PARSING_ERROR,fatal:!1,levelRetry:E,error:T,reason:v}),!E)return}if(aT(e,this.observer,s,o,this.audioCodec),void 0!==t.pts)d=t.pts;else{if(!r)return void ce.warn("[tsdemuxer]: AAC PES unknown PTS");{const v=lT(e.samplerate);d=r.sample.pts+v}}let g,m=0;for(;o<c;){if(g=cT(e,s,o,d,m),o+=g.length,g.missing){this.aacOverFlow=g;break}for(m++;o<c-1&&!c_(s,o);o++);}}parseMPEGPES(e,t){const i=t.data,r=i.length;let s=0,o=0;const c=t.pts;if(void 0!==c)for(;o<r;)if(Ov(i,o)){const d=uT(e,i,o,c,s);if(!d)break;o+=d.length,s++}else o++;else ce.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseID3PES(e,t){if(void 0===t.pts)return void ce.warn("[tsdemuxer]: ID3 PES unknown PTS");const i=vr({},t,{type:this._avcTrack?To_emsg:"org.id3",duration:Number.POSITIVE_INFINITY});e.samples.push(i)}}function op(n,e,t,i){return{key:n,frame:!1,pts:e,dts:t,units:[],debug:i,length:0}}function h_(n,e){return((31&n[e+1])<<8)+n[e+2]}function Nv(n,e){return(31&n[e+10])<<8|n[e+11]}function ld(n,e,t,i){const r={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},o=e+3+((15&n[e+1])<<8|n[e+2])-4;for(e+=12+((15&n[e+10])<<8|n[e+11]);e<o;){const d=h_(n,e);switch(n[e]){case 207:if(!i){ce.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===r.audio&&(r.audio=d);break;case 21:-1===r.id3&&(r.id3=d);break;case 219:if(!i){ce.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===r.avc&&(r.avc=d);break;case 3:case 4:!0!==t.mpeg&&!0!==t.mp3?ce.log("MPEG audio found, not supported in this browser"):-1===r.audio&&(r.audio=d,r.segmentCodec="mp3");break;case 36:ce.warn("Unsupported HEVC stream type found")}e+=5+((15&n[e+3])<<8|n[e+4])}return r}function zh(n){let t,i,r,s,o,e=0;const c=n.data;if(!n||0===n.size)return null;for(;c[0].length<19&&c.length>1;){const m=new Uint8Array(c[0].length+c[1].length);m.set(c[0]),m.set(c[1],c[0].length),c[0]=m,c.splice(1,1)}if(t=c[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(i=(t[4]<<8)+t[5],i&&i>n.size-6)return null;const m=t[7];192&m&&(s=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&m?(o=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,s-o>54e5&&(ce.warn(`${Math.round((s-o)/9e4)}s delta between PTS and DTS, align them`),s=o)):o=s),r=t[8];let g=r+9;if(n.size<=g)return null;n.size-=g;const v=new Uint8Array(n.size);for(let E=0,T=c.length;E<T;E++){t=c[E];let C=t.byteLength;if(g){if(g>C){g-=C;continue}t=t.subarray(g),C-=g,g=0}v.set(t,e),e+=C}return i&&(i-=r+3),{data:v,pts:s,dts:o,len:i}}return null}function ap(n,e){if(n.units.length&&n.frame){if(void 0===n.pts){const t=e.samples,i=t.length;if(!i)return void e.dropped++;{const r=t[i-1];n.pts=r.pts,n.dts=r.dts}}e.samples.push(n)}n.debug.length&&ce.log(n.pts+"/"+n.dts+":"+n.debug)}class LA{static getSilentFrame(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}const fl=Math.pow(2,32)-1;let lp=(()=>{class n{static init(){let t;for(t in n.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},n.types)n.types.hasOwnProperty(t)&&(n.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);const i=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);n.HDLR_TYPES={video:i,audio:r};const s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);n.STTS=n.STSC=n.STCO=o,n.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),n.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),n.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),n.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const c=new Uint8Array([105,115,111,109]),d=new Uint8Array([97,118,99,49]),m=new Uint8Array([0,0,0,1]);n.FTYP=n.box(n.types.ftyp,c,m,c,d),n.DINF=n.box(n.types.dinf,n.box(n.types.dref,s))}static box(t,...i){let r=8,s=i.length;const o=s;for(;s--;)r+=i[s].byteLength;const c=new Uint8Array(r);for(c[0]=r>>24&255,c[1]=r>>16&255,c[2]=r>>8&255,c[3]=255&r,c.set(t,4),s=0,r=8;s<o;s++)c.set(i[s],r),r+=i[s].byteLength;return c}static hdlr(t){return n.box(n.types.hdlr,n.HDLR_TYPES[t])}static mdat(t){return n.box(n.types.mdat,t)}static mdhd(t,i){i*=t;const r=Math.floor(i/(fl+1)),s=Math.floor(i%(fl+1));return n.box(n.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,s>>24,s>>16&255,s>>8&255,255&s,85,196,0,0]))}static mdia(t){return n.box(n.types.mdia,n.mdhd(t.timescale,t.duration),n.hdlr(t.type),n.minf(t))}static mfhd(t){return n.box(n.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}static minf(t){return n.box(n.types.minf,"audio"===t.type?n.box(n.types.smhd,n.SMHD):n.box(n.types.vmhd,n.VMHD),n.DINF,n.stbl(t))}static moof(t,i,r){return n.box(n.types.moof,n.mfhd(t),n.traf(r,i))}static moov(t){let i=t.length;const r=[];for(;i--;)r[i]=n.trak(t[i]);return n.box.apply(null,[n.types.moov,n.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(n.mvex(t)))}static mvex(t){let i=t.length;const r=[];for(;i--;)r[i]=n.trex(t[i]);return n.box.apply(null,[n.types.mvex,...r])}static mvhd(t,i){i*=t;const r=Math.floor(i/(fl+1)),s=Math.floor(i%(fl+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,s>>24,s>>16&255,s>>8&255,255&s,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return n.box(n.types.mvhd,o)}static sdtp(t){const i=t.samples||[],r=new Uint8Array(4+i.length);let s,o;for(s=0;s<i.length;s++)o=i[s].flags,r[s+4]=o.dependsOn<<4|o.isDependedOn<<2|o.hasRedundancy;return n.box(n.types.sdtp,r)}static stbl(t){return n.box(n.types.stbl,n.stsd(t),n.box(n.types.stts,n.STTS),n.box(n.types.stsc,n.STSC),n.box(n.types.stsz,n.STSZ),n.box(n.types.stco,n.STCO))}static avc1(t){let s,o,c,i=[],r=[];for(s=0;s<t.sps.length;s++)o=t.sps[s],c=o.byteLength,i.push(c>>>8&255),i.push(255&c),i=i.concat(Array.prototype.slice.call(o));for(s=0;s<t.pps.length;s++)o=t.pps[s],c=o.byteLength,r.push(c>>>8&255),r.push(255&c),r=r.concat(Array.prototype.slice.call(o));const d=n.box(n.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|t.sps.length].concat(i).concat([t.pps.length]).concat(r))),m=t.width,g=t.height,v=t.pixelRatio[0],E=t.pixelRatio[1];return n.box(n.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,m>>8&255,255&m,g>>8&255,255&g,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),d,n.box(n.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),n.box(n.types.pasp,new Uint8Array([v>>24,v>>16&255,v>>8&255,255&v,E>>24,E>>16&255,E>>8&255,255&E])))}static esds(t){const i=t.config.length;return new Uint8Array([0,0,0,0,3,23+i,0,1,0,4,15+i,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([i]).concat(t.config).concat([6,1,2]))}static mp4a(t){const i=t.samplerate;return n.box(n.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]),n.box(n.types.esds,n.esds(t)))}static mp3(t){const i=t.samplerate;return n.box(n.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]))}static stsd(t){return n.box(n.types.stsd,n.STSD,"audio"===t.type?"mp3"===t.segmentCodec&&"mp3"===t.codec?n.mp3(t):n.mp4a(t):n.avc1(t))}static tkhd(t){const i=t.id,r=t.duration*t.timescale,s=t.width,o=t.height,c=Math.floor(r/(fl+1)),d=Math.floor(r%(fl+1));return n.box(n.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,i>>24&255,i>>16&255,i>>8&255,255&i,0,0,0,0,c>>24,c>>16&255,c>>8&255,255&c,d>>24,d>>16&255,d>>8&255,255&d,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,255&s,0,0,o>>8&255,255&o,0,0]))}static traf(t,i){const r=n.sdtp(t),s=t.id,o=Math.floor(i/(fl+1)),c=Math.floor(i%(fl+1));return n.box(n.types.traf,n.box(n.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s])),n.box(n.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,c>>24,c>>16&255,c>>8&255,255&c])),n.trun(t,r.length+16+20+8+16+8+8),r)}static trak(t){return t.duration=t.duration||4294967295,n.box(n.types.trak,n.tkhd(t),n.mdia(t))}static trex(t){const i=t.id;return n.box(n.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(t,i){const r=t.samples||[],s=r.length,o=12+16*s,c=new Uint8Array(o);let d,m,g,v,E,T;for(c.set(["video"===t.type?1:0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,255&s,(i+=8+o)>>>24&255,i>>>16&255,i>>>8&255,255&i],0),d=0;d<s;d++)m=r[d],g=m.duration,v=m.size,E=m.flags,T=m.cts,c.set([g>>>24&255,g>>>16&255,g>>>8&255,255&g,v>>>24&255,v>>>16&255,v>>>8&255,255&v,E.isLeading<<2|E.dependsOn,E.isDependedOn<<6|E.hasRedundancy<<4|E.paddingValue<<1|E.isNonSync,61440&E.degradPrio,15&E.degradPrio,T>>>24&255,T>>>16&255,T>>>8&255,255&T],12+16*d);return n.box(n.types.trun,c)}static initSegment(t){n.types||n.init();const i=n.moov(t),r=new Uint8Array(n.FTYP.byteLength+i.byteLength);return r.set(n.FTYP),r.set(i,n.FTYP.byteLength),r}}return n.types=void 0,n.HDLR_TYPES=void 0,n.STTS=void 0,n.STSC=void 0,n.STCO=void 0,n.STSZ=void 0,n.VMHD=void 0,n.SMHD=void 0,n.STSD=void 0,n.FTYP=void 0,n.DINF=void 0,n})();const Fv=9e4;function f_(n,e,t=1,i=!1){const r=n*e*t;return i?Math.round(r):r}function Qt(n,e=!1){return f_(n,1e3,1/Fv,e)}let tc,m_=null,qh=null;class Yh{constructor(e,t,i,r=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=e,this.config=t,this.typeSupported=i,this.ISGenerated=!1,null===m_){const o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);m_=o?parseInt(o[1]):0}if(null===qh){const s=navigator.userAgent.match(/Safari\/(\d+)/i);qh=s?parseInt(s[1]):0}}destroy(){}resetTimeStamp(e){ce.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){ce.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){ce.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1}getVideoStartPts(e){let t=!1;const i=e.reduce((r,s)=>{const o=s.pts-r;return o<-4294967296?(t=!0,Kn(r,s.pts)):o>0?r:s.pts},e[0].pts);return t&&ce.debug("PTS rollover detected"),i}remux(e,t,i,r,s,o,c,d){let m,g,v,E,T,C,k=s,P=s;const Y=t.pid>-1,W=t.samples.length,te=e.samples.length>0,oe=c&&W>0||W>1;if((!(e.pid>-1)||te)&&(!Y||oe)||this.ISGenerated||c){this.ISGenerated||(v=this.generateIS(e,t,s,o));const we=this.isVideoContiguous;let rt,Ge=-1;if(oe&&(Ge=function UL(n){for(let e=0;e<n.length;e++)if(n[e].key)return e;return-1}(t.samples),!we&&this.config.forceKeyFrameOnDiscontinuity))if(C=!0,Ge>0){ce.warn(`[mp4-remuxer]: Dropped ${Ge} out of ${W} video samples due to a missing keyframe`);const Pe=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(Ge),t.dropped+=Ge,P+=(t.samples[0].pts-Pe)/t.inputTimeScale,rt=P}else-1===Ge&&(ce.warn(`[mp4-remuxer]: No keyframe found out of ${W} video samples`),C=!1);if(this.ISGenerated){if(te&&oe){const Pe=this.getVideoStartPts(t.samples),yt=(Kn(e.samples[0].pts,Pe)-Pe)/t.inputTimeScale;k+=Math.max(0,yt),P+=Math.max(0,-yt)}if(te){if(e.samplerate||(ce.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),v=this.generateIS(e,t,s,o)),g=this.remuxAudio(e,k,this.isAudioContiguous,o,Y||oe||d===ln.AUDIO?P:void 0),oe){const Pe=g?g.endPTS-g.startPTS:0;t.inputTimeScale||(ce.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),v=this.generateIS(e,t,s,o)),m=this.remuxVideo(t,P,we,Pe)}}else oe&&(m=this.remuxVideo(t,P,we,0));m&&(m.firstKeyFrame=Ge,m.independent=-1!==Ge,m.firstKeyFramePTS=rt)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(T=Bv(i,s,this._initPTS,this._initDTS)),r.samples.length&&(E=Uv(r,s,this._initPTS))),{audio:g,video:m,initSegment:v,independent:C,text:E,id3:T}}generateIS(e,t,i,r){const s=e.samples,o=t.samples,c=this.typeSupported,d={},m=this._initPTS;let E,T,C,g=!m||r,v="audio/mp4";if(g&&(E=T=1/0),e.config&&s.length&&("mp3"===(e.timescale=e.samplerate,e.segmentCodec)&&(c.mpeg?(v="audio/mpeg",e.codec=""):c.mp3&&(e.codec="mp3")),d.audio={id:"audio",container:v,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&c.mpeg?new Uint8Array(0):lp.initSegment([e]),metadata:{channelCount:e.channelCount}},g&&(C=e.inputTimeScale,m&&C===m.timescale?g=!1:E=T=s[0].pts-Math.round(C*i))),t.sps&&t.pps&&o.length&&(t.timescale=t.inputTimeScale,d.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:lp.initSegment([t]),metadata:{width:t.width,height:t.height}},g))if(C=t.inputTimeScale,m&&C===m.timescale)g=!1;else{const k=this.getVideoStartPts(o),P=Math.round(C*i);T=Math.min(T,Kn(o[0].dts,k)-P),E=Math.min(E,k-P)}if(Object.keys(d).length)return this.ISGenerated=!0,g?(this._initPTS={baseTime:E,timescale:C},this._initDTS={baseTime:T,timescale:C}):E=C=void 0,{tracks:d,initPTS:E,timescale:C}}remuxVideo(e,t,i,r){const s=e.inputTimeScale,o=e.samples,c=[],d=o.length,m=this._initPTS;let T,C,g=this.nextAvcDts,v=8,E=this.videoSampleDuration,k=Number.POSITIVE_INFINITY,P=Number.NEGATIVE_INFINITY,G=!1;i&&null!==g||(g=t*s-(o[0].pts-Kn(o[0].dts,o[0].pts)));const Y=m.baseTime*s/m.timescale;for(let $e=0;$e<d;$e++){const dt=o[$e];dt.pts=Kn(dt.pts-Y,g),dt.dts=Kn(dt.dts-Y,g),dt.dts<o[$e>0?$e-1:$e].dts&&(G=!0)}G&&o.sort(function($e,dt){return $e.dts-dt.dts||$e.pts-dt.pts}),T=o[0].dts,C=o[o.length-1].dts;const W=C-T,te=W?Math.round(W/(d-1)):E||e.inputTimeScale/30;if(i){const $e=T-g,dt=$e>te,wn=$e<-1;if((dt||wn)&&(ce.warn(dt?`AVC: ${Qt($e,!0)} ms (${$e}dts) hole between fragments detected, filling it`:`AVC: ${Qt(-$e,!0)} ms (${$e}dts) overlapping between fragments detected`),!wn||g>=o[0].pts)){T=g;const Hn=o[0].pts-$e;o[0].dts=T,o[0].pts=Hn,ce.log(`Video: First PTS/DTS adjusted: ${Qt(Hn,!0)}/${Qt(T,!0)}, delta: ${Qt($e,!0)} ms`)}}T=Math.max(0,T);let oe=0,Ae=0;for(let $e=0;$e<d;$e++){const dt=o[$e],wn=dt.units,Hn=wn.length;let xn=0;for(let vi=0;vi<Hn;vi++)xn+=wn[vi].data.length;Ae+=xn,oe+=Hn,dt.length=xn,dt.dts=Math.max(dt.dts,T),k=Math.min(dt.pts,k),P=Math.max(dt.pts,P)}C=o[d-1].dts;const we=Ae+4*oe+8;let Ge;try{Ge=new Uint8Array(we)}catch($e){return void this.observer.emit(N.ERROR,N.ERROR,{type:an.MUX_ERROR,details:Me.REMUX_ALLOC_ERROR,fatal:!1,error:$e,bytes:we,reason:`fail allocating video mdat ${we}`})}const rt=new DataView(Ge.buffer);rt.setUint32(0,we),Ge.set(lp.types.mdat,4);let Pe=!1,Xt=Number.POSITIVE_INFINITY,yt=Number.POSITIVE_INFINITY,Fn=Number.NEGATIVE_INFINITY,Lr=Number.NEGATIVE_INFINITY;for(let $e=0;$e<d;$e++){const dt=o[$e],wn=dt.units;let xn,Hn=0;for(let jn=0,ia=wn.length;jn<ia;jn++){const ra=wn[jn],er=ra.data,mc=ra.data.byteLength;rt.setUint32(v,mc),v+=4,Ge.set(er,v),v+=mc,Hn+=4+mc}if($e<d-1)E=o[$e+1].dts-dt.dts,xn=o[$e+1].pts-dt.pts;else{const jn=this.config,ia=$e>0?dt.dts-o[$e-1].dts:te;if(xn=$e>0?dt.pts-o[$e-1].pts:te,jn.stretchShortVideoTrack&&null!==this.nextAudioPts){const ra=Math.floor(jn.maxBufferHole*s),er=(r?k+r*s:this.nextAudioPts)-dt.pts;er>ra?(E=er-ia,E<0?E=ia:Pe=!0,ce.log(`[mp4-remuxer]: It is approximately ${er/90} ms to the next segment; using duration ${E/90} ms for the last video frame.`)):E=ia}else E=ia}const vi=Math.round(dt.pts-dt.dts);Xt=Math.min(Xt,E),Fn=Math.max(Fn,E),yt=Math.min(yt,xn),Lr=Math.max(Lr,xn),c.push(new gT(dt.key,E,Hn,vi))}if(c.length)if(m_){if(m_<70){const $e=c[0].flags;$e.dependsOn=2,$e.isNonSync=0}}else if(qh&&Lr-yt<Fn-Xt&&te/Fn<.025&&0===c[0].cts){ce.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let $e=T;for(let dt=0,wn=c.length;dt<wn;dt++){const Hn=$e+c[dt].duration;c[dt].duration=dt<wn-1?Hn+c[dt+1].cts-($e+c[dt].cts):dt?c[dt-1].duration:te,c[dt].cts=0,$e=Hn}}E=Pe||!E?te:E,this.nextAvcDts=g=C+E,this.videoSampleDuration=E,this.isVideoContiguous=!0;const pt={data1:lp.moof(e.sequenceNumber++,T,vr({},e,{samples:c})),data2:Ge,startPTS:k/s,endPTS:(P+E)/s,startDTS:T/s,endDTS:g/s,type:"video",hasAudio:!1,hasVideo:!0,nb:c.length,dropped:e.dropped};return e.samples=[],e.dropped=0,pt}remuxAudio(e,t,i,r,s){const o=e.inputTimeScale,d=o/(e.samplerate?e.samplerate:o),m="aac"===e.segmentCodec?1024:1152,g=m*d,v=this._initPTS,E="mp3"===e.segmentCodec&&this.typeSupported.mpeg,T=[],C=void 0!==s;let k=e.samples,P=E?0:8,G=this.nextAudioPts||-1;const Y=t*o,W=v.baseTime*o/v.timescale;if(this.isAudioContiguous=i=i||k.length&&G>0&&(r&&Math.abs(Y-G)<9e3||Math.abs(Kn(k[0].pts-W,Y)-G)<20*g),k.forEach(function(ct){ct.pts=Kn(ct.pts-W,Y)}),!i||G<0){if(k=k.filter(ct=>ct.pts>=0),!k.length)return;G=0===s?0:r&&!C?Math.max(0,Y):k[0].pts}if("aac"===e.segmentCodec){const ct=this.config.maxAudioFramesDrift;for(let pt=0,$e=G;pt<k.length;pt++){const dt=k[pt],wn=dt.pts,Hn=wn-$e,xn=Math.abs(1e3*Hn/o);if(Hn<=-ct*g&&C)0===pt&&(ce.warn(`Audio frame @ ${(wn/o).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*Hn/o)} ms.`),this.nextAudioPts=G=$e=wn);else if(Hn>=ct*g&&xn<1e4&&C){let vi=Math.round(Hn/g);$e=wn-vi*g,$e<0&&(vi--,$e+=g),0===pt&&(this.nextAudioPts=G=$e),ce.warn(`[mp4-remuxer]: Injecting ${vi} audio frame @ ${($e/o).toFixed(3)}s due to ${Math.round(1e3*Hn/o)} ms gap.`);for(let jn=0;jn<vi;jn++){const ia=Math.max($e,0);let ra=LA.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);ra||(ce.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),ra=dt.unit.subarray()),k.splice(pt,0,{unit:ra,pts:ia}),$e+=g,pt++}}dt.pts=$e,$e+=g}}let Ae,te=null,oe=null,we=0,Ge=k.length;for(;Ge--;)we+=k[Ge].unit.byteLength;for(let ct=0,pt=k.length;ct<pt;ct++){const $e=k[ct],dt=$e.unit;let wn=$e.pts;if(null!==oe)T[ct-1].duration=Math.round((wn-oe)/d);else{if(i&&"aac"===e.segmentCodec&&(wn=G),te=wn,!(we>0))return;we+=P;try{Ae=new Uint8Array(we)}catch(xn){return void this.observer.emit(N.ERROR,N.ERROR,{type:an.MUX_ERROR,details:Me.REMUX_ALLOC_ERROR,fatal:!1,error:xn,bytes:we,reason:`fail allocating audio mdat ${we}`})}E||(new DataView(Ae.buffer).setUint32(0,we),Ae.set(lp.types.mdat,4))}Ae.set(dt,P);const Hn=dt.byteLength;P+=Hn,T.push(new gT(!0,m,Hn,0)),oe=wn}const rt=T.length;if(!rt)return;this.nextAudioPts=G=oe+d*T[T.length-1].duration;const Xt=E?new Uint8Array(0):lp.moof(e.sequenceNumber++,te/d,vr({},e,{samples:T}));e.samples=[];const yt=te/o,Fn=G/o,pi={data1:Xt,data2:Ae,startPTS:yt,endPTS:Fn,startDTS:yt,endDTS:Fn,type:"audio",hasAudio:!0,hasVideo:!1,nb:rt};return this.isAudioContiguous=!0,pi}remuxEmptyAudio(e,t,i,r){const s=e.inputTimeScale,d=this.nextAudioPts,m=this._initDTS,g=9e4*m.baseTime/m.timescale,v=(null!==d?d:r.startDTS*s)+g,T=s/(e.samplerate?e.samplerate:s)*1024,C=Math.ceil((r.endDTS*s+g-v)/T),k=LA.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(ce.warn("[mp4-remuxer]: remux empty Audio"),!k)return void ce.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");const P=[];for(let G=0;G<C;G++){const Y=v+G*T;P.push({unit:k,pts:Y,dts:Y})}return e.samples=P,this.remuxAudio(e,t,i,!1)}}function Kn(n,e){let t;if(null===e)return n;for(t=e<n?-8589934592:8589934592;Math.abs(n-e)>4294967296;)n+=t;return n}function Bv(n,e,t,i){const r=n.samples.length;if(!r)return;const s=n.inputTimeScale;for(let c=0;c<r;c++){const d=n.samples[c];d.pts=Kn(d.pts-t.baseTime*s/t.timescale,e*s)/s,d.dts=Kn(d.dts-i.baseTime*s/i.timescale,e*s)/s}const o=n.samples;return n.samples=[],{samples:o}}function Uv(n,e,t){const i=n.samples.length;if(!i)return;const r=n.inputTimeScale;for(let o=0;o<i;o++){const c=n.samples[o];c.pts=Kn(c.pts-t.baseTime*r/t.timescale,e*r)/r}n.samples.sort((o,c)=>o.pts-c.pts);const s=n.samples;return n.samples=[],{samples:s}}class gT{constructor(e,t,i,r){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=i,this.cts=r,this.flags=new _T(e)}}class _T{constructor(e){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=e?2:1,this.isNonSync=e?0:1}}function Vv(n,e){const t=n?.codec;return t&&t.length>4?t:"hvc1"===t||"hev1"===t?"hvc1.1.6.L120.90":"av01"===t?"av01.0.04M.08":"avc1"===t||e===hi.VIDEO?"avc1.42e01e":"mp4a.40.5"}try{tc=self.performance.now.bind(self.performance)}catch{ce.debug("Unable to use Performance API on this environment"),tc=typeof self<"u"&&self.Date.now}const $v=[{demux:class DA{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,i,r){const s=this.videoTrack=Ma("video",1),o=this.audioTrack=Ma("audio",1),c=this.txtTrack=Ma("text",1);if(this.id3Track=Ma("id3",1),this.timeOffset=0,null==e||!e.byteLength)return;const d=Rx(e);if(d.video){const{id:m,timescale:g,codec:v}=d.video;s.id=m,s.timescale=c.timescale=g,s.codec=v}if(d.audio){const{id:m,timescale:g,codec:v}=d.audio;o.id=m,o.timescale=g,o.codec=v}c.id=Cx.text,s.sampleDuration=0,s.duration=o.duration=r}resetContiguity(){this.remainderData=null}static probe(e){return Bn(e=e.length>16384?e.subarray(0,16384):e,["moof"]).length>0}demux(e,t){this.timeOffset=t;let i=e;const r=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=td(this.remainderData,e));const c=function aA(n){const e={valid:null,remainder:null},t=Bn(n,["moof"]);if(!t)return e;if(t.length<2)return e.remainder=n,e;const i=t[t.length-1];return e.valid=Oh(n,0,i.byteOffset-8),e.remainder=Oh(n,i.byteOffset-8),e}(i);this.remainderData=c.remainder,r.samples=c.valid||new Uint8Array}else r.samples=i;const o=this.extractID3Track(r,t);return s.samples=nv(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,i=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const r=this.extractID3Track(t,this.timeOffset);return i.samples=nv(e,t),{videoTrack:t,audioTrack:Ma(),id3Track:r,textTrack:Ma()}}extractID3Track(e,t){const i=this.id3Track;if(e.samples.length){const r=Bn(e.samples,["emsg"]);r&&r.forEach(s=>{const o=function OL(n){const e=n[0];let t="",i="",r=0,s=0,o=0,c=0,d=0,m=0;if(0===e){for(;"\0"!==qr(n.subarray(m,m+1));)t+=qr(n.subarray(m,m+1)),m+=1;for(t+=qr(n.subarray(m,m+1)),m+=1;"\0"!==qr(n.subarray(m,m+1));)i+=qr(n.subarray(m,m+1)),m+=1;i+=qr(n.subarray(m,m+1)),m+=1,r=pn(n,12),s=pn(n,16),c=pn(n,20),d=pn(n,24),m=28}else if(1===e){m+=4,r=pn(n,m),m+=4;const v=pn(n,m);m+=4;const E=pn(n,m);for(m+=4,o=2**32*v+E,Number.isSafeInteger(o)||(o=Number.MAX_SAFE_INTEGER,ce.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),c=pn(n,m),m+=4,d=pn(n,m),m+=4;"\0"!==qr(n.subarray(m,m+1));)t+=qr(n.subarray(m,m+1)),m+=1;for(t+=qr(n.subarray(m,m+1)),m+=1;"\0"!==qr(n.subarray(m,m+1));)i+=qr(n.subarray(m,m+1)),m+=1;i+=qr(n.subarray(m,m+1)),m+=1}return{schemeIdUri:t,value:i,timeScale:r,presentationTime:o,presentationTimeDelta:s,eventDuration:c,id:d,payload:n.subarray(m,n.byteLength)}}(s);if(CA.test(o.schemeIdUri)){const c=Jt(o.presentationTime)?o.presentationTime/o.timeScale:t+o.presentationTimeDelta/o.timeScale;let d=4294967295===o.eventDuration?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;d<=.001&&(d=Number.POSITIVE_INFINITY);const m=o.payload;i.samples.push({data:m,len:m.byteLength,dts:c,pts:c,type:To_emsg,duration:d})}})}return i}demuxSampleAes(e,t,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}},remux:class yT{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,i,r){this.audioCodec=t,this.videoCodec=i,this.generateInitSegment(function tv(n,e){if(!n||!e)return n;const t=e.keyId;return t&&e.isCommonEncryption&&Bn(n,["moov","trak"]).forEach(r=>{const o=Bn(r,["mdia","minf","stbl","stsd"])[0].subarray(8);let c=Bn(o,["enca"]);const d=c.length>0;d||(c=Bn(o,["encv"])),c.forEach(m=>{Bn(m.subarray(d?28:78),["sinf"]).forEach(E=>{const T=kx(E);if(T){const C=T.subarray(8,24);C.some(k=>0!==k)||(ce.log(`[eme] Patching keyId in 'enc${d?"a":"v"}>sinf>>tenc' box: ${ul_hexDump(C)} -> ${ul_hexDump(t)}`),T.set(t,8))}})})}),n}(e,r)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:i}=this;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const r=this.initData=Rx(e);t||(t=Vv(r.audio,hi.AUDIO)),i||(i=Vv(r.video,hi.VIDEO));const s={};r.audio&&r.video?s.audiovideo={container:"video/mp4",codec:t+","+i,initSegment:e,id:"main"}:r.audio?s.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:r.video?s.video={container:"video/mp4",codec:i,initSegment:e,id:"main"}:ce.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=s}remux(e,t,i,r,s,o){var c,d;let{initPTS:m,lastEndTime:g}=this;const v={audio:void 0,video:void 0,text:r,id3:i,initSegment:void 0};Jt(g)||(g=this.lastEndTime=s||0);const E=t.samples;if(null==E||!E.length)return v;const T={initPTS:void 0,timescale:1};let C=this.initData;if(null!=(c=C)&&c.length||(this.generateInitSegment(E),C=this.initData),null==(d=C)||!d.length)return ce.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),v;this.emitInitSegment&&(T.tracks=this.initTracks,this.emitInitSegment=!1);const k=function rA(n,e){let t=0,i=0,r=0;const s=Bn(n,["moof","traf"]);for(let o=0;o<s.length;o++){const c=s[o],d=Bn(c,["tfhd"])[0],g=e[pn(d,4)];if(!g)continue;const v=g.default,E=pn(d,0)|v?.flags;let T=v?.duration;8&E&&(T=pn(d,2&E?12:8));const C=g.timescale||9e4,k=Bn(c,["trun"]);for(let P=0;P<k.length;P++)t=sA(k[P]),!t&&T&&(t=T*pn(k[P],4)),g.type===hi.VIDEO?i+=t/C:g.type===hi.AUDIO&&(r+=t/C)}if(0===i&&0===r){let o=0;const c=Bn(n,["sidx"]);for(let d=0;d<c.length;d++){const m=ev(c[d]);null!=m&&m.references&&(o+=m.references.reduce((g,v)=>g+v.info.duration||0,0))}return o}return i||r}(E,C),P=function iA(n,e){return Bn(e,["moof","traf"]).reduce((t,i)=>{const r=Bn(i,["tfdt"])[0],s=r[0],o=Bn(i,["tfhd"]).reduce((c,d)=>{const m=pn(d,4),g=n[m];if(g){let v=pn(r,4);if(1===s){if(v===X0)return ce.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),c;v*=X0+1,v+=pn(r,8)}const T=v/(g.timescale||9e4);if(isFinite(T)&&(null===c||T<c))return T}return c},null);return null!==o&&isFinite(o)&&(null===t||o<t)?o:t},null)}(C,E),G=null===P?s:P;(function vT(n,e,t,i){if(null===n)return!0;const r=Math.max(i,1);return Math.abs(e-n.baseTime/n.timescale-t)>r}(m,G,s,k)||T.timescale!==m.timescale&&o)&&(T.initPTS=G-s,m&&1===m.timescale&&ce.warn("Adjusting initPTS by "+(T.initPTS-m.baseTime)),this.initPTS=m={baseTime:T.initPTS,timescale:1});const Y=e?G-m.baseTime/m.timescale:g,W=Y+k;(function oA(n,e,t){Bn(e,["moof","traf"]).forEach(i=>{Bn(i,["tfhd"]).forEach(r=>{const s=pn(r,4),o=n[s];if(!o)return;const c=o.timescale||9e4;Bn(i,["tfdt"]).forEach(d=>{const m=d[0];let g=pn(d,4);if(0===m)g-=t*c,g=Math.max(g,0),J0(d,4,g);else{g*=Math.pow(2,32),g+=pn(d,8),g-=t*c,g=Math.max(g,0);const v=Math.floor(g/(X0+1)),E=Math.floor(g%(X0+1));J0(d,4,v),J0(d,8,E)}})})})})(C,E,m.baseTime/m.timescale),k>0?this.lastEndTime=W:(ce.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const te=!!C.audio,oe=!!C.video;let Ae="";te&&(Ae+="audio"),oe&&(Ae+="video");const we={data1:E,startPTS:Y,startDTS:Y,endPTS:W,endDTS:W,type:Ae,hasAudio:te,hasVideo:oe,nb:1,dropped:0};return v.audio="audio"===we.type?we:void 0,v.video="audio"!==we.type?we:void 0,v.initSegment=T,v.id3=Bv(i,s,m,m),r.samples.length&&(v.text=Uv(r,s,m)),v}}},{demux:ec,remux:Yh},{demux:class SA extends kv{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,i,r){super.resetInitSegment(e,t,i,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let i=(Km(e,0)||[]).length;for(let r=e.length;i<r;i++)if(TA(e,i))return ce.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return function xA(n,e){return function EA(n,e){return e+5<n.length}(n,e)&&Mv(n,e)&&l_(n,e)<=n.length-e}(e,t)}appendFrame(e,t,i){aT(e,this.observer,t,i,e.manifestCodec);const r=cT(e,t,i,this.basePTS,this.frameIndex);if(r&&0===r.missing)return r}},remux:Yh},{demux:class Wh extends kv{resetInitSegment(e,t,i,r){super.resetInitSegment(e,t,i,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let i=(Km(e,0)||[]).length;for(let r=e.length;i<r;i++)if(fT(e,i))return ce.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return function hT(n,e){return d_(n,e)&&4<=n.length-e}(e,t)}appendFrame(e,t,i){if(null!==this.basePTS)return uT(e,t,i,this.basePTS,this.frameIndex)}},remux:Yh}];class bT{constructor(e,t,i,r,s){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=i,this.vendor=r,this.id=s}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,i,r){const s=i.transmuxing;s.executeStart=tc();let o=new Uint8Array(e);const{currentTransmuxState:c,transmuxConfig:d}=this;r&&(this.currentTransmuxState=r);const{contiguous:m,discontinuity:g,trackSwitch:v,accurateTimeOffset:E,timeOffset:T,initSegmentChange:C}=r||c,{audioCodec:k,videoCodec:P,defaultInitPts:G,duration:Y,initSegmentData:W}=d,te=function cp(n,e){let t=null;return n.byteLength>0&&null!=e&&null!=e.key&&null!==e.iv&&null!=e.method&&(t=e),t}(o,t);if(te&&"AES-128"===te.method){const Ge=this.getDecrypter();if(!Ge.isSync())return this.decryptionPromise=Ge.webCryptoDecrypt(o,te.key.buffer,te.iv.buffer).then(rt=>{const Pe=this.push(rt,null,i);return this.decryptionPromise=null,Pe}),this.decryptionPromise;{let rt=Ge.softwareDecrypt(o,te.key.buffer,te.iv.buffer);if(i.part>-1&&(rt=Ge.flush()),!rt)return s.executeEnd=tc(),Hv(i);o=new Uint8Array(rt)}}const oe=this.needsProbing(g,v);if(oe){const Ge=this.configureTransmuxer(o);if(Ge)return ce.warn(`[transmuxer] ${Ge.message}`),this.observer.emit(N.ERROR,N.ERROR,{type:an.MEDIA_ERROR,details:Me.FRAG_PARSING_ERROR,fatal:!1,error:Ge,reason:Ge.message}),s.executeEnd=tc(),Hv(i)}(g||v||C||oe)&&this.resetInitSegment(W,k,P,Y,t),(g||C||oe)&&this.resetInitialTimestamp(G),m||this.resetContiguity();const Ae=this.transmux(o,te,T,E,i),we=this.currentTransmuxState;return we.contiguous=!0,we.discontinuity=!1,we.trackSwitch=!1,s.executeEnd=tc(),Ae}flush(e){const t=e.transmuxing;t.executeStart=tc();const{decrypter:i,currentTransmuxState:r,decryptionPromise:s}=this;if(s)return s.then(()=>this.flush(e));const o=[],{timeOffset:c}=r;if(i){const v=i.flush();v&&o.push(this.push(v,null,e))}const{demuxer:d,remuxer:m}=this;if(!d||!m)return t.executeEnd=tc(),[Hv(e)];const g=d.flush(c);return p_(g)?g.then(v=>(this.flushRemux(o,v,e),o)):(this.flushRemux(o,g,e),o)}flushRemux(e,t,i){const{audioTrack:r,videoTrack:s,id3Track:o,textTrack:c}=t,{accurateTimeOffset:d,timeOffset:m}=this.currentTransmuxState;ce.log(`[transmuxer.ts]: Flushed fragment ${i.sn}${i.part>-1?" p: "+i.part:""} of level ${i.level}`);const g=this.remuxer.remux(r,s,o,c,m,d,!0,this.id);e.push({remuxResult:g,chunkMeta:i}),i.transmuxing.executeEnd=tc()}resetInitialTimestamp(e){const{demuxer:t,remuxer:i}=this;!t||!i||(t.resetTimeStamp(e),i.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,i,r,s){const{demuxer:o,remuxer:c}=this;!o||!c||(o.resetInitSegment(e,t,i,r),c.resetInitSegment(e,t,i,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,i,r,s){let o;return o=t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,i,r,s):this.transmuxUnencrypted(e,i,r,s),o}transmuxUnencrypted(e,t,i,r){const{audioTrack:s,videoTrack:o,id3Track:c,textTrack:d}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,o,c,d,t,i,!1,this.id),chunkMeta:r}}transmuxSampleAes(e,t,i,r,s){return this.demuxer.demuxSampleAes(e,t,i).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,i,r,!1,this.id),chunkMeta:s}))}configureTransmuxer(e){const{config:t,observer:i,typeSupported:r,vendor:s}=this;let o;for(let v=0,E=$v.length;v<E;v++)if($v[v].demux.probe(e)){o=$v[v];break}if(!o)return new Error("Failed to find demuxer by probing fragment data");const c=this.demuxer,d=this.remuxer,m=o.remux,g=o.demux;(!d||!(d instanceof m))&&(this.remuxer=new m(i,t,r,s)),(!c||!(c instanceof g))&&(this.demuxer=new g(i,t,r),this.probe=g.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Av(this.config)),e}}const Hv=n=>({remuxResult:{},chunkMeta:n});function p_(n){return"then"in n&&n.then instanceof Function}class NA{constructor(e,t,i,r,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=i,this.duration=r,this.defaultInitPts=s||null}}class g_{constructor(e,t,i,r,s,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=i,this.trackSwitch=r,this.timeOffset=s,this.initSegmentChange=o}}var jv={exports:{}};!function(n){var e=Object.prototype.hasOwnProperty,t="~";function i(){}function r(d,m,g){this.fn=d,this.context=m,this.once=g||!1}function s(d,m,g,v,E){if("function"!=typeof g)throw new TypeError("The listener must be a function");var T=new r(g,v||d,E),C=t?t+m:m;return d._events[C]?d._events[C].fn?d._events[C]=[d._events[C],T]:d._events[C].push(T):(d._events[C]=T,d._eventsCount++),d}function o(d,m){0==--d._eventsCount?d._events=new i:delete d._events[m]}function c(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(t=!1)),c.prototype.eventNames=function(){var g,v,m=[];if(0===this._eventsCount)return m;for(v in g=this._events)e.call(g,v)&&m.push(t?v.slice(1):v);return Object.getOwnPropertySymbols?m.concat(Object.getOwnPropertySymbols(g)):m},c.prototype.listeners=function(m){var v=this._events[t?t+m:m];if(!v)return[];if(v.fn)return[v.fn];for(var E=0,T=v.length,C=new Array(T);E<T;E++)C[E]=v[E].fn;return C},c.prototype.listenerCount=function(m){var v=this._events[t?t+m:m];return v?v.fn?1:v.length:0},c.prototype.emit=function(m,g,v,E,T,C){var k=t?t+m:m;if(!this._events[k])return!1;var Y,W,P=this._events[k],G=arguments.length;if(P.fn){switch(P.once&&this.removeListener(m,P.fn,void 0,!0),G){case 1:return P.fn.call(P.context),!0;case 2:return P.fn.call(P.context,g),!0;case 3:return P.fn.call(P.context,g,v),!0;case 4:return P.fn.call(P.context,g,v,E),!0;case 5:return P.fn.call(P.context,g,v,E,T),!0;case 6:return P.fn.call(P.context,g,v,E,T,C),!0}for(W=1,Y=new Array(G-1);W<G;W++)Y[W-1]=arguments[W];P.fn.apply(P.context,Y)}else{var oe,te=P.length;for(W=0;W<te;W++)switch(P[W].once&&this.removeListener(m,P[W].fn,void 0,!0),G){case 1:P[W].fn.call(P[W].context);break;case 2:P[W].fn.call(P[W].context,g);break;case 3:P[W].fn.call(P[W].context,g,v);break;case 4:P[W].fn.call(P[W].context,g,v,E);break;default:if(!Y)for(oe=1,Y=new Array(G-1);oe<G;oe++)Y[oe-1]=arguments[oe];P[W].fn.apply(P[W].context,Y)}}return!0},c.prototype.on=function(m,g,v){return s(this,m,g,v,!1)},c.prototype.once=function(m,g,v){return s(this,m,g,v,!0)},c.prototype.removeListener=function(m,g,v,E){var T=t?t+m:m;if(!this._events[T])return this;if(!g)return o(this,T),this;var C=this._events[T];if(C.fn)C.fn===g&&(!E||C.once)&&(!v||C.context===v)&&o(this,T);else{for(var k=0,P=[],G=C.length;k<G;k++)(C[k].fn!==g||E&&!C[k].once||v&&C[k].context!==v)&&P.push(C[k]);P.length?this._events[T]=1===P.length?P[0]:P:o(this,T)}return this},c.prototype.removeAllListeners=function(m){var g;return m?this._events[g=t?t+m:m]&&o(this,g):(this._events=new i,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,n.exports=c}(jv);var __=U0(jv.exports);const Gv=Ql()||{isTypeSupported:()=>!1};class Zh{constructor(e,t,i,r){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const s=e.config;this.hls=e,this.id=t,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=i,this.onFlush=r;const o=(m,g)=>{(g=g||{}).frag=this.frag,g.id=this.id,m===N.ERROR&&(this.error=g.error),this.hls.trigger(m,g)};this.observer=new __,this.observer.on(N.FRAG_DECRYPTED,o),this.observer.on(N.ERROR,o);const c={mp4:Gv.isTypeSupported("video/mp4"),mpeg:Gv.isTypeSupported("audio/mpeg"),mp3:Gv.isTypeSupported('audio/mp4; codecs="mp3"')},d=navigator.vendor;if(this.useWorker&&typeof Worker<"u"&&(s.workerPath||function rT(){return"function"==typeof __HLS_WORKER_BUNDLE__}()))try{s.workerPath?(ce.log(`loading Web Worker ${s.workerPath} for "${t}"`),this.workerContext=function Rv(n){const e=new self.URL(n,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}(s.workerPath)):(ce.log(`injecting Web Worker for "${t}"`),this.workerContext=function a_(){const n=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(n);return{worker:new self.Worker(e),objectURL:e}}()),this.onwmsg=v=>this.onWorkerMessage(v);const{worker:g}=this.workerContext;g.addEventListener("message",this.onwmsg),g.onerror=v=>{const E=new Error(`${v.message}  (${v.filename}:${v.lineno})`);s.enableWorker=!1,ce.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(N.ERROR,{type:an.OTHER_ERROR,details:Me.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:E})},g.postMessage({cmd:"init",typeSupported:c,vendor:d,id:t,config:JSON.stringify(s)})}catch(g){ce.warn(`Error setting up "${t}" Web Worker, fallback to inline`,g),this.resetWorker(),this.error=null,this.transmuxer=new bT(this.observer,c,s,d,t)}else this.transmuxer=new bT(this.observer,c,s,d,t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,i,r,s,o,c,d,m,g){var v,E;m.transmuxing.start=self.performance.now();const{transmuxer:T}=this,C=o?o.start:s.start,k=s.decryptdata,P=this.frag,G=!(P&&s.cc===P.cc),Y=!(P&&m.level===P.level),W=P?m.sn-P.sn:-1,te=this.part?m.part-this.part.index:-1,Ae=!Y&&(1===W||0===W&&(1===te||0===W&&m.id>1&&m.id===P?.stats.chunkCount&&te<=0)),we=self.performance.now();(Y||W||0===s.stats.parsing.start)&&(s.stats.parsing.start=we),o&&(te||!Ae)&&(o.stats.parsing.start=we);const Ge=!(P&&(null==(v=s.initSegment)?void 0:v.url)===(null==(E=P.initSegment)?void 0:E.url)),rt=new g_(G,Ae,d,Y,C,Ge);if(!Ae||G||Ge){ce.log(`[transmuxer-interface, ${s.type}]: Starting new transmux session for sn: ${m.sn} p: ${m.part} level: ${m.level} id: ${m.id}\n        discontinuity: ${G}\n        trackSwitch: ${Y}\n        contiguous: ${Ae}\n        accurateTimeOffset: ${d}\n        timeOffset: ${C}\n        initSegmentChange: ${Ge}`);const Pe=new NA(i,r,t,c,g);this.configureTransmuxer(Pe)}if(this.frag=s,this.part=o,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:k,chunkMeta:m,state:rt},e instanceof ArrayBuffer?[e]:[]);else if(T){const Pe=T.push(e,k,m,rt);p_(Pe)?(T.async=!0,Pe.then(Xt=>{this.handleTransmuxComplete(Xt)}).catch(Xt=>{this.transmuxerError(Xt,m,"transmuxer-interface push error")})):(T.async=!1,this.handleTransmuxComplete(Pe))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let i=t.flush(e);p_(i)||t.async?(p_(i)||(i=Promise.resolve(i)),i.then(s=>{this.handleFlushResult(s,e)}).catch(s=>{this.transmuxerError(s,e,"transmuxer-interface flush error")})):this.handleFlushResult(i,e)}}transmuxerError(e,t,i){this.hls&&(this.error=e,this.hls.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Me.FRAG_PARSING_ERROR,chunkMeta:t,fatal:!1,error:e,err:e,reason:i}))}handleFlushResult(e,t){e.forEach(i=>{this.handleTransmuxComplete(i)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data,i=this.hls;switch(t.event){case"init":{var r;const s=null==(r=this.workerContext)?void 0:r.objectURL;s&&self.URL.revokeObjectURL(s);break}case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":ce[t.data.logType]&&ce[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,i.trigger(t.event,t.data)}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}class ET{constructor(e,t,i,r){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=i,this.hls=r}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:i,media:r,stalled:s}=this;if(null===r)return;const{currentTime:o,seeking:c}=r,d=this.seeking&&!c,m=!this.seeking&&c;if(this.seeking=c,o!==e){if(this.moved=!0,null!==s){if(this.stallReported){const G=self.performance.now()-s;ce.warn(`playback not stuck anymore @${o}, after ${Math.round(G)}ms`),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if(m||d)return void(this.stalled=null);if(r.paused&&!c||r.ended||0===r.playbackRate||!Un.getBuffered(r).length)return;const g=Un.bufferInfo(r,o,0),E=g.nextStart||0;if(!(g.len>0||E))return;if(c){const G=g.len>2,Y=!E||t&&t.start<=o||E-o>2&&!this.fragmentTracker.getPartialFragment(o);if(G||Y)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var T;const G=Math.max(E,g.start||0)-o,Y=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,te=(null==Y||null==(T=Y.details)?void 0:T.live)?2*Y.details.targetduration:2,oe=this.fragmentTracker.getPartialFragment(o);if(G>0&&(G<=te||oe))return void this._trySkipBufferHole(oe)}const C=self.performance.now();if(null===s)return void(this.stalled=C);const k=C-s;if(!c&&k>=250&&(this._reportStall(g),!this.media))return;const P=Un.bufferInfo(r,o,i.maxBufferHole);this._tryFixBufferStall(P,k)}_tryFixBufferStall(e,t){const{config:i,fragmentTracker:r,media:s}=this;if(null===s)return;const o=s.currentTime,c=r.getPartialFragment(o);c&&(this._trySkipBufferHole(c)||!this.media)||(e.len>i.maxBufferHole||e.nextStart&&e.nextStart-o<i.maxBufferHole)&&t>1e3*i.highBufferWatchdogPeriod&&(ce.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:i,stallReported:r}=this;if(!r&&i){this.stallReported=!0;const s=new Error(`Playback stalling at @${i.currentTime} due to low buffer (${JSON.stringify(e)})`);ce.warn(s.message),t.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Me.BUFFER_STALLED_ERROR,fatal:!1,error:s,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:i,media:r}=this;if(null===r)return 0;const s=r.currentTime,o=Un.bufferInfo(r,s,0),c=s<o.start?o.start:o.nextStart;if(c){const g=c-s;if(g>0&&(o.len<=t.maxBufferHole||o.len>0&&o.len<1&&r.readyState<3)){if(g>t.maxBufferHole){const{fragmentTracker:E}=this;let T=!1;if(0===s){const C=E.getAppendedFrag(0,ln.MAIN);C&&c<C.end&&(T=!0)}if(!T){const C=e||E.getAppendedFrag(s,ln.MAIN);if(C){let k=!1,P=C.end;for(;P<c;){const G=E.getPartialFragment(P);if(!G){k=!0;break}P+=G.duration}if(k)return 0}}}const v=Math.max(c+.05,s+.1);if(ce.warn(`skipping hole, adjusting currentTime from ${s} to ${v}`),this.moved=!0,this.stalled=null,r.currentTime=v,e&&!e.gap){const E=new Error(`fragment loaded with buffer holes, seeking from ${s} to ${v}`);i.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Me.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:E,reason:E.message,frag:e})}return v}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:i,nudgeRetry:r}=this;if(null===i)return;const s=i.currentTime;if(this.nudgeRetry++,r<e.nudgeMaxRetry){const o=s+(r+1)*e.nudgeOffset,c=new Error(`Nudging 'currentTime' from ${s} to ${o}`);ce.warn(c.message),i.currentTime=o,t.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Me.BUFFER_NUDGE_ON_STALL,error:c,fatal:!1})}else{const o=new Error(`Playhead still not moving while enough data buffered @${s} after ${e.nudgeMaxRetry} nudges`);ce.error(o.message),t.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Me.BUFFER_STALLED_ERROR,error:o,fatal:!0})}}}class TT extends Gh{constructor(e,t,i){super(e,t,i,"[stream-controller]",ln.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.MANIFEST_PARSED,this.onManifestParsed,this),e.on(N.LEVEL_LOADING,this.onLevelLoading,this),e.on(N.LEVEL_LOADED,this.onLevelLoaded,this),e.on(N.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(N.ERROR,this.onError,this),e.on(N.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(N.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(N.BUFFER_CREATED,this.onBufferCreated,this),e.on(N.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(N.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(N.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.MANIFEST_PARSED,this.onManifestParsed,this),e.off(N.LEVEL_LOADED,this.onLevelLoaded,this),e.off(N.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(N.ERROR,this.onError,this),e.off(N.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(N.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(N.BUFFER_CREATED,this.onBufferCreated,this),e.off(N.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(N.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(N.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:i}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let r=i.startLevel;-1===r&&(i.config.testBandwidth&&this.levels.length>1?(r=0,this.bitrateTest=!0):r=i.nextAutoLevel),this.level=i.nextLoadLevel=r,this.loadedmetadata=!1}t>0&&-1===e&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state="IDLE",this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state="STOPPED"}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case"WAITING_LEVEL":{var e;const{levels:i,level:r}=this,s=null==i||null==(e=i[r])?void 0:e.details;if(s&&(!s.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(s))break;this.state="IDLE";break}if(this.hls.nextLoadLevel!==this.level){this.state="IDLE";break}break}case"FRAG_LOADING_WAITING_RETRY":{var t;const i=self.performance.now(),r=this.retryDate;(!r||i>=r||null!=(t=this.media)&&t.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state="IDLE")}}"IDLE"===this.state&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:i,media:r}=this,{config:s,nextLoadLevel:o}=e;if(null===t||!r&&(this.startFragRequested||!s.startFragPrefetch)||this.altAudio&&this.audioOnly||null==i||!i[o])return;const c=i[o],d=this.getMainFwdBufferInfo();if(null===d)return;const m=this.getLevelDetails();if(m&&this._streamEnded(d,m)){const P={};return this.altAudio&&(P.type="video"),this.hls.trigger(N.BUFFER_EOS,P),void(this.state="ENDED")}e.loadLevel!==o&&-1===e.manualLevel&&this.log(`Adapting to level ${o} from level ${this.level}`),this.level=e.nextLoadLevel=o;const g=c.details;if(!g||"WAITING_LEVEL"===this.state||g.live&&this.levelLastLoaded!==o)return this.level=o,void(this.state="WAITING_LEVEL");const v=d.len,E=this.getMaxBufferLength(c.maxBitrate);if(v>=E)return;this.backtrackFragment&&this.backtrackFragment.start>d.end&&(this.backtrackFragment=null);const T=this.backtrackFragment?this.backtrackFragment.start:d.end;let C=this.getNextFragment(T,g);if(this.couldBacktrack&&!this.fragPrevious&&C&&"initSegment"!==C.sn&&"OK"!==this.fragmentTracker.getState(C)){var k;const G=(null!=(k=this.backtrackFragment)?k:C).sn-g.startSN,Y=g.fragments[G-1];Y&&C.cc===Y.cc&&(C=Y,this.fragmentTracker.removeFragment(Y))}else this.backtrackFragment&&d.len&&(this.backtrackFragment=null);if(C&&this.isLoopLoading(C,T)){if(!C.gap){const G=this.audioOnly&&!this.altAudio?hi.AUDIO:hi.VIDEO,Y=(G===hi.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;Y&&this.afterBufferFlushed(Y,G,ln.MAIN)}C=this.getNextFragmentLoopLoading(C,g,d,ln.MAIN,E)}C&&(C.initSegment&&!C.initSegment.data&&!this.bitrateTest&&(C=C.initSegment),this.loadFragment(C,c,T))}loadFragment(e,t,i){const r=this.fragmentTracker.getState(e);this.fragCurrent=e,"NOT_LOADED"===r||"PARTIAL"===r?"initSegment"===e.sn?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,i)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,ln.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(null!=t&&t.readyState){let i;const r=this.getAppendedFrag(t.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);const s=this.getLevelDetails();if(null!=s&&s.live){const c=this.getMainFwdBufferInfo();if(!c||c.len<2*s.targetduration)return}if(!t.paused&&e){const m=this.fragLastKbps;i=m&&this.fragCurrent?this.fragCurrent.duration*e[this.hls.nextLoadLevel].maxBitrate/(1e3*m)+1:0}else i=0;const o=this.getBufferedFrag(t.currentTime+i);if(o){const c=this.followingBufferedFrag(o);if(c){this.abortCurrentFrag();const m=c.duration,g=Math.max(o.end,(c.maxStartPTS?c.maxStartPTS:c.start)+Math.min(Math.max(m-this.config.maxFragLookUpTolerance,.5*m),.75*m));this.flushMainBuffer(g,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case"KEY_LOADING":case"FRAG_LOADING":case"FRAG_LOADING_WAITING_RETRY":case"PARSING":case"PARSED":this.state="IDLE"}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const i=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),i.addEventListener("playing",this.onvplaying),i.addEventListener("seeked",this.onvseeked),this.gapController=new ET(this.config,i,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;Jt(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const i=this.getMainFwdBufferInfo();null!==i&&0!==i.len?this.tick():this.warn(`Main forward buffer length on "seeked" event ${i?i.len:"empty"})`)}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(N.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.levels=this.fragPlaying=this.backtrackFragment=null,this.altAudio=this.audioOnly=!1}onManifestParsed(e,t){let s,i=!1,r=!1;t.levels.forEach(o=>{s=o.audioCodec,s&&(-1!==s.indexOf("mp4a.40.2")&&(i=!0),-1!==s.indexOf("mp4a.40.5")&&(r=!0))}),this.audioCodecSwitch=i&&r&&!function iT(){var n;const e=tT();return"function"==typeof(null==e||null==(n=e.prototype)?void 0:n.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:i}=this;if(!i||"IDLE"!==this.state)return;const r=i[t.level];(!r.details||r.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(r.details))&&(this.state="WAITING_LEVEL")}onLevelLoaded(e,t){var i;const{levels:r}=this,s=t.level,o=t.details,c=o.totalduration;if(!r)return void this.warn(`Levels were reset while loading level ${s}`);this.log(`Level ${s} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${c}`);const d=r[s],m=this.fragCurrent;m&&("FRAG_LOADING"===this.state||"FRAG_LOADING_WAITING_RETRY"===this.state)&&(m.level!==t.level||m.urlId!==d.urlId)&&m.loader&&this.abortCurrentFrag();let g=0;if(o.live||null!=(i=d.details)&&i.live){if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;g=this.alignPlaylists(o,d.details)}if(d.details=o,this.levelLastLoaded=s,this.hls.trigger(N.LEVEL_UPDATED,{details:o,level:s}),"WAITING_LEVEL"===this.state){if(this.waitForCdnTuneIn(o))return;this.state="IDLE"}this.startFragRequested?o.live&&this.synchronizeToLiveEdge(o):this.setStartPosition(o,g),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:i,part:r,payload:s}=e,{levels:o}=this;if(!o)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);const c=o[i.level],d=c.details;if(!d)return this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`),void this.fragmentTracker.removeFragment(i);const m=c.videoCodec,g=d.PTSKnown||!d.live,v=null==(t=i.initSegment)?void 0:t.data,E=this._getAudioCodec(c),T=this.transmuxer=this.transmuxer||new Zh(this.hls,ln.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),C=r?r.index:-1,P=new Sv(i.level,i.sn,i.stats.chunkCount,s.byteLength,C,-1!==C);T.push(s,v,E,m,i,r,d.totalduration,g,P,this.initPTS[i.cc])}onAudioTrackSwitching(e,t){const i=this.altAudio;if(!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const s=this.hls;i&&(s.trigger(N.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),s.trigger(N.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const r=!!this.hls.audioTracks[t.id].url;if(r){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=r,this.tick()}onBufferCreated(e,t){const i=t.tracks;let r,s,o=!1;for(const c in i){const d=i[c];if("main"===d.id){if(s=c,r=d,"video"===c){const m=i[c];m&&(this.videoBuffer=m.buffer)}}else o=!0}o&&r?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:i,part:r}=t;if(i&&i.type!==ln.MAIN)return;if(this.fragContextChanged(i))return this.warn(`Fragment ${i.sn}${r?" p: "+r.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),void("PARSED"===this.state&&(this.state="IDLE"));const s=r?r.stats:i.stats;this.fragLastKbps=Math.round(8*s.total/(s.buffering.end-s.loading.first)),"initSegment"!==i.sn&&(this.fragPrevious=i),this.fragBufferedComplete(i,r)}onError(e,t){var i;if(t.fatal)this.state="ERROR";else switch(t.details){case Me.FRAG_GAP:case Me.FRAG_PARSING_ERROR:case Me.FRAG_DECRYPT_ERROR:case Me.FRAG_LOAD_ERROR:case Me.FRAG_LOAD_TIMEOUT:case Me.KEY_LOAD_ERROR:case Me.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ln.MAIN,t);break;case Me.LEVEL_LOAD_ERROR:case Me.LEVEL_LOAD_TIMEOUT:case Me.LEVEL_PARSING_ERROR:!t.levelRetry&&"WAITING_LEVEL"===this.state&&(null==(i=t.context)?void 0:i.type)===Qn.LEVEL&&(this.state="IDLE");break;case Me.BUFFER_FULL_ERROR:if(!t.parent||"main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case Me.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}checkBuffer(){const{media:e,gapController:t}=this;e&&t&&e.readyState&&(!this.loadedmetadata&&Un.getBuffered(e).length||t.poll(this.lastCurrentTime,"IDLE"!==this.state?this.fragCurrent:null),this.lastCurrentTime=e.currentTime)}onFragLoadEmergencyAborted(){this.state="IDLE",this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){(t!==hi.AUDIO||this.audioOnly&&!this.altAudio)&&this.afterBufferFlushed((t===hi.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media,t,ln.MAIN)}onLevelsUpdated(e,t){this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let i=this.startPosition;if(i>=0&&t<i){if(e.seeking)return void this.log(`could not seek to ${i}, already seeking at ${t}`);const r=Un.getBuffered(e),o=(r.length?r.start(0):0)-i;o>0&&(o<this.config.maxBufferHole||o<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${o} to match buffer start`),i+=o,this.startPosition=i),this.log(`seek to target start position ${i} from current time ${t}`),e.currentTime=i}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(i=>{const{hls:r}=this;if(!i||this.fragContextChanged(e))return;t.fragmentError=0,this.state="IDLE",this.startFragRequested=!1,this.bitrateTest=!1;const s=e.stats;s.parsing.start=s.parsing.end=s.buffering.start=s.buffering.end=self.performance.now(),r.trigger(N.FRAG_LOADED,i),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const i="main",{hls:r}=this,{remuxResult:s,chunkMeta:o}=e,c=this.getCurrentContext(o);if(!c)return void this.resetWhenMissingContext(o);const{frag:d,part:m,level:g}=c,{video:v,text:E,id3:T,initSegment:C}=s,{details:k}=g,P=this.altAudio?void 0:s.audio;if(this.fragContextChanged(d))this.fragmentTracker.removeFragment(d);else{if(this.state="PARSING",C){if(null!=C&&C.tracks){const W=d.initSegment||d;this._bufferInitSegment(g,C.tracks,W,o),r.trigger(N.FRAG_PARSING_INIT_SEGMENT,{frag:W,id:i,tracks:C.tracks})}const G=C.initPTS,Y=C.timescale;Jt(G)&&(this.initPTS[d.cc]={baseTime:G,timescale:Y},r.trigger(N.INIT_PTS_FOUND,{frag:d,id:i,initPTS:G,timescale:Y}))}if(v&&k&&"initSegment"!==d.sn){const G=k.fragments[d.sn-1-k.startSN],Y=d.sn===k.startSN,W=!G||d.cc>G.cc;if(!1!==s.independent){const{startPTS:te,endPTS:oe,startDTS:Ae,endDTS:we}=v;if(m)m.elementaryStreams[v.type]={startPTS:te,endPTS:oe,startDTS:Ae,endDTS:we};else if(v.firstKeyFrame&&v.independent&&1===o.id&&!W&&(this.couldBacktrack=!0),v.dropped&&v.independent){const Ge=this.getMainFwdBufferInfo(),rt=(Ge?Ge.end:this.getLoadPosition())+this.config.maxBufferHole;if(!Y&&rt<(v.firstKeyFramePTS?v.firstKeyFramePTS:te)-this.config.maxBufferHole&&!W)return void this.backtrack(d);W&&(d.gap=!0),d.setElementaryStreamInfo(v.type,d.start,oe,d.start,we,!0)}d.setElementaryStreamInfo(v.type,te,oe,Ae,we),this.backtrackFragment&&(this.backtrackFragment=d),this.bufferFragmentData(v,d,m,o,Y||W)}else{if(!Y&&!W)return void this.backtrack(d);d.gap=!0}}if(P){const{startPTS:G,endPTS:Y,startDTS:W,endDTS:te}=P;m&&(m.elementaryStreams[hi.AUDIO]={startPTS:G,endPTS:Y,startDTS:W,endDTS:te}),d.setElementaryStreamInfo(hi.AUDIO,G,Y,W,te),this.bufferFragmentData(P,d,m,o)}k&&null!=T&&null!=(t=T.samples)&&t.length&&r.trigger(N.FRAG_PARSING_METADATA,{id:i,frag:d,details:k,samples:T.samples}),k&&E&&r.trigger(N.FRAG_PARSING_USERDATA,{id:i,frag:d,details:k,samples:E.samples})}}_bufferInitSegment(e,t,i,r){if("PARSING"!==this.state)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:s,video:o,audiovideo:c}=t;if(s){let d=e.audioCodec;const m=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(d&&(d=-1!==d.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==s.metadata.channelCount&&-1===m.indexOf("firefox")&&(d="mp4a.40.5")),-1!==m.indexOf("android")&&"audio/mpeg"!==s.container&&(d="mp4a.40.2",this.log(`Android: force audio codec to ${d}`)),e.audioCodec&&e.audioCodec!==d&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${d}"`),s.levelCodec=d,s.id="main",this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${d||""}/${e.audioCodec||""}/${s.codec}]`)}o&&(o.levelCodec=e.videoCodec,o.id="main",this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${o.codec}]`)),c&&this.log(`Init audiovideo buffer, container:${c.container}, codecs[level/parsed]=[${e.attrs.CODECS||""}/${c.codec}]`),this.hls.trigger(N.BUFFER_CODECS,t),Object.keys(t).forEach(d=>{const g=t[d].initSegment;null!=g&&g.byteLength&&this.hls.trigger(N.BUFFER_APPENDING,{type:d,data:g,frag:i,part:null,chunkMeta:r,parent:i.type})}),this.tick()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,ln.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state="IDLE"}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&!1===e.seeking){const i=e.currentTime;if(Un.isBuffered(e,i)?t=this.getAppendedFrag(i):Un.isBuffered(e,i+.1)&&(t=this.getAppendedFrag(i+.1)),t){this.backtrackFragment=null;const r=this.fragPlaying,s=t.level;(!r||t.sn!==r.sn||r.level!==s||t.urlId!==r.urlId)&&(this.fragPlaying=t,this.hls.trigger(N.FRAG_CHANGED,{frag:t}),(!r||r.level!==s)&&this.hls.trigger(N.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,i=this.currentFrag;if(i&&Jt(t)&&Jt(i.programDateTime))return new Date(i.programDateTime+1e3*(t-i.start))}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class Qh{constructor(e,t=0,i=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=i}sample(e,t){const i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class IT{constructor(e,t,i,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Qh(e),this.fast_=new Qh(t),this.defaultTTFB_=r,this.ttfb_=new Qh(e)}update(e,t){const{slow_:i,fast_:r,ttfb_:s}=this;i.halfLife!==e&&(this.slow_=new Qh(e,i.getEstimate(),i.getTotalWeight())),r.halfLife!==t&&(this.fast_=new Qh(t,r.getEstimate(),r.getTotalWeight())),s.halfLife!==e&&(this.ttfb_=new Qh(e,s.getEstimate(),s.getTotalWeight()))}sample(e,t){const r=(e=Math.max(e,this.minDelayMs_))/1e3,s=8*t/r;this.fast_.sample(r,s),this.slow_.sample(r,s)}sampleTTFB(e){const t=e/1e3,i=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(i,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}class ST{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let i;return e.length?(i=1===e.length?e[0]:function VL(n,e){const t=new Uint8Array(e);let i=0;for(let r=0;r<n.length;r++){const s=n[r];t.set(s,i),i+=s.length}return t}(e,t),this.reset(),i):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}function Wv(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!y_(n[t].attrs,e[t].attrs))return!1;return!0}function y_(n,e){const t=n["STABLE-RENDITION-ID"];return t?t===e["STABLE-RENDITION-ID"]:!["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED"].some(i=>n[i]!==e[i])}class DT{constructor(e){this.buffered=void 0;const t=(i,r,s)=>{if((r>>>=0)>s-1)throw new DOMException(`Failed to execute '${i}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${s})`);return e[r][i]};this.buffered={get length(){return e.length},end:i=>t("end",i,e.length),start:i=>t("start",i,e.length)}}}function Kv(n){const e=[];for(let t=0;t<n.length;t++){const i=n[t];("subtitles"===i.kind||"captions"===i.kind)&&i.label&&e.push(n[t])}return e}class HA{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t){const i=this.queues[t];i.push(e),1===i.length&&this.buffers[t]&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const i=new Promise(s=>{t=s});return this.append({execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}},e),i}executeNext(e){const{buffers:t,queues:i}=this,r=t[e],s=i[e];if(s.length){const o=s[0];try{o.execute()}catch(c){ce.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),o.onError(c),null!=r&&r.updating||(s.shift(),this.executeNext(e))}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const AT=Ql(),RT=/([ha]vc.)(?:\.[^.,]+)+/,kT={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},qv=function(e){let t=e;return kT.hasOwnProperty(e)&&(t=kT[e]),String.fromCharCode(t)},nc=100,hp={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},jA={17:2,18:4,21:6,22:8,23:10,19:13,20:15},MT={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},GA={25:2,26:4,29:6,30:8,31:10,27:13,28:15},LT=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class zA{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const i="function"==typeof t?t():t;ce.log(`${this.time} [${e}] ${i}`)}}}const eu=function(e){const t=[];for(let i=0;i<e.length;i++)t.push(e[i].toString(16));return t};class OT{constructor(e,t,i,r,s){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=i||!1,this.background=r||"black",this.flash=s||!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let i=0;i<t.length;i++){const r=t[i];e.hasOwnProperty(r)&&(this[r]=e[r])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class Yv{constructor(e,t,i,r,s,o){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new OT(t,i,r,s,o)}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class WA{constructor(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(let t=0;t<nc;t++)this.chars.push(new Yv);this.logger=e,this.pos=0,this.currPenState=new OT}equals(e){let t=!0;for(let i=0;i<nc;i++)if(!this.chars[i].equals(e.chars[i])){t=!1;break}return t}copy(e){for(let t=0;t<nc;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<nc;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>nc&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=nc)}moveCursor(e){const t=this.pos+e;if(e>1)for(let i=this.pos+1;i<t+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=qv(e);this.pos>=nc?this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))}clearFromPos(e){let t;for(t=e;t<nc;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let i=0;i<nc;i++){const r=this.chars[i].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class v_{constructor(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(let t=0;t<15;t++)this.rows.push(new WA(e));this.logger=e,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}reset(){for(let e=0;e<15;e++)this.rows[e].clear();this.currRow=14}equals(e){let t=!0;for(let i=0;i<15;i++)if(!this.rows[i].equals(e.rows[i])){t=!1;break}return t}copy(e){for(let t=0;t<15;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let c=0;c<15;c++)this.rows[c].clear();const s=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){const c=o.rows[s].cueStartTime,d=this.logger.time;if(c&&null!==d&&c<d)for(let m=0;m<this.nrRollUpRows;m++)this.rows[t-this.nrRollUpRows+m+1].copy(o.rows[s+m])}}this.currRow=t;const i=this.rows[this.currRow];if(null!==e.indent){const o=Math.max(e.indent-1,0);i.setCursor(e.indent),e.color=i.chars[o].penState.foreground}this.setPen({foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1})}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,()=>this.getDisplayText());const t=this.rows.splice(this.currRow+1-this.nrRollUpRows,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let i="",r=-1;for(let s=0;s<15;s++){const o=this.rows[s].getTextString();o&&(r=s+1,t.push(e?"Row "+r+": '"+o+"'":o.trim()))}return t.length>0&&(i=e?"["+t.join(" | ")+"]":t.join("\n")),i}getTextAndFormat(){return this.rows}}class Zv{constructor(e,t,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new v_(i),this.nonDisplayedMemory=new v_(i),this.lastOutputScreen=new v_(i),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let i=0;i<e.length;i++)this.writeScreen.insertChar(e[i]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),("MODE_PAINT-ON"===this.mode||"MODE_ROLL-UP"===this.mode)&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{const i=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][i]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class PT{constructor(e,t,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;const r=new zA;this.channels=[null,new Zv(e,t,r),new Zv(e+1,i,r)],this.cmdHistory={a:null,b:null},this.logger=r}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){let i,r,s,o=!1;this.logger.time=e;for(let c=0;c<t.length;c+=2)if(r=127&t[c],s=127&t[c+1],0!==r||0!==s){if(this.logger.log(3,"["+eu([t[c],t[c+1]])+"] -> ("+eu([r,s])+")"),i=this.parseCmd(r,s),i||(i=this.parseMidrow(r,s)),i||(i=this.parsePAC(r,s)),i||(i=this.parseBackgroundAttributes(r,s)),!i&&(o=this.parseChars(r,s),o)){const d=this.currentChannel;d&&d>0?this.channels[d].insertChars(o):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!i&&!o&&this.logger.log(2,"Couldn't parse cleaned data "+eu([r,s])+" orig: "+eu([t[c],t[c+1]]))}}parseCmd(e,t){const{cmdHistory:i}=this;if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=33&&t<=35))return!1;if(NT(e,t,i))return Xh(null,null,i),this.logger.log(3,"Repeated command ("+eu([e,t])+") is dropped"),!0;const o=20===e||21===e||23===e?1:2,c=this.channels[o];return 20===e||21===e||28===e||29===e?32===t?c.ccRCL():33===t?c.ccBS():34===t?c.ccAOF():35===t?c.ccAON():36===t?c.ccDER():37===t?c.ccRU(2):38===t?c.ccRU(3):39===t?c.ccRU(4):40===t?c.ccFON():41===t?c.ccRDC():42===t?c.ccTR():43===t?c.ccRTD():44===t?c.ccEDM():45===t?c.ccCR():46===t?c.ccENM():47===t&&c.ccEOC():c.ccTO(t-32),Xh(e,t,i),this.currentChannel=o,!0}parseMidrow(e,t){let i=0;if((17===e||25===e)&&t>=32&&t<=47){if(i=17===e?1:2,i!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const r=this.channels[i];return!!r&&(r.ccMIDROW(t),this.logger.log(3,"MIDROW ("+eu([e,t])+")"),!0)}return!1}parsePAC(e,t){let i;const r=this.cmdHistory;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127||(16===e||24===e)&&t>=64&&t<=95))return!1;if(NT(e,t,r))return Xh(null,null,r),!0;const c=e<=23?1:2;i=t>=64&&t<=95?1===c?hp[e]:MT[e]:1===c?jA[e]:GA[e];const d=this.channels[c];return!!d&&(d.setPAC(this.interpretPAC(i,t)),Xh(e,t,r),this.currentChannel=c,!0)}interpretPAC(e,t){let i;const r={color:null,italics:!1,indent:null,underline:!1,row:e};return i=t>95?t-96:t-64,r.underline=1==(1&i),i<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((i-16)/2),r}parseChars(e,t){let i,r=null,s=null;if(e>=25?(i=2,s=e-8):(i=1,s=e),s>=17&&s<=19){let o;o=17===s?t+80:18===s?t+112:t+144,this.logger.log(2,"Special char '"+qv(o)+"' in channel "+i),r=[o]}else e>=32&&e<=127&&(r=0===t?[e]:[e,t]);if(r){const o=eu(r);this.logger.log(3,"Char codes =  "+o.join(",")),Xh(e,t,this.cmdHistory)}return r}parseBackgroundAttributes(e,t){if(!((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47))return!1;let s;const o={};return 16===e||24===e?(s=Math.floor((t-32)/2),o.background=LT[s],t%2==1&&(o.background=o.background+"_semi")):45===t?o.background="transparent":(o.foreground="black",47===t&&(o.underline=!0)),this.channels[e<=23?1:2].setBkgData(o),Xh(e,t,this.cmdHistory),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}this.cmdHistory={a:null,b:null}}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const i=this.channels[t];i&&i.cueSplitAtTime(e)}}}function Xh(n,e,t){t.a=n,t.b=e}function NT(n,e,t){return t.a===n&&t.b===e}class w_{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,i){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var E_=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;const n=["","lr","rl"],e=["start","middle","end","left","right"];function t(c,d){if("string"!=typeof d||!Array.isArray(c))return!1;const m=d.toLowerCase();return!!~c.indexOf(m)&&m}function r(c){return t(e,c)}function s(c,...d){let m=1;for(;m<arguments.length;m++){const g=arguments[m];for(const v in g)c[v]=g[v]}return c}function o(c,d,m){const g=this,v={enumerable:!0};g.hasBeenReset=!1;let E="",T=!1,C=c,k=d,P=m,G=null,Y="",W=!0,te="auto",oe="start",Ae=50,we="middle",Ge=50,rt="middle";Object.defineProperty(g,"id",s({},v,{get:function(){return E},set:function(Pe){E=""+Pe}})),Object.defineProperty(g,"pauseOnExit",s({},v,{get:function(){return T},set:function(Pe){T=!!Pe}})),Object.defineProperty(g,"startTime",s({},v,{get:function(){return C},set:function(Pe){if("number"!=typeof Pe)throw new TypeError("Start time must be set to a number.");C=Pe,this.hasBeenReset=!0}})),Object.defineProperty(g,"endTime",s({},v,{get:function(){return k},set:function(Pe){if("number"!=typeof Pe)throw new TypeError("End time must be set to a number.");k=Pe,this.hasBeenReset=!0}})),Object.defineProperty(g,"text",s({},v,{get:function(){return P},set:function(Pe){P=""+Pe,this.hasBeenReset=!0}})),Object.defineProperty(g,"region",s({},v,{get:function(){return G},set:function(Pe){G=Pe,this.hasBeenReset=!0}})),Object.defineProperty(g,"vertical",s({},v,{get:function(){return Y},set:function(Pe){const Xt=function i(c){return t(n,c)}(Pe);if(!1===Xt)throw new SyntaxError("An invalid or illegal string was specified.");Y=Xt,this.hasBeenReset=!0}})),Object.defineProperty(g,"snapToLines",s({},v,{get:function(){return W},set:function(Pe){W=!!Pe,this.hasBeenReset=!0}})),Object.defineProperty(g,"line",s({},v,{get:function(){return te},set:function(Pe){if("number"!=typeof Pe&&"auto"!==Pe)throw new SyntaxError("An invalid number or illegal string was specified.");te=Pe,this.hasBeenReset=!0}})),Object.defineProperty(g,"lineAlign",s({},v,{get:function(){return oe},set:function(Pe){const Xt=r(Pe);if(!Xt)throw new SyntaxError("An invalid or illegal string was specified.");oe=Xt,this.hasBeenReset=!0}})),Object.defineProperty(g,"position",s({},v,{get:function(){return Ae},set:function(Pe){if(Pe<0||Pe>100)throw new Error("Position must be between 0 and 100.");Ae=Pe,this.hasBeenReset=!0}})),Object.defineProperty(g,"positionAlign",s({},v,{get:function(){return we},set:function(Pe){const Xt=r(Pe);if(!Xt)throw new SyntaxError("An invalid or illegal string was specified.");we=Xt,this.hasBeenReset=!0}})),Object.defineProperty(g,"size",s({},v,{get:function(){return Ge},set:function(Pe){if(Pe<0||Pe>100)throw new Error("Size must be between 0 and 100.");Ge=Pe,this.hasBeenReset=!0}})),Object.defineProperty(g,"align",s({},v,{get:function(){return rt},set:function(Pe){const Xt=r(Pe);if(!Xt)throw new SyntaxError("An invalid or illegal string was specified.");rt=Xt,this.hasBeenReset=!0}})),g.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o}();class KA{decode(e,t){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function FT(n){function e(i,r,s,o){return 3600*(0|i)+60*(0|r)+(0|s)+parseFloat(o||0)}const t=n.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class qA{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&""!==t&&(this.values[e]=t)}get(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,i){for(let r=0;r<i.length;++r)if(t===i[r]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const i=parseFloat(t);if(i>=0&&i<=100)return this.set(e,i),!0}return!1}}function BT(n,e,t,i){const r=i?n.split(i):[n];for(const s in r){if("string"!=typeof r[s])continue;const o=r[s].split(t);2===o.length&&e(o[0],o[1])}}const Qv=new E_(0,0,""),x_="middle"===Qv.align?"middle":"center";function YA(n,e,t){const i=n;function r(){const c=FT(n);if(null===c)throw new Error("Malformed timestamp: "+i);return n=n.replace(/^[^\sa-zA-Z-]+/,""),c}function o(){n=n.replace(/^\s+/,"")}if(o(),e.startTime=r(),o(),"--\x3e"!==n.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);n=n.slice(3),o(),e.endTime=r(),o(),function s(c,d){const m=new qA;BT(c,function(E,T){let C;switch(E){case"region":for(let k=t.length-1;k>=0;k--)if(t[k].id===T){m.set(E,t[k].region);break}break;case"vertical":m.alt(E,T,["rl","lr"]);break;case"line":C=T.split(","),m.integer(E,C[0]),m.percent(E,C[0])&&m.set("snapToLines",!1),m.alt(E,C[0],["auto"]),2===C.length&&m.alt("lineAlign",C[1],["start",x_,"end"]);break;case"position":C=T.split(","),m.percent(E,C[0]),2===C.length&&m.alt("positionAlign",C[1],["start",x_,"end","line-left","line-right","auto"]);break;case"size":m.percent(E,T);break;case"align":m.alt(E,T,["start",x_,"end","left","right"])}},/:/,/\s/),d.region=m.get("region",null),d.vertical=m.get("vertical","");let g=m.get("line","auto");"auto"===g&&-1===Qv.line&&(g=-1),d.line=g,d.lineAlign=m.get("lineAlign","start"),d.snapToLines=m.get("snapToLines",!0),d.size=m.get("size",100),d.align=m.get("align",x_);let v=m.get("position","auto");"auto"===v&&50===Qv.position&&(v="start"===d.align||"left"===d.align?0:"end"===d.align||"right"===d.align?100:50),d.position=v}(n,e)}function UT(n){return n.replace(/<br(?: \/)?>/gi,"\n")}class VT{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new KA,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;function i(){let s=t.buffer,o=0;for(s=UT(s);o<s.length&&"\r"!==s[o]&&"\n"!==s[o];)++o;const c=s.slice(0,o);return"\r"===s[o]&&++o,"\n"===s[o]&&++o,t.buffer=s.slice(o),c}function r(s){BT(s,function(o,c){},/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{let s="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;s=i();const c=s.match(/^(\xef\xbb\xbf)?WEBVTT([ \t].*)?$/);if(null==c||!c[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let o=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:s=i(),t.state){case"HEADER":/:/.test(s)?r(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new E_(0,0,""),t.state="CUE",-1===s.indexOf("--\x3e")){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{YA(s,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const c=-1!==s.indexOf("--\x3e");if(!s||c&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch{"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const $T=/\r\n|\n\r|\n|\r/g,Xv=function(e,t,i=0){return e.slice(i,i+t.length)===t},ZA=function(e){let t=parseInt(e.slice(-3));const i=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!(Jt(t)&&Jt(i)&&Jt(r)&&Jt(s)))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*i,t+=6e4*r,t+=36e5*s,t},T_=function(e){let t=5381,i=e.length;for(;i;)t=33*t^e.charCodeAt(--i);return(t>>>0).toString()};function Jv(n,e,t){return T_(n.toString())+T_(e.toString())+T_(t)}const QA=function(e,t,i){let r=e[t],s=e[r.prevCC];if(!s||!s.new&&r.new)return e.ccOffset=e.presentationOffset=r.start,void(r.new=!1);for(;null!=(o=s)&&o.new;){var o;e.ccOffset+=r.start-s.start,r.new=!1,r=s,s=e[r.prevCC]}e.presentationOffset=i};const fp="stpp.ttml.im1t",I_=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,eb=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,tb={left:"start",center:"center",right:"end",start:"start",end:"end"};function HT(n,e,t,i){const r=Bn(new Uint8Array(n),["mdat"]);if(0===r.length)return void i(new Error("Could not parse IMSC1 mdat"));const s=r.map(c=>cl(c)),o=function BL(n,e,t=1,i=!1){return f_(n,e,1/t,i)}(e.baseTime,1,e.timescale);try{s.forEach(c=>t(function JA(n,e){const r=(new DOMParser).parseFromString(n,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(s).reduce((v,E)=>(v[E]=r.getAttribute(`ttp:${E}`)||s[E],v),{}),c="preserve"!==r.getAttribute("xml:space"),d=jT(mp(r,"styling","style")),m=jT(mp(r,"layout","region")),g=mp(r,"body","[begin]");return[].map.call(g,v=>{const E=nb(v,c);if(!E||!v.hasAttribute("begin"))return null;const T=zT(v.getAttribute("begin"),o),C=zT(v.getAttribute("dur"),o);let k=zT(v.getAttribute("end"),o);if(null===T)throw GT(v);if(null===k){if(null===C)throw GT(v);k=T+C}const P=new E_(T-e,k-e,E);P.id=Jv(P.startTime,P.endTime,P.text);const W=function Jh(n,e,t){const i="http://www.w3.org/ns/ttml#styling";let r=null;const o=null!=n&&n.hasAttribute("style")?n.getAttribute("style"):null;return o&&t.hasOwnProperty(o)&&(r=t[o]),["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce((c,d)=>{const m=S_(e,i,d)||S_(n,i,d)||S_(r,i,d);return m&&(c[d]=m),c},{})}(m[v.getAttribute("region")],d[v.getAttribute("style")],d),{textAlign:te}=W;if(te){const oe=tb[te];oe&&(P.lineAlign=oe),P.align=te}return vr(P,W),P}).filter(v=>null!==v)}(c,o)))}catch(c){i(c)}}function mp(n,e,t){const i=n.getElementsByTagName(e)[0];return i?[].slice.call(i.querySelectorAll(t)):[]}function jT(n){return n.reduce((e,t)=>{const i=t.getAttribute("xml:id");return i&&(e[i]=t),e},{})}function nb(n,e){return[].slice.call(n.childNodes).reduce((t,i,r)=>{var s;return"br"===i.nodeName&&r?t+"\n":null!=(s=i.childNodes)&&s.length?nb(i,e):e?t+i.textContent.trim().replace(/\s+/g," "):t+i.textContent},"")}function S_(n,e,t){return n&&n.hasAttributeNS(e,t)?n.getAttributeNS(e,t):null}function GT(n){return new Error(`Could not parse ttml timestamp ${n}`)}function zT(n,e){if(!n)return null;let t=FT(n);return null===t&&(I_.test(n)?t=function WT(n,e){const t=I_.exec(n);return 3600*(0|t[1])+60*(0|t[2])+(0|t[3])+((0|t[4])+(0|t[5])/e.subFrameRate)/e.frameRate}(n,e):eb.test(n)&&(t=function ib(n,e){const t=eb.exec(n),i=Number(t[1]);switch(t[2]){case"h":return 3600*i;case"m":return 60*i;case"ms":return 1e3*i;case"f":return i/e.frameRate;case"t":return i/e.tickRate}return i}(n,e))),t}function rb(n,e){return!!n&&n.label===e.name&&!(n.textTrack1||n.textTrack2)}function tR(n,e,t,i){return Math.min(e,i)-Math.max(n,t)}class pp{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(N.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(N.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(N.MANIFEST_PARSED,this.onManifestParsed,this),e.on(N.BUFFER_CODECS,this.onBufferCodecs,this),e.on(N.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(N.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(N.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(N.MANIFEST_PARSED,this.onManifestParsed,this),e.off(N.BUFFER_CODECS,this.onBufferCodecs,this),e.off(N.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const i=this.hls.levels[t.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null}onManifestParsed(e,t){const i=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,i.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){const e=this.hls.levels;if(e.length){const t=this.hls;t.autoLevelCapping=this.getMaxLevel(e.length-1),t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const i=t.filter((r,s)=>this.isLevelAllowed(r)&&s<=e);return this.clientRect=null,pp.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const i=e.getBoundingClientRect();t.width=i.width,t.height=i.height,!t.width&&!t.height&&(t.width=i.right-i.left||e.width||0,t.height=i.bottom-i.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return e}isLevelAllowed(e){return!this.restrictedLevels.some(i=>e.bitrate===i.bitrate&&e.width===i.width&&e.height===i.height)}static getMaxLevelByMediaSize(e,t,i){if(null==e||!e.length)return-1;const r=(o,c)=>!c||o.width!==c.width||o.height!==c.height;let s=e.length-1;for(let o=0;o<e.length;o+=1){const c=e[o];if((c.width>=t||c.height>=i)&&r(c,e[o+1])){s=o;break}}return s}}const gp="[eme]";let qT=(()=>{class n{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=n.CDMCleanupPromise?[n.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=ce.debug.bind(ce,gp),this.log=ce.log.bind(ce,gp),this.warn=ce.warn.bind(ce,gp),this.error=ce.error.bind(ce,gp),this.hls=t,this.config=t.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const t=this.config;t.requestMediaKeySystemAccessFunc=null,t.licenseXhrSetup=t.licenseResponseCallback=void 0,t.drmSystems=t.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(N.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(N.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(N.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(N.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(N.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(N.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(N.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(N.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(t){const{drmSystems:i,widevineLicenseUrl:r}=this.config,s=i[t];if(s)return s.licenseUrl;if(t===Ai.WIDEVINE&&r)return r;throw new Error(`no license server URL configured for key-system "${t}"`)}getServerCertificateUrl(t){const{drmSystems:i}=this.config,r=i[t];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${t}"]`)}attemptKeySystemAccess(t){const i=this.hls.levels,r=(c,d,m)=>!!c&&m.indexOf(c)===d,s=i.map(c=>c.audioCodec).filter(r),o=i.map(c=>c.videoCodec).filter(r);return s.length+o.length===0&&o.push("avc1.42e01e"),new Promise((c,d)=>{const m=g=>{const v=g.shift();this.getMediaKeysPromise(v,s,o).then(E=>c({keySystem:v,mediaKeys:E})).catch(E=>{g.length?m(g):d(E instanceof Io?E:new Io({type:an.KEY_SYSTEM_ERROR,details:Me.KEY_SYSTEM_NO_ACCESS,error:E,fatal:!0},E.message))})};m(t)})}requestMediaKeySystemAccess(t,i){const{requestMediaKeySystemAccessFunc:r}=this.config;if("function"!=typeof r){let s=`Configured requestMediaKeySystemAccess is not a function ${r}`;return null===zm&&"http:"===self.location.protocol&&(s=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(s))}return r(t,i)}getMediaKeysPromise(t,i,r){const s=function zg(n,e,t,i){let r;switch(n){case Ai.FAIRPLAY:r=["cenc","sinf"];break;case Ai.WIDEVINE:case Ai.PLAYREADY:r=["cenc"];break;case Ai.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${n}`)}return function Wg(n,e,t,i){return[{initDataTypes:n,persistentState:i.persistentState||"not-allowed",distinctiveIdentifier:i.distinctiveIdentifier||"not-allowed",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:e.map(s=>({contentType:`audio/mp4; codecs="${s}"`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null})),videoCapabilities:t.map(s=>({contentType:`video/mp4; codecs="${s}"`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}))}]}(r,e,t,i)}(t,i,r,this.config.drmSystemOptions),o=this.keySystemAccessPromises[t];let c=o?.keySystemAccess;if(!c){this.log(`Requesting encrypted media "${t}" key-system access with config: ${JSON.stringify(s)}`),c=this.requestMediaKeySystemAccess(t,s);const d=this.keySystemAccessPromises[t]={keySystemAccess:c};return c.catch(m=>{this.log(`Failed to obtain access to key-system "${t}": ${m}`)}),c.then(m=>{this.log(`Access for key-system "${m.keySystem}" obtained`);const g=this.fetchServerCertificate(t);return this.log(`Create media-keys for "${t}"`),d.mediaKeys=m.createMediaKeys().then(v=>(this.log(`Media-keys created for "${t}"`),g.then(E=>E?this.setMediaKeysServerCertificate(v,t,E):v))),d.mediaKeys.catch(v=>{this.error(`Failed to create media-keys for "${t}"}: ${v}`)}),d.mediaKeys})}return c.then(()=>o.mediaKeys)}createMediaKeySessionContext({decryptdata:t,keySystem:i,mediaKeys:r}){this.log(`Creating key-system session "${i}" keyId: ${ul_hexDump(t.keyId||[])}`);const s=r.createSession(),o={decryptdata:t,keySystem:i,mediaKeys:r,mediaKeysSession:s,keyStatus:"status-pending"};return this.mediaKeySessions.push(o),o}renewKeySession(t){const i=t.decryptdata;if(i.pssh){const r=this.createMediaKeySessionContext(t),s=this.getKeyIdString(i);this.keyIdToKeySessionPromise[s]=this.generateRequestWithPreferredKeySession(r,"cenc",i.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(t)}getKeyIdString(t){if(!t)throw new Error("Could not read keyId of undefined decryptdata");if(null===t.keyId)throw new Error("keyId is null");return ul_hexDump(t.keyId)}updateKeySession(t,i){var r;const s=t.mediaKeysSession;return this.log(`Updating key-session "${s.sessionId}" for keyID ${ul_hexDump((null==(r=t.decryptdata)?void 0:r.keyId)||[])}\n      } (data length: ${i&&i.byteLength})`),s.update(i)}selectKeySystemFormat(t){const i=Object.keys(t.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${t.sn} ${t.type}: ${t.level}) key formats ${i.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(i)),this.keyFormatPromise}getKeyFormatPromise(t){return new Promise((i,r)=>{const s=Z0(this.config),o=t.map(bx).filter(c=>!!c&&-1!==s.indexOf(c));return this.getKeySystemSelectionPromise(o).then(({keySystem:c})=>{const d=Ex(c);d?i(d):r(new Error(`Unable to find format for key-system "${c}"`))}).catch(r)})}loadKey(t){const i=t.keyInfo.decryptdata,r=this.getKeyIdString(i),s=`(keyId: ${r} format: "${i.keyFormat}" method: ${i.method} uri: ${i.uri})`;this.log(`Starting session for key ${s}`);let o=this.keyIdToKeySessionPromise[r];return o||(o=this.keyIdToKeySessionPromise[r]=this.getKeySystemForKeyPromise(i).then(({keySystem:c,mediaKeys:d})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${t.frag.sn} ${t.frag.type}: ${t.frag.level} using key ${s}`),this.attemptSetMediaKeys(c,d).then(()=>{this.throwIfDestroyed();const m=this.createMediaKeySessionContext({keySystem:c,mediaKeys:d,decryptdata:i});return this.generateRequestWithPreferredKeySession(m,"cenc",i.pssh,"playlist-key")}))),o.catch(c=>this.handleError(c))),o}throwIfDestroyed(t="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(t){this.hls&&(this.error(t.message),this.hls.trigger(N.ERROR,t instanceof Io?t.data:{type:an.KEY_SYSTEM_ERROR,details:Me.KEY_SYSTEM_NO_KEYS,error:t,fatal:!0}))}getKeySystemForKeyPromise(t){const i=this.getKeyIdString(t),r=this.keyIdToKeySessionPromise[i];if(!r){const s=bx(t.keyFormat),o=s?[s]:Z0(this.config);return this.attemptKeySystemAccess(o)}return r}getKeySystemSelectionPromise(t){if(t.length||(t=Z0(this.config)),0===t.length)throw new Io({type:an.KEY_SYSTEM_ERROR,details:Me.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(t)}_onMediaEncrypted(t){const{initDataType:i,initData:r}=t;if(this.debug(`"${t.type}" event: init data type: "${i}"`),null===r)return;let s,o;if("sinf"===i&&this.config.drmSystems[Ai.FAIRPLAY]){const v=qr(new Uint8Array(r));try{const E=K0(JSON.parse(v).sinf),T=kx(new Uint8Array(E));if(!T)return;s=T.subarray(8,24),o=Ai.FAIRPLAY}catch{return void this.warn('Failed to parse sinf "encrypted" event message initData')}}else{const v=function dA(n){if(!(n instanceof ArrayBuffer)||n.byteLength<32)return null;const e={version:0,systemId:"",kids:null,data:null},t=new DataView(n),i=t.getUint32(0);if(n.byteLength!==i&&i>44||1886614376!==t.getUint32(4)||(e.version=t.getUint32(8)>>>24,e.version>1))return null;e.systemId=ul_hexDump(new Uint8Array(n,12,16));const s=t.getUint32(28);if(0===e.version){if(i-32<s)return null;e.data=new Uint8Array(n,32,s)}else if(1===e.version){e.kids=[];for(let o=0;o<s;o++)e.kids.push(new Uint8Array(n,32+16*o,16))}return e}(r);if(null===v)return;0===v.version&&v.systemId===wx_WIDEVINE&&v.data&&(s=v.data.subarray(8,24)),o=function Y0(n){if(n===wx_WIDEVINE)return Ai.WIDEVINE}(v.systemId)}if(!o||!s)return;const c=ul_hexDump(s),{keyIdToKeySessionPromise:d,mediaKeySessions:m}=this;let g=d[c];for(let v=0;v<m.length;v++){const E=m[v],T=E.decryptdata;if(T.pssh||!T.keyId)continue;const C=ul_hexDump(T.keyId);if(c===C||-1!==T.uri.replace(/-/g,"").indexOf(c)){g=d[C],delete d[C],T.pssh=new Uint8Array(r),T.keyId=s,g=d[c]=g.then(()=>this.generateRequestWithPreferredKeySession(E,i,r,"encrypted-event-key-match"));break}}g||(g=d[c]=this.getKeySystemSelectionPromise([o]).then(({keySystem:v,mediaKeys:E})=>{var T;this.throwIfDestroyed();const C=new Xm("ISO-23001-7",c,null!=(T=Ex(v))?T:"");return C.pssh=new Uint8Array(r),C.keyId=s,this.attemptSetMediaKeys(v,E).then(()=>{this.throwIfDestroyed();const k=this.createMediaKeySessionContext({decryptdata:C,keySystem:v,mediaKeys:E});return this.generateRequestWithPreferredKeySession(k,i,r,"encrypted-event-no-match")})})),g.catch(v=>this.handleError(v))}_onWaitingForKey(t){this.log(`"${t.type}" event`)}attemptSetMediaKeys(t,i){const r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${t}"`);const s=Promise.all(r).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(i)});return this.setMediaKeysQueue.push(s),s.then(()=>{this.log(`Media-keys set for "${t}"`),r.push(s),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(o=>-1===r.indexOf(o))})}generateRequestWithPreferredKeySession(t,i,r,s){var o,c;const d=null==(o=this.config.drmSystems)||null==(c=o[t.keySystem])?void 0:c.generateRequest;if(d)try{const T=d.call(this.hls,i,r,t);if(!T)throw new Error("Invalid response from configured generateRequest filter");i=T.initDataType,r=t.decryptdata.pssh=T.initData?new Uint8Array(T.initData):null}catch(T){var m;if(this.warn(T.message),null!=(m=this.hls)&&m.config.debug)throw T}if(null===r)return this.log(`Skipping key-session request for "${s}" (no initData)`),Promise.resolve(t);const g=this.getKeyIdString(t.decryptdata);this.log(`Generating key-session request for "${s}": ${g} (init data type: ${i} length: ${r?r.byteLength:null})`);const v=new __;t.mediaKeysSession.onmessage=T=>{const C=t.mediaKeysSession;if(!C)return void v.emit("error",new Error("invalid state"));const{messageType:k,message:P}=T;this.log(`"${k}" message event for session "${C.sessionId}" message size: ${P.byteLength}`),"license-request"===k||"license-renewal"===k?this.renewLicense(t,P).catch(G=>{this.handleError(G),v.emit("error",G)}):"license-release"===k?t.keySystem===Ai.FAIRPLAY&&(this.updateKeySession(t,vx("acknowledged")),this.removeSession(t)):this.warn(`unhandled media key message type "${k}"`)},t.mediaKeysSession.onkeystatuseschange=T=>{if(!t.mediaKeysSession)return void v.emit("error",new Error("invalid state"));this.onKeyStatusChange(t);const k=t.keyStatus;v.emit("keyStatus",k),"expired"===k&&(this.warn(`${t.keySystem} expired for key ${g}`),this.renewKeySession(t))};const E=new Promise((T,C)=>{v.on("error",C),v.on("keyStatus",k=>{k.startsWith("usable")?T():"output-restricted"===k?C(new Io({type:an.KEY_SYSTEM_ERROR,details:Me.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===k?C(new Io({type:an.KEY_SYSTEM_ERROR,details:Me.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${k}"`)):"expired"===k?C(new Error("key expired while generating request")):this.warn(`unhandled key status change "${k}"`)})});return t.mediaKeysSession.generateRequest(i,r).then(()=>{var T;this.log(`Request generated for key-session "${null==(T=t.mediaKeysSession)?void 0:T.sessionId}" keyId: ${g}`)}).catch(T=>{throw new Io({type:an.KEY_SYSTEM_ERROR,details:Me.KEY_SYSTEM_NO_SESSION,error:T,fatal:!1},`Error generating key-session request: ${T}`)}).then(()=>E).catch(T=>{throw v.removeAllListeners(),this.removeSession(t),T}).then(()=>(v.removeAllListeners(),t))}onKeyStatusChange(t){t.mediaKeysSession.keyStatuses.forEach((i,r)=>{this.log(`key status change "${i}" for keyStatuses keyId: ${ul_hexDump("buffer"in r?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r))} session keyId: ${ul_hexDump(new Uint8Array(t.decryptdata.keyId||[]))} uri: ${t.decryptdata.uri}`),t.keyStatus=i})}fetchServerCertificate(t){const i=this.config,s=new(0,i.loader)(i),o=this.getServerCertificateUrl(t);return o?(this.log(`Fetching serverCertificate for "${t}"`),new Promise((c,d)=>{const m={responseType:"arraybuffer",url:o},g=i.certLoadPolicy.default;s.load(m,{loadPolicy:g,timeout:g.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},{onSuccess:(T,C,k,P)=>{c(T.data)},onError:(T,C,k,P)=>{d(new Io({type:an.KEY_SYSTEM_ERROR,details:Me.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:k,response:hs({url:m.url,data:void 0},T)},`"${t}" certificate request failed (${o}). Status: ${T.code} (${T.text})`))},onTimeout:(T,C,k)=>{d(new Io({type:an.KEY_SYSTEM_ERROR,details:Me.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:k,response:{url:m.url,data:void 0}},`"${t}" certificate request timed out (${o})`))},onAbort:(T,C,k)=>{d(new Error("aborted"))}})})):Promise.resolve()}setMediaKeysServerCertificate(t,i,r){return new Promise((s,o)=>{t.setServerCertificate(r).then(c=>{this.log(`setServerCertificate ${c?"success":"not supported by CDM"} (${r?.byteLength}) on "${i}"`),s(t)}).catch(c=>{o(new Io({type:an.KEY_SYSTEM_ERROR,details:Me.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:c,fatal:!0},c.message))})})}renewLicense(t,i){return this.requestLicense(t,new Uint8Array(i)).then(r=>this.updateKeySession(t,new Uint8Array(r)).catch(s=>{throw new Io({type:an.KEY_SYSTEM_ERROR,details:Me.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:s,fatal:!0},s.message)}))}setupLicenseXHR(t,i,r,s){const o=this.config.licenseXhrSetup;return o?Promise.resolve().then(()=>{if(!r.decryptdata)throw new Error("Key removed");return o.call(this.hls,t,i,r,s)}).catch(c=>{if(!r.decryptdata)throw c;return t.open("POST",i,!0),o.call(this.hls,t,i,r,s)}).then(c=>(t.readyState||t.open("POST",i,!0),{xhr:t,licenseChallenge:c||s})):(t.open("POST",i,!0),Promise.resolve({xhr:t,licenseChallenge:s}))}requestLicense(t,i){const r=this.config.keyLoadPolicy.default;return new Promise((s,o)=>{const c=this.getLicenseServerUrl(t.keySystem);this.log(`Sending license request to URL: ${c}`);const d=new XMLHttpRequest;d.responseType="arraybuffer",d.onreadystatechange=()=>{if(!this.hls||!t.mediaKeysSession)return o(new Error("invalid state"));if(4===d.readyState)if(200===d.status){this._requestLicenseFailureCount=0;let m=d.response;this.log(`License received ${m instanceof ArrayBuffer?m.byteLength:m}`);const g=this.config.licenseResponseCallback;if(g)try{m=g.call(this.hls,d,c,t)}catch(v){this.error(v)}s(m)}else{const m=r.errorRetry,g=m?m.maxNumRetry:0;this._requestLicenseFailureCount++,this._requestLicenseFailureCount>g||d.status>=400&&d.status<500?o(new Io({type:an.KEY_SYSTEM_ERROR,details:Me.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:d,response:{url:c,data:void 0,code:d.status,text:d.statusText}},`License Request XHR failed (${c}). Status: ${d.status} (${d.statusText})`)):(this.warn(`Retrying license request, ${g-this._requestLicenseFailureCount+1} attempts left`),this.requestLicense(t,i).then(s,o))}},t.licenseXhr&&t.licenseXhr.readyState!==XMLHttpRequest.DONE&&t.licenseXhr.abort(),t.licenseXhr=d,this.setupLicenseXHR(d,c,t,i).then(({xhr:m,licenseChallenge:g})=>{m.send(g)})})}onMediaAttached(t,i){if(!this.config.emeEnabled)return;const r=i.media;this.media=r,r.addEventListener("encrypted",this.onMediaEncrypted),r.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const t=this.media,i=this.mediaKeySessions;t&&(t.removeEventListener("encrypted",this.onMediaEncrypted),t.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},Xm.clearKeyUriToKeyIdMap();const r=i.length;n.CDMCleanupPromise=Promise.all(i.map(s=>this.removeSession(s)).concat(t?.setMediaKeys(null).catch(s=>{this.log(`Could not clear media keys: ${s}. media.src: ${t?.src}`)}))).then(()=>{r&&(this.log("finished closing key sessions and clearing media keys"),i.length=0)}).catch(s=>{this.log(`Could not close sessions and clear media keys: ${s}. media.src: ${t?.src}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(t,{sessionKeys:i}){if(i&&this.config.emeEnabled&&!this.keyFormatPromise){const r=i.reduce((s,o)=>(-1===s.indexOf(o.keyFormat)&&s.push(o.keyFormat),s),[]);this.log(`Selecting key-system from session-keys ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)}}removeSession(t){const{mediaKeysSession:i,licenseXhr:r}=t;if(i){this.log(`Remove licenses and keys and close session ${i.sessionId}`),i.onmessage=null,i.onkeystatuseschange=null,r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),t.mediaKeysSession=t.decryptdata=t.licenseXhr=void 0;const s=this.mediaKeySessions.indexOf(t);return s>-1&&this.mediaKeySessions.splice(s,1),i.remove().catch(o=>{this.log(`Could not remove session: ${o}`)}).then(()=>i.close()).catch(o=>{this.log(`Could not close session: ${o}`)})}}}return n.CDMCleanupPromise=void 0,n})();class Io extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}class tu{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=r=>{try{this.apply(r,{ot:"m",su:!this.initialized})}catch(s){ce.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=r=>{try{const s=r.frag,o=this.hls.levels[s.level],c=this.getObjectType(s),d={d:1e3*s.duration,ot:c};("v"===c||"a"===c||"av"==c)&&(d.br=o.bitrate/1e3,d.tb=this.getTopBandwidth(c)/1e3,d.bl=this.getBufferLength(c)),this.apply(r,d)}catch(s){ce.warn("Could not generate segment CMCD data.",s)}},this.hls=e;const t=this.config=e.config,{cmcd:i}=t;null!=i&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||tu.uuid(),this.cid=i.contentId,this.useHeaders=!0===i.useHeaders,this.registerListeners())}registerListeners(){const e=this.hls;e.on(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(N.MEDIA_DETACHED,this.onMediaDetached,this),e.on(N.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(N.MEDIA_DETACHED,this.onMediaDetached,this),e.off(N.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var i,r;this.audioBuffer=null==(i=t.tracks.audio)?void 0:i.buffer,this.videoBuffer=null==(r=t.tracks.video)?void 0:r.buffer}createData(){var e;return{v:1,sf:"h",sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){if(vr(t,this.createData()),this.starved&&("i"===t.ot||"v"===t.ot||"av"===t.ot)&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering),this.useHeaders){const r=tu.toHeaders(t);if(!Object.keys(r).length)return;e.headers||(e.headers={}),vr(e.headers,r)}else{const r=tu.toQuery(t);if(!r)return;e.url=tu.appendQueryToUri(e.url,r)}}getObjectType(e){const{type:t}=e;return"subtitle"===t?"tt":"initSegment"===e.sn?"i":"audio"===t?"a":"main"===t?this.hls.audioTracks.length?"v":"av":void 0}getTopBandwidth(e){let i,t=0;const r=this.hls;if("a"===e)i=r.audioTracks;else{const s=r.maxAutoLevel;i=r.levels.slice(0,s>-1?s+1:r.levels.length)}for(const s of i)s.bitrate>t&&(t=s.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.hls.media,i="a"===e?this.audioBuffer:this.videoBuffer;return i&&t?1e3*Un.bufferInfo(i,t.currentTime,this.config.maxBufferHole).len:NaN}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,i=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new i(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,c){t(s),this.loader.load(s,o,c)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,i=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new i(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,c){t(s),this.loader.load(s,o,c)}}}static uuid(){const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}static serialize(e){const t=[],i=m=>!Number.isNaN(m)&&null!=m&&""!==m&&!1!==m,r=m=>Math.round(m),s=m=>100*r(m/100),c={br:r,d:r,bl:s,dl:s,mtp:s,nor:m=>encodeURIComponent(m),rtp:s,tb:r},d=Object.keys(e||{}).sort();for(const m of d){let g=e[m];if(!i(g)||"v"===m&&1===g||"pr"==m&&1===g)continue;const v=c[m];v&&(g=v(g));const E=typeof g;let T;T="ot"===m||"sf"===m||"st"===m?`${m}=${g}`:"boolean"===E?m:"number"===E?`${m}=${g}`:`${m}=${JSON.stringify(g)}`,t.push(T)}return t.join(",")}static toHeaders(e){const t=Object.keys(e),i={},r=["Object","Request","Session","Status"],s=[{},{},{},{}],o={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};for(const c of t)s[null!=o[c]?o[c]:1][c]=e[c];for(let c=0;c<s.length;c++){const d=tu.serialize(s[c]);d&&(i[`CMCD-${r[c]}`]=d)}return i}static toQuery(e){return`CMCD=${encodeURIComponent(tu.serialize(e))}`}static appendQueryToUri(e,t){if(!t)return e;const i=e.includes("?")?"&":"?";return`${e}${i}${t}`}}function ob(n,e,t,i){n&&Object.keys(e).forEach(r=>{const s=n.filter(o=>o.groupId===r).map(o=>{const c=vr({},o);return c.details=void 0,c.attrs=new Ui(c.attrs),c.url=c.attrs.URI=ZT(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),c.groupId=c.attrs["GROUP-ID"]=e[r],c.attrs["PATHWAY-ID"]=i,c});n.push(...s)})}function ZT(n,e,t,i){const{HOST:r,PARAMS:s,[t]:o}=i;let c;e&&(c=o?.[e],c&&(n=c));const d=new self.URL(n);return r&&!c&&(d.host=r),s&&Object.keys(s).sort().forEach(m=>{m&&d.searchParams.set(m,s[m])}),d.href}const rR=/^age:\s*[\d.]+\s*$/im;class sR{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new jg,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=i,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e)return;const i=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;const s=this.xhrSetup;s?Promise.resolve().then(()=>{if(!this.stats.aborted)return s(i,t.url)}).catch(o=>(i.open("GET",t.url,!0),s(i,t.url))).then(()=>{this.stats.aborted||this.openAndSendXhr(i,t,e)}).catch(o=>{this.callbacks.onError({code:i.status,text:o.message},t,i,r)}):this.openAndSendXhr(i,t,e)}openAndSendXhr(e,t,i){e.readyState||e.open("GET",t.url,!0);const r=this.context.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:o}=i.loadPolicy;if(r)for(const c in r)e.setRequestHeader(c,r[c]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),i.timeout=s&&Jt(s)?s:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:i}=this;if(!e||!t)return;const r=t.readyState,s=this.config;if(!i.aborted&&r>=2&&(0===i.loading.first&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),4===r)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const o=t.status,c="text"!==t.responseType;if(o>=200&&o<300&&(c&&t.response||null!==t.responseText)){i.loading.end=Math.max(self.performance.now(),i.loading.first);const d=c?t.response:t.responseText;if(i.loaded=i.total="arraybuffer"===t.responseType?d.byteLength:d.length,i.bwEstimate=8e3*i.total/(i.loading.end-i.loading.first),!this.callbacks)return;const g=this.callbacks.onProgress;if(g&&g(i,e,d,t),!this.callbacks)return;this.callbacks.onSuccess({url:t.responseURL,data:d,code:o},i,e,t)}else{const d=s.loadPolicy.errorRetry;t_(d,i.retry,!1,o)?this.retry(d):(ce.error(`${o} while loading ${e.url}`),this.callbacks.onError({code:o,text:t.statusText},e,t,i))}}}loadtimeout(){var e;const t=null==(e=this.config)?void 0:e.loadPolicy.timeoutRetry;if(t_(t,this.stats.retry,!0))this.retry(t);else{ce.warn(`timeout while loading ${this.context.url}`);const r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:i}=this;this.retryDelay=jh(e,i.retry),i.retry++,ce.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t.url}, retrying ${i.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&rR.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const aR=/(\d+)-(\d+)\/(\d+)/;class ab{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||dR,this.controller=new self.AbortController,this.stats=new jg}destroy(){this.loader=this.callbacks=null,this.abortInternal()}abortInternal(){const e=this.response;null!=e&&e.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,i){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const s=function lR(n,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(vr({},n.headers))};return n.rangeEnd&&t.headers.set("Range","bytes="+n.rangeStart+"-"+String(n.rangeEnd-1)),t}(e,this.controller.signal),o=i.onProgress,c="arraybuffer"===e.responseType,d=c?"byteLength":"length",{maxTimeToFirstByteMs:m,maxLoadTimeMs:g}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=i,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=m&&Jt(m)?m:g,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),i.onTimeout(r,e,this.response)},t.timeout),self.fetch(this.request).then(v=>{this.response=this.loader=v;const E=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=g,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),i.onTimeout(r,e,this.response)},g-(E-r.loading.start)),!v.ok){const{status:T,statusText:C}=v;throw new hR(C||"fetch, bad network response",T,v)}return r.loading.first=E,r.total=function uR(n){const e=n.get("Content-Range");if(e){const i=function cR(n){const e=aR.exec(n);if(e)return parseInt(e[2])-parseInt(e[1])+1}(e);if(Jt(i))return i}const t=n.get("Content-Length");if(t)return parseInt(t)}(v.headers)||r.total,o&&Jt(t.highWaterMark)?this.loadProgressively(v,r,e,t.highWaterMark,o):c?v.arrayBuffer():"json"===e.responseType?v.json():v.text()}).then(v=>{const{response:E}=this;self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const T=v[d];T&&(r.loaded=r.total=T);const C={url:E.url,data:v,code:E.status};o&&!Jt(t.highWaterMark)&&o(r,e,v,E),i.onSuccess(C,r,e,E)}).catch(v=>{self.clearTimeout(this.requestTimeout),r.aborted||i.onError({code:v&&v.code||0,text:v?v.message:null},e,v?v.details:null,r)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,i,r=0,s){const o=new ST,c=e.body.getReader(),d=()=>c.read().then(m=>{if(m.done)return o.dataLength&&s(t,i,o.flush(),e),Promise.resolve(new ArrayBuffer(0));const g=m.value,v=g.length;return t.loaded+=v,v<r||o.dataLength?(o.push(g),o.dataLength>=r&&s(t,i,o.flush(),e)):s(t,i,g,e),d()}).catch(()=>Promise.reject());return d()}}function dR(n,e){return new self.Request(n.url,e)}class hR extends Error{constructor(e,t,i){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=i}}const fR=/\s/,mR={newCue(n,e,t,i){const r=[];let s,o,c,d,m;const g=self.VTTCue||self.TextTrackCue;for(let E=0;E<i.rows.length;E++)if(s=i.rows[E],c=!0,d=0,m="",!s.isEmpty()){var v;for(let k=0;k<s.chars.length;k++)fR.test(s.chars[k].uchar)&&c?d++:(m+=s.chars[k].uchar,c=!1);s.cueStartTime=e,e===t&&(t+=1e-4),d>=16?d--:d++;const T=UT(m.trim()),C=Jv(e,t,T);null!=n&&null!=(v=n.cues)&&v.getCueById(C)||(o=new g(e,t,T),o.id=C,o.line=E+1,o.align="left",o.position=10+Math.min(80,10*Math.floor(8*d/32)),r.push(o))}return n&&r.length&&(r.sort((E,T)=>"auto"===E.line||"auto"===T.line?0:E.line>8&&T.line>8?T.line-E.line:E.line-T.line),r.forEach(E=>Bx(n,E))),r}},gR=hs(hs({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:sR,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class UA{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=e;const t=e.config;this.bwEstimator=new IT(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(N.FRAG_LOADING,this.onFragLoading,this),e.on(N.FRAG_LOADED,this.onFragLoaded,this),e.on(N.FRAG_BUFFERED,this.onFragBuffered,this),e.on(N.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(N.LEVEL_LOADED,this.onLevelLoaded,this)}unregisterListeners(){const{hls:e}=this;e.off(N.FRAG_LOADING,this.onFragLoading,this),e.off(N.FRAG_LOADED,this.onFragLoaded,this),e.off(N.FRAG_BUFFERED,this.onFragBuffered,this),e.off(N.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(N.LEVEL_LOADED,this.onLevelLoaded,this)}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null}onFragLoading(e,t){var i;const r=t.frag;this.ignoreFragment(r)||(this.fragCurrent=r,this.partCurrent=null!=(i=t.part)?i:null,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))}onLevelSwitching(e,t){this.clearTimer()}getTimeToLoadFrag(e,t,i,r){return e+i/t+(r?this.lastLevelLoadSec:0)}onLevelLoaded(e,t){const i=this.hls.config,{total:r,bwEstimate:s}=t.stats;Jt(r)&&Jt(s)&&(this.lastLevelLoadSec=8*r/s),t.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD)}_abandonRulesCheck(){const{fragCurrent:e,partCurrent:t,hls:i}=this,{autoLevelEnabled:r,media:s}=i;if(!e||!s)return;const o=performance.now(),c=t?t.stats:e.stats,d=t?t.duration:e.duration,m=o-c.loading.start;if(c.aborted||c.loaded&&c.loaded===c.total||0===e.level)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!r||s.paused||!s.playbackRate||!s.readyState)return;const g=i.mainForwardBufferInfo;if(null===g)return;const v=this.bwEstimator.getEstimateTTFB(),E=Math.abs(s.playbackRate);if(m<=Math.max(v,d/(2*E)*1e3))return;const T=g.len/E;if(T>=2*d/E)return;const C=c.loading.first?c.loading.first-c.loading.start:-1,k=c.loaded&&C>-1,P=this.bwEstimator.getEstimate(),{levels:G,minAutoLevel:Y}=i,te=c.total||Math.max(c.loaded,Math.round(d*G[e.level].maxBitrate/8));let oe=m-C;oe<1&&k&&(oe=Math.min(m,8*c.loaded/P));const Ae=k?1e3*c.loaded/oe:0,we=Ae?(te-c.loaded)/Ae:8*te/P+v/1e3;if(we<=T)return;const Ge=Ae?8*Ae:P;let Pe,rt=Number.POSITIVE_INFINITY;for(Pe=e.level-1;Pe>Y&&(rt=this.getTimeToLoadFrag(v/1e3,Ge,d*G[Pe].maxBitrate,!G[Pe].details),!(rt<T));Pe--);rt>=we||rt>10*d||(i.nextLoadLevel=Pe,k?this.bwEstimator.sample(m-Math.min(v,C),c.loaded):this.bwEstimator.sampleTTFB(m),this.clearTimer(),ce.warn(`[abr] Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} is loading too slowly;\n      Time to underbuffer: ${T.toFixed(3)} s\n      Estimated load time for current fragment: ${we.toFixed(3)} s\n      Estimated load time for down switch fragment: ${rt.toFixed(3)} s\n      TTFB estimate: ${C}\n      Current BW estimate: ${Jt(P)?(P/1024).toFixed(3):"Unknown"} Kb/s\n      New BW estimate: ${(this.bwEstimator.getEstimate()/1024).toFixed(3)} Kb/s\n      Aborting and switching to level ${Pe}`),e.loader&&(this.fragCurrent=this.partCurrent=null,e.abortRequests()),i.trigger(N.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:c}))}onFragLoaded(e,{frag:t,part:i}){const r=i?i.stats:t.stats;if(t.type===ln.MAIN&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){const o=this.hls.levels[t.level],c=(o.loaded?o.loaded.bytes:0)+r.loaded,d=(o.loaded?o.loaded.duration:0)+(i?i.duration:t.duration);o.loaded={bytes:c,duration:d},o.realBitrate=Math.round(8*c/d)}t.bitrateTest&&(this.onFragBuffered(N.FRAG_BUFFERED,{stats:r,frag:t,part:i,id:t.type}),t.bitrateTest=!1)}}onFragBuffered(e,t){const{frag:i,part:r}=t,s=null!=r&&r.stats.loaded?r.stats:i.stats;if(s.aborted||this.ignoreFragment(i))return;const o=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,s.loaded),s.bwEstimate=this.bwEstimator.getEstimate(),this.bitrateTestDelay=i.bitrateTest?o/1e3:0}ignoreFragment(e){return e.type!==ln.MAIN||"initSegment"===e.sn}clearTimer(){self.clearInterval(this.timer)}get nextAutoLevel(){const e=this._nextAutoLevel;if(-1!==e&&!this.bwEstimator.canEstimate())return e;let i=this.getNextABRAutoLevel();if(-1!==e){const r=this.hls.levels;if(r.length>Math.max(e,i)&&r[e].loadError<=r[i].loadError)return e}return-1!==e&&(i=Math.min(e,i)),i}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:i}=this,{maxAutoLevel:r,config:s,minAutoLevel:o,media:c}=i,d=t?t.duration:e?e.duration:0,m=c&&0!==c.playbackRate?Math.abs(c.playbackRate):1,g=this.bwEstimator?this.bwEstimator.getEstimate():s.abrEwmaDefaultEstimate,v=i.mainForwardBufferInfo,E=(v?v.len:0)/m;let T=this.findBestLevel(g,o,r,E,s.abrBandWidthFactor,s.abrBandWidthUpFactor);if(T>=0)return T;ce.trace(`[abr] ${E?"rebuffering expected":"buffer is empty"}, finding optimal quality level`);let C=d?Math.min(d,s.maxStarvationDelay):s.maxStarvationDelay,k=s.abrBandWidthFactor,P=s.abrBandWidthUpFactor;if(!E){const G=this.bitrateTestDelay;G&&(C=(d?Math.min(d,s.maxLoadingDelay):s.maxLoadingDelay)-G,ce.trace(`[abr] bitrate test took ${Math.round(1e3*G)}ms, set first fragment max fetchDuration to ${Math.round(1e3*C)} ms`),k=P=1)}return T=this.findBestLevel(g,o,r,E+C,k,P),Math.max(T,0)}findBestLevel(e,t,i,r,s,o){var c;const{fragCurrent:d,partCurrent:m,lastLoadedFragLevel:g}=this,{levels:v}=this.hls,E=v[g],T=!(null==E||null==(c=E.details)||!c.live),C=E?.codecSet,k=m?m.duration:d?d.duration:0,P=this.bwEstimator.getEstimateTTFB()/1e3;let G=t,Y=-1;for(let W=i;W>=t;W--){const te=v[W];if(!te||C&&te.codecSet!==C){te&&(G=Math.min(W,G),Y=Math.max(W,Y));continue}-1!==Y&&ce.trace(`[abr] Skipped level(s) ${G}-${Y} with CODECS:"${v[Y].attrs.CODECS}"; not compatible with "${E.attrs.CODECS}"`);const oe=te.details,Ae=(m?oe?.partTarget:oe?.averagetargetduration)||k;let we;we=W<=g?s*e:o*e;const Ge=v[W].maxBitrate,rt=this.getTimeToLoadFrag(P,we,Ge*Ae,void 0===oe);if(ce.trace(`[abr] level:${W} adjustedbw-bitrate:${Math.round(we-Ge)} avgDuration:${Ae.toFixed(1)} maxFetchDuration:${r.toFixed(1)} fetchDuration:${rt.toFixed(1)}`),we>Ge&&(0===rt||!Jt(rt)||T&&!this.bitrateTestDelay||rt<r))return W}return-1}set nextAutoLevel(e){this._nextAutoLevel=e}},bufferController:class jL{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=()=>{const{media:t,mediaSource:i}=this;ce.log("[buffer-controller]: Media source opened"),t&&(t.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(N.MEDIA_ATTACHED,{media:t})),i&&i.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{ce.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=()=>{ce.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=()=>{const{media:t,_objectUrl:i}=this;t&&t.src!==i&&ce.error(`Media element src was set while attaching MediaSource (${i} > ${t.src})`)},this.hls=e,this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null}registerListeners(){const{hls:e}=this;e.on(N.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.MANIFEST_PARSED,this.onManifestParsed,this),e.on(N.BUFFER_RESET,this.onBufferReset,this),e.on(N.BUFFER_APPENDING,this.onBufferAppending,this),e.on(N.BUFFER_CODECS,this.onBufferCodecs,this),e.on(N.BUFFER_EOS,this.onBufferEos,this),e.on(N.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(N.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(N.FRAG_PARSED,this.onFragParsed,this),e.on(N.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(N.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.MANIFEST_PARSED,this.onManifestParsed,this),e.off(N.BUFFER_RESET,this.onBufferReset,this),e.off(N.BUFFER_APPENDING,this.onBufferAppending,this),e.off(N.BUFFER_CODECS,this.onBufferCodecs,this),e.off(N.BUFFER_EOS,this.onBufferEos,this),e.off(N.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(N.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(N.FRAG_PARSED,this.onFragParsed,this),e.off(N.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new HA(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let i=2;(t.audio&&!t.video||!t.altAudio)&&(i=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=i,ce.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const i=this.media=t.media;if(i&&AT){const r=this.mediaSource=new AT;r.addEventListener("sourceopen",this._onMediaSourceOpen),r.addEventListener("sourceended",this._onMediaSourceEnded),r.addEventListener("sourceclose",this._onMediaSourceClose),i.src=self.URL.createObjectURL(r),this._objectUrl=i.src,i.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:i}=this;if(t){if(ce.log("[buffer-controller]: media source detaching"),"open"===t.readyState)try{t.endOfStream()}catch(r){ce.warn(`[buffer-controller]: onMediaDetaching: ${r.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),e&&(e.removeEventListener("emptied",this._onMediaEmptied),i&&self.URL.revokeObjectURL(i),e.src===i?(e.removeAttribute("src"),e.load()):ce.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(N.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{const t=this.sourceBuffer[e];try{t&&(this.removeBufferListeners(e),this.mediaSource&&this.mediaSource.removeSourceBuffer(t),this.sourceBuffer[e]=void 0)}catch(i){ce.warn(`[buffer-controller]: Failed to reset the ${e} buffer`,i)}}),this._initSourceBuffer()}onBufferCodecs(e,t){const i=this.getSourceBufferTypes().length;Object.keys(t).forEach(r=>{if(i){const s=this.tracks[r];if(s&&"function"==typeof s.buffer.changeType){const{id:o,codec:c,levelCodec:d,container:m,metadata:g}=t[r],v=(s.levelCodec||s.codec).replace(RT,"$1"),E=(d||c).replace(RT,"$1");v!==E&&(this.appendChangeType(r,`${m};codecs=${d||c}`),ce.log(`[buffer-controller]: switching codec ${v} to ${E}`),this.tracks[r]={buffer:s.buffer,codec:c,container:m,levelCodec:d,metadata:g,id:o})}}else this.pendingTracks[r]=t[r]}),!i&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())}appendChangeType(e,t){const{operationQueue:i}=this,r={execute:()=>{const s=this.sourceBuffer[e];s&&(ce.log(`[buffer-controller]: changing ${e} sourceBuffer type to ${t}`),s.changeType(t)),i.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:s=>{ce.warn(`[buffer-controller]: Failed to change ${e} SourceBuffer type`,s)}};i.append(r,e)}onBufferAppending(e,t){const{hls:i,operationQueue:r,tracks:s}=this,{data:o,type:c,frag:d,part:m,chunkMeta:g}=t,v=g.buffering[c],E=self.performance.now();v.start=E;const T=d.stats.buffering,C=m?m.stats.buffering:null;0===T.start&&(T.start=E),C&&0===C.start&&(C.start=E);let P=!1;"audio"===c&&"audio/mpeg"===s.audio?.container&&(P=!this.lastMpegAudioChunk||1===g.id||this.lastMpegAudioChunk.sn!==g.sn,this.lastMpegAudioChunk=g);const G=d.start;r.append({execute:()=>{if(v.executeStart=self.performance.now(),P){const W=this.sourceBuffer[c];if(W){const te=G-W.timestampOffset;Math.abs(te)>=.1&&(ce.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${G} (delta: ${te}) sn: ${d.sn})`),W.timestampOffset=G)}}this.appendExecutor(o,c)},onStart:()=>{},onComplete:()=>{const W=self.performance.now();v.executeEnd=v.end=W,0===T.first&&(T.first=W),C&&0===C.first&&(C.first=W);const{sourceBuffer:te}=this,oe={};for(const Ae in te)oe[Ae]=Un.getBuffered(te[Ae]);this.appendError=0,this.hls.trigger(N.BUFFER_APPENDED,{type:c,frag:d,part:m,chunkMeta:g,parent:d.type,timeRanges:oe})},onError:W=>{ce.error(`[buffer-controller]: Error encountered while trying to append to the ${c} SourceBuffer`,W);const te={type:an.MEDIA_ERROR,parent:d.type,details:Me.BUFFER_APPEND_ERROR,frag:d,part:m,chunkMeta:g,error:W,err:W,fatal:!1};W.code===DOMException.QUOTA_EXCEEDED_ERR?te.details=Me.BUFFER_FULL_ERROR:(this.appendError++,te.details=Me.BUFFER_APPEND_ERROR,this.appendError>i.config.appendErrorMaxRetry&&(ce.error(`[buffer-controller]: Failed ${i.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),te.fatal=!0)),i.trigger(N.ERROR,te)}},c)}onBufferFlushing(e,t){const{operationQueue:i}=this,r=s=>({execute:this.removeExecutor.bind(this,s,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(N.BUFFER_FLUSHED,{type:s})},onError:o=>{ce.warn(`[buffer-controller]: Failed to remove from ${s} SourceBuffer`,o)}});t.type?i.append(r(t.type),t.type):this.getSourceBufferTypes().forEach(s=>{i.append(r(s),s)})}onFragParsed(e,t){const{frag:i,part:r}=t,s=[],o=r?r.elementaryStreams:i.elementaryStreams;o[hi.AUDIOVIDEO]?s.push("audiovideo"):(o[hi.AUDIO]&&s.push("audio"),o[hi.VIDEO]&&s.push("video")),0===s.length&&ce.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers(()=>{const d=self.performance.now();i.stats.buffering.end=d,r&&(r.stats.buffering.end=d),this.hls.trigger(N.FRAG_BUFFERED,{frag:i,part:r,stats:r?r.stats:i.stats,id:i.type})},s)}onFragChanged(e,t){this.flushBackBuffer()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((r,s)=>{const o=this.sourceBuffer[s];return o&&(!t.type||t.type===s)&&(o.ending=!0,o.ended||(o.ended=!0,ce.log(`[buffer-controller]: ${s} sourceBuffer now EOS`))),r&&!(o&&!o.ended)},!0)&&(ce.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(s=>{const o=this.sourceBuffer[s];o&&(o.ending=!1)});const{mediaSource:r}=this;r&&"open"===r.readyState?(ce.log("[buffer-controller]: Calling mediaSource.endOfStream()"),r.endOfStream()):r&&ce.info(`[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: ${r.readyState}`)}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}flushBackBuffer(){const{hls:e,details:t,media:i,sourceBuffer:r}=this;if(!i||null===t)return;const s=this.getSourceBufferTypes();if(!s.length)return;const o=t.live&&null!==e.config.liveBackBufferLength?e.config.liveBackBufferLength:e.config.backBufferLength;if(!Jt(o)||o<0)return;const c=i.currentTime,d=t.levelTargetDuration,m=Math.max(o,d),g=Math.floor(c/d)*d-m;s.forEach(v=>{const E=r[v];if(E){const T=Un.getBuffered(E);if(T.length>0&&g>T.start(0)){if(e.trigger(N.BACK_BUFFER_REACHED,{bufferEnd:g}),t.live)e.trigger(N.LIVE_BACK_BUFFER_REACHED,{bufferEnd:g});else if(E.ended&&T.end(T.length-1)-c<2*d)return void ce.info(`[buffer-controller]: Cannot flush ${v} back buffer while SourceBuffer is in ended state`);e.trigger(N.BUFFER_FLUSHING,{startOffset:0,endOffset:g,type:v})}}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||"open"!==this.mediaSource.readyState)return;const{details:e,hls:t,media:i,mediaSource:r}=this,s=e.fragments[0].start+e.totalduration,o=i.duration,c=Jt(r.duration)?r.duration:0;e.live&&t.config.liveDurationInfinity?(ce.log("[buffer-controller]: Media Source duration is set to Infinity"),r.duration=1/0,this.updateSeekableRange(e)):(s>c&&s>o||!Jt(o))&&(ce.log(`[buffer-controller]: Updating Media Source duration to ${s.toFixed(3)}`),r.duration=s)}updateSeekableRange(e){const t=this.mediaSource,i=e.fragments;if(i.length&&e.live&&null!=t&&t.setLiveSeekableRange){const s=Math.max(0,i[0].start),o=Math.max(s,s+e.totalduration);t.setLiveSeekableRange(s,o)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:i}=this,r=Object.keys(i).length;if(r&&!e||2===r){this.createSourceBuffers(i),this.pendingTracks={};const s=this.getSourceBufferTypes();if(s.length)this.hls.trigger(N.BUFFER_CREATED,{tracks:this.tracks}),s.forEach(o=>{t.executeNext(o)});else{const o=new Error("could not create source buffer for media codec(s)");this.hls.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Me.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:o,reason:o.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:i}=this;if(!i)throw Error("createSourceBuffers called when mediaSource was null");for(const r in e)if(!t[r]){const s=e[r];if(!s)throw Error(`source buffer exists for track ${r}, however track does not`);const o=s.levelCodec||s.codec,c=`${s.container};codecs=${o}`;ce.log(`[buffer-controller]: creating sourceBuffer(${c})`);try{const d=t[r]=i.addSourceBuffer(c),m=r;this.addBufferListener(m,"updatestart",this._onSBUpdateStart),this.addBufferListener(m,"updateend",this._onSBUpdateEnd),this.addBufferListener(m,"error",this._onSBUpdateError),this.tracks[r]={buffer:d,codec:o,container:s.container,levelCodec:s.levelCodec,metadata:s.metadata,id:s.id}}catch(d){ce.error(`[buffer-controller]: error while trying to add sourceBuffer: ${d.message}`),this.hls.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Me.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:d,mimeType:c})}}}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){const{operationQueue:t}=this;t.current(e).onComplete(),t.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){const i=new Error(`${e} SourceBuffer error`);ce.error(`[buffer-controller]: ${i}`,t),this.hls.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Me.BUFFER_APPENDING_ERROR,error:i,fatal:!1});const r=this.operationQueue.current(e);r&&r.onError(t)}removeExecutor(e,t,i){const{media:r,mediaSource:s,operationQueue:o,sourceBuffer:c}=this,d=c[e];if(!r||!s||!d)return ce.warn(`[buffer-controller]: Attempting to remove from the ${e} SourceBuffer, but it does not exist`),void o.shiftAndExecuteNext(e);const m=Jt(r.duration)?r.duration:1/0,g=Jt(s.duration)?s.duration:1/0,v=Math.max(0,t),E=Math.min(i,m,g);E>v&&!d.ending?(d.ended=!1,ce.log(`[buffer-controller]: Removing [${v},${E}] from the ${e} SourceBuffer`),d.remove(v,E)):o.shiftAndExecuteNext(e)}appendExecutor(e,t){const{operationQueue:i,sourceBuffer:r}=this,s=r[t];if(!s)return ce.warn(`[buffer-controller]: Attempting to append to the ${t} SourceBuffer, but it does not exist`),void i.shiftAndExecuteNext(t);s.ended=!1,s.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length)return ce.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(e);const{operationQueue:i}=this,r=t.map(s=>i.appendBlocker(s));Promise.all(r).then(()=>{e(),t.forEach(s=>{const o=this.sourceBuffer[s];null!=o&&o.updating||i.shiftAndExecuteNext(s)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,i){const r=this.sourceBuffer[e];if(!r)return;const s=i.bind(this,e);this.listeners[e].push({event:t,listener:s}),r.addEventListener(t,s)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach(i=>{t.removeEventListener(i.event,i.listener)})}},capLevelController:pp,errorController:class qx{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=ce.log.bind(ce,"[info]:"),this.warn=ce.warn.bind(ce,"[warning]:"),this.error=ce.error.bind(ce,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(N.ERROR,this.onError,this),e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(N.ERROR,this.onError,this),e.off(N.ERROR,this.onErrorOut,this),e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){this.playlistError=0}stopLoad(){}getVariantLevelIndex(e){return e?.type===ln.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var i,r;if(t.fatal)return;const s=this.hls,o=t.context;switch(t.details){case Me.FRAG_LOAD_ERROR:case Me.FRAG_LOAD_TIMEOUT:case Me.KEY_LOAD_ERROR:case Me.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case Me.FRAG_PARSING_ERROR:if(null!=(i=t.frag)&&i.gap)return void(t.errorAction={action:0,flags:0});case Me.FRAG_GAP:case Me.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=2);case Me.LEVEL_EMPTY_ERROR:case Me.LEVEL_PARSING_ERROR:{var c,d;const m=t.parent===ln.MAIN?t.level:s.loadLevel;t.details===Me.LEVEL_EMPTY_ERROR&&null!=(c=t.context)&&null!=(d=c.levelDetails)&&d.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,m):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,m))}return;case Me.LEVEL_LOAD_ERROR:case Me.LEVEL_LOAD_TIMEOUT:return void("number"==typeof o?.level&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o.level)));case Me.AUDIO_TRACK_LOAD_ERROR:case Me.AUDIO_TRACK_LOAD_TIMEOUT:case Me.SUBTITLE_LOAD_ERROR:case Me.SUBTITLE_TRACK_LOAD_TIMEOUT:if(o){const m=s.levels[s.loadLevel];if(m&&(o.type===Qn.AUDIO_TRACK&&o.groupId===m.audioGroupId||o.type===Qn.SUBTITLE_TRACK&&o.groupId===m.textGroupId))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.loadLevel),t.errorAction.action=2,void(t.errorAction.flags=1)}return;case Me.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const g=s.levels[s.loadLevel]?.attrs["HDCP-LEVEL"];g&&(t.errorAction={action:2,flags:2,hdcpLevel:g})}return;case Me.BUFFER_ADD_CODEC_ERROR:case Me.REMUX_ALLOC_ERROR:return void(t.errorAction=this.getLevelSwitchAction(t,null!=(r=t.level)?r:s.loadLevel));case Me.INTERNAL_EXCEPTION:case Me.BUFFER_APPENDING_ERROR:case Me.BUFFER_APPEND_ERROR:case Me.BUFFER_FULL_ERROR:case Me.LEVEL_SWITCH_ERROR:case Me.BUFFER_STALLED_ERROR:case Me.BUFFER_SEEK_OVER_HOLE:case Me.BUFFER_NUDGE_ON_STALL:return void(t.errorAction={action:0,flags:0})}if(t.type===an.KEY_SYSTEM_ERROR){const m=this.getVariantLevelIndex(t.frag);return t.levelRetry=!1,void(t.errorAction=this.getLevelSwitchAction(t,m))}}getPlaylistRetryOrSwitchAction(e,t){var i;const s=vv(this.hls.config.playlistLoadPolicy,e),o=this.playlistError++,c=null==(i=e.response)?void 0:i.code;if(t_(s,o,ip(e),c))return{action:5,flags:0,retryConfig:s,retryCount:o};const m=this.getLevelSwitchAction(e,t);return s&&(m.retryConfig=s,m.retryCount=o),m}getFragRetryOrSwitchAction(e){const t=this.hls,i=this.getVariantLevelIndex(e.frag),r=t.levels[i],{fragLoadPolicy:s,keyLoadPolicy:o}=t.config,c=vv(e.details.startsWith("key")?o:s,e),d=t.levels.reduce((v,E)=>v+E.fragmentError,0);if(r){var m;e.details!==Me.FRAG_GAP&&r.fragmentError++;const v=null==(m=e.response)?void 0:m.code;if(t_(c,d,ip(e),v))return{action:5,flags:0,retryConfig:c,retryCount:d}}const g=this.getLevelSwitchAction(e,i);return c&&(g.retryConfig=c,g.retryCount=d),g}getLevelSwitchAction(e,t){const i=this.hls;null==t&&(t=i.loadLevel);const r=this.hls.levels[t];if(r&&(r.loadError++,i.autoLevelEnabled)){var s,o;let c=-1;const{levels:d,loadLevel:m,minAutoLevel:g,maxAutoLevel:v}=i,E=null==(s=e.frag)?void 0:s.type,{type:T,groupId:C}=null!=(o=e.context)?o:{};for(let k=d.length;k--;){const P=(k+m)%d.length;if(P!==m&&P>=g&&P<=v&&0===d[P].loadError){const G=d[P];if(e.details===Me.FRAG_GAP&&e.frag){const Y=d[P].details;if(Y){const W=ad(e.frag,Y.fragments,e.frag.start);if(null!=W&&W.gap)continue}}else{if(T===Qn.AUDIO_TRACK&&C===G.audioGroupId||T===Qn.SUBTITLE_TRACK&&C===G.textGroupId)continue;if(E===ln.AUDIO&&r.audioGroupId===G.audioGroupId||E===ln.SUBTITLE&&r.textGroupId===G.textGroupId)continue}c=P;break}}if(c>-1&&i.loadLevel!==c)return e.levelRetry=!0,this.playlistError=0,{action:2,flags:0,nextAutoLevel:c}}return{action:2,flags:1}}onErrorOut(e,t){var i;switch(null==(i=t.errorAction)?void 0:i.action){case 0:break;case 2:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==Me.FRAG_GAP&&(t.fatal=!0)}t.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(e){const t=this.hls,i=e.errorAction;if(!i)return;const{flags:r,hdcpLevel:s,nextAutoLevel:o}=i;switch(r){case 0:this.switchLevel(e,o);break;case 1:i.resolved||(i.resolved=this.redundantFailover(e));break;case 2:s&&(t.maxHdcpLevel=tp[tp.indexOf(s)-1],i.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`)}i.resolved||this.switchLevel(e,o)}switchLevel(e,t){void 0!==t&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}redundantFailover(e){const{hls:t,penalizedRenditions:i}=this,r=e.parent===ln.MAIN?e.level:t.loadLevel,s=t.levels[r],o=s.url.length,c=e.frag?e.frag.urlId:s.urlId;s.urlId===c&&(!e.frag||s.details)&&this.penalizeRendition(s,e);for(let d=1;d<o;d++){const m=(c+d)%o,g=i[m];if(!g||mA(g,e,i[c]))return this.warn(`Switching to Redundant Stream ${m+1}/${o}: "${s.url[m]}" after ${e.details}`),this.playlistError=0,t.levels.forEach(v=>{v.urlId=m}),t.nextLoadLevel=r,!0}return!1}penalizeRendition(e,t){const{penalizedRenditions:i}=this,r=i[e.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};r.lastErrorPerfMs=performance.now(),r.errors.push(t),r.details=e.details,i[e.urlId]=r}},fpsController:class KT{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(N.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(N.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const i=this.hls.config;if(i.capLevelOnFPSDrop){const r=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=r,r&&"function"==typeof r.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,i){const r=performance.now();if(t){if(this.lastTime){const o=i-this.lastDroppedFrames,c=t-this.lastDecodedFrames,d=1e3*o/(r-this.lastTime),m=this.hls;if(m.trigger(N.FPS_DROP,{currentDropped:o,currentDecoded:c,totalDroppedFrames:i}),d>0&&o>m.config.fpsDroppedMonitoringThreshold*c){let g=m.currentLevel;ce.warn("drop FPS ratio greater than max allowed value for currentLevel: "+g),g>0&&(-1===m.autoLevelCapping||m.autoLevelCapping>=g)&&(g-=1,m.trigger(N.FPS_DROP_LEVEL_CAPPING,{level:g,droppedLevel:m.currentLevel}),m.autoLevelCapping=g,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=i,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:zm,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},function _p(){return{cueHandler:mR,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}()),{},{subtitleStreamController:class $A extends Gh{constructor(e,t,i){super(e,t,i,"[subtitle-stream-controller]",ln.SUBTITLE),this.levels=[],this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.LEVEL_LOADED,this.onLevelLoaded,this),e.on(N.ERROR,this.onError,this),e.on(N.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(N.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(N.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(N.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(N.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(N.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.LEVEL_LOADED,this.onLevelLoaded,this),e.off(N.ERROR,this.onError,this),e.off(N.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(N.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(N.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(N.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(N.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(N.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state="IDLE",this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:i,success:r}=t;if(this.fragPrevious=i,this.state="IDLE",!r)return;const s=this.tracksBuffered[this.currentTrackId];if(!s)return;let o;const c=i.start;for(let m=0;m<s.length;m++)if(c>=s[m].start&&c<=s[m].end){o=s[m];break}const d=i.start+i.duration;o?o.end=d:(o={start:c,end:d},s.push(o)),this.fragmentTracker.fragBuffered(i)}onBufferFlushing(e,t){const{startOffset:i,endOffset:r}=t;if(0===i&&r!==Number.POSITIVE_INFINITY){const s=r-1;if(s<=0)return;t.endOffsetSubtitles=Math.max(0,s),this.tracksBuffered.forEach(o=>{for(let c=0;c<o.length;)if(o[c].end<=s)o.shift();else{if(!(o[c].start<s))break;o[c].start=s,c++}}),this.fragmentTracker.removeFragmentsInRange(i,s,ln.SUBTITLE)}}onFragBuffered(e,t){var i;this.loadedmetadata||t.frag.type!==ln.MAIN||null!=(i=this.media)&&i.buffered.length&&(this.loadedmetadata=!0)}onError(e,t){t.frag?.type===ln.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),"STOPPED"!==this.state&&(this.state="IDLE"))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){Wv(this.levels,t)?this.levels=t.map(i=>new Hh(i)):(this.tracksBuffered=[],this.levels=t.map(i=>{const r=new Hh(i);return this.tracksBuffered[r.id]=[],r}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,ln.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(e,t){if(this.currentTrackId=t.id,!this.levels.length||-1===this.currentTrackId)return void this.clearInterval();const i=this.levels[this.currentTrackId];this.mediaBuffer=null!=i&&i.details?this.mediaBufferTimeRanges:null,i&&this.setInterval(500)}onSubtitleTrackLoaded(e,t){var i;const{details:r,id:s}=t,{currentTrackId:o,levels:c}=this;if(!c.length)return;const d=c[o];if(s>=c.length||s!==o||!d)return;this.mediaBuffer=this.mediaBufferTimeRanges;let m=0;if(r.live||null!=(i=d.details)&&i.live){const g=this.mainDetails;if(r.deltaUpdateFailed||!g)return;const v=g.fragments[0];d.details?(m=this.alignPlaylists(r,d.details),0===m&&v&&(m=v.start,e_(r,m))):r.hasProgramDateTime&&g.hasProgramDateTime?(Xx(r,g),m=r.fragments[0].start):v&&(m=v.start,e_(r,m))}d.details=r,this.levelLastLoaded=s,!this.startFragRequested&&(this.mainDetails||!r.live)&&this.setStartPosition(d.details,m),this.tick(),r.live&&!this.fragCurrent&&this.media&&"IDLE"===this.state&&(ad(null,r.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),d.details=void 0))}_handleFragmentLoadComplete(e){const{frag:t,payload:i}=e,r=t.decryptdata,s=this.hls;if(!this.fragContextChanged(t)&&i&&i.byteLength>0&&r&&r.key&&r.iv&&"AES-128"===r.method){const o=performance.now();this.decrypter.decrypt(new Uint8Array(i),r.key.buffer,r.iv.buffer).catch(c=>{throw s.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Me.FRAG_DECRYPT_ERROR,fatal:!1,error:c,reason:c.message,frag:t}),c}).then(c=>{const d=performance.now();s.trigger(N.FRAG_DECRYPTED,{frag:t,payload:c,stats:{tstart:o,tdecrypt:d}})}).catch(c=>{this.warn(`${c.name}: ${c.message}`),this.state="IDLE"})}}doTick(){if(this.media){if("IDLE"===this.state){const{currentTrackId:e,levels:t}=this,i=t[e];if(!t.length||!i||!i.details)return;const{config:r}=this,s=this.getLoadPosition(),o=Un.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],s,r.maxBufferHole),{end:c,len:d}=o,m=this.getFwdBufferInfo(this.media,ln.MAIN),g=i.details;if(d>this.getMaxBufferLength(m?.len)+g.levelTargetDuration)return;const E=g.fragments,T=E.length,C=g.edge;let k=null;const P=this.fragPrevious;if(c<C){const G=r.maxFragLookUpTolerance,Y=c>C-G?0:G;k=ad(P,E,Math.max(E[0].start,c),Y),!k&&P&&P.start<E[0].start&&(k=E[0])}else k=E[T-1];if(!k)return;if(k=this.mapToInitFragWhenRequired(k),"initSegment"!==k.sn){const Y=E[k.sn-g.startSN-1];Y&&Y.cc===k.cc&&"NOT_LOADED"===this.fragmentTracker.getState(Y)&&(k=Y)}"NOT_LOADED"===this.fragmentTracker.getState(k)&&this.loadFragment(k,i,c)}}else this.state="IDLE"}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,i){this.fragCurrent=e,"initSegment"===e.sn?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,i))}get mediaBufferTimeRanges(){return new DT(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class dp extends dr{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.trackChangeListener=()=>this.onTextTracksChanged(),this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes(this.trackId)}registerListeners(){const{hls:e}=this;e.on(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.MANIFEST_PARSED,this.onManifestParsed,this),e.on(N.LEVEL_LOADING,this.onLevelLoading,this),e.on(N.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(N.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(N.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.MANIFEST_PARSED,this.onManifestParsed,this),e.off(N.LEVEL_LOADING,this.onLevelLoading,this),e.off(N.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(N.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(N.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,e)}onMediaDetaching(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),Kv(this.media.textTracks).forEach(t=>{Xl(t)}),this.subtitleTrack=-1,this.media=null)}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:i,details:r}=t,{trackId:s}=this,o=this.tracksInGroup[s];if(!o)return void this.warn(`Invalid subtitle track id ${i}`);const c=o.details;o.details=t.details,this.log(`subtitle track ${i} loaded [${r.startSN}-${r.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,c)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(null==t||!t.textGroupIds)return;const i=t.textGroupIds[t.urlId],r=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;if(this.groupId!==i){const s=this.tracks.filter(d=>!i||d.groupId===i);this.tracksInGroup=s;const o=this.findTrackId(r?.name)||this.findTrackId();this.groupId=i||null;const c={subtitleTracks:s};this.log(`Updating subtitle tracks, ${s.length} track(s) found in "${i}" group-id`),this.hls.trigger(N.SUBTITLE_TRACKS_UPDATED,c),-1!==o&&this.setSubtitleTrack(o,r)}else this.shouldReloadPlaylist(r)&&this.setSubtitleTrack(this.trackId,r)}findTrackId(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){const r=t[i];if((!this.selectDefaultTrack||r.default)&&(!e||e===r.name))return r.id}return-1}onError(e,t){t.fatal||!t.context||t.context.type===Qn.SUBTITLE_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.checkRetry(t)}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e,this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0)}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const i=t.id,r=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`Loading subtitle playlist for id ${i}`),this.hls.trigger(N.SUBTITLE_TRACK_LOADING,{url:s,id:i,groupId:r,deliveryDirectives:e||null})}}toggleTrackModes(e){const{media:t,trackId:i}=this;if(!t)return;const r=Kv(t.textTracks),s=r.filter(c=>c.groupId===this.groupId);if(-1===e)[].slice.call(r).forEach(c=>{c.mode="disabled"});else{const c=s[i];c&&(c.mode="disabled")}const o=s[e];o&&(o.mode=this.subtitleDisplay?"showing":"hidden")}setSubtitleTrack(e,t){var i;const r=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=e);if(this.trackId!==e&&this.toggleTrackModes(e),this.trackId===e&&(-1===e||null!=(i=r[e])&&i.details)||e<-1||e>=r.length)return;this.clearTimer();const s=r[e];if(this.log(`Switching to subtitle-track ${e}`+(s?` "${s.name}" lang:${s.lang} group:${s.groupId}`:"")),this.trackId=e,s){const{id:o,groupId:c="",name:d,type:m,url:g}=s;this.hls.trigger(N.SUBTITLE_TRACK_SWITCH,{id:o,groupId:c,name:d,type:m,url:g});const v=this.switchParams(s.url,t?.details);this.loadPlaylist(v)}else this.hls.trigger(N.SUBTITLE_TRACK_SWITCH,{id:e})}onTextTracksChanged(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=-1;const t=Kv(this.media.textTracks);for(let i=0;i<t.length;i++)if("hidden"===t[i].mode)e=i;else if("showing"===t[i].mode){e=i;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}},timelineController:class eR{constructor(e){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){const t=new w_(this,"textTrack1"),i=new w_(this,"textTrack2"),r=new w_(this,"textTrack3"),s=new w_(this,"textTrack4");this.cea608Parser1=new PT(1,t,i),this.cea608Parser2=new PT(3,r,s)}e.on(N.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(N.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(N.FRAG_LOADING,this.onFragLoading,this),e.on(N.FRAG_LOADED,this.onFragLoaded,this),e.on(N.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(N.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(N.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(N.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(N.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(N.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(N.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(N.FRAG_LOADING,this.onFragLoading,this),e.off(N.FRAG_LOADED,this.onFragLoaded,this),e.off(N.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(N.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(N.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(N.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(N.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null}addCues(e,t,i,r,s){let o=!1;for(let c=s.length;c--;){const d=s[c],m=tR(d[0],d[1],t,i);if(m>=0&&(d[0]=Math.min(d[0],t),d[1]=Math.max(d[1],i),o=!0,m/(i-t)>.5))return}if(o||s.push([t,i]),this.config.renderTextTracksNatively)this.Cues.newCue(this.captionsTracks[e],t,i,r);else{const c=this.Cues.newCue(null,t,i,r);this.hls.trigger(N.CUES_PARSED,{type:"captions",cues:c,track:e})}}onInitPtsFound(e,{frag:t,id:i,initPTS:r,timescale:s}){const{unparsedVttFrags:o}=this;"main"===i&&(this.initPTS[t.cc]={baseTime:r,timescale:s}),o.length&&(this.unparsedVttFrags=[],o.forEach(c=>{this.onFragLoaded(N.FRAG_LOADED,c)}))}getExistingTrack(e){const{media:t}=this;if(t)for(let i=0;i<t.textTracks.length;i++){const r=t.textTracks[i];if(r[e])return r}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:i,media:r}=this,{label:s,languageCode:o}=t[e],c=this.getExistingTrack(e);if(c)i[e]=c,Xl(i[e]),Qg(i[e],r);else{const d=this.createTextTrack("captions",s,o);d&&(d[e]=!0,i[e]=d)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const r={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(N.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,t,i){const r=this.media;if(r)return r.addTextTrack(e,t,i)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{Xl(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let i=0;i<t.length;i++)Xl(t[i])}onSubtitleTracksUpdated(e,t){const i=t.subtitleTracks||[],r=i.some(s=>s.textCodec===fp);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){if(Wv(this.tracks,i))return void(this.tracks=i);if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){const o=this.media?this.media.textTracks:null;this.tracks.forEach((c,d)=>{let m;if(o&&d<o.length){let g=null;for(let v=0;v<o.length;v++)if(rb(o[v],c)){g=o[v];break}g&&(m=g)}if(m)Xl(m);else{const g=this._captionsOrSubtitlesFromCharacteristics(c);m=this.createTextTrack(g,c.name,c.lang),m&&(m.mode="disabled")}m&&(m.groupId=c.groupId,this.textTracks.push(m))})}else if(this.tracks.length){const o=this.tracks.map(c=>({label:c.name,kind:c.type.toLowerCase(),default:c.default,subtitleTrack:c}));this.hls.trigger(N.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}_captionsOrSubtitlesFromCharacteristics(e){if(e.attrs.CHARACTERISTICS){const t=/transcribes-spoken-dialog/gi.test(e.attrs.CHARACTERISTICS),i=/describes-music-and-sound/gi.test(e.attrs.CHARACTERISTICS);if(t&&i)return"captions"}return"subtitles"}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(i=>{const r=/(?:CC|SERVICE)([1-4])/.exec(i.instreamId);if(!r)return;const o=this.captionsProperties[`textTrack${r[1]}`];o&&(o.label=i.name,i.lang&&(o.languageCode=i.lang),o.media=i)})}closedCaptionsForLevel(e){return this.hls.levels[e.level]?.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){const{cea608Parser1:i,cea608Parser2:r,lastSn:s,lastPartIndex:o}=this;if(this.enabled&&i&&r&&t.frag.type===ln.MAIN){var c,d;const m=t.frag.sn,g=null!=(c=null==t||null==(d=t.part)?void 0:d.index)?c:-1;m===s+1||m===s&&g===o+1||(i.reset(),r.reset()),this.lastSn=m,this.lastPartIndex=g}}onFragLoaded(e,t){const{frag:i,payload:r}=t;if(i.type===ln.SUBTITLE)if(r.byteLength){const s=i.decryptdata;if(null==s||!s.encrypted||"stats"in t){const c=this.tracks[i.level],d=this.vttCCs;d[i.cc]||(d[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),c&&c.textCodec===fp?this._parseIMSC1(i,r):this._parseVTTs(t)}}else this.hls.trigger(N.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const i=this.hls;HT(t,this.initPTS[e.cc],r=>{this._appendCues(r,e.level),i.trigger(N.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},r=>{ce.log(`Failed to parse IMSC1: ${r}`),i.trigger(N.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:r})})}_parseVTTs(e){var t;const{frag:i,payload:r}=e,{initPTS:s,unparsedVttFrags:o}=this,c=s.length-1;if(!s[i.cc]&&-1===c)return void o.push(e);const d=this.hls;!function XA(n,e,t,i,r,s,o){const c=new VT,d=cl(new Uint8Array(n)).trim().replace($T,"\n").split("\n"),m=[],g=e?function OA(n,e=1){return f_(n,Fv,1/e)}(e.baseTime,e.timescale):0;let C,v="00:00.000",E=0,T=0,k=!0;c.oncue=function(P){const G=t[i];let Y=t.ccOffset;const W=(E-g)/9e4;if(null!=G&&G.new&&(void 0!==T?Y=t.ccOffset=G.start:QA(t,i,W)),W){if(!e)return void(C=new Error("Missing initPTS for VTT MPEGTS"));Y=W-t.presentationOffset}const te=P.endTime-P.startTime,oe=Kn(9e4*(P.startTime+Y-T),9e4*r)/9e4;P.startTime=Math.max(oe,0),P.endTime=Math.max(oe+te,0);const Ae=P.text.trim();P.text=decodeURIComponent(encodeURIComponent(Ae)),P.id||(P.id=Jv(P.startTime,P.endTime,Ae)),P.endTime>0&&m.push(P)},c.onparsingerror=function(P){C=P},c.onflush=function(){C?o(C):s(m)},d.forEach(P=>{if(k){if(Xv(P,"X-TIMESTAMP-MAP=")){k=!1,P.slice(16).split(",").forEach(G=>{Xv(G,"LOCAL:")?v=G.slice(6):Xv(G,"MPEGTS:")&&(E=parseInt(G.slice(7)))});try{T=ZA(v)/1e3}catch(G){C=G}return}""===P&&(k=!1)}c.parse(P+"\n")}),c.flush()}(null!=(t=i.initSegment)&&t.data?td(i.initSegment.data,new Uint8Array(r)):r,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,g=>{this._appendCues(g,i.level),d.trigger(N.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},g=>{const v="Missing initPTS for VTT MPEGTS"===g.message;v?o.push(e):this._fallbackToIMSC1(i,r),ce.log(`Failed to parse VTT cue: ${g}`),!(v&&c>i.cc)&&d.trigger(N.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:g})})}_fallbackToIMSC1(e,t){const i=this.tracks[e.level];i.textCodec||HT(t,this.initPTS[e.cc],()=>{i.textCodec=fp,this._parseIMSC1(e,t)},()=>{i.textCodec="wvtt"})}_appendCues(e,t){const i=this.hls;if(this.config.renderTextTracksNatively){const r=this.textTracks[t];if(!r||"disabled"===r.mode)return;e.forEach(s=>Bx(r,s))}else{const r=this.tracks[t];if(!r)return;i.trigger(N.CUES_PARSED,{type:"subtitles",cues:e,track:r.default?"default":"subtitles"+t})}}onFragDecrypted(e,t){const{frag:i}=t;i.type===ln.SUBTITLE&&this.onFragLoaded(N.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){const{cea608Parser1:i,cea608Parser2:r}=this;if(!this.enabled||!i||!r)return;const{frag:s,samples:o}=t;if(s.type!==ln.MAIN||"NONE"!==this.closedCaptionsForLevel(s))for(let c=0;c<o.length;c++){const d=o[c].bytes;if(d){const m=this.extractCea608Data(d);i.addData(o[c].pts,m[0]),r.addData(o[c].pts,m[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:i,endOffsetSubtitles:r,type:s}){const{media:o}=this;if(o&&!(o.currentTime<i)){if(!s||"video"===s){const{captionsTracks:c}=this;Object.keys(c).forEach(d=>$h(c[d],t,i))}if(this.config.renderTextTracksNatively&&0===t&&void 0!==r){const{textTracks:c}=this;Object.keys(c).forEach(d=>$h(c[d],t,r))}}}extractCea608Data(e){const t=[[],[]],i=31&e[0];let r=2;for(let s=0;s<i;s++){const o=e[r++],c=127&e[r++],d=127&e[r++];if((0!==c||0!==d)&&0!=(4&o)){const g=3&o;(0===g||1===g)&&(t[g].push(c),t[g].push(d))}}return t}},audioStreamController:class $L extends Gh{constructor(e,t,i){super(e,t,i,"[audio-stream-controller]",ln.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.LEVEL_LOADED,this.onLevelLoaded,this),e.on(N.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(N.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(N.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(N.ERROR,this.onError,this),e.on(N.BUFFER_RESET,this.onBufferReset,this),e.on(N.BUFFER_CREATED,this.onBufferCreated,this),e.on(N.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(N.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(N.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.LEVEL_LOADED,this.onLevelLoaded,this),e.off(N.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(N.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(N.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(N.ERROR,this.onError,this),e.off(N.BUFFER_RESET,this.onBufferReset,this),e.off(N.BUFFER_CREATED,this.onBufferCreated,this),e.off(N.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(N.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(N.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:i,initPTS:r,timescale:s}){if("main"===i){const o=t.cc;this.initPTS[t.cc]={baseTime:r,timescale:s},this.log(`InitPTS for cc: ${o} found from main: ${r}`),this.videoTrackCC=o,"WAITING_INIT_PTS"===this.state&&this.tick()}}startLoad(e){if(!this.levels)return this.startPosition=e,void(this.state="STOPPED");const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),t>0&&-1===e?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state="IDLE"):(this.loadedmetadata=!1,this.state="WAITING_TRACK"),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case"IDLE":this.doTickIdle();break;case"WAITING_TRACK":{var e;const{levels:i,trackId:r}=this,s=null==i||null==(e=i[r])?void 0:e.details;if(s){if(this.waitForCdnTuneIn(s))break;this.state="WAITING_INIT_PTS"}break}case"FRAG_LOADING_WAITING_RETRY":{var t;const i=performance.now(),r=this.retryDate;(!r||i>=r||null!=(t=this.media)&&t.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state="IDLE");break}case"WAITING_INIT_PTS":{const i=this.waitingData;if(i){const{frag:r,part:s,cache:o,complete:c}=i;if(void 0!==this.initPTS[r.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state="FRAG_LOADING";const m={frag:r,part:s,payload:o.flush(),networkDetails:null};this._handleFragmentLoadProgress(m),c&&super._handleFragmentLoadComplete(m)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${r.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const d=this.getLoadPosition(),m=Un.bufferInfo(this.mediaBuffer,d,this.config.maxBufferHole);bv(m.end,this.config.maxFragLookUpTolerance,r)<0&&(this.log(`Waiting fragment cc (${r.cc}) @ ${r.start} cancelled because another fragment at ${m.end} is needed`),this.clearWaitingFragment())}}else this.state="IDLE"}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state="IDLE")}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:i,trackId:r}=this;if(null==t||!t[r]||!i&&(this.startFragRequested||!e.config.startFragPrefetch))return;const o=t[r],c=o.details;if(!c||c.live&&this.levelLastLoaded!==r||this.waitForCdnTuneIn(c))return void(this.state="WAITING_TRACK");const d=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&d&&(this.bufferFlushed=!1,this.afterBufferFlushed(d,hi.AUDIO,ln.AUDIO));const m=this.getFwdBufferInfo(d,ln.AUDIO);if(null===m)return;const{bufferedTrack:g,switchingTrack:v}=this;if(!v&&this._streamEnded(m,c))return e.trigger(N.BUFFER_EOS,{type:"audio"}),void(this.state="ENDED");const E=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,ln.MAIN),T=m.len,C=this.getMaxBufferLength(E?.len);if(T>=C&&!v)return;const P=c.fragments[0].start;let G=m.end;if(v&&i){const oe=this.getLoadPosition();g&&v.attrs!==g.attrs&&(G=oe),c.PTSKnown&&oe<P&&(m.end>P||m.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),i.currentTime=P+.05)}let Y=this.getNextFragment(G,c),W=!1;if(Y&&this.isLoopLoading(Y,G)&&(W=!!Y.gap,Y=this.getNextFragmentLoopLoading(Y,c,m,ln.MAIN,C)),!Y)return void(this.bufferFlushed=!0);const te=E&&Y.start>E.end+c.targetduration;if(te||(null==E||!E.len)&&m.len){const oe=this.getAppendedFrag(Y.start,ln.MAIN);if(null===oe||(W||(W=!!oe.gap||!!te&&0===E.len),te&&!W||W&&m.nextStart&&m.nextStart<oe.end))return}this.loadFragment(Y,o,G)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(i=>new Hh(i))}onAudioTrackSwitching(e,t){const i=!!t.url;this.trackId=t.id;const{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),i?this.setInterval(100):this.resetTransmuxer(),i?(this.switchingTrack=t,this.state="IDLE"):(this.switchingTrack=null,this.bufferedTrack=t,this.state="STOPPED"),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(N.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var i;if(null==this.mainDetails)return void(this.cachedTrackLoadedData=t);const{levels:r}=this,{details:s,id:o}=t;if(!r)return void this.warn(`Audio tracks were reset while loading level ${o}`);this.log(`Track ${o} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`);const c=r[o];let d=0;if(s.live||null!=(i=c.details)&&i.live){this.checkLiveUpdate(s);const m=this.mainDetails;if(s.deltaUpdateFailed||!m)return;!c.details&&s.hasProgramDateTime&&m.hasProgramDateTime?(Xx(s,m),d=s.fragments[0].start):d=this.alignPlaylists(s,c.details)}c.details=s,this.levelLastLoaded=o,!this.startFragRequested&&(this.mainDetails||!s.live)&&this.setStartPosition(c.details,d),"WAITING_TRACK"===this.state&&!this.waitForCdnTuneIn(s)&&(this.state="IDLE"),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:i,part:r,payload:s}=e,{config:o,trackId:c,levels:d}=this;if(!d)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);const m=d[c];if(!m)return void this.warn("Audio track is undefined on fragment load progress");const g=m.details;if(!g)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(i.start);const v=o.defaultAudioCodec||m.audioCodec||"mp4a.40.2";let E=this.transmuxer;E||(E=this.transmuxer=new Zh(this.hls,ln.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const T=this.initPTS[i.cc],C=null==(t=i.initSegment)?void 0:t.data;if(void 0!==T){const P=r?r.index:-1,Y=new Sv(i.level,i.sn,i.stats.chunkCount,s.byteLength,P,-1!==P);E.push(s,C,v,"",i,r,g.totalduration,!1,Y,T)}else{this.log(`Unknown video PTS for cc ${i.cc}, waiting for video PTS before demuxing audio frag ${i.sn} of [${g.startSN} ,${g.endSN}],track ${c}`);const{cache:k}=this.waitingData=this.waitingData||{frag:i,part:r,cache:new ST,complete:!1};k.push(new Uint8Array(s)),this.waitingVideoCC=this.videoTrackCC,this.state="WAITING_INIT_PTS"}}_handleFragmentLoadComplete(e){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const i=t.tracks.audio;i&&(this.mediaBuffer=i.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:i,part:r}=t;if(i.type===ln.AUDIO)if(this.fragContextChanged(i))this.warn(`Fragment ${i.sn}${r?" p: "+r.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if("initSegment"!==i.sn){this.fragPrevious=i;const s=this.switchingTrack;s&&(this.bufferedTrack=s,this.switchingTrack=null,this.hls.trigger(N.AUDIO_TRACK_SWITCHED,hs({},s)))}this.fragBufferedComplete(i,r)}else if(!this.loadedmetadata&&i.type===ln.MAIN){const s=this.videoBuffer||this.media;s&&Un.getBuffered(s).length&&(this.loadedmetadata=!0)}}onError(e,t){var i;if(t.fatal)this.state="ERROR";else switch(t.details){case Me.FRAG_GAP:case Me.FRAG_PARSING_ERROR:case Me.FRAG_DECRYPT_ERROR:case Me.FRAG_LOAD_ERROR:case Me.FRAG_LOAD_TIMEOUT:case Me.KEY_LOAD_ERROR:case Me.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ln.AUDIO,t);break;case Me.AUDIO_TRACK_LOAD_ERROR:case Me.AUDIO_TRACK_LOAD_TIMEOUT:case Me.LEVEL_PARSING_ERROR:!t.levelRetry&&"WAITING_TRACK"===this.state&&(null==(i=t.context)?void 0:i.type)===Qn.AUDIO_TRACK&&(this.state="IDLE");break;case Me.BUFFER_FULL_ERROR:if(!t.parent||"audio"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case Me.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}onBufferFlushed(e,{type:t}){t===hi.AUDIO&&(this.bufferFlushed=!0,"ENDED"===this.state&&(this.state="IDLE"))}_handleTransmuxComplete(e){var t;const i="audio",{hls:r}=this,{remuxResult:s,chunkMeta:o}=e,c=this.getCurrentContext(o);if(!c)return void this.resetWhenMissingContext(o);const{frag:d,part:m,level:g}=c,{details:v}=g,{audio:E,text:T,id3:C,initSegment:k}=s;if(!this.fragContextChanged(d)&&v){if(this.state="PARSING",this.switchingTrack&&E&&this.completeAudioSwitch(this.switchingTrack),null!=k&&k.tracks){const P=d.initSegment||d;this._bufferInitSegment(k.tracks,P,o),r.trigger(N.FRAG_PARSING_INIT_SEGMENT,{frag:P,id:i,tracks:k.tracks})}if(E){const{startPTS:P,endPTS:G,startDTS:Y,endDTS:W}=E;m&&(m.elementaryStreams[hi.AUDIO]={startPTS:P,endPTS:G,startDTS:Y,endDTS:W}),d.setElementaryStreamInfo(hi.AUDIO,P,G,Y,W),this.bufferFragmentData(E,d,m,o)}if(null!=C&&null!=(t=C.samples)&&t.length){const P=vr({id:i,frag:d,details:v},C);r.trigger(N.FRAG_PARSING_METADATA,P)}if(T){const P=vr({id:i,frag:d,details:v},T);r.trigger(N.FRAG_PARSING_USERDATA,P)}}else this.fragmentTracker.removeFragment(d)}_bufferInitSegment(e,t,i){if("PARSING"!==this.state)return;e.video&&delete e.video;const r=e.audio;if(!r)return;r.levelCodec=r.codec,r.id="audio",this.log(`Init audio buffer, container:${r.container}, codecs[parsed]=[${r.codec}]`),this.hls.trigger(N.BUFFER_CODECS,e);const s=r.initSegment;null!=s&&s.byteLength&&this.hls.trigger(N.BUFFER_APPENDING,{type:"audio",frag:t,part:null,chunkMeta:i,parent:t.type,data:s}),this.tick()}loadFragment(e,t,i){const r=this.fragmentTracker.getState(e);var s;this.fragCurrent=e,this.switchingTrack||"NOT_LOADED"===r||"PARTIAL"===r?"initSegment"===e.sn?this._loadInitSegment(e,t):null!=(s=t.details)&&s.live&&!this.initPTS[e.cc]?(this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state="WAITING_INIT_PTS"):(this.startFragRequested=!0,super.loadFragment(e,t,i)):this.clearTrackerIfNeeded(e)}completeAudioSwitch(e){const{hls:t,media:i,bufferedTrack:r}=this,s=r?.attrs,o=e.attrs;i&&s&&(s.CHANNELS!==o.CHANNELS||s.NAME!==o.NAME||s.LANGUAGE!==o.LANGUAGE)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio")),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(N.AUDIO_TRACK_SWITCHED,hs({},e))}},audioTrackController:class HL extends dr{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.MANIFEST_PARSED,this.onManifestParsed,this),e.on(N.LEVEL_LOADING,this.onLevelLoading,this),e.on(N.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(N.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(N.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.MANIFEST_PARSED,this.onManifestParsed,this),e.off(N.LEVEL_LOADING,this.onLevelLoading,this),e.off(N.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(N.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(N.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:i,groupId:r,details:s}=t,o=this.tracksInGroup[i];if(!o||o.groupId!==r)return void this.warn(`Track with id:${i} and group:${r} not found in active group ${o.groupId}`);const c=o.details;o.details=t.details,this.log(`audio-track ${i} "${o.name}" lang:${o.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,c)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(null==t||!t.audioGroupIds)return;const i=t.audioGroupIds[t.urlId];if(this.groupId!==i){this.groupId=i||null;const r=this.tracks.filter(o=>!i||o.groupId===i);this.selectDefaultTrack&&!r.some(o=>o.default)&&(this.selectDefaultTrack=!1),this.tracksInGroup=r;const s={audioTracks:r};this.log(`Updating audio tracks, ${r.length} track(s) found in group:${i}`),this.hls.trigger(N.AUDIO_TRACKS_UPDATED,s),this.selectInitialTrack()}else this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===Qn.AUDIO_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(t))}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length)return void this.warn("Invalid id passed to audio-track controller");this.clearTimer();const i=this.currentTrack,r=t[e],{groupId:s,name:o}=r;if(this.log(`Switching to audio-track ${e} "${o}" lang:${r.lang} group:${s}`),this.trackId=e,this.currentTrack=r,this.selectDefaultTrack=!1,this.hls.trigger(N.AUDIO_TRACK_SWITCHING,hs({},r)),r.details&&!r.details.live)return;const c=this.switchParams(r.url,i?.details);this.loadPlaylist(c)}selectInitialTrack(){const e=this.tracksInGroup,t=this.findTrackId(this.currentTrack)|this.findTrackId(null);if(-1!==t)this.setAudioTrack(t);else{const i=new Error(`No track found for running audio group-ID: ${this.groupId} track count: ${e.length}`);this.warn(i.message),this.hls.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Me.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:i})}}findTrackId(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){const r=t[i];if((!this.selectDefaultTrack||r.default)&&(!e||void 0!==e.attrs["STABLE-RENDITION-ID"]&&e.attrs["STABLE-RENDITION-ID"]===r.attrs["STABLE-RENDITION-ID"]||e.name===r.name&&e.lang===r.lang))return r.id}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const i=t.id,r=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`loading audio-track playlist ${i} "${t.name}" lang:${t.lang} group:${r}`),this.clearTimer(),this.hls.trigger(N.AUDIO_TRACK_LOADING,{url:s,id:i,groupId:r,deliveryDirectives:e||null})}}},emeController:qT,cmcdController:tu,contentSteeringController:class GL{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=ce.log.bind(ce,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(N.MANIFEST_PARSED,this.onManifestParsed,this),e.on(N.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(N.MANIFEST_PARSED,this.onManifestParsed,this),e.off(N.ERROR,this.onError,this))}startLoad(){if(this.started=!0,self.clearTimeout(this.reloadTimer),this.enabled&&this.uri)if(this.updated){const e=Math.max(1e3*this.timeToLoad-(performance.now()-this.updated),0);this.scheduleRefresh(this.uri,e)}else this.loadSteeringManifest(this.uri)}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),self.clearTimeout(this.reloadTimer)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(i=>i!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:i}=t;null!==i&&(this.pathwayId=i.pathwayId,this.uri=i.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:i}=t;if(2===i?.action&&1===i.flags){let r=this.pathwayPriority;const s=this.pathwayId;this.penalizedPathways[s]||(this.penalizedPathways[s]=performance.now()),!r&&this.levels&&(r=this.levels.reduce((o,c)=>(-1===o.indexOf(c.pathwayId)&&o.push(c.pathwayId),o),[])),r&&r.length>1&&(this.updatePathwayPriority(r),i.resolved=this.pathwayId!==s)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){const i=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${i}"`),t=this.getLevelsForPathway(i),this.pathwayId=i}return t.length!==e.length?(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t):e}getLevelsForPathway(e){return null===this.levels?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){let t;this.pathwayPriority=e;const i=this.penalizedPathways,r=performance.now();Object.keys(i).forEach(s=>{r-i[s]>3e5&&delete i[s]});for(let s=0;s<e.length;s++){const o=e[s];if(i[o])continue;if(o===this.pathwayId)return;const c=this.hls.nextLoadLevel,d=this.hls.levels[c];if(t=this.getLevelsForPathway(o),t.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,this.hls.trigger(N.LEVELS_UPDATED,{levels:t});const m=this.hls.levels[c];d&&m&&this.levels&&(m.attrs["STABLE-VARIANT-ID"]!==d.attrs["STABLE-VARIANT-ID"]&&m.bitrate!==d.bitrate&&this.log(`Unstable Pathways change from bitrate ${d.bitrate} to ${m.bitrate}`),this.hls.nextLoadLevel=c);break}}}clonePathways(e){const t=this.levels;if(!t)return;const i={},r={};e.forEach(s=>{const{ID:o,"BASE-ID":c,"URI-REPLACEMENT":d}=s;if(t.some(g=>g.pathwayId===o))return;const m=this.getLevelsForPathway(c).map(g=>{const v=vr({},g);v.details=void 0,v.url=ZT(g.uri,g.attrs["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",d);const E=new Ui(g.attrs);E["PATHWAY-ID"]=o;const T=E.AUDIO&&`${E.AUDIO}_clone_${o}`,C=E.SUBTITLES&&`${E.SUBTITLES}_clone_${o}`;T&&(i[E.AUDIO]=T,E.AUDIO=T),C&&(r[E.SUBTITLES]=C,E.SUBTITLES=C),v.attrs=E;const k=new Hh(v);return r_(k,"audio",T),r_(k,"text",C),k});t.push(...m),ob(this.audioTracks,i,d,o),ob(this.subtitleTracks,r,d,o)})}loadSteeringManifest(e){const t=this.hls.config,i=t.loader;let r;this.loader&&this.loader.destroy(),this.loader=new i(t);try{r=new self.URL(e)}catch{return this.enabled=!1,void this.log(`Failed to parse Steering Manifest URI: ${e}`)}if("data:"!==r.protocol){const g=0|(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate);r.searchParams.set("_HLS_pathway",this.pathwayId),r.searchParams.set("_HLS_throughput",""+g)}const s={responseType:"json",url:r.href},o=t.steeringManifestLoadPolicy.default,c=o.errorRetry||o.timeoutRetry||{},d={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:c.maxNumRetry||0,retryDelay:c.retryDelayMs||0,maxRetryDelay:c.maxRetryDelayMs||0},m={onSuccess:(g,v,E,T)=>{this.log(`Loaded steering manifest: "${r}"`);const C=g.data;if(1!==C.VERSION)return void this.log(`Steering VERSION ${C.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=C.TTL;const{"RELOAD-URI":k,"PATHWAY-CLONES":P,"PATHWAY-PRIORITY":G}=C;if(k)try{this.uri=new self.URL(k,r).href}catch{return this.enabled=!1,void this.log(`Failed to parse Steering Manifest RELOAD-URI: ${k}`)}this.scheduleRefresh(this.uri||E.url),P&&this.clonePathways(P),G&&this.updatePathwayPriority(G)},onError:(g,v,E,T)=>{if(this.log(`Error loading steering manifest: ${g.code} ${g.text} (${v.url})`),this.stopLoad(),410===g.code)return this.enabled=!1,void this.log(`Steering manifest ${v.url} no longer available`);let C=1e3*this.timeToLoad;if(429!==g.code)this.scheduleRefresh(this.uri||v.url,C);else{const k=this.loader;if("function"==typeof k?.getResponseHeader){const P=k.getResponseHeader("Retry-After");P&&(C=1e3*parseFloat(P))}this.log(`Steering manifest ${v.url} rate limited`)}},onTimeout:(g,v,E)=>{this.log(`Timeout loading steering manifest (${v.url})`),this.scheduleRefresh(this.uri||v.url)}};this.log(`Requesting steering manifest: ${r}`),this.loader.load(s,d,m)}scheduleRefresh(e,t=1e3*this.timeToLoad){self.clearTimeout(this.reloadTimer),this.reloadTimer=self.setTimeout(()=>{this.loadSteeringManifest(e)},t)}}});function C_(n){return n&&"object"==typeof n?Array.isArray(n)?n.map(C_):Object.keys(n).reduce((e,t)=>(e[t]=C_(n[t]),e),{}):n}let D_=(()=>{class n{static get version(){return"1.4.12"}static isSupported(){return function nT(){const n=Ql();if(!n)return!1;const e=tT();return!(!n||"function"!=typeof n.isTypeSupported||!n.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')||e&&(!e.prototype||"function"!=typeof e.prototype.appendBuffer||"function"!=typeof e.prototype.remove))}()}static get Events(){return N}static get ErrorTypes(){return an}static get ErrorDetails(){return Me}static get DefaultConfig(){return n.defaultConfig?n.defaultConfig:gR}static set DefaultConfig(t){n.defaultConfig=t}constructor(t={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new __,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,function KD(n,e){if(self.console&&!0===n||"object"==typeof n){!function WD(n,...e){e.forEach(function(t){Gm[t]=n[t]?n[t].bind(n):function Eo(n){const e=self.console[n];return e?e.bind(self.console,`[${n}] >`):Xc}(t)})}(n,"debug","log","info","warn","error");try{Gm.log(`Debug logs enabled for "${e}" in hls.js version 1.4.12`)}catch{Gm=H0}}else Gm=H0}(t.debug||!1,"Hls instance");const i=this.config=function QT(n,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==e.liveMaxLatencyDurationCount&&(void 0===e.liveSyncDurationCount||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==e.liveMaxLatencyDuration&&(void 0===e.liveSyncDuration||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const t=C_(n),r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach(s=>{const o=`${"level"===s?"playlist":s}LoadPolicy`,c=void 0===e[o],d=[];r.forEach(m=>{const g=`${s}Loading${m}`,v=e[g];if(void 0!==v&&c){d.push(g);const E=t[o].default;switch(e[o]={default:E},m){case"TimeOut":E.maxLoadTimeMs=v,E.maxTimeToFirstByteMs=v;break;case"MaxRetry":E.errorRetry.maxNumRetry=v,E.timeoutRetry.maxNumRetry=v;break;case"RetryDelay":E.errorRetry.retryDelayMs=v,E.timeoutRetry.retryDelayMs=v;break;case"MaxRetryTimeout":E.errorRetry.maxRetryDelayMs=v,E.timeoutRetry.maxRetryDelayMs=v}}}),d.length&&ce.warn(`hls.js config: "${d.join('", "')}" setting(s) are deprecated, use "${o}": ${JSON.stringify(e[o])}`)}),hs(hs({},t),e)}(n.DefaultConfig,t);this.userConfig=t,this._autoLevelCapping=-1,i.progressive&&function XT(n){const e=n.loader;e!==ab&&e!==sR?(ce.log("[config]: Custom loader detected, cannot enable progressive streaming"),n.progressive=!1):function oR(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}()&&(n.loader=ab,n.progressive=!0,n.enableSoftwareAES=!0,ce.log("[config]: Progressive streaming enabled, using FetchLoader"))}(i);const{abrController:r,bufferController:s,capLevelController:o,errorController:c,fpsController:d}=i,m=new c(this),g=this.abrController=new r(this),v=this.bufferController=new s(this),E=this.capLevelController=new o(this),T=new d(this),C=new uv(this),k=new Vx(this),P=i.contentSteeringController,G=P?new P(this):null,Y=this.levelController=new pA(this,G),W=new Yx(this),te=new FL(this.config),oe=this.streamController=new TT(this,W,te);E.setStreamController(oe),T.setStreamController(oe);const Ae=[C,Y,oe];G&&Ae.splice(1,0,G),this.networkControllers=Ae;const we=[g,v,E,T,k,W];this.audioTrackController=this.createController(i.audioTrackController,Ae);const Ge=i.audioStreamController;Ge&&Ae.push(new Ge(this,W,te)),this.subtitleTrackController=this.createController(i.subtitleTrackController,Ae);const rt=i.subtitleStreamController;rt&&Ae.push(new rt(this,W,te)),this.createController(i.timelineController,we),te.emeController=this.emeController=this.createController(i.emeController,we),this.cmcdController=this.createController(i.cmcdController,we),this.latencyController=this.createController(fv,we),this.coreComponents=we,Ae.push(m);const Pe=m.onErrorOut;"function"==typeof Pe&&this.on(N.ERROR,Pe,m)}createController(t,i){if(t){const r=new t(this);return i&&i.push(r),r}return null}on(t,i,r=this){this._emitter.on(t,i,r)}once(t,i,r=this){this._emitter.once(t,i,r)}removeAllListeners(t){this._emitter.removeAllListeners(t)}off(t,i,r=this,s){this._emitter.off(t,i,r,s)}listeners(t){return this._emitter.listeners(t)}emit(t,i,r){return this._emitter.emit(t,i,r)}trigger(t,i){if(this.config.debug)return this.emit(t,t,i);try{return this.emit(t,t,i)}catch(r){ce.error("An internal error happened while handling event "+t+'. Error message: "'+r.message+'". Here is a stacktrace:',r),this.trigger(N.ERROR,{type:an.OTHER_ERROR,details:Me.INTERNAL_EXCEPTION,fatal:!1,event:t,error:r})}return!1}listenerCount(t){return this._emitter.listenerCount(t)}destroy(){ce.log("destroy"),this.trigger(N.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(i=>i.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(i=>i.destroy()),this.coreComponents.length=0;const t=this.config;t.xhrSetup=t.fetchSetup=void 0,this.userConfig=null}attachMedia(t){ce.log("attachMedia"),this._media=t,this.trigger(N.MEDIA_ATTACHING,{media:t})}detachMedia(){ce.log("detachMedia"),this.trigger(N.MEDIA_DETACHING,void 0),this._media=null}loadSource(t){this.stopLoad();const i=this.media,r=this.url,s=this.url=$g.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0});ce.log(`loadSource:${s}`),i&&r&&(r!==s||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(i)),this.trigger(N.MANIFEST_LOADING,{url:t})}startLoad(t=-1){ce.log(`startLoad(${t})`),this.networkControllers.forEach(i=>{i.startLoad(t)})}stopLoad(){ce.log("stopLoad"),this.networkControllers.forEach(t=>{t.stopLoad()})}swapAudioCodec(){ce.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){ce.log("recoverMediaError");const t=this._media;this.detachMedia(),t&&this.attachMedia(t)}removeLevel(t,i=0){this.levelController.removeLevel(t,i)}get levels(){return this.levelController.levels||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(t){ce.log(`set currentLevel:${t}`),this.loadLevel=t,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(t){ce.log(`set nextLevel:${t}`),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(t){ce.log(`set loadLevel:${t}`),this.levelController.manualLevel=t}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(t){this.levelController.nextLoadLevel=t}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(t){ce.log(`set firstLevel:${t}`),this.levelController.firstLevel=t}get startLevel(){return this.levelController.startLevel}set startLevel(t){ce.log(`set startLevel:${t}`),-1!==t&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(t){const i=!!t;i!==this.config.capLevelToPlayerSize&&(i?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=i)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimate():NaN}get ttfbEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimateTTFB():NaN}set autoLevelCapping(t){this._autoLevelCapping!==t&&(ce.log(`set autoLevelCapping:${t}`),this._autoLevelCapping=t)}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(t){tp.indexOf(t)>-1&&(this._maxHdcpLevel=t)}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:t,config:{minAutoBitrate:i}}=this;if(!t)return 0;const r=t.length;for(let s=0;s<r;s++)if(t[s].maxBitrate>=i)return s;return 0}get maxAutoLevel(){const{levels:t,autoLevelCapping:i,maxHdcpLevel:r}=this;let s;if(s=-1===i&&t&&t.length?t.length-1:i,r)for(let o=s;o--;){const c=t[o].attrs["HDCP-LEVEL"];if(c&&c<=r)return o}return s}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(t){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,t)}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get audioTracks(){const t=this.audioTrackController;return t?t.audioTracks:[]}get audioTrack(){const t=this.audioTrackController;return t?t.audioTrack:-1}set audioTrack(t){const i=this.audioTrackController;i&&(i.audioTrack=t)}get subtitleTracks(){const t=this.subtitleTrackController;return t?t.subtitleTracks:[]}get subtitleTrack(){const t=this.subtitleTrackController;return t?t.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(t){const i=this.subtitleTrackController;i&&(i.subtitleTrack=t)}get subtitleDisplay(){const t=this.subtitleTrackController;return!!t&&t.subtitleDisplay}set subtitleDisplay(t){const i=this.subtitleTrackController;i&&(i.subtitleDisplay=t)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(t){this.config.lowLatencyMode=t}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}return n.defaultConfig=void 0,n})();var gt,hr=z(6881),cd=z(4859),nu=z(1877),An=z(2090),JT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Oa={},lb=lb||{},vn=JT||self;function iu(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function yp(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var Zo="closure_uid_"+(1e9*Math.random()>>>0),_R=0;function A_(n,e,t){return n.call.apply(n.bind,arguments)}function vp(n,e,t){if(!n)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,i),n.apply(e,r)}}return function(){return n.apply(e,arguments)}}function ms(n,e,t){return(ms=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?A_:vp).apply(null,arguments)}function R_(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var i=t.slice();return i.push.apply(i,arguments),n.apply(this,i)}}function Ur(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(i,r,s){for(var o=Array(arguments.length-2),c=2;c<arguments.length;c++)o[c-2]=arguments[c];return e.prototype[r].apply(i,o)}}function Pa(){this.s=this.s,this.o=this.o}Pa.prototype.s=!1,Pa.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function cb(n){Object.prototype.hasOwnProperty.call(n,Zo)&&n[Zo]||(n[Zo]=++_R)}(this)},Pa.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const eI=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function ub(n){const e=n.length;if(0<e){const t=Array(e);for(let i=0;i<e;i++)t[i]=n[i];return t}return[]}function db(n,e){for(let t=1;t<arguments.length;t++){const i=arguments[t];if(iu(i)){const r=n.length||0,s=i.length||0;n.length=r+s;for(let o=0;o<s;o++)n[r+o]=i[o]}else n.push(i)}}function Qr(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}Qr.prototype.h=function(){this.defaultPrevented=!0};var hb=function(){if(!vn.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{vn.addEventListener("test",()=>{},e),vn.removeEventListener("test",()=>{},e)}catch{}return n}();function ef(n){return/^[\s\xa0]*$/.test(n)}function tf(){var n=vn.navigator;return n&&(n=n.userAgent)?n:""}function Qo(n){return-1!=tf().indexOf(n)}function M_(n){return M_[" "](n),n}M_[" "]=function(){};var O_,n,mb=Qo("Opera"),nf=Qo("Trident")||Qo("MSIE"),tI=Qo("Edge"),pb=tI||nf,nI=Qo("Gecko")&&!(-1!=tf().toLowerCase().indexOf("webkit")&&!Qo("Edge"))&&!(Qo("Trident")||Qo("MSIE"))&&!Qo("Edge"),iI=-1!=tf().toLowerCase().indexOf("webkit")&&!Qo("Edge");function L_(){var n=vn.document;return n?n.documentMode:void 0}e:{var P_="",N_=(n=tf(),nI?/rv:([^\);]+)(\)|;)/.exec(n):tI?/Edge\/([\d\.]+)/.exec(n):nf?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):iI?/WebKit\/(\S+)/.exec(n):mb?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(N_&&(P_=N_?N_[1]:""),nf){var F_=L_();if(null!=F_&&F_>parseFloat(P_)){O_=String(F_);break e}}O_=P_}var rI=vn.document&&nf&&(L_()||parseInt(O_,10))||void 0;function bp(n,e){if(Qr.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,i=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(nI){e:{try{M_(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:sI[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&bp.$.h.call(this)}}Ur(bp,Qr);var sI={2:"touch",3:"pen",4:"mouse"};bp.prototype.h=function(){bp.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var rf="closure_listenable_"+(1e6*Math.random()|0),Os=0;function sf(n,e,t,i,r){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!i,this.la=r,this.key=++Os,this.fa=this.ia=!1}function B_(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function yb(n,e,t){for(const i in n)e.call(t,n[i],i,n)}function yR(n){const e={};for(const t in n)e[t]=n[t];return e}const vb="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function U_(n,e){let t,i;for(let r=1;r<arguments.length;r++){for(t in i=arguments[r],i)n[t]=i[t];for(let s=0;s<vb.length;s++)t=vb[s],Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t])}}function ru(n){this.src=n,this.g={},this.h=0}function bb(n,e){var t=e.type;if(t in n.g){var s,i=n.g[t],r=eI(i,e);(s=0<=r)&&Array.prototype.splice.call(i,r,1),s&&(B_(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function wp(n,e,t,i){for(var r=0;r<n.length;++r){var s=n[r];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==i)return r}return-1}ru.prototype.add=function(n,e,t,i,r){var s=n.toString();(n=this.g[s])||(n=this.g[s]=[],this.h++);var o=wp(n,e,i,r);return-1<o?(e=n[o],t||(e.ia=!1)):((e=new sf(e,this.src,s,!!i,r)).ia=t,n.push(e)),e};var wb="closure_lm_"+(1e6*Math.random()|0),V_={};function oI(n,e,t,i,r){if(i&&i.once)return $_(n,e,t,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)oI(n,e[s],t,i,r);return null}return t=Tb(t),n&&n[rf]?n.O(e,t,yp(i)?!!i.capture:!!i,r):aI(n,e,t,!1,i,r)}function aI(n,e,t,i,r,s){if(!e)throw Error("Invalid event type");var o=yp(r)?!!r.capture:!!r,c=lI(n);if(c||(n[wb]=c=new ru(n)),(t=c.add(e,t,i,o,s)).proxy)return t;if(i=function vR(){const e=xb;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=i,i.src=n,i.listener=t,n.addEventListener)hb||(r=o),void 0===r&&(r=!1),n.addEventListener(e.toString(),i,r);else if(n.attachEvent)n.attachEvent(Ep(e.toString()),i);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(i)}return t}function $_(n,e,t,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)$_(n,e[s],t,i,r);return null}return t=Tb(t),n&&n[rf]?n.P(e,t,yp(i)?!!i.capture:!!i,r):aI(n,e,t,!0,i,r)}function Eb(n,e,t,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)Eb(n,e[s],t,i,r);else i=yp(i)?!!i.capture:!!i,t=Tb(t),n&&n[rf]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=wp(s=n.g[e],t,i,r))&&(B_(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete n.g[e],n.h--))):n&&(n=lI(n))&&(e=n.g[e.toString()],n=-1,e&&(n=wp(e,t,i,r)),(t=-1<n?e[n]:null)&&H_(t))}function H_(n){if("number"!=typeof n&&n&&!n.fa){var e=n.src;if(e&&e[rf])bb(e.i,n);else{var t=n.type,i=n.proxy;e.removeEventListener?e.removeEventListener(t,i,n.capture):e.detachEvent?e.detachEvent(Ep(t),i):e.addListener&&e.removeListener&&e.removeListener(i),(t=lI(e))?(bb(t,n),0==t.h&&(t.src=null,e[wb]=null)):B_(n)}}}function Ep(n){return n in V_?V_[n]:V_[n]="on"+n}function xb(n,e){if(n.fa)n=!0;else{e=new bp(e,this);var t=n.listener,i=n.la||n.src;n.ia&&H_(n),n=t.call(i,e)}return n}function lI(n){return(n=n[wb])instanceof ru?n:null}var j_="__closure_events_fn_"+(1e9*Math.random()>>>0);function Tb(n){return"function"==typeof n?n:(n[j_]||(n[j_]=function(e){return n.handleEvent(e)}),n[j_])}function Ar(){Pa.call(this),this.i=new ru(this),this.S=this,this.J=null}function Zi(n,e){var t,i=n.J;if(i)for(t=[];i;i=i.J)t.push(i);if(n=n.S,i=e.type||e,"string"==typeof e)e=new Qr(e,n);else if(e instanceof Qr)e.target=e.target||n;else{var r=e;U_(e=new Qr(i,n),r)}if(r=!0,t)for(var s=t.length-1;0<=s;s--){var o=e.g=t[s];r=G_(o,i,!0,e)&&r}if(r=G_(o=e.g=n,i,!0,e)&&r,r=G_(o,i,!1,e)&&r,t)for(s=0;s<t.length;s++)r=G_(o=e.g=t[s],i,!1,e)&&r}function G_(n,e,t,i){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==t){var c=o.listener,d=o.la||o.src;o.ia&&bb(n.i,o),r=!1!==c.call(d,i)&&r}}return r&&!i.defaultPrevented}Ur(Ar,Pa),Ar.prototype[rf]=!0,Ar.prototype.removeEventListener=function(n,e,t,i){Eb(this,n,e,t,i)},Ar.prototype.N=function(){if(Ar.$.N.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],i=0;i<t.length;i++)B_(t[i]);delete n.g[e],n.h--}}this.J=null},Ar.prototype.O=function(n,e,t,i){return this.i.add(String(n),e,!1,t,i)},Ar.prototype.P=function(n,e,t,i){return this.i.add(String(n),e,!0,t,i)};var z_=vn.JSON.stringify;function WL(){var n=Sb;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var wR=new class Ib{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new ER,n=>n.reset());class ER{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function xR(n){var e=1;n=n.split(":");const t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function TR(n){vn.setTimeout(()=>{throw n},0)}let af,lf=!1,Sb=new class bR{constructor(){this.h=this.g=null}add(e,t){const i=wR.get();i.set(e,t),this.h?this.h.next=i:this.g=i,this.h=i}},Cb=()=>{const n=vn.Promise.resolve(void 0);af=()=>{n.then(cI)}};var cI=()=>{for(var n;n=WL();){try{n.h.call(n.g)}catch(t){TR(t)}var e=wR;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}lf=!1};function W_(n,e){Ar.call(this),this.h=n||1,this.g=e||vn,this.j=ms(this.qb,this),this.l=Date.now()}function Db(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}function K_(n,e,t){if("function"==typeof n)t&&(n=ms(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=ms(n.handleEvent,n)}return 2147483647<Number(e)?-1:vn.setTimeout(n,e||0)}function uI(n){n.g=K_(()=>{n.g=null,n.i&&(n.i=!1,uI(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}Ur(W_,Ar),(gt=W_.prototype).ga=!1,gt.T=null,gt.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Zi(this,"tick"),this.ga&&(Db(this),this.start()))}},gt.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},gt.N=function(){W_.$.N.call(this),Db(this),delete this.g};class dI extends Pa{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:uI(this)}N(){super.N(),this.g&&(vn.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function cf(n){Pa.call(this),this.h=n,this.g={}}Ur(cf,Pa);var Ab=[];function Rb(n,e,t,i){Array.isArray(t)||(t&&(Ab[0]=t.toString()),t=Ab);for(var r=0;r<t.length;r++){var s=oI(e,t[r],i||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function hI(n){yb(n.g,function(e,t){this.g.hasOwnProperty(t)&&H_(e)},n),n.g={}}function q_(){this.g=!0}function xp(n,e,t,i){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function YL(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var i=t[n];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return z_(t)}catch{return e}}(n,t)+(i?" "+i:"")})}cf.prototype.N=function(){cf.$.N.call(this),hI(this)},cf.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},q_.prototype.Ea=function(){this.g=!1},q_.prototype.info=function(){};var uf={},IR=null;function kb(){return IR=IR||new Ar}function SR(n){Qr.call(this,uf.Ta,n)}function Y_(n){const e=kb();Zi(e,new SR(e))}function Tp(n,e){Qr.call(this,uf.STAT_EVENT,n),this.stat=e}function Js(n){const e=kb();Zi(e,new Tp(e,n))}function Mb(n,e){Qr.call(this,uf.Ua,n),this.size=e}function su(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return vn.setTimeout(function(){n()},e)}uf.Ta="serverreachability",Ur(SR,Qr),uf.STAT_EVENT="statevent",Ur(Tp,Qr),uf.Ua="timingevent",Ur(Mb,Qr);var Ip={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Lb={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function mI(){}function Ob(){}mI.prototype.h=null;var Nb,Sp={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function pI(){Qr.call(this,"d")}function Pb(){Qr.call(this,"c")}function Q_(){}function ou(n,e,t,i){this.l=n,this.j=e,this.m=t,this.W=i||1,this.U=new cf(this),this.P=ZL,this.V=new W_(n=pb?125:void 0),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new gI}function gI(){this.i=null,this.g="",this.h=!1}Ur(pI,Qr),Ur(Pb,Qr),Ur(Q_,mI),Q_.prototype.g=function(){return new XMLHttpRequest},Q_.prototype.i=function(){return{}},Nb=new Q_;var ZL=45e3,_I={},Fb={};function Bb(n,e,t){n.L=1,n.v=Ap(ic(e)),n.s=t,n.S=!0,yI(n,null)}function yI(n,e){n.G=Date.now(),df(n),n.A=ic(n.v);var t=n.A,i=n.W;Array.isArray(i)||(i=[String(i)]),II(t.i,"t",i),n.C=0,t=n.l.J,n.h=new gI,n.g=UI(n.l,t?e:null,!n.s),0<n.O&&(n.M=new dI(ms(n.Pa,n,n.g),n.O)),Rb(n.U,n.g,"readystatechange",n.nb),e=n.I?yR(n.I):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.A,n.u,n.s,e)):(n.u="GET",n.g.ha(n.A,n.u,null,e)),Y_(),function KL(n,e,t,i,r,s){n.info(function(){if(n.g)if(s)for(var o="",c=s.split("&"),d=0;d<c.length;d++){var m=c[d].split("=");if(1<m.length){var g=m[0];m=m[1];var v=g.split("_");o=2<=v.length&&"type"==v[1]?o+(g+"=")+m+"&":o+(g+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+t+"\n"+o})}(n.j,n.u,n.A,n.m,n.W,n.s)}function vI(n){return!!n.g&&"GET"==n.u&&2!=n.L&&n.l.Ha}function CR(n,e,t){let r,i=!0;for(;!n.J&&n.C<t.length;){if(r=DR(n,t),r==Fb){4==e&&(n.o=4,Js(14),i=!1),xp(n.j,n.m,null,"[Incomplete Response]");break}if(r==_I){n.o=4,Js(15),xp(n.j,n.m,t,"[Invalid Chunk]"),i=!1;break}xp(n.j,n.m,r,null),Cp(n,r)}vI(n)&&r!=Fb&&r!=_I&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,Js(16),i=!1),n.i=n.i&&i,i?0<t.length&&!n.ba&&(n.ba=!0,(e=n.l).g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),Zb(e),e.M=!0,Js(11))):(xp(n.j,n.m,t,"[Invalid Chunked Response]"),ud(n),Ps(n))}function DR(n,e){var t=n.C,i=e.indexOf("\n",t);return-1==i?Fb:(t=Number(e.substring(t,i)),isNaN(t)?_I:(i+=1)+t>e.length?Fb:(e=e.slice(i,i+t),n.C=i+t,e))}function df(n){n.Y=Date.now()+n.P,Ub(n,n.P)}function Ub(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=su(ms(n.lb,n),e)}function Vb(n){n.B&&(vn.clearTimeout(n.B),n.B=null)}function Ps(n){0==n.l.H||n.J||FI(n.l,n)}function ud(n){Vb(n);var e=n.M;e&&"function"==typeof e.sa&&e.sa(),n.M=null,Db(n.V),hI(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function Cp(n,e){try{var t=n.l;if(0!=t.H&&(t.g==n||X_(t.i,n)))if(!n.K&&X_(t.i,n)&&3==t.H){try{var i=t.Ja.g.parse(e)}catch{i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<n.G))break e;ly(t),iy(t)}ay(t),Js(18)}}else t.Fa=r[1],0<t.Fa-t.V&&37500>r[2]&&t.G&&0==t.A&&!t.v&&(t.v=su(ms(t.ib,t),6e3));if(1>=SI(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else cu(t,11)}else if((n.K||t.g==n)&&ly(t),!ef(e))for(r=t.Ja.g.parse(e),e=0;e<r.length;e++){let m=r[e];if(t.V=m[0],m=m[1],2==t.H)if("c"==m[0]){t.K=m[1],t.pa=m[2];const g=m[3];null!=g&&(t.ra=g,t.l.info("VER="+t.ra));const v=m[4];null!=v&&(t.Ga=v,t.l.info("SVER="+t.Ga));const E=m[5];null!=E&&"number"==typeof E&&0<E&&(t.L=i=1.5*E,t.l.info("backChannelRequestTimeoutMs_="+i)),i=t;const T=n.g;if(T){const C=T.g?T.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(C){var s=i.i;s.g||-1==C.indexOf("spdy")&&-1==C.indexOf("quic")&&-1==C.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(CI(s,s.h),s.h=null))}if(i.F){const k=T.g?T.g.getResponseHeader("X-HTTP-Session-Id"):null;k&&(i.Da=k,xi(i.I,i.F,k))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms"));var o=n;if((i=t).wa=BI(i,i.J?i.pa:null,i.Y),o.K){J_(i.i,o);var c=o,d=i.L;d&&c.setTimeout(d),c.B&&(Vb(c),df(c)),i.g=o}else $R(i);0<t.j.length&&gf(t)}else"stop"!=m[0]&&"close"!=m[0]||cu(t,7);else 3==t.H&&("stop"==m[0]||"close"==m[0]?"stop"==m[0]?cu(t,7):Mp(t):"noop"!=m[0]&&t.h&&t.h.Aa(m),t.A=0)}Y_()}catch{}}function So(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(iu(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function QL(n){if(n.ta&&"function"==typeof n.ta)return n.ta();if(!n.Z||"function"!=typeof n.Z){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(iu(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const i in n)e[t++]=i;return e}}}(n),i=function AR(n){if(n.Z&&"function"==typeof n.Z)return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(iu(n)){for(var e=[],t=n.length,i=0;i<t;i++)e.push(n[i]);return e}for(i in e=[],t=0,n)e[t++]=n[i];return e}(n),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],t&&t[s],n)}(gt=ou.prototype).setTimeout=function(n){this.P=n},gt.nb=function(n){n=n.target;const e=this.M;e&&3==Co(n)?e.l():this.Pa(n)},gt.Pa=function(n){try{if(n==this.g)e:{const g=Co(this.g);var e=this.g.Ia();if(this.g.da(),!(3>g)&&(3!=g||pb||this.g&&(this.h.h||this.g.ja()||PI(this.g)))){this.J||4!=g||7==e||Y_(),Vb(this);var t=this.g.da();this.ca=t;t:if(vI(this)){var i=PI(this.g);n="";var r=i.length,s=4==Co(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){ud(this),Ps(this);var o="";break t}this.h.i=new vn.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,n+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.splice(0,r),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==t,function fI(n,e,t,i,r,s,o){n.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+t+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.W,g,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var c,d=this.g;if((c=d.g?d.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ef(c)){var m=c;break t}}m=null}if(!(t=m)){this.i=!1,this.o=3,Js(12),ud(this),Ps(this);break e}xp(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Cp(this,t)}this.S?(CR(this,g,o),pb&&this.i&&3==g&&(Rb(this.U,this.V,"tick",this.mb),this.V.start())):(xp(this.j,this.m,o,null),Cp(this,o)),4==g&&ud(this),this.i&&!this.J&&(4==g?FI(this.l,this):(this.i=!1,df(this)))}else(function BR(n){const e={};n=(n.g&&2<=Co(n)&&n.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<n.length;i++){if(ef(n[i]))continue;var t=xR(n[i]);const r=t[0];if("string"!=typeof(t=t[1]))continue;t=t.trim();const s=e[r]||[];e[r]=s,s.push(t)}!function zL(n,e){for(const t in n)e.call(void 0,n[t],t,n)}(e,function(i){return i.join(", ")})})(this.g),400==t&&0<o.indexOf("Unknown SID")?(this.o=3,Js(12)):(this.o=0,Js(13)),ud(this),Ps(this)}}}catch{}},gt.mb=function(){if(this.g){var n=Co(this.g),e=this.g.ja();this.C<e.length&&(Vb(this),CR(this,n,e),this.i&&4!=n&&df(this))}},gt.cancel=function(){this.J=!0,ud(this)},gt.lb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(function qL(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.L&&(Y_(),Js(17)),ud(this),this.o=2,Ps(this)):Ub(this,this.Y-n)};var bI=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function dd(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof dd){this.h=n.h,hf(this,n.j),this.s=n.s,this.g=n.g,Dp(this,n.m),this.l=n.l;var e=n.i,t=new hd;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),Hb(this,t),this.o=n.o}else n&&(e=String(n).match(bI))?(this.h=!1,hf(this,e[1]||"",!0),this.s=ff(e[2]||""),this.g=ff(e[3]||"",!0),Dp(this,e[4]),this.l=ff(e[5]||"",!0),Hb(this,e[6]||"",!0),this.o=ff(e[7]||"")):(this.h=!1,this.i=new hd(null,this.h))}function ic(n){return new dd(n)}function hf(n,e,t){n.j=t?ff(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function Dp(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function Hb(n,e,t){e instanceof hd?(n.i=e,function kR(n,e){e&&!n.j&&(sc(n),n.i=null,n.g.forEach(function(t,i){var r=i.toLowerCase();i!=r&&(TI(this,i),II(this,r,t))},n)),n.j=e}(n.i,n.h)):(t||(e=Rp(e,au)),n.i=new hd(e,n.h))}function xi(n,e,t){n.i.set(e,t)}function Ap(n){return xi(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function ff(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function Rp(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,wI),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function wI(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}dd.prototype.toString=function(){var n=[],e=this.j;e&&n.push(Rp(e,EI,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(Rp(e,EI,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(Rp(t,"/"==t.charAt(0)?rc:jb,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",Rp(t,xI)),n.join("")};var EI=/[#\/\?@]/g,jb=/[#\?:]/g,rc=/[#\?]/g,au=/[#\?@]/g,xI=/#/g;function hd(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function sc(n){n.g||(n.g=new Map,n.h=0,n.i&&function $b(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var i=n[t].indexOf("="),r=null;if(0<=i){var s=n[t].substring(0,i);r=n[t].substring(i+1)}else s=n[t];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function TI(n,e){sc(n),e=mf(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function RR(n,e){return sc(n),e=mf(n,e),n.g.has(e)}function II(n,e,t){TI(n,e),0<t.length&&(n.i=null,n.g.set(mf(n,e),ub(t)),n.h+=t.length)}function mf(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function Gb(n){this.l=n||XL,n=vn.PerformanceNavigationTiming?0<(n=vn.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(vn.g&&vn.g.Ka&&vn.g.Ka()&&vn.g.Ka().ec),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(gt=hd.prototype).add=function(n,e){sc(this),this.i=null,n=mf(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},gt.forEach=function(n,e){sc(this),this.g.forEach(function(t,i){t.forEach(function(r){n.call(e,r,i,this)},this)},this)},gt.ta=function(){sc(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let i=0;i<e.length;i++){const r=n[i];for(let s=0;s<r.length;s++)t.push(e[i])}return t},gt.Z=function(n){sc(this);let e=[];if("string"==typeof n)RR(this,n)&&(e=e.concat(this.g.get(mf(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},gt.set=function(n,e){return sc(this),this.i=null,RR(this,n=mf(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},gt.get=function(n,e){return n&&0<(n=this.Z(n)).length?String(n[0]):e},gt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var i=e[t];const s=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),n.push(r)}}return this.i=n.join("&")};var XL=10;function zb(n){return!!n.h||!!n.g&&n.g.size>=n.j}function SI(n){return n.h?1:n.g?n.g.size:0}function X_(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function CI(n,e){n.g?n.g.add(e):n.h=e}function J_(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function Wb(n){if(null!=n.h)return n.i.concat(n.h.F);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return ub(n.i)}Gb.prototype.cancel=function(){if(this.i=Wb(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}};var DI=class{stringify(n){return vn.JSON.stringify(n,void 0)}parse(n){return vn.JSON.parse(n,void 0)}};function AI(){this.g=new DI}function RI(n,e,t){const i=t||"";try{So(n,function(r,s){let o=r;yp(r)&&(o=z_(r)),e.push(i+s+"="+encodeURIComponent(o))})}catch(r){throw e.push(i+"type="+encodeURIComponent("_badmap")),r}}function fd(n,e,t,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch{}}function lu(n){this.l=n.fc||null,this.j=n.ob||!1}function kp(n,e){Ar.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=Kb,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ur(lu,mI),lu.prototype.g=function(){return new kp(this.l,this.j)},lu.prototype.i=function(n){return function(){return n}}({}),Ur(kp,Ar);var Kb=0;function MI(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}function ey(n){n.readyState=4,n.l=null,n.j=null,n.A=null,ty(n)}function ty(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(gt=kp.prototype).open=function(n,e){if(this.readyState!=Kb)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,ty(this)},gt.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||vn).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},gt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,ey(this)),this.readyState=Kb},gt.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,ty(this)),this.g&&(this.readyState=3,ty(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof vn.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;MI(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))},gt.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?ey(this):ty(this),3==this.readyState&&MI(this)}},gt.Za=function(n){this.g&&(this.response=this.responseText=n,ey(this))},gt.Ya=function(n){this.g&&(this.response=n,ey(this))},gt.ka=function(){this.g&&ey(this)},gt.setRequestHeader=function(n,e){this.v.append(n,e)},gt.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},gt.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(kp.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var JL=vn.JSON.parse;function Vi(n){Ar.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=LI,this.L=this.M=!1}Ur(Vi,Ar);var LI="",LR=/^https?$/i,OR=["POST","PUT"];function PR(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,NR(n),qb(n)}function NR(n){n.F||(n.F=!0,Zi(n,"complete"),Zi(n,"error"))}function FR(n){if(n.h&&typeof lb<"u"&&(!n.C[1]||4!=Co(n)||2!=n.da()))if(n.v&&4==Co(n))K_(n.La,0,n);else if(Zi(n,"readystatechange"),4==Co(n)){n.h=!1;try{const o=n.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var i;if(i=0===o){var r=String(n.I).match(bI)[1]||null;!r&&vn.self&&vn.self.location&&(r=vn.self.location.protocol.slice(0,-1)),i=!LR.test(r?r.toLowerCase():"")}t=i}if(t)Zi(n,"complete"),Zi(n,"success");else{n.m=6;try{var s=2<Co(n)?n.g.statusText:""}catch{s=""}n.j=s+" ["+n.da()+"]",NR(n)}}finally{qb(n)}}}function qb(n,e){if(n.g){OI(n);const t=n.g,i=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||Zi(n,"ready");try{t.onreadystatechange=i}catch{}}}function OI(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(vn.clearTimeout(n.A),n.A=null)}function Co(n){return n.g?n.g.readyState:0}function PI(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case LI:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function Yb(n){let e="";return yb(n,function(t,i){e+=i,e+=":",e+=t,e+="\r\n"}),e}function oc(n,e,t){e:{for(i in t){var i=!1;break e}i=!0}i||(t=Yb(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):xi(n,e,t))}function pf(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function ny(n){this.Ga=0,this.j=[],this.l=new q_,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=pf("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=pf("baseRetryDelayMs",5e3,n),this.hb=pf("retryDelaySeedMs",1e4,n),this.eb=pf("forwardChannelMaxRetries",2,n),this.xa=pf("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.dc||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new Gb(n&&n.concurrentRequestLimit),this.Ja=new AI,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Mp(n){if(ry(n),3==n.H){var e=n.W++,t=ic(n.I);if(xi(t,"SID",n.K),xi(t,"RID",e),xi(t,"TYPE","terminate"),oy(n,t),(e=new ou(n,n.l,e)).L=2,e.v=Ap(ic(t)),t=!1,vn.navigator&&vn.navigator.sendBeacon)try{t=vn.navigator.sendBeacon(e.v.toString(),"")}catch{}!t&&vn.Image&&((new Image).src=e.v,t=!0),t||(e.g=UI(e.l,null),e.g.ha(e.v)),e.G=Date.now(),df(e)}Xb(n)}function iy(n){n.g&&(Zb(n),n.g.cancel(),n.g=null)}function ry(n){iy(n),n.u&&(vn.clearTimeout(n.u),n.u=null),ly(n),n.i.cancel(),n.m&&("number"==typeof n.m&&vn.clearTimeout(n.m),n.m=null)}function gf(n){if(!zb(n.i)&&!n.m){n.m=!0;var e=n.Na;af||Cb(),lf||(af(),lf=!0),Sb.add(e,n),n.C=0}}function UR(n,e){var t;t=e?e.m:n.W++;const i=ic(n.I);xi(i,"SID",n.K),xi(i,"RID",t),xi(i,"AID",n.V),oy(n,i),n.o&&n.s&&oc(i,n.o,n.s),t=new ou(n,n.l,t,n.C+1),null===n.o&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=VR(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),CI(n.i,t),Bb(t,i,e)}function oy(n,e){n.na&&yb(n.na,function(t,i){xi(e,i,t)}),n.h&&So({},function(t,i){xi(e,i,t)})}function VR(n,e,t){t=Math.min(n.j.length,t);var i=n.h?ms(n.h.Va,n.h,n):null;e:{var r=n.j;let s=-1;for(;;){const o=["count="+t];-1==s?0<t?(s=r[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let c=!0;for(let d=0;d<t;d++){let m=r[d].g;const g=r[d].map;if(m-=s,0>m)s=Math.max(0,r[d].g-100),c=!1;else try{RI(g,o,"req"+m+"_")}catch{i&&i(g)}}if(c){i=o.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,i}function $R(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;af||Cb(),lf||(af(),lf=!0),Sb.add(e,n),n.A=0}}function ay(n){return!(n.g||n.u||3<=n.A||(n.ba++,n.u=su(ms(n.Ma,n),Qb(n,n.A)),n.A++,0))}function Zb(n){null!=n.B&&(vn.clearTimeout(n.B),n.B=null)}function NI(n){n.g=new ou(n,n.l,"rpc",n.ba),null===n.o&&(n.g.I=n.s),n.g.O=0;var e=ic(n.wa);xi(e,"RID","rpc"),xi(e,"SID",n.K),xi(e,"AID",n.V),xi(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&xi(e,"TO",n.qa),xi(e,"TYPE","xmlhttp"),oy(n,e),n.o&&n.s&&oc(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.v=Ap(ic(e)),t.s=null,t.S=!0,yI(t,n)}function ly(n){null!=n.v&&(vn.clearTimeout(n.v),n.v=null)}function FI(n,e){var t=null;if(n.g==e){ly(n),Zb(n),n.g=null;var i=2}else{if(!X_(n.i,e))return;t=e.F,J_(n.i,e),i=1}if(0!=n.H)if(e.i)if(1==i){t=e.s?e.s.length:0,e=Date.now()-e.G;var r=n.C;Zi(i=kb(),new Mb(i,t)),gf(n)}else $R(n);else if(3==(r=e.o)||0==r&&0<e.ca||!(1==i&&function sy(n,e){return!(SI(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.j=e.F.concat(n.j),0):1==n.H||2==n.H||n.C>=(n.cb?0:n.eb)||(n.m=su(ms(n.Na,n,e),Qb(n,n.C)),n.C++,0)))}(n,e)||2==i&&ay(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),r){case 1:cu(n,5);break;case 4:cu(n,10);break;case 3:cu(n,6);break;default:cu(n,2)}}function Qb(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function cu(n,e){if(n.l.info("Error code "+e),2==e){var t=null;n.h&&(t=null);var i=ms(n.pb,n);t||(t=new dd("//www.google.com/images/cleardot.gif"),vn.location&&"http"==vn.location.protocol||hf(t,"https"),Ap(t)),function kI(n,e){const t=new q_;if(vn.Image){const i=new Image;i.onload=R_(fd,t,i,"TestLoadImage: loaded",!0,e),i.onerror=R_(fd,t,i,"TestLoadImage: error",!1,e),i.onabort=R_(fd,t,i,"TestLoadImage: abort",!1,e),i.ontimeout=R_(fd,t,i,"TestLoadImage: timeout",!1,e),vn.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n}else e(!1)}(t.toString(),i)}else Js(2);n.H=0,n.h&&n.h.za(e),Xb(n),ry(n)}function Xb(n){if(n.H=0,n.ma=[],n.h){const e=Wb(n.i);(0!=e.length||0!=n.j.length)&&(db(n.ma,e),db(n.ma,n.j),n.i.i.length=0,ub(n.j),n.j.length=0),n.h.ya()}}function BI(n,e,t){var i=t instanceof dd?ic(t):new dd(t);if(""!=i.g)e&&(i.g=e+"."+i.g),Dp(i,i.m);else{var r=vn.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new dd(null);i&&hf(s,i),e&&(s.g=e),r&&Dp(s,r),t&&(s.l=t),i=s}return e=n.Da,(t=n.F)&&e&&xi(i,t,e),xi(i,"VER",n.ra),oy(n,i),i}function UI(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Vi(t&&n.Ha&&!n.va?new lu({ob:!0}):n.va)).Oa(n.J),e}function Jb(){}function _f(){if(nf&&!(10<=Number(rI)))throw Error("Environmental error: no available transport.")}function Xo(n,e){Ar.call(this),this.g=new ny(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!ef(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ef(e)&&(this.g.F=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new yf(this)}function ew(n){pI.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function cy(){Pb.call(this),this.status=1}function yf(n){this.g=n}function ml(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function VI(n,e,t){t||(t=0);var i=Array(16);if("string"==typeof e)for(var r=0;16>r;++r)i[r]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(r=0;16>r;++r)i[r]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var s=n.g[3],o=(e=n.g[0])+(s^(t=n.g[1])&((r=n.g[2])^s))+i[0]+3614090360&4294967295;o=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=t+(o<<7&4294967295|o>>>25))+((o=s+(r^e&(t^r))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(t^s&(e^t))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^r&(s^e))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(r^s))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(t^r))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(t^s&(e^t))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^r&(s^e))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(r^s))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(t^r))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(t^s&(e^t))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^r&(s^e))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(r^s))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(t^r))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(t^s&(e^t))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^r&(s^e))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^s&(t^r))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^r&(e^t))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^t&(s^e))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(r^s))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(t^r))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^r&(e^t))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^t&(s^e))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(r^s))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(t^r))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^r&(e^t))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^t&(s^e))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(r^s))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(t^r))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^r&(e^t))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^t&(s^e))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(r^s))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(t^r^s)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^r)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^t)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=t+(r^s^e)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^r^s)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^r)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^t)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=t+(r^s^e)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^r^s)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^r)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^t)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=t+(r^s^e)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^r^s)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^r)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^t)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=t+(r^s^e)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(r^(t|~s))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~r))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~t))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(r|~e))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(t|~s))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~r))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~t))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(r|~e))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(t|~s))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~r))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~t))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(r|~e))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=t+((o=e+(r^(t|~s))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~r))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(e^(s|~t))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+i[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,n.g[2]=n.g[2]+r&4294967295,n.g[3]=n.g[3]+s&4294967295}function li(n,e){this.h=e;for(var t=[],i=!0,r=n.length-1;0<=r;r--){var s=0|n[r];i&&s==e||(t[r]=s,i=!1)}this.g=t}(gt=Vi.prototype).Oa=function(n){this.M=n},gt.ha=function(n,e,t,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Nb.g(),this.C=function Z_(n){return n.h||(n.h=n.i())}(this.u?this.u:Nb),this.g.onreadystatechange=ms(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(s){return void PR(this,s)}if(n=t||"",t=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)t.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const s of i.keys())t.set(s,i.get(s))}i=Array.from(t.keys()).find(s=>"content-type"==s.toLowerCase()),r=vn.FormData&&n instanceof vn.FormData,!(0<=eI(OR,e))||i||r||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of t)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{OI(this),0<this.B&&((this.L=function eO(n){return nf&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ms(this.ua,this)):this.A=K_(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){PR(this,s)}},gt.ua=function(){typeof lb<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Zi(this,"timeout"),this.abort(8))},gt.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,Zi(this,"complete"),Zi(this,"abort"),qb(this))},gt.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),qb(this,!0)),Vi.$.N.call(this)},gt.La=function(){this.s||(this.G||this.v||this.l?FR(this):this.kb())},gt.kb=function(){FR(this)},gt.isActive=function(){return!!this.g},gt.da=function(){try{return 2<Co(this)?this.g.status:-1}catch{return-1}},gt.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},gt.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),JL(e)}},gt.Ia=function(){return this.m},gt.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(gt=ny.prototype).ra=8,gt.H=1,gt.Na=function(n){if(this.m)if(this.m=null,1==this.H){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const r=new ou(this,this.l,n);let s=this.s;if(this.U&&(s?(s=yR(s),U_(s,this.U)):s=this.U),null!==this.o||this.O||(r.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){var i=this.j[t];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=t;break e}if(4096===e||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=VR(this,r,e),xi(t=ic(this.I),"RID",n),xi(t,"CVER",22),this.F&&xi(t,"X-HTTP-Session-Id",this.F),oy(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(Yb(s)))+"&"+e:this.o&&oc(t,this.o,s)),CI(this.i,r),this.bb&&xi(t,"TYPE","init"),this.P?(xi(t,"$req",e),xi(t,"SID","null"),r.aa=!0,Bb(r,t,null)):Bb(r,t,e),this.H=2}}else 3==this.H&&(n?UR(this,n):0==this.j.length||zb(this.i)||UR(this))},gt.Ma=function(){if(this.u=null,NI(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=su(ms(this.jb,this),n)}},gt.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Js(10),iy(this),NI(this))},gt.ib=function(){null!=this.v&&(this.v=null,iy(this),ay(this),Js(19))},gt.pb=function(n){n?(this.l.info("Successfully pinged google.com"),Js(2)):(this.l.info("Failed to ping google.com"),Js(1))},gt.isActive=function(){return!!this.h&&this.h.isActive(this)},(gt=Jb.prototype).Ba=function(){},gt.Aa=function(){},gt.za=function(){},gt.ya=function(){},gt.isActive=function(){return!0},gt.Va=function(){},_f.prototype.g=function(n,e){return new Xo(n,e)},Ur(Xo,Ar),Xo.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;Js(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=BI(n,null,n.Y),gf(n)},Xo.prototype.close=function(){Mp(this.g)},Xo.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=z_(n),n=t);e.j.push(new class{constructor(n,e){this.g=n,this.map=e}}(e.fb++,n)),3==e.H&&gf(e)},Xo.prototype.N=function(){this.g.h=null,delete this.j,Mp(this.g),delete this.g,Xo.$.N.call(this)},Ur(ew,pI),Ur(cy,Pb),Ur(yf,Jb),yf.prototype.Ba=function(){Zi(this.g,"a")},yf.prototype.Aa=function(n){Zi(this.g,new ew(n))},yf.prototype.za=function(n){Zi(this.g,new cy)},yf.prototype.ya=function(){Zi(this.g,"b")},Ur(ml,function HR(){this.blockSize=-1}),ml.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},ml.prototype.j=function(n,e){void 0===e&&(e=n.length);for(var t=e-this.blockSize,i=this.m,r=this.h,s=0;s<e;){if(0==r)for(;s<=t;)VI(this,n,s),s+=this.blockSize;if("string"==typeof n){for(;s<e;)if(i[r++]=n.charCodeAt(s++),r==this.blockSize){VI(this,i),r=0;break}}else for(;s<e;)if(i[r++]=n[s++],r==this.blockSize){VI(this,i),r=0;break}}this.h=r,this.i+=e},ml.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=255&t,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var i=0;32>i;i+=8)n[t++]=this.g[e]>>>i&255;return n};var jR={};function tw(n){return-128<=n&&128>n?function fb(n,e){var t=jR;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}(n,function(e){return new li([0|e],0>e?-1:0)}):new li([0|n],0>n?-1:0)}function ac(n){if(isNaN(n)||!isFinite(n))return Lp;if(0>n)return ps(ac(-n));for(var e=[],t=1,i=0;n>=t;i++)e[i]=n/t|0,t*=$I;return new li(e,0)}var $I=4294967296,Lp=tw(0),nw=tw(1),zR=tw(16777216);function uu(n){if(0!=n.h)return!1;for(var e=0;e<n.g.length;e++)if(0!=n.g[e])return!1;return!0}function Na(n){return-1==n.h}function ps(n){for(var e=n.g.length,t=[],i=0;i<e;i++)t[i]=~n.g[i];return new li(t,~n.h).add(nw)}function iw(n,e){return n.add(ps(e))}function rw(n,e){for(;(65535&n[e])!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function a(n,e){this.g=n,this.h=e}function l(n,e){if(uu(e))throw Error("division by zero");if(uu(n))return new a(Lp,Lp);if(Na(n))return e=l(ps(n),e),new a(ps(e.g),ps(e.h));if(Na(e))return e=l(n,ps(e)),new a(ps(e.g),e.h);if(30<n.g.length){if(Na(n)||Na(e))throw Error("slowDivide_ only works with positive integers.");for(var t=nw,i=e;0>=i.X(n);)t=u(t),i=u(i);var r=f(t,1),s=f(i,1);for(i=f(i,2),t=f(t,2);!uu(i);){var o=s.add(i);0>=o.X(n)&&(r=r.add(t),s=o),i=f(i,1),t=f(t,1)}return e=iw(n,r.R(e)),new a(r,e)}for(r=Lp;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),i=48>=(i=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,i-48),o=(s=ac(t)).R(e);Na(o)||0<o.X(n);)o=(s=ac(t-=i)).R(e);uu(s)&&(s=nw),r=r.add(s),n=iw(n,o)}return new a(r,n)}function u(n){for(var e=n.g.length+1,t=[],i=0;i<e;i++)t[i]=n.D(i)<<1|n.D(i-1)>>>31;return new li(t,n.h)}function f(n,e){var t=e>>5;e%=32;for(var i=n.g.length-t,r=[],s=0;s<i;s++)r[s]=0<e?n.D(s+t)>>>e|n.D(s+t+1)<<32-e:n.D(s+t);return new li(r,n.h)}(gt=li.prototype).ea=function(){if(Na(this))return-ps(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var i=this.D(t);n+=(0<=i?i:$I+i)*e,e*=$I}return n},gt.toString=function(n){if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if(uu(this))return"0";if(Na(this))return"-"+ps(this).toString(n);for(var e=ac(Math.pow(n,6)),t=this,i="";;){var r=l(t,e).g,s=((0<(t=iw(t,r.R(e))).g.length?t.g[0]:t.h)>>>0).toString(n);if(uu(t=r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}},gt.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h},gt.X=function(n){return Na(n=iw(this,n))?-1:uu(n)?0:1},gt.abs=function(){return Na(this)?ps(this):this},gt.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0,r=0;r<=e;r++){var s=i+(65535&this.D(r))+(65535&n.D(r)),o=(s>>>16)+(this.D(r)>>>16)+(n.D(r)>>>16);i=o>>>16,t[r]=(o&=65535)<<16|(s&=65535)}return new li(t,-2147483648&t[t.length-1]?-1:0)},gt.R=function(n){if(uu(this)||uu(n))return Lp;if(Na(this))return Na(n)?ps(this).R(ps(n)):ps(ps(this).R(n));if(Na(n))return ps(this.R(ps(n)));if(0>this.X(zR)&&0>n.X(zR))return ac(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],i=0;i<2*e;i++)t[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<n.g.length;r++){var s=this.D(i)>>>16,o=65535&this.D(i),c=n.D(r)>>>16,d=65535&n.D(r);t[2*i+2*r]+=o*d,rw(t,2*i+2*r),t[2*i+2*r+1]+=s*d,rw(t,2*i+2*r+1),t[2*i+2*r+1]+=o*c,rw(t,2*i+2*r+1),t[2*i+2*r+2]+=s*c,rw(t,2*i+2*r+2)}for(i=0;i<e;i++)t[i]=t[2*i+1]<<16|t[2*i];for(i=e;i<2*e;i++)t[i]=0;return new li(t,0)},gt.gb=function(n){return l(this,n).h},gt.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0;i<e;i++)t[i]=this.D(i)&n.D(i);return new li(t,this.h&n.h)},gt.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0;i<e;i++)t[i]=this.D(i)|n.D(i);return new li(t,this.h|n.h)},gt.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0;i<e;i++)t[i]=this.D(i)^n.D(i);return new li(t,this.h^n.h)},_f.prototype.createWebChannel=_f.prototype.g,Xo.prototype.send=Xo.prototype.u,Xo.prototype.open=Xo.prototype.m,Xo.prototype.close=Xo.prototype.close,Ip.NO_ERROR=0,Ip.TIMEOUT=8,Ip.HTTP_ERROR=6,Lb.COMPLETE="complete",Ob.EventType=Sp,Sp.OPEN="a",Sp.CLOSE="b",Sp.ERROR="c",Sp.MESSAGE="d",Ar.prototype.listen=Ar.prototype.O,Vi.prototype.listenOnce=Vi.prototype.P,Vi.prototype.getLastError=Vi.prototype.Sa,Vi.prototype.getLastErrorCode=Vi.prototype.Ia,Vi.prototype.getStatus=Vi.prototype.da,Vi.prototype.getResponseJson=Vi.prototype.Wa,Vi.prototype.getResponseText=Vi.prototype.ja,Vi.prototype.send=Vi.prototype.ha,Vi.prototype.setWithCredentials=Vi.prototype.Oa,ml.prototype.digest=ml.prototype.l,ml.prototype.reset=ml.prototype.reset,ml.prototype.update=ml.prototype.j,li.prototype.add=li.prototype.add,li.prototype.multiply=li.prototype.R,li.prototype.modulo=li.prototype.gb,li.prototype.compare=li.prototype.X,li.prototype.toNumber=li.prototype.ea,li.prototype.toString=li.prototype.toString,li.prototype.getBits=li.prototype.D,li.fromNumber=ac,li.fromString=function GR(n,e){if(0==n.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==n.charAt(0))return ps(GR(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=ac(Math.pow(e,8)),i=Lp,r=0;r<n.length;r+=8){var s=Math.min(8,n.length-r),o=parseInt(n.substring(r,r+s),e);8>s?(s=ac(Math.pow(e,s)),i=i.R(s).add(ac(o))):i=(i=i.R(t)).add(ac(o))}return i};var ot,ft,Ot,rn,Ke,Ti,Qi,WR,tO,nO,iO,rO,sO,oO,aO,lO,cO,uO,dO,hO,fO,mO,pO,gO,_O,yO,vO,bO,wO,EO,xO,TO,IO,SO,CO,DO,AO,RO,kO,MO,LO,OO,PO,p=Oa.createWebChannelTransport=function(){return new _f},_=Oa.getStatEventTarget=function(){return kb()},w=Oa.ErrorCode=Ip,I=Oa.EventType=Lb,S=Oa.Event=uf,M=Oa.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},B=Oa.FetchXmlHttpFactory=lu,K=Oa.WebChannel=Ob,se=Oa.XhrIo=Vi,he=Oa.Md5=ml,ke=Oa.Integer=li;const NO="@firebase/firestore";class gs{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}gs.UNAUTHENTICATED=new gs(null),gs.GOOGLE_CREDENTIALS=new gs("google-credentials-uid"),gs.FIRST_PARTY=new gs("first-party-uid"),gs.MOCK_USER=new gs("mock-user");let uy="9.23.0";const vf=new nu.Yd("@firebase/firestore");function KR(){return vf.logLevel}function nt(n,...e){if(vf.logLevel<=nu.in.DEBUG){const t=e.map(qR);vf.debug(`Firestore (${uy}): ${n}`,...t)}}function Rr(n,...e){if(vf.logLevel<=nu.in.ERROR){const t=e.map(qR);vf.error(`Firestore (${uy}): ${n}`,...t)}}function pl(n,...e){if(vf.logLevel<=nu.in.WARN){const t=e.map(qR);vf.warn(`Firestore (${uy}): ${n}`,...t)}}function qR(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function Mt(n="Unexpected state"){const e=`FIRESTORE (${uy}) INTERNAL ASSERTION FAILED: `+n;throw Rr(e),new Error(e)}function Kt(n,e){n||Mt()}function _t(n,e){return n}const be={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ve extends An.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Xr{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class FO{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class n3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(gs.UNAUTHENTICATED))}shutdown(){}}class r3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class s3{constructor(e){this.t=e,this.currentUser=gs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var i=this;let r=this.i;const s=m=>this.i!==r?(r=this.i,t(m)):Promise.resolve();let o=new Xr;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Xr,e.enqueueRetryable(()=>s(this.currentUser))};const c=()=>{const m=o;e.enqueueRetryable((0,Te.Z)(function*(){yield m.promise,yield s(i.currentUser)}))},d=m=>{nt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.auth.addAuthTokenListener(this.o),c()};this.t.onInit(m=>d(m)),setTimeout(()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?d(m):(nt("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Xr)}},0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(nt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Kt("string"==typeof i.accessToken),new FO(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Kt(null===e||"string"==typeof e),new gs(e)}}class o3{constructor(e,t,i){this.h=e,this.l=t,this.m=i,this.type="FirstParty",this.user=gs.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class a3{constructor(e,t,i){this.h=e,this.l=t,this.m=i}getToken(){return Promise.resolve(new o3(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(gs.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class BO{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class l3{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const i=s=>{null!=s.error&&nt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.T;return this.T=s.token,nt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};const r=s=>{nt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.I.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.I.getImmediate({optional:!0});s?r(s):nt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Kt("string"==typeof t.token),this.T=t.token,new BO(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function c3(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class UO{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let i="";for(;i.length<20;){const r=c3(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%e.length))}return i}}function bn(n,e){return n<e?-1:n>e?1:0}function dy(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}function VO(n){return n+"\0"}class Xi{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ve(be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ve(be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Ve(be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ve(be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Xi.fromMillis(Date.now())}static fromDate(e){return Xi.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new Xi(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?bn(this.nanoseconds,e.nanoseconds):bn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class qt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new qt(e)}static min(){return new qt(new Xi(0,0))}static max(){return new qt(new Xi(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class sw{constructor(e,t,i){void 0===t?t=0:t>e.length&&Mt(),void 0===i?i=e.length-t:i>e.length-t&&Mt(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return 0===sw.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof sw?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=e.get(r),o=t.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Xn extends sw{construct(e,t,i){return new Xn(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ve(be.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new Xn(t)}static emptyPath(){return new Xn([])}}const u3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class wr extends sw{construct(e,t,i){return new wr(e,t,i)}static isValidIdentifier(e){return u3.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),wr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new wr(["__name__"])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(0===i.length)throw new Ve(be.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const c=e[r];if("\\"===c){if(r+1===e.length)throw new Ve(be.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[r+1];if("\\"!==d&&"."!==d&&"`"!==d)throw new Ve(be.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=d,r+=2}else"`"===c?(o=!o,r++):"."!==c||o?(i+=c,r++):(s(),r++)}if(s(),o)throw new Ve(be.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new wr(t)}static emptyPath(){return new wr([])}}class mt{constructor(e){this.path=e}static fromPath(e){return new mt(Xn.fromString(e))}static fromName(e){return new mt(Xn.fromString(e).popFirst(5))}static empty(){return new mt(Xn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Xn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Xn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new mt(new Xn(e.slice()))}}class HI{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function YR(n){return n.fields.find(e=>2===e.kind)}function Op(n){return n.fields.filter(e=>2!==e.kind)}HI.UNKNOWN_ID=-1;class jI{constructor(e,t){this.fieldPath=e,this.kind=t}}class ow{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new ow(0,Fa.min())}}function $O(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=qt.fromTimestamp(1e9===i?new Xi(t+1,0):new Xi(t,i));return new Fa(r,mt.empty(),e)}function HO(n){return new Fa(n.readTime,n.key,-1)}class Fa{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Fa(qt.min(),mt.empty(),-1)}static max(){return new Fa(qt.max(),mt.empty(),-1)}}function ZR(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=mt.comparator(n.documentKey,e.documentKey),0!==t?t:bn(n.largestBatchId,e.largestBatchId))}const jO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class GO{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function bf(n){return(ot=ot||(0,Te.Z)(function*(e){if(e.code!==be.FAILED_PRECONDITION||e.message!==jO)throw e;nt("LocalStore","Unexpectedly lost primary lease")})).apply(this,arguments)}class ge{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Mt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ge((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ge?t:ge.resolve(t)}catch(t){return ge.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ge.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ge.reject(t)}static resolve(e){return new ge((t,i)=>{t(e)})}static reject(e){return new ge((t,i)=>{i(e)})}static waitFor(e){return new ge((t,i)=>{let r=0,s=0,o=!1;e.forEach(c=>{++r,c.next(()=>{++s,o&&s===r&&t()},d=>i(d))}),o=!0,s===r&&t()})}static or(e){let t=ge.resolve(!1);for(const i of e)t=t.next(r=>r?ge.resolve(r):i());return t}static forEach(e,t){const i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new ge((i,r)=>{const s=e.length,o=new Array(s);let c=0;for(let d=0;d<s;d++){const m=d;t(e[m]).next(g=>{o[m]=g,++c,c===s&&i(o)},g=>r(g))}})}static doWhile(e,t){return new ge((i,r)=>{const s=()=>{!0===e()?t().next(()=>{s()},r):i()};s()})}}class GI{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.v=new Xr,this.transaction.oncomplete=()=>{this.v.resolve()},this.transaction.onabort=()=>{t.error?this.v.reject(new aw(e,t.error)):this.v.resolve()},this.transaction.onerror=i=>{const r=QR(i.target.error);this.v.reject(new aw(e,r))}}static open(e,t,i,r){try{return new GI(t,e.transaction(r,i))}catch(s){throw new aw(t,s)}}get R(){return this.v.promise}abort(e){e&&this.v.reject(e),this.aborted||(nt("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}P(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new m3(t)}}class lc{constructor(e,t,i){this.name=e,this.version=t,this.V=i,12.2===lc.S((0,An.z$)())&&Rr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return nt("SimpleDb","Removing database:",e),Pp(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,An.hl)())return!1;if(lc.C())return!0;const e=(0,An.z$)(),t=lc.S(e),i=0<t&&t<10,r=lc.N(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.k)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}static N(e){const t=e.match(/Android ([\d.]+)/i),i=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(i)}$(e){var t=this;return(0,Te.Z)(function*(){return t.db||(nt("SimpleDb","Opening database:",t.name),t.db=yield new Promise((i,r)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=o=>{i(o.target.result)},s.onblocked=()=>{r(new aw(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const c=o.target.error;r("VersionError"===c.name?new Ve(be.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===c.name?new Ve(be.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+c):new aw(e,c))},s.onupgradeneeded=o=>{nt("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',o.oldVersion),t.V.O(o.target.result,s.transaction,o.oldVersion,t.version).next(()=>{nt("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.F&&(t.db.onversionchange=i=>t.F(i)),t.db})()}B(e){this.F=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,i,r){var s=this;return(0,Te.Z)(function*(){const o="readonly"===t;let c=0;for(;;){++c;try{s.db=yield s.$(e);const d=GI.open(s.db,e,o?"readonly":"readwrite",i),m=r(d).next(g=>(d.P(),g)).catch(g=>(d.abort(g),ge.reject(g))).toPromise();return m.catch(()=>{}),yield d.R,m}catch(d){const m=d,g="FirebaseError"!==m.name&&c<3;if(nt("SimpleDb","Transaction failed with error:",m.message,"Retrying:",g),s.close(),!g)return Promise.reject(m)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class f3{constructor(e){this.L=e,this.q=!1,this.U=null}get isDone(){return this.q}get K(){return this.U}set cursor(e){this.L=e}done(){this.q=!0}G(e){this.U=e}delete(){return Pp(this.L.delete())}}class aw extends Ve{constructor(e,t){super(be.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function wf(n){return"IndexedDbTransactionError"===n.name}class m3{constructor(e){this.store=e}put(e,t){let i;return void 0!==t?(nt("SimpleDb","PUT",this.store.name,e,t),i=this.store.put(t,e)):(nt("SimpleDb","PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Pp(i)}add(e){return nt("SimpleDb","ADD",this.store.name,e,e),Pp(this.store.add(e))}get(e){return Pp(this.store.get(e)).next(t=>(void 0===t&&(t=null),nt("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return nt("SimpleDb","DELETE",this.store.name,e),Pp(this.store.delete(e))}count(){return nt("SimpleDb","COUNT",this.store.name),Pp(this.store.count())}j(e,t){const i=this.options(e,t);if(i.index||"function"!=typeof this.store.getAll){const r=this.cursor(i),s=[];return this.W(r,(o,c)=>{s.push(c)}).next(()=>s)}{const r=this.store.getAll(i.range);return new ge((s,o)=>{r.onerror=c=>{o(c.target.error)},r.onsuccess=c=>{s(c.target.result)}})}}H(e,t){const i=this.store.getAll(e,null===t?void 0:t);return new ge((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}})}J(e,t){nt("SimpleDb","DELETE ALL",this.store.name);const i=this.options(e,t);i.Y=!1;const r=this.cursor(i);return this.W(r,(s,o,c)=>c.delete())}X(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.W(r,t)}Z(e){const t=this.cursor({});return new ge((i,r)=>{t.onerror=s=>{const o=QR(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(c=>{c?o.continue():i()}):i()}})}W(e,t){const i=[];return new ge((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const c=o.target.result;if(!c)return void r();const d=new f3(c),m=t(c.primaryKey,c.value,d);if(m instanceof ge){const g=m.catch(v=>(d.done(),ge.reject(v)));i.push(g)}d.isDone?r():null===d.K?c.continue():c.continue(d.K)}}).next(()=>ge.waitFor(i))}options(e,t){let i;return void 0!==e&&("string"==typeof e?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.Y?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Pp(n){return new ge((e,t)=>{n.onsuccess=i=>{e(i.target.result)},n.onerror=i=>{const r=QR(i.target.error);t(r)}})}let zO=!1;function QR(n){const e=lc.S((0,An.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new Ve("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return zO||(zO=!0,setTimeout(()=>{throw i},0)),i}}return n}class p3{constructor(e,t){this.asyncQueue=e,this.tt=t,this.task=null}start(){this.et(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}et(e){var t=this;nt("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,Te.Z)(function*(){t.task=null;try{nt("IndexBackiller",`Documents written: ${yield t.tt.nt()}`)}catch(i){wf(i)?nt("IndexBackiller","Ignoring IndexedDB error during index backfill: ",i):yield bf(i)}yield t.et(6e4)}))}}class g3{constructor(e,t){this.localStore=e,this.persistence=t}nt(e=50){var t=this;return(0,Te.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",i=>t.st(i,e))})()}st(e,t){const i=new Set;let r=t,s=!0;return ge.doWhile(()=>!0===s&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(null!==o&&!i.has(o))return nt("IndexBackiller",`Processing collection: ${o}`),this.it(e,o,r).next(c=>{r-=c,i.add(o)});s=!1})).next(()=>t-r)}it(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.rt(r,s)).next(c=>(nt("IndexBackiller",`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c))).next(()=>o.size)}))}rt(e,t){let i=e;return t.changes.forEach((r,s)=>{const o=HO(s);ZR(o,i)>0&&(i=o)}),new Fa(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}let Ba=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ot(r),this.ut=r=>i.writeSequenceNumber(r))}ot(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ut&&this.ut(t),t}}return n.ct=-1,n})();function lw(n){return null==n}function cw(n){return 0===n&&1/n==-1/0}function WO(n){return"number"==typeof n&&Number.isInteger(n)&&!cw(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function eo(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=KO(e)),e=_3(n.get(t),e);return KO(e)}function _3(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function KO(n){return n+"\x01\x01"}function du(n){const e=n.length;if(Kt(e>=2),2===e)return Kt("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),Xn.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf("\x01",s);switch((o<0||o>t)&&Mt(),n.charAt(o+1)){case"\x01":const c=n.substring(s,o);let d;0===r.length?d=c:(r+=c,d=r,r=""),i.push(d);break;case"\x10":r+=n.substring(s,o),r+="\0";break;case"\x11":r+=n.substring(s,o+1);break;default:Mt()}s=o+2}return new Xn(i)}const qO=["userId","batchId"];function zI(n,e){return[n,eo(e)]}function YO(n,e,t){return[n,eo(e),t]}const y3={},v3=["prefixPath","collectionGroup","readTime","documentId"],b3=["prefixPath","collectionGroup","documentId"],w3=["collectionGroup","readTime","prefixPath","documentId"],E3=["canonicalId","targetId"],x3=["targetId","path"],T3=["path","targetId"],I3=["collectionId","parent"],S3=["indexId","uid"],C3=["uid","sequenceNumber"],D3=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],A3=["indexId","uid","orderedDocumentKey"],R3=["userId","collectionPath","documentId"],k3=["userId","collectionPath","largestBatchId"],M3=["userId","collectionGroup","largestBatchId"],ZO=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],L3=[...ZO,"documentOverlays"],QO=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],XO=QO,O3=[...XO,"indexConfiguration","indexState","indexEntries"];class XR extends GO{constructor(e,t){super(),this.ht=e,this.currentSequenceNumber=t}}function _s(n,e){const t=_t(n);return lc.M(t.ht,e)}function JO(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ef(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function eP(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Ri{constructor(e,t){this.comparator=e,this.root=t||Ns.EMPTY}insert(e,t){return new Ri(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ns.BLACK,null,null))}remove(e){return new Ri(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ns.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(0===i)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(0===r)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new WI(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new WI(this.root,e,this.comparator,!1)}getReverseIterator(){return new WI(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new WI(this.root,e,this.comparator,!0)}}class WI{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ns{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??Ns.RED,this.left=r??Ns.EMPTY,this.right=s??Ns.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new Ns(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Ns.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Ns.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ns.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ns.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Mt();const e=this.left.check();if(e!==this.right.check())throw Mt();return e+(this.isRed()?0:1)}}Ns.EMPTY=null,Ns.RED=!0,Ns.BLACK=!1,Ns.EMPTY=new class{constructor(){this.size=0}get key(){throw Mt()}get value(){throw Mt()}get color(){throw Mt()}get left(){throw Mt()}get right(){throw Mt()}copy(n,e,t,i,r){return this}insert(n,e,t){return new Ns(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class $i{constructor(e){this.comparator=e,this.data=new Ri(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new tP(this.data.getIterator())}getIteratorFrom(e){return new tP(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof $i)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(0!==this.comparator(r,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new $i(this.comparator);return t.data=e,t}}class tP{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function hy(n){return n.hasNext()?n.getNext():void 0}class Jo{constructor(e){this.fields=e,e.sort(wr.comparator)}static empty(){return new Jo([])}unionWith(e){let t=new $i(wr.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Jo(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return dy(this.fields,e.fields,(t,i)=>t.isEqual(i))}}class nP extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Jr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new nP("Invalid base64 string: "+r):r}}(e);return new Jr(t)}static fromUint8Array(e){const t=function(i){let r="";for(let s=0;s<i.length;++s)r+=String.fromCharCode(i[s]);return r}(e);return new Jr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return bn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Jr.EMPTY_BYTE_STRING=new Jr("");const N3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xf(n){if(Kt(!!n),"string"==typeof n){let e=0;const t=N3.exec(n);if(Kt(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Er(n.seconds),nanos:Er(n.nanos)}}function Er(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function md(n){return"string"==typeof n?Jr.fromBase64String(n):Jr.fromUint8Array(n)}function KI(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function qI(n){const e=n.mapValue.fields.__previous_value__;return KI(e)?qI(e):e}function uw(n){const e=xf(n.mapValue.fields.__local_write_time__.timestampValue);return new Xi(e.seconds,e.nanos)}class F3{constructor(e,t,i,r,s,o,c,d,m){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=d,this.useFetchStreams=m}}class Tf{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Tf("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Tf&&e.projectId===this.projectId&&e.database===this.database}}const If={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},YI={nullValue:"NULL_VALUE"};function Sf(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?KI(n)?4:oP(n)?9007199254740991:10:Mt()}function hu(n,e){if(n===e)return!0;const t=Sf(n);if(t!==Sf(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return uw(n).isEqual(uw(e));case 3:return function(i,r){if("string"==typeof i.timestampValue&&"string"==typeof r.timestampValue&&i.timestampValue.length===r.timestampValue.length)return i.timestampValue===r.timestampValue;const s=xf(i.timestampValue),o=xf(r.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,r){return md(i.bytesValue).isEqual(md(r.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,r){return Er(i.geoPointValue.latitude)===Er(r.geoPointValue.latitude)&&Er(i.geoPointValue.longitude)===Er(r.geoPointValue.longitude)}(n,e);case 2:return function(i,r){if("integerValue"in i&&"integerValue"in r)return Er(i.integerValue)===Er(r.integerValue);if("doubleValue"in i&&"doubleValue"in r){const s=Er(i.doubleValue),o=Er(r.doubleValue);return s===o?cw(s)===cw(o):isNaN(s)&&isNaN(o)}return!1}(n,e);case 9:return dy(n.arrayValue.values||[],e.arrayValue.values||[],hu);case 10:return function(i,r){const s=i.mapValue.fields||{},o=r.mapValue.fields||{};if(JO(s)!==JO(o))return!1;for(const c in s)if(s.hasOwnProperty(c)&&(void 0===o[c]||!hu(s[c],o[c])))return!1;return!0}(n,e);default:return Mt()}}function dw(n,e){return void 0!==(n.values||[]).find(t=>hu(t,e))}function Cf(n,e){if(n===e)return 0;const t=Sf(n),i=Sf(e);if(t!==i)return bn(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return bn(n.booleanValue,e.booleanValue);case 2:return function(r,s){const o=Er(r.integerValue||r.doubleValue),c=Er(s.integerValue||s.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(n,e);case 3:return iP(n.timestampValue,e.timestampValue);case 4:return iP(uw(n),uw(e));case 5:return bn(n.stringValue,e.stringValue);case 6:return function(r,s){const o=md(r),c=md(s);return o.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(r,s){const o=r.split("/"),c=s.split("/");for(let d=0;d<o.length&&d<c.length;d++){const m=bn(o[d],c[d]);if(0!==m)return m}return bn(o.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(r,s){const o=bn(Er(r.latitude),Er(s.latitude));return 0!==o?o:bn(Er(r.longitude),Er(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(r,s){const o=r.values||[],c=s.values||[];for(let d=0;d<o.length&&d<c.length;++d){const m=Cf(o[d],c[d]);if(m)return m}return bn(o.length,c.length)}(n.arrayValue,e.arrayValue);case 10:return function(r,s){if(r===If.mapValue&&s===If.mapValue)return 0;if(r===If.mapValue)return 1;if(s===If.mapValue)return-1;const o=r.fields||{},c=Object.keys(o),d=s.fields||{},m=Object.keys(d);c.sort(),m.sort();for(let g=0;g<c.length&&g<m.length;++g){const v=bn(c[g],m[g]);if(0!==v)return v;const E=Cf(o[c[g]],d[m[g]]);if(0!==E)return E}return bn(c.length,m.length)}(n.mapValue,e.mapValue);default:throw Mt()}}function iP(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return bn(n,e);const t=xf(n),i=xf(e),r=bn(t.seconds,i.seconds);return 0!==r?r:bn(t.nanos,i.nanos)}function fy(n){return JR(n)}function JR(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(i){const r=xf(i);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?md(n.bytesValue).toBase64():"referenceValue"in n?mt.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(i){let r="[",s=!0;for(const o of i.values||[])s?s=!1:r+=",",r+=JR(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(i){const r=Object.keys(i.fields||{}).sort();let s="{",o=!0;for(const c of r)o?o=!1:s+=",",s+=`${c}:${JR(i.fields[c])}`;return s+"}"}(n.mapValue):Mt();var e}function Np(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ek(n){return!!n&&"integerValue"in n}function hw(n){return!!n&&"arrayValue"in n}function rP(n){return!!n&&"nullValue"in n}function sP(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function QI(n){return!!n&&"mapValue"in n}function fw(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Ef(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=fw(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=fw(n.arrayValue.values[t]);return e}return Object.assign({},n)}function oP(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function B3(n){return"nullValue"in n?YI:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Np(Tf.empty(),mt.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:Mt()}function U3(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Np(Tf.empty(),mt.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?If:Mt()}function aP(n,e){const t=Cf(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function lP(n,e){const t=Cf(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Fs{constructor(e){this.value=e}static empty(){return new Fs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!QI(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=fw(t)}setAll(e){let t=wr.emptyPath(),i={},r=[];e.forEach((o,c)=>{if(!t.isImmediateParentOf(c)){const d=this.getFieldsMap(t);this.applyChanges(d,i,r),i={},r=[],t=c.popLast()}o?i[c.lastSegment()]=fw(o):r.push(c.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());QI(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return hu(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];QI(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Ef(t,(r,s)=>e[r]=s);for(const r of i)delete e[r]}clone(){return new Fs(fw(this.value))}}function cP(n){const e=[];return Ef(n.fields,(t,i)=>{const r=new wr([t]);if(QI(i)){const s=cP(i.mapValue).fields;if(0===s.length)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)}),new Jo(e)}class Hi{constructor(e,t,i,r,s,o,c){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=c}static newInvalidDocument(e){return new Hi(e,0,qt.min(),qt.min(),qt.min(),Fs.empty(),0)}static newFoundDocument(e,t,i,r){return new Hi(e,1,t,qt.min(),i,r,0)}static newNoDocument(e,t){return new Hi(e,2,t,qt.min(),qt.min(),Fs.empty(),0)}static newUnknownDocument(e,t){return new Hi(e,3,t,qt.min(),qt.min(),Fs.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(qt.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Fs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Fs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=qt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Hi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Hi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Df{constructor(e,t){this.position=e,this.inclusive=t}}function uP(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(i=s.field.isKeyField()?mt.comparator(mt.fromName(o.referenceValue),t.key):Cf(o,t.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function dP(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!hu(n.position[t],e.position[t]))return!1;return!0}class my{constructor(e,t="asc"){this.field=e,this.dir=t}}function V3(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class hP{}class Vn extends hP{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,i):new $3(e,t,i):"array-contains"===t?new G3(e,i):"in"===t?new yP(e,i):"not-in"===t?new z3(e,i):"array-contains-any"===t?new W3(e,i):new Vn(e,t,i)}static createKeyFieldInFilter(e,t,i){return"in"===t?new H3(e,i):new j3(e,i)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Cf(t,this.value)):null!==t&&Sf(this.value)===Sf(t)&&this.matchesComparison(Cf(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Mt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class mi extends hP{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new mi(e,t)}matches(e){return py(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(t=>t.isInequality());return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function py(n){return"and"===n.op}function tk(n){return"or"===n.op}function nk(n){return fP(n)&&py(n)}function fP(n){for(const e of n.filters)if(e instanceof mi)return!1;return!0}function ik(n){if(n instanceof Vn)return n.field.canonicalString()+n.op.toString()+fy(n.value);if(nk(n))return n.filters.map(e=>ik(e)).join(",");{const e=n.filters.map(t=>ik(t)).join(",");return`${n.op}(${e})`}}function mP(n,e){return n instanceof Vn?function(t,i){return i instanceof Vn&&t.op===i.op&&t.field.isEqual(i.field)&&hu(t.value,i.value)}(n,e):n instanceof mi?function(t,i){return i instanceof mi&&t.op===i.op&&t.filters.length===i.filters.length&&t.filters.reduce((r,s,o)=>r&&mP(s,i.filters[o]),!0)}(n,e):void Mt()}function pP(n,e){const t=n.filters.concat(e);return mi.create(t,n.op)}function gP(n){return n instanceof Vn?`${(e=n).field.canonicalString()} ${e.op} ${fy(e.value)}`:n instanceof mi?function(e){return e.op.toString()+" {"+e.getFilters().map(gP).join(" ,")+"}"}(n):"Filter";var e}class $3 extends Vn{constructor(e,t,i){super(e,t,i),this.key=mt.fromName(i.referenceValue)}matches(e){const t=mt.comparator(e.key,this.key);return this.matchesComparison(t)}}class H3 extends Vn{constructor(e,t){super(e,"in",t),this.keys=_P(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class j3 extends Vn{constructor(e,t){super(e,"not-in",t),this.keys=_P(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function _P(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(i=>mt.fromName(i.referenceValue))}class G3 extends Vn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return hw(t)&&dw(t.arrayValue,this.value)}}class yP extends Vn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&dw(this.value.arrayValue,t)}}class z3 extends Vn{constructor(e,t){super(e,"not-in",t)}matches(e){if(dw(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!dw(this.value.arrayValue,t)}}class W3 extends Vn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!hw(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>dw(this.value.arrayValue,i))}}class K3{constructor(e,t=null,i=[],r=[],s=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=c,this.dt=null}}function rk(n,e=null,t=[],i=[],r=null,s=null,o=null){return new K3(n,e,t,i,r,s,o)}function Fp(n){const e=_t(n);if(null===e.dt){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>ik(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(r){return r.field.canonicalString()+r.dir}(i)).join(","),lw(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>fy(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>fy(i)).join(",")),e.dt=t}return e.dt}function mw(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!V3(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!mP(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!dP(n.startAt,e.startAt)&&dP(n.endAt,e.endAt)}function XI(n){return mt.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function JI(n,e){return n.filters.filter(t=>t instanceof Vn&&t.field.isEqual(e))}function vP(n,e,t){let i=YI,r=!0;for(const s of JI(n,e)){let o=YI,c=!0;switch(s.op){case"<":case"<=":o=B3(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,c=!1;break;case"!=":case"not-in":o=YI}aP({value:i,inclusive:r},{value:o,inclusive:c})<0&&(i=o,r=c)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];aP({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}return{value:i,inclusive:r}}function bP(n,e,t){let i=If,r=!0;for(const s of JI(n,e)){let o=If,c=!0;switch(s.op){case">=":case">":o=U3(s.value),c=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,c=!1;break;case"!=":case"not-in":o=If}lP({value:i,inclusive:r},{value:o,inclusive:c})>0&&(i=o,r=c)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];lP({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}return{value:i,inclusive:r}}class pd{constructor(e,t=null,i=[],r=[],s=null,o="F",c=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=c,this.endAt=d,this.wt=null,this._t=null}}function wP(n,e,t,i,r,s,o,c){return new pd(n,e,t,i,r,s,o,c)}function gy(n){return new pd(n)}function EP(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function sk(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function eS(n){for(const e of n.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function ok(n){return null!==n.collectionGroup}function Bp(n){const e=_t(n);if(null===e.wt){e.wt=[];const t=eS(e),i=sk(e);if(null!==t&&null===i)t.isKeyField()||e.wt.push(new my(t)),e.wt.push(new my(wr.keyField(),"asc"));else{let r=!1;for(const s of e.explicitOrderBy)e.wt.push(s),s.field.isKeyField()&&(r=!0);if(!r){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new my(wr.keyField(),s))}}}return e.wt}function Do(n){const e=_t(n);if(!e._t)if("F"===e.limitType)e._t=rk(e.path,e.collectionGroup,Bp(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const s of Bp(e))t.push(new my(s.field,"desc"===s.dir?"asc":"desc"));const i=e.endAt?new Df(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Df(e.startAt.position,e.startAt.inclusive):null;e._t=rk(e.path,e.collectionGroup,t,e.filters,e.limit,i,r)}return e._t}function ak(n,e){e.getFirstInequalityField(),eS(n);const t=n.filters.concat([e]);return new pd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function tS(n,e,t){return new pd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function pw(n,e){return mw(Do(n),Do(e))&&n.limitType===e.limitType}function xP(n){return`${Fp(Do(n))}|lt:${n.limitType}`}function lk(n){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(i=>gP(i)).join(", ")}]`),lw(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(i=>function(r){return`${r.field.canonicalString()} (${r.dir})`}(i)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>fy(i)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>fy(i)).join(",")),`Target(${t})`}(Do(n))}; limitType=${n.limitType})`}function gw(n,e){return e.isFoundDocument()&&function(t,i){const r=i.key.path;return null!==t.collectionGroup?i.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(r):mt.isDocumentKey(t.path)?t.path.isEqual(r):t.path.isImmediateParentOf(r)}(n,e)&&function(t,i){for(const r of Bp(t))if(!r.field.isKeyField()&&null===i.data.field(r.field))return!1;return!0}(n,e)&&function(t,i){for(const r of t.filters)if(!r.matches(i))return!1;return!0}(n,e)&&function(t,i){return!(t.startAt&&!function(r,s,o){const c=uP(r,s,o);return r.inclusive?c<=0:c<0}(t.startAt,Bp(t),i)||t.endAt&&!function(r,s,o){const c=uP(r,s,o);return r.inclusive?c>=0:c>0}(t.endAt,Bp(t),i))}(n,e)}function TP(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function IP(n){return(e,t)=>{let i=!1;for(const r of Bp(n)){const s=q3(r,e,t);if(0!==s)return s;i=i||r.field.isKeyField()}return 0}}function q3(n,e,t){const i=n.field.isKeyField()?mt.comparator(e.key,t.key):function(r,s,o){const c=s.data.field(r),d=o.data.field(r);return null!==c&&null!==d?Cf(c,d):Mt()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Mt()}}class gd{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(void 0!==i)for(const[r,s]of i)if(this.equalsFn(r,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(void 0===r)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(void 0===i)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return 1===i.length?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ef(this.inner,(t,i)=>{for(const[r,s]of i)e(r,s)})}isEmpty(){return eP(this.inner)}size(){return this.innerSize}}const Y3=new Ri(mt.comparator);function ea(){return Y3}const SP=new Ri(mt.comparator);function _w(...n){let e=SP;for(const t of n)e=e.insert(t.key,t);return e}function CP(n){let e=SP;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function fu(){return yw()}function DP(){return yw()}function yw(){return new gd(n=>n.toString(),(n,e)=>n.isEqual(e))}const Z3=new Ri(mt.comparator),Q3=new $i(mt.comparator);function Sn(...n){let e=Q3;for(const t of n)e=e.add(t);return e}const X3=new $i(bn);function ck(){return X3}function AP(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:cw(e)?"-0":e}}function RP(n){return{integerValue:""+n}}function kP(n,e){return WO(e)?RP(e):AP(n,e)}class nS{constructor(){this._=void 0}}function J3(n,e,t){return n instanceof _y?function(i,r){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return r&&KI(r)&&(r=qI(r)),r&&(s.fields.__previous_value__=r),{mapValue:s}}(t,e):n instanceof Up?LP(n,e):n instanceof Vp?OP(n,e):function(i,r){const s=MP(i,r),o=PP(s)+PP(i.gt);return ek(s)&&ek(i.gt)?RP(o):AP(i.serializer,o)}(n,e)}function eH(n,e,t){return n instanceof Up?LP(n,e):n instanceof Vp?OP(n,e):t}function MP(n,e){return n instanceof yy?ek(t=e)||function(i){return!!i&&"doubleValue"in i}(t)?e:{integerValue:0}:null;var t}class _y extends nS{}class Up extends nS{constructor(e){super(),this.elements=e}}function LP(n,e){const t=NP(e);for(const i of n.elements)t.some(r=>hu(r,i))||t.push(i);return{arrayValue:{values:t}}}class Vp extends nS{constructor(e){super(),this.elements=e}}function OP(n,e){let t=NP(e);for(const i of n.elements)t=t.filter(r=>!hu(r,i));return{arrayValue:{values:t}}}class yy extends nS{constructor(e,t){super(),this.serializer=e,this.gt=t}}function PP(n){return Er(n.integerValue||n.doubleValue)}function NP(n){return hw(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class vw{constructor(e,t){this.field=e,this.transform=t}}class nH{constructor(e,t){this.version=e,this.transformResults=t}}class Ji{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ji}static exists(e){return new Ji(void 0,e)}static updateTime(e){return new Ji(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function iS(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class rS{}function FP(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new by(n.key,Ji.none()):new vy(n.key,n.data,Ji.none());{const t=n.data,i=Fs.empty();let r=new $i(wr.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);null===o&&s.length>1&&(s=s.popLast(),o=t.field(s)),null===o?i.delete(s):i.set(s,o),r=r.add(s)}return new _d(n.key,i,new Jo(r.toArray()),Ji.none())}}function iH(n,e,t){n instanceof vy?function(i,r,s){const o=i.value.clone(),c=VP(i.fieldTransforms,r,s.transformResults);o.setAll(c),r.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(n,e,t):n instanceof _d?function(i,r,s){if(!iS(i.precondition,r))return void r.convertToUnknownDocument(s.version);const o=VP(i.fieldTransforms,r,s.transformResults),c=r.data;c.setAll(UP(i)),c.setAll(o),r.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(n,e,t):function(i,r,s){r.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function bw(n,e,t,i){return n instanceof vy?function(r,s,o,c){if(!iS(r.precondition,s))return o;const d=r.value.clone(),m=$P(r.fieldTransforms,c,s);return d.setAll(m),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),null}(n,e,t,i):n instanceof _d?function(r,s,o,c){if(!iS(r.precondition,s))return o;const d=$P(r.fieldTransforms,c,s),m=s.data;return m.setAll(UP(r)),m.setAll(d),s.convertToFoundDocument(s.version,m).setHasLocalMutations(),null===o?null:o.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(g=>g.field))}(n,e,t,i):function(r,s,o){return iS(r.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o}(n,e,t)}function rH(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),s=MP(i.transform,r||null);null!=s&&(null===t&&(t=Fs.empty()),t.set(i.field,s))}return t||null}function BP(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(t,i){return void 0===t&&void 0===i||!(!t||!i)&&dy(t,i,(r,s)=>function tH(n,e){return n.field.isEqual(e.field)&&function(t,i){return t instanceof Up&&i instanceof Up||t instanceof Vp&&i instanceof Vp?dy(t.elements,i.elements,hu):t instanceof yy&&i instanceof yy?hu(t.gt,i.gt):t instanceof _y&&i instanceof _y}(n.transform,e.transform)}(r,s))}(n.fieldTransforms,e.fieldTransforms)&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class vy extends rS{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class _d extends rS{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function UP(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function VP(n,e,t){const i=new Map;Kt(n.length===t.length);for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,c=e.data.field(s.field);i.set(s.field,eH(o,c,t[r]))}return i}function $P(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,J3(s,o,e))}return i}class by extends rS{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class uk extends rS{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class dk{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&iH(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=bw(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=bw(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=DP();return this.mutations.forEach(r=>{const s=e.get(r.key),o=s.overlayedDocument;let c=this.applyToLocalView(o,s.mutatedFields);c=t.has(r.key)?null:c;const d=FP(o,c);null!==d&&i.set(r.key,d),o.isValidDocument()||o.convertToNoDocument(qt.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Sn())}isEqual(e){return this.batchId===e.batchId&&dy(this.mutations,e.mutations,(t,i)=>BP(t,i))&&dy(this.baseMutations,e.baseMutations,(t,i)=>BP(t,i))}}class hk{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Kt(e.mutations.length===i.length);let r=Z3;const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new hk(e,t,i,r)}}class fk{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class oH{constructor(e,t){this.count=e,this.unchangedNames=t}}var Vr,Jn;function HP(n){switch(n){default:return Mt();case be.CANCELLED:case be.UNKNOWN:case be.DEADLINE_EXCEEDED:case be.RESOURCE_EXHAUSTED:case be.INTERNAL:case be.UNAVAILABLE:case be.UNAUTHENTICATED:return!1;case be.INVALID_ARGUMENT:case be.NOT_FOUND:case be.ALREADY_EXISTS:case be.PERMISSION_DENIED:case be.FAILED_PRECONDITION:case be.ABORTED:case be.OUT_OF_RANGE:case be.UNIMPLEMENTED:case be.DATA_LOSS:return!0}}function jP(n){if(void 0===n)return Rr("GRPC error has no .code"),be.UNKNOWN;switch(n){case Vr.OK:return be.OK;case Vr.CANCELLED:return be.CANCELLED;case Vr.UNKNOWN:return be.UNKNOWN;case Vr.DEADLINE_EXCEEDED:return be.DEADLINE_EXCEEDED;case Vr.RESOURCE_EXHAUSTED:return be.RESOURCE_EXHAUSTED;case Vr.INTERNAL:return be.INTERNAL;case Vr.UNAVAILABLE:return be.UNAVAILABLE;case Vr.UNAUTHENTICATED:return be.UNAUTHENTICATED;case Vr.INVALID_ARGUMENT:return be.INVALID_ARGUMENT;case Vr.NOT_FOUND:return be.NOT_FOUND;case Vr.ALREADY_EXISTS:return be.ALREADY_EXISTS;case Vr.PERMISSION_DENIED:return be.PERMISSION_DENIED;case Vr.FAILED_PRECONDITION:return be.FAILED_PRECONDITION;case Vr.ABORTED:return be.ABORTED;case Vr.OUT_OF_RANGE:return be.OUT_OF_RANGE;case Vr.UNIMPLEMENTED:return be.UNIMPLEMENTED;case Vr.DATA_LOSS:return be.DATA_LOSS;default:return Mt()}}(Jn=Vr||(Vr={}))[Jn.OK=0]="OK",Jn[Jn.CANCELLED=1]="CANCELLED",Jn[Jn.UNKNOWN=2]="UNKNOWN",Jn[Jn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Jn[Jn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Jn[Jn.NOT_FOUND=5]="NOT_FOUND",Jn[Jn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Jn[Jn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Jn[Jn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Jn[Jn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Jn[Jn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Jn[Jn.ABORTED=10]="ABORTED",Jn[Jn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Jn[Jn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Jn[Jn.INTERNAL=13]="INTERNAL",Jn[Jn.UNAVAILABLE=14]="UNAVAILABLE",Jn[Jn.DATA_LOSS=15]="DATA_LOSS";class mk{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return sS}static getOrCreateInstance(){return null===sS&&(sS=new mk),sS}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let sS=null;function GP(){return new TextEncoder}const aH=new ke([4294967295,4294967295],0);function zP(n){const e=GP().encode(n),t=new he;return t.update(e),new Uint8Array(t.digest())}function WP(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ke([t,i],0),new ke([r,s],0)]}class pk{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new ww(`Invalid padding: ${t}`);if(i<0)throw new ww(`Invalid hash count: ${i}`);if(e.length>0&&0===this.hashCount)throw new ww(`Invalid hash count: ${i}`);if(0===e.length&&0!==t)throw new ww(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=ke.fromNumber(this.It)}Et(e,t,i){let r=e.add(t.multiply(ke.fromNumber(i)));return 1===r.compare(aH)&&(r=new ke([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Tt).toNumber()}At(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=zP(e),[i,r]=WP(t);for(let s=0;s<this.hashCount;s++){const o=this.Et(i,r,s);if(!this.At(o))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new pk(s,r,t);return i.forEach(c=>o.insert(c)),o}insert(e){if(0===this.It)return;const t=zP(e),[i,r]=WP(t);for(let s=0;s<this.hashCount;s++){const o=this.Et(i,r,s);this.Rt(o)}}Rt(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class ww extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Ew{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,xw.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Ew(qt.min(),r,new Ri(bn),ea(),Sn())}}class xw{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new xw(i,t,Sn(),Sn(),Sn())}}class oS{constructor(e,t,i,r){this.Pt=e,this.removedTargetIds=t,this.key=i,this.bt=r}}class KP{constructor(e,t){this.targetId=e,this.Vt=t}}class qP{constructor(e,t,i=Jr.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class YP{constructor(){this.St=0,this.Dt=QP(),this.Ct=Jr.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=Sn(),t=Sn(),i=Sn();return this.Dt.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Mt()}}),new xw(this.Ct,this.xt,e,t,i)}Ft(){this.Nt=!1,this.Dt=QP()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class lH{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=ea(),this.zt=ZP(),this.Wt=new Ri(bn)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{const i=this.Zt(t);switch(e.state){case 0:this.te(t)&&i.$t(e.resumeToken);break;case 1:i.Ut(),i.kt||i.Ft(),i.$t(e.resumeToken);break;case 2:i.Ut(),i.kt||this.removeTarget(t);break;case 3:this.te(t)&&(i.Kt(),i.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),i.$t(e.resumeToken));break;default:Mt()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((i,r)=>{this.te(r)&&t(r)})}ne(e){var t;const i=e.targetId,r=e.Vt.count,s=this.se(i);if(s){const o=s.target;if(XI(o))if(0===r){const c=new mt(o.path);this.Yt(i,c,Hi.newNoDocument(c,qt.min()))}else Kt(1===r);else{const c=this.ie(i);if(c!==r){const d=this.re(e,c);0!==d&&(this.ee(i),this.Wt=this.Wt.insert(i,2===d?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),null===(t=mk.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(m,g,v){var E,T,C,k,P,G;const Y={localCacheCount:g,existenceFilterCount:v.count},W=v.unchangedNames;return W&&(Y.bloomFilter={applied:0===m,hashCount:null!==(E=W?.hashCount)&&void 0!==E?E:0,bitmapLength:null!==(k=null===(C=null===(T=W?.bits)||void 0===T?void 0:T.bitmap)||void 0===C?void 0:C.length)&&void 0!==k?k:0,padding:null!==(G=null===(P=W?.bits)||void 0===P?void 0:P.padding)&&void 0!==G?G:0}),Y}(d,c,e.Vt))}}}}re(e,t){const{unchangedNames:i,count:r}=e.Vt;if(!i||!i.bits)return 1;const{bits:{bitmap:s="",padding:o=0},hashCount:c=0}=i;let d,m;try{d=md(s).toUint8Array()}catch(g){if(g instanceof nP)return pl("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw g}try{m=new pk(d,o,c)}catch(g){return pl(g instanceof ww?"BloomFilter error: ":"Applying bloom filter failed: ",g),1}return 0===m.It?1:r!==t-this.oe(e.targetId,m)?2:0}oe(e,t){const i=this.Gt.getRemoteKeysForTarget(e);let r=0;return i.forEach(s=>{const o=this.Gt.ue(),c=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.vt(c)||(this.Yt(e,s,null),r++)}),r}ce(e){const t=new Map;this.Qt.forEach((s,o)=>{const c=this.se(o);if(c){if(s.current&&XI(c.target)){const d=new mt(c.target.path);null!==this.jt.get(d)||this.ae(o,d)||this.Yt(o,d,Hi.newNoDocument(d,e))}s.Mt&&(t.set(o,s.Ot()),s.Ft())}});let i=Sn();this.zt.forEach((s,o)=>{let c=!0;o.forEachWhile(d=>{const m=this.se(d);return!m||"TargetPurposeLimboResolution"===m.purpose||(c=!1,!1)}),c&&(i=i.add(s))}),this.jt.forEach((s,o)=>o.setReadTime(e));const r=new Ew(e,t,this.Wt,this.jt,i);return this.jt=ea(),this.zt=ZP(),this.Wt=new Ri(bn),r}Jt(e,t){if(!this.te(e))return;const i=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,i),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,i){if(!this.te(e))return;const r=this.Zt(e);this.ae(e,t)?r.Bt(t,1):r.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),i&&(this.jt=this.jt.insert(t,i))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new YP,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new $i(bn),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||nt("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new YP),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function ZP(){return new Ri(mt.comparator)}function QP(){return new Ri(mt.comparator)}const cH={asc:"ASCENDING",desc:"DESCENDING"},uH={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},dH={and:"AND",or:"OR"};class hH{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function gk(n,e){return n.useProto3Json||lw(e)?e:{value:e}}function wy(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function XP(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function fH(n,e){return wy(n,e.toTimestamp())}function kr(n){return Kt(!!n),qt.fromTimestamp(function(e){const t=xf(e);return new Xi(t.seconds,t.nanos)}(n))}function _k(n,e){return(t=n,new Xn(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function JP(n){const e=Xn.fromString(n);return Kt(lN(e)),e}function Tw(n,e){return _k(n.databaseId,e.path)}function mu(n,e){const t=JP(e);if(t.get(1)!==n.databaseId.projectId)throw new Ve(be.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ve(be.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new mt(tN(t))}function yk(n,e){return _k(n.databaseId,e)}function eN(n){const e=JP(n);return 4===e.length?Xn.emptyPath():tN(e)}function Iw(n){return new Xn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function tN(n){return Kt(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function nN(n,e,t){return{name:Tw(n,e),fields:t.value.mapValue.fields}}function iN(n,e,t){const i=mu(n,e.name),r=kr(e.updateTime),s=e.createTime?kr(e.createTime):qt.min(),o=new Fs({mapValue:{fields:e.fields}}),c=Hi.newFoundDocument(i,r,s,o);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function Sw(n,e){let t;if(e instanceof vy)t={update:nN(n,e.key,e.value)};else if(e instanceof by)t={delete:Tw(n,e.key)};else if(e instanceof _d)t={update:nN(n,e.key,e.data),updateMask:wH(e.fieldMask)};else{if(!(e instanceof uk))return Mt();t={verify:Tw(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(r,s){const o=s.transform;if(o instanceof _y)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Up)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Vp)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof yy)return{fieldPath:s.field.canonicalString(),increment:o.gt};throw Mt()}(0,i))),e.precondition.isNone||(t.currentDocument=function(i,r){return void 0!==r.updateTime?{updateTime:fH(i,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:Mt()}(n,e.precondition)),t}function vk(n,e){const t=e.currentDocument?function(r){return void 0!==r.updateTime?Ji.updateTime(kr(r.updateTime)):void 0!==r.exists?Ji.exists(r.exists):Ji.none()}(e.currentDocument):Ji.none(),i=e.updateTransforms?e.updateTransforms.map(r=>function(s,o){let c=null;"setToServerValue"in o?(Kt("REQUEST_TIME"===o.setToServerValue),c=new _y):"appendMissingElements"in o?c=new Up(o.appendMissingElements.values||[]):"removeAllFromArray"in o?c=new Vp(o.removeAllFromArray.values||[]):"increment"in o?c=new yy(s,o.increment):Mt();const d=wr.fromServerFormat(o.fieldPath);return new vw(d,c)}(n,r)):[];if(e.update){const r=mu(n,e.update.name),s=new Fs({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){return new Jo((c.fieldPaths||[]).map(m=>wr.fromServerFormat(m)))}(e.updateMask);return new _d(r,s,o,t,i)}return new vy(r,s,t,i)}if(e.delete){const r=mu(n,e.delete);return new by(r,t)}if(e.verify){const r=mu(n,e.verify);return new uk(r,t)}return Mt()}function rN(n,e){return{documents:[yk(n,e.path)]}}function bk(n,e){const t={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(t.parent=yk(n,i),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=yk(n,i.popLast()),t.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(d){if(0!==d.length)return aN(mi.create(d,"and"))}(e.filters);r&&(t.structuredQuery.where=r);const s=function(d){if(0!==d.length)return d.map(m=>{return{field:Af((g=m).field),direction:yH(g.dir)};var g})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const o=gk(n,e.limit);var c,d;return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt={before:(c=e.startAt).inclusive,values:c.position}),e.endAt&&(t.structuredQuery.endAt={before:!(d=e.endAt).inclusive,values:d.position}),t}function sN(n){let e=eN(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){Kt(1===i);const g=t.from[0];g.allDescendants?r=g.collectionId:e=e.child(g.collectionId)}let s=[];t.where&&(s=function(g){const v=oN(g);return v instanceof mi&&nk(v)?v.getFilters():[v]}(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(g=>{return new my(Ey((v=g).field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction));var v}));let c=null;t.limit&&(c=function(g){let v;return v="object"==typeof g?g.value:g,lw(v)?null:v}(t.limit));let d=null;var g;t.startAt&&(d=new Df((g=t.startAt).values||[],!!g.before));let m=null;return t.endAt&&(m=function(g){return new Df(g.values||[],!g.before)}(t.endAt)),wP(e,r,o,s,c,"F",d,m)}function oN(n){return void 0!==n.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Ey(e.unaryFilter.field);return Vn.create(t,"==",{doubleValue:NaN});case"IS_NULL":const i=Ey(e.unaryFilter.field);return Vn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ey(e.unaryFilter.field);return Vn.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Ey(e.unaryFilter.field);return Vn.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Mt()}}(n):void 0!==n.fieldFilter?Vn.create(Ey((e=n).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Mt()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==n.compositeFilter?function(e){return mi.create(e.compositeFilter.filters.map(t=>oN(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return Mt()}}(e.compositeFilter.op))}(n):Mt();var e}function yH(n){return cH[n]}function vH(n){return uH[n]}function bH(n){return dH[n]}function Af(n){return{fieldPath:n.canonicalString()}}function Ey(n){return wr.fromServerFormat(n.fieldPath)}function aN(n){return n instanceof Vn?function(e){if("=="===e.op){if(sP(e.value))return{unaryFilter:{field:Af(e.field),op:"IS_NAN"}};if(rP(e.value))return{unaryFilter:{field:Af(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(sP(e.value))return{unaryFilter:{field:Af(e.field),op:"IS_NOT_NAN"}};if(rP(e.value))return{unaryFilter:{field:Af(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Af(e.field),op:vH(e.op),value:e.value}}}(n):n instanceof mi?function(e){const t=e.getFilters().map(i=>aN(i));return 1===t.length?t[0]:{compositeFilter:{op:bH(e.op),filters:t}}}(n):Mt()}function wH(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function lN(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class yd{constructor(e,t,i,r,s=qt.min(),o=qt.min(),c=Jr.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=d}withSequenceNumber(e){return new yd(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new yd(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new yd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new yd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class cN{constructor(e){this.fe=e}}function uN(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:aS(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=function(r,s){return{name:Tw(r,s.key),fields:s.data.value.mapValue.fields,updateTime:wy(r,s.version.toTimestamp()),createTime:wy(r,s.createTime.toTimestamp())}}(n.fe,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:$p(e.version)};else{if(!e.isUnknownDocument())return Mt();i.unknownDocument={path:t.path.toArray(),version:$p(e.version)}}return i}function aS(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function $p(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Hp(n){const e=new Xi(n.seconds,n.nanoseconds);return qt.fromTimestamp(e)}function jp(n,e){const t=(e.baseMutations||[]).map(s=>vk(n.fe,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const i=e.mutations.map(s=>vk(n.fe,s)),r=Xi.fromMillis(e.localWriteTimeMs);return new dk(e.batchId,r,t,i)}function Cw(n){const e=Hp(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?Hp(n.lastLimboFreeSnapshotVersion):qt.min();let i;var r;return void 0!==n.query.documents?(Kt(1===(r=n.query).documents.length),i=Do(gy(eN(r.documents[0])))):i=function(s){return Do(sN(s))}(n.query),new yd(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Jr.fromBase64String(n.resumeToken))}function dN(n,e){const t=$p(e.snapshotVersion),i=$p(e.lastLimboFreeSnapshotVersion);let r;r=XI(e.target)?rN(n.fe,e.target):bk(n.fe,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Fp(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function wk(n){const e=sN({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?tS(e,e.limit,"L"):e}function Ek(n,e){return new fk(e.largestBatchId,vk(n.fe,e.overlayMutation))}function hN(n,e){const t=e.path.lastSegment();return[n,eo(e.path.popLast()),t]}function fN(n,e,t,i){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:$p(i.readTime),documentKey:eo(i.documentKey.path),largestBatchId:i.largestBatchId}}class xH{getBundleMetadata(e,t){return mN(e).get(t).next(i=>{if(i)return{id:(r=i).bundleId,createTime:Hp(r.createTime),version:r.version};var r})}saveBundleMetadata(e,t){return mN(e).put({bundleId:(i=t).id,createTime:$p(kr(i.createTime)),version:i.version});var i}getNamedQuery(e,t){return pN(e).get(t).next(i=>{if(i)return{name:(r=i).name,query:wk(r.bundledQuery),readTime:Hp(r.readTime)};var r})}saveNamedQuery(e,t){return pN(e).put(function(i){return{name:i.name,readTime:$p(kr(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function mN(n){return _s(n,"bundles")}function pN(n){return _s(n,"namedQueries")}class lS{constructor(e,t){this.serializer=e,this.userId=t}static de(e,t){return new lS(e,t.uid||"")}getOverlay(e,t){return Dw(e).get(hN(this.userId,t)).next(i=>i?Ek(this.serializer,i):null)}getOverlays(e,t){const i=fu();return ge.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){const r=[];return i.forEach((s,o)=>{const c=new fk(t,o);r.push(this.we(e,c))}),ge.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach(o=>r.add(eo(o.getCollectionPath())));const s=[];return r.forEach(o=>{const c=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Dw(e).J("collectionPathOverlayIndex",c))}),ge.waitFor(s)}getOverlaysForCollection(e,t,i){const r=fu(),s=eo(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Dw(e).j("collectionPathOverlayIndex",o).next(c=>{for(const d of c){const m=Ek(this.serializer,d);r.set(m.getKey(),m)}return r})}getOverlaysForCollectionGroup(e,t,i,r){const s=fu();let o;const c=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Dw(e).X({index:"collectionGroupOverlayIndex",range:c},(d,m,g)=>{const v=Ek(this.serializer,m);s.size()<r||v.largestBatchId===o?(s.set(v.getKey(),v),o=v.largestBatchId):g.done()}).next(()=>s)}we(e,t){return Dw(e).put(function(i,r,s){const[o,c,d]=hN(r,s.mutation.key);return{userId:r,collectionPath:c,documentId:d,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:Sw(i.fe,s.mutation)}}(this.serializer,this.userId,t))}}function Dw(n){return _s(n,"documentOverlays")}class Gp{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(Er(e.integerValue));else if("doubleValue"in e){const i=Er(e.doubleValue);isNaN(i)?this.ye(t,13):(this.ye(t,15),cw(i)?t.pe(0):t.pe(i))}else if("timestampValue"in e){const i=e.timestampValue;this.ye(t,20),"string"==typeof i?t.Ie(i):(t.Ie(`${i.seconds||""}`),t.pe(i.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(md(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.ye(t,45),t.pe(i.latitude||0),t.pe(i.longitude||0)}else"mapValue"in e?oP(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):Mt()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const i=e.fields||{};this.ye(t,55);for(const r of Object.keys(i))this.Te(r,t),this.me(i[r],t)}Pe(e,t){const i=e.values||[];this.ye(t,50);for(const r of i)this.me(r,t)}ve(e,t){this.ye(t,37),mt.fromName(e).path.forEach(i=>{this.ye(t,60),this.be(i,t)})}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}function TH(n){if(0===n)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function gN(n){const e=64-function(t){let i=0;for(let r=0;r<8;++r){const s=TH(255&t[r]);if(i+=s,8!==s)break}return i}(n);return Math.ceil(e/8)}Gp.Ve=new Gp;class IH{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Se(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.De(i.value),i=t.next();this.Ce()}xe(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Ne(i.value),i=t.next();this.ke()}Me(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.De(i);else if(i<2048)this.De(960|i>>>6),this.De(128|63&i);else if(t<"\ud800"||"\udbff"<t)this.De(480|i>>>12),this.De(128|63&i>>>6),this.De(128|63&i);else{const r=t.codePointAt(0);this.De(240|r>>>18),this.De(128|63&r>>>12),this.De(128|63&r>>>6),this.De(128|63&r)}}this.Ce()}$e(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Ne(i);else if(i<2048)this.Ne(960|i>>>6),this.Ne(128|63&i);else if(t<"\ud800"||"\udbff"<t)this.Ne(480|i>>>12),this.Ne(128|63&i>>>6),this.Ne(128|63&i);else{const r=t.codePointAt(0);this.Ne(240|r>>>18),this.Ne(128|63&r>>>12),this.Ne(128|63&r>>>6),this.Ne(128|63&r)}}this.ke()}Oe(e){const t=this.Fe(e),i=gN(t);this.Be(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Le(e){const t=this.Fe(e),i=gN(t);this.Be(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}qe(){this.Ue(255),this.Ue(255)}Ke(){this.Ge(255),this.Ge(255)}reset(){this.position=0}seed(e){this.Be(e.length),this.buffer.set(e,this.position),this.position+=e.length}Qe(){return this.buffer.slice(0,this.position)}Fe(e){const t=function(r){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,r,!1),new Uint8Array(s.buffer)}(e),i=0!=(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}De(e){const t=255&e;0===t?(this.Ue(0),this.Ue(255)):255===t?(this.Ue(255),this.Ue(0)):this.Ue(t)}Ne(e){const t=255&e;0===t?(this.Ge(0),this.Ge(255)):255===t?(this.Ge(255),this.Ge(0)):this.Ge(e)}Ce(){this.Ue(0),this.Ue(1)}ke(){this.Ge(0),this.Ge(1)}Ue(e){this.Be(1),this.buffer[this.position++]=e}Ge(e){this.Be(1),this.buffer[this.position++]=~e}Be(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class SH{constructor(e){this.je=e}Ae(e){this.je.Se(e)}Ie(e){this.je.Me(e)}pe(e){this.je.Oe(e)}ge(){this.je.qe()}}class CH{constructor(e){this.je=e}Ae(e){this.je.xe(e)}Ie(e){this.je.$e(e)}pe(e){this.je.Le(e)}ge(){this.je.Ke()}}class Aw{constructor(){this.je=new IH,this.ze=new SH(this.je),this.We=new CH(this.je)}seed(e){this.je.seed(e)}He(e){return 0===e?this.ze:this.We}Qe(){return this.je.Qe()}reset(){this.je.reset()}}class zp{constructor(e,t,i,r){this.indexId=e,this.documentKey=t,this.arrayValue=i,this.directionalValue=r}Je(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,i=new Uint8Array(t);return i.set(this.directionalValue,0),t!==e?i.set([0],this.directionalValue.length):++i[i.length-1],new zp(this.indexId,this.documentKey,this.arrayValue,i)}}function Rf(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=_N(n.arrayValue,e.arrayValue),0!==t?t:(t=_N(n.directionalValue,e.directionalValue),0!==t?t:mt.comparator(n.documentKey,e.documentKey)))}function _N(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(0!==i)return i}return n.length-e.length}class DH{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ye=e.orderBy,this.Xe=[];for(const t of e.filters){const i=t;i.isInequality()?this.Ze=i:this.Xe.push(i)}}tn(e){Kt(e.collectionGroup===this.collectionId);const t=YR(e);if(void 0!==t&&!this.en(t))return!1;const i=Op(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.en(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(void 0!==this.Ze){if(!r.has(this.Ze.field.canonicalString())){const c=i[s];if(!this.nn(this.Ze,c)||!this.sn(this.Ye[o++],c))return!1}++s}for(;s<i.length;++s)if(o>=this.Ye.length||!this.sn(this.Ye[o++],i[s]))return!1;return!0}en(e){for(const t of this.Xe)if(this.nn(t,e))return!0;return!1}nn(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function yN(n){var e,t;if(Kt(n instanceof Vn||n instanceof mi),n instanceof Vn){if(n instanceof yP){const r=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(s=>Vn.create(n.field,"==",s)))||[];return mi.create(r,"or")}return n}const i=n.filters.map(r=>yN(r));return mi.create(i,n.op)}function AH(n){if(0===n.getFilters().length)return[];const e=Ik(yN(n));return Kt(vN(e)),xk(e)||Tk(e)?[e]:e.getFilters()}function xk(n){return n instanceof Vn}function Tk(n){return n instanceof mi&&nk(n)}function vN(n){return xk(n)||Tk(n)||function(e){if(e instanceof mi&&tk(e)){for(const t of e.getFilters())if(!xk(t)&&!Tk(t))return!1;return!0}return!1}(n)}function Ik(n){if(Kt(n instanceof Vn||n instanceof mi),n instanceof Vn)return n;if(1===n.filters.length)return Ik(n.filters[0]);const e=n.filters.map(i=>Ik(i));let t=mi.create(e,n.op);return t=cS(t),vN(t)?t:(Kt(t instanceof mi),Kt(py(t)),Kt(t.filters.length>1),t.filters.reduce((i,r)=>Sk(i,r)))}function Sk(n,e){let t;return Kt(n instanceof Vn||n instanceof mi),Kt(e instanceof Vn||e instanceof mi),t=n instanceof Vn?e instanceof Vn?function(i,r){return mi.create([i,r],"and")}(n,e):bN(n,e):e instanceof Vn?bN(e,n):function(i,r){if(Kt(i.filters.length>0&&r.filters.length>0),py(i)&&py(r))return pP(i,r.getFilters());const s=tk(i)?i:r,o=tk(i)?r:i,c=s.filters.map(d=>Sk(d,o));return mi.create(c,"or")}(n,e),cS(t)}function bN(n,e){if(py(e))return pP(e,n.getFilters());{const t=e.filters.map(i=>Sk(n,i));return mi.create(t,"or")}}function cS(n){if(Kt(n instanceof Vn||n instanceof mi),n instanceof Vn)return n;const e=n.getFilters();if(1===e.length)return cS(e[0]);if(fP(n))return n;const t=e.map(r=>cS(r)),i=[];return t.forEach(r=>{r instanceof Vn?i.push(r):r instanceof mi&&(r.op===n.op?i.push(...r.filters):i.push(r))}),1===i.length?i[0]:mi.create(i,n.op)}class RH{constructor(){this.rn=new Ck}addToCollectionParentIndex(e,t){return this.rn.add(t),ge.resolve()}getCollectionParents(e,t){return ge.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return ge.resolve()}deleteFieldIndex(e,t){return ge.resolve()}getDocumentsMatchingTarget(e,t){return ge.resolve(null)}getIndexType(e,t){return ge.resolve(0)}getFieldIndexes(e,t){return ge.resolve([])}getNextCollectionGroupToUpdate(e){return ge.resolve(null)}getMinOffset(e,t){return ge.resolve(Fa.min())}getMinOffsetFromCollectionGroup(e,t){return ge.resolve(Fa.min())}updateCollectionGroup(e,t,i){return ge.resolve()}updateIndexEntries(e,t){return ge.resolve()}}class Ck{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new $i(Xn.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new $i(Xn.comparator)).toArray()}}const uS=new Uint8Array(0);class kH{constructor(e,t){this.user=e,this.databaseId=t,this.on=new Ck,this.un=new gd(i=>Fp(i),(i,r)=>mw(i,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.on.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.on.add(t)});const s={collectionId:i,parent:eo(r)};return wN(e).put(s)}return ge.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[VO(t),""],!1,!0);return wN(e).j(r).next(s=>{for(const o of s){if(o.collectionId!==t)break;i.push(du(o.parent))}return i})}addFieldIndex(e,t){const i=dS(e),r=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=kw(e);return s.next(c=>{o.put(fN(c,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const i=dS(e),r=kw(e),s=Rw(e);return i.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const i=Rw(e);let r=!0;const s=new Map;return ge.forEach(this.cn(t),o=>this.an(e,o).next(c=>{r&&(r=!!c),s.set(o,c)})).next(()=>{if(r){let o=Sn();const c=[];return ge.forEach(s,(d,m)=>{var g;nt("IndexedDbIndexManager",`Using index ${g=d,`id=${g.indexId}|cg=${g.collectionGroup}|f=${g.fields.map(W=>`${W.fieldPath}:${W.kind}`).join(",")}`} to execute ${Fp(t)}`);const v=function(W,te){const oe=YR(te);if(void 0===oe)return null;for(const Ae of JI(W,oe.fieldPath))switch(Ae.op){case"array-contains-any":return Ae.value.arrayValue.values||[];case"array-contains":return[Ae.value]}return null}(m,d),E=function(W,te){const oe=new Map;for(const Ae of Op(te))for(const we of JI(W,Ae.fieldPath))switch(we.op){case"==":case"in":oe.set(Ae.fieldPath.canonicalString(),we.value);break;case"not-in":case"!=":return oe.set(Ae.fieldPath.canonicalString(),we.value),Array.from(oe.values())}return null}(m,d),T=function(W,te){const oe=[];let Ae=!0;for(const we of Op(te)){const Ge=0===we.kind?vP(W,we.fieldPath,W.startAt):bP(W,we.fieldPath,W.startAt);oe.push(Ge.value),Ae&&(Ae=Ge.inclusive)}return new Df(oe,Ae)}(m,d),C=function(W,te){const oe=[];let Ae=!0;for(const we of Op(te)){const Ge=0===we.kind?bP(W,we.fieldPath,W.endAt):vP(W,we.fieldPath,W.endAt);oe.push(Ge.value),Ae&&(Ae=Ge.inclusive)}return new Df(oe,Ae)}(m,d),k=this.hn(d,m,T),P=this.hn(d,m,C),G=this.ln(d,m,E),Y=this.fn(d.indexId,v,k,T.inclusive,P,C.inclusive,G);return ge.forEach(Y,W=>i.H(W,t.limit).next(te=>{te.forEach(oe=>{const Ae=mt.fromSegments(oe.documentKey);o.has(Ae)||(o=o.add(Ae),c.push(Ae))})}))}).next(()=>c)}return ge.resolve(null)})}cn(e){let t=this.un.get(e);return t||(t=0===e.filters.length?[e]:AH(mi.create(e.filters,"and")).map(i=>rk(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}fn(e,t,i,r,s,o,c){const d=(null!=t?t.length:1)*Math.max(i.length,s.length),m=d/(null!=t?t.length:1),g=[];for(let v=0;v<d;++v){const E=t?this.dn(t[v/m]):uS,T=this.wn(e,E,i[v%m],r),C=this._n(e,E,s[v%m],o),k=c.map(P=>this.wn(e,E,P,!0));g.push(...this.createRange(T,C,k))}return g}wn(e,t,i,r){const s=new zp(e,mt.empty(),t,i);return r?s:s.Je()}_n(e,t,i,r){const s=new zp(e,mt.empty(),t,i);return r?s.Je():s}an(e,t){const i=new DH(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(s=>{let o=null;for(const c of s)i.tn(c)&&(!o||c.fields.length>o.fields.length)&&(o=c);return o})}getIndexType(e,t){let i=2;const r=this.cn(t);return ge.forEach(r,s=>this.an(e,s).next(o=>{o?0!==i&&o.fields.length<function(c){let d=new $i(wr.comparator),m=!1;for(const g of c.filters)for(const v of g.getFlattenedFilters())v.field.isKeyField()||("array-contains"===v.op||"array-contains-any"===v.op?m=!0:d=d.add(v.field));for(const g of c.orderBy)g.field.isKeyField()||(d=d.add(g.field));return d.size+(m?1:0)}(s)&&(i=1):i=0})).next(()=>function(s){return null!==s.limit}(t)&&r.length>1&&2===i?1:i)}mn(e,t){const i=new Aw;for(const r of Op(e)){const s=t.data.field(r.fieldPath);if(null==s)return null;const o=i.He(r.kind);Gp.Ve._e(s,o)}return i.Qe()}dn(e){const t=new Aw;return Gp.Ve._e(e,t.He(0)),t.Qe()}gn(e,t){const i=new Aw;return Gp.Ve._e(Np(this.databaseId,t),i.He(function(r){const s=Op(r);return 0===s.length?0:s[s.length-1].kind}(e))),i.Qe()}ln(e,t,i){if(null===i)return[];let r=[];r.push(new Aw);let s=0;for(const o of Op(e)){const c=i[s++];for(const d of r)if(this.yn(t,o.fieldPath)&&hw(c))r=this.pn(r,o,c);else{const m=d.He(o.kind);Gp.Ve._e(c,m)}}return this.In(r)}hn(e,t,i){return this.ln(e,t,i.position)}In(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].Qe();return t}pn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const c of r){const d=new Aw;d.seed(c.Qe()),Gp.Ve._e(o,d.He(t.kind)),s.push(d)}return s}yn(e,t){return!!e.filters.find(i=>i instanceof Vn&&i.field.isEqual(t)&&("in"===i.op||"not-in"===i.op))}getFieldIndexes(e,t){const i=dS(e),r=kw(e);return(t?i.j("collectionGroupIndex",IDBKeyRange.bound(t,t)):i.j()).next(s=>{const o=[];return ge.forEach(s,c=>r.get([c.indexId,this.uid]).next(d=>{o.push(function(m,g){const v=g?new ow(g.sequenceNumber,new Fa(Hp(g.readTime),new mt(du(g.documentKey)),g.largestBatchId)):ow.empty(),E=m.fields.map(([T,C])=>new jI(wr.fromServerFormat(T),C));return new HI(m.indexId,m.collectionGroup,E,v)}(c,d))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return 0!==s?s:bn(i.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,i){const r=dS(e),s=kw(e);return this.Tn(e).next(o=>r.j("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(c=>ge.forEach(c,d=>s.put(fN(d.indexId,this.user,o,i)))))}updateIndexEntries(e,t){const i=new Map;return ge.forEach(t,(r,s)=>{const o=i.get(r.collectionGroup);return(o?ge.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(c=>(i.set(r.collectionGroup,c),ge.forEach(c,d=>this.En(e,r,d).next(m=>{const g=this.An(s,d);return m.isEqual(g)?ge.resolve():this.vn(e,s,d,m,g)}))))})}Rn(e,t,i,r){return Rw(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.gn(i,t.key),documentKey:t.key.path.toArray()})}Pn(e,t,i,r){return Rw(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.gn(i,t.key),t.key.path.toArray()])}En(e,t,i){const r=Rw(e);let s=new $i(Rf);return r.X({index:"documentKeyIndex",range:IDBKeyRange.only([i.indexId,this.uid,this.gn(i,t)])},(o,c)=>{s=s.add(new zp(i.indexId,t,c.arrayValue,c.directionalValue))}).next(()=>s)}An(e,t){let i=new $i(Rf);const r=this.mn(t,e);if(null==r)return i;const s=YR(t);if(null!=s){const o=e.data.field(s.fieldPath);if(hw(o))for(const c of o.arrayValue.values||[])i=i.add(new zp(t.indexId,e.key,this.dn(c),r))}else i=i.add(new zp(t.indexId,e.key,uS,r));return i}vn(e,t,i,r,s){nt("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(c,d,m,g,v){const E=c.getIterator(),T=d.getIterator();let C=hy(E),k=hy(T);for(;C||k;){let P=!1,G=!1;if(C&&k){const Y=m(C,k);Y<0?G=!0:Y>0&&(P=!0)}else null!=C?G=!0:P=!0;P?(g(k),k=hy(T)):G?(v(C),C=hy(E)):(C=hy(E),k=hy(T))}}(r,s,Rf,c=>{o.push(this.Rn(e,t,i,c))},c=>{o.push(this.Pn(e,t,i,c))}),ge.waitFor(o)}Tn(e){let t=1;return kw(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(i,r,s)=>{s.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,i){i=i.sort((o,c)=>Rf(o,c)).filter((o,c,d)=>!c||0!==Rf(o,d[c-1]));const r=[];r.push(e);for(const o of i){const c=Rf(o,e),d=Rf(o,t);if(0===c)r[0]=e.Je();else if(c>0&&d<0)r.push(o),r.push(o.Je());else if(d>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.bn(r[o],r[o+1]))return[];s.push(IDBKeyRange.bound([r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,uS,[]],[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,uS,[]]))}return s}bn(e,t){return Rf(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(EN)}getMinOffset(e,t){return ge.mapArray(this.cn(t),i=>this.an(e,i).next(r=>r||Mt())).next(EN)}}function wN(n){return _s(n,"collectionParents")}function Rw(n){return _s(n,"indexEntries")}function dS(n){return _s(n,"indexConfiguration")}function kw(n){return _s(n,"indexState")}function EN(n){Kt(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;ZR(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Fa(e.readTime,e.documentKey,t)}const xN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class to{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new to(e,to.DEFAULT_COLLECTION_PERCENTILE,to.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function TN(n,e,t){const i=n.store("mutations"),r=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId);let c=0;const d=i.X({range:o},(g,v,E)=>(c++,E.delete()));s.push(d.next(()=>{Kt(1===c)}));const m=[];for(const g of t.mutations){const v=YO(e,g.key.path,t.batchId);s.push(r.delete(v)),m.push(g.key)}return ge.waitFor(s).next(()=>m)}function hS(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Mt();e=n.noDocument}return JSON.stringify(e).length}to.DEFAULT_COLLECTION_PERCENTILE=10,to.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,to.DEFAULT=new to(41943040,to.DEFAULT_COLLECTION_PERCENTILE,to.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),to.DISABLED=new to(-1,0,0);class fS{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Vn={}}static de(e,t,i,r){Kt(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new fS(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return kf(e).X({index:"userMutationsIndex",range:i},(r,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,i,r){const s=xy(e),o=kf(e);return o.add({}).next(c=>{Kt("number"==typeof c);const d=new dk(c,t,i,r),m=function(E,T,C){const k=C.baseMutations.map(G=>Sw(E.fe,G)),P=C.mutations.map(G=>Sw(E.fe,G));return{userId:T,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:k,mutations:P}}(this.serializer,this.userId,d),g=[];let v=new $i((E,T)=>bn(E.canonicalString(),T.canonicalString()));for(const E of r){const T=YO(this.userId,E.key.path,c);v=v.add(E.key.path.popLast()),g.push(o.put(m)),g.push(s.put(T,y3))}return v.forEach(E=>{g.push(this.indexManager.addToCollectionParentIndex(e,E))}),e.addOnCommittedListener(()=>{this.Vn[c]=d.keys()}),ge.waitFor(g).next(()=>d)})}lookupMutationBatch(e,t){return kf(e).get(t).next(i=>i?(Kt(i.userId===this.userId),jp(this.serializer,i)):null)}Sn(e,t){return this.Vn[t]?ge.resolve(this.Vn[t]):this.lookupMutationBatch(e,t).next(i=>{if(i){const r=i.keys();return this.Vn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return kf(e).X({index:"userMutationsIndex",range:r},(o,c,d)=>{c.userId===this.userId&&(Kt(c.batchId>=i),s=jp(this.serializer,c)),d.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=-1;return kf(e).X({index:"userMutationsIndex",range:t,reverse:!0},(r,s,o)=>{i=s.batchId,o.done()}).next(()=>i)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return kf(e).j("userMutationsIndex",t).next(i=>i.map(r=>jp(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=zI(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return xy(e).X({range:r},(o,c,d)=>{const[m,g,v]=o,E=du(g);if(m===this.userId&&t.path.isEqual(E))return kf(e).get(v).next(T=>{if(!T)throw Mt();Kt(T.userId===this.userId),s.push(jp(this.serializer,T))});d.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new $i(bn);const r=[];return t.forEach(s=>{const o=zI(this.userId,s.path),c=IDBKeyRange.lowerBound(o),d=xy(e).X({range:c},(m,g,v)=>{const[E,T,C]=m,k=du(T);E===this.userId&&s.path.isEqual(k)?i=i.add(C):v.done()});r.push(d)}),ge.waitFor(r).next(()=>this.Dn(e,i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=zI(this.userId,i),o=IDBKeyRange.lowerBound(s);let c=new $i(bn);return xy(e).X({range:o},(d,m,g)=>{const[v,E,T]=d,C=du(E);v===this.userId&&i.isPrefixOf(C)?C.length===r&&(c=c.add(T)):g.done()}).next(()=>this.Dn(e,c))}Dn(e,t){const i=[],r=[];return t.forEach(s=>{r.push(kf(e).get(s).next(o=>{if(null===o)throw Mt();Kt(o.userId===this.userId),i.push(jp(this.serializer,o))}))}),ge.waitFor(r).next(()=>i)}removeMutationBatch(e,t){return TN(e.ht,this.userId,t).next(i=>(e.addOnCommittedListener(()=>{this.Cn(t.batchId)}),ge.forEach(i,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}Cn(e){delete this.Vn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return ge.resolve();const i=IDBKeyRange.lowerBound([this.userId]),r=[];return xy(e).X({range:i},(s,o,c)=>{if(s[0]===this.userId){const d=du(s[1]);r.push(d)}else c.done()}).next(()=>{Kt(0===r.length)})})}containsKey(e,t){return IN(e,this.userId,t)}xn(e){return SN(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function IN(n,e,t){const i=zI(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return xy(n).X({range:s,Y:!0},(c,d,m)=>{const[g,v,E]=c;g===e&&v===r&&(o=!0),m.done()}).next(()=>o)}function kf(n){return _s(n,"mutations")}function xy(n){return _s(n,"documentMutations")}function SN(n){return _s(n,"mutationQueues")}class Wp{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new Wp(0)}static Mn(){return new Wp(-1)}}class MH{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.$n(e).next(t=>{const i=new Wp(t.highestTargetId);return t.highestTargetId=i.next(),this.On(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.$n(e).next(t=>qt.fromTimestamp(new Xi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.$n(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,i){return this.$n(e).next(r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.On(e,r)))}addTargetData(e,t){return this.Fn(e,t).next(()=>this.$n(e).next(i=>(i.targetCount+=1,this.Bn(t,i),this.On(e,i))))}updateTargetData(e,t){return this.Fn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Ty(e).delete(t.targetId)).next(()=>this.$n(e)).next(i=>(Kt(i.targetCount>0),i.targetCount-=1,this.On(e,i)))}removeTargets(e,t,i){let r=0;const s=[];return Ty(e).X((o,c)=>{const d=Cw(c);d.sequenceNumber<=t&&null===i.get(d.targetId)&&(r++,s.push(this.removeTargetData(e,d)))}).next(()=>ge.waitFor(s)).next(()=>r)}forEachTarget(e,t){return Ty(e).X((i,r)=>{const s=Cw(r);t(s)})}$n(e){return CN(e).get("targetGlobalKey").next(t=>(Kt(null!==t),t))}On(e,t){return CN(e).put("targetGlobalKey",t)}Fn(e,t){return Ty(e).put(dN(this.serializer,t))}Bn(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.$n(e).next(t=>t.targetCount)}getTargetData(e,t){const i=Fp(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return Ty(e).X({range:r,index:"queryTargetsIndex"},(o,c,d)=>{const m=Cw(c);mw(t,m.target)&&(s=m,d.done())}).next(()=>s)}addMatchingKeys(e,t,i){const r=[],s=Mf(e);return t.forEach(o=>{const c=eo(o.path);r.push(s.put({targetId:i,path:c})),r.push(this.referenceDelegate.addReference(e,i,o))}),ge.waitFor(r)}removeMatchingKeys(e,t,i){const r=Mf(e);return ge.forEach(t,s=>{const o=eo(s.path);return ge.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])})}removeMatchingKeysForTargetId(e,t){const i=Mf(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Mf(e);let s=Sn();return r.X({range:i,Y:!0},(o,c,d)=>{const m=du(o[1]),g=new mt(m);s=s.add(g)}).next(()=>s)}containsKey(e,t){const i=eo(t.path),r=IDBKeyRange.bound([i],[VO(i)],!1,!0);let s=0;return Mf(e).X({index:"documentTargetsIndex",Y:!0,range:r},([o,c],d,m)=>{0!==o&&(s++,m.done())}).next(()=>s>0)}le(e,t){return Ty(e).get(t).next(i=>i?Cw(i):null)}}function Ty(n){return _s(n,"targets")}function CN(n){return _s(n,"targetGlobal")}function Mf(n){return _s(n,"targetDocuments")}function DN([n,e],[t,i]){const r=bn(n,t);return 0===r?bn(e,i):r}class LH{constructor(e){this.Ln=e,this.buffer=new $i(DN),this.qn=0}Un(){return++this.qn}Kn(e){const t=[e,this.Un()];if(this.buffer.size<this.Ln)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();DN(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class AN{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Gn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Qn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return null!==this.Gn}Qn(e){var t=this;nt("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,Te.Z)(function*(){t.Gn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(i){wf(i)?nt("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",i):yield bf(i)}yield t.Qn(3e5)}))}}class OH{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.zn(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(0===t)return ge.resolve(Ba.ct);const i=new LH(t);return this.jn.forEachTarget(e,r=>i.Kn(r.sequenceNumber)).next(()=>this.jn.Wn(e,r=>i.Kn(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.jn.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(nt("LruGarbageCollector","Garbage collection skipped; disabled"),ge.resolve(xN)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(nt("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),xN):this.Hn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Hn(e,t){let i,r,s,o,c,d,m;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(v=>(v>this.params.maximumSequenceNumbersToCollect?(nt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),r=this.params.maximumSequenceNumbersToCollect):r=v,o=Date.now(),this.nthSequenceNumber(e,r))).next(v=>(i=v,c=Date.now(),this.removeTargets(e,i,t))).next(v=>(s=v,d=Date.now(),this.removeOrphanedDocuments(e,i))).next(v=>(m=Date.now(),KR()<=nu.in.DEBUG&&nt("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-g}ms\n\tDetermined least recently used ${r} in `+(c-o)+`ms\n\tRemoved ${s} targets in `+(d-c)+`ms\n\tRemoved ${v} documents in `+(m-d)+`ms\nTotal Duration: ${m-g}ms`),ge.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:v})))}}class PH{constructor(e,t){this.db=e,this.garbageCollector=function RN(n,e){return new OH(n,e)}(this,t)}zn(e){const t=this.Jn(e);return this.db.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}Jn(e){let t=0;return this.Wn(e,i=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Wn(e,t){return this.Yn(e,(i,r)=>t(r))}addReference(e,t,i){return mS(e,i)}removeReference(e,t,i){return mS(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return mS(e,t)}Xn(e,t){return function(i,r){let s=!1;return SN(i).Z(o=>IN(i,o,r).next(c=>(c&&(s=!0),ge.resolve(!c)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Yn(e,(o,c)=>{if(c<=t){const d=this.Xn(e,o).next(m=>{if(!m)return s++,i.getEntry(e,o).next(()=>(i.removeEntry(o,qt.min()),Mf(e).delete([0,eo(o.path)])))});r.push(d)}}).next(()=>ge.waitFor(r)).next(()=>i.apply(e)).next(()=>s)}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return mS(e,t)}Yn(e,t){const i=Mf(e);let r,s=Ba.ct;return i.X({index:"documentTargetsIndex"},([o,c],{path:d,sequenceNumber:m})=>{0===o?(s!==Ba.ct&&t(new mt(du(r)),s),s=m,r=d):s=Ba.ct}).next(()=>{s!==Ba.ct&&t(new mt(du(r)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function mS(n,e){return Mf(n).put(function(t,i){return{targetId:0,path:eo(t.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}class kN{constructor(){this.changes=new gd(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Hi.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return void 0!==i?ge.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class NH{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Kp(e).put(i)}removeEntry(e,t,i){return Kp(e).delete(function(r,s){const o=r.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],aS(s),o[o.length-1]]}(t,i))}updateMetadata(e,t){return this.getMetadata(e).next(i=>(i.byteSize+=t,this.Zn(e,i)))}getEntry(e,t){let i=Hi.newInvalidDocument(t);return Kp(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Mw(t))},(r,s)=>{i=this.ts(t,s)}).next(()=>i)}es(e,t){let i={size:0,document:Hi.newInvalidDocument(t)};return Kp(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Mw(t))},(r,s)=>{i={document:this.ts(t,s),size:hS(s)}}).next(()=>i)}getEntries(e,t){let i=ea();return this.ns(e,t,(r,s)=>{const o=this.ts(r,s);i=i.insert(r,o)}).next(()=>i)}ss(e,t){let i=ea(),r=new Ri(mt.comparator);return this.ns(e,t,(s,o)=>{const c=this.ts(s,o);i=i.insert(s,c),r=r.insert(s,hS(o))}).next(()=>({documents:i,rs:r}))}ns(e,t,i){if(t.isEmpty())return ge.resolve();let r=new $i(PN);t.forEach(d=>r=r.add(d));const s=IDBKeyRange.bound(Mw(r.first()),Mw(r.last())),o=r.getIterator();let c=o.getNext();return Kp(e).X({index:"documentKeyIndex",range:s},(d,m,g)=>{const v=mt.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;c&&PN(c,v)<0;)i(c,null),c=o.getNext();c&&c.isEqual(v)&&(i(c,m),c=o.hasNext()?o.getNext():null),c?g.G(Mw(c)):g.done()}).next(()=>{for(;c;)i(c,null),c=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,i,r){const s=t.path,o=[s.popLast().toArray(),s.lastSegment(),aS(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],c=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Kp(e).j(IDBKeyRange.bound(o,c,!0)).next(d=>{let m=ea();for(const g of d){const v=this.ts(mt.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);v.isFoundDocument()&&(gw(t,v)||r.has(v.key))&&(m=m.insert(v.key,v))}return m})}getAllFromCollectionGroup(e,t,i,r){let s=ea();const o=ON(t,i),c=ON(t,Fa.max());return Kp(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,c,!0)},(d,m,g)=>{const v=this.ts(mt.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);s=s.insert(v.key,v),s.size===r&&g.done()}).next(()=>s)}newChangeBuffer(e){return new FH(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return LN(e).get("remoteDocumentGlobalKey").next(t=>(Kt(!!t),t))}Zn(e,t){return LN(e).put("remoteDocumentGlobalKey",t)}ts(e,t){if(t){const i=function EH(n,e){let t;if(e.document)t=iN(n.fe,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=mt.fromSegments(e.noDocument.path),r=Hp(e.noDocument.readTime);t=Hi.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Mt();{const i=mt.fromSegments(e.unknownDocument.path),r=Hp(e.unknownDocument.version);t=Hi.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime(function(i){const r=new Xi(i[0],i[1]);return qt.fromTimestamp(r)}(e.readTime)),t}(this.serializer,t);if(!i.isNoDocument()||!i.version.isEqual(qt.min()))return i}return Hi.newInvalidDocument(e)}}function MN(n){return new NH(n)}class FH extends kN{constructor(e,t){super(),this.os=e,this.trackRemovals=t,this.us=new gd(i=>i.toString(),(i,r)=>i.isEqual(r))}applyChanges(e){const t=[];let i=0,r=new $i((s,o)=>bn(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const c=this.us.get(s);if(t.push(this.os.removeEntry(e,s,c.readTime)),o.isValidDocument()){const d=uN(this.os.serializer,o);r=r.add(s.path.popLast());const m=hS(d);i+=m-c.size,t.push(this.os.addEntry(e,s,d))}else if(i-=c.size,this.trackRemovals){const d=uN(this.os.serializer,o.convertToNoDocument(qt.min()));t.push(this.os.addEntry(e,s,d))}}),r.forEach(s=>{t.push(this.os.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.os.updateMetadata(e,i)),ge.waitFor(t)}getFromCache(e,t){return this.os.es(e,t).next(i=>(this.us.set(t,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(e,t){return this.os.ss(e,t).next(({documents:i,rs:r})=>(r.forEach((s,o)=>{this.us.set(s,{size:o,readTime:i.get(s).readTime})}),i))}}function LN(n){return _s(n,"remoteDocumentGlobal")}function Kp(n){return _s(n,"remoteDocumentsV14")}function Mw(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function ON(n,e){const t=e.documentKey.path.toArray();return[n,aS(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function PN(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=bn(t[s],i[s]),r)return r;return r=bn(t.length,i.length),r||(r=bn(t[t.length-2],i[i.length-2]),r||bn(t[t.length-1],i[i.length-1]))}class BH{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class NN{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(null!==i&&bw(i.mutation,r,Jo.empty(),Xi.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,Sn()).next(()=>i))}getLocalViewOfDocuments(e,t,i=Sn()){const r=fu();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let o=_w();return s.forEach((c,d)=>{o=o.insert(c,d.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const i=fu();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,Sn()))}populateOverlays(e,t,i){const r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,c)=>{t.set(o,c)})})}computeViews(e,t,i,r){let s=ea();const o=yw(),c=yw();return t.forEach((d,m)=>{const g=i.get(m.key);r.has(m.key)&&(void 0===g||g.mutation instanceof _d)?s=s.insert(m.key,m):void 0!==g?(o.set(m.key,g.mutation.getFieldMask()),bw(g.mutation,m,g.mutation.getFieldMask(),Xi.now())):o.set(m.key,Jo.empty())}),this.recalculateAndSaveOverlays(e,s).next(d=>(d.forEach((m,g)=>o.set(m,g)),t.forEach((m,g)=>{var v;return c.set(m,new BH(g,null!==(v=o.get(m))&&void 0!==v?v:null))}),c))}recalculateAndSaveOverlays(e,t){const i=yw();let r=new Ri((o,c)=>o-c),s=Sn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const c of o)c.keys().forEach(d=>{const m=t.get(d);if(null===m)return;let g=i.get(d)||Jo.empty();g=c.applyToLocalView(m,g),i.set(d,g);const v=(r.get(c.batchId)||Sn()).add(d);r=r.insert(c.batchId,v)})}).next(()=>{const o=[],c=r.getReverseIterator();for(;c.hasNext();){const d=c.getNext(),m=d.key,g=d.value,v=DP();g.forEach(E=>{if(!s.has(E)){const T=FP(t.get(E),i.get(E));null!==T&&v.set(E,T),s=s.add(E)}}),o.push(this.documentOverlayCache.saveOverlays(e,m,v))}return ge.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i){return function(r){return mt.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ok(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i):this.getDocumentsMatchingCollectionQuery(e,t,i)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):ge.resolve(fu());let c=-1,d=s;return o.next(m=>ge.forEach(m,(g,v)=>(c<v.largestBatchId&&(c=v.largestBatchId),s.get(g)?ge.resolve():this.remoteDocumentCache.getEntry(e,g).next(E=>{d=d.insert(g,E)}))).next(()=>this.populateOverlays(e,m,s)).next(()=>this.computeViews(e,d,m,Sn())).next(g=>({batchId:c,changes:CP(g)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new mt(t)).next(i=>{let r=_w();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i){const r=t.collectionGroup;let s=_w();return this.indexManager.getCollectionParents(e,r).next(o=>ge.forEach(o,c=>{const d=(m=t,g=c.child(r),new pd(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt));var m,g;return this.getDocumentsMatchingCollectionQuery(e,d,i).next(m=>{m.forEach((g,v)=>{s=s.insert(g,v)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,i){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(s=>(r=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,r))).next(s=>{r.forEach((c,d)=>{const m=d.getKey();null===s.get(m)&&(s=s.insert(m,Hi.newInvalidDocument(m)))});let o=_w();return s.forEach((c,d)=>{const m=r.get(c);void 0!==m&&bw(m.mutation,d,Jo.empty(),Xi.now()),gw(t,d)&&(o=o.insert(c,d))}),o})}}class UH{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return ge.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var i;return this.cs.set(t.id,{id:(i=t).id,version:i.version,createTime:kr(i.createTime)}),ge.resolve()}getNamedQuery(e,t){return ge.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,function(i){return{name:i.name,query:wk(i.bundledQuery),readTime:kr(i.readTime)}}(t)),ge.resolve()}}class VH{constructor(){this.overlays=new Ri(mt.comparator),this.ls=new Map}getOverlay(e,t){return ge.resolve(this.overlays.get(t))}getOverlays(e,t){const i=fu();return ge.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.we(e,t,s)}),ge.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.ls.get(i);return void 0!==r&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.ls.delete(i)),ge.resolve()}getOverlaysForCollection(e,t,i){const r=fu(),s=t.length+1,o=new mt(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const d=c.getNext().value,m=d.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===s&&d.largestBatchId>i&&r.set(d.getKey(),d)}return ge.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new Ri((m,g)=>m-g);const o=this.overlays.getIterator();for(;o.hasNext();){const m=o.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>i){let g=s.get(m.largestBatchId);null===g&&(g=fu(),s=s.insert(m.largestBatchId,g)),g.set(m.getKey(),m)}}const c=fu(),d=s.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((m,g)=>c.set(m,g)),!(c.size()>=r)););return ge.resolve(c)}we(e,t,i){const r=this.overlays.get(i.key);if(null!==r){const o=this.ls.get(r.largestBatchId).delete(i.key);this.ls.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new fk(t,i));let s=this.ls.get(t);void 0===s&&(s=Sn(),this.ls.set(t,s)),this.ls.set(t,s.add(i.key))}}class Dk{constructor(){this.fs=new $i(ys.ds),this.ws=new $i(ys._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const i=new ys(e,t);this.fs=this.fs.add(i),this.ws=this.ws.add(i)}gs(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.ys(new ys(e,t))}ps(e,t){e.forEach(i=>this.removeReference(i,t))}Is(e){const t=new mt(new Xn([])),i=new ys(t,e),r=new ys(t,e+1),s=[];return this.ws.forEachInRange([i,r],o=>{this.ys(o),s.push(o.key)}),s}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new mt(new Xn([])),i=new ys(t,e),r=new ys(t,e+1);let s=Sn();return this.ws.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new ys(e,0),i=this.fs.firstAfterOrEqual(t);return null!==i&&e.isEqual(i.key)}}class ys{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return mt.comparator(e.key,t.key)||bn(e.As,t.As)}static _s(e,t){return bn(e.As,t.As)||mt.comparator(e.key,t.key)}}class $H{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new $i(ys.ds)}checkEmpty(e){return ge.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,i,r){const s=this.vs;this.vs++;const o=new dk(s,t,i,r);this.mutationQueue.push(o);for(const c of r)this.Rs=this.Rs.add(new ys(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return ge.resolve(o)}lookupMutationBatch(e,t){return ge.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const r=this.bs(t+1),s=r<0?0:r;return ge.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ge.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return ge.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new ys(t,0),r=new ys(t,Number.POSITIVE_INFINITY),s=[];return this.Rs.forEachInRange([i,r],o=>{const c=this.Ps(o.As);s.push(c)}),ge.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new $i(bn);return t.forEach(r=>{const s=new ys(r,0),o=new ys(r,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([s,o],c=>{i=i.add(c.As)})}),ge.resolve(this.Vs(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;mt.isDocumentKey(s)||(s=s.child(""));const o=new ys(new mt(s),0);let c=new $i(bn);return this.Rs.forEachWhile(d=>{const m=d.key.path;return!!i.isPrefixOf(m)&&(m.length===r&&(c=c.add(d.As)),!0)},o),ge.resolve(this.Vs(c))}Vs(e){const t=[];return e.forEach(i=>{const r=this.Ps(i);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){Kt(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let i=this.Rs;return ge.forEach(t.mutations,r=>{const s=new ys(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Rs=i})}Cn(e){}containsKey(e,t){const i=new ys(t,0),r=this.Rs.firstAfterOrEqual(i);return ge.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return ge.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class HH{constructor(e){this.Ds=e,this.docs=new Ri(mt.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.Ds(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return ge.resolve(i?i.document.mutableCopy():Hi.newInvalidDocument(t))}getEntries(e,t){let i=ea();return t.forEach(r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Hi.newInvalidDocument(r))}),ge.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=ea();const o=t.path,c=new mt(o.child("")),d=this.docs.getIteratorFrom(c);for(;d.hasNext();){const{key:m,value:{document:g}}=d.getNext();if(!o.isPrefixOf(m.path))break;m.path.length>o.length+1||ZR(HO(g),i)<=0||(r.has(g.key)||gw(t,g))&&(s=s.insert(g.key,g.mutableCopy()))}return ge.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Mt()}Cs(e,t){return ge.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new jH(this)}getSize(e){return ge.resolve(this.size)}}class jH extends kN{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.os.addEntry(e,r)):this.os.removeEntry(i)}),ge.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}class GH{constructor(e){this.persistence=e,this.xs=new gd(t=>Fp(t),mw),this.lastRemoteSnapshotVersion=qt.min(),this.highestTargetId=0,this.Ns=0,this.ks=new Dk,this.targetCount=0,this.Ms=Wp.kn()}forEachTarget(e,t){return this.xs.forEach((i,r)=>t(r)),ge.resolve()}getLastRemoteSnapshotVersion(e){return ge.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ge.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),ge.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Ns&&(this.Ns=t),ge.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new Wp(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,ge.resolve()}updateTargetData(e,t){return this.Fn(t),ge.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,ge.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.xs.forEach((o,c)=>{c.sequenceNumber<=t&&null===i.get(c.targetId)&&(this.xs.delete(o),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),r++)}),ge.waitFor(s).next(()=>r)}getTargetCount(e){return ge.resolve(this.targetCount)}getTargetData(e,t){const i=this.xs.get(t)||null;return ge.resolve(i)}addMatchingKeys(e,t,i){return this.ks.gs(t,i),ge.resolve()}removeMatchingKeys(e,t,i){this.ks.ps(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),ge.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),ge.resolve()}getMatchingKeysForTargetId(e,t){const i=this.ks.Es(t);return ge.resolve(i)}containsKey(e,t){return ge.resolve(this.ks.containsKey(t))}}class Ak{constructor(e,t){this.$s={},this.overlays={},this.Os=new Ba(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new GH(this),this.indexManager=new RH,this.remoteDocumentCache=function(i){return new HH(i)}(i=>this.referenceDelegate.Ls(i)),this.serializer=new cN(t),this.qs=new UH(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new VH,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.$s[e.toKey()];return i||(i=new $H(t,this.referenceDelegate),this.$s[e.toKey()]=i),i}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,i){nt("MemoryPersistence","Starting transaction:",e);const r=new zH(this.Os.next());return this.referenceDelegate.Us(),i(r).next(s=>this.referenceDelegate.Ks(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Gs(e,t){return ge.or(Object.values(this.$s).map(i=>()=>i.containsKey(e,t)))}}class zH extends GO{constructor(e){super(),this.currentSequenceNumber=e}}class pS{constructor(e){this.persistence=e,this.Qs=new Dk,this.js=null}static zs(e){return new pS(e)}get Ws(){if(this.js)return this.js;throw Mt()}addReference(e,t,i){return this.Qs.addReference(i,t),this.Ws.delete(i.toString()),ge.resolve()}removeReference(e,t,i){return this.Qs.removeReference(i,t),this.Ws.add(i.toString()),ge.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),ge.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(r=>this.Ws.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.Ws.add(s.toString()))}).next(()=>i.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ge.forEach(this.Ws,i=>{const r=mt.fromPath(i);return this.Hs(e,r).next(s=>{s||t.removeEntry(r,qt.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(i=>{i?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return ge.or([()=>ge.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}class WH{constructor(e){this.serializer=e}O(e,t,i,r){const s=new GI("createOrUpgrade",t);i<1&&r>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",qO,{unique:!0}),c.createObjectStore("documentMutations")}(e),FN(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=ge.resolve();return i<3&&r>=3&&(0!==i&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),FN(e)),o=o.next(()=>function(c){const d=c.store("targetGlobal"),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:qt.min().toTimestamp(),targetCount:0};return d.put("targetGlobalKey",m)}(s))),i<4&&r>=4&&(0!==i&&(o=o.next(()=>function(c,d){return d.store("mutations").j().next(m=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",qO,{unique:!0});const g=d.store("mutations"),v=m.map(E=>g.put(E));return ge.waitFor(v)})}(e,s))),o=o.next(()=>{!function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),i<5&&r>=5&&(o=o.next(()=>this.Ys(s))),i<6&&r>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.Xs(s)))),i<7&&r>=7&&(o=o.next(()=>this.Zs(s))),i<8&&r>=8&&(o=o.next(()=>this.ti(e,s))),i<9&&r>=9&&(o=o.next(()=>{!function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")}(e)})),i<10&&r>=10&&(o=o.next(()=>this.ei(s))),i<11&&r>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),i<12&&r>=12&&(o=o.next(()=>{!function(c){const d=c.createObjectStore("documentOverlays",{keyPath:R3});d.createIndex("collectionPathOverlayIndex",k3,{unique:!1}),d.createIndex("collectionGroupOverlayIndex",M3,{unique:!1})}(e)})),i<13&&r>=13&&(o=o.next(()=>function(c){const d=c.createObjectStore("remoteDocumentsV14",{keyPath:v3});d.createIndex("documentKeyIndex",b3),d.createIndex("collectionGroupIndex",w3)}(e)).next(()=>this.ni(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),i<14&&r>=14&&(o=o.next(()=>this.si(e,s))),i<15&&r>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:S3}).createIndex("sequenceNumberIndex",C3,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:D3}).createIndex("documentKeyIndex",A3,{unique:!1})}(e))),o}Xs(e){let t=0;return e.store("remoteDocuments").X((i,r)=>{t+=hS(r)}).next(()=>{const i={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",i)})}Ys(e){const t=e.store("mutationQueues"),i=e.store("mutations");return t.j().next(r=>ge.forEach(r,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return i.j("userMutationsIndex",o).next(c=>ge.forEach(c,d=>{Kt(d.userId===s.userId);const m=jp(this.serializer,d);return TN(e,s.userId,m).next(()=>{})}))}))}Zs(e){const t=e.store("targetDocuments"),i=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const s=[];return i.X((o,c)=>{const d=new Xn(o),m=[0,eo(d)];s.push(t.get(m).next(g=>g?ge.resolve():t.put({targetId:0,path:eo(d),sequenceNumber:r.highestListenSequenceNumber})))}).next(()=>ge.waitFor(s))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:I3});const i=t.store("collectionParents"),r=new Ck,s=o=>{if(r.add(o)){const c=o.lastSegment(),d=o.popLast();return i.put({collectionId:c,parent:eo(d)})}};return t.store("remoteDocuments").X({Y:!0},(o,c)=>{const d=new Xn(o);return s(d.popLast())}).next(()=>t.store("documentMutations").X({Y:!0},([o,c,d],m)=>{const g=du(c);return s(g.popLast())}))}ei(e){const t=e.store("targets");return t.X((i,r)=>{const s=Cw(r),o=dN(this.serializer,s);return t.put(o)})}ni(e,t){const i=t.store("remoteDocuments"),r=[];return i.X((s,o)=>{const c=t.store("remoteDocumentsV14"),d=(m=o,m.document?new mt(Xn.fromString(m.document.name).popFirst(5)):m.noDocument?mt.fromSegments(m.noDocument.path):m.unknownDocument?mt.fromSegments(m.unknownDocument.path):Mt()).path.toArray();var m;const g={prefixPath:d.slice(0,d.length-2),collectionGroup:d[d.length-2],documentId:d[d.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(c.put(g))}).next(()=>ge.waitFor(r))}si(e,t){const i=t.store("mutations"),r=MN(this.serializer),s=new Ak(pS.zs,this.serializer.fe);return i.j().next(o=>{const c=new Map;return o.forEach(d=>{var m;let g=null!==(m=c.get(d.userId))&&void 0!==m?m:Sn();jp(this.serializer,d).keys().forEach(v=>g=g.add(v)),c.set(d.userId,g)}),ge.forEach(c,(d,m)=>{const g=new gs(m),v=lS.de(this.serializer,g),E=s.getIndexManager(g),T=fS.de(g,this.serializer,E,s.referenceDelegate);return new NN(r,T,v,E).recalculateAndSaveOverlaysForDocumentKeys(new XR(t,Ba.ct),d).next()})})}}function FN(n){n.createObjectStore("targetDocuments",{keyPath:x3}).createIndex("documentTargetsIndex",T3,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",E3,{unique:!0}),n.createObjectStore("targetGlobal")}const Rk="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class kk{constructor(e,t,i,r,s,o,c,d,m,g,v=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.ii=s,this.window=o,this.document=c,this.ri=m,this.oi=g,this.ui=v,this.Os=null,this.Fs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.ai=null,this.hi=null,this.li=Number.NEGATIVE_INFINITY,this.fi=E=>Promise.resolve(),!kk.D())throw new Ve(be.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new PH(this,r),this.di=t+"main",this.serializer=new cN(d),this.wi=new lc(this.di,this.ui,new WH(this.serializer)),this.Bs=new MH(this.referenceDelegate,this.serializer),this.remoteDocumentCache=MN(this.serializer),this.qs=new xH,this.window&&this.window.localStorage?this._i=this.window.localStorage:(this._i=null,!1===g&&Rr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ve(be.FAILED_PRECONDITION,Rk);return this.gi(),this.yi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Bs.getHighestSequenceNumber(e))}).then(e=>{this.Os=new Ba(e,this.ri)}).then(()=>{this.Fs=!0}).catch(e=>(this.wi&&this.wi.close(),Promise.reject(e)))}Ii(e){var i,t=this;return this.fi=function(r){return(i=i||(0,Te.Z)(function*(s){if(t.started)return e(s)})).apply(this,arguments)},e(this.isPrimary)}setDatabaseDeletedListener(e){var t;this.wi.B(function(i){return(t=t||(0,Te.Z)(function*(r){null===r.newVersion&&(yield e())})).apply(this,arguments)})}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.ii.enqueueAndForget((0,Te.Z)(function*(){t.started&&(yield t.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>_S(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ti(e).next(t=>{t||(this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)))})}).next(()=>this.Ei(e)).next(t=>this.isPrimary&&!t?this.Ai(e).next(()=>!1):!!t&&this.vi(e).next(()=>!0))).catch(e=>{if(wf(e))return nt("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return nt("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ii.enqueueRetryable(()=>this.fi(e)),this.isPrimary=e})}Ti(e){return Lw(e).get("owner").next(t=>ge.resolve(this.Ri(t)))}Pi(e){return _S(e).delete(this.clientId)}bi(){var e=this;return(0,Te.Z)(function*(){if(e.isPrimary&&!e.Vi(e.li,18e5)){e.li=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",i=>{const r=_s(i,"clientMetadata");return r.j().next(s=>{const o=e.Si(s,18e5),c=s.filter(d=>-1===o.indexOf(d));return ge.forEach(c,d=>r.delete(d.clientId)).next(()=>c)})}).catch(()=>[]);if(e._i)for(const i of t)e._i.removeItem(e.Di(i.clientId))}})()}pi(){this.hi=this.ii.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.bi()).then(()=>this.pi()))}Ri(e){return!!e&&e.ownerId===this.clientId}Ei(e){return this.oi?ge.resolve(!0):Lw(e).get("owner").next(t=>{if(null!==t&&this.Vi(t.leaseTimestampMs,5e3)&&!this.Ci(t.ownerId)){if(this.Ri(t)&&this.networkEnabled)return!0;if(!this.Ri(t)){if(!t.allowTabSynchronization)throw new Ve(be.FAILED_PRECONDITION,Rk);return!1}}return!(!this.networkEnabled||!this.inForeground)||_S(e).j().next(i=>void 0===this.Si(i,5e3).find(r=>!(this.clientId===r.clientId||!(!this.networkEnabled&&r.networkEnabled||!this.inForeground&&r.inForeground&&this.networkEnabled===r.networkEnabled))))}).next(t=>(this.isPrimary!==t&&nt("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,Te.Z)(function*(){e.Fs=!1,e.xi(),e.hi&&(e.hi.cancel(),e.hi=null),e.Ni(),e.ki(),yield e.wi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const i=new XR(t,Ba.ct);return e.Ai(i).next(()=>e.Pi(i))}),e.wi.close(),e.Mi()})()}Si(e,t){return e.filter(i=>this.Vi(i.updateTimeMs,t)&&!this.Ci(i.clientId))}$i(){return this.runTransaction("getActiveClients","readonly",e=>_S(e).j().next(t=>this.Si(t,18e5).map(i=>i.clientId)))}get started(){return this.Fs}getMutationQueue(e,t){return fS.de(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new kH(e,this.serializer.fe.databaseId)}getDocumentOverlayCache(e){return lS.de(this.serializer,e)}getBundleCache(){return this.qs}runTransaction(e,t,i){nt("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",s=15===(o=this.ui)?O3:14===o?XO:13===o?QO:12===o?L3:11===o?ZO:void Mt();var o;let c;return this.wi.runTransaction(e,r,s,d=>(c=new XR(d,this.Os?this.Os.next():Ba.ct),"readwrite-primary"===t?this.Ti(c).next(m=>!!m||this.Ei(c)).next(m=>{if(!m)throw Rr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)),new Ve(be.FAILED_PRECONDITION,jO);return i(c)}).next(m=>this.vi(c).next(()=>m)):this.Oi(c).next(()=>i(c)))).then(d=>(c.raiseOnCommittedEvent(),d))}Oi(e){return Lw(e).get("owner").next(t=>{if(null!==t&&this.Vi(t.leaseTimestampMs,5e3)&&!this.Ci(t.ownerId)&&!this.Ri(t)&&!(this.oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ve(be.FAILED_PRECONDITION,Rk)})}vi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Lw(e).put("owner",t)}static D(){return lc.D()}Ai(e){const t=Lw(e);return t.get("owner").next(i=>this.Ri(i)?(nt("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):ge.resolve())}Vi(e,t){const i=Date.now();return!(e<i-t||e>i&&(Rr(`Detected an update time that is in the future: ${e} > ${i}`),1))}gi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ai=()=>{this.ii.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.mi()))},this.document.addEventListener("visibilitychange",this.ai),this.inForeground="visible"===this.document.visibilityState)}Ni(){this.ai&&(this.document.removeEventListener("visibilitychange",this.ai),this.ai=null)}yi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ci=()=>{this.xi();const t=/(?:Version|Mobile)\/1[456]/;(0,An.G6)()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ii.enterRestrictedMode(!0),this.ii.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}ki(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Ci(e){var t;try{const i=null!==(null===(t=this._i)||void 0===t?void 0:t.getItem(this.Di(e)));return nt("IndexedDbPersistence",`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return Rr("IndexedDbPersistence","Failed to get zombied client id.",i),!1}}xi(){if(this._i)try{this._i.setItem(this.Di(this.clientId),String(Date.now()))}catch(e){Rr("Failed to set zombie client id.",e)}}Mi(){if(this._i)try{this._i.removeItem(this.Di(this.clientId))}catch{}}Di(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Lw(n){return _s(n,"owner")}function _S(n){return _s(n,"clientMetadata")}function Mk(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Lk{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Fi=i,this.Bi=r}static Li(e,t){let i=Sn(),r=Sn();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Lk(e,t.fromCache,i,r)}}class BN{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,i,r){return this.Ki(e,t).next(s=>s||this.Gi(e,t,r,i)).next(s=>s||this.Qi(e,t))}Ki(e,t){if(EP(t))return ge.resolve(null);let i=Do(t);return this.indexManager.getIndexType(e,i).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=tS(t,null,"F"),i=Do(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{const o=Sn(...s);return this.Ui.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,i).next(d=>{const m=this.ji(t,c);return this.zi(t,m,o,d.readTime)?this.Ki(e,tS(t,null,"F")):this.Wi(e,m,t,d)}))})))}Gi(e,t,i,r){return EP(t)||r.isEqual(qt.min())?this.Qi(e,t):this.Ui.getDocuments(e,i).next(s=>{const o=this.ji(t,s);return this.zi(t,o,i,r)?this.Qi(e,t):(KR()<=nu.in.DEBUG&&nt("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),lk(t)),this.Wi(e,o,t,$O(r,-1)))})}ji(e,t){let i=new $i(IP(e));return t.forEach((r,s)=>{gw(e,s)&&(i=i.add(s))}),i}zi(e,t,i,r){if(null===e.limit)return!1;if(i.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Qi(e,t){return KR()<=nu.in.DEBUG&&nt("QueryEngine","Using full collection scan to execute query:",lk(t)),this.Ui.getDocumentsMatchingQuery(e,t,Fa.min())}Wi(e,t,i,r){return this.Ui.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}class KH{constructor(e,t,i,r){this.persistence=e,this.Hi=t,this.serializer=r,this.Ji=new Ri(bn),this.Yi=new gd(s=>Fp(s),mw),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(i)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new NN(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}}function UN(n,e,t,i){return new KH(n,e,t,i)}function VN(n,e){return(ft=ft||(0,Te.Z)(function*(t,i){const r=_t(t);return yield r.persistence.runTransaction("Handle user change","readonly",s=>{let o;return r.mutationQueue.getAllMutationBatches(s).next(c=>(o=c,r.tr(i),r.mutationQueue.getAllMutationBatches(s))).next(c=>{const d=[],m=[];let g=Sn();for(const v of o){d.push(v.batchId);for(const E of v.mutations)g=g.add(E.key)}for(const v of c){m.push(v.batchId);for(const E of v.mutations)g=g.add(E.key)}return r.localDocuments.getDocuments(s,g).next(v=>({er:v,removedBatchIds:d,addedBatchIds:m}))})})})).apply(this,arguments)}function $N(n){const e=_t(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Bs.getLastRemoteSnapshotVersion(t))}function HN(n,e,t){let i=Sn(),r=Sn();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let o=ea();return t.forEach((c,d)=>{const m=s.get(c);d.isFoundDocument()!==m.isFoundDocument()&&(r=r.add(c)),d.isNoDocument()&&d.version.isEqual(qt.min())?(e.removeEntry(c,d.readTime),o=o.insert(c,d)):!m.isValidDocument()||d.version.compareTo(m.version)>0||0===d.version.compareTo(m.version)&&m.hasPendingWrites?(e.addEntry(d),o=o.insert(c,d)):nt("LocalStore","Ignoring outdated watch update for ",c,". Current version:",m.version," Watch version:",d.version)}),{nr:o,sr:r}})}function ZH(n,e){const t=_t(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function Iy(n,e){const t=_t(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.Bs.getTargetData(i,e).next(s=>s?(r=s,ge.resolve(r)):t.Bs.allocateTargetId(i).next(o=>(r=new yd(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.Bs.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=t.Ji.get(i.targetId);return(null===r||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ji=t.Ji.insert(i.targetId,i),t.Yi.set(e,i.targetId)),i})}function Sy(n,e,t){return(Ot=Ot||(0,Te.Z)(function*(i,r,s){const o=_t(i),c=o.Ji.get(r),d=s?"readwrite":"readwrite-primary";try{s||(yield o.persistence.runTransaction("Release target",d,m=>o.persistence.referenceDelegate.removeTarget(m,c)))}catch(m){if(!wf(m))throw m;nt("LocalStore",`Failed to update sequence numbers for target ${r}: ${m}`)}o.Ji=o.Ji.remove(r),o.Yi.delete(c.target)})).apply(this,arguments)}function yS(n,e,t){const i=_t(n);let r=qt.min(),s=Sn();return i.persistence.runTransaction("Execute query","readonly",o=>function(c,d,m){const g=_t(c),v=g.Yi.get(m);return void 0!==v?ge.resolve(g.Ji.get(v)):g.Bs.getTargetData(d,m)}(i,o,Do(e)).next(c=>{if(c)return r=c.lastLimboFreeSnapshotVersion,i.Bs.getMatchingKeysForTargetId(o,c.targetId).next(d=>{s=d})}).next(()=>i.Hi.getDocumentsMatchingQuery(o,e,t?r:qt.min(),t?s:Sn())).next(c=>(zN(i,TP(e),c),{documents:c,ir:s})))}function jN(n,e){const t=_t(n),i=_t(t.Bs),r=t.Ji.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",s=>i.le(s,e).next(o=>o?o.target:null))}function GN(n,e){const t=_t(n),i=t.Xi.get(e)||qt.min();return t.persistence.runTransaction("Get new document changes","readonly",r=>t.Zi.getAllFromCollectionGroup(r,e,$O(i,-1),Number.MAX_SAFE_INTEGER)).then(r=>(zN(t,e,r),r))}function zN(n,e,t){let i=n.Xi.get(e)||qt.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.Xi.set(e,i)}function XH(n,e){return(Ke=Ke||(0,Te.Z)(function*(t,i,r=Sn()){const s=yield Iy(t,Do(wk(i.bundledQuery))),o=_t(t);return o.persistence.runTransaction("Save named query","readwrite",c=>{const d=kr(i.readTime);if(s.snapshotVersion.compareTo(d)>=0)return o.qs.saveNamedQuery(c,i);const m=s.withResumeToken(Jr.EMPTY_BYTE_STRING,d);return o.Ji=o.Ji.insert(m.targetId,m),o.Bs.updateTargetData(c,m).next(()=>o.Bs.removeMatchingKeysForTargetId(c,s.targetId)).next(()=>o.Bs.addMatchingKeys(c,r,s.targetId)).next(()=>o.qs.saveNamedQuery(c,i))})})).apply(this,arguments)}function WN(n,e){return`firestore_clients_${n}_${e}`}function KN(n,e,t){let i=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}function Ok(n,e){return`firestore_targets_${n}_${e}`}class vS{constructor(e,t,i,r){this.user=e,this.batchId=t,this.state=i,this.error=r}static ar(e,t,i){const r=JSON.parse(i);let s,o="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return o&&r.error&&(o="string"==typeof r.error.message&&"string"==typeof r.error.code,o&&(s=new Ve(r.error.code,r.error.message))),o?new vS(e,t,r.state,s):(Rr("SharedClientState",`Failed to parse mutation state for ID '${t}': ${i}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ow{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static ar(e,t){const i=JSON.parse(t);let r,s="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return s&&i.error&&(s="string"==typeof i.error.message&&"string"==typeof i.error.code,s&&(r=new Ve(i.error.code,i.error.message))),s?new Ow(e,i.state,r):(Rr("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class bS{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static ar(e,t){const i=JSON.parse(t);let r="object"==typeof i&&i.activeTargetIds instanceof Array,s=ck();for(let o=0;r&&o<i.activeTargetIds.length;++o)r=WO(i.activeTargetIds[o]),s=s.add(i.activeTargetIds[o]);return r?new bS(e,s):(Rr("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Pk{constructor(e,t){this.clientId=e,this.onlineState=t}static ar(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Pk(t.clientId,t.onlineState):(Rr("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Nk{constructor(){this.activeTargetIds=ck()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Fk{constructor(e,t,i,r,s){this.window=e,this.ii=t,this.persistenceKey=i,this.wr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this._r=this.mr.bind(this),this.gr=new Ri(bn),this.started=!1,this.yr=[];const o=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.pr=WN(this.persistenceKey,this.wr),this.Ir=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.gr=this.gr.insert(this.wr,new Nk),this.Tr=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Er=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ar=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vr=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Rr=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this._r)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,Te.Z)(function*(){const t=yield e.syncEngine.$i();for(const r of t){if(r===e.wr)continue;const s=e.getItem(WN(e.persistenceKey,r));if(s){const o=bS.ar(r,s);o&&(e.gr=e.gr.insert(o.clientId,o))}}e.Pr();const i=e.storage.getItem(e.vr);if(i){const r=e.br(i);r&&e.Vr(r)}for(const r of e.yr)e.mr(r);e.yr=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.Ir,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Sr(this.gr)}isActiveQueryTarget(e){let t=!1;return this.gr.forEach((i,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Dr(e,"pending")}updateMutationState(e,t,i){this.Dr(e,t,i),this.Cr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Ok(this.persistenceKey,e));if(i){const r=Ow.ar(e,i);r&&(t=r.state)}}return this.Nr.lr(e),this.Pr(),t}removeLocalQueryTarget(e){this.Nr.dr(e),this.Pr()}isLocalQueryTarget(e){return this.Nr.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Ok(this.persistenceKey,e))}updateQueryState(e,t,i){this.kr(e,t,i)}handleUserChange(e,t,i){t.forEach(r=>{this.Cr(r)}),this.currentUser=e,i.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.Mr(e)}notifyBundleLoaded(e){this.$r(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this._r),this.removeItem(this.pr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return nt("SharedClientState","READ",e,t),t}setItem(e,t){nt("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){nt("SharedClientState","REMOVE",e),this.storage.removeItem(e)}mr(e){var t=this;const i=e;if(i.storageArea===this.storage){if(nt("SharedClientState","EVENT",i.key,i.newValue),i.key===this.pr)return void Rr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ii.enqueueRetryable((0,Te.Z)(function*(){if(t.started){if(null!==i.key)if(t.Tr.test(i.key)){if(null==i.newValue){const r=t.Or(i.key);return t.Fr(r,null)}{const r=t.Br(i.key,i.newValue);if(r)return t.Fr(r.clientId,r)}}else if(t.Er.test(i.key)){if(null!==i.newValue){const r=t.Lr(i.key,i.newValue);if(r)return t.qr(r)}}else if(t.Ar.test(i.key)){if(null!==i.newValue){const r=t.Ur(i.key,i.newValue);if(r)return t.Kr(r)}}else if(i.key===t.vr){if(null!==i.newValue){const r=t.br(i.newValue);if(r)return t.Vr(r)}}else if(i.key===t.Ir){const r=function(s){let o=Ba.ct;if(null!=s)try{const c=JSON.parse(s);Kt("number"==typeof c),o=c}catch(c){Rr("SharedClientState","Failed to read sequence number from WebStorage",c)}return o}(i.newValue);r!==Ba.ct&&t.sequenceNumberHandler(r)}else if(i.key===t.Rr){const r=t.Gr(i.newValue);yield Promise.all(r.map(s=>t.syncEngine.Qr(s)))}}else t.yr.push(i)}))}}get Nr(){return this.gr.get(this.wr)}Pr(){this.setItem(this.pr,this.Nr.hr())}Dr(e,t,i){const r=new vS(this.currentUser,e,t,i),s=KN(this.persistenceKey,this.currentUser,e);this.setItem(s,r.hr())}Cr(e){const t=KN(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Mr(e){this.storage.setItem(this.vr,JSON.stringify({clientId:this.wr,onlineState:e}))}kr(e,t,i){const r=Ok(this.persistenceKey,e),s=new Ow(e,t,i);this.setItem(r,s.hr())}$r(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Rr,t)}Or(e){const t=this.Tr.exec(e);return t?t[1]:null}Br(e,t){const i=this.Or(e);return bS.ar(i,t)}Lr(e,t){const i=this.Er.exec(e),r=Number(i[1]);return vS.ar(new gs(void 0!==i[2]?i[2]:null),r,t)}Ur(e,t){const i=this.Ar.exec(e),r=Number(i[1]);return Ow.ar(r,t)}br(e){return Pk.ar(e)}Gr(e){return JSON.parse(e)}qr(e){var t=this;return(0,Te.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.jr(e.batchId,e.state,e.error);nt("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Kr(e){return this.syncEngine.zr(e.targetId,e.state,e.error)}Fr(e,t){const i=t?this.gr.insert(e,t):this.gr.remove(e),r=this.Sr(this.gr),s=this.Sr(i),o=[],c=[];return s.forEach(d=>{r.has(d)||o.push(d)}),r.forEach(d=>{s.has(d)||c.push(d)}),this.syncEngine.Wr(o,c).then(()=>{this.gr=i})}Vr(e){this.gr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Sr(e){let t=ck();return e.forEach((i,r)=>{t=t.unionWith(r.activeTargetIds)}),t}}class qN{constructor(){this.Hr=new Nk,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,i){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new Nk,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class JH{Yr(e){}shutdown(){}}class YN{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){nt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){nt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let wS=null;function Bk(){return null===wS?wS=268435456+Math.round(2147483648*Math.random()):wS++,"0x"+wS.toString(16)}const e4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class t4{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}const no="WebChannelConnection";class n4 extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.mo=(e.ssl?"https":"http")+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,i,r,s){const o=Bk(),c=this.To(e,t);nt("RestConnection",`Sending RPC '${e}' ${o}:`,c,i);const d={};return this.Eo(d,r,s),this.Ao(e,c,d,i).then(m=>(nt("RestConnection",`Received RPC '${e}' ${o}: `,m),m),m=>{throw pl("RestConnection",`RPC '${e}' ${o} failed with error: `,m,"url: ",c,"request:",i),m})}vo(e,t,i,r,s,o){return this.Io(e,t,i,r,s)}Eo(e,t,i){e["X-Goog-Api-Client"]="gl-js/ fire/"+uy,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,s)=>e[s]=r),i&&i.headers.forEach((r,s)=>e[s]=r)}To(e,t){return`${this.mo}/v1/${t}:${e4[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,i,r){const s=Bk();return new Promise((o,c)=>{const d=new se;d.setWithCredentials(!0),d.listenOnce(I.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case w.NO_ERROR:const g=d.getResponseJson();nt(no,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(g)),o(g);break;case w.TIMEOUT:nt(no,`RPC '${e}' ${s} timed out`),c(new Ve(be.DEADLINE_EXCEEDED,"Request time out"));break;case w.HTTP_ERROR:const v=d.getStatus();if(nt(no,`RPC '${e}' ${s} failed with status:`,v,"response text:",d.getResponseText()),v>0){let E=d.getResponseJson();Array.isArray(E)&&(E=E[0]);const T=E?.error;if(T&&T.status&&T.message){const C=function(k){const P=k.toLowerCase().replace(/_/g,"-");return Object.values(be).indexOf(P)>=0?P:be.UNKNOWN}(T.status);c(new Ve(C,T.message))}else c(new Ve(be.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new Ve(be.UNAVAILABLE,"Connection failed."));break;default:Mt()}}finally{nt(no,`RPC '${e}' ${s} completed.`)}});const m=JSON.stringify(r);nt(no,`RPC '${e}' ${s} sending request:`,r),d.send(t,"POST",m,i,15)})}Ro(e,t,i){const r=Bk(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=p(),c=_(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;void 0!==m&&(d.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(d.xmlHttpFactory=new B({})),this.Eo(d.initMessageHeaders,t,i),d.encodeInitMessageHeaders=!0;const g=s.join("");nt(no,`Creating RPC '${e}' stream ${r}: ${g}`,d);const v=o.createWebChannel(g,d);let E=!1,T=!1;const C=new t4({ro:P=>{T?nt(no,`Not sending because RPC '${e}' stream ${r} is closed:`,P):(E||(nt(no,`Opening RPC '${e}' stream ${r} transport.`),v.open(),E=!0),nt(no,`RPC '${e}' stream ${r} sending:`,P),v.send(P))},oo:()=>v.close()}),k=(P,G,Y)=>{P.listen(G,W=>{try{Y(W)}catch(te){setTimeout(()=>{throw te},0)}})};return k(v,K.EventType.OPEN,()=>{T||nt(no,`RPC '${e}' stream ${r} transport opened.`)}),k(v,K.EventType.CLOSE,()=>{T||(T=!0,nt(no,`RPC '${e}' stream ${r} transport closed`),C.wo())}),k(v,K.EventType.ERROR,P=>{T||(T=!0,pl(no,`RPC '${e}' stream ${r} transport errored:`,P),C.wo(new Ve(be.UNAVAILABLE,"The operation could not be completed")))}),k(v,K.EventType.MESSAGE,P=>{var G;if(!T){const Y=P.data[0];Kt(!!Y);const te=Y.error||(null===(G=Y[0])||void 0===G?void 0:G.error);if(te){nt(no,`RPC '${e}' stream ${r} received error:`,te);const oe=te.status;let Ae=function(Ge){const rt=Vr[Ge];if(void 0!==rt)return jP(rt)}(oe),we=te.message;void 0===Ae&&(Ae=be.INTERNAL,we="Unknown error status: "+oe+" with message "+te.message),T=!0,C.wo(new Ve(Ae,we)),v.close()}else nt(no,`RPC '${e}' stream ${r} received:`,Y),C._o(Y)}}),k(c,S.STAT_EVENT,P=>{P.stat===M.PROXY?nt(no,`RPC '${e}' stream ${r} detected buffering proxy`):P.stat===M.NOPROXY&&nt(no,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{C.fo()},0),C}}function ZN(){return typeof window<"u"?window:null}function ES(){return typeof document<"u"?document:null}function Pw(n){return new hH(n,!0)}class Uk{constructor(e,t,i=1e3,r=1.5,s=6e4){this.ii=e,this.timerId=t,this.Po=i,this.bo=r,this.Vo=s,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),i=Math.max(0,Date.now()-this.Co),r=Math.max(0,t-i);r>0&&nt("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,r,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class QN{constructor(e,t,i,r,s,o,c,d){this.ii=e,this.$o=i,this.Oo=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=d,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new Uk(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}stop(){var e=this;return(0,Te.Z)(function*(){e.Uo()&&(yield e.close(0))})()}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}zo(){var e=this;return(0,Te.Z)(function*(){if(e.Ko())return e.close(0)})()}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}close(e,t){var i=this;return(0,Te.Z)(function*(){i.Ho(),i.Jo(),i.qo.cancel(),i.Fo++,4!==e?i.qo.reset():t&&t.code===be.RESOURCE_EXHAUSTED?(Rr(t.toString()),Rr("Using maximum backoff delay to prevent overloading the backend."),i.qo.xo()):t&&t.code===be.UNAUTHENTICATED&&3!==i.state&&(i.authCredentialsProvider.invalidateToken(),i.appCheckCredentialsProvider.invalidateToken()),null!==i.stream&&(i.Yo(),i.stream.close(),i.stream=null),i.state=e,yield i.listener.ao(t)})()}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.Fo===t&&this.Zo(i,r)},i=>{e(()=>{const r=new Ve(be.UNKNOWN,"Fetching auth token failed: "+i.message);return this.tu(r)})})}Zo(e,t){const i=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{i(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(r=>{i(()=>this.tu(r))}),this.stream.onMessage(r=>{i(()=>this.onMessage(r))})}Go(){var e=this;this.state=5,this.qo.No((0,Te.Z)(function*(){e.state=0,e.start()}))}tu(e){return nt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(nt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class i4 extends QN{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function pH(n,e){let t;if("targetChange"in e){const i="NO_CHANGE"===(d=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===d?1:"REMOVE"===d?2:"CURRENT"===d?3:"RESET"===d?4:Mt(),r=e.targetChange.targetIds||[],s=function(d,m){return d.useProto3Json?(Kt(void 0===m||"string"==typeof m),Jr.fromBase64String(m||"")):(Kt(void 0===m||m instanceof Uint8Array),Jr.fromUint8Array(m||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(d){const m=void 0===d.code?be.UNKNOWN:jP(d.code);return new Ve(m,d.message||"")}(o);t=new qP(i,r,s,c||null)}else if("documentChange"in e){const i=e.documentChange,r=mu(n,i.document.name),s=kr(i.document.updateTime),o=i.document.createTime?kr(i.document.createTime):qt.min(),c=new Fs({mapValue:{fields:i.document.fields}}),d=Hi.newFoundDocument(r,s,o,c);t=new oS(i.targetIds||[],i.removedTargetIds||[],d.key,d)}else if("documentDelete"in e){const i=e.documentDelete,r=mu(n,i.document),s=i.readTime?kr(i.readTime):qt.min(),o=Hi.newNoDocument(r,s);t=new oS([],i.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const i=e.documentRemove,r=mu(n,i.document);t=new oS([],i.removedTargetIds||[],r,null)}else{if(!("filter"in e))return Mt();{const i=e.filter,{count:r=0,unchangedNames:s}=i,o=new oH(r,s);t=new KP(i.targetId,o)}}var d;return t}(this.serializer,e),i=function(r){if(!("targetChange"in r))return qt.min();const s=r.targetChange;return s.targetIds&&s.targetIds.length?qt.min():s.readTime?kr(s.readTime):qt.min()}(e);return this.listener.nu(t,i)}su(e){const t={};t.database=Iw(this.serializer),t.addTarget=function(r,s){let o;const c=s.target;if(o=XI(c)?{documents:rN(r,c)}:{query:bk(r,c)},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){o.resumeToken=XP(r,s.resumeToken);const d=gk(r,s.expectedCount);null!==d&&(o.expectedCount=d)}else if(s.snapshotVersion.compareTo(qt.min())>0){o.readTime=wy(r,s.snapshotVersion.toTimestamp());const d=gk(r,s.expectedCount);null!==d&&(o.expectedCount=d)}return o}(this.serializer,e);const i=function _H(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Mt()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);i&&(t.labels=i),this.Wo(t)}iu(e){const t={};t.database=Iw(this.serializer),t.removeTarget=e,this.Wo(t)}}class r4 extends QN{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(Kt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function gH(n,e){return n&&n.length>0?(Kt(void 0!==e),n.map(t=>function(i,r){let s=kr(i.updateTime?i.updateTime:r);return s.isEqual(qt.min())&&(s=kr(r)),new nH(s,i.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),i=kr(e.commitTime);return this.listener.cu(i,t)}return Kt(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=Iw(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>Sw(this.serializer,i))};this.Wo(t)}}class s4 extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.lu=!1}fu(){if(this.lu)throw new Ve(be.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.connection.Io(e,t,i,r,s)).catch(r=>{throw"FirebaseError"===r.name?(r.code===be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new Ve(be.UNKNOWN,r.toString())})}vo(e,t,i,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.vo(e,t,i,s,o,r)).catch(s=>{throw"FirebaseError"===s.name?(s.code===be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ve(be.UNKNOWN,s.toString())})}terminate(){this.lu=!0}}class a4{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Rr(t),this.mu=!1):nt("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class l4{constructor(e,t,i,r,s){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=s,this.Pu.Yr(c=>{i.enqueueAndForget((0,Te.Z)(function*(){var d;Lf(o)&&(nt("RemoteStore","Restarting streams for network reachability change."),yield function(m){return(d=d||(0,Te.Z)(function*(g){const v=_t(g);v.vu.add(4),yield Cy(v),v.bu.set("Unknown"),v.vu.delete(4),yield Nw(v)})).apply(this,arguments)}(o))}))}),this.bu=new a4(i,r)}}function Nw(n){return(Ti=Ti||(0,Te.Z)(function*(e){if(Lf(e))for(const t of e.Ru)yield t(!0)})).apply(this,arguments)}function Cy(n){return(Qi=Qi||(0,Te.Z)(function*(e){for(const t of e.Ru)yield t(!1)})).apply(this,arguments)}function xS(n,e){const t=_t(n);t.Au.has(e.targetId)||(t.Au.set(e.targetId,e),Hk(t)?$k(t):Ay(t).Ko()&&Vk(t,e))}function Fw(n,e){const t=_t(n),i=Ay(t);t.Au.delete(e),i.Ko()&&XN(t,e),0===t.Au.size&&(i.Ko()?i.jo():Lf(t)&&t.bu.set("Unknown"))}function Vk(n,e){if(n.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(qt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ay(n).su(e)}function XN(n,e){n.Vu.qt(e),Ay(n).iu(e)}function $k(n){n.Vu=new lH({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),le:e=>n.Au.get(e)||null,ue:()=>n.datastore.serializer.databaseId}),Ay(n).start(),n.bu.gu()}function Hk(n){return Lf(n)&&!Ay(n).Uo()&&n.Au.size>0}function Lf(n){return 0===_t(n).vu.size}function JN(n){n.Vu=void 0}function c4(n){return(WR=WR||(0,Te.Z)(function*(e){e.Au.forEach((t,i)=>{Vk(e,t)})})).apply(this,arguments)}function u4(n,e){return(tO=tO||(0,Te.Z)(function*(t,i){JN(t),Hk(t)?(t.bu.Iu(i),$k(t)):t.bu.set("Unknown")})).apply(this,arguments)}function d4(n,e,t){return(nO=nO||(0,Te.Z)(function*(i,r,s){if(i.bu.set("Online"),r instanceof qP&&2===r.state&&r.cause)try{var o;yield function(c,d){return(o=o||(0,Te.Z)(function*(m,g){const v=g.cause;for(const E of g.targetIds)m.Au.has(E)&&(yield m.remoteSyncer.rejectListen(E,v),m.Au.delete(E),m.Vu.removeTarget(E))})).apply(this,arguments)}(i,r)}catch(c){nt("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),c),yield TS(i,c)}else if(r instanceof oS?i.Vu.Ht(r):r instanceof KP?i.Vu.ne(r):i.Vu.Xt(r),!s.isEqual(qt.min()))try{const c=yield $N(i.localStore);s.compareTo(c)>=0&&(yield function(d,m){const g=d.Vu.ce(m);return g.targetChanges.forEach((v,E)=>{if(v.resumeToken.approximateByteSize()>0){const T=d.Au.get(E);T&&d.Au.set(E,T.withResumeToken(v.resumeToken,m))}}),g.targetMismatches.forEach((v,E)=>{const T=d.Au.get(v);if(!T)return;d.Au.set(v,T.withResumeToken(Jr.EMPTY_BYTE_STRING,T.snapshotVersion)),XN(d,v);const C=new yd(T.target,v,E,T.sequenceNumber);Vk(d,C)}),d.remoteSyncer.applyRemoteEvent(g)}(i,s))}catch(c){nt("RemoteStore","Failed to raise snapshot:",c),yield TS(i,c)}})).apply(this,arguments)}function TS(n,e,t){return(iO=iO||(0,Te.Z)(function*(i,r,s){if(!wf(r))throw r;i.vu.add(1),yield Cy(i),i.bu.set("Offline"),s||(s=()=>$N(i.localStore)),i.asyncQueue.enqueueRetryable((0,Te.Z)(function*(){nt("RemoteStore","Retrying IndexedDB access"),yield s(),i.vu.delete(1),yield Nw(i)}))})).apply(this,arguments)}function eF(n,e){return e().catch(t=>TS(n,t,e))}function Dy(n){return(rO=rO||(0,Te.Z)(function*(e){const t=_t(e),i=Of(t);let r=t.Eu.length>0?t.Eu[t.Eu.length-1].batchId:-1;for(;h4(t);)try{const s=yield ZH(t.localStore,r);if(null===s){0===t.Eu.length&&i.jo();break}r=s.batchId,f4(t,s)}catch(s){yield TS(t,s)}tF(t)&&nF(t)})).apply(this,arguments)}function h4(n){return Lf(n)&&n.Eu.length<10}function f4(n,e){n.Eu.push(e);const t=Of(n);t.Ko()&&t.ou&&t.uu(e.mutations)}function tF(n){return Lf(n)&&!Of(n).Uo()&&n.Eu.length>0}function nF(n){Of(n).start()}function m4(n){return(sO=sO||(0,Te.Z)(function*(e){Of(e).hu()})).apply(this,arguments)}function p4(n){return(oO=oO||(0,Te.Z)(function*(e){const t=Of(e);for(const i of e.Eu)t.uu(i.mutations)})).apply(this,arguments)}function g4(n,e,t){return(aO=aO||(0,Te.Z)(function*(i,r,s){const o=i.Eu.shift(),c=hk.from(o,r,s);yield eF(i,()=>i.remoteSyncer.applySuccessfulWrite(c)),yield Dy(i)})).apply(this,arguments)}function _4(n,e){return(lO=lO||(0,Te.Z)(function*(t,i){var r;i&&Of(t).ou&&(yield function(s,o){return(r=r||(0,Te.Z)(function*(c,d){if(HP(m=d.code)&&m!==be.ABORTED){const g=c.Eu.shift();Of(c).Qo(),yield eF(c,()=>c.remoteSyncer.rejectFailedWrite(g.batchId,d)),yield Dy(c)}var m})).apply(this,arguments)}(t,i)),tF(t)&&nF(t)})).apply(this,arguments)}function iF(n,e){return(cO=cO||(0,Te.Z)(function*(t,i){const r=_t(t);r.asyncQueue.verifyOperationInProgress(),nt("RemoteStore","RemoteStore received new credentials");const s=Lf(r);r.vu.add(3),yield Cy(r),s&&r.bu.set("Unknown"),yield r.remoteSyncer.handleCredentialChange(i),r.vu.delete(3),yield Nw(r)})).apply(this,arguments)}function jk(n,e){return(uO=uO||(0,Te.Z)(function*(t,i){const r=_t(t);i?(r.vu.delete(2),yield Nw(r)):i||(r.vu.add(2),yield Cy(r),r.bu.set("Unknown"))})).apply(this,arguments)}function Ay(n){var e;return n.Su||(n.Su=function(t,i,r){const s=_t(t);return s.fu(),new i4(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{uo:c4.bind(null,n),ao:u4.bind(null,n),nu:d4.bind(null,n)}),n.Ru.push(function(t){return(e=e||(0,Te.Z)(function*(i){i?(n.Su.Qo(),Hk(n)?$k(n):n.bu.set("Unknown")):(yield n.Su.stop(),JN(n))})).apply(this,arguments)})),n.Su}function Of(n){var e;return n.Du||(n.Du=function(t,i,r){const s=_t(t);return s.fu(),new r4(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{uo:m4.bind(null,n),ao:_4.bind(null,n),au:p4.bind(null,n),cu:g4.bind(null,n)}),n.Ru.push(function(t){return(e=e||(0,Te.Z)(function*(i){i?(n.Du.Qo(),yield Dy(n)):(yield n.Du.stop(),n.Eu.length>0&&(nt("RemoteStore",`Stopping write stream with ${n.Eu.length} pending writes`),n.Eu=[]))})).apply(this,arguments)})),n.Du}class Gk{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new Xr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,c=new Gk(e,t,o,r,s);return c.start(i),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ve(be.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ry(n,e){if(Rr("AsyncQueue",`${e}: ${n}`),wf(n))return new Ve(be.UNAVAILABLE,`${e}: ${n}`);throw n}class ky{constructor(e){this.comparator=e?(t,i)=>e(t,i)||mt.comparator(t.key,i.key):(t,i)=>mt.comparator(t.key,i.key),this.keyedMap=_w(),this.sortedSet=new Ri(this.comparator)}static emptySet(e){return new ky(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ky)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const i=new ky;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class rF{constructor(){this.Cu=new Ri(mt.comparator)}track(e){const t=e.doc.key,i=this.Cu.get(t);i?0!==e.type&&3===i.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==i.type?this.Cu=this.Cu.insert(t,{type:i.type,doc:e.doc}):2===e.type&&2===i.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===i.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===i.type?this.Cu=this.Cu.remove(t):1===e.type&&2===i.type?this.Cu=this.Cu.insert(t,{type:1,doc:i.doc}):0===e.type&&1===i.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):Mt():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal((t,i)=>{e.push(i)}),e}}class My{constructor(e,t,i,r,s,o,c,d,m){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=d,this.hasCachedResults=m}static fromInitialDocuments(e,t,i,r,s){const o=[];return t.forEach(c=>{o.push({type:0,doc:c})}),new My(e,t,ky.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pw(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}class y4{constructor(){this.Nu=void 0,this.listeners=[]}}class v4{constructor(){this.queries=new gd(e=>xP(e),pw),this.onlineState="Unknown",this.ku=new Set}}function zk(n,e){return(dO=dO||(0,Te.Z)(function*(t,i){const r=_t(t),s=i.query;let o=!1,c=r.queries.get(s);if(c||(o=!0,c=new y4),o)try{c.Nu=yield r.onListen(s)}catch(d){const m=Ry(d,`Initialization of query '${lk(i.query)}' failed`);return void i.onError(m)}r.queries.set(s,c),c.listeners.push(i),i.Mu(r.onlineState),c.Nu&&i.$u(c.Nu)&&Kk(r)})).apply(this,arguments)}function Wk(n,e){return(hO=hO||(0,Te.Z)(function*(t,i){const r=_t(t),s=i.query;let o=!1;const c=r.queries.get(s);if(c){const d=c.listeners.indexOf(i);d>=0&&(c.listeners.splice(d,1),o=0===c.listeners.length)}if(o)return r.queries.delete(s),r.onUnlisten(s)})).apply(this,arguments)}function b4(n,e){const t=_t(n);let i=!1;for(const r of e){const o=t.queries.get(r.query);if(o){for(const c of o.listeners)c.$u(r)&&(i=!0);o.Nu=r}}i&&Kk(t)}function w4(n,e,t){const i=_t(n),r=i.queries.get(e);if(r)for(const s of r.listeners)s.onError(t);i.queries.delete(e)}function Kk(n){n.ku.forEach(e=>{e.next()})}class qk{constructor(e,t,i){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=i||{}}$u(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)3!==r.type&&i.push(r);e=new My(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){return!e.fromCache||(!this.options.Ku||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Uu(e){e=My.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}class E4{constructor(e,t){this.Gu=e,this.byteLength=t}Qu(){return"metadata"in this.Gu}}class sF{constructor(e){this.serializer=e}rr(e){return mu(this.serializer,e)}ur(e){return e.metadata.exists?iN(this.serializer,e.document,!1):Hi.newNoDocument(this.rr(e.metadata.name),this.cr(e.metadata.readTime))}cr(e){return kr(e)}}class x4{constructor(e,t,i){this.ju=e,this.localStore=t,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=oF(e)}zu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Gu.namedQuery)this.queries.push(e.Gu.namedQuery);else if(e.Gu.documentMetadata){this.documents.push({metadata:e.Gu.documentMetadata}),e.Gu.documentMetadata.exists||++t;const i=Xn.fromString(e.Gu.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.Gu.document&&(this.documents[this.documents.length-1].document=e.Gu.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Wu(e){const t=new Map,i=new sF(this.serializer);for(const r of e)if(r.metadata.queries){const s=i.rr(r.metadata.name);for(const o of r.metadata.queries){const c=(t.get(o)||Sn()).add(s);t.set(o,c)}}return t}complete(){var e=this;return(0,Te.Z)(function*(){const t=yield function QH(n,e,t,i){return(rn=rn||(0,Te.Z)(function*(r,s,o,c){const d=_t(r);let m=Sn(),g=ea();for(const T of o){const C=s.rr(T.metadata.name);T.document&&(m=m.add(C));const k=s.ur(T);k.setReadTime(s.cr(T.metadata.readTime)),g=g.insert(C,k)}const v=d.Zi.newChangeBuffer({trackRemovals:!0}),E=yield Iy(d,(T=c,Do(gy(Xn.fromString(`__bundle__/docs/${T}`)))));var T;return d.persistence.runTransaction("Apply bundle documents","readwrite",T=>HN(T,v,g).next(C=>(v.apply(T),C)).next(C=>d.Bs.removeMatchingKeysForTargetId(T,E.targetId).next(()=>d.Bs.addMatchingKeys(T,m,E.targetId)).next(()=>d.localDocuments.getLocalViewOfDocuments(T,C.nr,C.sr)).next(()=>C.nr)))})).apply(this,arguments)}(e.localStore,new sF(e.serializer),e.documents,e.ju.id),i=e.Wu(e.documents);for(const r of e.queries)yield XH(e.localStore,r,i.get(r.name));return e.progress.taskState="Success",{progress:e.progress,Hu:e.collectionGroups,Ju:t}})()}}function oF(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class aF{constructor(e){this.key=e}}class lF{constructor(e){this.key=e}}class cF{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=Sn(),this.mutatedKeys=Sn(),this.tc=IP(e),this.ec=new ky(this.tc)}get nc(){return this.Yu}sc(e,t){const i=t?t.ic:new rF,r=t?t.ec:this.ec;let s=t?t.mutatedKeys:this.mutatedKeys,o=r,c=!1;const d="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,m="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((g,v)=>{const E=r.get(g),T=gw(this.query,v)?v:null,C=!!E&&this.mutatedKeys.has(E.key),k=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let P=!1;E&&T?E.data.isEqual(T.data)?C!==k&&(i.track({type:3,doc:T}),P=!0):this.rc(E,T)||(i.track({type:2,doc:T}),P=!0,(d&&this.tc(T,d)>0||m&&this.tc(T,m)<0)&&(c=!0)):!E&&T?(i.track({type:0,doc:T}),P=!0):E&&!T&&(i.track({type:1,doc:E}),P=!0,(d||m)&&(c=!0)),P&&(T?(o=o.add(T),s=k?s.add(g):s.delete(g)):(o=o.delete(g),s=s.delete(g)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const g="F"===this.query.limitType?o.last():o.first();o=o.delete(g.key),s=s.delete(g.key),i.track({type:1,doc:g})}return{ec:o,ic:i,zi:c,mutatedKeys:s}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i){const r=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const s=e.ic.xu();s.sort((m,g)=>function(v,E){const T=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Mt()}};return T(v)-T(E)}(m.type,g.type)||this.tc(m.doc,g.doc)),this.oc(i);const o=t?this.uc():[],c=0===this.Zu.size&&this.current?1:0,d=c!==this.Xu;return this.Xu=c,0!==s.length||d?{snapshot:new My(this.query,e.ec,r,s,e.mutatedKeys,0===c,d,!1,!!i&&i.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new rF,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(t=>this.Yu=this.Yu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Yu=this.Yu.delete(t)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=Sn(),this.ec.forEach(i=>{this.ac(i.key)&&(this.Zu=this.Zu.add(i.key))});const t=[];return e.forEach(i=>{this.Zu.has(i)||t.push(new lF(i))}),this.Zu.forEach(i=>{e.has(i)||t.push(new aF(i))}),t}hc(e){this.Yu=e.ir,this.Zu=Sn();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return My.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class T4{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class I4{constructor(e){this.key=e,this.fc=!1}}class S4{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new gd(c=>xP(c),pw),this._c=new Map,this.mc=new Set,this.gc=new Ri(mt.comparator),this.yc=new Map,this.Ic=new Dk,this.Tc={},this.Ec=new Map,this.Ac=Wp.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}function C4(n,e){return(fO=fO||(0,Te.Z)(function*(t,i){const r=eM(t);let s,o;const c=r.wc.get(i);if(c)s=c.targetId,r.sharedClientState.addLocalQueryTarget(s),o=c.view.lc();else{const d=yield Iy(r.localStore,Do(i)),m=r.sharedClientState.addLocalQueryTarget(d.targetId);s=d.targetId,o=yield Yk(r,i,s,"current"===m,d.resumeToken),r.isPrimaryClient&&xS(r.remoteStore,d)}return o})).apply(this,arguments)}function Yk(n,e,t,i,r){return(mO=mO||(0,Te.Z)(function*(s,o,c,d,m){s.Rc=(P,G,Y)=>{var W;return function(te,oe,Ae,we){return(W=W||(0,Te.Z)(function*(Ge,rt,Pe,Xt){let yt=rt.view.sc(Pe);yt.zi&&(yt=yield yS(Ge.localStore,rt.query,!1).then(({documents:pi})=>rt.view.sc(pi,yt)));const Fn=Xt&&Xt.targetChanges.get(rt.targetId),Lr=rt.view.applyChanges(yt,Ge.isPrimaryClient,Fn);return Xk(Ge,rt.targetId,Lr.cc),Lr.snapshot})).apply(this,arguments)}(s,P,G,Y)};const g=yield yS(s.localStore,o,!0),v=new cF(o,g.ir),E=v.sc(g.documents),T=xw.createSynthesizedTargetChangeForCurrentChange(c,d&&"Offline"!==s.onlineState,m),C=v.applyChanges(E,s.isPrimaryClient,T);Xk(s,c,C.cc);const k=new T4(o,c,v);return s.wc.set(o,k),s._c.has(c)?s._c.get(c).push(o):s._c.set(c,[o]),C.snapshot})).apply(this,arguments)}function D4(n,e){return(pO=pO||(0,Te.Z)(function*(t,i){const r=_t(t),s=r.wc.get(i),o=r._c.get(s.targetId);if(o.length>1)return r._c.set(s.targetId,o.filter(c=>!pw(c,i))),void r.wc.delete(i);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||(yield Sy(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),Fw(r.remoteStore,s.targetId),Ly(r,s.targetId)}).catch(bf))):(Ly(r,s.targetId),yield Sy(r.localStore,s.targetId,!0))})).apply(this,arguments)}function uF(n,e){return(_O=_O||(0,Te.Z)(function*(t,i){const r=_t(t);try{const s=yield function YH(n,e){const t=_t(n),i=e.snapshotVersion;let r=t.Ji;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.Zi.newChangeBuffer({trackRemovals:!0});r=t.Ji;const c=[];e.targetChanges.forEach((g,v)=>{const E=r.get(v);if(!E)return;c.push(t.Bs.removeMatchingKeys(s,g.removedDocuments,v).next(()=>t.Bs.addMatchingKeys(s,g.addedDocuments,v)));let T=E.withSequenceNumber(s.currentSequenceNumber);var C,k,P;null!==e.targetMismatches.get(v)?T=T.withResumeToken(Jr.EMPTY_BYTE_STRING,qt.min()).withLastLimboFreeSnapshotVersion(qt.min()):g.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(g.resumeToken,i)),r=r.insert(v,T),k=T,P=g,(0===(C=E).resumeToken.approximateByteSize()||k.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=3e8||P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0)&&c.push(t.Bs.updateTargetData(s,T))});let d=ea(),m=Sn();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,g))}),c.push(HN(s,o,e.documentUpdates).next(g=>{d=g.nr,m=g.sr})),!i.isEqual(qt.min())){const g=t.Bs.getLastRemoteSnapshotVersion(s).next(v=>t.Bs.setTargetsMetadata(s,s.currentSequenceNumber,i));c.push(g)}return ge.waitFor(c).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,d,m)).next(()=>d)}).then(s=>(t.Ji=r,s))}(r.localStore,i);i.targetChanges.forEach((o,c)=>{const d=r.yc.get(c);d&&(Kt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1),o.addedDocuments.size>0?d.fc=!0:o.modifiedDocuments.size>0?Kt(d.fc):o.removedDocuments.size>0&&(Kt(d.fc),d.fc=!1))}),yield vd(r,s,i)}catch(s){yield bf(s)}})).apply(this,arguments)}function dF(n,e,t){const i=_t(n);if(i.isPrimaryClient&&0===t||!i.isPrimaryClient&&1===t){const r=[];i.wc.forEach((s,o)=>{const c=o.view.Mu(e);c.snapshot&&r.push(c.snapshot)}),function(s,o){const c=_t(s);c.onlineState=o;let d=!1;c.queries.forEach((m,g)=>{for(const v of g.listeners)v.Mu(o)&&(d=!0)}),d&&Kk(c)}(i.eventManager,e),r.length&&i.dc.nu(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function R4(n,e,t){return(yO=yO||(0,Te.Z)(function*(i,r,s){const o=_t(i);o.sharedClientState.updateQueryState(r,"rejected",s);const c=o.yc.get(r),d=c&&c.key;if(d){let m=new Ri(mt.comparator);m=m.insert(d,Hi.newNoDocument(d,qt.min()));const g=Sn().add(d),v=new Ew(qt.min(),new Map,new Ri(bn),m,g);yield uF(o,v),o.gc=o.gc.remove(d),o.yc.delete(r),Jk(o)}else yield Sy(o.localStore,r,!1).then(()=>Ly(o,r,s)).catch(bf)})).apply(this,arguments)}function k4(n,e){return(vO=vO||(0,Te.Z)(function*(t,i){const r=_t(t),s=i.batch.batchId;try{const o=yield function qH(n,e){const t=_t(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=e.batch.keys(),s=t.Zi.newChangeBuffer({trackRemovals:!0});return function(o,c,d,m){const g=d.batch,v=g.keys();let E=ge.resolve();return v.forEach(T=>{E=E.next(()=>m.getEntry(c,T)).next(C=>{const k=d.docVersions.get(T);Kt(null!==k),C.version.compareTo(k)<0&&(g.applyToRemoteDocument(C,d),C.isValidDocument()&&(C.setReadTime(d.commitVersion),m.addEntry(C)))})}),E.next(()=>o.mutationQueue.removeMutationBatch(c,g))}(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(o){let c=Sn();for(let d=0;d<o.mutationResults.length;++d)o.mutationResults[d].transformResults.length>0&&(c=c.add(o.batch.mutations[d].key));return c}(e))).next(()=>t.localDocuments.getDocuments(i,r))})}(r.localStore,i);Qk(r,s,null),Zk(r,s),r.sharedClientState.updateMutationState(s,"acknowledged"),yield vd(r,o)}catch(o){yield bf(o)}})).apply(this,arguments)}function M4(n,e,t){return(bO=bO||(0,Te.Z)(function*(i,r,s){const o=_t(i);try{const c=yield function(d,m){const g=_t(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",v=>{let E;return g.mutationQueue.lookupMutationBatch(v,m).next(T=>(Kt(null!==T),E=T.keys(),g.mutationQueue.removeMutationBatch(v,T))).next(()=>g.mutationQueue.performConsistencyCheck(v)).next(()=>g.documentOverlayCache.removeOverlaysForBatchId(v,E,m)).next(()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(v,E)).next(()=>g.localDocuments.getDocuments(v,E))})}(o.localStore,r);Qk(o,r,s),Zk(o,r),o.sharedClientState.updateMutationState(r,"rejected",s),yield vd(o,c)}catch(c){yield bf(c)}})).apply(this,arguments)}function Zk(n,e){(n.Ec.get(e)||[]).forEach(t=>{t.resolve()}),n.Ec.delete(e)}function Qk(n,e,t){const i=_t(n);let r=i.Tc[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Tc[i.currentUser.toKey()]=r}}function Ly(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n._c.get(e))n.wc.delete(i),t&&n.dc.Pc(i,t);n._c.delete(e),n.isPrimaryClient&&n.Ic.Is(e).forEach(i=>{n.Ic.containsKey(i)||hF(n,i)})}function hF(n,e){n.mc.delete(e.path.canonicalString());const t=n.gc.get(e);null!==t&&(Fw(n.remoteStore,t),n.gc=n.gc.remove(e),n.yc.delete(t),Jk(n))}function Xk(n,e,t){for(const i of t)i instanceof aF?(n.Ic.addReference(i.key,e),O4(n,i)):i instanceof lF?(nt("SyncEngine","Document no longer in limbo: "+i.key),n.Ic.removeReference(i.key,e),n.Ic.containsKey(i.key)||hF(n,i.key)):Mt()}function O4(n,e){const t=e.key,i=t.path.canonicalString();n.gc.get(t)||n.mc.has(i)||(nt("SyncEngine","New document in limbo: "+t),n.mc.add(i),Jk(n))}function Jk(n){for(;n.mc.size>0&&n.gc.size<n.maxConcurrentLimboResolutions;){const e=n.mc.values().next().value;n.mc.delete(e);const t=new mt(Xn.fromString(e)),i=n.Ac.next();n.yc.set(i,new I4(t)),n.gc=n.gc.insert(t,i),xS(n.remoteStore,new yd(Do(gy(t.path)),i,"TargetPurposeLimboResolution",Ba.ct))}}function vd(n,e,t){return(EO=EO||(0,Te.Z)(function*(i,r,s){var o;const c=_t(i),d=[],m=[],g=[];c.wc.isEmpty()||(c.wc.forEach((v,E)=>{g.push(c.Rc(E,r,s).then(T=>{if((T||s)&&c.isPrimaryClient&&c.sharedClientState.updateQueryState(E.targetId,T?.fromCache?"not-current":"current"),T){d.push(T);const C=Lk.Li(E.targetId,T);m.push(C)}}))}),yield Promise.all(g),c.dc.nu(d),yield function(v,E){return(o=o||(0,Te.Z)(function*(T,C){const k=_t(T);try{yield k.persistence.runTransaction("notifyLocalViewChanges","readwrite",P=>ge.forEach(C,G=>ge.forEach(G.Fi,Y=>k.persistence.referenceDelegate.addReference(P,G.targetId,Y)).next(()=>ge.forEach(G.Bi,Y=>k.persistence.referenceDelegate.removeReference(P,G.targetId,Y)))))}catch(P){if(!wf(P))throw P;nt("LocalStore","Failed to update sequence numbers: "+P)}for(const P of C){const G=P.targetId;if(!P.fromCache){const Y=k.Ji.get(G),te=Y.withLastLimboFreeSnapshotVersion(Y.snapshotVersion);k.Ji=k.Ji.insert(G,te)}}})).apply(this,arguments)}(c.localStore,m))})).apply(this,arguments)}function P4(n,e){return(xO=xO||(0,Te.Z)(function*(t,i){const r=_t(t);if(!r.currentUser.isEqual(i)){nt("SyncEngine","User change. New user:",i.toKey());const s=yield VN(r.localStore,i);r.currentUser=i,function(o,c){o.Ec.forEach(d=>{d.forEach(m=>{m.reject(new Ve(be.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),o.Ec.clear()}(r),r.sharedClientState.handleUserChange(i,s.removedBatchIds,s.addedBatchIds),yield vd(r,s.er)}})).apply(this,arguments)}function N4(n,e){const t=_t(n),i=t.yc.get(e);if(i&&i.fc)return Sn().add(i.key);{let r=Sn();const s=t._c.get(e);if(!s)return r;for(const o of s){const c=t.wc.get(o);r=r.unionWith(c.view.nc)}return r}}function F4(n,e){return(TO=TO||(0,Te.Z)(function*(t,i){const r=_t(t),s=yield yS(r.localStore,i.query,!0),o=i.view.hc(s);return r.isPrimaryClient&&Xk(r,i.targetId,o.cc),o})).apply(this,arguments)}function B4(n,e){return(IO=IO||(0,Te.Z)(function*(t,i){const r=_t(t);return GN(r.localStore,i).then(s=>vd(r,s))})).apply(this,arguments)}function U4(n,e,t,i){return(SO=SO||(0,Te.Z)(function*(r,s,o,c){const d=_t(r),m=yield function(g,v){const E=_t(g),T=_t(E.mutationQueue);return E.persistence.runTransaction("Lookup mutation documents","readonly",C=>T.Sn(C,v).next(k=>k?E.localDocuments.getDocuments(C,k):ge.resolve(null)))}(d.localStore,s);var v;null!==m?("pending"===o?yield Dy(d.remoteStore):"acknowledged"===o||"rejected"===o?(Qk(d,s,c||null),Zk(d,s),v=s,_t(_t(d.localStore).mutationQueue).Cn(v)):Mt(),yield vd(d,m)):nt("SyncEngine","Cannot apply mutation batch with id: "+s)})).apply(this,arguments)}function fF(n,e,t){return(DO=DO||(0,Te.Z)(function*(i,r,s){const o=_t(i),c=[],d=[];for(const m of r){let g;const v=o._c.get(m);if(v&&0!==v.length){g=yield Iy(o.localStore,Do(v[0]));for(const E of v){const T=o.wc.get(E),C=yield F4(o,T);C.snapshot&&d.push(C.snapshot)}}else{const E=yield jN(o.localStore,m);g=yield Iy(o.localStore,E),yield Yk(o,mF(E),m,!1,g.resumeToken)}c.push(g)}return o.dc.nu(d),c})).apply(this,arguments)}function mF(n){return wP(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function $4(n){const e=_t(n);return _t(_t(e.localStore).persistence).$i()}function H4(n,e,t,i){return(AO=AO||(0,Te.Z)(function*(r,s,o,c){const d=_t(r);if(d.vc)return void nt("SyncEngine","Ignoring unexpected query state notification.");const m=d._c.get(s);if(m&&m.length>0)switch(o){case"current":case"not-current":{const g=yield GN(d.localStore,TP(m[0])),v=Ew.createSynthesizedRemoteEventForCurrentChange(s,"current"===o,Jr.EMPTY_BYTE_STRING);yield vd(d,g,v);break}case"rejected":yield Sy(d.localStore,s,!0),Ly(d,s,c);break;default:Mt()}})).apply(this,arguments)}function j4(n,e,t){return(RO=RO||(0,Te.Z)(function*(i,r,s){const o=eM(i);if(o.vc){for(const c of r){if(o._c.has(c)){nt("SyncEngine","Adding an already active target "+c);continue}const d=yield jN(o.localStore,c),m=yield Iy(o.localStore,d);yield Yk(o,mF(d),m.targetId,!1,m.resumeToken),xS(o.remoteStore,m)}for(const c of s)o._c.has(c)&&(yield Sy(o.localStore,c,!1).then(()=>{Fw(o.remoteStore,c),Ly(o,c)}).catch(bf))}})).apply(this,arguments)}function eM(n){const e=_t(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=uF.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=N4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=R4.bind(null,e),e.dc.nu=b4.bind(null,e.eventManager),e.dc.Pc=w4.bind(null,e.eventManager),e}function tM(n){const e=_t(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=k4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=M4.bind(null,e),e}class Bw{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,Te.Z)(function*(){t.serializer=Pw(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return UN(this.persistence,new BN,e.initialUser,this.serializer)}createPersistence(e){return new Ak(pS.zs,this.serializer)}createSharedClientState(e){return new qN}terminate(){var e=this;return(0,Te.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class nM extends Bw{constructor(e,t,i){super(),this.Vc=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,i=this;return(0,Te.Z)(function*(){yield t().call(i,e),yield i.Vc.initialize(i,e),yield tM(i.Vc.syncEngine),yield Dy(i.Vc.remoteStore),yield i.persistence.Ii(()=>(i.gcScheduler&&!i.gcScheduler.started&&i.gcScheduler.start(),i.indexBackfillerScheduler&&!i.indexBackfillerScheduler.started&&i.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return UN(this.persistence,new BN,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){return new AN(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const i=new g3(t,this.persistence);return new p3(e.asyncQueue,i)}createPersistence(e){const t=Mk(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=void 0!==this.cacheSizeBytes?to.withCacheSize(this.cacheSizeBytes):to.DEFAULT;return new kk(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,ZN(),ES(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new qN}}class pF extends nM{constructor(e,t){super(e,t,!1),this.Vc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,i=this;return(0,Te.Z)(function*(){var r;yield t().call(i,e);const s=i.Vc.syncEngine;i.sharedClientState instanceof Fk&&(i.sharedClientState.syncEngine={jr:U4.bind(null,s),zr:H4.bind(null,s),Wr:j4.bind(null,s),$i:$4.bind(null,s),Qr:B4.bind(null,s)},yield i.sharedClientState.start()),yield i.persistence.Ii(function(o){return(r=r||(0,Te.Z)(function*(c){yield function V4(n,e){return(CO=CO||(0,Te.Z)(function*(t,i){const r=_t(t);if(eM(r),tM(r),!0===i&&!0!==r.vc){const s=r.sharedClientState.getAllActiveQueryTargets(),o=yield fF(r,s.toArray());r.vc=!0,yield jk(r.remoteStore,!0);for(const c of o)xS(r.remoteStore,c)}else if(!1===i&&!1!==r.vc){const s=[];let o=Promise.resolve();r._c.forEach((c,d)=>{r.sharedClientState.isLocalQueryTarget(d)?s.push(d):o=o.then(()=>(Ly(r,d),Sy(r.localStore,d,!0))),Fw(r.remoteStore,d)}),yield o,yield fF(r,s),function(c){const d=_t(c);d.yc.forEach((m,g)=>{Fw(d.remoteStore,g)}),d.Ic.Ts(),d.yc=new Map,d.gc=new Ri(mt.comparator)}(r),r.vc=!1,yield jk(r.remoteStore,!1)}})).apply(this,arguments)}(i.Vc.syncEngine,c),i.gcScheduler&&(c&&!i.gcScheduler.started?i.gcScheduler.start():c||i.gcScheduler.stop()),i.indexBackfillerScheduler&&(c&&!i.indexBackfillerScheduler.started?i.indexBackfillerScheduler.start():c||i.indexBackfillerScheduler.stop())})).apply(this,arguments)})})()}createSharedClientState(e){const t=ZN();if(!Fk.D(t))throw new Ve(be.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=Mk(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Fk(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class Oy{initialize(e,t){var i=this;return(0,Te.Z)(function*(){i.localStore||(i.localStore=e.localStore,i.sharedClientState=e.sharedClientState,i.datastore=i.createDatastore(t),i.remoteStore=i.createRemoteStore(t),i.eventManager=i.createEventManager(t),i.syncEngine=i.createSyncEngine(t,!e.synchronizeTabs),i.sharedClientState.onlineStateHandler=r=>dF(i.syncEngine,r,1),i.remoteStore.remoteSyncer.handleCredentialChange=P4.bind(null,i.syncEngine),yield jk(i.remoteStore,i.syncEngine.isPrimaryClient))})()}createEventManager(e){return new v4}createDatastore(e){const t=Pw(e.databaseInfo.databaseId),i=new n4(e.databaseInfo);return function(s,o,c,d){return new s4(s,o,c,d)}(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return t=this.localStore,i=this.datastore,r=e.asyncQueue,s=c=>dF(this.syncEngine,c,0),o=YN.D()?new YN:new JH,new l4(t,i,r,s,o);var t,i,r,s,o}createSyncEngine(e,t){return function(i,r,s,o,c,d,m){const g=new S4(i,r,s,o,c,d);return m&&(g.vc=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){var e;return function(t){return(e=e||(0,Te.Z)(function*(i){const r=_t(i);nt("RemoteStore","RemoteStore shutting down."),r.vu.add(5),yield Cy(r),r.Pu.shutdown(),r.bu.set("Unknown")})).apply(this,arguments)}(this.remoteStore)}}function gF(n,e=10240){let t=0;return{read:()=>(0,Te.Z)(function*(){if(t<n.byteLength){const i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})(),cancel:()=>(0,Te.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class IS{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):Rr("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class W4{constructor(e,t){this.Cc=e,this.serializer=t,this.metadata=new Xr,this.buffer=new Uint8Array,this.xc=new TextDecoder("utf-8"),this.Nc().then(i=>{i&&i.Qu()?this.metadata.resolve(i.Gu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(i?.Gu)}`))},i=>this.metadata.reject(i))}close(){return this.Cc.cancel()}getMetadata(){var e=this;return(0,Te.Z)(function*(){return e.metadata.promise})()}bc(){var e=this;return(0,Te.Z)(function*(){return yield e.getMetadata(),e.Nc()})()}Nc(){var e=this;return(0,Te.Z)(function*(){const t=yield e.kc();if(null===t)return null;const i=e.xc.decode(t),r=Number(i);isNaN(r)&&e.Mc(`length string (${i}) is not valid number`);const s=yield e.$c(r);return new E4(JSON.parse(s),t.length+r)})()}Oc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}kc(){var e=this;return(0,Te.Z)(function*(){for(;e.Oc()<0&&!(yield e.Fc()););if(0===e.buffer.length)return null;const t=e.Oc();t<0&&e.Mc("Reached the end of bundle when a length string is expected.");const i=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),i})()}$c(e){var t=this;return(0,Te.Z)(function*(){for(;t.buffer.length<e;)(yield t.Fc())&&t.Mc("Reached the end of bundle when more is expected.");const i=t.xc.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),i})()}Mc(e){throw this.Cc.cancel(),new Error(`Invalid bundle format: ${e}`)}Fc(){var e=this;return(0,Te.Z)(function*(){const t=yield e.Cc.read();if(!t.done){const i=new Uint8Array(e.buffer.length+t.value.length);i.set(e.buffer),i.set(t.value,e.buffer.length),e.buffer=i}return t.done})()}}class K4{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,Te.Z)(function*(){var i;if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new Ve(be.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield function(s,o){return(i=i||(0,Te.Z)(function*(c,d){const m=_t(c),g=Iw(m.serializer)+"/documents",v={documents:d.map(k=>Tw(m.serializer,k))},E=yield m.vo("BatchGetDocuments",g,v,d.length),T=new Map;E.forEach(k=>{const P=function mH(n,e){return"found"in e?function(t,i){Kt(!!i.found);const r=mu(t,i.found.name),s=kr(i.found.updateTime),o=i.found.createTime?kr(i.found.createTime):qt.min(),c=new Fs({mapValue:{fields:i.found.fields}});return Hi.newFoundDocument(r,s,o,c)}(n,e):"missing"in e?function(t,i){Kt(!!i.missing),Kt(!!i.readTime);const r=mu(t,i.missing),s=kr(i.readTime);return Hi.newNoDocument(r,s)}(n,e):Mt()}(m.serializer,k);T.set(P.key.toString(),P)});const C=[];return d.forEach(k=>{const P=T.get(k.toString());Kt(!!P),C.push(P)}),C})).apply(this,arguments)}(t.datastore,e);return r.forEach(s=>t.recordVersion(s)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastWriteError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new by(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,Te.Z)(function*(){var t;if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const i=e.readVersions;e.mutations.forEach(r=>{i.delete(r.key.toString())}),i.forEach((r,s)=>{const o=mt.fromPath(s);e.mutations.push(new uk(o,e.precondition(o)))}),yield function(r,s){return(t=t||(0,Te.Z)(function*(o,c){const d=_t(o),m=Iw(d.serializer)+"/documents",g={writes:c.map(v=>Sw(d.serializer,v))};yield d.Io("Commit",m,g)})).apply(this,arguments)}(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Mt();t=qt.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new Ve(be.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(qt.min())?Ji.exists(!1):Ji.updateTime(t):Ji.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(qt.min()))throw new Ve(be.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ji.updateTime(t)}return Ji.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class q4{constructor(e,t,i,r,s){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=r,this.deferred=s,this.Bc=i.maxAttempts,this.qo=new Uk(this.asyncQueue,"transaction_retry")}run(){this.Bc-=1,this.Lc()}Lc(){var e=this;this.qo.No((0,Te.Z)(function*(){const t=new K4(e.datastore),i=e.qc(t);i&&i.then(r=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(r)}).catch(s=>{e.Uc(s)}))}).catch(r=>{e.Uc(r)})}))}qc(e){try{const t=this.updateFunction(e);return!lw(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Uc(e){this.Bc>0&&this.Kc(e)?(this.Bc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Lc(),Promise.resolve()))):this.deferred.reject(e)}Kc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!HP(t)}return!1}}class Y4{constructor(e,t,i,r){var o,s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=gs.UNAUTHENTICATED,this.clientId=UO.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,function(c){return(o=o||(0,Te.Z)(function*(d){nt("FirestoreClient","Received user=",d.uid),yield s.authCredentialListener(d),s.user=d})).apply(this,arguments)}),this.appCheckCredentials.start(i,c=>(nt("FirestoreClient","Received new app check token=",c),this.appCheckCredentialListener(c,this.user)))}getConfiguration(){var e=this;return(0,Te.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Ve(be.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new Xr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,Te.Z)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(i){const r=Ry(i,"Failed to shutdown persistence");t.reject(r)}})),t.promise}}function SS(n,e){return(kO=kO||(0,Te.Z)(function*(t,i){var r;t.asyncQueue.verifyOperationInProgress(),nt("FirestoreClient","Initializing OfflineComponentProvider");const s=yield t.getConfiguration();yield i.initialize(s);let o=s.initialUser;t.setCredentialChangeListener(function(c){return(r=r||(0,Te.Z)(function*(d){o.isEqual(d)||(yield VN(i.localStore,d),o=d)})).apply(this,arguments)}),i.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=i})).apply(this,arguments)}function iM(n,e){return(MO=MO||(0,Te.Z)(function*(t,i){t.asyncQueue.verifyOperationInProgress();const r=yield rM(t);nt("FirestoreClient","Initializing OnlineComponentProvider");const s=yield t.getConfiguration();yield i.initialize(r,s),t.setCredentialChangeListener(o=>iF(i.remoteStore,o)),t.setAppCheckTokenChangeListener((o,c)=>iF(i.remoteStore,c)),t._onlineComponents=i})).apply(this,arguments)}function _F(n){return"FirebaseError"===n.name?n.code===be.FAILED_PRECONDITION||n.code===be.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code}function rM(n){return(LO=LO||(0,Te.Z)(function*(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){nt("FirestoreClient","Using user provided OfflineComponentProvider");try{yield SS(e,e._uninitializedComponentsProvider._offline)}catch(t){const i=t;if(!_F(i))throw i;pl("Error using user provided cache. Falling back to memory cache: "+i),yield SS(e,new Bw)}}else nt("FirestoreClient","Using default OfflineComponentProvider"),yield SS(e,new Bw);return e._offlineComponents})).apply(this,arguments)}function CS(n){return(OO=OO||(0,Te.Z)(function*(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(nt("FirestoreClient","Using user provided OnlineComponentProvider"),yield iM(e,e._uninitializedComponentsProvider._online)):(nt("FirestoreClient","Using default OnlineComponentProvider"),yield iM(e,new Oy))),e._onlineComponents})).apply(this,arguments)}function yF(n){return rM(n).then(e=>e.persistence)}function DS(n){return rM(n).then(e=>e.localStore)}function vF(n){return CS(n).then(e=>e.remoteStore)}function sM(n){return CS(n).then(e=>e.syncEngine)}function Py(n){return(PO=PO||(0,Te.Z)(function*(e){const t=yield CS(e),i=t.eventManager;return i.onListen=C4.bind(null,t.syncEngine),i.onUnlisten=D4.bind(null,t.syncEngine),i})).apply(this,arguments)}function wF(n,e,t={}){const i=new Xr;return n.asyncQueue.enqueueAndForget((0,Te.Z)(function*(){return function(r,s,o,c,d){const m=new IS({next:v=>{s.enqueueAndForget(()=>Wk(r,g));const E=v.docs.has(o);!E&&v.fromCache?d.reject(new Ve(be.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&v.fromCache&&c&&"server"===c.source?d.reject(new Ve(be.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(v)},error:v=>d.reject(v)}),g=new qk(gy(o.path),m,{includeMetadataChanges:!0,Ku:!0});return zk(r,g)}(yield Py(n),n.asyncQueue,e,t,i)})),i.promise}function EF(n,e,t={}){const i=new Xr;return n.asyncQueue.enqueueAndForget((0,Te.Z)(function*(){return function(r,s,o,c,d){const m=new IS({next:v=>{s.enqueueAndForget(()=>Wk(r,g)),v.fromCache&&"server"===c.source?d.reject(new Ve(be.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(v)},error:v=>d.reject(v)}),g=new qk(o,m,{includeMetadataChanges:!0,Ku:!0});return zk(r,g)}(yield Py(n),n.asyncQueue,e,t,i)})),i.promise}function xF(n){const e={};return void 0!==n.timeoutSeconds&&(e.timeoutSeconds=n.timeoutSeconds),e}const TF=new Map;function oM(n,e,t){if(!t)throw new Ve(be.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function IF(n,e,t,i){if(!0===e&&!0===i)throw new Ve(be.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function SF(n){if(!mt.isDocumentKey(n))throw new Ve(be.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function CF(n){if(mt.isDocumentKey(n))throw new Ve(be.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function AS(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":Mt()}function $n(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ve(be.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=AS(n);throw new Ve(be.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function DF(n,e){if(e<=0)throw new Ve(be.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class AF{constructor(e){var t,i;if(void 0===e.host){if(void 0!==e.ssl)throw new Ve(be.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Ve(be.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}IF("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=xF(null!==(i=e.experimentalLongPollingOptions)&&void 0!==i?i:{}),function(r){if(void 0!==r.timeoutSeconds){if(isNaN(r.timeoutSeconds))throw new Ve(be.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Ve(be.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Ve(be.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Uw{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new AF({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Ve(be.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Ve(be.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new AF(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new n3;switch(t.type){case"firstParty":return new a3(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Ve(be.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=TF.get(e);t&&(nt("ComponentProvider","Removing Datastore"),TF.delete(e),t.terminate())}(this),Promise.resolve()}}function RF(n,e,t,i={}){var r;const s=(n=$n(n,Uw))._getSettings(),o=`${e}:${t}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&pl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let c,d;if("string"==typeof i.mockUserToken)c=i.mockUserToken,d=gs.MOCK_USER;else{c=(0,An.Sg)(i.mockUserToken,null===(r=n._app)||void 0===r?void 0:r.options.projectId);const m=i.mockUserToken.sub||i.mockUserToken.user_id;if(!m)throw new Ve(be.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new gs(m)}n._authCredentials=new r3(new FO(c,d))}}class ji{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new pu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ji(this.firestore,e,this._key)}}class Bs{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Bs(this.firestore,e,this._query)}}class pu extends Bs{constructor(e,t,i){super(e,t,gy(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ji(this.firestore,null,new mt(e))}withConverter(e){return new pu(this.firestore,e,this._path)}}function kF(n,e,...t){if(n=(0,An.m9)(n),oM("collection","path",e),n instanceof Uw){const i=Xn.fromString(e,...t);return CF(i),new pu(n,null,i)}{if(!(n instanceof ji||n instanceof pu))throw new Ve(be.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Xn.fromString(e,...t));return CF(i),new pu(n.firestore,null,i)}}function Vw(n,e,...t){if(n=(0,An.m9)(n),1===arguments.length&&(e=UO.A()),oM("doc","path",e),n instanceof Uw){const i=Xn.fromString(e,...t);return SF(i),new ji(n,null,new mt(i))}{if(!(n instanceof ji||n instanceof pu))throw new Ve(be.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Xn.fromString(e,...t));return SF(i),new ji(n.firestore,n instanceof pu?n.converter:null,new mt(i))}}function MF(n,e){return n=(0,An.m9)(n),e=(0,An.m9)(e),(n instanceof ji||n instanceof pu)&&(e instanceof ji||e instanceof pu)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function aM(n,e){return n=(0,An.m9)(n),e=(0,An.m9)(e),n instanceof Bs&&e instanceof Bs&&n.firestore===e.firestore&&pw(n._query,e._query)&&n.converter===e.converter}class sj{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new Uk(this,"async_queue_retry"),this.Xc=()=>{const t=ES();t&&nt("AsyncQueue","Visibility state changed to "+t.visibilityState),this.qo.Mo()};const e=ES();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=ES();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const t=new Xr;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}ea(){var e=this;return(0,Te.Z)(function*(){if(0!==e.Qc.length){try{yield e.Qc[0](),e.Qc.shift(),e.qo.reset()}catch(t){if(!wf(t))throw t;nt("AsyncQueue","Operation failed with retryable error: "+t)}e.Qc.length>0&&e.qo.No(()=>e.ea())}})()}ta(e){const t=this.Gc.then(()=>(this.Hc=!0,e().catch(i=>{this.Wc=i,this.Hc=!1;const r=function(s){let o=s.message||"";return s.stack&&(o=s.stack.includes(s.message)?s.stack:s.message+"\n"+s.stack),o}(i);throw Rr("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.Hc=!1,i))));return this.Gc=t,t}enqueueAfterDelay(e,t,i){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const r=Gk.createAndSchedule(this,e,t,i,s=>this.na(s));return this.zc.push(r),r}Zc(){this.Wc&&Mt()}verifyOperationInProgress(){}sa(){var e=this;return(0,Te.Z)(function*(){let t;do{t=e.Gc,yield t}while(t!==e.Gc)})()}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function lM(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const i=e;for(const r of["next","error","complete"])if(r in i&&"function"==typeof i[r])return!0;return!1}(n)}class oj{constructor(){this._progressObserver={},this._taskCompletionResolver=new Xr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class Gi extends Uw{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new sj,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||OF(this),this._firestoreClient.terminate()}}function LF(n,e){const t="object"==typeof n?n:(0,hr.getApp)(),i="string"==typeof n?n:e||"(default)",r=(0,hr._getProvider)(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=(0,An.P0)("firestore");s&&RF(r,...s)}return r}function Mr(n){return n._firestoreClient||OF(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function OF(n){var e,t,i;const r=n._freezeSettings(),s=function(o,c,d,m){return new F3(o,c,d,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,xF(m.experimentalLongPollingOptions),m.useFetchStreams)}(n._databaseId,(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",n._persistenceKey,r);n._firestoreClient=new Y4(n._authCredentials,n._appCheckCredentials,n._queue,s),null!==(t=r.cache)&&void 0!==t&&t._offlineComponentProvider&&null!==(i=r.cache)&&void 0!==i&&i._onlineComponentProvider&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.cache.kind,_offline:r.cache._offlineComponentProvider,_online:r.cache._onlineComponentProvider})}function PF(n,e,t){const i=new Xr;return n.asyncQueue.enqueue((0,Te.Z)(function*(){try{yield SS(n,t),yield iM(n,e),i.resolve()}catch(r){const s=r;if(!_F(s))throw s;pl("Error enabling indexeddb cache. Falling back to memory cache: "+s),i.reject(s)}})).then(()=>i.promise)}function NF(n){if(n._initialized||n._terminated)throw new Ve(be.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class gu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new gu(Jr.fromBase64String(e))}catch(t){throw new Ve(be.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new gu(Jr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class bd{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Ve(be.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new wr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class qp{constructor(e){this._methodName=e}}class RS{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ve(be.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ve(be.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return bn(this._lat,e._lat)||bn(this._long,e._long)}}const _j=/^__.*__$/;class yj{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return null!==this.fieldMask?new _d(e,this.data,this.fieldMask,t,this.fieldTransforms):new vy(e,this.data,t,this.fieldTransforms)}}class FF{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new _d(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function BF(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Mt()}}class kS{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,void 0===s&&this.ua(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new kS(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:i,la:!1});return r.fa(e),r}da(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:i,la:!1});return r.ua(),r}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return OS(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(BF(this.ca)&&_j.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class vj{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Pw(e)}ya(e,t,i,r=!1){return new kS({ca:e,methodName:t,ga:i,path:wr.emptyPath(),la:!1,ma:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Yp(n){const e=n._freezeSettings(),t=Pw(n._databaseId);return new vj(n._databaseId,!!e.ignoreUndefinedProperties,t)}function MS(n,e,t,i,r,s={}){const o=n.ya(s.merge||s.mergeFields?2:0,e,t,r);hM("Data must be an object, but it was:",o,i);const c=$F(i,o);let d,m;if(s.merge)d=new Jo(o.fieldMask),m=o.fieldTransforms;else if(s.mergeFields){const g=[];for(const v of s.mergeFields){const E=jw(e,v,t);if(!o.contains(E))throw new Ve(be.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);jF(g,E)||g.push(E)}d=new Jo(g),m=o.fieldTransforms.filter(v=>d.covers(v.field))}else d=null,m=o.fieldTransforms;return new yj(new Fs(c),d,m)}class Hw extends qp{_toFieldTransform(e){if(2!==e.ca)throw e._a(1===e.ca?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Hw}}function UF(n,e,t){return new kS({ca:3,ga:e.settings.ga,methodName:n._methodName,la:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class cM extends qp{_toFieldTransform(e){return new vw(e.path,new _y)}isEqual(e){return e instanceof cM}}class bj extends qp{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){const t=UF(this,e,!0),i=this.pa.map(s=>Zp(s,t)),r=new Up(i);return new vw(e.path,r)}isEqual(e){return this===e}}class wj extends qp{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){const t=UF(this,e,!0),i=this.pa.map(s=>Zp(s,t)),r=new Vp(i);return new vw(e.path,r)}isEqual(e){return this===e}}class Ej extends qp{constructor(e,t){super(e),this.Ia=t}_toFieldTransform(e){const t=new yy(e.serializer,kP(e.serializer,this.Ia));return new vw(e.path,t)}isEqual(e){return this===e}}function uM(n,e,t,i){const r=n.ya(1,e,t);hM("Data must be an object, but it was:",r,i);const s=[],o=Fs.empty();Ef(i,(d,m)=>{const g=LS(e,d,t);m=(0,An.m9)(m);const v=r.da(g);if(m instanceof Hw)s.push(g);else{const E=Zp(m,v);null!=E&&(s.push(g),o.set(g,E))}});const c=new Jo(s);return new FF(o,c,r.fieldTransforms)}function dM(n,e,t,i,r,s){const o=n.ya(1,e,t),c=[jw(e,i,t)],d=[r];if(s.length%2!=0)throw new Ve(be.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<s.length;E+=2)c.push(jw(e,s[E])),d.push(s[E+1]);const m=[],g=Fs.empty();for(let E=c.length-1;E>=0;--E)if(!jF(m,c[E])){const T=c[E];let C=d[E];C=(0,An.m9)(C);const k=o.da(T);if(C instanceof Hw)m.push(T);else{const P=Zp(C,k);null!=P&&(m.push(T),g.set(T,P))}}const v=new Jo(m);return new FF(g,v,o.fieldTransforms)}function VF(n,e,t,i=!1){return Zp(t,n.ya(i?4:3,e))}function Zp(n,e){if(HF(n=(0,An.m9)(n)))return hM("Unsupported field value:",e,n),$F(n,e);if(n instanceof qp)return function(t,i){if(!BF(i.ca))throw i._a(`${t._methodName}() can only be used with update() and set()`);if(!i.path)throw i._a(`${t._methodName}() is not currently supported inside arrays`);const r=t._toFieldTransform(i);r&&i.fieldTransforms.push(r)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.la&&4!==e.ca)throw e._a("Nested arrays are not supported");return function(t,i){const r=[];let s=0;for(const o of t){let c=Zp(o,i.wa(s));null==c&&(c={nullValue:"NULL_VALUE"}),r.push(c),s++}return{arrayValue:{values:r}}}(n,e)}return function(t,i){if(null===(t=(0,An.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return kP(i.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const r=Xi.fromDate(t);return{timestampValue:wy(i.serializer,r)}}if(t instanceof Xi){const r=new Xi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:wy(i.serializer,r)}}if(t instanceof RS)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof gu)return{bytesValue:XP(i.serializer,t._byteString)};if(t instanceof ji){const r=i.databaseId,s=t.firestore._databaseId;if(!s.isEqual(r))throw i._a(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:_k(t.firestore._databaseId||i.databaseId,t._key.path)}}throw i._a(`Unsupported field value: ${AS(t)}`)}(n,e)}function $F(n,e){const t={};return eP(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ef(n,(i,r)=>{const s=Zp(r,e.ha(i));null!=s&&(t[i]=s)}),{mapValue:{fields:t}}}function HF(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Xi||n instanceof RS||n instanceof gu||n instanceof ji||n instanceof qp)}function hM(n,e,t){if(!HF(t)||!function(i){return"object"==typeof i&&null!==i&&(Object.getPrototypeOf(i)===Object.prototype||null===Object.getPrototypeOf(i))}(t)){const i=AS(t);throw e._a("an object"===i?n+" a custom object":n+" "+i)}}function jw(n,e,t){if((e=(0,An.m9)(e))instanceof bd)return e._internalPath;if("string"==typeof e)return LS(n,e);throw OS("Field path arguments must be of type string or ",n,!1,void 0,t)}const xj=new RegExp("[~\\*/\\[\\]]");function LS(n,e,t){if(e.search(xj)>=0)throw OS(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new bd(...e.split("."))._internalPath}catch{throw OS(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function OS(n,e,t,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let d="";return(s||o)&&(d+=" (found",s&&(d+=` in field ${i}`),o&&(d+=` in document ${r}`),d+=")"),new Ve(be.INVALID_ARGUMENT,c+n+d)}function jF(n,e){return n.some(t=>t.isEqual(e))}class Gw{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ji(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Tj(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(PS("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Tj extends Gw{data(){return super.data()}}function PS(n,e){return"string"==typeof e?LS(n,e):e instanceof bd?e._internalPath:e._delegate._internalPath}function GF(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Ve(be.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class fM{}class zw extends fM{}function Pf(n,e,...t){let i=[];e instanceof fM&&i.push(e),i=i.concat(t),function(r){const s=r.filter(c=>c instanceof Ny).length,o=r.filter(c=>c instanceof Ww).length;if(s>1||s>0&&o>0)throw new Ve(be.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)n=r._apply(n);return n}class Ww extends zw{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Ww(e,t,i)}_apply(e){const t=this._parse(e);return qF(e._query,t),new Bs(e.firestore,e.converter,ak(e._query,t))}_parse(e){const t=Yp(e.firestore);return function(r,s,o,c,d,m,g){let v;if(d.isKeyField()){if("array-contains"===m||"array-contains-any"===m)throw new Ve(be.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if("in"===m||"not-in"===m){KF(g,m);const E=[];for(const T of g)E.push(WF(c,r,T));v={arrayValue:{values:E}}}else v=WF(c,r,g)}else"in"!==m&&"not-in"!==m&&"array-contains-any"!==m||KF(g,m),v=VF(o,"where",g,"in"===m||"not-in"===m);return Vn.create(d,m,v)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class Ny extends fM{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Ny(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return 1===t.length?t[0]:mi.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(i,r){let s=i;const o=r.getFlattenedFilters();for(const c of o)qF(s,c),s=ak(s,c)}(e._query,t),new Bs(e.firestore,e.converter,ak(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class mM extends zw{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new mM(e,t)}_apply(e){const t=function(i,r,s){if(null!==i.startAt)throw new Ve(be.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new Ve(be.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new my(r,s);return function(c,d){if(null===sk(c)){const m=eS(c);null!==m&&YF(0,m,d.field)}}(i,o),o}(e._query,this._field,this._direction);return new Bs(e.firestore,e.converter,function(i,r){const s=i.explicitOrderBy.concat([r]);return new pd(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}class NS extends zw{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new NS(e,t,i)}_apply(e){return new Bs(e.firestore,e.converter,tS(e._query,this._limit,this._limitType))}}class FS extends zw{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new FS(e,t,i)}_apply(e){const t=zF(e,this.type,this._docOrFields,this._inclusive);return new Bs(e.firestore,e.converter,function(i,r){return new pd(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,r,i.endAt)}(e._query,t))}}class BS extends zw{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new BS(e,t,i)}_apply(e){const t=zF(e,this.type,this._docOrFields,this._inclusive);return new Bs(e.firestore,e.converter,function(i,r){return new pd(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,r)}(e._query,t))}}function zF(n,e,t,i){if(t[0]=(0,An.m9)(t[0]),t[0]instanceof Gw)return function(r,s,o,c,d){if(!c)throw new Ve(be.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const m=[];for(const g of Bp(r))if(g.field.isKeyField())m.push(Np(s,c.key));else{const v=c.data.field(g.field);if(KI(v))throw new Ve(be.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+g.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===v){const E=g.field.canonicalString();throw new Ve(be.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${E}' (used as the orderBy) does not exist.`)}m.push(v)}return new Df(m,d)}(n._query,n.firestore._databaseId,e,t[0]._document,i);{const r=Yp(n.firestore);return function(s,o,c,d,m,g){const v=s.explicitOrderBy;if(m.length>v.length)throw new Ve(be.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const E=[];for(let T=0;T<m.length;T++){const C=m[T];if(v[T].field.isKeyField()){if("string"!=typeof C)throw new Ve(be.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof C}`);if(!ok(s)&&-1!==C.indexOf("/"))throw new Ve(be.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${C}' contains a slash.`);const k=s.path.child(Xn.fromString(C));if(!mt.isDocumentKey(k))throw new Ve(be.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${k}' is not because it contains an odd number of segments.`);const P=new mt(k);E.push(Np(o,P))}else{const k=VF(c,d,C);E.push(k)}}return new Df(E,g)}(n._query,n.firestore._databaseId,r,e,t,i)}}function WF(n,e,t){if("string"==typeof(t=(0,An.m9)(t))){if(""===t)throw new Ve(be.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ok(e)&&-1!==t.indexOf("/"))throw new Ve(be.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Xn.fromString(t));if(!mt.isDocumentKey(i))throw new Ve(be.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Np(n,new mt(i))}if(t instanceof ji)return Np(n,t._key);throw new Ve(be.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${AS(t)}.`)}function KF(n,e){if(!Array.isArray(n)||0===n.length)throw new Ve(be.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function qF(n,e){if(e.isInequality()){const i=eS(n),r=e.field;if(null!==i&&!i.isEqual(r))throw new Ve(be.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${i.toString()}' and '${r.toString()}'`);const s=sk(n);null!==s&&YF(0,r,s)}const t=function(i,r){for(const s of i)for(const o of s.getFlattenedFilters())if(r.indexOf(o.op)>=0)return o.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new Ve(be.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function YF(n,e,t){if(!t.isEqual(e))throw new Ve(be.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class pM{convertValue(e,t="none"){switch(Sf(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Er(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(md(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Mt()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Ef(e,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertGeoPoint(e){return new RS(Er(e.latitude),Er(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=qI(e);return null==i?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(uw(e));default:return null}}convertTimestamp(e){const t=xf(e);return new Xi(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Xn.fromString(e);Kt(lN(i));const r=new Tf(i.get(1),i.get(3)),s=new mt(i.popFirst(5));return r.isEqual(t)||Rr(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function US(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class Lj extends pM{constructor(e){super(),this.firestore=e}convertBytes(e){return new gu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ji(this.firestore,null,t)}}class Qp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class wd extends Gw{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Kw(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(PS("DocumentSnapshot.get",e));if(null!==i)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class Kw extends wd{data(e={}){return super.data(e)}}class Nf{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Qp(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new Kw(this._firestore,this._userDataWriter,i.key,i,new Qp(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ve(be.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,r){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(o=>({type:"added",doc:new Kw(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Qp(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:s++}))}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>r||3!==o.type).map(o=>{const c=new Kw(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Qp(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,m=-1;return 0!==o.type&&(d=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),1!==o.type&&(s=s.add(o.doc),m=s.indexOf(o.doc.key)),{type:Pj(o.type),doc:c,oldIndex:d,newIndex:m}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Pj(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Mt()}}function QF(n,e){return n instanceof wd&&e instanceof wd?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Nf&&e instanceof Nf&&n._firestore===e._firestore&&aM(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class Ff extends pM{constructor(e){super(),this.firestore=e}convertBytes(e){return new gu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ji(this.firestore,null,t)}}function XF(n,e,t){n=$n(n,ji);const i=$n(n.firestore,Gi),r=US(n.converter,e,t);return Fy(i,[MS(Yp(i),"setDoc",n._key,r,null!==n.converter,t).toMutation(n._key,Ji.none())])}function VS(n,e,t,...i){n=$n(n,ji);const r=$n(n.firestore,Gi),s=Yp(r);let o;return o="string"==typeof(e=(0,An.m9)(e))||e instanceof bd?dM(s,"updateDoc",n._key,e,t,i):uM(s,"updateDoc",n._key,e),Fy(r,[o.toMutation(n._key,Ji.exists(!0))])}function gM(n,...e){var t,i,r;n=(0,An.m9)(n);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||lM(e[o])||(s=e[o],o++);const c={includeMetadataChanges:s.includeMetadataChanges};if(lM(e[o])){const v=e[o];e[o]=null===(t=v.next)||void 0===t?void 0:t.bind(v),e[o+1]=null===(i=v.error)||void 0===i?void 0:i.bind(v),e[o+2]=null===(r=v.complete)||void 0===r?void 0:r.bind(v)}let d,m,g;if(n instanceof ji)m=$n(n.firestore,Gi),g=gy(n._key.path),d={next:v=>{e[o]&&e[o](_M(m,n,v))},error:e[o+1],complete:e[o+2]};else{const v=$n(n,Bs);m=$n(v.firestore,Gi),g=v._query;const E=new Ff(m);d={next:T=>{e[o]&&e[o](new Nf(m,E,v,T))},error:e[o+1],complete:e[o+2]},GF(n._query)}return function(v,E,T,C){const k=new IS(C),P=new qk(E,k,T);return v.asyncQueue.enqueueAndForget((0,Te.Z)(function*(){return zk(yield Py(v),P)})),()=>{k.Dc(),v.asyncQueue.enqueueAndForget((0,Te.Z)(function*(){return Wk(yield Py(v),P)}))}}(Mr(m),g,c,d)}function Fy(n,e){return function(t,i){const r=new Xr;return t.asyncQueue.enqueueAndForget((0,Te.Z)(function*(){return function A4(n,e,t){return(gO=gO||(0,Te.Z)(function*(i,r,s){const o=tM(i);try{const c=yield function(d,m){const g=_t(d),v=Xi.now(),E=m.reduce((k,P)=>k.add(P.key),Sn());let T,C;return g.persistence.runTransaction("Locally write mutations","readwrite",k=>{let P=ea(),G=Sn();return g.Zi.getEntries(k,E).next(Y=>{P=Y,P.forEach((W,te)=>{te.isValidDocument()||(G=G.add(W))})}).next(()=>g.localDocuments.getOverlayedDocuments(k,P)).next(Y=>{T=Y;const W=[];for(const te of m){const oe=rH(te,T.get(te.key).overlayedDocument);null!=oe&&W.push(new _d(te.key,oe,cP(oe.value.mapValue),Ji.exists(!0)))}return g.mutationQueue.addMutationBatch(k,v,W,m)}).next(Y=>{C=Y;const W=Y.applyToLocalDocumentSet(T,G);return g.documentOverlayCache.saveOverlays(k,Y.batchId,W)})}).then(()=>({batchId:C.batchId,changes:CP(T)}))}(o.localStore,r);o.sharedClientState.addPendingMutation(c.batchId),function(d,m,g){let v=d.Tc[d.currentUser.toKey()];v||(v=new Ri(bn)),v=v.insert(m,g),d.Tc[d.currentUser.toKey()]=v}(o,c.batchId,s),yield vd(o,c.changes),yield Dy(o.remoteStore)}catch(c){const d=Ry(c,"Failed to persist write");s.reject(d)}})).apply(this,arguments)}(yield sM(t),i,r)})),r.promise}(Mr(n),e)}function _M(n,e,t){const i=t.docs.get(e._key),r=new Ff(n);return new wd(n,r,e._key,i,new Qp(t.hasPendingWrites,t.fromCache),e.converter)}const Jj={maxAttempts:5};class JF{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Yp(e)}set(e,t,i){this._verifyNotCommitted();const r=Bf(e,this._firestore),s=US(r.converter,t,i),o=MS(this._dataReader,"WriteBatch.set",r._key,s,null!==r.converter,i);return this._mutations.push(o.toMutation(r._key,Ji.none())),this}update(e,t,i,...r){this._verifyNotCommitted();const s=Bf(e,this._firestore);let o;return o="string"==typeof(t=(0,An.m9)(t))||t instanceof bd?dM(this._dataReader,"WriteBatch.update",s._key,t,i,r):uM(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Ji.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Bf(e,this._firestore);return this._mutations=this._mutations.concat(new by(t._key,Ji.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ve(be.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Bf(n,e){if((n=(0,An.m9)(n)).firestore!==e)throw new Ve(be.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class eG extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Yp(e)}get(e){const t=Bf(e,this._firestore),i=new Lj(this._firestore);return this._transaction.lookup([t._key]).then(r=>{if(!r||1!==r.length)return Mt();const s=r[0];if(s.isFoundDocument())return new Gw(this._firestore,i,s.key,s,t.converter);if(s.isNoDocument())return new Gw(this._firestore,i,t._key,null,t.converter);throw Mt()})}set(e,t,i){const r=Bf(e,this._firestore),s=US(r.converter,t,i),o=MS(this._dataReader,"Transaction.set",r._key,s,null!==r.converter,i);return this._transaction.set(r._key,o),this}update(e,t,i,...r){const s=Bf(e,this._firestore);let o;return o="string"==typeof(t=(0,An.m9)(t))||t instanceof bd?dM(this._dataReader,"Transaction.update",s._key,t,i,r):uM(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}delete(e){const t=Bf(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Bf(e,this._firestore),i=new Ff(this._firestore);return super.get(e).then(r=>new wd(this._firestore,i,t._key,r._document,new Qp(!1,!1),t.converter))}}!function(n,e=!0){uy=hr.SDK_VERSION,(0,hr._registerComponent)(new cd.wA("firestore",(t,{instanceIdentifier:i,options:r})=>{const s=t.getProvider("app").getImmediate(),o=new Gi(new s3(t.getProvider("auth-internal")),new l3(t.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Ve(be.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Tf(c.options.projectId,d)}(s,i),s);return r=Object.assign({useFetchStreams:e},r),o._setSettings(r),o},"PUBLIC").setMultipleInstances(!0)),(0,hr.registerVersion)(NO,"3.13.0",n),(0,hr.registerVersion)(NO,"3.13.0","esm2017")}();let aG=(()=>{var n;class e{constructor(){this.localChannels=[{name:"PNN",url:"http://203.176.130.123:8989/live/pnn_480k.stream/playlist.m3u8"},{name:"TVK1",url:"https://live.kh.malimarcdn.com/live/tvk.stream/playlist.m3u8"},{name:"TVK2",url:"https://live.kh.malimarcdn.com/live/tvk2.stream/playlist.m3u8"},{name:"TV5",url:"http://203.176.130.123:8989/live/tv5_480k.stream/playlist.m3u8"},{name:"Bayonv TV",url:"  http://203.176.130.123:8989/live/bayontv_480k.stream/playlist.m3u8"},{name:"BTV",url:"  http://203.176.130.123:8989/live/bayontv1_480k.stream/playlist.m3u8"},{name:"SEA TV",url:"http://203.176.130.123:8989/live/seatv_480k.stream/playlist.m3u8"},{name:"WIKI TV",url:"http://206.189.93.160:1935/live/myStream_720p/playlist.m3u8"},{name:"CTV9",url:"http://203.176.130.123:8989/live/ctv9hd.stream/playlist.m3u8"},{name:"Fresh News",url:"https://streaming.freshnewsasia.com/live/ngrp:myStream_all/chunklist_w1992010384_b1496608.m3u8"},{name:"Apsara TV",url:"http://203.176.130.123:8989/live/apsaratv_480k.stream/playlist.m3u8"},{name:"Hang Meas TV",url:"http://167.99.72.244:1935/hm_hdtv/_definst_/smil:HMHDTV.smil/chunklist_w422093947_b800000_sleng.m3u8"},{name:"Raksmey Hang Mease",url:"http://malisresidencess.com:1934/rhm_hdtv/smil:RHMHDTV.smil/chunklist_w616528546_b1800000_sleng.m3u8"},{name:"TeaTv",url:"https://livefta.malimarcdn.com/ftaedge00/teatv2.sdp/playlist.m3u8"},{name:"KHMERTV",url:"https://livefta.malimarcdn.com/ftaedge00/khmertv2020.stream/chunklist.m3u8"},{name:"MSJ TV",url:"http://124.248.165.18:1935/live/myStream.smil/chunklist_w1860765658_b2260000_sleng.m3u8"},{name:"Netlink TV",url:"https://netlink.netlinkbroadcaster.com/hls/test.m3u8"}],this.globalChannels=[{name:"LOKAL",url:"http://andriant.my.id"},{name:"CH2 STARMAX",url:"http://stream.rs.co.th/ch2-hi/index.m3u8"},{name:"CH3 HD",url:"http://27.254.130.64/feed/ch3hd/playlist.m3u8"},{name:"CH5",url:"http://27.254.130.64/feed/ch5hd/playlist.m3u8"},{name:"CH7 HD",url:"http://27.254.130.64/feed/ch7hd/playlist.m3u8"},{name:"CH8",url:"http://stream.rs.co.th/ch8-hi/index.m3u8"},{name:"MCOT-HD",url:"http://27.254.130.64/feed/chmcothd/playlist.m3u8"},{name:"CH11 NBT",url:"http://27.254.130.64/live01/ch14.m3u8?p=m3u8"},{name:"CH11 NBT",url:"http://122.155.92.8:1935/live/ch1_L.sdp/chunklist.m3u8"},{name:"Workpoint",url:"https://gcorigin.wisdomcloud.net/live/master/playlist.m3u8_500.m3u8"}]}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();var t2=z(1389),yM=z(6451),$S=z(5363),lG=z(6063);class cG extends Yn.x{constructor(e=1/0,t=1/0,i=lG.l){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:i,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:o}=this;t||(i.push(e),!r&&i.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:i,_buffer:r}=this,s=r.slice();for(let o=0;o<s.length&&!e.closed;o+=i?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:i,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<i.length&&i.splice(0,i.length-s),!r){const o=t.now();let c=0;for(let d=1;d<i.length&&i[d]<=o;d+=2)c=d;c&&i.splice(0,c+1)}}}var n2=z(3099);function r2(n,e,t){let i,r=!1;return n&&"object"==typeof n?({bufferSize:i=1/0,windowTime:e=1/0,refCount:r=!1,scheduler:t}=n):i=n??1/0,(0,n2.B)({connector:()=>new cG(i,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}function s2(n,e){return(0,Ys.m)(e)?Di(()=>n,e):Di(()=>n)}var vM=z(9468),Cn=z(4976),cc=z(2011),uc=z(259);class Uf{constructor(e){return e}}class qw{constructor(){return(0,uc.C6)()}}const bM=new h.OlP("angularfire2._apps"),dG={provide:Uf,useFactory:function uG(n){return n&&1===n.length?n[0]:new Uf((0,uc.Mq)())},deps:[[new h.FiY,bM]]},hG={provide:qw,deps:[[new h.FiY,bM]]};function fG(n){return(e,t)=>{const i=e.runOutsideAngular(()=>n(t));return new Uf(i)}}let mG=(()=>{class n{constructor(t){(0,uc.KN)("angularfire",Cn.q4.full,"core"),(0,uc.KN)("angularfire",Cn.q4.full,"app"),(0,uc.KN)("angular",h.q4F.full,t.toString())}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(h.Lbi))},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({providers:[dG,hG]}),n})();function pG(n,...e){return{ngModule:mG,providers:[{provide:bM,useFactory:fG(n),multi:!0,deps:[h.R0b,h.zs3,Cn.HU,...e]}]}}const gG=(0,Cn.u3)(uc.Mq,!0),_G=(0,Cn.u3)(uc.ZF,!0);var o2,a2,d2,h2,f2;const wM=new Map,g2={activated:!1,tokenObservers:[]},yG={initialized:!1,enabled:!1};function xr(n){return wM.get(n)||Object.assign({},g2)}function HS(){return yG}const EM="https://content-firebaseappcheck.googleapis.com/v1",EG="exchangeDebugToken",_2={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class TG{constructor(e,t,i,r,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=i,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,Te.Z)(function*(){t.stop();try{t.pending=new An.BH,yield function IG(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new An.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(i){t.retryPolicy(i)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const Us=new An.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function xM(n){if(!xr(n).activated)throw Us.create("use-before-activation",{appName:n.name})}function zS(n,e){return(o2=o2||(0,Te.Z)(function*({url:t,body:i},r){const s={"Content-Type":"application/json"},o=r.getImmediate({optional:!0});if(o){const T=yield o.getHeartbeatsHeader();T&&(s["X-Firebase-Client"]=T)}const c={method:"POST",body:JSON.stringify(i),headers:s};let d,m;try{d=yield fetch(t,c)}catch(T){throw Us.create("fetch-network-error",{originalErrorMessage:T?.message})}if(200!==d.status)throw Us.create("fetch-status-error",{httpStatus:d.status});try{m=yield d.json()}catch(T){throw Us.create("fetch-parse-error",{originalErrorMessage:T?.message})}const g=m.ttl.match(/^([\d.]+)(s)$/);if(!g||!g[2]||isNaN(Number(g[1])))throw Us.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${m.ttl}`});const v=1e3*Number(g[1]),E=Date.now();return{token:m.token,expireTimeMillis:E+v,issuedAtTimeMillis:E}})).apply(this,arguments)}function y2(n,e){const{projectId:t,appId:i,apiKey:r}=n.options;return{url:`${EM}/projects/${t}/apps/${i}:${EG}?key=${r}`,body:{debug_token:e}}}const AG="firebase-app-check-database",RG=1,Yw="firebase-app-check-store";let WS=null;function w2(n,e){return(a2=a2||(0,Te.Z)(function*(t,i){const s=(yield function b2(){return WS||(WS=new Promise((n,e)=>{try{const t=indexedDB.open(AG,RG);t.onsuccess=i=>{n(i.target.result)},t.onerror=i=>{var r;e(Us.create("storage-open",{originalErrorMessage:null===(r=i.target.error)||void 0===r?void 0:r.message}))},t.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(Yw,{keyPath:"compositeKey"})}}catch(t){e(Us.create("storage-open",{originalErrorMessage:t?.message}))}}),WS)}()).transaction(Yw,"readwrite"),c=s.objectStore(Yw).put({compositeKey:t,value:i});return new Promise((d,m)=>{c.onsuccess=g=>{d()},s.onerror=g=>{var v;m(Us.create("storage-set",{originalErrorMessage:null===(v=g.target.error)||void 0===v?void 0:v.message}))}})})).apply(this,arguments)}const Zw=new nu.Yd("@firebase/app-check");function IM(n,e){return(0,An.hl)()?function MG(n,e){return w2(function x2(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{Zw.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function SM(){return HS().enabled}function CM(){return(d2=d2||(0,Te.Z)(function*(){const n=HS();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const BG={error:"UNKNOWN_ERROR"};function UG(n){return An.US.encodeString(JSON.stringify(n),!1)}function KS(n){return(h2=h2||(0,Te.Z)(function*(e,t=!1){const i=e.app;xM(i);const r=xr(i);let o,s=r.token;if(s&&!By(s)&&(r.token=void 0,s=void 0),!s){const m=yield r.cachedTokenPromise;m&&(By(m)?s=m:yield IM(i,void 0))}if(!t&&s&&By(s))return{token:s.token};let d,c=!1;if(SM()){r.exchangeTokenPromise||(r.exchangeTokenPromise=zS(y2(i,yield CM()),e.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),c=!0);const m=yield r.exchangeTokenPromise;return yield IM(i,m),r.token=m,{token:m.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),c=!0),s=yield xr(i).exchangeTokenPromise}catch(m){"appCheck/throttled"===m.code?Zw.warn(m.message):Zw.error(m),o=m}return s?o?d=By(s)?{token:s.token,internalError:o}:C2(o):(d={token:s.token},r.token=s,yield IM(i,s)):d=C2(o),c&&function S2(n,e){const t=xr(n).tokenObservers;for(const i of t)try{"EXTERNAL"===i.type&&null!=e.error?i.error(e.error):i.next(e)}catch{}}(i,d),d})).apply(this,arguments)}function AM(n,e){const t=xr(n),i=t.tokenObservers.filter(r=>r.next!==e);0===i.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=i}function I2(n){const{app:e}=n,t=xr(e);let i=t.tokenRefresher;i||(i=function VG(n){const{app:e}=n;return new TG((0,Te.Z)(function*(){let i;if(i=xr(e).token?yield KS(n,!0):yield KS(n),i.error)throw i.error;if(i.internalError)throw i.internalError}),()=>!0,()=>{const t=xr(e);if(t.token){let i=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return i=Math.min(i,t.token.expireTimeMillis-3e5),Math.max(0,i-Date.now())}return 0},_2.RETRIAL_MIN_WAIT,_2.RETRIAL_MAX_WAIT)}(n),t.tokenRefresher=i),!i.isRunning()&&t.isTokenAutoRefreshEnabled&&i.start()}function By(n){return n.expireTimeMillis-Date.now()>0}function C2(n){return{token:UG(BG),error:n}}class $G{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=xr(this.app);for(const t of e)AM(this.app,t.next);return Promise.resolve()}}const P2="app-check-internal";!function tz(){(0,hr._registerComponent)(new cd.wA("app-check",n=>function HG(n,e){return new $G(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(P2).initialize()})),(0,hr._registerComponent)(new cd.wA(P2,n=>function jG(n){return{getToken:e=>KS(n,e),getLimitedUseToken:()=>function T2(n){return(f2=f2||(0,Te.Z)(function*(e){const t=e.app;xM(t);const{provider:i}=xr(t);if(SM()){const r=yield CM(),{token:s}=yield zS(y2(t,r),e.heartbeatServiceProvider);return{token:s}}{const{token:r}=yield i.getToken();return{token:r}}})).apply(this,arguments)}(n),addTokenListener:e=>function DM(n,e,t,i){const{app:r}=n,s=xr(r);if(s.tokenObservers=[...s.tokenObservers,{next:t,error:i,type:e}],s.token&&By(s.token)){const c=s.token;Promise.resolve().then(()=>{t({token:c.token}),I2(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>I2(n))}(n,"INTERNAL",e),removeTokenListener:e=>AM(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,hr.registerVersion)("@firebase/app-check","0.8.0")}();class Xp{constructor(){return(0,Cn.vb)("app-check")}}typeof window<"u"&&window;var oz=z(9260);const F2=new h.OlP("angularfire2.auth.use-emulator"),B2=new h.OlP("angularfire2.auth.settings"),U2=new h.OlP("angularfire2.auth.tenant-id"),V2=new h.OlP("angularfire2.auth.langugage-code"),$2=new h.OlP("angularfire2.auth.use-device-language"),H2=new h.OlP("angularfire.auth.persistence"),j2=(n,e,t,i,r,s,o,c)=>(0,cc.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const d=e.runOutsideAngular(()=>n.auth());if(t&&d.useEmulator(...t),i&&(d.tenantId=i),d.languageCode=r,s&&d.useDeviceLanguage(),o)for(const[m,g]of Object.entries(o))d.settings[m]=g;return c&&d.setPersistence(c),d},[t,i,r,s,o,c]);let Qw=(()=>{class n{constructor(t,i,r,s,o,c,d,m,g,v,E,T){const C=new Yn.x,k=Ct(void 0).pipe((0,$S.Q)(o.outsideAngular),Di(()=>s.runOutsideAngular(()=>Promise.resolve().then(z.bind(z,9568)))),(0,bt.U)(()=>(0,cc.on)(t,s,i)),(0,bt.U)(P=>j2(P,s,c,m,g,v,d,E)),r2({bufferSize:1,refCount:!1}));if(Xf(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Ct(null);else{k.pipe(Rs()).subscribe();const G=k.pipe(Di(te=>te.getRedirectResult().then(oe=>oe,()=>null)),Cn.iC,r2({bufferSize:1,refCount:!1})),Y=k.pipe(Di(te=>new lr.y(oe=>({unsubscribe:s.runOutsideAngular(()=>te.onAuthStateChanged(Ae=>oe.next(Ae),Ae=>oe.error(Ae),()=>oe.complete()))})))),W=k.pipe(Di(te=>new lr.y(oe=>({unsubscribe:s.runOutsideAngular(()=>te.onIdTokenChanged(Ae=>oe.next(Ae),Ae=>oe.error(Ae),()=>oe.complete()))}))));this.authState=G.pipe(s2(Y),(0,vM.R)(o.outsideAngular),(0,$S.Q)(o.insideAngular)),this.user=G.pipe(s2(W),(0,vM.R)(o.outsideAngular),(0,$S.Q)(o.insideAngular)),this.idToken=this.user.pipe(Di(te=>te?(0,Wn.D)(te.getIdToken()):Ct(null))),this.idTokenResult=this.user.pipe(Di(te=>te?(0,Wn.D)(te.getIdTokenResult()):Ct(null))),this.credential=(0,yM.T)(G,C,this.authState.pipe(_i(te=>!te))).pipe((0,bt.U)(te=>te?.user?te:null),(0,vM.R)(o.outsideAngular),(0,$S.Q)(o.insideAngular))}return(0,cc.pX)(this,k,s,{spy:{apply:(P,G,Y)=>{(P.startsWith("signIn")||P.startsWith("createUser"))&&Y.then(W=>C.next(W))}}})}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(cc.Dh),h.LFG(cc.xv,8),h.LFG(h.Lbi),h.LFG(h.R0b),h.LFG(Cn.HU),h.LFG(F2,8),h.LFG(B2,8),h.LFG(U2,8),h.LFG(V2,8),h.LFG($2,8),h.LFG(H2,8),h.LFG(Xp,8))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),G2=(()=>{var n;class e{constructor(i){this.afAuth=i}loginWithGoogle(){const i=new t2.V;this.afAuth.signInWithPopup(i)}logout(){return this.afAuth.signOut()}get loggedIn(){return!!this.afAuth.currentUser}}return(n=e).\u0275fac=function(i){return new(i||n)(h.LFG(Qw))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();var YS=z(4986);function MM(){return(0,Ni.e)((n,e)=>{let t,i=!1;n.subscribe((0,Ci.x)(e,r=>{const s=t;t=r,i&&e.next([s,r]),i=!0}))})}function LM(n,e=$l.y){return n=n??lz,(0,Ni.e)((t,i)=>{let r,s=!0;t.subscribe((0,Ci.x)(i,o=>{const c=e(o);(s||!n(r,c))&&(s=!1,r=c,i.next(o))}))})}function lz(n,e){return n===e}z(9568);var cz=z(3942);function OM(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Ve("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function z2(){if(typeof Uint8Array>"u")throw new Ve("unimplemented","Uint8Arrays are not available in this environment.")}function W2(){if(!function P3(){return typeof atob<"u"}())throw new Ve("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Xw{constructor(e){this._delegate=e}static fromBase64String(e){return W2(),new Xw(gu.fromBase64String(e))}static fromUint8Array(e){return z2(),new Xw(gu.fromUint8Array(e))}toBase64(){return W2(),this._delegate.toBase64()}toUint8Array(){return z2(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function PM(n){return function hz(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const i of e)if(i in t&&"function"==typeof t[i])return!0;return!1}(n,["next","error","complete"])}class fz{enableIndexedDbPersistence(e,t){return function lj(n,e){NF(n=$n(n,Gi));const t=Mr(n);if(t._uninitializedComponentsProvider)throw new Ve(be.FAILED_PRECONDITION,"SDK cache is already specified.");pl("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const i=n._freezeSettings(),r=new Oy;return PF(t,r,new nM(r,i.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function cj(n){NF(n=$n(n,Gi));const e=Mr(n);if(e._uninitializedComponentsProvider)throw new Ve(be.FAILED_PRECONDITION,"SDK cache is already specified.");pl("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),i=new Oy;return PF(e,i,new pF(i,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function uj(n){if(n._initialized&&!n._terminated)throw new Ve(be.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Xr;return n._queue.enqueueAndForgetEvenWhileRestricted((0,Te.Z)(function*(){try{var t;yield function(i){return(t=t||(0,Te.Z)(function*(r){if(!lc.D())return Promise.resolve();const s=r+"main";yield lc.delete(s)})).apply(this,arguments)}(Mk(n._databaseId,n._persistenceKey)),e.resolve()}catch(i){e.reject(i)}})),e.promise}(e._delegate)}}class K2{constructor(e,t,i){this._delegate=t,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof Tf||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&pl("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,i={}){RF(this._delegate,e,t,i)}enableNetwork(){return function hj(n){return function Z4(n){return n.asyncQueue.enqueue((0,Te.Z)(function*(){const e=yield yF(n),t=yield vF(n);return e.setNetworkEnabled(!0),function(i){const r=_t(i);return r.vu.delete(0),Nw(r)}(t)}))}(Mr(n=$n(n,Gi)))}(this._delegate)}disableNetwork(){return function fj(n){return function Q4(n){return n.asyncQueue.enqueue((0,Te.Z)(function*(){var e;const t=yield yF(n),i=yield vF(n);return t.setNetworkEnabled(!1),function(r){return(e=e||(0,Te.Z)(function*(s){const o=_t(s);o.vu.add(0),yield Cy(o),o.bu.set("Offline")})).apply(this,arguments)}(i)}))}(Mr(n=$n(n,Gi)))}(this._delegate)}enablePersistence(e){let t=!1,i=!1;return e&&(t=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,IF("synchronizeTabs",t,"experimentalForceOwningTab",i)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function dj(n){return function(e){const t=new Xr;return e.asyncQueue.enqueueAndForget((0,Te.Z)(function*(){return function L4(n,e){return(wO=wO||(0,Te.Z)(function*(t,i){const r=_t(t);Lf(r.remoteStore)||nt("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const s=yield function(c){const d=_t(c);return d.persistence.runTransaction("Get highest unacknowledged batch id","readonly",m=>d.mutationQueue.getHighestUnacknowledgedBatchId(m))}(r.localStore);if(-1===s)return void i.resolve();const o=r.Ec.get(s)||[];o.push(i),r.Ec.set(s,o)}catch(s){const o=Ry(s,"Initialization of waitForPendingWrites() operation failed");i.reject(o)}})).apply(this,arguments)}(yield sM(e),t)})),t.promise}(Mr(n=$n(n,Gi)))}(this._delegate)}onSnapshotsInSync(e){return function Gj(n,e){return function ej(n,e){const t=new IS(e);return n.asyncQueue.enqueueAndForget((0,Te.Z)(function*(){return function(i,r){_t(i).ku.add(r),r.next()}(yield Py(n),t)})),()=>{t.Dc(),n.asyncQueue.enqueueAndForget((0,Te.Z)(function*(){return function(i,r){_t(i).ku.delete(r)}(yield Py(n),t)}))}}(Mr(n=$n(n,Gi)),lM(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new Ve("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Uy(this,kF(this._delegate,e))}catch(t){throw Ao(t,"collection()","Firestore.collection()")}}doc(e){try{return new gl(this,Vw(this._delegate,e))}catch(t){throw Ao(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Ro(this,function rj(n,e){if(n=$n(n,Uw),oM("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Ve(be.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Bs(n,null,(t=e,new pd(Xn.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw Ao(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function tG(n,e,t){n=$n(n,Gi);const i=Object.assign(Object.assign({},Jj),t);return function(r){if(r.maxAttempts<1)throw new Ve(be.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(r,s,o){const c=new Xr;return r.asyncQueue.enqueueAndForget((0,Te.Z)(function*(){const d=yield function bF(n){return CS(n).then(e=>e.datastore)}(r);new q4(r.asyncQueue,d,o,s,c).run()})),c.promise}(Mr(n),r=>e(new eG(n,r)),i)}(this._delegate,t=>e(new q2(this,t)))}batch(){return Mr(this._delegate),new Y2(new JF(this._delegate,e=>Fy(this._delegate,e)))}loadBundle(e){return function mj(n,e){const t=Mr(n=$n(n,Gi)),i=new oj;return function tj(n,e,t,i){const r=function(s,o){let c;return c="string"==typeof s?GP().encode(s):s,d=function(d,m){if(d instanceof Uint8Array)return gF(d,m);if(d instanceof ArrayBuffer)return gF(new Uint8Array(d),m);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),new W4(d,o);var d}(t,Pw(e));n.asyncQueue.enqueueAndForget((0,Te.Z)(function*(){!function G4(n,e,t){var i;const r=_t(n);(function(s,o,c){return(i=i||(0,Te.Z)(function*(d,m,g){try{const v=yield m.getMetadata();if(yield function(k,P){const G=_t(k),Y=kr(P.createTime);return G.persistence.runTransaction("hasNewerBundle","readonly",W=>G.qs.getBundleMetadata(W,P.id)).then(W=>!!W&&W.createTime.compareTo(Y)>=0)}(d.localStore,v))return yield m.close(),g._completeWith({taskState:"Success",documentsLoaded:(k=v).totalDocuments,bytesLoaded:k.totalBytes,totalDocuments:k.totalDocuments,totalBytes:k.totalBytes}),Promise.resolve(new Set);g._updateProgress(oF(v));const E=new x4(v,d.localStore,m.serializer);let T=yield m.bc();for(;T;){const k=yield E.zu(T);k&&g._updateProgress(k),T=yield m.bc()}const C=yield E.complete();return yield vd(d,C.Ju,void 0),yield function(k,P){const G=_t(k);return G.persistence.runTransaction("Save bundle","readwrite",Y=>G.qs.saveBundleMetadata(Y,P))}(d.localStore,v),g._completeWith(C.progress),Promise.resolve(C.Hu)}catch(v){return pl("SyncEngine",`Loading bundle failed with ${v}`),g._failWith(v),Promise.resolve(new Set)}var k})).apply(this,arguments)})(r,e,t).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}(yield sM(n),r,i)}))}(t,n._databaseId,e,i),i}(this._delegate,e)}namedQuery(e){return function pj(n,e){return function nj(n,e){return n.asyncQueue.enqueue((0,Te.Z)(function*(){return function(t,i){const r=_t(t);return r.persistence.runTransaction("Get named query","readonly",s=>r.qs.getNamedQuery(s,i))}(yield DS(n),e)}))}(Mr(n=$n(n,Gi)),e).then(t=>t?new Bs(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Ro(this,t):null)}}class ZS extends pM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Xw(new gu(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return gl.forKey(t,this.firestore,null)}}class q2{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new ZS(e)}get(e){const t=eg(e);return this._delegate.get(t).then(i=>new Jw(this._firestore,new wd(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,t.converter)))}set(e,t,i){const r=eg(e);return i?(OM("Transaction.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){const s=eg(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){const t=eg(e);return this._delegate.delete(t),this}}class Y2{constructor(e){this._delegate=e}set(e,t,i){const r=eg(e);return i?(OM("WriteBatch.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){const s=eg(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){const t=eg(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Jp{constructor(e,t,i){this._firestore=e,this._userDataWriter=t,this._delegate=i}fromFirestore(e,t){const i=new Kw(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new eE(this._firestore,i),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const i=Jp.INSTANCES;let r=i.get(e);r||(r=new WeakMap,i.set(e,r));let s=r.get(t);return s||(s=new Jp(e,new ZS(e),t),r.set(t,s)),s}}Jp.INSTANCES=new WeakMap;class gl{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ZS(e)}static forPath(e,t,i){if(e.length%2!=0)throw new Ve("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new gl(t,new ji(t._delegate,i,new mt(e)))}static forKey(e,t,i){return new gl(t,new ji(t._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new Uy(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Uy(this.firestore,kF(this._delegate,e))}catch(t){throw Ao(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,An.m9)(e))instanceof ji&&MF(this._delegate,e)}set(e,t){t=OM("DocumentReference.set",t);try{return t?XF(this._delegate,e,t):XF(this._delegate,e)}catch(i){throw Ao(i,"setDoc()","DocumentReference.set()")}}update(e,t,...i){try{return 1===arguments.length?VS(this._delegate,e):VS(this._delegate,e,t,...i)}catch(r){throw Ao(r,"updateDoc()","DocumentReference.update()")}}delete(){return function Hj(n){return Fy($n(n.firestore,Gi),[new by(n._key,Ji.none())])}(this._delegate)}onSnapshot(...e){const t=Z2(e),i=Q2(e,r=>new Jw(this.firestore,new wd(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return gM(this._delegate,t,i)}get(e){let t;return t="cache"===e?.source?function Fj(n){n=$n(n,ji);const e=$n(n.firestore,Gi),t=Mr(e),i=new Ff(e);return function X4(n,e){const t=new Xr;return n.asyncQueue.enqueueAndForget((0,Te.Z)(function*(){var i;return function(r,s,o){return(i=i||(0,Te.Z)(function*(c,d,m){try{const g=yield function(v,E){const T=_t(v);return T.persistence.runTransaction("read document","readonly",C=>T.localDocuments.getDocument(C,E))}(c,d);g.isFoundDocument()?m.resolve(g):g.isNoDocument()?m.resolve(null):m.reject(new Ve(be.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(g){const v=Ry(g,`Failed to get document '${d} from cache`);m.reject(v)}})).apply(this,arguments)}(yield DS(n),e,t)})),t.promise}(t,n._key).then(r=>new wd(e,i,n._key,r,new Qp(null!==r&&r.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function Bj(n){n=$n(n,ji);const e=$n(n.firestore,Gi);return wF(Mr(e),n._key,{source:"server"}).then(t=>_M(e,n,t))}(this._delegate):function Nj(n){n=$n(n,ji);const e=$n(n.firestore,Gi);return wF(Mr(e),n._key).then(t=>_M(e,n,t))}(this._delegate),t.then(i=>new Jw(this.firestore,new wd(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new gl(this.firestore,this._delegate.withConverter(e?Jp.getInstance(this.firestore,e):null))}}function Ao(n,e,t){return n.message=n.message.replace(e,t),n}function Z2(n){for(const e of n)if("object"==typeof e&&!PM(e))return e;return{}}function Q2(n,e){var t,i;let r;return r=PM(n[0])?n[0]:PM(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:s=>{r.next&&r.next(e(s))},error:null===(t=r.error)||void 0===t?void 0:t.bind(r),complete:null===(i=r.complete)||void 0===i?void 0:i.bind(r)}}class Jw{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new gl(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return QF(this._delegate,e._delegate)}}class eE extends Jw{data(e){const t=this._delegate.data(e);return function t3(n,e){n||Mt()}(void 0!==t),t}}class Ro{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ZS(e)}where(e,t,i){try{return new Ro(this.firestore,Pf(this._delegate,function Ij(n,e,t){const i=e,r=PS("where",n);return Ww._create(r,i,t)}(e,t,i)))}catch(r){throw Ao(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Ro(this.firestore,Pf(this._delegate,function Sj(n,e="asc"){const t=e,i=PS("orderBy",n);return mM._create(i,t)}(e,t)))}catch(i){throw Ao(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Ro(this.firestore,Pf(this._delegate,function Cj(n){return DF("limit",n),NS._create("limit",n,"F")}(e)))}catch(t){throw Ao(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Ro(this.firestore,Pf(this._delegate,function Dj(n){return DF("limitToLast",n),NS._create("limitToLast",n,"L")}(e)))}catch(t){throw Ao(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Ro(this.firestore,Pf(this._delegate,function Aj(...n){return FS._create("startAt",n,!0)}(...e)))}catch(t){throw Ao(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Ro(this.firestore,Pf(this._delegate,function Rj(...n){return FS._create("startAfter",n,!1)}(...e)))}catch(t){throw Ao(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Ro(this.firestore,Pf(this._delegate,function kj(...n){return BS._create("endBefore",n,!1)}(...e)))}catch(t){throw Ao(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Ro(this.firestore,Pf(this._delegate,function Mj(...n){return BS._create("endAt",n,!0)}(...e)))}catch(t){throw Ao(t,"endAt()","Query.endAt()")}}isEqual(e){return aM(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function Vj(n){n=$n(n,Bs);const e=$n(n.firestore,Gi),t=Mr(e),i=new Ff(e);return function J4(n,e){const t=new Xr;return n.asyncQueue.enqueueAndForget((0,Te.Z)(function*(){var i;return function(r,s,o){return(i=i||(0,Te.Z)(function*(c,d,m){try{const g=yield yS(c,d,!0),v=new cF(d,g.ir),E=v.sc(g.documents),T=v.applyChanges(E,!1);m.resolve(T.snapshot)}catch(g){const v=Ry(g,`Failed to execute query '${d} against cache`);m.reject(v)}})).apply(this,arguments)}(yield DS(n),e,t)})),t.promise}(t,n._query).then(r=>new Nf(e,i,n,r))}(this._delegate):"server"===e?.source?function $j(n){n=$n(n,Bs);const e=$n(n.firestore,Gi),t=Mr(e),i=new Ff(e);return EF(t,n._query,{source:"server"}).then(r=>new Nf(e,i,n,r))}(this._delegate):function Uj(n){n=$n(n,Bs);const e=$n(n.firestore,Gi),t=Mr(e),i=new Ff(e);return GF(n._query),EF(t,n._query).then(r=>new Nf(e,i,n,r))}(this._delegate),t.then(i=>new NM(this.firestore,new Nf(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){const t=Z2(e),i=Q2(e,r=>new NM(this.firestore,new Nf(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return gM(this._delegate,t,i)}withConverter(e){return new Ro(this.firestore,this._delegate.withConverter(e?Jp.getInstance(this.firestore,e):null))}}class pz{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new eE(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class NM{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Ro(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new eE(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new pz(this._firestore,t))}forEach(e,t){this._delegate.forEach(i=>{e.call(t,new eE(this._firestore,i))})}isEqual(e){return QF(this._delegate,e._delegate)}}class Uy extends Ro{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new gl(this.firestore,e):null}doc(e){try{return new gl(this.firestore,void 0===e?Vw(this._delegate):Vw(this._delegate,e))}catch(t){throw Ao(t,"doc()","CollectionReference.doc()")}}add(e){return function jj(n,e){const t=$n(n.firestore,Gi),i=Vw(n),r=US(n.converter,e);return Fy(t,[MS(Yp(n.firestore),"addDoc",i._key,r,null!==n.converter,{}).toMutation(i._key,Ji.exists(!1))]).then(()=>i)}(this._delegate,e).then(t=>new gl(this.firestore,t))}isEqual(e){return MF(this._delegate,e._delegate)}withConverter(e){return new Uy(this.firestore,this._delegate.withConverter(e?Jp.getInstance(this.firestore,e):null))}}function eg(n){return $n(n,ji)}class FM{constructor(...e){this._delegate=new bd(...e)}static documentId(){return new FM(wr.keyField().canonicalString())}isEqual(e){return(e=(0,An.m9)(e))instanceof bd&&this._delegate._internalPath.isEqual(e._internalPath)}}class tg{constructor(e){this._delegate=e}static serverTimestamp(){const e=function iG(){return new cM("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new tg(e)}static delete(){const e=function nG(){return new Hw("deleteField")}();return e._methodName="FieldValue.delete",new tg(e)}static arrayUnion(...e){const t=function rG(...n){return new bj("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new tg(t)}static arrayRemove(...e){const t=function sG(...n){return new wj("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new tg(t)}static increment(e){const t=function oG(n){return new Ej("increment",n)}(e);return t._methodName="FieldValue.increment",new tg(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const gz={Firestore:K2,GeoPoint:RS,Timestamp:Xi,Blob:Xw,Transaction:q2,WriteBatch:Y2,DocumentReference:gl,DocumentSnapshot:Jw,Query:Ro,QueryDocumentSnapshot:eE,QuerySnapshot:NM,CollectionReference:Uy,FieldPath:FM,FieldValue:tg,setLogLevel:function mz(n){!function e3(n){vf.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};function X2(n,e){return function vz(n,e=YS.z){return new lr.y(t=>{let i;return null!=e?e.schedule(()=>{i=n.onSnapshot({includeMetadataChanges:!0},t)}):i=n.onSnapshot({includeMetadataChanges:!0},t),()=>{i?.()}})}(n,e)}function BM(n,e){return X2(n,e).pipe((0,bt.U)(t=>({payload:t,type:"query"})))}function QS(n,e){return BM(n,e).pipe(Go(void 0),MM(),(0,bt.U)(([t,i])=>{const r=i.payload.docChanges(),s=r.map(o=>({type:o.type,payload:o}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((o,c)=>{const d=r.find(g=>g.doc.ref.isEqual(o.ref)),m=t?.payload.docs.find(g=>g.ref.isEqual(o.ref));d&&JSON.stringify(d.doc.metadata)===JSON.stringify(o.metadata)||!d&&m&&JSON.stringify(m.metadata)===JSON.stringify(o.metadata)||s.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:o}})}),s}))}function J2(n,e,t){return QS(n,t).pipe(Hc((i,r)=>function wz(n,e,t){return e.forEach(i=>{t.indexOf(i.type)>-1&&(n=function Ez(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return UM(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return UM(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return UM(n,e.oldIndex,1)}return n}(n,i))}),n}(i,r.map(s=>s.payload),e),[]),LM(),(0,bt.U)(i=>i.map(r=>({type:r.type,payload:r}))))}function UM(n,e,t,...i){const r=n.slice();return r.splice(e,t,...i),r}function eB(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}!function yz(n){(function _z(n,e){n.INTERNAL.registerComponent(new cd.wA("firestore-compat",t=>{const i=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(i,r)},"PUBLIC").setServiceProps(Object.assign({},gz)))})(n,(e,t)=>new K2(e,t,new fz)),n.registerVersion("@firebase/firestore-compat","0.3.12")}(cz.Z);class tB{constructor(e,t,i){this.ref=e,this.query=t,this.afs=i}stateChanges(e){let t=QS(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,bt.U)(i=>i.filter(r=>e.indexOf(r.type)>-1)))),t.pipe(Go(void 0),MM(),_i(([i,r])=>r.length>0||!i),(0,bt.U)(([i,r])=>r),Cn.iC)}auditTrail(e){return this.stateChanges(e).pipe(Hc((t,i)=>[...t,...i],[]))}snapshotChanges(e){const t=eB(e);return J2(this.query,t,this.afs.schedulers.outsideAngular).pipe(Cn.iC)}valueChanges(e={}){return BM(this.query,this.afs.schedulers.outsideAngular).pipe((0,bt.U)(t=>t.payload.docs.map(i=>e.idField?Object.assign(Object.assign({},i.data()),{[e.idField]:i.id}):i.data())),Cn.iC)}get(e){return(0,Wn.D)(this.query.get(e)).pipe(Cn.iC)}add(e){return this.ref.add(e)}doc(e){return new nB(this.ref.doc(e),this.afs)}}class nB{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const i=this.ref.collection(e),{ref:r,query:s}=sB(i,t);return new tB(r,s,this.afs)}snapshotChanges(){return function bz(n,e){return X2(n,e).pipe(Go(void 0),MM(),(0,bt.U)(([t,i])=>i.exists?t?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(Cn.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,bt.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,Wn.D)(this.ref.get(e)).pipe(Cn.iC)}}class xz{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?QS(this.query,this.afs.schedulers.outsideAngular).pipe((0,bt.U)(t=>t.filter(i=>e.indexOf(i.type)>-1)),_i(t=>t.length>0),Cn.iC):QS(this.query,this.afs.schedulers.outsideAngular).pipe(Cn.iC)}auditTrail(e){return this.stateChanges(e).pipe(Hc((t,i)=>[...t,...i],[]))}snapshotChanges(e){const t=eB(e);return J2(this.query,t,this.afs.schedulers.outsideAngular).pipe(Cn.iC)}valueChanges(e={}){return BM(this.query,this.afs.schedulers.outsideAngular).pipe((0,bt.U)(i=>i.payload.docs.map(r=>e.idField?Object.assign({[e.idField]:r.id},r.data()):r.data())),Cn.iC)}get(e){return(0,Wn.D)(this.query.get(e)).pipe(Cn.iC)}}const iB=new h.OlP("angularfire2.enableFirestorePersistence"),rB=new h.OlP("angularfire2.firestore.persistenceSettings"),Tz=new h.OlP("angularfire2.firestore.settings"),Iz=new h.OlP("angularfire2.firestore.use-emulator");function sB(n,e=(t=>t)){return{query:e(n),ref:n}}let $M,VM=(()=>{class n{constructor(t,i,r,s,o,c,d,m,g,v,E,T,C,k,P,G,Y){this.schedulers=d;const W=(0,cc.on)(t,c,i),te=g;v&&j2(W,c,E,C,k,P,T,G),[this.firestore,this.persistenceEnabled$]=(0,cc.cc)(`${W.name}.firestore`,"AngularFirestore",W.name,()=>{const oe=c.runOutsideAngular(()=>W.firestore());if(s&&oe.settings(s),te&&oe.useEmulator(...te),r&&!Xf(o)){const Ae=()=>{try{return(0,Wn.D)(oe.enablePersistence(m||void 0).then(()=>!0,()=>!1))}catch(we){return typeof console<"u"&&console.warn(we),Ct(!1)}};return[oe,c.runOutsideAngular(Ae)]}return[oe,Ct(!1)]},[s,te,r])}collection(t,i){let r;r="string"==typeof t?this.firestore.collection(t):t;const{ref:s,query:o}=sB(r,i),c=this.schedulers.ngZone.run(()=>s);return new tB(c,o,this)}collectionGroup(t,i){const r=i||(o=>o),s=this.firestore.collectionGroup(t);return new xz(r(s),this)}doc(t){let i;i="string"==typeof t?this.firestore.doc(t):t;const r=this.schedulers.ngZone.run(()=>i);return new nB(r,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(cc.Dh),h.LFG(cc.xv,8),h.LFG(iB,8),h.LFG(Tz,8),h.LFG(h.Lbi),h.LFG(h.R0b),h.LFG(Cn.HU),h.LFG(rB,8),h.LFG(Iz,8),h.LFG(Qw,8),h.LFG(F2,8),h.LFG(B2,8),h.LFG(U2,8),h.LFG(V2,8),h.LFG($2,8),h.LFG(H2,8),h.LFG(Xp,8))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),Sz=(()=>{class n{constructor(){oz.Z.registerVersion("angularfire",Cn.q4.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:iB,useValue:!0},{provide:rB,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({providers:[VM]}),n})();try{$M=typeof Intl<"u"&&Intl.v8BreakIterator}catch{$M=!1}let tE,JS,ng,HM,_l=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?function Qf(n){return n===yc}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!$M)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(h.Lbi))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function XS(n){return function Cz(){if(null==tE&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>tE=!0}))}finally{tE=tE||!1}return tE}()?n:!!n.capture}function nE(){if("object"!=typeof document||!document)return 0;if(null==JS){const n=document.createElement("div"),e=n.style;n.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const t=document.createElement("div"),i=t.style;i.width="2px",i.height="1px",n.appendChild(t),document.body.appendChild(n),JS=0,0===n.scrollLeft&&(n.scrollLeft=1,JS=0===n.scrollLeft?1:2),n.remove()}return JS}function $y(n){return n.composedPath?n.composedPath()[0]:n.target}function eC(n,e=YS.z){return(0,Ni.e)((t,i)=>{let r=null,s=null,o=null;const c=()=>{if(r){r.unsubscribe(),r=null;const m=s;s=null,i.next(m)}};function d(){const m=o+n,g=e.now();if(g<m)return r=this.schedule(void 0,m-g),void i.add(r);c()}t.subscribe((0,Ci.x)(i,m=>{s=m,o=e.now(),r||(r=e.schedule(d,n),i.add(r))},()=>{c(),i.complete()},void 0,()=>{s=r=null}))})}function lB(n){return _i((e,t)=>n<=t)}var Jz=z(5032);function ta(n){return(0,Ni.e)((e,t)=>{(0,qs.Xf)(n).subscribe((0,Ci.x)(t,()=>t.complete(),Jz.Z)),!t.closed&&e.subscribe(t)})}function Vs(n){return null!=n&&"false"!=`${n}`}function tC(n,e=0){return function e6(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):e}function cB(n){return Array.isArray(n)?n:[n]}function ig(n){return n instanceof h.SBq?n.nativeElement:n}const uB=new Set;let Hy,t6=(()=>{class n{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):i6}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function n6(n){if(!uB.has(n))try{Hy||(Hy=document.createElement("style"),Hy.setAttribute("type","text/css"),document.head.appendChild(Hy)),Hy.sheet&&(Hy.sheet.insertRule(`@media ${n} {body{ }}`,0),uB.add(n))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(_l))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function i6(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let dB=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new Yn.x}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return hB(cB(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){const r=hB(cB(t)).map(o=>this._registerQuery(o).observable);let s=lh(r);return s=Vc(s.pipe(go(1)),s.pipe(lB(1),eC(0))),s.pipe((0,bt.U)(o=>{const c={matches:!1,breakpoints:{}};return o.forEach(({matches:d,query:m})=>{c.matches=c.matches||d,c.breakpoints[m]=d}),c}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),s={observable:new lr.y(o=>{const c=d=>this._zone.run(()=>o.next(d));return i.addListener(c),()=>{i.removeListener(c)}}).pipe(Go(i),(0,bt.U)(({matches:o})=>({query:t,matches:o})),ta(this._destroySubject)),mql:i};return this._queries.set(t,s),s}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(t6),h.LFG(h.R0b))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function hB(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}let pB=(()=>{class n{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function u6(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const i=function c6(n){try{return n.frameElement}catch{return null}}(function y6(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(t));if(i&&(-1===_B(i)||!this.isVisible(i)))return!1;let r=t.nodeName.toLowerCase(),s=_B(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function g6(n){let e=n.nodeName.toLowerCase(),t="input"===e&&n.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,i){return function _6(n){return!function h6(n){return function m6(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function d6(n){let e=n.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(n)||function f6(n){return function p6(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||gB(n))}(t)&&!this.isDisabled(t)&&(i?.ignoreVisibility||this.isVisible(t))}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(_l))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function gB(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let e=n.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function _B(n){if(!gB(n))return null;const e=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class v6{get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}constructor(e,t,i,r,s=!1){this._element=e,this._checker=t,this._ngZone=i,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){const t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const i=this._getFirstTabbableElement(t);return i?.focus(e),!!i}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=0;i<t.length;i++){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[i]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=t.length-1;i>=0;i--){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[i]):null;if(r)return r}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(go(1)).subscribe(e)}}let b6=(()=>{class n{constructor(t,i,r){this._checker=t,this._ngZone=i,this._document=r}create(t,i=!1){return new v6(t,this._checker,this._ngZone,this._document,i)}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(pB),h.LFG(h.R0b),h.LFG(ue))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function yB(n){return 0===n.buttons||0===n.offsetX&&0===n.offsetY}function vB(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const w6=new h.OlP("cdk-input-modality-detector-options"),E6={ignoreKeys:[18,17,224,91,16]},jy=XS({passive:!0,capture:!0});let x6=(()=>{class n{get mostRecentModality(){return this._modality.value}constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new us(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(c=>c===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=$y(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(yB(o)?"keyboard":"mouse"),this._mostRecentTarget=$y(o))},this._onTouchstart=o=>{vB(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=$y(o))},this._options={...E6,...s},this.modalityDetected=this._modality.pipe(lB(1)),this.modalityChanged=this.modalityDetected.pipe(LM()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,jy),r.addEventListener("mousedown",this._onMousedown,jy),r.addEventListener("touchstart",this._onTouchstart,jy)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,jy),document.removeEventListener("mousedown",this._onMousedown,jy),document.removeEventListener("touchstart",this._onTouchstart,jy))}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(_l),h.LFG(h.R0b),h.LFG(ue),h.LFG(w6,8))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const I6=new h.OlP("cdk-focus-monitor-default-options"),nC=XS({passive:!0,capture:!0});let wB=(()=>{class n{constructor(t,i,r,s,o){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Yn.x,this._rootNodeFocusAndBlurListener=c=>{for(let m=$y(c);m;m=m.parentElement)"focus"===c.type?this._onFocus(c,m):this._onBlur(c,m)},this._document=s,this._detectionMode=o?.detectionMode||0}monitor(t,i=!1){const r=ig(t);if(!this._platform.isBrowser||1!==r.nodeType)return Ct(null);const s=function Rz(n){if(function Az(){if(null==HM){const n=typeof document<"u"?document.head:null;HM=!(!n||!n.createShadowRoot&&!n.attachShadow)}return HM}()){const e=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return i&&(o.checkChildren=!0),o.subject;const c={checkChildren:i,subject:new Yn.x,rootNode:s};return this._elementInfo.set(r,c),this._registerGlobalListeners(c),c.subject}stopMonitoring(t){const i=ig(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const s=ig(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([c,d])=>this._originChanged(c,i,d)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused","touch"===i),t.classList.toggle("cdk-keyboard-focused","keyboard"===i),t.classList.toggle("cdk-mouse-focused","mouse"===i),t.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),s=$y(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(t,i){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,nC),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,nC)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(ta(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,nC),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,nC),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!i||i===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const s=t.labels;if(s)for(let o=0;o<s.length;o++)if(s[o].contains(i))return!0;return!1}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(h.R0b),h.LFG(_l),h.LFG(x6),h.LFG(ue,8),h.LFG(I6,8))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const EB="cdk-high-contrast-black-on-white",xB="cdk-high-contrast-white-on-black",GM="cdk-high-contrast-active";let S6=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=(0,h.f3M)(dB).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(GM,EB,xB),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?t.add(GM,EB):2===i&&t.add(GM,xB)}}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(_l),h.LFG(ue))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const C6=new h.OlP("cdk-dir-doc",{providedIn:"root",factory:function D6(){return(0,h.f3M)(ue)}}),A6=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let TB=(()=>{class n{constructor(t){this.value="ltr",this.change=new h.vpe,t&&(this.value=function R6(n){const e=n?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?A6.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(C6,8))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),IB=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({}),n})();const M6=new h.OlP("mat-sanity-checks",{providedIn:"root",factory:function k6(){return!0}});let ko=(()=>{class n{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!function Mz(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(S6),h.LFG(M6,8),h.LFG(ue))},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({imports:[IB,IB]}),n})();function L6(n){return class extends n{get disabled(){return this._disabled}set disabled(e){this._disabled=Vs(e)}constructor(...e){super(...e),this._disabled=!1}}}function O6(n,e){return class extends n{get color(){return this._color}set color(t){const i=t||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}constructor(...t){super(...t),this.defaultColor=e,this.color=e}}}function P6(n){return class extends n{get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=Vs(e)}constructor(...e){super(...e),this._disableRipple=!1}}}class F6{constructor(e,t,i,r=!1){this._renderer=e,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const DB=XS({passive:!0,capture:!0});class B6{constructor(){this._events=new Map,this._delegateEventHandler=e=>{const t=$y(e);t&&this._events.get(e.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,i,r){const s=this._events.get(t);if(s){const o=s.get(i);o?o.add(r):s.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,DB)})}removeHandler(e,t,i){const r=this._events.get(e);if(!r)return;const s=r.get(t);s&&(s.delete(i),0===s.size&&r.delete(t),0===r.size&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,DB)))}}const AB={enterDuration:225,exitDuration:150},RB=XS({passive:!0,capture:!0}),kB=["mousedown","touchstart"],MB=["mouseup","mouseleave","touchend","touchcancel"];class Gy{constructor(e,t,i,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=ig(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...AB,...i.animation};i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=i.radius||function V6(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),c=e-r.left,d=t-r.top,m=s.enterDuration,g=document.createElement("div");g.classList.add("mat-ripple-element"),g.style.left=c-o+"px",g.style.top=d-o+"px",g.style.height=2*o+"px",g.style.width=2*o+"px",null!=i.color&&(g.style.backgroundColor=i.color),g.style.transitionDuration=`${m}ms`,this._containerElement.appendChild(g);const v=window.getComputedStyle(g),T=v.transitionDuration,C="none"===v.transitionProperty||"0s"===T||"0s, 0s"===T||0===r.width&&0===r.height,k=new F6(this,g,i,C);g.style.transform="scale3d(1, 1, 1)",k.state=0,i.persistent||(this._mostRecentTransientRipple=k);let P=null;return!C&&(m||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const G=()=>this._finishRippleTransition(k),Y=()=>this._destroyRipple(k);g.addEventListener("transitionend",G),g.addEventListener("transitioncancel",Y),P={onTransitionEnd:G,onTransitionCancel:Y}}),this._activeRipples.set(k,P),(C||!m)&&this._finishRippleTransition(k),k}fadeOutRipple(e){if(2===e.state||3===e.state)return;const t=e.element,i={...AB,...e.config.animation};t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",e.state=2,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=ig(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,kB.forEach(i=>{Gy._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{MB.forEach(t=>{this._triggerElement.addEventListener(t,this,RB)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){0===e.state?this._startFadeOutTransition(e):2===e.state&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=1,!i&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=3,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){const t=yB(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!vB(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const e=this._triggerElement;e&&(kB.forEach(t=>Gy._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&MB.forEach(t=>e.removeEventListener(t,this,RB)))}}Gy._eventManager=new B6;const zM=new h.OlP("mat-ripple-global-options");let iC=(()=>{class n{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,i,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new Gy(this,i,t,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}}return n.\u0275fac=function(t){return new(t||n)(h.Y36(h.SBq),h.Y36(h.R0b),h.Y36(_l),h.Y36(zM,8),h.Y36(h.QbO,8))},n.\u0275dir=h.lG2({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,i){2&t&&h.ekj("mat-ripple-unbounded",i.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),n})(),WM=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({imports:[ko,ko]}),n})(),$6=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({imports:[ko]}),n})();const H6=["videoPlayer"];function j6(n,e){if(1&n){const t=h.EpF();h.TgZ(0,"div",21)(1,"a",22),h.NdJ("click",function(){const r=h.CHM(t),s=r.index,o=r.$implicit,c=h.oxw();return c.createCollection(s,o.name),h.KtG(c.changeChannel(s,!0))}),h._uU(2),h.qZA()()}if(2&n){const t=e.$implicit,i=e.index,r=h.oxw();h.xp6(1),h.ekj("active",r.activeLocalChannel===i),h.xp6(1),h.AsE(" ",i,". ",t.name," ")}}function G6(n,e){if(1&n){const t=h.EpF();h.TgZ(0,"button",23),h.NdJ("click",function(){const s=h.CHM(t).$implicit,o=h.oxw();return h.KtG(o.updateChannelIndex(s))}),h._uU(1),h.qZA()}if(2&n){const t=e.$implicit;h.xp6(1),h.hij(" ",t," ")}}const z6=function(){return[1,2,3,4,5,6,7,8,9]};let W6=(()=>{var n;class e{constructor(i,r,s,o,c,d){this.route=i,this.router=r,this.store=s,this.auth=o,this.afAuth=c,this.firestore=d,this.documentRef=null,this.volumeLevel=0,this.activeLocalChannel=-1,this.activeGlobalChannel=-1,this.channelIndex=0,this.hls=new D_}handleKeyboardEvent(i){"ArrowLeft"===i.key?this.changeChannel(this.activeLocalChannel-1,!0):"ArrowRight"===i.key&&this.changeChannel(this.activeLocalChannel+1,!0)}createCollection(i,r){var s=this;return(0,Te.Z)(function*(){const o=s.firestore.collection("test"),d=yield s.afAuth.currentUser;if(d){const g={SelectedIndex:i,ChannelName:r,IncreaseVolume:s.volumeLevel<1?s.volumeLevel+.1:s.volumeLevel,DecreaseVolume:s.volumeLevel>0?s.volumeLevel-.1:s.volumeLevel,key:"",username:d.displayName};s.data=g;const v=o.doc("v9dWU1YRCsIOISzKbbjH");return s.documentRef=v.ref,g.key=v.ref.id,v.set(g).then(()=>{s.documentRef&&VS(s.documentRef,{SelectedIndex:i})}).catch(E=>{}),s.unsubscribe=gM(s.documentRef,E=>{const T=E.data();T&&s.router.navigate(["/display",T.ChannelName,T.SelectedIndex])}),v}throw new Error("User is not authenticated.")})()}ngOnInit(){this.fetchData(),this.firestore.collection("test").doc("v9dWU1YRCsIOISzKbbjH").valueChanges().subscribe(i=>{if(i&&i.ChannelName){const r=i.ChannelName;this.selectedIndex=i.SelectedIndex||0,this.router.navigate(["/display",r,this.selectedIndex])}})}fetchData(){this.afAuth.authState.subscribe(i=>{i?this.firestore.doc(`test/${i.uid}`).valueChanges().subscribe(s=>{const{SelectedIndex:o=0,ChannelName:c="",IncreaseVolume:d=0,DecreaseVolume:m=0,key:g="",username:v=null}=s||{};this.data={SelectedIndex:o,ChannelName:c,IncreaseVolume:d,DecreaseVolume:m,key:g,username:v}}):this.data={SelectedIndex:0,ChannelName:"",IncreaseVolume:0,DecreaseVolume:0,key:"",username:null}})}ngAfterViewInit(){var r,i=this;D_.isSupported()&&this.route.paramMap.subscribe(function(s){return(r=r||(0,Te.Z)(function*(o){const c=(o.get("channelName")||"").replace(/-/g," "),d=o.get("index");if(null!==d){const g=+d;i.changeChannel(g,g<i.store.localChannels.length);const E=i.createCollection(g,c);var m;E&&(yield E).valueChanges().subscribe(function(T){return(m=m||(0,Te.Z)(function*(C){if(C){void 0!==C.IncreaseVolume&&(i.videoplayer.nativeElement.volume=C.IncreaseVolume/100),void 0!==C.DecreaseVolume&&(i.videoplayer.nativeElement.volume=C.DecreaseVolume/100),void 0!==C.ChannelUrl&&i.activeLocalChannel===g&&i.playChannel(C.ChannelUrl);const P=(yield i.afAuth.currentUser)?.displayName;if(i.documentRef&&P){const Y=Vw(LF(),"test",i.documentRef.id);yield VS(Y,{username:P})}}})).apply(this,arguments)})}})).apply(this,arguments)})}ngOnDestroy(){if(this.documentRef){const i=this.data?.key;console.log("Document Key:",i)}this.unsubscribe()}playChannel(i){i.startsWith("blob:")?fetch(i).then(r=>r.blob()).then(r=>{const s=URL.createObjectURL(r);this.videoplayer.nativeElement.src=s,this.videoplayer.nativeElement.play()}):(this.hls.loadSource(i),this.hls.attachMedia(this.videoplayer.nativeElement),this.hls.on(D_.Events.MANIFEST_PARSED,()=>{this.videoplayer.nativeElement.play()}))}changeChannel(i,r){const s=r?this.store.localChannels:this.store.globalChannels;i<0?i=0:i>=s.length&&(i%=s.length),r?(this.activeLocalChannel=i,this.activeGlobalChannel=-1):(this.activeGlobalChannel=i,this.activeLocalChannel=-1),this.playChannel(s[i].url);const c=s[i].name;this.createCollection(i,c),this.router.navigate(["/display",c,i])}updateChannelIndex(i){this.channelIndex=10*this.channelIndex+i,this.changeChannelTimeout&&clearTimeout(this.changeChannelTimeout),this.changeChannelTimeout=setTimeout(()=>{this.changeChannel(this.channelIndex,!0),this.channelIndex=0},2e3),this.createCollection(this.channelIndex,this.store.localChannels[this.channelIndex].name)}increaseVolume(){this.updateVolume(.1)}decreaseVolume(){this.updateVolume(-.1)}updateVolume(i){let r=this.videoplayer.nativeElement.volume;const s=Math.max(Math.min(r+i,1),0);r!==s&&(this.videoplayer.nativeElement.volume=s,this.volumeLevel=Math.round(100*s),this.createCollection(this.activeLocalChannel,this.store.localChannels[this.activeLocalChannel].name))}onChannelIndexChange(i){this.channelIndex=+i.target.value}}return(n=e).\u0275fac=function(i){return new(i||n)(h.Y36(Qu),h.Y36(ds),h.Y36(aG),h.Y36(G2),h.Y36(Qw),h.Y36(VM))},n.\u0275cmp=h.Xpm({type:n,selectors:[["app-main-display"]],viewQuery:function(i,r){if(1&i&&h.Gf(H6,5),2&i){let s;h.iGM(s=h.CRH())&&(r.videoplayer=s.first)}},hostBindings:function(i,r){1&i&&h.NdJ("keydown",function(o){return r.handleKeyboardEvent(o)},!1,h.Jf7)},decls:40,vars:6,consts:[[1,"container"],[1,"row"],[1,"centre"],[1,"tv-frame"],["controls","","autoplay","",1,"w-100","video"],["videoPlayer",""],[1,"channel"],[1,"btn-channel"],["class","button",4,"ngFor","ngForOf"],[1,"remote-control"],[1,"title-remote"],[1,"volume-display"],[1,"number-display"],[1,"remote-row","col"],[1,"remote-updown","up",3,"click"],[1,"remote-updown","center"],[1,"remote-updown","down",3,"click"],[1,"channel-input"],[1,"number-buttons"],["class","num",3,"click",4,"ngFor","ngForOf"],[1,"num","zero",3,"click"],[1,"button"],["matRipple","",3,"click"],[1,"num",3,"click"]],template:function(i,r){1&i&&(h.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),h._UZ(4,"video",4,5),h.qZA()(),h.TgZ(6,"div",6)(7,"h2"),h._uU(8,"Local Channels"),h.qZA(),h.TgZ(9,"div",7),h.YNc(10,j6,3,4,"div",8),h.qZA()()()(),h.TgZ(11,"div",9)(12,"p",10),h._uU(13,"THY SMART TV"),h.qZA(),h.TgZ(14,"p",10),h._uU(15),h.qZA(),h.TgZ(16,"div",11),h._uU(17),h.qZA(),h.TgZ(18,"div",12),h._uU(19),h.qZA(),h.TgZ(20,"div",1)(21,"div",13)(22,"button",14),h.NdJ("click",function(){return r.increaseVolume()}),h._uU(23,"+"),h.qZA(),h.TgZ(24,"button",15),h._uU(25,"VOL"),h.qZA(),h.TgZ(26,"button",16),h.NdJ("click",function(){return r.decreaseVolume()}),h._uU(27,"-"),h.qZA()(),h.TgZ(28,"div",13)(29,"button",14),h.NdJ("click",function(){return r.changeChannel(r.selectedIndex+1,!0)}),h._uU(30," + "),h.qZA(),h.TgZ(31,"button",15),h._uU(32,"CN"),h.qZA(),h.TgZ(33,"button",16),h.NdJ("click",function(){return r.changeChannel(r.selectedIndex-1,!0)}),h._uU(34," - "),h.qZA()()(),h.TgZ(35,"div",17)(36,"div",18),h.YNc(37,G6,2,1,"button",19),h.TgZ(38,"button",20),h.NdJ("click",function(){return r.updateChannelIndex(0)}),h._uU(39,"0"),h.qZA()()()()),2&i&&(h.xp6(10),h.Q6J("ngForOf",r.store.localChannels),h.xp6(5),h.hij("[THY] webOS TV ",r.data.key,""),h.xp6(2),h.hij("Volume: ",r.volumeLevel,""),h.xp6(2),h.hij(" Channel: ",r.channelIndex||r.data.SelectedIndex," "),h.xp6(18),h.Q6J("ngForOf",h.DdM(5,z6)))},dependencies:[aa,iC],styles:[".container[_ngcontent-%COMP%]{font-family:Arial,sans-serif;min-width:100%;color:#fff;margin-top:50px}.channel[_ngcontent-%COMP%]{padding-top:16px;background-color:#fff;margin-left:auto;display:flex;flex-direction:column;text-align:center}.channel[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#000}.channel[_ngcontent-%COMP%]   .btn-channel[_ngcontent-%COMP%]{padding:0 10px 10px;overflow:hidden auto;max-height:calc(100vh - 122px)}.button[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:13px;border-radius:10px;width:100%;padding-left:3px}.button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:3px;align-items:flex-start;flex-shrink:0;padding:11px 10px;background-color:#bbd9e9;opacity:.8;transition:opacity .3s;border-radius:10px;width:90%;cursor:pointer;font-weight:500;color:#000;margin:4px 0}.button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:1}.button[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.tv-frame[_ngcontent-%COMP%]{min-width:704px;height:536px;background-image:url(/assets/PngItem_1681287.png);background-size:cover;background-position:center;position:relative}.video[_ngcontent-%COMP%]{border-radius:7px;position:absolute;top:7px;left:7px;object-fit:fill;width:98.2%;height:79.4%}.remote-control[_ngcontent-%COMP%]{display:none}.remote-row[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:10px}.row[_ngcontent-%COMP%]{display:flex}.col[_ngcontent-%COMP%]{flex-direction:column;border-radius:50%;padding:0 10px;width:70px}.remote-button[_ngcontent-%COMP%]{margin:5px;padding:5px 10px;font-size:14px;background-color:#f0f0f0;border:none;border-radius:5px;color:#333;transition:background-color .3s ease-in-out,transform .3s ease-in-out}.remote-button[_ngcontent-%COMP%]:hover{background-color:#007bff;color:#fff}.remote-button[_ngcontent-%COMP%]:active{animation:_ngcontent-%COMP%_button-click .2s linear}.remote-updown[_ngcontent-%COMP%]{padding:20px;border:none}.up[_ngcontent-%COMP%]{border-radius:50% 50% 0 0;font-size:20px}.center[_ngcontent-%COMP%]{font-weight:500}.down[_ngcontent-%COMP%]{font-size:20px;border-radius:0 0 50% 50%}.remote-updown.up[_ngcontent-%COMP%]:hover, .remote-updown.down[_ngcontent-%COMP%]:hover{background-color:#f2f2f2}.remote-updown.up[_ngcontent-%COMP%]:active, .remote-updown.down[_ngcontent-%COMP%]:active{animation:_ngcontent-%COMP%_button-click .2s linear;background-color:#f0f0f096}@keyframes _ngcontent-%COMP%_button-click{0%{transform:scale(1)}50%{transform:scale(.9)}to{transform:scale(1)}}.number-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;justify-items:center;align-items:center}.centre[_ngcontent-%COMP%]{display:block;margin:50px auto}.num[_ngcontent-%COMP%]{width:100px;height:50px;font-size:16px;background-color:#f0f0f0;border:none;border-radius:5px;color:#333;transition:background-color .3s ease-in-out,transform .3s ease-in-out;display:flex;align-items:center;justify-content:center}.num.zero[_ngcontent-%COMP%]{grid-column:span 3}.num[_ngcontent-%COMP%]:active{color:#fff;background-color:#007bff;animation:_ngcontent-%COMP%_button-click .2s linear}.volume-display[_ngcontent-%COMP%], .number-display[_ngcontent-%COMP%]{background-color:#f0f0f0;color:#000;padding:10px;margin-bottom:20px;border-radius:6px;font-size:16px}@media screen and (max-width: 600px){.container[_ngcontent-%COMP%]{display:none}.title-remote[_ngcontent-%COMP%]{color:#000!important;font-size:12px}.remote-control[_ngcontent-%COMP%]{display:block;position:fixed;height:100vh;width:100vw;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;justify-content:center;align-items:center}.remote-control[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background-color:#fff;padding:20px;border-radius:15px}.title-remote[_ngcontent-%COMP%]{font-size:16px!important}}"]}),e})(),K6=(()=>{var n;class e{constructor(i,r){this.router=i,this.firestore=r}ngOnInit(){this.firestore.collection("test").doc("v9dWU1YRCsIOISzKbbjH").valueChanges().subscribe(i=>{i&&i.ChannelName&&this.router.navigate(["/display",i.ChannelName,i.SelectedIndex])})}}return(n=e).\u0275fac=function(i){return new(i||n)(h.Y36(ds),h.Y36(VM))},n.\u0275cmp=h.Xpm({type:n,selectors:[["ng-component"]],decls:0,vars:0,template:function(i,r){},encapsulation:2}),e})();var q6=z(1144);const Y6=["addListener","removeListener"],Z6=["addEventListener","removeEventListener"],Q6=["on","off"];function rE(n,e,t,i){if((0,Ys.m)(t)&&(i=t,t=void 0),i)return rE(n,e,t).pipe(Wr(i));const[r,s]=function e8(n){return(0,Ys.m)(n.addEventListener)&&(0,Ys.m)(n.removeEventListener)}(n)?Z6.map(o=>c=>n[o](e,c,t)):function X6(n){return(0,Ys.m)(n.addListener)&&(0,Ys.m)(n.removeListener)}(n)?Y6.map(LB(n,e)):function J6(n){return(0,Ys.m)(n.on)&&(0,Ys.m)(n.off)}(n)?Q6.map(LB(n,e)):[];if(!r&&(0,q6.z)(n))return(0,Yi.z)(o=>rE(o,e,t))((0,qs.Xf)(n));if(!r)throw new TypeError("Invalid event target");return new lr.y(o=>{const c=(...d)=>o.next(1<d.length?d:d[0]);return r(c),()=>s(c)})}function LB(n,e){return t=>i=>n[t](e,i)}var OB=z(4408);const sE={schedule(n){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=sE;i&&(e=i.requestAnimationFrame,t=i.cancelAnimationFrame);const r=e(s=>{t=void 0,n(s)});return new el.w0(()=>t?.(r))},requestAnimationFrame(...n){const{delegate:e}=sE;return(e?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:e}=sE;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0};var PB=z(7565);new class n8 extends PB.v{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class t8 extends OB.o{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=sE.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(sE.cancelAnimationFrame(t),e._scheduled=void 0)}});let KM,r8=1;const rC={};function NB(n){return n in rC&&(delete rC[n],!0)}const s8={setImmediate(n){const e=r8++;return rC[e]=!0,KM||(KM=Promise.resolve()),KM.then(()=>NB(e)&&n()),e},clearImmediate(n){NB(n)}},{setImmediate:o8,clearImmediate:a8}=s8,sC={setImmediate(...n){const{delegate:e}=sC;return(e?.setImmediate||o8)(...n)},clearImmediate(n){const{delegate:e}=sC;return(e?.clearImmediate||a8)(n)},delegate:void 0};new class c8 extends PB.v{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class l8 extends OB.o{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=sC.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(sC.clearImmediate(t),e._scheduled===t&&(e._scheduled=void 0))}});var h8=z(3532);function FB(n,e=YS.z){return function d8(n){return(0,Ni.e)((e,t)=>{let i=!1,r=null,s=null,o=!1;const c=()=>{if(s?.unsubscribe(),s=null,i){i=!1;const m=r;r=null,t.next(m)}o&&t.complete()},d=()=>{s=null,o&&t.complete()};e.subscribe((0,Ci.x)(t,m=>{i=!0,r=m,s||(0,qs.Xf)(n(m)).subscribe(s=(0,Ci.x)(t,c,d))},()=>{o=!0,(!i||!s||s.closed)&&t.complete()}))})}(()=>function m8(n=0,e,t=YS.P){let i=-1;return null!=e&&((0,h8.K)(e)?t=e:i=e),new lr.y(r=>{let s=function f8(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}(n,e))}let qM=(()=>{class n{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new Yn.x,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new lr.y(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(FB(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Ct()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(_i(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=ig(i),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>rE(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(h.R0b),h.LFG(_l),h.LFG(ue,8))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),oE=(()=>{class n{constructor(t,i,r,s){this.elementRef=t,this.scrollDispatcher=i,this.ngZone=r,this.dir=s,this._destroyed=new Yn.x,this._elementScrolled=new lr.y(o=>this.ngZone.runOutsideAngular(()=>rE(this.elementRef.nativeElement,"scroll").pipe(ta(this._destroyed)).subscribe(o)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const i=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=r?t.end:t.start),null==t.right&&(t.right=r?t.start:t.end),null!=t.bottom&&(t.top=i.scrollHeight-i.clientHeight-t.bottom),r&&0!=nE()?(null!=t.left&&(t.right=i.scrollWidth-i.clientWidth-t.left),2==nE()?t.left=t.right:1==nE()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=i.scrollWidth-i.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const i=this.elementRef.nativeElement;!function Dz(){if(null==ng){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return ng=!1,ng;if("scrollBehavior"in document.documentElement.style)ng=!0;else{const n=Element.prototype.scrollTo;ng=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return ng}()?(null!=t.top&&(i.scrollTop=t.top),null!=t.left&&(i.scrollLeft=t.left)):i.scrollTo(t)}measureScrollOffset(t){const i="left",r="right",s=this.elementRef.nativeElement;if("top"==t)return s.scrollTop;if("bottom"==t)return s.scrollHeight-s.clientHeight-s.scrollTop;const o=this.dir&&"rtl"==this.dir.value;return"start"==t?t=o?r:i:"end"==t&&(t=o?i:r),o&&2==nE()?t==i?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:o&&1==nE()?t==i?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:t==i?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}}return n.\u0275fac=function(t){return new(t||n)(h.Y36(h.SBq),h.Y36(qM),h.Y36(h.R0b),h.Y36(TB,8))},n.\u0275dir=h.lG2({type:n,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0}),n})(),_8=(()=>{class n{constructor(t,i,r){this._platform=t,this._change=new Yn.x,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(FB(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(_l),h.LFG(h.R0b),h.LFG(ue,8))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),BB=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({}),n})();class UB{}class y8{}const Ed="*";function v8(n,e){return{type:7,name:n,definitions:e,options:{}}}function VB(n,e=null){return{type:4,styles:e,timings:n}}function $B(n,e=null){return{type:2,steps:n,options:e}}function oC(n){return{type:6,styles:n,offset:null}}function HB(n,e,t){return{type:0,name:n,styles:e,options:t}}function jB(n,e,t=null){return{type:1,expr:n,animation:e,options:t}}function GB(n){Promise.resolve().then(n)}class aE{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){GB(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class zB{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,r=0;const s=this.players.length;0==s?GB(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,c)=>Math.max(o,c.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}const YM="!",aC=["*"],b8=["content"];function w8(n,e){if(1&n){const t=h.EpF();h.TgZ(0,"div",2),h.NdJ("click",function(){h.CHM(t);const r=h.oxw();return h.KtG(r._onBackdropClicked())}),h.qZA()}if(2&n){const t=h.oxw();h.ekj("mat-drawer-shown",t._isShowingBackdrop())}}function E8(n,e){1&n&&(h.TgZ(0,"mat-drawer-content"),h.Hsn(1,2),h.qZA())}const x8=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],T8=["mat-drawer","mat-drawer-content","*"];function I8(n,e){if(1&n){const t=h.EpF();h.TgZ(0,"div",2),h.NdJ("click",function(){h.CHM(t);const r=h.oxw();return h.KtG(r._onBackdropClicked())}),h.qZA()}if(2&n){const t=h.oxw();h.ekj("mat-drawer-shown",t._isShowingBackdrop())}}function S8(n,e){1&n&&(h.TgZ(0,"mat-sidenav-content"),h.Hsn(1,2),h.qZA())}const C8=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],D8=["mat-sidenav","mat-sidenav-content","*"],WB={transformDrawer:v8("transform",[HB("open, open-instant",oC({transform:"none",visibility:"visible"})),HB("void",oC({"box-shadow":"none",visibility:"hidden"})),jB("void => open-instant",VB("0ms")),jB("void <=> open, open-instant => void",VB("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},R8=new h.OlP("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function k8(){return!1}}),ZM=new h.OlP("MAT_DRAWER_CONTAINER");let lC=(()=>{class n extends oE{constructor(t,i,r,s,o){super(r,s,o),this._changeDetectorRef=t,this._container=i}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return n.\u0275fac=function(t){return new(t||n)(h.Y36(h.sBO),h.Y36((0,h.Gpc)(()=>qB)),h.Y36(h.SBq),h.Y36(qM),h.Y36(h.R0b))},n.\u0275cmp=h.Xpm({type:n,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(t,i){2&t&&h.Udp("margin-left",i._container._contentMargins.left,"px")("margin-right",i._container._contentMargins.right,"px")},features:[h._Bn([{provide:oE,useExisting:n}]),h.qOj],ngContentSelectors:aC,decls:1,vars:0,template:function(t,i){1&t&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),n})(),KB=(()=>{class n{get position(){return this._position}set position(t){(t="end"===t?"end":"start")!==this._position&&(this._isAttached&&this._updatePositionInParent(t),this._position=t,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(t){this._mode=t,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(t){this._disableClose=Vs(t)}get autoFocus(){return this._autoFocus??("side"===this.mode?"dialog":"first-tabbable")}set autoFocus(t){("true"===t||"false"===t||null==t)&&(t=Vs(t)),this._autoFocus=t}get opened(){return this._opened}set opened(t){this.toggle(Vs(t))}constructor(t,i,r,s,o,c,d,m){this._elementRef=t,this._focusTrapFactory=i,this._focusMonitor=r,this._platform=s,this._ngZone=o,this._interactivityChecker=c,this._doc=d,this._container=m,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new Yn.x,this._animationEnd=new Yn.x,this._animationState="void",this.openedChange=new h.vpe(!0),this._openedStream=this.openedChange.pipe(_i(g=>g),(0,bt.U)(()=>{})),this.openedStart=this._animationStarted.pipe(_i(g=>g.fromState!==g.toState&&0===g.toState.indexOf("open")),yo(void 0)),this._closedStream=this.openedChange.pipe(_i(g=>!g),(0,bt.U)(()=>{})),this.closedStart=this._animationStarted.pipe(_i(g=>g.fromState!==g.toState&&"void"===g.toState),yo(void 0)),this._destroyed=new Yn.x,this.onPositionChanged=new h.vpe,this._modeChanged=new Yn.x,this.openedChange.subscribe(g=>{g?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{rE(this._elementRef.nativeElement,"keydown").pipe(_i(g=>27===g.keyCode&&!this.disableClose&&!function jM(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}(g)),ta(this._destroyed)).subscribe(g=>this._ngZone.run(()=>{this.close(),g.stopPropagation(),g.preventDefault()}))}),this._animationEnd.pipe(LM((g,v)=>g.fromState===v.fromState&&g.toState===v.toState)).subscribe(g=>{const{fromState:v,toState:E}=g;(0===E.indexOf("open")&&"void"===v||"void"===E&&0===v.indexOf("open"))&&this.openedChange.emit(this._opened)})}_forceFocus(t,i){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{t.removeEventListener("blur",r),t.removeEventListener("mousedown",r),t.removeAttribute("tabindex")};t.addEventListener("blur",r),t.addEventListener("mousedown",r)})),t.focus(i)}_focusByCssSelector(t,i){let r=this._elementRef.nativeElement.querySelector(t);r&&this._forceFocus(r,i)}_takeFocus(){if(!this._focusTrap)return;const t=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(i=>{!i&&"function"==typeof this._elementRef.nativeElement.focus&&t.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(t){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,t):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const t=this._doc.activeElement;return!!t&&this._elementRef.nativeElement.contains(t)}ngAfterViewInit(){this._isAttached=!0,this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState(),"end"===this._position&&this._updatePositionInParent("end")}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(t){return this.toggle(!0,t)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(t=!this.opened,i){t&&i&&(this._openedVia=i);const r=this._setOpen(t,!t&&this._isFocusWithinDrawer(),this._openedVia||"program");return t||(this._openedVia=null),r}_setOpen(t,i,r){return this._opened=t,t?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",i&&this._restoreFocus(r)),this._updateFocusTrapState(),new Promise(s=>{this.openedChange.pipe(go(1)).subscribe(o=>s(o?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_updatePositionInParent(t){const i=this._elementRef.nativeElement,r=i.parentNode;"end"===t?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),r.insertBefore(this._anchor,i)),r.appendChild(i)):this._anchor&&this._anchor.parentNode.insertBefore(i,this._anchor)}}return n.\u0275fac=function(t){return new(t||n)(h.Y36(h.SBq),h.Y36(b6),h.Y36(wB),h.Y36(_l),h.Y36(h.R0b),h.Y36(pB),h.Y36(ue,8),h.Y36(ZM,8))},n.\u0275cmp=h.Xpm({type:n,selectors:[["mat-drawer"]],viewQuery:function(t,i){if(1&t&&h.Gf(b8,5),2&t){let r;h.iGM(r=h.CRH())&&(i._content=r.first)}},hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(t,i){1&t&&h.WFA("@transform.start",function(s){return i._animationStarted.next(s)})("@transform.done",function(s){return i._animationEnd.next(s)}),2&t&&(h.uIk("align",null),h.d8E("@transform",i._animationState),h.ekj("mat-drawer-end","end"===i.position)("mat-drawer-over","over"===i.mode)("mat-drawer-push","push"===i.mode)("mat-drawer-side","side"===i.mode)("mat-drawer-opened",i.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:aC,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(t,i){1&t&&(h.F$t(),h.TgZ(0,"div",0,1),h.Hsn(2),h.qZA())},dependencies:[oE],encapsulation:2,data:{animation:[WB.transformDrawer]},changeDetection:0}),n})(),qB=(()=>{class n{get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(t){this._autosize=Vs(t)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(t){this._backdropOverride=null==t?null:Vs(t)}get scrollable(){return this._userContent||this._content}constructor(t,i,r,s,o,c=!1,d){this._dir=t,this._element=i,this._ngZone=r,this._changeDetectorRef=s,this._animationMode=d,this._drawers=new h.n_E,this.backdropClick=new h.vpe,this._destroyed=new Yn.x,this._doCheckSubject=new Yn.x,this._contentMargins={left:null,right:null},this._contentMarginChanges=new Yn.x,t&&t.change.pipe(ta(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),o.change().pipe(ta(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=c}ngAfterContentInit(){this._allDrawers.changes.pipe(Go(this._allDrawers),ta(this._destroyed)).subscribe(t=>{this._drawers.reset(t.filter(i=>!i._container||i._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(Go(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(t=>{this._watchDrawerToggle(t),this._watchDrawerPosition(t),this._watchDrawerMode(t)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(eC(10),ta(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(t=>t.open())}close(){this._drawers.forEach(t=>t.close())}updateContentMargins(){let t=0,i=0;if(this._left&&this._left.opened)if("side"==this._left.mode)t+=this._left._getWidth();else if("push"==this._left.mode){const r=this._left._getWidth();t+=r,i-=r}if(this._right&&this._right.opened)if("side"==this._right.mode)i+=this._right._getWidth();else if("push"==this._right.mode){const r=this._right._getWidth();i+=r,t-=r}t=t||null,i=i||null,(t!==this._contentMargins.left||i!==this._contentMargins.right)&&(this._contentMargins={left:t,right:i},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(t){t._animationStarted.pipe(_i(i=>i.fromState!==i.toState),ta(this._drawers.changes)).subscribe(i=>{"open-instant"!==i.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==t.mode&&t.openedChange.pipe(ta(this._drawers.changes)).subscribe(()=>this._setContainerClass(t.opened))}_watchDrawerPosition(t){t&&t.onPositionChanged.pipe(ta(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(go(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(t){t&&t._modeChanged.pipe(ta((0,yM.T)(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(t){const i=this._element.nativeElement.classList,r="mat-drawer-container-has-open";t?i.add(r):i.remove(r)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(t=>{"end"==t.position?this._end=t:this._start=t}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(t=>t&&!t.disableClose&&this._canHaveBackdrop(t)).forEach(t=>t._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(t){return"side"!==t.mode||!!this._backdropOverride}_isDrawerOpen(t){return null!=t&&t.opened}}return n.\u0275fac=function(t){return new(t||n)(h.Y36(TB,8),h.Y36(h.SBq),h.Y36(h.R0b),h.Y36(h.sBO),h.Y36(_8),h.Y36(R8),h.Y36(h.QbO,8))},n.\u0275cmp=h.Xpm({type:n,selectors:[["mat-drawer-container"]],contentQueries:function(t,i,r){if(1&t&&(h.Suo(r,lC,5),h.Suo(r,KB,5)),2&t){let s;h.iGM(s=h.CRH())&&(i._content=s.first),h.iGM(s=h.CRH())&&(i._allDrawers=s)}},viewQuery:function(t,i){if(1&t&&h.Gf(lC,5),2&t){let r;h.iGM(r=h.CRH())&&(i._userContent=r.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(t,i){2&t&&h.ekj("mat-drawer-container-explicit-backdrop",i._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[h._Bn([{provide:ZM,useExisting:n}])],ngContentSelectors:T8,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,i){1&t&&(h.F$t(x8),h.YNc(0,w8,1,2,"div",0),h.Hsn(1),h.Hsn(2,1),h.YNc(3,E8,2,0,"mat-drawer-content",1)),2&t&&(h.Q6J("ngIf",i.hasBackdrop),h.xp6(3),h.Q6J("ngIf",!i._content))},dependencies:[Es,lC],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),n})(),QM=(()=>{class n extends lC{constructor(t,i,r,s,o){super(t,i,r,s,o)}}return n.\u0275fac=function(t){return new(t||n)(h.Y36(h.sBO),h.Y36((0,h.Gpc)(()=>ZB)),h.Y36(h.SBq),h.Y36(qM),h.Y36(h.R0b))},n.\u0275cmp=h.Xpm({type:n,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(t,i){2&t&&h.Udp("margin-left",i._container._contentMargins.left,"px")("margin-right",i._container._contentMargins.right,"px")},features:[h._Bn([{provide:oE,useExisting:n}]),h.qOj],ngContentSelectors:aC,decls:1,vars:0,template:function(t,i){1&t&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),n})(),YB=(()=>{class n extends KB{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(t){this._fixedInViewport=Vs(t)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(t){this._fixedTopGap=tC(t)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(t){this._fixedBottomGap=tC(t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=h.n5z(n)))(i||n)}}(),n.\u0275cmp=h.Xpm({type:n,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(t,i){2&t&&(h.uIk("align",null),h.Udp("top",i.fixedInViewport?i.fixedTopGap:null,"px")("bottom",i.fixedInViewport?i.fixedBottomGap:null,"px"),h.ekj("mat-drawer-end","end"===i.position)("mat-drawer-over","over"===i.mode)("mat-drawer-push","push"===i.mode)("mat-drawer-side","side"===i.mode)("mat-drawer-opened",i.opened)("mat-sidenav-fixed",i.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[h.qOj],ngContentSelectors:aC,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(t,i){1&t&&(h.F$t(),h.TgZ(0,"div",0,1),h.Hsn(2),h.qZA())},dependencies:[oE],encapsulation:2,data:{animation:[WB.transformDrawer]},changeDetection:0}),n})(),ZB=(()=>{class n extends qB{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=h.n5z(n)))(i||n)}}(),n.\u0275cmp=h.Xpm({type:n,selectors:[["mat-sidenav-container"]],contentQueries:function(t,i,r){if(1&t&&(h.Suo(r,QM,5),h.Suo(r,YB,5)),2&t){let s;h.iGM(s=h.CRH())&&(i._content=s.first),h.iGM(s=h.CRH())&&(i._allDrawers=s)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(t,i){2&t&&h.ekj("mat-drawer-container-explicit-backdrop",i._backdropOverride)},exportAs:["matSidenavContainer"],features:[h._Bn([{provide:ZM,useExisting:n}]),h.qOj],ngContentSelectors:D8,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,i){1&t&&(h.F$t(C8),h.YNc(0,I8,1,2,"div",0),h.Hsn(1),h.Hsn(2,1),h.YNc(3,S8,2,0,"mat-sidenav-content",1)),2&t&&(h.Q6J("ngIf",i.hasBackdrop),h.xp6(3),h.Q6J("ngIf",!i._content))},dependencies:[Es,QM],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),n})(),M8=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({imports:[Ad,ko,BB,BB,ko]}),n})(),QB=(()=>{class n{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),P8=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({providers:[QB]}),n})(),N8=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({imports:[ko,ko]}),n})();const Wy=new h.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>mC}),mC="always";let VU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({}),n})(),F5=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({imports:[VU]}),n})(),U5=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Wy,useValue:t.callSetDisabledState??mC}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({imports:[F5]}),n})();const rV=["*"],lW=new h.OlP("MAT_LIST_CONFIG");let hE=(()=>{class n{constructor(){this._isNonInteractive=!0,this._disableRipple=!1,this._disabled=!1,this._defaultOptions=(0,h.f3M)(lW,{optional:!0})}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=Vs(t)}get disabled(){return this._disabled}set disabled(t){this._disabled=Vs(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=h.lG2({type:n,hostVars:1,hostBindings:function(t,i){2&t&&h.uIk("aria-disabled",i.disabled)},inputs:{disableRipple:"disableRipple",disabled:"disabled"}}),n})(),uW=(()=>{class n extends hE{constructor(){super(...arguments),this._isNonInteractive=!1}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=h.n5z(n)))(i||n)}}(),n.\u0275cmp=h.Xpm({type:n,selectors:[["mat-nav-list"]],hostAttrs:["role","navigation",1,"mat-mdc-nav-list","mat-mdc-list-base","mdc-list"],exportAs:["matNavList"],features:[h._Bn([{provide:hE,useExisting:n}]),h.qOj],ngContentSelectors:rV,decls:1,vars:0,template:function(t,i){1&t&&(h.F$t(),h.Hsn(0))},styles:['@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-list-divider::after{content:"";display:block;border-bottom-width:1px;border-bottom-style:solid}}.mdc-list{margin:0;padding:8px 0;list-style-type:none}.mdc-list:focus{outline:none}.mdc-list-item__wrapper{display:block}.mdc-list-item{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;align-items:stretch;cursor:pointer}.mdc-list-item:focus{outline:none}.mdc-list-item.mdc-list-item--with-one-line{height:48px}.mdc-list-item.mdc-list-item--with-two-lines{height:64px}.mdc-list-item.mdc-list-item--with-three-lines{height:88px}.mdc-list-item.mdc-list-item--with-one-line .mdc-list-item__start{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--with-three-lines .mdc-list-item__start{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--with-one-line .mdc-list-item__end{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-two-lines .mdc-list-item__end{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--disabled,.mdc-list-item.mdc-list-item--non-interactive{cursor:auto}.mdc-list-item:not(.mdc-list-item--selected):focus::before,.mdc-list-item.mdc-ripple-upgraded--background-focused::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-list-item:not(.mdc-list-item--selected):focus::before,.mdc-list-item.mdc-ripple-upgraded--background-focused::before{border-color:CanvasText}}.mdc-list-item.mdc-list-item--selected::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:3px double rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-list-item.mdc-list-item--selected::before{border-color:CanvasText}}.mdc-list-item.mdc-list-item--selected:focus::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:3px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-list-item.mdc-list-item--selected:focus::before{border-color:CanvasText}}a.mdc-list-item{color:inherit;text-decoration:none}.mdc-list-item__start{fill:currentColor;flex-shrink:0;pointer-events:none}.mdc-list-item__end{flex-shrink:0;pointer-events:none}.mdc-list-item__content{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;align-self:center;flex:1;pointer-events:none}.mdc-list-item--with-two-lines .mdc-list-item__content,.mdc-list-item--with-three-lines .mdc-list-item__content{align-self:stretch}.mdc-list-item__content[for]{pointer-events:none}.mdc-list-item__primary-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.mdc-list-item--with-two-lines .mdc-list-item__primary-text,.mdc-list-item--with-three-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before,.mdc-list-item--with-three-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after,.mdc-list-item--with-three-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item__secondary-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;margin-top:0;line-height:normal}.mdc-list-item__secondary-text::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-list-item--with-three-lines .mdc-list-item__secondary-text{white-space:normal;line-height:20px}.mdc-list-item--with-overline .mdc-list-item__secondary-text{white-space:nowrap;line-height:auto}.mdc-list-item__overline-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:24px;content:"";vertical-align:0}.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-three-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-three-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-three-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-avatar.mdc-list-item,.mdc-list-item--with-leading-avatar.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-avatar .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-avatar .mdc-list-item__start,.mdc-list-item--with-leading-avatar .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-avatar.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-avatar .mdc-list-item__start{border-radius:50%}.mdc-list-item--with-leading-icon.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-icon.mdc-list-item,.mdc-list-item--with-leading-icon.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-icon .mdc-list-item__start{margin-left:16px;margin-right:32px}[dir=rtl] .mdc-list-item--with-leading-icon .mdc-list-item__start,.mdc-list-item--with-leading-icon .mdc-list-item__start[dir=rtl]{margin-left:32px;margin-right:16px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-icon.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-thumbnail.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-thumbnail.mdc-list-item,.mdc-list-item--with-leading-thumbnail.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-thumbnail .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-thumbnail .mdc-list-item__start,.mdc-list-item--with-leading-thumbnail .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-image.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-image.mdc-list-item,.mdc-list-item--with-leading-image.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-image .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-image .mdc-list-item__start,.mdc-list-item--with-leading-image .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-image.mdc-list-item--with-one-line{height:72px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:8px}.mdc-list-item--with-leading-video.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-video.mdc-list-item,.mdc-list-item--with-leading-video.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-video .mdc-list-item__start{margin-left:0;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-video .mdc-list-item__start,.mdc-list-item--with-leading-video .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:0}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-video.mdc-list-item--with-one-line{height:72px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-checkbox.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-checkbox.mdc-list-item,.mdc-list-item--with-leading-checkbox.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-checkbox .mdc-list-item__start{margin-left:8px;margin-right:24px}[dir=rtl] .mdc-list-item--with-leading-checkbox .mdc-list-item__start,.mdc-list-item--with-leading-checkbox .mdc-list-item__start[dir=rtl]{margin-left:24px;margin-right:8px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:8px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-radio.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-radio.mdc-list-item,.mdc-list-item--with-leading-radio.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-radio .mdc-list-item__start{margin-left:8px;margin-right:24px}[dir=rtl] .mdc-list-item--with-leading-radio .mdc-list-item__start,.mdc-list-item--with-leading-radio .mdc-list-item__start[dir=rtl]{margin-left:24px;margin-right:8px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:8px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-radio.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-switch.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-switch.mdc-list-item,.mdc-list-item--with-leading-switch.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-switch .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-switch .mdc-list-item__start,.mdc-list-item--with-leading-switch .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:16px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-switch.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-trailing-icon.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-icon.mdc-list-item,.mdc-list-item--with-trailing-icon.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-icon .mdc-list-item__end{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-trailing-icon .mdc-list-item__end,.mdc-list-item--with-trailing-icon .mdc-list-item__end[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-trailing-meta.mdc-list-item--with-two-lines .mdc-list-item__end{align-self:flex-start;margin-top:0}.mdc-list-item--with-trailing-meta.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:0}.mdc-list-item--with-trailing-meta.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-meta.mdc-list-item,.mdc-list-item--with-trailing-meta.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-meta .mdc-list-item__end{margin-left:28px;margin-right:16px}[dir=rtl] .mdc-list-item--with-trailing-meta .mdc-list-item__end,.mdc-list-item--with-trailing-meta .mdc-list-item__end[dir=rtl]{margin-left:16px;margin-right:28px}.mdc-list-item--with-trailing-meta.mdc-list-item--with-two-lines .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-trailing-meta.mdc-list-item--with-two-lines .mdc-list-item__end::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-trailing-meta.mdc-list-item--with-three-lines .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-trailing-meta.mdc-list-item--with-three-lines .mdc-list-item__end::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-trailing-meta .mdc-list-item__end{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mdc-typography-caption-font-family);font-size:var(--mdc-typography-caption-font-size);line-height:var(--mdc-typography-caption-line-height);font-weight:var(--mdc-typography-caption-font-weight);letter-spacing:var(--mdc-typography-caption-letter-spacing);text-decoration:var(--mdc-typography-caption-text-decoration);text-transform:var(--mdc-typography-caption-text-transform)}.mdc-list-item--with-trailing-checkbox.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-checkbox.mdc-list-item,.mdc-list-item--with-trailing-checkbox.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-checkbox .mdc-list-item__end{margin-left:24px;margin-right:8px}[dir=rtl] .mdc-list-item--with-trailing-checkbox .mdc-list-item__end,.mdc-list-item--with-trailing-checkbox .mdc-list-item__end[dir=rtl]{margin-left:8px;margin-right:24px}.mdc-list-item--with-trailing-checkbox.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:8px}.mdc-list-item--with-trailing-radio.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-radio.mdc-list-item,.mdc-list-item--with-trailing-radio.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-radio .mdc-list-item__end{margin-left:24px;margin-right:8px}[dir=rtl] .mdc-list-item--with-trailing-radio .mdc-list-item__end,.mdc-list-item--with-trailing-radio .mdc-list-item__end[dir=rtl]{margin-left:8px;margin-right:24px}.mdc-list-item--with-trailing-radio.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:8px}.mdc-list-item--with-trailing-switch.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-switch.mdc-list-item,.mdc-list-item--with-trailing-switch.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-switch .mdc-list-item__end{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-trailing-switch .mdc-list-item__end,.mdc-list-item--with-trailing-switch .mdc-list-item__end[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-trailing-switch.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:16px}.mdc-list-item--with-overline.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-overline.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-list-item--with-overline.mdc-list-item--with-three-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-overline.mdc-list-item--with-three-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-list-item{padding-left:16px;padding-right:16px}[dir=rtl] .mdc-list-item,.mdc-list-item[dir=rtl]{padding-left:16px;padding-right:16px}.mdc-list-group .mdc-deprecated-list{padding:0}.mdc-list-group__subheader{margin:calc((3rem - 1.5rem)/2) 16px}.mdc-list-divider{padding:0;background-clip:content-box}.mdc-list-divider.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-text.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-icon.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-image.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-switch.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-radio.mdc-list-divider--with-leading-inset{padding-left:16px;padding-right:auto}[dir=rtl] .mdc-list-divider.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-text.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-icon.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-image.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-avatar.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-switch.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-radio.mdc-list-divider--with-leading-inset,.mdc-list-divider.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-text.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-icon.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-image.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-switch.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-radio.mdc-list-divider--with-leading-inset[dir=rtl]{padding-left:auto;padding-right:16px}.mdc-list-divider.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-text.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-icon.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-image.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-switch.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-radio.mdc-list-divider--with-trailing-inset{padding-left:auto;padding-right:16px}[dir=rtl] .mdc-list-divider.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-text.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-icon.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-image.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-avatar.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-switch.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-radio.mdc-list-divider--with-trailing-inset,.mdc-list-divider.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-text.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-icon.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-image.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-switch.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-radio.mdc-list-divider--with-trailing-inset[dir=rtl]{padding-left:16px;padding-right:auto}.mdc-list-divider--with-leading-video.mdc-list-divider--with-leading-inset{padding-left:0px;padding-right:auto}[dir=rtl] .mdc-list-divider--with-leading-video.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-video.mdc-list-divider--with-leading-inset[dir=rtl]{padding-left:auto;padding-right:0px}[dir=rtl] .mdc-list-divider,.mdc-list-divider[dir=rtl]{padding:0}.mdc-list-item{background-color:var(--mdc-list-list-item-container-color)}.mdc-list-item.mdc-list-item--selected{background-color:var(--mdc-list-list-item-selected-container-color)}.mdc-list-item--with-one-line{border-radius:var(--mdc-list-list-item-container-shape)}.mdc-list-item--with-one-line.mdc-list-item--with-leading-avatar,.mdc-list-item--with-one-line.mdc-list-item--with-leading-icon,.mdc-list-item--with-one-line.mdc-list-item--with-leading-thumbnail,.mdc-list-item--with-one-line.mdc-list-item--with-leading-checkbox,.mdc-list-item--with-one-line.mdc-list-item--with-leading-radio,.mdc-list-item--with-one-line.mdc-list-item--with-leading-switch{border-radius:var(--mdc-list-list-item-container-shape)}.mdc-list-item--with-one-line.mdc-list-item--with-leading-image,.mdc-list-item--with-one-line.mdc-list-item--with-leading-video{border-radius:var(--mdc-list-list-item-container-shape)}.mdc-list-item--with-two-lines{border-radius:var(--mdc-list-list-item-container-shape)}.mdc-list-item--with-two-lines.mdc-list-item--with-leading-avatar,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-icon,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-thumbnail,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-checkbox,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-radio,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-switch,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-image,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-video{border-radius:var(--mdc-list-list-item-container-shape)}.mdc-list-item--with-three-lines{border-radius:var(--mdc-list-list-item-container-shape)}.mdc-list-item.mdc-list-item--with-one-line{height:var(--mdc-list-list-item-one-line-container-height)}.mdc-list-item.mdc-list-item--with-two-lines{height:var(--mdc-list-list-item-two-line-container-height)}.mdc-list-item.mdc-list-item--with-three-lines{height:var(--mdc-list-list-item-three-line-container-height)}.mdc-list-item__primary-text{color:var(--mdc-list-list-item-label-text-color)}.mdc-list-item__primary-text{font-family:var(--mdc-list-list-item-label-text-font);line-height:var(--mdc-list-list-item-label-text-line-height);font-size:var(--mdc-list-list-item-label-text-size);font-weight:var(--mdc-list-list-item-label-text-weight);letter-spacing:var(--mdc-list-list-item-label-text-tracking)}.mdc-list-item__secondary-text{color:var(--mdc-list-list-item-supporting-text-color)}.mdc-list-item__secondary-text{font-family:var(--mdc-list-list-item-supporting-text-font);line-height:var(--mdc-list-list-item-supporting-text-line-height);font-size:var(--mdc-list-list-item-supporting-text-size);font-weight:var(--mdc-list-list-item-supporting-text-weight);letter-spacing:var(--mdc-list-list-item-supporting-text-tracking)}.mdc-list-item--with-leading-icon .mdc-list-item__start{color:var(--mdc-list-list-item-leading-icon-color)}.mdc-list-item--with-leading-icon .mdc-list-item__start{width:var(--mdc-list-list-item-leading-icon-size);height:var(--mdc-list-list-item-leading-icon-size)}.mdc-list-item--with-leading-icon .mdc-list-item__start>i{font-size:var(--mdc-list-list-item-leading-icon-size)}.mdc-list-item--with-leading-icon .mdc-list-item__start .mdc-list-item__icon{font-size:var(--mdc-list-list-item-leading-icon-size);width:var(--mdc-list-list-item-leading-icon-size);height:var(--mdc-list-list-item-leading-icon-size)}.mdc-list-item--with-leading-avatar .mdc-list-item__start{width:var(--mdc-list-list-item-leading-avatar-size);height:var(--mdc-list-list-item-leading-avatar-size)}.mdc-list-item.mdc-list-item--with-trailing-meta .mdc-list-item__end{color:var(--mdc-list-list-item-trailing-supporting-text-color)}.mdc-list-item--with-trailing-meta .mdc-list-item__end{font-family:var(--mdc-list-list-item-trailing-supporting-text-font);line-height:var(--mdc-list-list-item-trailing-supporting-text-line-height);font-size:var(--mdc-list-list-item-trailing-supporting-text-size);font-weight:var(--mdc-list-list-item-trailing-supporting-text-weight);letter-spacing:var(--mdc-list-list-item-trailing-supporting-text-tracking)}.mdc-list-item--with-trailing-icon .mdc-list-item__end{color:var(--mdc-list-list-item-trailing-icon-color)}.mdc-list-item--with-trailing-icon .mdc-list-item__end{width:var(--mdc-list-list-item-trailing-icon-size);height:var(--mdc-list-list-item-trailing-icon-size)}.mdc-list-item--with-trailing-icon .mdc-list-item__end>i{font-size:var(--mdc-list-list-item-trailing-icon-size)}.mdc-list-item--with-trailing-icon .mdc-list-item__end .mdc-list-item__icon{font-size:var(--mdc-list-list-item-trailing-icon-size);width:var(--mdc-list-list-item-trailing-icon-size);height:var(--mdc-list-list-item-trailing-icon-size)}.mdc-list-item--selected.mdc-list-item--with-trailing-icon .mdc-list-item__end{color:var(--mdc-list-list-item-selected-trailing-icon-color)}.mdc-list-item--disabled .mdc-list-item__start,.mdc-list-item--disabled .mdc-list-item__content,.mdc-list-item--disabled .mdc-list-item__end{opacity:1}.mdc-list-item--disabled .mdc-list-item__primary-text,.mdc-list-item--disabled .mdc-list-item__secondary-text,.mdc-list-item--disabled .mdc-list-item__overline-text{opacity:var(--mdc-list-list-item-disabled-label-text-opacity)}.mdc-list-item--disabled.mdc-list-item--with-leading-icon .mdc-list-item__start{color:var(--mdc-list-list-item-disabled-leading-icon-color)}.mdc-list-item--disabled.mdc-list-item--with-leading-icon .mdc-list-item__start{opacity:var(--mdc-list-list-item-disabled-leading-icon-opacity)}.mdc-list-item--disabled.mdc-list-item--with-trailing-icon .mdc-list-item__end{color:var(--mdc-list-list-item-disabled-trailing-icon-color)}.mdc-list-item--disabled.mdc-list-item--with-trailing-icon .mdc-list-item__end{opacity:var(--mdc-list-list-item-disabled-trailing-icon-opacity)}.mdc-list-item:hover .mdc-list-item__primary-text{color:var(--mdc-list-list-item-hover-label-text-color)}.mdc-list-item--with-leading-icon:hover .mdc-list-item__start{color:var(--mdc-list-list-item-hover-leading-icon-color)}.mdc-list-item--with-trailing-icon:hover .mdc-list-item__end{color:var(--mdc-list-list-item-hover-trailing-icon-color)}.mdc-list-item:focus .mdc-list-item__primary-text{color:var(--mdc-list-list-item-focus-label-text-color)}.mdc-list-item.mdc-list-item--disabled .mdc-list-item__primary-text{color:var(--mdc-list-list-item-disabled-label-text-color)}.mdc-list-item:hover::before{background-color:var(--mdc-list-list-item-hover-state-layer-color);opacity:var(--mdc-list-list-item-hover-state-layer-opacity)}.mdc-list-item.mdc-list-item--disabled::before{background-color:var(--mdc-list-list-item-disabled-state-layer-color);opacity:var(--mdc-list-list-item-disabled-state-layer-opacity)}.mdc-list-item:focus::before{background-color:var(--mdc-list-list-item-focus-state-layer-color);opacity:var(--mdc-list-list-item-focus-state-layer-opacity)}.mdc-list-item--disabled .mdc-radio,.mdc-list-item--disabled .mdc-checkbox{opacity:var(--mdc-list-list-item-disabled-label-text-opacity)}.mdc-list-item--with-leading-avatar .mat-mdc-list-item-avatar{border-radius:var(--mdc-list-list-item-leading-avatar-shape);background-color:var(--mdc-list-list-item-leading-avatar-color)}.mat-mdc-list-base{--mdc-list-list-item-container-shape:0;--mdc-list-list-item-leading-avatar-shape:50%;--mdc-list-list-item-container-color:transparent;--mdc-list-list-item-selected-container-color:transparent;--mdc-list-list-item-leading-avatar-color:transparent;--mdc-list-list-item-leading-icon-size:24px;--mdc-list-list-item-leading-avatar-size:40px;--mdc-list-list-item-trailing-icon-size:24px;--mdc-list-list-item-disabled-state-layer-color:transparent;--mdc-list-list-item-disabled-state-layer-opacity:0;--mdc-list-list-item-disabled-label-text-opacity:0.38;--mdc-list-list-item-disabled-leading-icon-opacity:0.38;--mdc-list-list-item-disabled-trailing-icon-opacity:0.38}.cdk-high-contrast-active a.mdc-list-item--activated::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active a.mdc-list-item--activated [dir=rtl]::after{right:auto;left:16px}.mat-mdc-list-base{display:block}.mat-mdc-list-base .mdc-list-item__start,.mat-mdc-list-base .mdc-list-item__end,.mat-mdc-list-base .mdc-list-item__content{pointer-events:auto}.mat-mdc-list-item,.mat-mdc-list-option{width:100%;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-list-item:not(.mat-mdc-list-item-interactive),.mat-mdc-list-option:not(.mat-mdc-list-item-interactive){cursor:default}.mat-mdc-list-item .mat-divider-inset,.mat-mdc-list-option .mat-divider-inset{position:absolute;left:0;right:0;bottom:0}.mat-mdc-list-item .mat-mdc-list-item-avatar~.mat-divider-inset,.mat-mdc-list-option .mat-mdc-list-item-avatar~.mat-divider-inset{margin-left:72px}[dir=rtl] .mat-mdc-list-item .mat-mdc-list-item-avatar~.mat-divider-inset,[dir=rtl] .mat-mdc-list-option .mat-mdc-list-item-avatar~.mat-divider-inset{margin-right:72px}.mat-mdc-list-item-interactive::before{top:0;left:0;right:0;bottom:0;position:absolute;content:"";opacity:0;pointer-events:none}.mat-mdc-list-item>.mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-list-item:focus>.mat-mdc-focus-indicator::before{content:""}.mat-mdc-list-item.mdc-list-item--with-three-lines .mat-mdc-list-item-line.mdc-list-item__secondary-text{white-space:nowrap;line-height:normal}.mat-mdc-list-item.mdc-list-item--with-three-lines .mat-mdc-list-item-unscoped-content.mdc-list-item__secondary-text{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}mat-action-list button{background:none;color:inherit;border:none;font:inherit;outline:inherit;-webkit-tap-highlight-color:rgba(0,0,0,0);text-align:left}[dir=rtl] mat-action-list button{text-align:right}mat-action-list button::-moz-focus-inner{border:0}'],encapsulation:2,changeDetection:0}),n})(),mW=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({imports:[P8,Ad,ko,WM,$6,N8]}),n})();const pW=["mat-button",""],gW=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],_W=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],yW=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],vW=O6(L6(P6(class{constructor(n){this._elementRef=n}})));let bW=(()=>{class n extends vW{constructor(t,i,r,s){super(t),this._platform=i,this._ngZone=r,this._animationMode=s,this._focusMonitor=(0,h.f3M)(wB),this._isFab=!1;const o=t.nativeElement.classList;for(const c of yW)this._hasHostAttributes(c.selector)&&c.mdcClasses.forEach(d=>{o.add(d)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t="program",i){t?this._focusMonitor.focusVia(this._elementRef.nativeElement,t,i):this._elementRef.nativeElement.focus(i)}_hasHostAttributes(...t){return t.some(i=>this._elementRef.nativeElement.hasAttribute(i))}_isRippleDisabled(){return this.disableRipple||this.disabled}}return n.\u0275fac=function(t){h.$Z()},n.\u0275dir=h.lG2({type:n,viewQuery:function(t,i){if(1&t&&h.Gf(iC,5),2&t){let r;h.iGM(r=h.CRH())&&(i.ripple=r.first)}},features:[h.qOj]}),n})(),EW=(()=>{class n extends bW{constructor(t,i,r,s){super(t,i,r,s)}}return n.\u0275fac=function(t){return new(t||n)(h.Y36(h.SBq),h.Y36(_l),h.Y36(h.R0b),h.Y36(h.QbO,8))},n.\u0275cmp=h.Xpm({type:n,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:7,hostBindings:function(t,i){2&t&&(h.uIk("disabled",i.disabled||null),h.ekj("_mat-animation-noopable","NoopAnimations"===i._animationMode)("mat-unthemed",!i.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[h.qOj],attrs:pW,ngContentSelectors:_W,decls:8,vars:6,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],["matRipple","",1,"mat-mdc-button-ripple",3,"matRippleDisabled","matRippleTrigger"],[1,"mat-mdc-button-touch-target"]],template:function(t,i){1&t&&(h.F$t(gW),h._UZ(0,"span",0),h.Hsn(1),h.TgZ(2,"span",1),h.Hsn(3,1),h.qZA(),h.Hsn(4,2),h._UZ(5,"span",2)(6,"span",3)(7,"span",4)),2&t&&(h.ekj("mdc-button__ripple",!i._isFab)("mdc-fab__ripple",i._isFab),h.xp6(6),h.Q6J("matRippleDisabled",i._isRippleDisabled())("matRippleTrigger",i._elementRef.nativeElement))},dependencies:[iC],styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(\n      100% + 4px\n    );width:calc(\n      100% + 4px\n    );display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{height:var(--mdc-text-button-container-height, 36px);border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, inherit)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button{height:var(--mdc-filled-button-container-height, 36px);border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color, transparent)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, inherit)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button{height:var(--mdc-protected-button-container-height, 36px);border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px));box-shadow:var(--mdc-protected-button-container-elevation, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color, transparent)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, inherit)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button.mdc-ripple-upgraded--background-focused,.mat-mdc-raised-button:not(.mdc-ripple-upgraded):focus{box-shadow:var(--mdc-protected-button-focus-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled):active{box-shadow:var(--mdc-protected-button-pressed-container-elevation, 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button{height:var(--mdc-outlined-button-container-height, 36px);border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px));padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, inherit)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width, 1px));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width, 1px))}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-button .mat-ripple-element,.mat-mdc-unelevated-button .mat-ripple-element,.mat-mdc-raised-button .mat-ripple-element,.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button[disabled],.mat-mdc-unelevated-button[disabled],.mat-mdc-raised-button[disabled],.mat-mdc-outlined-button[disabled]{cursor:default;pointer-events:none}.mat-mdc-button .mat-mdc-button-touch-target,.mat-mdc-unelevated-button .mat-mdc-button-touch-target,.mat-mdc-raised-button .mat-mdc-button-touch-target,.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}[dir=rtl] .mat-mdc-button>.mat-icon,.mat-mdc-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}.mat-mdc-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon,.mat-mdc-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem;margin-left:-4px;margin-right:8px}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:-4px}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon,.mat-mdc-raised-button .mdc-button__label+.mat-icon,.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:-4px}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon,.mat-mdc-unelevated-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-raised-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-outlined-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:-4px;margin-right:8px}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px) * -1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),n})(),TW=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({imports:[ko,WM,ko]}),n})();function IW(n,e){if(1&n){const t=h.EpF();h.TgZ(0,"button",10),h.NdJ("click",function(){h.CHM(t);const r=h.oxw();return h.KtG(r.auth.loginWithGoogle())}),h._uU(1," Sign In "),h.qZA()}}function SW(n,e){if(1&n){const t=h.EpF();h.TgZ(0,"button",11),h.NdJ("click",function(){h.CHM(t);const r=h.oxw();return h.KtG(r.auth.logout())}),h._uU(1," Sign Out "),h.qZA()}}let CW=(()=>{var n;class e{constructor(i,r){this.auth=i,this.afAuth=r}login(){this.auth.loginWithGoogle()}}return(n=e).\u0275fac=function(i){return new(i||n)(h.Y36(G2),h.Y36(Qw))},n.\u0275cmp=h.Xpm({type:n,selectors:[["app-navbar"]],decls:20,vars:6,consts:[[1,"navbar"],[1,"navbar-logo"],["href","/"],[1,"navbar-menu"],[1,"navbar-item"],["href","/about"],["href","/contact"],[1,"navbar-auth"],["mat-flat-button","","color","accent","color","accent",3,"click",4,"ngIf"],["mat-flat-button","","color","accent","color","primary",3,"click",4,"ngIf"],["mat-flat-button","","color","accent","color","accent",3,"click"],["mat-flat-button","","color","accent","color","primary",3,"click"]],template:function(i,r){1&i&&(h.TgZ(0,"nav",0)(1,"div",1)(2,"a",2),h._uU(3,"Hangmeas HDTV"),h.qZA()(),h.TgZ(4,"ul",3)(5,"li",4)(6,"a",2),h._uU(7,"Home"),h.qZA()(),h.TgZ(8,"li",4)(9,"a",5),h._uU(10,"About"),h.qZA()(),h.TgZ(11,"li",4)(12,"a",6),h._uU(13,"Contact"),h.qZA()()(),h.TgZ(14,"ul",7)(15,"li",4),h.YNc(16,IW,2,0,"button",8),h.ALo(17,"async"),h.YNc(18,SW,2,0,"button",9),h.ALo(19,"async"),h.qZA()()()),2&i&&(h.xp6(16),h.Q6J("ngIf",null===h.lcZ(17,2,r.afAuth.authState)),h.xp6(2),h.Q6J("ngIf",h.lcZ(19,4,r.afAuth.authState)))},dependencies:[Es,EW,Is],styles:['.navbar[_ngcontent-%COMP%]{position:fixed;top:0;right:0;background-color:#4e6b7b;color:#fff;display:flex;justify-content:space-between;align-items:center;height:50px;z-index:999;width:calc(100vw - 233px)}.navbar-logo[_ngcontent-%COMP%]{margin:auto 0;padding-left:10px}.navbar-logo[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-weight:500;color:#fff;font-size:16px;text-decoration:none}.navbar-menu[_ngcontent-%COMP%]{list-style:none;padding:0}.navbar-item[_ngcontent-%COMP%]{display:inline-block;margin-right:10px}.navbar-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:none;position:relative;transition:color .2s ease-in-out}.navbar-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before{content:"";position:absolute;bottom:-2px;left:0;width:100%;height:2px;background-color:#fff;transform:scaleX(0);transition:transform .2s ease-in-out}.navbar-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#bbb}.navbar-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:before{transform:scaleX(1)}@media screen and (max-width: 600px){*[_ngcontent-%COMP%]{display:none;background-color:transparent!important}}']}),e})();function DW(n,e){if(1&n&&(h.TgZ(0,"a",2),h._uU(1),h.qZA()),2&n){const t=e.$implicit;h.xp6(1),h.hij(" ",t," ")}}let AW=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275cmp=h.Xpm({type:n,selectors:[["app-btn-charthub"]],inputs:{items:"items",activeLocalChannel:"activeLocalChannel"},decls:2,vars:1,consts:[[1,"button"],["matRipple","",4,"ngFor","ngForOf"],["matRipple",""]],template:function(i,r){1&i&&(h.TgZ(0,"div",0),h.YNc(1,DW,2,1,"a",1),h.qZA()),2&i&&(h.xp6(1),h.Q6J("ngForOf",r.items))},dependencies:[aa,iC],styles:[".button[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:13px;scrollbar-width:none;border-radius:10px;width:100%;padding-left:3px}.button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:3px;align-items:start;flex-shrink:0;padding:11px 10px;background-color:#bbd9e9;opacity:.8;transition:opacity .3s;border-radius:10px;width:90%;cursor:pointer;font-weight:500}.button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:1}"]}),e})();const RW=["sidenav"],kW=[{path:"",component:Vg,children:[{path:"",redirectTo:"",pathMatch:"full"},{path:"",component:(()=>{var n;class e{constructor(i){this.breakpointObserver=i,this.items=["Button 1","Button 2","Button 3"],this.logoSrc="assets/logo-02.gif"}ngOnInit(){this.breakpointObserver.observe(["(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)"]).subscribe(i=>{})}toggleSidenav(){this.isMobileScreen&&this.sidenav.toggle()}disableContextMenu(i){i.preventDefault()}}return(n=e).\u0275fac=function(i){return new(i||n)(h.Y36(dB))},n.\u0275cmp=h.Xpm({type:n,selectors:[["app-sidenav"]],viewQuery:function(i,r){if(1&i&&h.Gf(RW,5),2&i){let s;h.iGM(s=h.CRH())&&(r.sidenav=s.first)}},decls:10,vars:3,consts:[[1,"sidenav-container"],["mode","side",3,"opened"],["sidenav",""],[1,"logo"],["id","logo-image",3,"src","contextmenu"],[3,"items"],[1,"sidenav-content"]],template:function(i,r){1&i&&(h.TgZ(0,"mat-sidenav-container",0)(1,"mat-sidenav",1,2)(3,"div",3)(4,"img",4),h.NdJ("contextmenu",function(o){return r.disableContextMenu(o)}),h.qZA()(),h.TgZ(5,"mat-nav-list"),h._UZ(6,"app-btn-charthub",5),h.qZA()(),h.TgZ(7,"mat-sidenav-content",6),h._UZ(8,"app-navbar")(9,"router-outlet"),h.qZA()()),2&i&&(h.xp6(1),h.Q6J("opened",!r.isMobileScreen),h.xp6(3),h.Q6J("src",r.logoSrc,h.LSH),h.xp6(2),h.Q6J("items",r.items))},dependencies:[Ag,YB,ZB,QM,uW,CW,AW],styles:[".sidebar{background-color:#bbd9e9;height:100vh}  .text-a{color:#fff!important}.sidenav-content[_ngcontent-%COMP%]{height:100vh;background-color:#71a4be}.logo[_ngcontent-%COMP%]{display:inline-block;position:relative;width:90px}.logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:200px;transition:transform .3s ease}.logo[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{transform:rotate(180deg)}.toggle-button[_ngcontent-%COMP%]{position:absolute;top:10px;left:10px;z-index:2}.sidenav-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh}.sidenav-content[_ngcontent-%COMP%]{overflow:hidden;flex-grow:1}@media screen and (max-width: 600px){.sidenav-container[_ngcontent-%COMP%]{justify-content:flex-start}.sidenav-container[_ngcontent-%COMP%] > mat-sidenav[_ngcontent-%COMP%]{display:none}.sidenav-content[_ngcontent-%COMP%] > .content[_ngcontent-%COMP%] > app-navbar[_ngcontent-%COMP%]{display:none}}"]}),e})(),children:[{path:"",redirectTo:"display/default-channel/draftChannel",pathMatch:"full"},{path:"display/:channelName/:index",component:W6}]}]},{path:"redirect",component:K6},{path:"**",redirectTo:"redirect"}];let MW=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({imports:[HD.forRoot(kW),HD]}),e})();function uV(n){return new h.vHH(3e3,!1)}function fK(){return typeof window<"u"&&typeof window.document<"u"}function b1(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function jf(n){switch(n.length){case 0:return new aE;case 1:return n[0];default:return new zB(n)}}function dV(n,e,t,i,r=new Map,s=new Map){const o=[],c=[];let d=-1,m=null;if(i.forEach(g=>{const v=g.get("offset"),E=v==d,T=E&&m||new Map;g.forEach((C,k)=>{let P=k,G=C;if("offset"!==k)switch(P=e.normalizePropertyName(P,o),G){case YM:G=r.get(k);break;case Ed:G=s.get(k);break;default:G=e.normalizeStyleValue(k,P,G,o)}T.set(P,G)}),E||c.push(T),m=T,d=v}),o.length)throw function tK(n){return new h.vHH(3502,!1)}();return c}function w1(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&E1(t,"start",n)));break;case"done":n.onDone(()=>i(t&&E1(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&E1(t,"destroy",n)))}}function E1(n,e,t){const s=x1(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),o=n._data;return null!=o&&(s._data=o),s}function x1(n,e,t,i,r="",s=0,o){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function Ua(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function hV(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}let T1=(n,e)=>!1,fV=(n,e,t)=>[],mV=null;function I1(n){const e=n.parentNode||n.host;return e===mV?null:e}(b1()||typeof Element<"u")&&(fK()?(mV=(()=>document.documentElement)(),T1=(n,e)=>{for(;e;){if(e===n)return!0;e=I1(e)}return!1}):T1=(n,e)=>n.contains(e),fV=(n,e,t)=>{if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]});let og=null,pV=!1;const gV=T1,_V=fV;let yV=(()=>{class n{validateStyleProperty(t){return function pK(n){og||(og=function gK(){return typeof document<"u"?document.body:null}()||{},pV=!!og.style&&"WebkitAppearance"in og.style);let e=!0;return og.style&&!function mK(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in og.style,!e&&pV&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in og.style)),e}(t)}matchesElement(t,i){return!1}containsElement(t,i){return gV(t,i)}getParentElement(t){return I1(t)}query(t,i,r){return _V(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,c=[],d){return new aE(r,s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac}),n})(),S1=(()=>{class n{}return n.NOOP=new yV,n})();const _K=1e3,C1="ng-enter",vC="ng-leave",bC="ng-trigger",wC=".ng-trigger",bV="ng-animating",D1=".ng-animating";function xd(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:A1(parseFloat(e[1]),e[2])}function A1(n,e){return"s"===e?n*_K:n}function EC(n,e,t){return n.hasOwnProperty("duration")?n:function vK(n,e,t){let r,s=0,o="";if("string"==typeof n){const c=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===c)return e.push(uV()),{duration:0,delay:0,easing:""};r=A1(parseFloat(c[1]),c[2]);const d=c[3];null!=d&&(s=A1(parseFloat(d),c[4]));const m=c[5];m&&(o=m)}else r=n;if(!t){let c=!1,d=e.length;r<0&&(e.push(function LW(){return new h.vHH(3100,!1)}()),c=!0),s<0&&(e.push(function OW(){return new h.vHH(3101,!1)}()),c=!0),c&&e.splice(d,0,uV())}return{duration:r,delay:s,easing:o}}(n,e,t)}function fE(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function wV(n){const e=new Map;return Object.keys(n).forEach(t=>{e.set(t,n[t])}),e}function Gf(n,e=new Map,t){if(t)for(let[i,r]of t)e.set(i,r);for(let[i,r]of n)e.set(i,r);return e}function xV(n,e,t){return t?e+":"+t+";":""}function TV(n){let e="";for(let t=0;t<n.style.length;t++){const i=n.style.item(t);e+=xV(0,i,n.style.getPropertyValue(i))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=xV(0,xK(t),n.style[t]));n.setAttribute("style",e)}function _u(n,e,t){n.style&&(e.forEach((i,r)=>{const s=k1(r);t&&!t.has(r)&&t.set(r,n.style[s]),n.style[s]=i}),b1()&&TV(n))}function ag(n,e){n.style&&(e.forEach((t,i)=>{const r=k1(i);n.style[r]=""}),b1()&&TV(n))}function mE(n){return Array.isArray(n)?1==n.length?n[0]:$B(n):n}const R1=new RegExp("{{\\s*(.+?)\\s*}}","g");function IV(n){let e=[];if("string"==typeof n){let t;for(;t=R1.exec(n);)e.push(t[1]);R1.lastIndex=0}return e}function pE(n,e,t){const i=n.toString(),r=i.replace(R1,(s,o)=>{let c=e[o];return null==c&&(t.push(function NW(n){return new h.vHH(3003,!1)}()),c=""),c.toString()});return r==i?n:r}function xC(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const EK=/-+([a-z0-9])/g;function k1(n){return n.replace(EK,(...e)=>e[1].toUpperCase())}function xK(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Va(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw function FW(n){return new h.vHH(3004,!1)}()}}function SV(n,e){return window.getComputedStyle(n)[e]}const SC="*";function AK(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function RK(n,e,t){if(":"==n[0]){const d=function kK(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function QW(n){return new h.vHH(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof d)return void e.push(d);n=d}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function ZW(n){return new h.vHH(3015,!1)}()),e;const r=i[1],s=i[2],o=i[3];e.push(CV(r,o));"<"==s[0]&&!(r==SC&&o==SC)&&e.push(CV(o,r))}(i,t,e)):t.push(n),t}const CC=new Set(["true","1"]),DC=new Set(["false","0"]);function CV(n,e){const t=CC.has(n)||DC.has(n),i=CC.has(e)||DC.has(e);return(r,s)=>{let o=n==SC||n==r,c=e==SC||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?CC.has(n):DC.has(n)),!c&&i&&"boolean"==typeof s&&(c=s?CC.has(e):DC.has(e)),o&&c}}const MK=new RegExp("s*:selfs*,?","g");function M1(n,e,t,i){return new LK(n).build(e,t,i)}class LK{constructor(e){this._driver=e}build(e,t,i){const r=new NK(t);return this._resetContextStyleTimingState(r),Va(this,mE(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function UW(){return new h.vHH(3006,!1)}()),e.definitions.forEach(c=>{if(this._resetContextStyleTimingState(t),0==c.type){const d=c,m=d.name;m.toString().split(/\s*,\s*/).forEach(g=>{d.name=g,s.push(this.visitState(d,t))}),d.name=m}else if(1==c.type){const d=this.visitTransition(c,t);i+=d.queryCount,r+=d.depCount,o.push(d)}else t.errors.push(function VW(){return new h.vHH(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};i.styles.forEach(c=>{c instanceof Map&&c.forEach(d=>{IV(d).forEach(m=>{o.hasOwnProperty(m)||s.add(m)})})}),s.size&&(xC(s.values()),t.errors.push(function $W(n,e){return new h.vHH(3008,!1)}()))}return{type:0,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=Va(this,mE(e.animation),t);return{type:1,matchers:AK(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:lg(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(i=>Va(this,i,t)),options:lg(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=i;const c=Va(this,o,t);return r=Math.max(r,t.currentTime),c});return t.currentTime=r,{type:3,steps:s,options:lg(e.options)}}visitAnimate(e,t){const i=function BK(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return L1(EC(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=L1(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=EC(t,e);return L1(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,s=e.styles?e.styles:oC({});if(5==s.type)r=this.visitKeyframes(s,t);else{let o=e.styles,c=!1;if(!o){c=!0;const m={};i.easing&&(m.easing=i.easing),o=oC(m)}t.currentTime+=i.duration+i.delay;const d=this.visitStyle(o,t);d.isEmptyStep=c,r=d}return t.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let c of r)"string"==typeof c?c===Ed?i.push(c):t.errors.push(new h.vHH(3002,!1)):i.push(wV(c));let s=!1,o=null;return i.forEach(c=>{if(c instanceof Map&&(c.has("easing")&&(o=c.get("easing"),c.delete("easing")),!s))for(let d of c.values())if(d.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:i,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((c,d)=>{const m=t.collectedStyles.get(t.currentQuerySelector),g=m.get(d);let v=!0;g&&(s!=r&&s>=g.startTime&&r<=g.endTime&&(t.errors.push(function jW(n,e,t,i,r){return new h.vHH(3010,!1)}()),v=!1),s=g.startTime),v&&m.set(d,{startTime:s,endTime:r}),t.options&&function wK(n,e,t){const i=e.params||{},r=IV(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||t.push(function PW(n){return new h.vHH(3001,!1)}())})}(c,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function GW(){return new h.vHH(3011,!1)}()),i;let s=0;const o=[];let c=!1,d=!1,m=0;const g=e.steps.map(G=>{const Y=this._makeStyleAst(G,t);let W=null!=Y.offset?Y.offset:function FK(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(Y.styles),te=0;return null!=W&&(s++,te=Y.offset=W),d=d||te<0||te>1,c=c||te<m,m=te,o.push(te),Y});d&&t.errors.push(function zW(){return new h.vHH(3012,!1)}()),c&&t.errors.push(function WW(){return new h.vHH(3200,!1)}());const v=e.steps.length;let E=0;s>0&&s<v?t.errors.push(function KW(){return new h.vHH(3202,!1)}()):0==s&&(E=1/(v-1));const T=v-1,C=t.currentTime,k=t.currentAnimateTimings,P=k.duration;return g.forEach((G,Y)=>{const W=E>0?Y==T?1:E*Y:o[Y],te=W*P;t.currentTime=C+k.delay+te,k.duration=te,this._validateStyleAst(G,t),G.offset=W,i.styles.push(G)}),i}visitReference(e,t){return{type:8,animation:Va(this,mE(e.animation),t),options:lg(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:lg(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:lg(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function OK(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(MK,"")),n=n.replace(/@\*/g,wC).replace(/@\w+/g,t=>wC+"-"+t.slice(1)).replace(/:animating/g,D1),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+s:s,Ua(t.collectedStyles,t.currentQuerySelector,new Map);const c=Va(this,mE(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:c,originalSelector:e.selector,options:lg(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function qW(){return new h.vHH(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:EC(e.timings,t.errors,!0);return{type:12,animation:Va(this,mE(e.animation),t),timings:i,options:null}}}class NK{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function lg(n){return n?(n=fE(n)).params&&(n.params=function PK(n){return n?fE(n):null}(n.params)):n={},n}function L1(n,e,t){return{duration:n,delay:e,easing:t}}function O1(n,e,t,i,r,s,o=null,c=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:c}}class AC{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const $K=new RegExp(":enter","g"),jK=new RegExp(":leave","g");function P1(n,e,t,i,r,s=new Map,o=new Map,c,d,m=[]){return(new GK).buildKeyframes(n,e,t,i,r,s,o,c,d,m)}class GK{buildKeyframes(e,t,i,r,s,o,c,d,m,g=[]){m=m||new AC;const v=new N1(e,t,m,r,s,g,[]);v.options=d;const E=d.delay?xd(d.delay):0;v.currentTimeline.delayNextStep(E),v.currentTimeline.setStyles([o],null,v.errors,d),Va(this,i,v);const T=v.timelines.filter(C=>C.containsAnimation());if(T.length&&c.size){let C;for(let k=T.length-1;k>=0;k--){const P=T[k];if(P.element===t){C=P;break}}C&&!C.allowOnlyTimelineStyles()&&C.setStyles([c],null,v.errors,d)}return T.length?T.map(C=>C.buildKeyframes()):[O1(t,[],[],[],0,E,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(const r of e){const s=r?.delay;if(s){const o="number"==typeof s?s:xd(pE(s,r?.params??{},t.errors));i.delayNextStep(o)}}}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime;const o=null!=i.duration?xd(i.duration):null,c=null!=i.delay?xd(i.delay):null;return 0!==o&&e.forEach(d=>{const m=t.appendInstructionToTimeline(d,o,c);s=Math.max(s,m.duration+m.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),Va(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=RC);const o=xd(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>Va(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?xd(e.options.delay):0;e.steps.forEach(o=>{const c=t.createSubContext(e.options);s&&c.delayNextStep(s),Va(this,o,c),r=Math.max(r,c.currentTimeline.currentTime),i.push(c.currentTimeline)}),i.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return EC(t.params?pE(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,s=i.duration,c=t.createSubContext().currentTimeline;c.easing=i.easing,e.styles.forEach(d=>{c.forwardTime((d.offset||0)*s),c.setStyles(d.styles,d.easing,t.errors,t.options),c.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(c),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?xd(r.delay):0;s&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=RC);let o=i;const c=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=c.length;let d=null;c.forEach((m,g)=>{t.currentQueryIndex=g;const v=t.createSubContext(e.options,m);s&&v.delayNextStep(s),m===t.element&&(d=v.currentTimeline),Va(this,e.animation,v),v.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,v.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),d&&(t.currentTimeline.mergeTimelineCollectedStyles(d),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),c=o*(t.currentQueryTotal-1);let d=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":d=c-d;break;case"full":d=i.currentStaggerTime}const g=t.currentTimeline;d&&g.delayNextStep(d);const v=g.currentTime;Va(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-v+(r.startTime-i.currentTimeline.startTime)}}const RC={};class N1{constructor(e,t,i,r,s,o,c,d){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=c,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=RC,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=d||new kC(this._driver,t,0),c.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=xd(i.duration)),null!=i.delay&&(r.delay=xd(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(c=>{(!t||!o.hasOwnProperty(c))&&(o[c]=pE(s[c],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,s=new N1(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=RC,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},s=new zK(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,s,o){let c=[];if(r&&c.push(this.element),e.length>0){e=(e=e.replace($K,"."+this._enterClassName)).replace(jK,"."+this._leaveClassName);let m=this._driver.query(this.element,e,1!=i);0!==i&&(m=i<0?m.slice(m.length+i,m.length):m.slice(0,i)),c.push(...m)}return!s&&0==c.length&&o.push(function YW(n){return new h.vHH(3014,!1)}()),c}}class kC{constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new kC(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||Ed),this._currentKeyframe.set(t,Ed);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},o=function WK(n,e){const t=new Map;let i;return n.forEach(r=>{if("*"===r){i=i||e.keys();for(let s of i)t.set(s,Ed)}else Gf(r,t)}),t}(e,this._globalTimelineStyles);for(let[c,d]of o){const m=pE(d,s,i);this._pendingStyles.set(c,m),this._localTimelineStyles.has(c)||this._backFill.set(c,this._globalTimelineStyles.get(c)??Ed),this._updateStyle(c,m)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((c,d)=>{const m=Gf(c,new Map,this._backFill);m.forEach((g,v)=>{g===YM?e.add(v):g===Ed&&t.add(v)}),i||m.set("offset",d/this.duration),r.push(m)});const s=e.size?xC(e.values()):[],o=t.size?xC(t.values()):[];if(i){const c=r[0],d=new Map(c);c.set("offset",0),d.set("offset",1),r=[c,d]}return O1(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class zK extends kC{constructor(e,t,i,r,s,o,c=!1){super(e,t,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=c,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=i+t,c=t/o,d=Gf(e[0]);d.set("offset",0),s.push(d);const m=Gf(e[0]);m.set("offset",RV(c)),s.push(m);const g=e.length-1;for(let v=1;v<=g;v++){let E=Gf(e[v]);const T=E.get("offset");E.set("offset",RV((t+T*i)/o)),s.push(E)}i=o,t=0,r="",e=s}return O1(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function RV(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class F1{}const KK=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class qK extends F1{normalizePropertyName(e,t){return k1(e)}normalizeStyleValue(e,t,i,r){let s="";const o=i.toString().trim();if(KK.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const c=i.match(/^[+-]?[\d\.]+([a-z]*)$/);c&&0==c[1].length&&r.push(function BW(n,e){return new h.vHH(3005,!1)}())}return o+s}}function kV(n,e,t,i,r,s,o,c,d,m,g,v,E){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:i,toStyles:o,timelines:c,queriedElements:d,preStyleProps:m,postStyleProps:g,totalTime:v,errors:E}}const B1={};class MV{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function YK(n,e,t,i,r){return n.some(s=>s(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,i):new Map}build(e,t,i,r,s,o,c,d,m,g){const v=[],E=this.ast.options&&this.ast.options.params||B1,C=this.buildStyles(i,c&&c.params||B1,v),k=d&&d.params||B1,P=this.buildStyles(r,k,v),G=new Set,Y=new Map,W=new Map,te="void"===r,oe={params:ZK(k,E),delay:this.ast.options?.delay},Ae=g?[]:P1(e,t,this.ast.animation,s,o,C,P,oe,m,v);let we=0;if(Ae.forEach(rt=>{we=Math.max(rt.duration+rt.delay,we)}),v.length)return kV(t,this._triggerName,i,r,te,C,P,[],[],Y,W,we,v);Ae.forEach(rt=>{const Pe=rt.element,Xt=Ua(Y,Pe,new Set);rt.preStyleProps.forEach(Fn=>Xt.add(Fn));const yt=Ua(W,Pe,new Set);rt.postStyleProps.forEach(Fn=>yt.add(Fn)),Pe!==t&&G.add(Pe)});const Ge=xC(G.values());return kV(t,this._triggerName,i,r,te,C,P,Ae,Ge,Y,W,we)}}function ZK(n,e){const t=fE(e);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(t[i]=n[i]);return t}class QK{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,r=fE(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(r[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,c)=>{o&&(o=pE(o,r,t));const d=this.normalizer.normalizePropertyName(c,t);o=this.normalizer.normalizeStyleValue(c,d,o,t),i.set(c,o)})}),i}}class JK{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new QK(r.style,r.options&&r.options.params||{},i))}),LV(this.states,"true","1"),LV(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new MV(e,r,this.states))}),this.fallbackTransition=function eq(n,e,t){return new MV(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,c)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(o=>o.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function LV(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const tq=new AC;class nq{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],r=[],s=M1(this._driver,t,i,r);if(i.length)throw function nK(n){return new h.vHH(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,i){const r=e.element,s=dV(0,this._normalizer,0,e.keyframes,t,i);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],s=this._animations.get(e);let o;const c=new Map;if(s?(o=P1(this._driver,t,s,C1,vC,new Map,new Map,i,tq,r),o.forEach(g=>{const v=Ua(c,g.element,new Map);g.postStyleProps.forEach(E=>v.set(E,null))})):(r.push(function iK(){return new h.vHH(3300,!1)}()),o=[]),r.length)throw function rK(n){return new h.vHH(3504,!1)}();c.forEach((g,v)=>{g.forEach((E,T)=>{g.set(T,this._driver.computeStyle(v,T,Ed))})});const m=jf(o.map(g=>{const v=c.get(g.element);return this._buildPlayer(g,new Map,v)}));return this._playersById.set(e,m),m.onDestroy(()=>this.destroy(e)),this.players.push(m),m}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function sK(n){return new h.vHH(3301,!1)}();return t}listen(e,t,i,r){const s=x1(t,"","","");return w1(this._getPlayer(e),i,s,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const OV="ng-animate-queued",U1="ng-animate-disabled",aq=[],PV={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},lq={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},yl="__ng_removed";class V1{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function hq(n){return n??null}(i?e.value:e),i){const s=fE(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const gE="void",$1=new V1(gE);class cq{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,vl(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.has(t))throw function oK(n,e){return new h.vHH(3302,!1)}();if(null==i||0==i.length)throw function aK(n){return new h.vHH(3303,!1)}();if(!function fq(n){return"start"==n||"done"==n}(i))throw function lK(n,e){return new h.vHH(3400,!1)}();const s=Ua(this._elementListeners,e,[]),o={name:t,phase:i,callback:r};s.push(o);const c=Ua(this._engine.statesByElement,e,new Map);return c.has(t)||(vl(e,bC),vl(e,bC+"-"+t),c.set(t,$1)),()=>{this._engine.afterFlush(()=>{const d=s.indexOf(o);d>=0&&s.splice(d,1),this._triggers.has(t)||c.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function cK(n){return new h.vHH(3401,!1)}();return t}trigger(e,t,i,r=!0){const s=this._getTrigger(t),o=new H1(this.id,t,e);let c=this._engine.statesByElement.get(e);c||(vl(e,bC),vl(e,bC+"-"+t),this._engine.statesByElement.set(e,c=new Map));let d=c.get(t);const m=new V1(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&d&&m.absorbOptions(d.options),c.set(t,m),d||(d=$1),m.value!==gE&&d.value===m.value){if(!function gq(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(d.params,m.params)){const k=[],P=s.matchStyles(d.value,d.params,k),G=s.matchStyles(m.value,m.params,k);k.length?this._engine.reportError(k):this._engine.afterFlush(()=>{ag(e,P),_u(e,G)})}return}const E=Ua(this._engine.playersByElement,e,[]);E.forEach(k=>{k.namespaceId==this.id&&k.triggerName==t&&k.queued&&k.destroy()});let T=s.matchTransition(d.value,m.value,e,m.params),C=!1;if(!T){if(!r)return;T=s.fallbackTransition,C=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:T,fromState:d,toState:m,player:o,isFallbackTransition:C}),C||(vl(e,OV),o.onStart(()=>{Ky(e,OV)})),o.onDone(()=>{let k=this.players.indexOf(o);k>=0&&this.players.splice(k,1);const P=this._engine.playersByElement.get(e);if(P){let G=P.indexOf(o);G>=0&&P.splice(G,1)}}),this.players.push(o),E.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,wC,!0);i.forEach(r=>{if(r[yl])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const c=[];if(s.forEach((d,m)=>{if(o.set(m,d.value),this._triggers.has(m)){const g=this.trigger(e,m,gE,r);g&&c.push(g)}}),c.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),i&&jf(c).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const d=this._triggers.get(o).fallbackTransition,m=i.get(o)||$1,g=new V1(gE),v=new H1(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:d,fromState:m,toState:g,player:v,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const s=e[yl];(!s||s===PV)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){vl(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(c=>{if(c.name==i.triggerName){const d=x1(s,i.triggerName,i.fromState.value,i.toState.value);d._data=e,w1(i.player,c.phase,d,c.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(i=>i.element===e)||t,t}}class uq{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new cq(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let o=!1,c=this.driver.getParentElement(t);for(;c;){const d=r.get(c);if(d){const m=i.indexOf(d);i.splice(m+1,0,e),o=!0;break}c=this.driver.getParentElement(c)}o||i.unshift(e)}else i.push(e);return r.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){if(!e)return;const i=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[e];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let r of i.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,i,r){if(MC(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!MC(t))return;const s=t[yl];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),vl(e,U1)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Ky(e,U1))}removeNode(e,t,i,r){if(MC(t)){const s=e?this._fetchNamespace(e):null;if(s?s.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),i){const o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,i,r,s){this.collectedLeaveElements.push(t),t[yl]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,i,r,s){return MC(t)?this._fetchNamespace(e).listen(t,i,r,s):()=>{}}_buildInstruction(e,t,i,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,wC,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,D1,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return jf(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[yl];if(t&&t.setForRemoval){if(e[yl]=PV,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(U1)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)vl(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?jf(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw function uK(n){return new h.vHH(3402,!1)}()}_flushAnimations(e,t){const i=new AC,r=[],s=new Map,o=[],c=new Map,d=new Map,m=new Map,g=new Set;this.disabledNodes.forEach(ct=>{g.add(ct);const pt=this.driver.query(ct,".ng-animate-queued",!0);for(let $e=0;$e<pt.length;$e++)g.add(pt[$e])});const v=this.bodyNode,E=Array.from(this.statesByElement.keys()),T=BV(E,this.collectedEnterElements),C=new Map;let k=0;T.forEach((ct,pt)=>{const $e=C1+k++;C.set(pt,$e),ct.forEach(dt=>vl(dt,$e))});const P=[],G=new Set,Y=new Set;for(let ct=0;ct<this.collectedLeaveElements.length;ct++){const pt=this.collectedLeaveElements[ct],$e=pt[yl];$e&&$e.setForRemoval&&(P.push(pt),G.add(pt),$e.hasAnimation?this.driver.query(pt,".ng-star-inserted",!0).forEach(dt=>G.add(dt)):Y.add(pt))}const W=new Map,te=BV(E,Array.from(G));te.forEach((ct,pt)=>{const $e=vC+k++;W.set(pt,$e),ct.forEach(dt=>vl(dt,$e))}),e.push(()=>{T.forEach((ct,pt)=>{const $e=C.get(pt);ct.forEach(dt=>Ky(dt,$e))}),te.forEach((ct,pt)=>{const $e=W.get(pt);ct.forEach(dt=>Ky(dt,$e))}),P.forEach(ct=>{this.processLeaveNode(ct)})});const oe=[],Ae=[];for(let ct=this._namespaceList.length-1;ct>=0;ct--)this._namespaceList[ct].drainQueuedTransitions(t).forEach($e=>{const dt=$e.player,wn=$e.element;if(oe.push(dt),this.collectedEnterElements.length){const er=wn[yl];if(er&&er.setForMove){if(er.previousTriggersValues&&er.previousTriggersValues.has($e.triggerName)){const mc=er.previousTriggersValues.get($e.triggerName),bl=this.statesByElement.get($e.element);if(bl&&bl.has($e.triggerName)){const WC=bl.get($e.triggerName);WC.value=mc,bl.set($e.triggerName,WC)}}return void dt.destroy()}}const Hn=!v||!this.driver.containsElement(v,wn),xn=W.get(wn),vi=C.get(wn),jn=this._buildInstruction($e,i,vi,xn,Hn);if(jn.errors&&jn.errors.length)return void Ae.push(jn);if(Hn)return dt.onStart(()=>ag(wn,jn.fromStyles)),dt.onDestroy(()=>_u(wn,jn.toStyles)),void r.push(dt);if($e.isFallbackTransition)return dt.onStart(()=>ag(wn,jn.fromStyles)),dt.onDestroy(()=>_u(wn,jn.toStyles)),void r.push(dt);const ia=[];jn.timelines.forEach(er=>{er.stretchStartingKeyframe=!0,this.disabledNodes.has(er.element)||ia.push(er)}),jn.timelines=ia,i.append(wn,jn.timelines),o.push({instruction:jn,player:dt,element:wn}),jn.queriedElements.forEach(er=>Ua(c,er,[]).push(dt)),jn.preStyleProps.forEach((er,mc)=>{if(er.size){let bl=d.get(mc);bl||d.set(mc,bl=new Set),er.forEach((WC,vL)=>bl.add(vL))}}),jn.postStyleProps.forEach((er,mc)=>{let bl=m.get(mc);bl||m.set(mc,bl=new Set),er.forEach((WC,vL)=>bl.add(vL))})});if(Ae.length){const ct=[];Ae.forEach(pt=>{ct.push(function dK(n,e){return new h.vHH(3505,!1)}())}),oe.forEach(pt=>pt.destroy()),this.reportError(ct)}const we=new Map,Ge=new Map;o.forEach(ct=>{const pt=ct.element;i.has(pt)&&(Ge.set(pt,pt),this._beforeAnimationBuild(ct.player.namespaceId,ct.instruction,we))}),r.forEach(ct=>{const pt=ct.element;this._getPreviousPlayers(pt,!1,ct.namespaceId,ct.triggerName,null).forEach(dt=>{Ua(we,pt,[]).push(dt),dt.destroy()})});const rt=P.filter(ct=>VV(ct,d,m)),Pe=new Map;FV(Pe,this.driver,Y,m,Ed).forEach(ct=>{VV(ct,d,m)&&rt.push(ct)});const yt=new Map;T.forEach((ct,pt)=>{FV(yt,this.driver,new Set(ct),d,YM)}),rt.forEach(ct=>{const pt=Pe.get(ct),$e=yt.get(ct);Pe.set(ct,new Map([...Array.from(pt?.entries()??[]),...Array.from($e?.entries()??[])]))});const Fn=[],Lr=[],pi={};o.forEach(ct=>{const{element:pt,player:$e,instruction:dt}=ct;if(i.has(pt)){if(g.has(pt))return $e.onDestroy(()=>_u(pt,dt.toStyles)),$e.disabled=!0,$e.overrideTotalTime(dt.totalTime),void r.push($e);let wn=pi;if(Ge.size>1){let xn=pt;const vi=[];for(;xn=xn.parentNode;){const jn=Ge.get(xn);if(jn){wn=jn;break}vi.push(xn)}vi.forEach(jn=>Ge.set(jn,wn))}const Hn=this._buildAnimation($e.namespaceId,dt,we,s,yt,Pe);if($e.setRealPlayer(Hn),wn===pi)Fn.push($e);else{const xn=this.playersByElement.get(wn);xn&&xn.length&&($e.parentPlayer=jf(xn)),r.push($e)}}else ag(pt,dt.fromStyles),$e.onDestroy(()=>_u(pt,dt.toStyles)),Lr.push($e),g.has(pt)&&r.push($e)}),Lr.forEach(ct=>{const pt=s.get(ct.element);if(pt&&pt.length){const $e=jf(pt);ct.setRealPlayer($e)}}),r.forEach(ct=>{ct.parentPlayer?ct.syncPlayerEvents(ct.parentPlayer):ct.destroy()});for(let ct=0;ct<P.length;ct++){const pt=P[ct],$e=pt[yl];if(Ky(pt,vC),$e&&$e.hasAnimation)continue;let dt=[];if(c.size){let Hn=c.get(pt);Hn&&Hn.length&&dt.push(...Hn);let xn=this.driver.query(pt,D1,!0);for(let vi=0;vi<xn.length;vi++){let jn=c.get(xn[vi]);jn&&jn.length&&dt.push(...jn)}}const wn=dt.filter(Hn=>!Hn.destroyed);wn.length?mq(this,pt,wn):this.processLeaveNode(pt)}return P.length=0,Fn.forEach(ct=>{this.players.push(ct),ct.onDone(()=>{ct.destroy();const pt=this.players.indexOf(ct);this.players.splice(pt,1)}),ct.play()}),Fn}elementContainsData(e,t){let i=!1;const r=t[yl];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(t)&&(i=!0),this.playersByQueriedElement.has(t)&&(i=!0),this.statesByElement.has(t)&&(i=!0),this._fetchNamespace(e).elementContainsData(t)||i}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,s){let o=[];if(t){const c=this.playersByQueriedElement.get(e);c&&(o=c)}else{const c=this.playersByElement.get(e);if(c){const d=!s||s==gE;c.forEach(m=>{m.queued||!d&&m.triggerName!=r||o.push(m)})}}return(i||r)&&(o=o.filter(c=>!(i&&i!=c.namespaceId||r&&r!=c.triggerName))),o}_beforeAnimationBuild(e,t,i){const s=t.element,o=t.isRemovalTransition?void 0:e,c=t.isRemovalTransition?void 0:t.triggerName;for(const d of t.timelines){const m=d.element,g=m!==s,v=Ua(i,m,[]);this._getPreviousPlayers(m,g,o,c,t.toState).forEach(T=>{const C=T.getRealPlayer();C.beforeDestroy&&C.beforeDestroy(),T.destroy(),v.push(T)})}ag(s,t.fromStyles)}_buildAnimation(e,t,i,r,s,o){const c=t.triggerName,d=t.element,m=[],g=new Set,v=new Set,E=t.timelines.map(C=>{const k=C.element;g.add(k);const P=k[yl];if(P&&P.removedBeforeQueried)return new aE(C.duration,C.delay);const G=k!==d,Y=function pq(n){const e=[];return UV(n,e),e}((i.get(k)||aq).map(we=>we.getRealPlayer())).filter(we=>!!we.element&&we.element===k),W=s.get(k),te=o.get(k),oe=dV(0,this._normalizer,0,C.keyframes,W,te),Ae=this._buildPlayer(C,oe,Y);if(C.subTimeline&&r&&v.add(k),G){const we=new H1(e,c,k);we.setRealPlayer(Ae),m.push(we)}return Ae});m.forEach(C=>{Ua(this.playersByQueriedElement,C.element,[]).push(C),C.onDone(()=>function dq(n,e,t){let i=n.get(e);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,C.element,C))}),g.forEach(C=>vl(C,bV));const T=jf(E);return T.onDestroy(()=>{g.forEach(C=>Ky(C,bV)),_u(d,t.toStyles)}),v.forEach(C=>{Ua(r,C,[]).push(T)}),T}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new aE(e.duration,e.delay)}}class H1{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new aE,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>w1(e,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Ua(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function MC(n){return n&&1===n.nodeType}function NV(n,e){const t=n.style.display;return n.style.display=e??"none",t}function FV(n,e,t,i,r){const s=[];t.forEach(d=>s.push(NV(d)));const o=[];i.forEach((d,m)=>{const g=new Map;d.forEach(v=>{const E=e.computeStyle(m,v,r);g.set(v,E),(!E||0==E.length)&&(m[yl]=lq,o.push(m))}),n.set(m,g)});let c=0;return t.forEach(d=>NV(d,s[c++])),o}function BV(n,e){const t=new Map;if(n.forEach(c=>t.set(c,[])),0==e.length)return t;const i=1,r=new Set(e),s=new Map;function o(c){if(!c)return i;let d=s.get(c);if(d)return d;const m=c.parentNode;return d=t.has(m)?m:r.has(m)?i:o(m),s.set(c,d),d}return e.forEach(c=>{const d=o(c);d!==i&&t.get(d).push(c)}),t}function vl(n,e){n.classList?.add(e)}function Ky(n,e){n.classList?.remove(e)}function mq(n,e,t){jf(t).onDone(()=>n.processLeaveNode(e))}function UV(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof zB?UV(i.players,e):e.push(i)}}function VV(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(s=>r.add(s)):e.set(n,i),t.delete(n),!0}class LC{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new uq(e,t,i),this._timelineEngine=new nq(e,t,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,i,r,s){const o=e+"-"+r;let c=this._triggerCache[o];if(!c){const d=[],m=[],g=M1(this._driver,s,d,m);if(d.length)throw function eK(n,e){return new h.vHH(3404,!1)}();c=function XK(n,e,t){return new JK(n,e,t)}(r,g,this._normalizer),this._triggerCache[o]=c}this._transitionEngine.registerTrigger(t,r,c)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i,r){this._transitionEngine.removeNode(e,t,r||!1,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[s,o]=hV(i);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,s){if("@"==i.charAt(0)){const[o,c]=hV(i);return this._timelineEngine.listen(o,t,c,s)}return this._transitionEngine.listen(e,t,i,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let yq=(()=>{class n{constructor(t,i,r){this._element=t,this._startStyles=i,this._endStyles=r,this._state=0;let s=n.initialStylesByElement.get(t);s||n.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&_u(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(_u(this._element,this._initialStyles),this._endStyles&&(_u(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(ag(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(ag(this._element,this._endStyles),this._endStyles=null),_u(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function j1(n){let e=null;return n.forEach((t,i)=>{(function vq(n){return"display"===n||"position"===n})(i)&&(e=e||new Map,e.set(i,t))}),e}class $V{constructor(e,t,i,r){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&e.set(r,this._finished?i:SV(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class bq{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return gV(e,t)}getParentElement(e){return I1(e)}query(e,t,i){return _V(e,t,i)}computeStyle(e,t,i){return window.getComputedStyle(e)[t]}animate(e,t,i,r,s,o=[]){const d={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(d.easing=s);const m=new Map,g=o.filter(T=>T instanceof $V);(function TK(n,e){return 0===n||0===e})(i,r)&&g.forEach(T=>{T.currentSnapshot.forEach((C,k)=>m.set(k,C))});let v=function bK(n){return n.length?n[0]instanceof Map?n:n.map(e=>wV(e)):[]}(t).map(T=>Gf(T));v=function IK(n,e,t){if(t.size&&e.length){let i=e[0],r=[];if(t.forEach((s,o)=>{i.has(o)||r.push(o),i.set(o,s)}),r.length)for(let s=1;s<e.length;s++){let o=e[s];r.forEach(c=>o.set(c,SV(n,c)))}}return e}(e,v,m);const E=function _q(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=j1(e[0]),e.length>1&&(i=j1(e[e.length-1]))):e instanceof Map&&(t=j1(e)),t||i?new yq(n,t,i):null}(e,v);return new $V(e,v,d,E)}}let wq=(()=>{class n extends UB{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:h.ifc.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?$B(t):t;return HV(this._renderer,null,i,"register",[r]),new Eq(i,this._renderer)}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(h.FYo),h.LFG(ue))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac}),n})();class Eq extends y8{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new xq(this._id,e,t||{},this._renderer)}}class xq{constructor(e,t,i,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return HV(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function HV(n,e,t,i,r){return n.setProperty(e,`@@${t}:${i}`,r)}const jV="@.disabled";let Tq=(()=>{class n{constructor(t,i,r){this.delegate=t,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(s,o)=>{const c=o?.parentNode(s);c&&o.removeChild(c,s)}}createRenderer(t,i){const s=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let g=this._rendererCache.get(s);return g||(g=new GV("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,g)),g}const o=i.id,c=i.id+"-"+this._currentId;this._currentId++,this.engine.register(c,t);const d=g=>{Array.isArray(g)?g.forEach(d):this.engine.registerTrigger(o,c,t,g.name,g)};return i.data.animation.forEach(d),new Iq(this,c,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,r){t>=0&&t<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,c]=s;o(c)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(h.FYo),h.LFG(LC),h.LFG(h.R0b))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac}),n})();class GV{constructor(e,t,i,r){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=r,this.destroyNode=this.delegate.destroyNode?s=>t.destroyNode(s):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate,i)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==jV?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Iq extends GV{constructor(e,t,i,r,s){super(t,i,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==jV?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const r=function Sq(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function Cq(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,c=>{this.factory.scheduleListenerCallback(c._data||-1,i,c)})}return this.delegate.listen(e,t,i)}}let Dq=(()=>{class n extends LC{constructor(t,i,r,s){super(t.body,i,r)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(t){return new(t||n)(h.LFG(ue),h.LFG(S1),h.LFG(F1),h.LFG(h.z2F))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac}),n})();const zV=[{provide:UB,useClass:wq},{provide:F1,useFactory:function Aq(){return new qK}},{provide:LC,useClass:Dq},{provide:h.FYo,useFactory:function Rq(n,e,t){return new Tq(n,e,t)},deps:[ls,LC,h.R0b]}],G1=[{provide:S1,useFactory:()=>new bq},{provide:h.QbO,useValue:"BrowserAnimations"},...zV],WV=[{provide:S1,useClass:yV},{provide:h.QbO,useValue:"NoopAnimations"},...zV];let kq=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?WV:G1}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({providers:G1,imports:[po]}),n})();class z1{constructor(e){return e}}class PC{constructor(){return(0,Cn.vb)("auth")}}const W1=new h.OlP("angularfire2.auth-instances");function Lq(n){return(e,t)=>{const i=e.runOutsideAngular(()=>n(t));return new z1(i)}}const Oq={provide:PC,deps:[[new h.FiY,W1]]},Pq={provide:z1,useFactory:function Mq(n,e){const t=(0,Cn.JM)("auth",n,e);return t&&new z1(t)},deps:[[new h.FiY,W1],Uf]};let Nq=(()=>{class n{constructor(){(0,uc.KN)("angularfire",Cn.q4.full,"auth")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({providers:[Pq,Oq]}),n})();function Fq(n,...e){return{ngModule:Nq,providers:[{provide:W1,useFactory:Lq(n),multi:!0,deps:[h.R0b,h.zs3,Cn.HU,qw,[new h.FiY,Xp],...e]}]}}const Bq=(0,Cn.u3)(t2.o,!0);class K1{constructor(e){return e}}const qV="firestore",q1=new h.OlP("angularfire2.firestore-instances");function $q(n){return(e,t)=>{const i=e.runOutsideAngular(()=>n(t));return new K1(i)}}const Hq={provide:class Uq{constructor(){return(0,Cn.vb)(qV)}},deps:[[new h.FiY,q1]]},jq={provide:K1,useFactory:function Vq(n,e){const t=(0,Cn.JM)(qV,n,e);return t&&new K1(t)},deps:[[new h.FiY,q1],Uf]};let Gq=(()=>{class n{constructor(){(0,uc.KN)("angularfire",Cn.q4.full,"fst")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({providers:[jq,Hq]}),n})();function zq(n,...e){return{ngModule:Gq,providers:[{provide:q1,useFactory:$q(n),multi:!0,deps:[h.R0b,h.zs3,Cn.HU,qw,[new h.FiY,PC],[new h.FiY,Xp],...e]}]}}const Wq=(0,Cn.u3)(LF,!0),ZV="firebasestorage.googleapis.com",QV="storageBucket";class fr extends An.ZR{constructor(e,t,i=0){super(Y1(e),`Firebase Storage: ${t} (${Y1(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,fr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Y1(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var ki=(()=>(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(ki||(ki={})),ki))();function Y1(n){return"storage/"+n}function Q1(n){return new fr(ki.INVALID_ARGUMENT,n)}function t$(){return new fr(ki.APP_DELETED,"The Firebase app was deleted.")}class Lo{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Lo.makeFromUrl(e,t)}catch{return new Lo(e,"")}if(""===i.path)return i;throw function n9(n){return new fr(ki.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)",c=new RegExp("^gs://"+r+"(/(.*))?$","i");function m(te){te.path_=decodeURIComponent(te.path)}const v=t.replace(/[.]/g,"\\."),W=[{regex:c,indices:{bucket:1,path:3},postModify:function s(te){"/"===te.path.charAt(te.path.length-1)&&(te.path_=te.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${v}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:m},{regex:new RegExp(`^https?://${t===ZV?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:m}];for(let te=0;te<W.length;te++){const oe=W[te],Ae=oe.regex.exec(e);if(Ae){let Ge=Ae[oe.indices.path];Ge||(Ge=""),i=new Lo(Ae[oe.indices.bucket],Ge),oe.postModify(i);break}}if(null==i)throw function t9(n){return new fr(ki.INVALID_URL,"Invalid URL '"+n+"'.")}(e);return i}}class l9{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function J1(n,e,t,i){if(i<e)throw Q1(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Q1(`Invalid value for '${n}'. Expected ${t} or less.`)}var zf=(()=>(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"}(zf||(zf={})),zf))();class m9{constructor(e,t,i,r,s,o,c,d,m,g,v,E=!0){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=c,this.errorCallback_=d,this.timeout_=m,this.progressCallback_=g,this.connectionFactory_=v,this.retry=E,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,C)=>{this.resolve_=T,this.reject_=C,this.start_()})}start_(){const t=(i,r)=>{const s=this.resolve_,o=this.reject_,c=r.connection;if(r.wasSuccessCode)try{const d=this.callback_(c,c.getResponse());!function d9(n){return void 0!==n}(d)?s():s(d)}catch(d){o(d)}else if(null!==c){const d=function Z1(){return new fr(ki.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}();d.serverResponse=c.getErrorText(),o(this.errorCallback_?this.errorCallback_(c,d):d)}else o(r.canceled?this.appDelete_?t$():function JV(){return new fr(ki.CANCELED,"User canceled the upload/download.")}():function XV(){return new fr(ki.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}())};this.canceled_?t(0,new FC(!1,null,!0)):this.backoffId_=function c9(n,e,t){let i=1,r=null,s=null,o=!1,c=0;function d(){return 2===c}let m=!1;function g(...P){m||(m=!0,e.apply(null,P))}function v(P){r=setTimeout(()=>{r=null,n(T,d())},P)}function E(){s&&clearTimeout(s)}function T(P,...G){if(m)return void E();if(P)return E(),void g.call(null,P,...G);if(d()||o)return E(),void g.call(null,P,...G);let W;i<64&&(i*=2),1===c?(c=2,W=0):W=1e3*(i+Math.random()),v(W)}let C=!1;function k(P){C||(C=!0,E(),!m&&(null!==r?(P||(c=2),clearTimeout(r),v(0)):P||(c=1)))}return v(0),s=setTimeout(()=>{o=!0,k(!0)},t),k}((i,r)=>{if(r)return void i(!1,new FC(!1,null,!0));const s=this.connectionFactory_();this.pendingConnection_=s;const o=c=>{null!==this.progressCallback_&&this.progressCallback_(c.loaded,c.lengthComputable?c.total:-1)};null!==this.progressCallback_&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const c=s.getErrorCode()===zf.NO_ERROR,d=s.getStatus();if(!c||function r$(n,e){const t=n>=500&&n<600,r=-1!==[408,429].indexOf(n),s=-1!==e.indexOf(n);return t||r||s}(d,this.additionalRetryCodes_)&&this.retry){const g=s.getErrorCode()===zf.ABORT;return void i(!1,new FC(!1,null,g))}const m=-1!==this.successCodes_.indexOf(d);i(!0,new FC(m,s))})},t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function u9(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class FC{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}class cg{constructor(e,t){this._service=e,this._location=t instanceof Lo?t:Lo.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new cg(e,t)}get root(){const e=new Lo(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return function c$(n){const e=n.lastIndexOf("/",n.length-2);return-1===e?n:n.slice(e+1)}(this._location.path)}get storage(){return this._service}get parent(){const e=function D9(n){if(0===n.length)return null;const e=n.lastIndexOf("/");return-1===e?"":n.slice(0,e)}(this._location.path);if(null===e)return null;const t=new Lo(this._location.bucket,e);return new cg(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function a9(n){return new fr(ki.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function T$(n,e){const t=e?.[QV];return null==t?null:Lo.makeFromBucketSpec(t,n)}class sL{constructor(e,t,i,r,s){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._bucket=null,this._host=ZV,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?Lo.makeFromBucketSpec(r,this._host):T$(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?Lo.makeFromBucketSpec(this._url,e):T$(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){J1("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){J1("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,Te.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const t=e._authProvider.getImmediate({optional:!0});if(t){const i=yield t.getToken();if(null!==i)return i.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,Te.Z)(function*(){const t=e._appCheckProvider.getImmediate({optional:!0});return t?(yield t.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new cg(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new l9(t$());{const o=function v9(n,e,t,i,r,s,o=!0){const c=function i$(n){const e=encodeURIComponent;let t="?";for(const i in n)n.hasOwnProperty(i)&&(t=t+(e(i)+"=")+e(n[i])+"&");return t=t.slice(0,-1),t}(n.urlParams),d=n.url+c,m=Object.assign({},n.headers);return function _9(n,e){e&&(n["X-Firebase-GMPID"]=e)}(m,e),function p9(n,e){null!==e&&e.length>0&&(n.Authorization="Firebase "+e)}(m,t),function g9(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}(m,s),function y9(n,e){null!==e&&(n["X-Firebase-AppCheck"]=e)}(m,i),new m9(d,n.method,m,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o)}(e,this._appId,i,r,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){var i=this;return(0,Te.Z)(function*(){const[r,s]=yield Promise.all([i._getAuthToken(),i._getAppCheckToken()]);return i._makeRequest(e,t,r,s).getPromise()})()}}const I$="@firebase/storage",C$="storage";function f7(n=(0,hr.getApp)(),e){n=(0,An.m9)(n);const i=(0,hr._getProvider)(n,C$).getImmediate({identifier:e}),r=(0,An.P0)("storage");return r&&function m7(n,e,t,i={}){!function h7(n,e,t,i={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:r}=i;r&&(n._overrideAuthToken="string"==typeof r?r:(0,An.Sg)(r,n.app.options.projectId))}(n,e,t,i)}(i,...r),i}function p7(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new sL(t,i,r,e,hr.SDK_VERSION)}!function g7(){(0,hr._registerComponent)(new cd.wA(C$,p7,"PUBLIC").setMultipleInstances(!0)),(0,hr.registerVersion)(I$,"0.11.2",""),(0,hr.registerVersion)(I$,"0.11.2","esm2017")}();class oL{constructor(e){return e}}const D$="storage",aL=new h.OlP("angularfire2.storage-instances");function v7(n){return(e,t)=>{const i=e.runOutsideAngular(()=>n(t));return new oL(i)}}const b7={provide:class _7{constructor(){return(0,Cn.vb)(D$)}},deps:[[new h.FiY,aL]]},w7={provide:oL,useFactory:function y7(n,e){const t=(0,Cn.JM)(D$,n,e);return t&&new oL(t)},deps:[[new h.FiY,aL],Uf]};let E7=(()=>{class n{constructor(){(0,uc.KN)("angularfire",Cn.q4.full,"gcs")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({providers:[w7,b7]}),n})();function x7(n,...e){return{ngModule:E7,providers:[{provide:aL,useFactory:v7(n),multi:!0,deps:[h.R0b,h.zs3,Cn.HU,qw,[new h.FiY,PC],[new h.FiY,Xp],...e]}]}}const T7=(0,Cn.u3)(f7,!0),cL="functions";class A7{constructor(e,t,i){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then(r=>this.auth=r,()=>{}),this.messaging||t.get().then(r=>this.messaging=r,()=>{}),this.appCheck||i.get().then(r=>this.appCheck=r,()=>{})}getAuthToken(){var e=this;return(0,Te.Z)(function*(){if(e.auth)try{return(yield e.auth.getToken())?.accessToken}catch{return}})()}getMessagingToken(){var e=this;return(0,Te.Z)(function*(){if(e.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return yield e.messaging.getToken()}catch{return}})()}getAppCheckToken(e){var t=this;return(0,Te.Z)(function*(){if(t.appCheck){const i=e?yield t.appCheck.getLimitedUseToken():yield t.appCheck.getToken();return i.error?null:i.token}return null})()}getContext(e){var t=this;return(0,Te.Z)(function*(){return{authToken:yield t.getAuthToken(),messagingToken:yield t.getMessagingToken(),appCheckToken:yield t.getAppCheckToken(e)}})()}}const uL="us-central1";class k7{constructor(e,t,i,r,s=uL,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new A7(t,i,r),this.cancelAllRequests=new Promise(c=>{this.deleteService=()=>Promise.resolve(c())});try{const c=new URL(s);this.customDomain=c.origin,this.region=uL}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return null!==this.emulatorOrigin?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:null!==this.customDomain?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}const O$="@firebase/functions";function $7(n=(0,hr.getApp)(),e=uL){const i=(0,hr._getProvider)((0,An.m9)(n),cL).getImmediate({identifier:e}),r=(0,An.P0)("functions");return r&&function H7(n,e,t){!function M7(n,e,t){n.emulatorOrigin=`http://${e}:${t}`}((0,An.m9)(n),e,t)}(i,...r),i}!function V7(n,e){(0,hr._registerComponent)(new cd.wA(cL,(i,{instanceIdentifier:r})=>{const s=i.getProvider("app").getImmediate(),o=i.getProvider("auth-internal"),c=i.getProvider("messaging-internal"),d=i.getProvider("app-check-internal");return new k7(s,o,c,d,r,n)},"PUBLIC").setMultipleInstances(!0)),(0,hr.registerVersion)(O$,"0.10.0",e),(0,hr.registerVersion)(O$,"0.10.0","esm2017")}(fetch.bind(self));class dL{constructor(e){return e}}const N$="functions",hL=new h.OlP("angularfire2.functions-instances");function z7(n){return(e,t)=>{const i=e.runOutsideAngular(()=>n(t));return new dL(i)}}const W7={provide:class j7{constructor(){return(0,Cn.vb)(N$)}},deps:[[new h.FiY,hL]]},K7={provide:dL,useFactory:function G7(n,e){const t=(0,Cn.JM)(N$,n,e);return t&&new dL(t)},deps:[[new h.FiY,hL],Uf]};let q7=(()=>{class n{constructor(){(0,uc.KN)("angularfire",Cn.q4.full,"fn")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({providers:[K7,W7]}),n})();function Y7(n,...e){return{ngModule:q7,providers:[{provide:hL,useFactory:z7(n),multi:!0,deps:[h.R0b,h.zs3,Cn.HU,qw,[new h.FiY,PC],[new h.FiY,Xp],...e]}]}}const Z7=(0,Cn.u3)($7,!0),F$_firebaseConfig={apiKey:"AIzaSyAmG52vP8RvmwchQ71fQggTMu0eRdUz0Bc",authDomain:"tv-project-ffd44.firebaseapp.com",databaseURL:"https://tv-project-ffd44-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"tv-project-ffd44",storageBucket:"tv-project-ffd44.appspot.com",messagingSenderId:"711946849087",appId:"1:711946849087:web:0079a3cd80b97cea04e18a",measurementId:"G-0GRY2RNYRQ"};let EY=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({imports:[ko,ko]}),n})(),xY=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({imports:[ko,ko]}),n})(),IY=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.oAB({type:n}),n.\u0275inj=h.cJS({imports:[ko]}),n})(),SY=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275mod=h.oAB({type:n,bootstrap:[Vg]}),n.\u0275inj=h.cJS({imports:[po,MW,TW,kq,U5,M8,mW,IY,EY,WM,xY,cc.hO.initializeApp(F$_firebaseConfig),Sz,pG(()=>_G(F$_firebaseConfig)),Fq(()=>Bq()),zq(()=>Wq()),x7(()=>T7()),Y7(()=>Z7(gG(),"asia-east2"))]}),e})();Jd().bootstrapModule(SY).catch(n=>console.error(n))},9751:(Ft,Be,z)=>{z.d(Be,{y:()=>Le});var h=z(930),X=z(727),V=z(8822),de=z(9635),ye=z(2416),ue=z(576),Oe=z(2806);let Le=(()=>{class le{constructor(Ue){Ue&&(this._subscribe=Ue)}lift(Ue){const lt=new le;return lt.source=this,lt.operator=Ue,lt}subscribe(Ue,lt,Et){const Se=function J(le){return le&&le instanceof h.Lv||function ee(le){return le&&(0,ue.m)(le.next)&&(0,ue.m)(le.error)&&(0,ue.m)(le.complete)}(le)&&(0,X.Nn)(le)}(Ue)?Ue:new h.Hp(Ue,lt,Et);return(0,Oe.x)(()=>{const{operator:ze,source:qe}=this;Se.add(ze?ze.call(Se,qe):qe?this._subscribe(Se):this._trySubscribe(Se))}),Se}_trySubscribe(Ue){try{return this._subscribe(Ue)}catch(lt){Ue.error(lt)}}forEach(Ue,lt){return new(lt=Ce(lt))((Et,Se)=>{const ze=new h.Hp({next:qe=>{try{Ue(qe)}catch(st){Se(st),ze.unsubscribe()}},error:Se,complete:Et});this.subscribe(ze)})}_subscribe(Ue){var lt;return null===(lt=this.source)||void 0===lt?void 0:lt.subscribe(Ue)}[V.L](){return this}pipe(...Ue){return(0,de.U)(Ue)(this)}toPromise(Ue){return new(Ue=Ce(Ue))((lt,Et)=>{let Se;this.subscribe(ze=>Se=ze,ze=>Et(ze),()=>lt(Se))})}}return le.create=tt=>new le(tt),le})();function Ce(le){var tt;return null!==(tt=le??ye.v.Promise)&&void 0!==tt?tt:Promise}},7579:(Ft,Be,z)=>{z.d(Be,{x:()=>Oe});var h=z(9751),X=z(727);const de=(0,z(3888).d)(Ce=>function(){Ce(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ye=z(8737),ue=z(2806);let Oe=(()=>{class Ce extends h.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(J){const le=new Le(this,this);return le.operator=J,le}_throwIfClosed(){if(this.closed)throw new de}next(J){(0,ue.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const le of this.currentObservers)le.next(J)}})}error(J){(0,ue.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=J;const{observers:le}=this;for(;le.length;)le.shift().error(J)}})}complete(){(0,ue.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:J}=this;for(;J.length;)J.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var J;return(null===(J=this.observers)||void 0===J?void 0:J.length)>0}_trySubscribe(J){return this._throwIfClosed(),super._trySubscribe(J)}_subscribe(J){return this._throwIfClosed(),this._checkFinalizedStatuses(J),this._innerSubscribe(J)}_innerSubscribe(J){const{hasError:le,isStopped:tt,observers:Ue}=this;return le||tt?X.Lc:(this.currentObservers=null,Ue.push(J),new X.w0(()=>{this.currentObservers=null,(0,ye.P)(Ue,J)}))}_checkFinalizedStatuses(J){const{hasError:le,thrownError:tt,isStopped:Ue}=this;le?J.error(tt):Ue&&J.complete()}asObservable(){const J=new h.y;return J.source=this,J}}return Ce.create=(ee,J)=>new Le(ee,J),Ce})();class Le extends Oe{constructor(ee,J){super(),this.destination=ee,this.source=J}next(ee){var J,le;null===(le=null===(J=this.destination)||void 0===J?void 0:J.next)||void 0===le||le.call(J,ee)}error(ee){var J,le;null===(le=null===(J=this.destination)||void 0===J?void 0:J.error)||void 0===le||le.call(J,ee)}complete(){var ee,J;null===(J=null===(ee=this.destination)||void 0===ee?void 0:ee.complete)||void 0===J||J.call(ee)}_subscribe(ee){var J,le;return null!==(le=null===(J=this.source)||void 0===J?void 0:J.subscribe(ee))&&void 0!==le?le:X.Lc}}},930:(Ft,Be,z)=>{z.d(Be,{Hp:()=>Et,Lv:()=>le});var h=z(576),X=z(727),V=z(2416),de=z(7849),ye=z(5032);const ue=Ce("C",void 0,void 0);function Ce(Ye,He,je){return{kind:Ye,value:He,error:je}}var ee=z(3410),J=z(2806);class le extends X.w0{constructor(He){super(),this.isStopped=!1,He?(this.destination=He,(0,X.Nn)(He)&&He.add(this)):this.destination=st}static create(He,je,at){return new Et(He,je,at)}next(He){this.isStopped?qe(function Le(Ye){return Ce("N",Ye,void 0)}(He),this):this._next(He)}error(He){this.isStopped?qe(function Oe(Ye){return Ce("E",void 0,Ye)}(He),this):(this.isStopped=!0,this._error(He))}complete(){this.isStopped?qe(ue,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(He){this.destination.next(He)}_error(He){try{this.destination.error(He)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const tt=Function.prototype.bind;function Ue(Ye,He){return tt.call(Ye,He)}class lt{constructor(He){this.partialObserver=He}next(He){const{partialObserver:je}=this;if(je.next)try{je.next(He)}catch(at){Se(at)}}error(He){const{partialObserver:je}=this;if(je.error)try{je.error(He)}catch(at){Se(at)}else Se(He)}complete(){const{partialObserver:He}=this;if(He.complete)try{He.complete()}catch(je){Se(je)}}}class Et extends le{constructor(He,je,at){let Je;if(super(),(0,h.m)(He)||!He)Je={next:He??void 0,error:je??void 0,complete:at??void 0};else{let wt;this&&V.v.useDeprecatedNextContext?(wt=Object.create(He),wt.unsubscribe=()=>this.unsubscribe(),Je={next:He.next&&Ue(He.next,wt),error:He.error&&Ue(He.error,wt),complete:He.complete&&Ue(He.complete,wt)}):Je=He}this.destination=new lt(Je)}}function Se(Ye){V.v.useDeprecatedSynchronousErrorHandling?(0,J.O)(Ye):(0,de.h)(Ye)}function qe(Ye,He){const{onStoppedNotification:je}=V.v;je&&ee.z.setTimeout(()=>je(Ye,He))}const st={closed:!0,next:ye.Z,error:function ze(Ye){throw Ye},complete:ye.Z}},727:(Ft,Be,z)=>{z.d(Be,{Lc:()=>ue,w0:()=>ye,Nn:()=>Oe});var h=z(576);const V=(0,z(3888).d)(Ce=>function(J){Ce(this),this.message=J?`${J.length} errors occurred during unsubscription:\n${J.map((le,tt)=>`${tt+1}) ${le.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=J});var de=z(8737);class ye{constructor(ee){this.initialTeardown=ee,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let ee;if(!this.closed){this.closed=!0;const{_parentage:J}=this;if(J)if(this._parentage=null,Array.isArray(J))for(const Ue of J)Ue.remove(this);else J.remove(this);const{initialTeardown:le}=this;if((0,h.m)(le))try{le()}catch(Ue){ee=Ue instanceof V?Ue.errors:[Ue]}const{_finalizers:tt}=this;if(tt){this._finalizers=null;for(const Ue of tt)try{Le(Ue)}catch(lt){ee=ee??[],lt instanceof V?ee=[...ee,...lt.errors]:ee.push(lt)}}if(ee)throw new V(ee)}}add(ee){var J;if(ee&&ee!==this)if(this.closed)Le(ee);else{if(ee instanceof ye){if(ee.closed||ee._hasParent(this))return;ee._addParent(this)}(this._finalizers=null!==(J=this._finalizers)&&void 0!==J?J:[]).push(ee)}}_hasParent(ee){const{_parentage:J}=this;return J===ee||Array.isArray(J)&&J.includes(ee)}_addParent(ee){const{_parentage:J}=this;this._parentage=Array.isArray(J)?(J.push(ee),J):J?[J,ee]:ee}_removeParent(ee){const{_parentage:J}=this;J===ee?this._parentage=null:Array.isArray(J)&&(0,de.P)(J,ee)}remove(ee){const{_finalizers:J}=this;J&&(0,de.P)(J,ee),ee instanceof ye&&ee._removeParent(this)}}ye.EMPTY=(()=>{const Ce=new ye;return Ce.closed=!0,Ce})();const ue=ye.EMPTY;function Oe(Ce){return Ce instanceof ye||Ce&&"closed"in Ce&&(0,h.m)(Ce.remove)&&(0,h.m)(Ce.add)&&(0,h.m)(Ce.unsubscribe)}function Le(Ce){(0,h.m)(Ce)?Ce():Ce.unsubscribe()}},2416:(Ft,Be,z)=>{z.d(Be,{v:()=>h});const h={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(Ft,Be,z)=>{z.d(Be,{E:()=>X});const X=new(z(9751).y)(ye=>ye.complete())},8996:(Ft,Be,z)=>{z.d(Be,{D:()=>He});var h=z(8421),X=z(5363),V=z(9468),ue=z(9751),Le=z(2202),Ce=z(576),ee=z(9672);function le(je,at){if(!je)throw new Error("Iterable cannot be null");return new ue.y(Je=>{(0,ee.f)(Je,at,()=>{const wt=je[Symbol.asyncIterator]();(0,ee.f)(Je,at,()=>{wt.next().then(At=>{At.done?Je.complete():Je.next(At.value)})},0,!0)})})}var tt=z(3670),Ue=z(8239),lt=z(1144),Et=z(6495),Se=z(2206),ze=z(4532),qe=z(3260);function He(je,at){return at?function Ye(je,at){if(null!=je){if((0,tt.c)(je))return function de(je,at){return(0,h.Xf)(je).pipe((0,V.R)(at),(0,X.Q)(at))}(je,at);if((0,lt.z)(je))return function Oe(je,at){return new ue.y(Je=>{let wt=0;return at.schedule(function(){wt===je.length?Je.complete():(Je.next(je[wt++]),Je.closed||this.schedule())})})}(je,at);if((0,Ue.t)(je))return function ye(je,at){return(0,h.Xf)(je).pipe((0,V.R)(at),(0,X.Q)(at))}(je,at);if((0,Se.D)(je))return le(je,at);if((0,Et.T)(je))return function J(je,at){return new ue.y(Je=>{let wt;return(0,ee.f)(Je,at,()=>{wt=je[Le.h](),(0,ee.f)(Je,at,()=>{let At,cn;try{({value:At,done:cn}=wt.next())}catch(xt){return void Je.error(xt)}cn?Je.complete():Je.next(At)},0,!0)}),()=>(0,Ce.m)(wt?.return)&&wt.return()})}(je,at);if((0,qe.L)(je))return function st(je,at){return le((0,qe.Q)(je),at)}(je,at)}throw(0,ze.z)(je)}(je,at):(0,h.Xf)(je)}},8421:(Ft,Be,z)=>{z.d(Be,{Xf:()=>tt});var h=z(7582),X=z(1144),V=z(8239),de=z(9751),ye=z(3670),ue=z(2206),Oe=z(4532),Le=z(6495),Ce=z(3260),ee=z(576),J=z(7849),le=z(8822);function tt(Ye){if(Ye instanceof de.y)return Ye;if(null!=Ye){if((0,ye.c)(Ye))return function Ue(Ye){return new de.y(He=>{const je=Ye[le.L]();if((0,ee.m)(je.subscribe))return je.subscribe(He);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Ye);if((0,X.z)(Ye))return function lt(Ye){return new de.y(He=>{for(let je=0;je<Ye.length&&!He.closed;je++)He.next(Ye[je]);He.complete()})}(Ye);if((0,V.t)(Ye))return function Et(Ye){return new de.y(He=>{Ye.then(je=>{He.closed||(He.next(je),He.complete())},je=>He.error(je)).then(null,J.h)})}(Ye);if((0,ue.D)(Ye))return ze(Ye);if((0,Le.T)(Ye))return function Se(Ye){return new de.y(He=>{for(const je of Ye)if(He.next(je),He.closed)return;He.complete()})}(Ye);if((0,Ce.L)(Ye))return function qe(Ye){return ze((0,Ce.Q)(Ye))}(Ye)}throw(0,Oe.z)(Ye)}function ze(Ye){return new de.y(He=>{(function st(Ye,He){var je,at,Je,wt;return(0,h.mG)(this,void 0,void 0,function*(){try{for(je=(0,h.KL)(Ye);!(at=yield je.next()).done;)if(He.next(at.value),He.closed)return}catch(At){Je={error:At}}finally{try{at&&!at.done&&(wt=je.return)&&(yield wt.call(je))}finally{if(Je)throw Je.error}}He.complete()})})(Ye,He).catch(je=>He.error(je))})}},6451:(Ft,Be,z)=>{z.d(Be,{T:()=>ue});var h=z(8189),X=z(8421),V=z(515),de=z(3269),ye=z(8996);function ue(...Oe){const Le=(0,de.yG)(Oe),Ce=(0,de._6)(Oe,1/0),ee=Oe;return ee.length?1===ee.length?(0,X.Xf)(ee[0]):(0,h.J)(Ce)((0,ye.D)(ee,Le)):V.E}},5403:(Ft,Be,z)=>{z.d(Be,{x:()=>X});var h=z(930);function X(de,ye,ue,Oe,Le){return new V(de,ye,ue,Oe,Le)}class V extends h.Lv{constructor(ye,ue,Oe,Le,Ce,ee){super(ye),this.onFinalize=Ce,this.shouldUnsubscribe=ee,this._next=ue?function(J){try{ue(J)}catch(le){ye.error(le)}}:super._next,this._error=Le?function(J){try{Le(J)}catch(le){ye.error(le)}finally{this.unsubscribe()}}:super._error,this._complete=Oe?function(){try{Oe()}catch(J){ye.error(J)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var ye;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:ue}=this;super.unsubscribe(),!ue&&(null===(ye=this.onFinalize)||void 0===ye||ye.call(this))}}}},4004:(Ft,Be,z)=>{z.d(Be,{U:()=>V});var h=z(4482),X=z(5403);function V(de,ye){return(0,h.e)((ue,Oe)=>{let Le=0;ue.subscribe((0,X.x)(Oe,Ce=>{Oe.next(de.call(ye,Ce,Le++))}))})}},8189:(Ft,Be,z)=>{z.d(Be,{J:()=>V});var h=z(5577),X=z(4671);function V(de=1/0){return(0,h.z)(X.y,de)}},5577:(Ft,Be,z)=>{z.d(Be,{z:()=>Le});var h=z(4004),X=z(8421),V=z(4482),de=z(9672),ye=z(5403),Oe=z(576);function Le(Ce,ee,J=1/0){return(0,Oe.m)(ee)?Le((le,tt)=>(0,h.U)((Ue,lt)=>ee(le,Ue,tt,lt))((0,X.Xf)(Ce(le,tt))),J):("number"==typeof ee&&(J=ee),(0,V.e)((le,tt)=>function ue(Ce,ee,J,le,tt,Ue,lt,Et){const Se=[];let ze=0,qe=0,st=!1;const Ye=()=>{st&&!Se.length&&!ze&&ee.complete()},He=at=>ze<le?je(at):Se.push(at),je=at=>{Ue&&ee.next(at),ze++;let Je=!1;(0,X.Xf)(J(at,qe++)).subscribe((0,ye.x)(ee,wt=>{tt?.(wt),Ue?He(wt):ee.next(wt)},()=>{Je=!0},void 0,()=>{if(Je)try{for(ze--;Se.length&&ze<le;){const wt=Se.shift();lt?(0,de.f)(ee,lt,()=>je(wt)):je(wt)}Ye()}catch(wt){ee.error(wt)}}))};return Ce.subscribe((0,ye.x)(ee,He,()=>{st=!0,Ye()})),()=>{Et?.()}}(le,tt,Ce,J)))}},5363:(Ft,Be,z)=>{z.d(Be,{Q:()=>de});var h=z(9672),X=z(4482),V=z(5403);function de(ye,ue=0){return(0,X.e)((Oe,Le)=>{Oe.subscribe((0,V.x)(Le,Ce=>(0,h.f)(Le,ye,()=>Le.next(Ce),ue),()=>(0,h.f)(Le,ye,()=>Le.complete(),ue),Ce=>(0,h.f)(Le,ye,()=>Le.error(Ce),ue)))})}},3099:(Ft,Be,z)=>{z.d(Be,{B:()=>ye});var h=z(8421),X=z(7579),V=z(930),de=z(4482);function ye(Oe={}){const{connector:Le=(()=>new X.x),resetOnError:Ce=!0,resetOnComplete:ee=!0,resetOnRefCountZero:J=!0}=Oe;return le=>{let tt,Ue,lt,Et=0,Se=!1,ze=!1;const qe=()=>{Ue?.unsubscribe(),Ue=void 0},st=()=>{qe(),tt=lt=void 0,Se=ze=!1},Ye=()=>{const He=tt;st(),He?.unsubscribe()};return(0,de.e)((He,je)=>{Et++,!ze&&!Se&&qe();const at=lt=lt??Le();je.add(()=>{Et--,0===Et&&!ze&&!Se&&(Ue=ue(Ye,J))}),at.subscribe(je),!tt&&Et>0&&(tt=new V.Hp({next:Je=>at.next(Je),error:Je=>{ze=!0,qe(),Ue=ue(st,Ce,Je),at.error(Je)},complete:()=>{Se=!0,qe(),Ue=ue(st,ee),at.complete()}}),(0,h.Xf)(He).subscribe(tt))})(le)}}function ue(Oe,Le,...Ce){if(!0===Le)return void Oe();if(!1===Le)return;const ee=new V.Hp({next:()=>{ee.unsubscribe(),Oe()}});return(0,h.Xf)(Le(...Ce)).subscribe(ee)}},9468:(Ft,Be,z)=>{z.d(Be,{R:()=>X});var h=z(4482);function X(V,de=0){return(0,h.e)((ye,ue)=>{ue.add(V.schedule(()=>ye.subscribe(ue),de))})}},8505:(Ft,Be,z)=>{z.d(Be,{b:()=>ye});var h=z(576),X=z(4482),V=z(5403),de=z(4671);function ye(ue,Oe,Le){const Ce=(0,h.m)(ue)||Oe||Le?{next:ue,error:Oe,complete:Le}:ue;return Ce?(0,X.e)((ee,J)=>{var le;null===(le=Ce.subscribe)||void 0===le||le.call(Ce);let tt=!0;ee.subscribe((0,V.x)(J,Ue=>{var lt;null===(lt=Ce.next)||void 0===lt||lt.call(Ce,Ue),J.next(Ue)},()=>{var Ue;tt=!1,null===(Ue=Ce.complete)||void 0===Ue||Ue.call(Ce),J.complete()},Ue=>{var lt;tt=!1,null===(lt=Ce.error)||void 0===lt||lt.call(Ce,Ue),J.error(Ue)},()=>{var Ue,lt;tt&&(null===(Ue=Ce.unsubscribe)||void 0===Ue||Ue.call(Ce)),null===(lt=Ce.finalize)||void 0===lt||lt.call(Ce)}))}):de.y}},4408:(Ft,Be,z)=>{z.d(Be,{o:()=>ye});var h=z(727);class X extends h.w0{constructor(Oe,Le){super()}schedule(Oe,Le=0){return this}}const V={setInterval(ue,Oe,...Le){const{delegate:Ce}=V;return Ce?.setInterval?Ce.setInterval(ue,Oe,...Le):setInterval(ue,Oe,...Le)},clearInterval(ue){const{delegate:Oe}=V;return(Oe?.clearInterval||clearInterval)(ue)},delegate:void 0};var de=z(8737);class ye extends X{constructor(Oe,Le){super(Oe,Le),this.scheduler=Oe,this.work=Le,this.pending=!1}schedule(Oe,Le=0){var Ce;if(this.closed)return this;this.state=Oe;const ee=this.id,J=this.scheduler;return null!=ee&&(this.id=this.recycleAsyncId(J,ee,Le)),this.pending=!0,this.delay=Le,this.id=null!==(Ce=this.id)&&void 0!==Ce?Ce:this.requestAsyncId(J,this.id,Le),this}requestAsyncId(Oe,Le,Ce=0){return V.setInterval(Oe.flush.bind(Oe,this),Ce)}recycleAsyncId(Oe,Le,Ce=0){if(null!=Ce&&this.delay===Ce&&!1===this.pending)return Le;null!=Le&&V.clearInterval(Le)}execute(Oe,Le){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const Ce=this._execute(Oe,Le);if(Ce)return Ce;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(Oe,Le){let ee,Ce=!1;try{this.work(Oe)}catch(J){Ce=!0,ee=J||new Error("Scheduled action threw falsy error")}if(Ce)return this.unsubscribe(),ee}unsubscribe(){if(!this.closed){const{id:Oe,scheduler:Le}=this,{actions:Ce}=Le;this.work=this.state=this.scheduler=null,this.pending=!1,(0,de.P)(Ce,this),null!=Oe&&(this.id=this.recycleAsyncId(Le,Oe,null)),this.delay=null,super.unsubscribe()}}}},7565:(Ft,Be,z)=>{z.d(Be,{v:()=>V});var h=z(6063);class X{constructor(ye,ue=X.now){this.schedulerActionCtor=ye,this.now=ue}schedule(ye,ue=0,Oe){return new this.schedulerActionCtor(this,ye).schedule(Oe,ue)}}X.now=h.l.now;class V extends X{constructor(ye,ue=X.now){super(ye,ue),this.actions=[],this._active=!1}flush(ye){const{actions:ue}=this;if(this._active)return void ue.push(ye);let Oe;this._active=!0;do{if(Oe=ye.execute(ye.state,ye.delay))break}while(ye=ue.shift());if(this._active=!1,Oe){for(;ye=ue.shift();)ye.unsubscribe();throw Oe}}}},4986:(Ft,Be,z)=>{z.d(Be,{P:()=>de,z:()=>V});var h=z(4408);const V=new(z(7565).v)(h.o),de=V},6063:(Ft,Be,z)=>{z.d(Be,{l:()=>h});const h={now:()=>(h.delegate||Date).now(),delegate:void 0}},3410:(Ft,Be,z)=>{z.d(Be,{z:()=>h});const h={setTimeout(X,V,...de){const{delegate:ye}=h;return ye?.setTimeout?ye.setTimeout(X,V,...de):setTimeout(X,V,...de)},clearTimeout(X){const{delegate:V}=h;return(V?.clearTimeout||clearTimeout)(X)},delegate:void 0}},2202:(Ft,Be,z)=>{z.d(Be,{h:()=>X});const X=function h(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(Ft,Be,z)=>{z.d(Be,{L:()=>h});const h="function"==typeof Symbol&&Symbol.observable||"@@observable"},3269:(Ft,Be,z)=>{z.d(Be,{_6:()=>ue,jO:()=>de,yG:()=>ye});var h=z(576),X=z(3532);function V(Oe){return Oe[Oe.length-1]}function de(Oe){return(0,h.m)(V(Oe))?Oe.pop():void 0}function ye(Oe){return(0,X.K)(V(Oe))?Oe.pop():void 0}function ue(Oe,Le){return"number"==typeof V(Oe)?Oe.pop():Le}},8737:(Ft,Be,z)=>{function h(X,V){if(X){const de=X.indexOf(V);0<=de&&X.splice(de,1)}}z.d(Be,{P:()=>h})},3888:(Ft,Be,z)=>{function h(X){const de=X(ye=>{Error.call(ye),ye.stack=(new Error).stack});return de.prototype=Object.create(Error.prototype),de.prototype.constructor=de,de}z.d(Be,{d:()=>h})},2806:(Ft,Be,z)=>{z.d(Be,{O:()=>de,x:()=>V});var h=z(2416);let X=null;function V(ye){if(h.v.useDeprecatedSynchronousErrorHandling){const ue=!X;if(ue&&(X={errorThrown:!1,error:null}),ye(),ue){const{errorThrown:Oe,error:Le}=X;if(X=null,Oe)throw Le}}else ye()}function de(ye){h.v.useDeprecatedSynchronousErrorHandling&&X&&(X.errorThrown=!0,X.error=ye)}},9672:(Ft,Be,z)=>{function h(X,V,de,ye=0,ue=!1){const Oe=V.schedule(function(){de(),ue?X.add(this.schedule(null,ye)):this.unsubscribe()},ye);if(X.add(Oe),!ue)return Oe}z.d(Be,{f:()=>h})},4671:(Ft,Be,z)=>{function h(X){return X}z.d(Be,{y:()=>h})},1144:(Ft,Be,z)=>{z.d(Be,{z:()=>h});const h=X=>X&&"number"==typeof X.length&&"function"!=typeof X},2206:(Ft,Be,z)=>{z.d(Be,{D:()=>X});var h=z(576);function X(V){return Symbol.asyncIterator&&(0,h.m)(V?.[Symbol.asyncIterator])}},576:(Ft,Be,z)=>{function h(X){return"function"==typeof X}z.d(Be,{m:()=>h})},3670:(Ft,Be,z)=>{z.d(Be,{c:()=>V});var h=z(8822),X=z(576);function V(de){return(0,X.m)(de[h.L])}},6495:(Ft,Be,z)=>{z.d(Be,{T:()=>V});var h=z(2202),X=z(576);function V(de){return(0,X.m)(de?.[h.h])}},8239:(Ft,Be,z)=>{z.d(Be,{t:()=>X});var h=z(576);function X(V){return(0,h.m)(V?.then)}},3260:(Ft,Be,z)=>{z.d(Be,{L:()=>de,Q:()=>V});var h=z(7582),X=z(576);function V(ye){return(0,h.FC)(this,arguments,function*(){const Oe=ye.getReader();try{for(;;){const{value:Le,done:Ce}=yield(0,h.qq)(Oe.read());if(Ce)return yield(0,h.qq)(void 0);yield yield(0,h.qq)(Le)}}finally{Oe.releaseLock()}})}function de(ye){return(0,X.m)(ye?.getReader)}},3532:(Ft,Be,z)=>{z.d(Be,{K:()=>X});var h=z(576);function X(V){return V&&(0,h.m)(V.schedule)}},4482:(Ft,Be,z)=>{z.d(Be,{A:()=>X,e:()=>V});var h=z(576);function X(de){return(0,h.m)(de?.lift)}function V(de){return ye=>{if(X(ye))return ye.lift(function(ue){try{return de(ue,this)}catch(Oe){this.error(Oe)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(Ft,Be,z)=>{function h(){}z.d(Be,{Z:()=>h})},9635:(Ft,Be,z)=>{z.d(Be,{U:()=>V,z:()=>X});var h=z(4671);function X(...de){return V(de)}function V(de){return 0===de.length?h.y:1===de.length?de[0]:function(ue){return de.reduce((Oe,Le)=>Le(Oe),ue)}}},7849:(Ft,Be,z)=>{z.d(Be,{h:()=>V});var h=z(2416),X=z(3410);function V(de){X.z.setTimeout(()=>{const{onUnhandledError:ye}=h.v;if(!ye)throw de;ye(de)})}},4532:(Ft,Be,z)=>{function h(X){return new TypeError(`You provided ${null!==X&&"object"==typeof X?"an invalid object":`'${X}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}z.d(Be,{z:()=>h})},4650:(Ft,Be,z)=>{z.d(Be,{$8M:()=>Za,$WT:()=>Xe,$Z:()=>gx,AFp:()=>Ip,ALo:()=>cd,AaK:()=>Le,AsE:()=>Rv,CHM:()=>Fd,CRH:()=>F_,CZH:()=>su,CqO:()=>Vx,D6c:()=>tw,DdM:()=>ab,EJc:()=>gI,EiD:()=>sD,EpF:()=>Jm,F$t:()=>jx,F4k:()=>Ux,FYo:()=>S0,FiY:()=>wa,Gf:()=>P_,GfV:()=>YE,Gpc:()=>J,Hsn:()=>Gx,JOm:()=>Zt,JVY:()=>AE,JZr:()=>Et,Jf7:()=>XE,KtG:()=>Bd,L6k:()=>RE,LAX:()=>Qu,LFG:()=>En,LSH:()=>m0,Lbi:()=>Sp,Lck:()=>GT,MAs:()=>Zg,MMx:()=>rb,NdJ:()=>fv,O4$:()=>om,OlP:()=>Ln,P3R:()=>VE,PXZ:()=>mf,Q6J:()=>uv,QGY:()=>ep,QbO:()=>Pb,Qsj:()=>_D,R0b:()=>So,RDi:()=>ZC,Rgc:()=>vp,SBq:()=>Dh,Sil:()=>yI,Suo:()=>N_,TTD:()=>Rd,TgZ:()=>Xl,Udp:()=>Tv,W1O:()=>rf,WFA:()=>tp,X6Q:()=>MI,XFs:()=>Bt,Xpm:()=>On,Xts:()=>g0,Y36:()=>Lh,YKP:()=>S_,YNc:()=>ln,Yjl:()=>$t,Yz7:()=>Dt,Z0I:()=>si,ZZ4:()=>_f,_Bn:()=>nb,_UZ:()=>dv,_Vd:()=>Ch,_c5:()=>li,_uU:()=>iT,aQg:()=>cy,c2e:()=>Nb,cJS:()=>Vt,cg1:()=>fl,d8E:()=>Nv,dDg:()=>Rp,dqk:()=>ni,eBb:()=>eD,eFA:()=>zb,eJc:()=>U_,ekj:()=>Iv,eoX:()=>wI,f3M:()=>Wi,g9A:()=>Ob,h0i:()=>Jh,hGG:()=>jR,hij:()=>a_,iGM:()=>O_,ifc:()=>j,ip1:()=>Mb,jDz:()=>sb,kL8:()=>Fv,kcU:()=>Ll,lG2:()=>It,lcZ:()=>JT,lqb:()=>Ju,lri:()=>Ap,mCW:()=>wh,n5z:()=>Hu,n_E:()=>A_,oAB:()=>fe,oxw:()=>Jg,pB0:()=>kE,q3G:()=>Bi,q4F:()=>ZE,qLn:()=>Nm,qOj:()=>ev,qZA:()=>$h,qzn:()=>Zs,rWj:()=>ff,sBO:()=>LI,s_b:()=>k_,soG:()=>ou,tb:()=>sc,tp0:()=>bt,uIk:()=>rv,vHH:()=>Se,vpe:()=>Zo,wAp:()=>Qt,xp6:()=>lx,z2F:()=>fd,z3N:()=>Ia,zSh:()=>Qc,zs3:()=>Rh});var h=z(7579),X=z(727),V=z(9751),de=z(6451),ye=z(3099);function ue(a){for(let l in a)if(a[l]===ue)return l;throw Error("Could not find renamed property on target object.")}function Oe(a,l){for(const u in l)l.hasOwnProperty(u)&&!a.hasOwnProperty(u)&&(a[u]=l[u])}function Le(a){if("string"==typeof a)return a;if(Array.isArray(a))return"["+a.map(Le).join(", ")+"]";if(null==a)return""+a;if(a.overriddenName)return`${a.overriddenName}`;if(a.name)return`${a.name}`;const l=a.toString();if(null==l)return""+l;const u=l.indexOf("\n");return-1===u?l:l.substring(0,u)}function Ce(a,l){return null==a||""===a?null===l?"":l:null==l||""===l?a:a+" "+l}const ee=ue({__forward_ref__:ue});function J(a){return a.__forward_ref__=J,a.toString=function(){return Le(this())},a}function le(a){return tt(a)?a():a}function tt(a){return"function"==typeof a&&a.hasOwnProperty(ee)&&a.__forward_ref__===J}function Ue(a){return a&&!!a.\u0275providers}const Et="https://g.co/ng/security#xss";class Se extends Error{constructor(l,u){super(ze(l,u)),this.code=l}}function ze(a,l){return`NG0${Math.abs(a)}${l?": "+l.trim():""}`}function qe(a){return"string"==typeof a?a:null==a?"":String(a)}function at(a,l){throw new Se(-201,!1)}function Ie(a,l){null==a&&function pe(a,l,u,f){throw new Error(`ASSERTION ERROR: ${a}`+(null==f?"":` [Expected=> ${u} ${f} ${l} <=Actual]`))}(l,a,null,"!=")}function Dt(a){return{token:a.token,providedIn:a.providedIn||null,factory:a.factory,value:void 0}}function Vt(a){return{providers:a.providers||[],imports:a.imports||[]}}function Tn(a){return Gn(a,gi)||Gn(a,tr)}function si(a){return null!==Tn(a)}function Gn(a,l){return a.hasOwnProperty(l)?a[l]:null}function Li(a){return a&&(a.hasOwnProperty(Oi)||a.hasOwnProperty(bi))?a[Oi]:null}const gi=ue({\u0275prov:ue}),Oi=ue({\u0275inj:ue}),tr=ue({ngInjectableDef:ue}),bi=ue({ngInjectorDef:ue});var Bt=(()=>((Bt=Bt||{})[Bt.Default=0]="Default",Bt[Bt.Host=1]="Host",Bt[Bt.Self=2]="Self",Bt[Bt.SkipSelf=4]="SkipSelf",Bt[Bt.Optional=8]="Optional",Bt))();let vs;function Pn(a){const l=vs;return vs=a,l}function $r(a,l,u){const f=Tn(a);return f&&"root"==f.providedIn?void 0===f.value?f.value=f.factory():f.value:u&Bt.Optional?null:void 0!==l?l:void at(Le(a))}const ni=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),nr={},ui="__NG_DI_FLAG__",wi="ngTempTokenPath",mr="ngTokenPath",zi=/\n/gm,oa="\u0275",zn="__source";let di;function sn(a){const l=di;return di=a,l}function so(a,l=Bt.Default){if(void 0===di)throw new Se(-203,!1);return null===di?$r(a,void 0,l):di.get(a,l&Bt.Optional?null:void 0,l)}function En(a,l=Bt.Default){return(function sa(){return vs}()||so)(le(a),l)}function Wi(a,l=Bt.Default){return En(a,ir(l))}function ir(a){return typeof a>"u"||"number"==typeof a?a:0|(a.optional&&8)|(a.host&&1)|(a.self&&2)|(a.skipSelf&&4)}function ns(a){const l=[];for(let u=0;u<a.length;u++){const f=le(a[u]);if(Array.isArray(f)){if(0===f.length)throw new Se(900,!1);let p,_=Bt.Default;for(let w=0;w<f.length;w++){const I=f[w],S=bs(I);"number"==typeof S?-1===S?p=I.token:_|=S:p=I}l.push(En(p,_))}else l.push(En(f))}return l}function Ki(a,l){return a[ui]=l,a.prototype[ui]=l,a}function bs(a){return a[ui]}function Z(a){return{toString:a}.toString()}var $=(()=>(($=$||{})[$.OnPush=0]="OnPush",$[$.Default=1]="Default",$))(),j=(()=>{return(a=j||(j={}))[a.Emulated=0]="Emulated",a[a.None=2]="None",a[a.ShadowDom=3]="ShadowDom",j;var a})();const U={},ie=[],Re=ue({\u0275cmp:ue}),ut=ue({\u0275dir:ue}),tn=ue({\u0275pipe:ue}),Yt=ue({\u0275mod:ue}),dn=ue({\u0275fac:ue}),Ut=ue({__NG_ELEMENT_ID__:ue});let qn=0;function On(a){return Z(()=>{const l=Pr(a),u={...l,decls:a.decls,vars:a.vars,template:a.template,consts:a.consts||null,ngContentSelectors:a.ngContentSelectors,onPush:a.changeDetection===$.OnPush,directiveDefs:null,pipeDefs:null,dependencies:l.standalone&&a.dependencies||null,getStandaloneInjector:null,data:a.data||{},encapsulation:a.encapsulation||j.Emulated,id:"c"+qn++,styles:a.styles||ie,_:null,schemas:a.schemas||null,tView:null};oo(u);const f=a.dependencies;return u.directiveDefs=$a(f,!1),u.pipeDefs=$a(f,!0),u})}function is(a){return Lt(a)||Rn(a)}function xe(a){return null!==a}function fe(a){return Z(()=>({type:a.type,bootstrap:a.bootstrap||ie,declarations:a.declarations||ie,imports:a.imports||ie,exports:a.exports||ie,transitiveCompileScopes:null,schemas:a.schemas||null,id:a.id||null}))}function Tt(a,l){if(null==a)return U;const u={};for(const f in a)if(a.hasOwnProperty(f)){let p=a[f],_=p;Array.isArray(p)&&(_=p[1],p=p[0]),u[p]=f,l&&(l[p]=_)}return u}function It(a){return Z(()=>{const l=Pr(a);return oo(l),l})}function $t(a){return{type:a.type,name:a.name,factory:null,pure:!1!==a.pure,standalone:!0===a.standalone,onDestroy:a.type.prototype.ngOnDestroy||null}}function Lt(a){return a[Re]||null}function Rn(a){return a[ut]||null}function kn(a){return a[tn]||null}function Xe(a){const l=Lt(a)||Rn(a)||kn(a);return null!==l&&l.standalone}function ei(a,l){const u=a[Yt]||null;if(!u&&!0===l)throw new Error(`Type ${Le(a)} does not have '\u0275mod' property.`);return u}function Pr(a){const l={};return{type:a.type,providersResolver:null,factory:null,hostBindings:a.hostBindings||null,hostVars:a.hostVars||0,hostAttrs:a.hostAttrs||null,contentQueries:a.contentQueries||null,declaredInputs:l,exportAs:a.exportAs||null,standalone:!0===a.standalone,selectors:a.selectors||ie,viewQuery:a.viewQuery||null,features:a.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Tt(a.inputs,l),outputs:Tt(a.outputs)}}function oo(a){a.features?.forEach(l=>l(a))}function $a(a,l){if(!a)return null;const u=l?kn:is;return()=>("function"==typeof a?a():a).map(f=>u(f)).filter(xe)}const rs=0,vt=1,yn=2,ii=3,Nr=4,ao=5,Tr=6,aa=7,hn=8,oi=9,Es=10,en=11,wl=12,la=13,Po=14,Ha=15,rr=16,El=17,ss=18,js=19,ca=20,ja=21,ti=22,Ts=1,Ir=2,pc=7,xl=8,Is=9,pr=10;function Sr(a){return Array.isArray(a)&&"object"==typeof a[Ts]}function Gs(a){return Array.isArray(a)&&!0===a[Ts]}function ua(a){return 0!=(4&a.flags)}function os(a){return a.componentOffset>-1}function zs(a){return 1==(1&a.flags)}function Ss(a){return!!a.template}function lo(a){return 0!=(256&a[yn])}function da(a,l){return a.hasOwnProperty(dn)?a[dn]:null}class Jf{constructor(l,u,f){this.previousValue=l,this.currentValue=u,this.firstChange=f}isFirstChange(){return this.firstChange}}function Rd(){return xu}function xu(a){return a.type.prototype.ngOnChanges&&(a.setInput=Tl),em}function em(){const a=tm(this),l=a?.current;if(l){const u=a.previous;if(u===U)a.previous=l;else for(let f in l)u[f]=l[f];a.current=null,this.ngOnChanges(l)}}function Tl(a,l,u,f){const p=this.declaredInputs[u],_=tm(a)||function nm(a,l){return a[vc]=l}(a,{previous:U,current:null}),w=_.current||(_.current={}),I=_.previous,S=I[p];w[p]=new Jf(S&&S.currentValue,l,I===U),a[f]=l}Rd.ngInherit=!0;const vc="__ngSimpleChanges__";function tm(a){return a[vc]||null}const Pi=function(a,l,u){},bc="svg";function In(a){for(;Array.isArray(a);)a=a[rs];return a}function za(a,l){return In(l[a])}function gr(a,l){return In(l[a.index])}function Iu(a,l){return a.data[l]}function jr(a,l){return a[l]}function sr(a,l){const u=l[a];return Sr(u)?u:u[rs]}function Cs(a){return 64==(64&a[yn])}function Bo(a,l){return null==l?null:a[l]}function Ec(a){a[ss]=0}function Wa(a,l){a[ao]+=l;let u=a,f=a[ii];for(;null!==f&&(1===l&&1===u[ao]||-1===l&&0===u[ao]);)f[ao]+=l,u=f,f=f[ii]}const nn={lFrame:jd(null),bindingsEnabled:!0};function Cu(){return nn.bindingsEnabled}function De(){return nn.lFrame.lView}function fn(){return nn.lFrame.tView}function Fd(a){return nn.lFrame.contextLView=a,a[hn]}function Bd(a){return nn.lFrame.contextLView=null,a}function or(){let a=Ud();for(;null!==a&&64===a.type;)a=a.parent;return a}function Ud(){return nn.lFrame.currentTNode}function ar(a,l){const u=nn.lFrame;u.currentTNode=a,u.isParent=l}function Du(){return nn.lFrame.isParent}function Au(){nn.lFrame.isParent=!1}function fi(){const a=nn.lFrame;let l=a.bindingRootIndex;return-1===l&&(l=a.bindingRootIndex=a.tView.bindingStartIndex),l}function Rl(){return nn.lFrame.bindingIndex++}function co(a){const l=nn.lFrame,u=l.bindingIndex;return l.bindingIndex=l.bindingIndex+a,u}function kl(a,l){const u=nn.lFrame;u.bindingIndex=u.bindingRootIndex=a,As(l)}function As(a){nn.lFrame.currentDirectiveIndex=a}function as(a){const l=nn.lFrame.currentDirectiveIndex;return-1===l?null:a[l]}function Tc(){return nn.lFrame.currentQueryIndex}function Cr(a){nn.lFrame.currentQueryIndex=a}function rm(a){const l=a[vt];return 2===l.type?l.declTNode:1===l.type?a[Tr]:null}function $d(a,l,u){if(u&Bt.SkipSelf){let p=l,_=a;for(;!(p=p.parent,null!==p||u&Bt.Host||(p=rm(_),null===p||(_=_[Ha],10&p.type))););if(null===p)return!1;l=p,a=_}const f=nn.lFrame=Hd();return f.currentTNode=l,f.lView=a,!0}function Ml(a){const l=Hd(),u=a[vt];nn.lFrame=l,l.currentTNode=u.firstChild,l.lView=a,l.tView=u,l.contextLView=a,l.bindingIndex=u.bindingStartIndex,l.inI18n=!1}function Hd(){const a=nn.lFrame,l=null===a?null:a.child;return null===l?jd(a):l}function jd(a){const l={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:a,child:null,inI18n:!1};return null!==a&&(a.child=l),l}function sm(){const a=nn.lFrame;return nn.lFrame=a.parent,a.currentTNode=null,a.lView=null,a}const uo=sm;function ha(){const a=sm();a.isParent=!0,a.tView=null,a.selectedIndex=-1,a.contextLView=null,a.elementDepthCount=0,a.currentDirectiveIndex=-1,a.currentNamespace=null,a.bindingRootIndex=-1,a.bindingIndex=-1,a.currentQueryIndex=0}function Si(){return nn.lFrame.selectedIndex}function Uo(a){nn.lFrame.selectedIndex=a}function ai(){const a=nn.lFrame;return Iu(a.tView,a.selectedIndex)}function om(){nn.lFrame.currentNamespace=bc}function Ll(){!function zd(){nn.lFrame.currentNamespace=null}()}function Ol(a,l){for(let u=l.directiveStart,f=l.directiveEnd;u<f;u++){const _=a.data[u].type.prototype,{ngAfterContentInit:w,ngAfterContentChecked:I,ngAfterViewInit:S,ngAfterViewChecked:M,ngOnDestroy:B}=_;w&&(a.contentHooks??(a.contentHooks=[])).push(-u,w),I&&((a.contentHooks??(a.contentHooks=[])).push(u,I),(a.contentCheckHooks??(a.contentCheckHooks=[])).push(u,I)),S&&(a.viewHooks??(a.viewHooks=[])).push(-u,S),M&&((a.viewHooks??(a.viewHooks=[])).push(u,M),(a.viewCheckHooks??(a.viewCheckHooks=[])).push(u,M)),null!=B&&(a.destroyHooks??(a.destroyHooks=[])).push(u,B)}}function Sc(a,l,u){Pl(a,l,3,u)}function Mu(a,l,u,f){(3&a[yn])===u&&Pl(a,l,u,f)}function Cc(a,l){let u=a[yn];(3&u)===l&&(u&=2047,u+=1,a[yn]=u)}function Pl(a,l,u,f){const _=f??-1,w=l.length-1;let I=0;for(let S=void 0!==f?65535&a[ss]:0;S<w;S++)if("number"==typeof l[S+1]){if(I=l[S],null!=f&&I>=f)break}else l[S]<0&&(a[ss]+=65536),(I<_||-1==_)&&(Nl(a,u,l,S),a[ss]=(4294901760&a[ss])+S+2),S++}function Nl(a,l,u,f){const p=u[f]<0,_=u[f+1],I=a[p?-u[f]:u[f]];if(p){if(a[yn]>>11<a[ss]>>16&&(3&a[yn])===l){a[yn]+=2048,Pi(4,I,_);try{_.call(I)}finally{Pi(5,I,_)}}}else{Pi(4,I,_);try{_.call(I)}finally{Pi(5,I,_)}}}const ma=-1;class Vo{constructor(l,u,f){this.factory=l,this.resolving=!1,this.canSeeViewProviders=u,this.injectImpl=f}}function Ka(a,l,u){let f=0;for(;f<u.length;){const p=u[f];if("number"==typeof p){if(0!==p)break;f++;const _=u[f++],w=u[f++],I=u[f++];a.setAttribute(l,w,I,_)}else{const _=p,w=u[++f];$o(_)?a.setProperty(l,_,w):a.setAttribute(l,_,w),f++}}return f}function Pu(a){return 3===a||4===a||6===a}function $o(a){return 64===a.charCodeAt(0)}function pa(a,l){if(null!==l&&0!==l.length)if(null===a||0===a.length)a=l.slice();else{let u=-1;for(let f=0;f<l.length;f++){const p=l[f];"number"==typeof p?u=p:0===u||ho(a,u,p,null,-1===u||2===u?l[++f]:null)}}return a}function ho(a,l,u,f,p){let _=0,w=a.length;if(-1===l)w=-1;else for(;_<a.length;){const I=a[_++];if("number"==typeof I){if(I===l){w=-1;break}if(I>l){w=_-1;break}}}for(;_<a.length;){const I=a[_];if("number"==typeof I)break;if(I===u){if(null===f)return void(null!==p&&(a[_+1]=p));if(f===a[_+1])return void(a[_+2]=p)}_++,null!==f&&_++,null!==p&&_++}-1!==w&&(a.splice(w,0,l),_=w+1),a.splice(_++,0,u),null!==f&&a.splice(_++,0,f),null!==p&&a.splice(_++,0,p)}function Fl(a){return a!==ma}function Bl(a){return 32767&a}function Ac(a,l){let u=function um(a){return a>>16}(a),f=l;for(;u>0;)f=f[Ha],u--;return f}let Rc=!0;function qa(a){const l=Rc;return Rc=a,l}const dm=255,Nu=5;let Fu=0;const ls={};function qd(a,l){const u=hm(a,l);if(-1!==u)return u;const f=l[vt];f.firstCreatePass&&(a.injectorIndex=l.length,Yd(f.data,a),Yd(l,null),Yd(f.blueprint,null));const p=Ho(a,l),_=a.injectorIndex;if(Fl(p)){const w=Bl(p),I=Ac(p,l),S=I[vt].data;for(let M=0;M<8;M++)l[_+M]=I[w+M]|S[w+M]}return l[_+8]=p,_}function Yd(a,l){a.push(0,0,0,0,0,0,0,0,l)}function hm(a,l){return-1===a.injectorIndex||a.parent&&a.parent.injectorIndex===a.injectorIndex||null===l[a.injectorIndex+8]?-1:a.injectorIndex}function Ho(a,l){if(a.parent&&-1!==a.parent.injectorIndex)return a.parent.injectorIndex;let u=0,f=null,p=l;for(;null!==p;){if(f=eh(p),null===f)return ma;if(u++,p=p[Ha],-1!==f.injectorIndex)return f.injectorIndex|u<<16}return ma}function jo(a,l,u){!function Kd(a,l,u){let f;"string"==typeof u?f=u.charCodeAt(0)||0:u.hasOwnProperty(Ut)&&(f=u[Ut]),null==f&&(f=u[Ut]=Fu++);const p=f&dm;l.data[a+(p>>Nu)]|=1<<p}(a,l,u)}function Uu(a,l,u){if(u&Bt.Optional||void 0!==a)return a;at()}function kc(a,l,u,f){if(u&Bt.Optional&&void 0===f&&(f=null),!(u&(Bt.Self|Bt.Host))){const p=a[oi],_=Pn(void 0);try{return p?p.get(l,f,u&Bt.Optional):$r(l,f,u&Bt.Optional)}finally{Pn(_)}}return Uu(f,0,u)}function Zd(a,l,u,f=Bt.Default,p){if(null!==a){if(1024&l[yn]){const w=function Jd(a,l,u,f,p){let _=a,w=l;for(;null!==_&&null!==w&&1024&w[yn]&&!(256&w[yn]);){const I=Vu(_,w,u,f|Bt.Self,ls);if(I!==ls)return I;let S=_.parent;if(!S){const M=w[ja];if(M){const B=M.get(u,ls,f);if(B!==ls)return B}S=eh(w),w=w[Ha]}_=S}return p}(a,l,u,f,ls);if(w!==ls)return w}const _=Vu(a,l,u,f,ls);if(_!==ls)return _}return kc(l,u,f,p)}function Vu(a,l,u,f,p){const _=function fm(a){if("string"==typeof a)return a.charCodeAt(0)||0;const l=a.hasOwnProperty(Ut)?a[Ut]:void 0;return"number"==typeof l?l>=0?l&dm:Xd:l}(u);if("function"==typeof _){if(!$d(l,a,f))return f&Bt.Host?Uu(p,0,f):kc(l,u,f,p);try{const w=_(f);if(null!=w||f&Bt.Optional)return w;at()}finally{uo()}}else if("number"==typeof _){let w=null,I=hm(a,l),S=ma,M=f&Bt.Host?l[rr][Tr]:null;for((-1===I||f&Bt.SkipSelf)&&(S=-1===I?Ho(a,l):l[I+8],S!==ma&&$u(f,!1)?(w=l[vt],I=Bl(S),l=Ac(S,l)):I=-1);-1!==I;){const B=l[vt];if(ga(_,I,B.data)){const K=Qd(I,l,u,w,f,M);if(K!==ls)return K}S=l[I+8],S!==ma&&$u(f,l[vt].data[I+8]===M)&&ga(_,I,l)?(w=B,I=Bl(S),l=Ac(S,l)):I=-1}}return p}function Qd(a,l,u,f,p,_){const w=l[vt],I=w.data[a+8],B=fo(I,w,u,null==f?os(I)&&Rc:f!=w&&0!=(3&I.type),p&Bt.Host&&_===I);return null!==B?mo(l,w,B,I):ls}function fo(a,l,u,f,p){const _=a.providerIndexes,w=l.data,I=1048575&_,S=a.directiveStart,B=_>>20,se=p?I+B:a.directiveEnd;for(let he=f?I:I+B;he<se;he++){const ke=w[he];if(he<S&&u===ke||he>=S&&ke.type===u)return he}if(p){const he=w[S];if(he&&Ss(he)&&he.type===u)return S}return null}function mo(a,l,u,f){let p=a[u];const _=l.data;if(function am(a){return a instanceof Vo}(p)){const w=p;w.resolving&&function Ye(a,l){const u=l?`. Dependency path: ${l.join(" > ")} > ${a}`:"";throw new Se(-200,`Circular dependency in DI detected for ${a}${u}`)}(function st(a){return"function"==typeof a?a.name||a.toString():"object"==typeof a&&null!=a&&"function"==typeof a.type?a.type.name||a.type.toString():qe(a)}(_[u]));const I=qa(w.canSeeViewProviders);w.resolving=!0;const S=w.injectImpl?Pn(w.injectImpl):null;$d(a,f,Bt.Default);try{p=a[u]=w.factory(void 0,_,a,f),l.firstCreatePass&&u>=f.directiveStart&&function fa(a,l,u){const{ngOnChanges:f,ngOnInit:p,ngDoCheck:_}=l.type.prototype;if(f){const w=xu(l);(u.preOrderHooks??(u.preOrderHooks=[])).push(a,w),(u.preOrderCheckHooks??(u.preOrderCheckHooks=[])).push(a,w)}p&&(u.preOrderHooks??(u.preOrderHooks=[])).push(0-a,p),_&&((u.preOrderHooks??(u.preOrderHooks=[])).push(a,_),(u.preOrderCheckHooks??(u.preOrderCheckHooks=[])).push(a,_))}(u,_[u],l)}finally{null!==S&&Pn(S),qa(I),w.resolving=!1,uo()}}return p}function ga(a,l,u){return!!(u[l+(a>>Nu)]&1<<a)}function $u(a,l){return!(a&Bt.Self||a&Bt.Host&&l)}class _a{constructor(l,u){this._tNode=l,this._lView=u}get(l,u,f){return Zd(this._tNode,this._lView,l,ir(f),u)}}function Xd(){return new _a(or(),De())}function Hu(a){return Z(()=>{const l=a.prototype.constructor,u=l[dn]||Ya(l),f=Object.prototype;let p=Object.getPrototypeOf(a.prototype).constructor;for(;p&&p!==f;){const _=p[dn]||Ya(p);if(_&&_!==u)return _;p=Object.getPrototypeOf(p)}return _=>new _})}function Ya(a){return tt(a)?()=>{const l=Ya(le(a));return l&&l()}:da(a)}function eh(a){const l=a[vt],u=l.type;return 2===u?l.declTNode:1===u?a[Tr]:null}function Za(a){return function Bu(a,l){if("class"===l)return a.classes;if("style"===l)return a.styles;const u=a.attrs;if(u){const f=u.length;let p=0;for(;p<f;){const _=u[p];if(Pu(_))break;if(0===_)p+=2;else if("number"==typeof _)for(p++;p<f&&"string"==typeof u[p];)p++;else{if(_===l)return u[p+1];p+=2}}}return null}(or(),a)}const po="__parameters__";function Qa(a,l,u){return Z(()=>{const f=function Dn(a){return function(...u){if(a){const f=a(...u);for(const p in f)this[p]=f[p]}}}(l);function p(..._){if(this instanceof p)return f.apply(this,_),this;const w=new p(..._);return I.annotation=w,I;function I(S,M,B){const K=S.hasOwnProperty(po)?S[po]:Object.defineProperty(S,po,{value:[]})[po];for(;K.length<=B;)K.push(null);return(K[B]=K[B]||[]).push(w),S}}return u&&(p.prototype=Object.create(u.prototype)),p.prototype.ngMetadataName=a,p.annotationCls=p,p})}class Ln{constructor(l,u){this._desc=l,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof u?this.__NG_ELEMENT_ID__=u:void 0!==u&&(this.\u0275prov=Dt({token:this,providedIn:u.providedIn||"root",factory:u.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function va(a,l){a.forEach(u=>Array.isArray(u)?va(u,l):l(u))}function _m(a,l,u){l>=a.length?a.push(u):a.splice(l,0,u)}function Vl(a,l){return l>=a.length-1?a.pop():a.splice(l,1)[0]}function Pc(a,l){const u=[];for(let f=0;f<a;f++)u.push(l);return u}function cs(a,l,u){let f=Fr(a,l);return f>=0?a[1|f]=u:(f=~f,function Nc(a,l,u,f){let p=a.length;if(p==l)a.push(u,f);else if(1===p)a.push(f,a[0]),a[0]=u;else{for(p--,a.push(a[p-1],a[p]);p>l;)a[p]=a[p-2],p--;a[l]=u,a[l+1]=f}}(a,f,l,u)),f}function Wn(a,l){const u=Fr(a,l);if(u>=0)return a[1|u]}function Fr(a,l){return function Yn(a,l,u){let f=0,p=a.length>>u;for(;p!==f;){const _=f+(p-f>>1),w=a[_<<u];if(l===w)return _<<u;w>l?p=_:f=_+1}return~(p<<u)}(a,l,1)}const wa=Ki(Qa("Optional"),8),bt=Ki(Qa("SkipSelf"),4);var Zt=(()=>((Zt=Zt||{})[Zt.Important=1]="Important",Zt[Zt.DashCase=2]="DashCase",Zt))();const hh=new Map;let bo=0;const Q="__ngContext__";function ae(a,l){Sr(l)?(a[Q]=l[ca],function fh(a){hh.set(a[ca],a)}(l)):a[Q]=l}let on;function Fi(a,l){return on(a,l)}function Ms(a){const l=a[ii];return Gs(l)?l[ii]:l}function zl(a){return Em(a[la])}function Wl(a){return Em(a[Nr])}function Em(a){for(;null!==a&&!Gs(a);)a=a[Nr];return a}function il(a,l,u,f,p){if(null!=f){let _,w=!1;Gs(f)?_=f:Sr(f)&&(w=!0,f=f[rs]);const I=In(f);0===a&&null!==u?null==p?Wt(l,u,I):kt(l,u,I,p||null,!0):1===a&&null!==u?kt(l,u,I,p||null,!0):2===a?function n0(a,l,u){const f=ur(a,l);f&&function cr(a,l,u,f){a.removeChild(l,u,f)}(a,f,l,u)}(l,I,w):3===a&&l.destroyNode(I),null!=_&&function Cm(a,l,u,f,p){const _=u[pc];_!==In(u)&&il(l,a,f,_,p);for(let I=pr;I<u.length;I++){const S=u[I];Sm(S[vt],S,a,l,f,_)}}(l,a,_,u,p)}}function Tm(a,l,u){return a.createElement(l,u)}function x(a,l){const u=a[Is],f=u.indexOf(l),p=l[ii];512&l[yn]&&(l[yn]&=-513,Wa(p,-1)),u.splice(f,1)}function O(a,l){if(a.length<=pr)return;const u=pr+l,f=a[u];if(f){const p=f[El];null!==p&&p!==a&&x(p,f),l>0&&(a[u-1][Nr]=f[Nr]);const _=Vl(a,pr+l);!function xg(a,l){Sm(a,l,l[en],2,null,null),l[rs]=null,l[Tr]=null}(f[vt],f);const w=_[js];null!==w&&w.detachView(_[vt]),f[ii]=null,f[Nr]=null,f[yn]&=-65}return f}function F(a,l){if(!(128&l[yn])){const u=l[en];u.destroyNode&&Sm(a,l,u,3,null,null),function R(a){let l=a[la];if(!l)return q(a[vt],a);for(;l;){let u=null;if(Sr(l))u=l[la];else{const f=l[pr];f&&(u=f)}if(!u){for(;l&&!l[Nr]&&l!==a;)Sr(l)&&q(l[vt],l),l=l[ii];null===l&&(l=a),Sr(l)&&q(l[vt],l),u=l&&l[Nr]}l=u}}(l)}}function q(a,l){if(!(128&l[yn])){l[yn]&=-65,l[yn]|=128,function me(a,l){let u;if(null!=a&&null!=(u=a.destroyHooks))for(let f=0;f<u.length;f+=2){const p=l[u[f]];if(!(p instanceof Vo)){const _=u[f+1];if(Array.isArray(_))for(let w=0;w<_.length;w+=2){const I=p[_[w]],S=_[w+1];Pi(4,I,S);try{S.call(I)}finally{Pi(5,I,S)}}else{Pi(4,p,_);try{_.call(p)}finally{Pi(5,p,_)}}}}}(a,l),function re(a,l){const u=a.cleanup,f=l[aa];let p=-1;if(null!==u)for(let _=0;_<u.length-1;_+=2)if("string"==typeof u[_]){const w=u[_+3];w>=0?f[p=w]():f[p=-w].unsubscribe(),_+=2}else{const w=f[p=u[_+1]];u[_].call(w)}if(null!==f){for(let _=p+1;_<f.length;_++)(0,f[_])();l[aa]=null}}(a,l),1===l[vt].type&&l[en].destroy();const u=l[El];if(null!==u&&Gs(l[ii])){u!==l[ii]&&x(u,l);const f=l[js];null!==f&&f.detachView(a)}!function wg(a){hh.delete(a[ca])}(l)}}function Fe(a,l,u){return function Ht(a,l,u){let f=l;for(;null!==f&&40&f.type;)f=(l=f).parent;if(null===f)return u[rs];{const{componentOffset:p}=f;if(p>-1){const{encapsulation:_}=a.data[f.directiveStart+p];if(_===j.None||_===j.Emulated)return null}return gr(f,u)}}(a,l.parent,u)}function kt(a,l,u,f,p){a.insertBefore(l,u,f,p)}function Wt(a,l,u){a.appendChild(l,u)}function Nn(a,l,u,f,p){null!==f?kt(a,l,u,f,p):Wt(a,l,u)}function ur(a,l){return a.parentNode(l)}function ph(a,l,u){return rl(a,l,u)}let gh,Yu,o0,Tg,rl=function qu(a,l,u){return 40&a.type?gr(a,u):null};function qc(a,l,u,f){const p=Fe(a,f,l),_=l[en],I=ph(f.parent||l[Tr],f,l);if(null!=p)if(Array.isArray(u))for(let S=0;S<u.length;S++)Nn(_,p,u[S],I,!1);else Nn(_,p,u,I,!1);void 0!==gh&&gh(_,f,l,u,p)}function yh(a,l){if(null!==l){const u=l.type;if(3&u)return gr(l,a);if(4&u)return sl(-1,a[l.index]);if(8&u){const f=l.child;if(null!==f)return yh(a,f);{const p=a[l.index];return Gs(p)?sl(-1,p):In(p)}}if(32&u)return Fi(l,a)()||In(a[l.index]);{const f=Yc(a,l);return null!==f?Array.isArray(f)?f[0]:yh(Ms(a[rr]),f):yh(a,l.next)}}return null}function Yc(a,l){return null!==l?a[rr][Tr].projection[l.projection]:null}function sl(a,l){const u=pr+a+1;if(u<l.length){const f=l[u],p=f[vt].firstChild;if(null!==p)return yh(f,p)}return l[pc]}function Im(a,l,u,f,p,_,w){for(;null!=u;){const I=f[u.index],S=u.type;if(w&&0===l&&(I&&ae(In(I),f),u.flags|=2),32!=(32&u.flags))if(8&S)Im(a,l,u.child,f,p,_,!1),il(l,a,p,I,_);else if(32&S){const M=Fi(u,f);let B;for(;B=M();)il(l,a,p,B,_);il(l,a,p,I,_)}else 16&S?r0(a,l,f,u,p,_):il(l,a,p,I,_);u=w?u.projectionNext:u.next}}function Sm(a,l,u,f,p,_){Im(u,f,a.firstChild,l,p,_,!1)}function r0(a,l,u,f,p,_){const w=u[rr],S=w[Tr].projection[f.projection];if(Array.isArray(S))for(let M=0;M<S.length;M++)il(l,a,p,S[M],_);else Im(a,l,S,w[ii],p,_,!0)}function Zc(a,l,u){""===u?a.removeAttribute(l,"class"):a.setAttribute(l,"class",u)}function Dm(a,l,u){const{mergedAttrs:f,classes:p,styles:_}=u;null!==f&&Ka(a,l,f),null!==p&&Zc(a,l,p),null!==_&&function s0(a,l,u){a.setAttribute(l,"style",u)}(a,l,_)}function vh(a){return function Am(){if(void 0===Yu&&(Yu=null,ni.trustedTypes))try{Yu=ni.trustedTypes.createPolicy("angular",{createHTML:a=>a,createScript:a=>a,createScriptURL:a=>a})}catch{}return Yu}()?.createHTML(a)||a}function ZC(a){o0=a}function CE(a){return function a0(){if(void 0===Tg&&(Tg=null,ni.trustedTypes))try{Tg=ni.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:a=>a,createScript:a=>a,createScriptURL:a=>a})}catch{}return Tg}()?.createScriptURL(a)||a}class Zu{constructor(l){this.changingThisBreaksApplicationSecurity=l}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Et})`}}class QC extends Zu{getTypeName(){return"HTML"}}class XC extends Zu{getTypeName(){return"Style"}}class JC extends Zu{getTypeName(){return"Script"}}class DE extends Zu{getTypeName(){return"URL"}}class c0 extends Zu{getTypeName(){return"ResourceURL"}}function Ia(a){return a instanceof Zu?a.changingThisBreaksApplicationSecurity:a}function Zs(a,l){const u=function bh(a){return a instanceof Zu&&a.getTypeName()||null}(a);if(null!=u&&u!==l){if("ResourceURL"===u&&"URL"===l)return!0;throw new Error(`Required a safe ${l}, got a ${u} (see ${Et})`)}return u===l}function AE(a){return new QC(a)}function RE(a){return new XC(a)}function eD(a){return new JC(a)}function Qu(a){return new DE(a)}function kE(a){return new c0(a)}class Ig{constructor(l){this.inertDocumentHelper=l}getInertBodyElement(l){l="<body><remove></remove>"+l;try{const u=(new window.DOMParser).parseFromString(vh(l),"text/html").body;return null===u?this.inertDocumentHelper.getInertBodyElement(l):(u.removeChild(u.firstChild),u)}catch{return null}}}class LE{constructor(l){this.defaultDoc=l,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(l){const u=this.inertDocument.createElement("template");return u.innerHTML=vh(l),u}}const OE=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function wh(a){return(a=String(a)).match(OE)?a:"unsafe:"+a}function Sa(a){const l={};for(const u of a.split(","))l[u]=!0;return l}function Rm(...a){const l={};for(const u of a)for(const f in u)u.hasOwnProperty(f)&&(l[f]=!0);return l}const Eh=Sa("area,br,col,hr,img,wbr"),PE=Sa("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),NE=Sa("rp,rt"),Sg=Rm(Eh,Rm(PE,Sa("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Rm(NE,Sa("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Rm(NE,PE)),Cg=Sa("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),km=Rm(Cg,Sa("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Sa("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Ag=Sa("script,style,template");class iD{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(l){let u=l.firstChild,f=!0;for(;u;)if(u.nodeType===Node.ELEMENT_NODE?f=this.startElement(u):u.nodeType===Node.TEXT_NODE?this.chars(u.nodeValue):this.sanitizedSomething=!0,f&&u.firstChild)u=u.firstChild;else for(;u;){u.nodeType===Node.ELEMENT_NODE&&this.endElement(u);let p=this.checkClobberedElement(u,u.nextSibling);if(p){u=p;break}u=this.checkClobberedElement(u,u.parentNode)}return this.buf.join("")}startElement(l){const u=l.nodeName.toLowerCase();if(!Sg.hasOwnProperty(u))return this.sanitizedSomething=!0,!Ag.hasOwnProperty(u);this.buf.push("<"),this.buf.push(u);const f=l.attributes;for(let p=0;p<f.length;p++){const _=f.item(p),w=_.name,I=w.toLowerCase();if(!km.hasOwnProperty(I)){this.sanitizedSomething=!0;continue}let S=_.value;Cg[I]&&(S=wh(S)),this.buf.push(" ",w,'="',h0(S),'"')}return this.buf.push(">"),!0}endElement(l){const u=l.nodeName.toLowerCase();Sg.hasOwnProperty(u)&&!Eh.hasOwnProperty(u)&&(this.buf.push("</"),this.buf.push(u),this.buf.push(">"))}chars(l){this.buf.push(h0(l))}checkClobberedElement(l,u){if(u&&(l.compareDocumentPosition(u)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${l.outerHTML}`);return u}}const rD=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,d0=/([^\#-~ |!])/g;function h0(a){return a.replace(/&/g,"&amp;").replace(rD,function(l){return"&#"+(1024*(l.charCodeAt(0)-55296)+(l.charCodeAt(1)-56320)+65536)+";"}).replace(d0,function(l){return"&#"+l.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let f0;function sD(a,l){let u=null;try{f0=f0||function ME(a){const l=new LE(a);return function u0(){try{return!!(new window.DOMParser).parseFromString(vh(""),"text/html")}catch{return!1}}()?new Ig(l):l}(a);let f=l?String(l):"";u=f0.getInertBodyElement(f);let p=5,_=f;do{if(0===p)throw new Error("Failed to sanitize html because the input is unstable");p--,f=_,_=u.innerHTML,u=f0.getInertBodyElement(f)}while(f!==_);return vh((new iD).sanitizeChildren(BE(u)||u))}finally{if(u){const f=BE(u)||u;for(;f.firstChild;)f.removeChild(f.firstChild)}}}function BE(a){return"content"in a&&function EL(a){return a.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===a.nodeName}(a)?a.content:null}var Bi=(()=>((Bi=Bi||{})[Bi.NONE=0]="NONE",Bi[Bi.HTML=1]="HTML",Bi[Bi.STYLE=2]="STYLE",Bi[Bi.SCRIPT=3]="SCRIPT",Bi[Bi.URL=4]="URL",Bi[Bi.RESOURCE_URL=5]="RESOURCE_URL",Bi))();function m0(a){const l=Lm();return l?l.sanitize(Bi.URL,a)||"":Zs(a,"URL")?Ia(a):wh(qe(a))}function Rg(a){const l=Lm();if(l)return CE(l.sanitize(Bi.RESOURCE_URL,a)||"");if(Zs(a,"ResourceURL"))return CE(Ia(a));throw new Se(904,!1)}function VE(a,l,u){return function lD(a,l){return"src"===l&&("embed"===a||"frame"===a||"iframe"===a||"media"===a||"script"===a)||"href"===l&&("base"===a||"link"===a)?Rg:m0}(l,u)(a)}function Lm(){const a=De();return a&&a[wl]}const g0=new Ln("ENVIRONMENT_INITIALIZER"),Xu=new Ln("INJECTOR",-1),xh=new Ln("INJECTOR_DEF_TYPES");class $E{get(l,u=nr){if(u===nr){const f=new Error(`NullInjectorError: No provider for ${Le(l)}!`);throw f.name="NullInjectorError",f}return u}}function Om(...a){return{\u0275providers:Th(0,a),\u0275fromNgModule:!0}}function Th(a,...l){const u=[],f=new Set;let p;return va(l,_=>{const w=_;_0(w,u,[],f)&&(p||(p=[]),p.push(w))}),void 0!==p&&HE(p,u),u}function HE(a,l){for(let u=0;u<a.length;u++){const{providers:p}=a[u];y0(p,_=>{l.push(_)})}}function _0(a,l,u,f){if(!(a=le(a)))return!1;let p=null,_=Li(a);const w=!_&&Lt(a);if(_||w){if(w&&!w.standalone)return!1;p=a}else{const S=a.ngModule;if(_=Li(S),!_)return!1;p=S}const I=f.has(p);if(w){if(I)return!1;if(f.add(p),w.dependencies){const S="function"==typeof w.dependencies?w.dependencies():w.dependencies;for(const M of S)_0(M,l,u,f)}}else{if(!_)return!1;{if(null!=_.imports&&!I){let M;f.add(p);try{va(_.imports,B=>{_0(B,l,u,f)&&(M||(M=[]),M.push(B))})}finally{}void 0!==M&&HE(M,l)}if(!I){const M=da(p)||(()=>new p);l.push({provide:p,useFactory:M,deps:ie},{provide:xh,useValue:p,multi:!0},{provide:g0,useValue:()=>En(p),multi:!0})}const S=_.providers;null==S||I||y0(S,B=>{l.push(B)})}}return p!==a&&void 0!==a.providers}function y0(a,l){for(let u of a)Ue(u)&&(u=u.\u0275providers),Array.isArray(u)?y0(u,l):l(u)}const uD=ue({provide:String,useValue:ue});function v0(a){return null!==a&&"object"==typeof a&&uD in a}function ql(a){return"function"==typeof a}const Qc=new Ln("Set Injector scope."),Mg={},hD={};let b0;function Lg(){return void 0===b0&&(b0=new $E),b0}class Ju{}class GE extends Ju{get destroyed(){return this._destroyed}constructor(l,u,f,p){super(),this.parent=u,this.source=f,this.scopes=p,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Sh(l,w=>this.processProvider(w)),this.records.set(Xu,Ih(void 0,this)),p.has("environment")&&this.records.set(Ju,Ih(void 0,this));const _=this.records.get(Qc);null!=_&&"string"==typeof _.value&&this.scopes.add(_.value),this.injectorDefTypes=new Set(this.get(xh.multi,ie,Bt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const l of this._ngOnDestroyHooks)l.ngOnDestroy();for(const l of this._onDestroyHooks)l()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(l){this._onDestroyHooks.push(l)}runInContext(l){this.assertNotDestroyed();const u=sn(this),f=Pn(void 0);try{return l()}finally{sn(u),Pn(f)}}get(l,u=nr,f=Bt.Default){this.assertNotDestroyed(),f=ir(f);const p=sn(this),_=Pn(void 0);try{if(!(f&Bt.SkipSelf)){let I=this.records.get(l);if(void 0===I){const S=function T0(a){return"function"==typeof a||"object"==typeof a&&a instanceof Ln}(l)&&Tn(l);I=S&&this.injectableDefInScope(S)?Ih(w0(l),Mg):null,this.records.set(l,I)}if(null!=I)return this.hydrate(l,I)}return(f&Bt.Self?Lg():this.parent).get(l,u=f&Bt.Optional&&u===nr?null:u)}catch(w){if("NullInjectorError"===w.name){if((w[wi]=w[wi]||[]).unshift(Le(l)),p)throw w;return function ws(a,l,u,f){const p=a[wi];throw l[zn]&&p.unshift(l[zn]),a.message=function ne(a,l,u,f=null){a=a&&"\n"===a.charAt(0)&&a.charAt(1)==oa?a.slice(2):a;let p=Le(l);if(Array.isArray(l))p=l.map(Le).join(" -> ");else if("object"==typeof l){let _=[];for(let w in l)if(l.hasOwnProperty(w)){let I=l[w];_.push(w+":"+("string"==typeof I?JSON.stringify(I):Le(I)))}p=`{${_.join(", ")}}`}return`${u}${f?"("+f+")":""}[${p}]: ${a.replace(zi,"\n  ")}`}("\n"+a.message,p,u,f),a[mr]=p,a[wi]=null,a}(w,l,"R3InjectorError",this.source)}throw w}finally{Pn(_),sn(p)}}resolveInjectorInitializers(){const l=sn(this),u=Pn(void 0);try{const f=this.get(g0.multi,ie,Bt.Self);for(const p of f)p()}finally{sn(l),Pn(u)}}toString(){const l=[],u=this.records;for(const f of u.keys())l.push(Le(f));return`R3Injector[${l.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Se(205,!1)}processProvider(l){let u=ql(l=le(l))?l:le(l&&l.provide);const f=function mD(a){return v0(a)?Ih(void 0,a.useValue):Ih(E0(a),Mg)}(l);if(ql(l)||!0!==l.multi)this.records.get(u);else{let p=this.records.get(u);p||(p=Ih(void 0,Mg,!0),p.factory=()=>ns(p.multi),this.records.set(u,p)),u=l,p.multi.push(l)}this.records.set(u,f)}hydrate(l,u){return u.value===Mg&&(u.value=hD,u.value=u.factory()),"object"==typeof u.value&&u.value&&function zE(a){return null!==a&&"object"==typeof a&&"function"==typeof a.ngOnDestroy}(u.value)&&this._ngOnDestroyHooks.add(u.value),u.value}injectableDefInScope(l){if(!l.providedIn)return!1;const u=le(l.providedIn);return"string"==typeof u?"any"===u||this.scopes.has(u):this.injectorDefTypes.has(u)}}function w0(a){const l=Tn(a),u=null!==l?l.factory:da(a);if(null!==u)return u;if(a instanceof Ln)throw new Se(204,!1);if(a instanceof Function)return function fD(a){const l=a.length;if(l>0)throw Pc(l,"?"),new Se(204,!1);const u=function Mi(a){return a&&(a[gi]||a[tr])||null}(a);return null!==u?()=>u.factory(a):()=>new a}(a);throw new Se(204,!1)}function E0(a,l,u){let f;if(ql(a)){const p=le(a);return da(p)||w0(p)}if(v0(a))f=()=>le(a.useValue);else if(function jE(a){return!(!a||!a.useFactory)}(a))f=()=>a.useFactory(...ns(a.deps||[]));else if(function dD(a){return!(!a||!a.useExisting)}(a))f=()=>En(le(a.useExisting));else{const p=le(a&&(a.useClass||a.provide));if(!function x0(a){return!!a.deps}(a))return da(p)||w0(p);f=()=>new p(...ns(a.deps))}return f}function Ih(a,l,u=!1){return{factory:a,value:l,multi:u?[]:void 0}}function Sh(a,l){for(const u of a)Array.isArray(u)?Sh(u,l):u&&Ue(u)?Sh(u.\u0275providers,l):l(u)}class pD{}class WE{}class qE{resolveComponentFactory(l){throw function gD(a){const l=Error(`No component factory found for ${Le(a)}. Did you add it to @NgModule.entryComponents?`);return l.ngComponent=a,l}(l)}}let Ch=(()=>{class a{}return a.NULL=new qE,a})();function Og(){return Yl(or(),De())}function Yl(a,l){return new Dh(gr(a,l))}let Dh=(()=>{class a{constructor(u){this.nativeElement=u}}return a.__NG_ELEMENT_ID__=Og,a})();function Pm(a){return a instanceof Dh?a.nativeElement:a}class S0{}let _D=(()=>{class a{}return a.__NG_ELEMENT_ID__=()=>function yD(){const a=De(),u=sr(or().index,a);return(Sr(u)?u:a)[en]}(),a})(),vD=(()=>{class a{}return a.\u0275prov=Dt({token:a,providedIn:"root",factory:()=>null}),a})();class YE{constructor(l){this.full=l,this.major=l.split(".")[0],this.minor=l.split(".")[1],this.patch=l.split(".").slice(2).join(".")}}const ZE=new YE("15.2.9"),Pg={},C0="ngOriginalError";function D0(a){return a[C0]}class Nm{constructor(){this._console=console}handleError(l){const u=this._findOriginalError(l);this._console.error("ERROR",l),u&&this._console.error("ORIGINAL ERROR",u)}_findOriginalError(l){let u=l&&D0(l);for(;u&&D0(u);)u=D0(u);return u||null}}function XE(a){return a.ownerDocument.defaultView}function al(a){return a instanceof Function?a():a}function ix(a,l,u){let f=a.length;for(;;){const p=a.indexOf(l,u);if(-1===p)return p;if(0===p||a.charCodeAt(p-1)<=32){const _=l.length;if(p+_===f||a.charCodeAt(p+_)<=32)return p}u=p+1}}const A0="ng-template";function R0(a,l,u){let f=0,p=!0;for(;f<a.length;){let _=a[f++];if("string"==typeof _&&p){const w=a[f++];if(u&&"class"===_&&-1!==ix(w.toLowerCase(),l,0))return!0}else{if(1===_){for(;f<a.length&&"string"==typeof(_=a[f++]);)if(_.toLowerCase()===l)return!0;return!1}"number"==typeof _&&(p=!1)}}return!1}function k0(a){return 4===a.type&&a.value!==A0}function Ah(a,l,u){return l===(4!==a.type||u?a.value:A0)}function M0(a,l,u){let f=4;const p=a.attrs||[],_=function sx(a){for(let l=0;l<a.length;l++)if(Pu(a[l]))return l;return a.length}(p);let w=!1;for(let I=0;I<l.length;I++){const S=l[I];if("number"!=typeof S){if(!w)if(4&f){if(f=2|1&f,""!==S&&!Ah(a,S,u)||""===S&&1===l.length){if(Ca(f))return!1;w=!0}}else{const M=8&f?S:l[++I];if(8&f&&null!==a.attrs){if(!R0(a.attrs,M,u)){if(Ca(f))return!1;w=!0}continue}const K=rx(8&f?"class":S,p,k0(a),u);if(-1===K){if(Ca(f))return!1;w=!0;continue}if(""!==M){let se;se=K>_?"":p[K+1].toLowerCase();const he=8&f?se:null;if(he&&-1!==ix(he,M,0)||2&f&&M!==se){if(Ca(f))return!1;w=!0}}}}else{if(!w&&!Ca(f)&&!Ca(S))return!1;if(w&&Ca(S))continue;w=!1,f=S|1&f}}return Ca(f)||w}function Ca(a){return 0==(1&a)}function rx(a,l,u,f){if(null===l)return-1;let p=0;if(f||!u){let _=!1;for(;p<l.length;){const w=l[p];if(w===a)return p;if(3===w||6===w)_=!0;else{if(1===w||2===w){let I=l[++p];for(;"string"==typeof I;)I=l[++p];continue}if(4===w)break;if(0===w){p+=4;continue}}p+=_?1:2}return-1}return function ox(a,l){let u=a.indexOf(4);if(u>-1)for(u++;u<a.length;){const f=a[u];if("number"==typeof f)return-1;if(f===l)return u;u++}return-1}(l,a)}function Bm(a,l,u=!1){for(let f=0;f<l.length;f++)if(M0(a,l[f],u))return!0;return!1}function ID(a,l){e:for(let u=0;u<l.length;u++){const f=l[u];if(a.length===f.length){for(let p=0;p<a.length;p++)if(a[p]!==f[p])continue e;return!0}}return!1}function ax(a,l){return a?":not("+l.trim()+")":l}function SD(a){let l=a[0],u=1,f=2,p="",_=!1;for(;u<a.length;){let w=a[u];if("string"==typeof w)if(2&f){const I=a[++u];p+="["+w+(I.length>0?'="'+I+'"':"")+"]"}else 8&f?p+="."+w:4&f&&(p+=" "+w);else""!==p&&!Ca(w)&&(l+=ax(_,p),p=""),f=w,_=_||!Ca(f);u++}return""!==p&&(l+=ax(_,p)),l}const mn={};function lx(a){cx(fn(),De(),Si()+a,!1)}function cx(a,l,u,f){if(!f)if(3==(3&l[yn])){const _=a.preOrderCheckHooks;null!==_&&Sc(l,_,u)}else{const _=a.preOrderHooks;null!==_&&Mu(l,_,0,u)}Uo(u)}function dx(a,l=null,u=null,f){const p=O0(a,l,u,f);return p.resolveInjectorInitializers(),p}function O0(a,l=null,u=null,f,p=new Set){const _=[u||ie,Om(a)];return f=f||("object"==typeof a?void 0:Le(a)),new GE(_,l||Lg(),f||null,p)}let Rh=(()=>{class a{static create(u,f){if(Array.isArray(u))return dx({name:""},f,u,"");{const p=u.name??"";return dx({name:p},u.parent,u.providers,p)}}}return a.THROW_IF_NOT_FOUND=nr,a.NULL=new $E,a.\u0275prov=Dt({token:a,providedIn:"any",factory:()=>En(Xu)}),a.__NG_ELEMENT_ID__=-1,a})();function Lh(a,l=Bt.Default){const u=De();return null===u?En(a,l):Zd(or(),u,le(a),l)}function gx(){throw new Error("invalid")}function _x(a,l){const u=a.contentQueries;if(null!==u)for(let f=0;f<u.length;f+=2){const _=u[f+1];if(-1!==_){const w=a.data[_];Cr(u[f]),w.contentQueries(2,l[_],_)}}}function Ug(a,l,u,f,p,_,w,I,S,M,B){const K=l.blueprint.slice();return K[rs]=p,K[yn]=76|f,(null!==B||a&&1024&a[yn])&&(K[yn]|=1024),Ec(K),K[ii]=K[Ha]=a,K[hn]=u,K[Es]=w||a&&a[Es],K[en]=I||a&&a[en],K[wl]=S||a&&a[wl]||null,K[oi]=M||a&&a[oi]||null,K[Tr]=_,K[ca]=function Wu(){return bo++}(),K[ja]=B,K[rr]=2==l.type?a[rr]:K,K}function Hm(a,l,u,f,p){let _=a.data[l];if(null===_)_=function Vg(a,l,u,f,p){const _=Ud(),w=Du(),S=a.data[l]=function an(a,l,u,f,p,_){return{type:u,index:f,insertBeforeIndex:null,injectorIndex:l?l.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:p,attrs:_,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:l,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,w?_:_&&_.parent,u,l,f,p);return null===a.firstChild&&(a.firstChild=S),null!==_&&(w?null==_.child&&null!==S.parent&&(_.child=S):null===_.next&&(_.next=S,S.prev=_)),S}(a,l,u,f,p),function Vd(){return nn.lFrame.inI18n}()&&(_.flags|=32);else if(64&_.type){_.type=u,_.value=f,_.attrs=p;const w=function Cl(){const a=nn.lFrame,l=a.currentTNode;return a.isParent?l:l.parent}();_.injectorIndex=null===w?-1:w.injectorIndex}return ar(_,!0),_}function Te(a,l,u,f){if(0===u)return-1;const p=l.length;for(let _=0;_<u;_++)l.push(f),a.blueprint.push(f),a.data.push(null);return p}function U0(a,l,u){Ml(l);try{const f=a.viewQuery;null!==f&&Wm(1,f,u);const p=a.template;null!==p&&$g(a,l,p,1,u),a.firstCreatePass&&(a.firstCreatePass=!1),a.staticContentQueries&&_x(a,l),a.staticViewQueries&&Wm(2,a.viewQuery,u);const _=a.components;null!==_&&function yx(a,l){for(let u=0;u<l.length;u++)Ex(a,l[u])}(l,_)}catch(f){throw a.firstCreatePass&&(a.incompleteFirstPass=!0,a.firstCreatePass=!1),f}finally{l[yn]&=-5,ha()}}function jm(a,l,u,f){const p=l[yn];if(128!=(128&p)){Ml(l);try{Ec(l),function Ds(a){return nn.lFrame.bindingIndex=a}(a.bindingStartIndex),null!==u&&$g(a,l,u,2,f);const w=3==(3&p);if(w){const M=a.preOrderCheckHooks;null!==M&&Sc(l,M,null)}else{const M=a.preOrderHooks;null!==M&&Mu(l,M,0,null),Cc(l,0)}if(function bx(a){for(let l=zl(a);null!==l;l=Wl(l)){if(!l[Ir])continue;const u=l[Is];for(let f=0;f<u.length;f++){const p=u[f];512&p[yn]||Wa(p[ii],1),p[yn]|=512}}}(l),function Qs(a){for(let l=zl(a);null!==l;l=Wl(l))for(let u=pr;u<l.length;u++){const f=l[u],p=f[vt];Cs(f)&&jm(p,f,p.template,f[hn])}}(l),null!==a.contentQueries&&_x(a,l),w){const M=a.contentCheckHooks;null!==M&&Sc(l,M)}else{const M=a.contentHooks;null!==M&&Mu(l,M,1),Cc(l,1)}!function jD(a,l){const u=a.hostBindingOpCodes;if(null!==u)try{for(let f=0;f<u.length;f++){const p=u[f];if(p<0)Uo(~p);else{const _=p,w=u[++f],I=u[++f];kl(w,_),I(2,l[_])}}}finally{Uo(-1)}}(a,l);const I=a.components;null!==I&&function GD(a,l){for(let u=0;u<l.length;u++)wx(a,l[u])}(l,I);const S=a.viewQuery;if(null!==S&&Wm(2,S,f),w){const M=a.viewCheckHooks;null!==M&&Sc(l,M)}else{const M=a.viewHooks;null!==M&&Mu(l,M,2),Cc(l,2)}!0===a.firstUpdatePass&&(a.firstUpdatePass=!1),l[yn]&=-41,512&l[yn]&&(l[yn]&=-513,Wa(l[ii],-1))}finally{ha()}}}function $g(a,l,u,f,p){const _=Si(),w=2&f;try{Uo(-1),w&&l.length>ti&&cx(a,l,ti,!1),Pi(w?2:0,p),u(f,p)}finally{Uo(_),Pi(w?3:1,p)}}function Hg(a,l,u){if(ua(l)){const p=l.directiveEnd;for(let _=l.directiveStart;_<p;_++){const w=a.data[_];w.contentQueries&&w.contentQueries(1,u[_],_)}}}function hs(a,l,u){Cu()&&(function YD(a,l,u,f){const p=u.directiveStart,_=u.directiveEnd;os(u)&&function K0(a,l,u){const f=gr(l,a),p=vr(u),_=a[Es],w=zm(a,Ug(a,p,null,u.onPush?32:16,f,l,_,_.createRenderer(f,u),null,null,null));a[l.index]=w}(l,u,a.data[p+u.componentOffset]),a.firstCreatePass||qd(u,l),ae(f,l);const w=u.initialInputs;for(let I=p;I<_;I++){const S=a.data[I],M=mo(l,a,I,u);ae(M,l),null!==w&&JD(0,I-p,M,S,0,w),Ss(S)&&(sr(u.index,l)[hn]=mo(l,a,I,u))}}(a,l,u,gr(u,l)),64==(64&u.flags)&&z0(a,l,u))}function V0(a,l,u=gr){const f=l.localNames;if(null!==f){let p=l.index+1;for(let _=0;_<f.length;_+=2){const w=f[_+1],I=-1===w?u(l,a):a[w];a[p++]=I}}}function vr(a){const l=a.tView;return null===l||l.incompleteFirstPass?a.tView=$0(1,null,a.template,a.decls,a.vars,a.directiveDefs,a.pipeDefs,a.viewQuery,a.schemas,a.consts):l}function $0(a,l,u,f,p,_,w,I,S,M){const B=ti+f,K=B+p,se=function zD(a,l){const u=[];for(let f=0;f<l;f++)u.push(f<a?null:mn);return u}(B,K),he="function"==typeof M?M():M;return se[vt]={type:a,blueprint:se,template:u,queries:null,viewQuery:I,declTNode:l,data:se.slice().fill(null,B),bindingStartIndex:B,expandoStartIndex:K,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof _?_():_,pipeRegistry:"function"==typeof w?w():w,firstChild:null,schemas:S,consts:he,incompleteFirstPass:!1}}function N(a,l,u,f){const p=Km(l);null===u?p.push(f):(p.push(u),a.firstCreatePass&&qm(a).push(f,p.length-1))}function Me(a,l,u,f){for(let p in a)if(a.hasOwnProperty(p)){u=null===u?{}:u;const _=a[p];null===f?Xc(u,l,p,_):f.hasOwnProperty(p)&&Xc(u,l,f[p],_)}return u}function Xc(a,l,u,f){a.hasOwnProperty(u)?a[u].push(l,f):a[u]=[l,f]}function Eo(a,l,u,f,p,_,w,I){const S=gr(l,u);let B,M=l.inputs;!I&&null!=M&&(B=M[f])?(Kg(a,u,B,f,p),os(l)&&function WD(a,l){const u=sr(l,a);16&u[yn]||(u[yn]|=32)}(u,l.index)):3&l.type&&(f=function Gm(a){return"class"===a?"className":"for"===a?"htmlFor":"formaction"===a?"formAction":"innerHtml"===a?"innerHTML":"readonly"===a?"readOnly":"tabindex"===a?"tabIndex":a}(f),p=null!=w?w(p,l.value||"",f):p,_.setProperty(S,f,p))}function j0(a,l,u,f){if(Cu()){const p=null===f?null:{"":-1},_=function hi(a,l){const u=a.directiveRegistry;let f=null,p=null;if(u)for(let _=0;_<u.length;_++){const w=u[_];if(Bm(l,w.selectors,!1))if(f||(f=[]),Ss(w))if(null!==w.findHostDirectiveDefs){const I=[];p=p||new Map,w.findHostDirectiveDefs(w,I,p),f.unshift(...I,w),Gg(a,l,I.length)}else f.unshift(w),Gg(a,l,0);else p=p||new Map,w.findHostDirectiveDefs?.(w,f,p),f.push(w)}return null===f?null:[f,p]}(a,u);let w,I;null===_?w=I=null:[w,I]=_,null!==w&&G0(a,l,u,w,p,I),p&&function W0(a,l,u){if(l){const f=a.localNames=[];for(let p=0;p<l.length;p+=2){const _=u[l[p+1]];if(null==_)throw new Se(-301,!1);f.push(l[p],_)}}}(u,f,p)}u.mergedAttrs=pa(u.mergedAttrs,u.attrs)}function G0(a,l,u,f,p,_){for(let M=0;M<f.length;M++)jo(qd(u,l),a,f[M].type);!function QD(a,l,u){a.flags|=1,a.directiveStart=l,a.directiveEnd=l+u,a.providerIndexes=l}(u,a.data.length,f.length);for(let M=0;M<f.length;M++){const B=f[M];B.providersResolver&&B.providersResolver(B)}let w=!1,I=!1,S=Te(a,l,f.length,null);for(let M=0;M<f.length;M++){const B=f[M];u.mergedAttrs=pa(u.mergedAttrs,B.hostAttrs),XD(a,u,l,S,B),ZD(S,B,p),null!==B.contentQueries&&(u.flags|=4),(null!==B.hostBindings||null!==B.hostAttrs||0!==B.hostVars)&&(u.flags|=64);const K=B.type.prototype;!w&&(K.ngOnChanges||K.ngOnInit||K.ngDoCheck)&&((a.preOrderHooks??(a.preOrderHooks=[])).push(u.index),w=!0),!I&&(K.ngOnChanges||K.ngDoCheck)&&((a.preOrderCheckHooks??(a.preOrderCheckHooks=[])).push(u.index),I=!0),S++}!function H0(a,l,u){const p=l.directiveEnd,_=a.data,w=l.attrs,I=[];let S=null,M=null;for(let B=l.directiveStart;B<p;B++){const K=_[B],se=u?u.get(K):null,ke=se?se.outputs:null;S=Me(K.inputs,B,S,se?se.inputs:null),M=Me(K.outputs,B,M,ke);const ot=null===S||null===w||k0(l)?null:vx(S,B,w);I.push(ot)}null!==S&&(S.hasOwnProperty("class")&&(l.flags|=8),S.hasOwnProperty("style")&&(l.flags|=16)),l.initialInputs=I,l.inputs=S,l.outputs=M}(a,u,_)}function z0(a,l,u){const f=u.directiveStart,p=u.directiveEnd,_=u.index,w=function Jy(){return nn.lFrame.currentDirectiveIndex}();try{Uo(_);for(let I=f;I<p;I++){const S=a.data[I],M=l[I];As(I),(null!==S.hostBindings||0!==S.hostVars||null!==S.hostAttrs)&&jg(S,M)}}finally{Uo(-1),As(w)}}function jg(a,l){null!==a.hostBindings&&a.hostBindings(1,l)}function Gg(a,l,u){l.componentOffset=u,(a.components??(a.components=[])).push(l.index)}function ZD(a,l,u){if(u){if(l.exportAs)for(let f=0;f<l.exportAs.length;f++)u[l.exportAs[f]]=a;Ss(l)&&(u[""]=a)}}function XD(a,l,u,f,p){a.data[f]=p;const _=p.factory||(p.factory=da(p.type)),w=new Vo(_,Ss(p),Lh);a.blueprint[f]=w,u[f]=w,function Ui(a,l,u,f,p){const _=p.hostBindings;if(_){let w=a.hostBindingOpCodes;null===w&&(w=a.hostBindingOpCodes=[]);const I=~l.index;(function qD(a){let l=a.length;for(;l>0;){const u=a[--l];if("number"==typeof u&&u<0)return u}return 0})(w)!=I&&w.push(I),w.push(u,f,_)}}(a,l,f,Te(a,u,p.hostVars,mn),p)}function ll(a,l,u,f,p,_){const w=gr(a,l);!function q0(a,l,u,f,p,_,w){if(null==_)a.removeAttribute(l,p,u);else{const I=null==w?qe(_):w(_,f||"",p);a.setAttribute(l,p,I,u)}}(l[en],w,_,a.value,u,f,p)}function JD(a,l,u,f,p,_){const w=_[l];if(null!==w){const I=f.setInput;for(let S=0;S<w.length;){const M=w[S++],B=w[S++],K=w[S++];null!==I?f.setInput(u,K,M,B):u[B]=K}}}function vx(a,l,u){let f=null,p=0;for(;p<u.length;){const _=u[p];if(0!==_)if(5!==_){if("number"==typeof _)break;if(a.hasOwnProperty(_)){null===f&&(f=[]);const w=a[_];for(let I=0;I<w.length;I+=2)if(w[I]===l){f.push(_,w[I+1],u[p+1]);break}}p+=2}else p+=2;else p+=4}return f}function Ai(a,l,u,f){return[a,!0,!1,l,null,0,f,u,null,null]}function wx(a,l){const u=sr(l,a);if(Cs(u)){const f=u[vt];48&u[yn]?jm(f,u,f.template,u[hn]):u[ao]>0&&Y0(u)}}function Y0(a){for(let f=zl(a);null!==f;f=Wl(f))for(let p=pr;p<f.length;p++){const _=f[p];if(Cs(_))if(512&_[yn]){const w=_[vt];jm(w,_,w.template,_[hn])}else _[ao]>0&&Y0(_)}const u=a[vt].components;if(null!==u)for(let f=0;f<u.length;f++){const p=sr(u[f],a);Cs(p)&&p[ao]>0&&Y0(p)}}function Ex(a,l){const u=sr(l,a),f=u[vt];(function Z0(a,l){for(let u=l.length;u<a.blueprint.length;u++)l.push(a.blueprint[u])})(f,u),U0(f,u,u[hn])}function zm(a,l){return a[la]?a[Po][Nr]=l:a[la]=l,a[Po]=l,l}function zg(a){for(;a;){a[yn]|=32;const l=Ms(a);if(lo(a)&&!l)return a;a=l}return null}function Wg(a,l,u,f=!0){const p=l[Es];p.begin&&p.begin();try{jm(a,l,a.template,u)}catch(w){throw f&&Tx(l,w),w}finally{p.end&&p.end()}}function Wm(a,l,u){Cr(0),l(a,u)}function Km(a){return a[aa]||(a[aa]=[])}function qm(a){return a.cleanup||(a.cleanup=[])}function xx(a,l,u){return(null===a||Ss(a))&&(u=function Il(a){for(;Array.isArray(a);){if("object"==typeof a[Ts])return a;a=a[rs]}return null}(u[l.index])),u[en]}function Tx(a,l){const u=a[oi],f=u?u.get(Nm,null):null;f&&f.handleError(l)}function Kg(a,l,u,f,p){for(let _=0;_<u.length;){const w=u[_++],I=u[_++],S=l[w],M=a.data[w];null!==M.setInput?M.setInput(S,p,f,I):S[I]=p}}function Zl(a,l,u){const f=za(l,a);!function xm(a,l,u){a.setValue(l,u)}(a[en],f,u)}function Ym(a,l,u){let f=u?a.styles:null,p=u?a.classes:null,_=0;if(null!==l)for(let w=0;w<l.length;w++){const I=l[w];"number"==typeof I?_=I:1==_?p=Ce(p,I):2==_&&(f=Ce(f,I+": "+l[++w]+";"))}u?a.styles=f:a.stylesWithoutHost=f,u?a.classes=p:a.classesWithoutHost=p}function qg(a,l,u,f,p=!1){for(;null!==u;){const _=l[u.index];if(null!==_&&f.push(In(_)),Gs(_))for(let I=pr;I<_.length;I++){const S=_[I],M=S[vt].firstChild;null!==M&&qg(S[vt],S,M,f)}const w=u.type;if(8&w)qg(a,l,u.child,f);else if(32&w){const I=Fi(u,l);let S;for(;S=I();)f.push(S)}else if(16&w){const I=Yc(l,u);if(Array.isArray(I))f.push(...I);else{const S=Ms(l[rr]);qg(S[vt],S,I,f,!0)}}u=p?u.projectionNext:u.next}return f}class Zm{get rootNodes(){const l=this._lView,u=l[vt];return qg(u,l,u.firstChild,[])}constructor(l,u){this._lView=l,this._cdRefInjectingView=u,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[hn]}set context(l){this._lView[hn]=l}get destroyed(){return 128==(128&this._lView[yn])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const l=this._lView[ii];if(Gs(l)){const u=l[xl],f=u?u.indexOf(this):-1;f>-1&&(O(l,f),Vl(u,f))}this._attachedToViewContainer=!1}F(this._lView[vt],this._lView)}onDestroy(l){N(this._lView[vt],this._lView,null,l)}markForCheck(){zg(this._cdRefInjectingView||this._lView)}detach(){this._lView[yn]&=-65}reattach(){this._lView[yn]|=64}detectChanges(){Wg(this._lView[vt],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Se(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function mh(a,l){Sm(a,l,l[en],2,null,null)}(this._lView[vt],this._lView)}attachToAppRef(l){if(this._attachedToViewContainer)throw new Se(902,!1);this._appRef=l}}class tA extends Zm{constructor(l){super(l),this._view=l}detectChanges(){const l=this._view;Wg(l[vt],l,l[hn],!1)}checkNoChanges(){}get context(){return null}}class Ix extends Ch{constructor(l){super(),this.ngModule=l}resolveComponentFactory(l){const u=Lt(l);return new Qm(u,this.ngModule)}}function Sx(a){const l=[];for(let u in a)a.hasOwnProperty(u)&&l.push({propName:a[u],templateName:u});return l}class Q0{constructor(l,u){this.injector=l,this.parentInjector=u}get(l,u,f){f=ir(f);const p=this.injector.get(l,Pg,f);return p!==Pg||u===Pg?p:this.parentInjector.get(l,u,f)}}class Qm extends WE{get inputs(){return Sx(this.componentDef.inputs)}get outputs(){return Sx(this.componentDef.outputs)}constructor(l,u){super(),this.componentDef=l,this.ngModule=u,this.componentType=l.type,this.selector=function CD(a){return a.map(SD).join(",")}(l.selectors),this.ngContentSelectors=l.ngContentSelectors?l.ngContentSelectors:[],this.isBoundToModule=!!u}create(l,u,f,p){let _=(p=p||this.ngModule)instanceof Ju?p:p?.injector;_&&null!==this.componentDef.getStandaloneInjector&&(_=this.componentDef.getStandaloneInjector(_)||_);const w=_?new Q0(l,_):l,I=w.get(S0,null);if(null===I)throw new Se(407,!1);const S=w.get(vD,null),M=I.createRenderer(null,this.componentDef),B=this.componentDef.selectors[0][0]||"div",K=f?function Jt(a,l,u){return a.selectRootElement(l,u===j.ShadowDom)}(M,f,this.componentDef.encapsulation):Tm(M,B,function cl(a){const l=a.toLowerCase();return"svg"===l?bc:"math"===l?"math":null}(B)),se=this.componentDef.onPush?288:272,he=$0(0,null,null,1,0,null,null,null,null,null),ke=Ug(null,he,null,se,null,null,I,M,S,w,null);let ot,ft;Ml(ke);try{const Ot=this.componentDef;let rn,Ke=null;Ot.findHostDirectiveDefs?(rn=[],Ke=new Map,Ot.findHostDirectiveDefs(Ot,rn,Ke),rn.push(Ot)):rn=[Ot];const gn=function nA(a,l){const u=a[vt],f=ti;return a[f]=l,Hm(u,f,2,"#host",null)}(ke,K),Ti=function Cx(a,l,u,f,p,_,w,I){const S=p[vt];!function qr(a,l,u,f){for(const p of a)l.mergedAttrs=pa(l.mergedAttrs,p.hostAttrs);null!==l.mergedAttrs&&(Ym(l,l.mergedAttrs,!0),null!==u&&Dm(f,u,l))}(f,a,l,w);const M=_.createRenderer(l,u),B=Ug(p,vr(u),null,u.onPush?32:16,p[a.index],a,_,M,I||null,null,null);return S.firstCreatePass&&Gg(S,a,f.length-1),zm(p,B),p[a.index]=B}(gn,K,Ot,rn,ke,I,M);ft=Iu(he,ti),K&&function pn(a,l,u,f){if(f)Ka(a,u,["ng-version",ZE.full]);else{const{attrs:p,classes:_}=function DD(a){const l=[],u=[];let f=1,p=2;for(;f<a.length;){let _=a[f];if("string"==typeof _)2===p?""!==_&&l.push(_,a[++f]):8===p&&u.push(_);else{if(!Ca(p))break;p=_}f++}return{attrs:l,classes:u}}(l.selectors[0]);p&&Ka(a,u,p),_&&_.length>0&&Zc(a,u,_.join(" "))}}(M,Ot,K,f),void 0!==u&&function Ax(a,l,u){const f=a.projection=[];for(let p=0;p<l.length;p++){const _=u[p];f.push(null!=_?Array.from(_):null)}}(ft,this.ngContentSelectors,u),ot=function Dx(a,l,u,f,p,_){const w=or(),I=p[vt],S=gr(w,p);G0(I,p,w,u,null,f);for(let B=0;B<u.length;B++)ae(mo(p,I,w.directiveStart+B,w),p);z0(I,p,w),S&&ae(S,p);const M=mo(p,I,w.directiveStart+w.componentOffset,w);if(a[hn]=p[hn]=M,null!==_)for(const B of _)B(M,l);return Hg(I,w,a),M}(Ti,Ot,rn,Ke,ke,[J0]),U0(he,ke,null)}finally{ha()}return new ul(this.componentType,ot,Yl(ft,ke),ke,ft)}}class ul extends pD{constructor(l,u,f,p,_){super(),this.location=f,this._rootLView=p,this._tNode=_,this.instance=u,this.hostView=this.changeDetectorRef=new tA(p),this.componentType=l}setInput(l,u){const f=this._tNode.inputs;let p;if(null!==f&&(p=f[l])){const _=this._rootLView;Kg(_[vt],_,p,l,u),zg(sr(this._tNode.index,_))}}get injector(){return new _a(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(l){this.hostView.onDestroy(l)}}function J0(){const a=or();Ol(De()[vt],a)}function ev(a){let l=function Bn(a){return Object.getPrototypeOf(a.prototype).constructor}(a.type),u=!0;const f=[a];for(;l;){let p;if(Ss(a))p=l.\u0275cmp||l.\u0275dir;else{if(l.\u0275cmp)throw new Se(903,!1);p=l.\u0275dir}if(p){if(u){f.push(p);const w=a;w.inputs=tv(a.inputs),w.declaredInputs=tv(a.declaredInputs),w.outputs=tv(a.outputs);const I=p.hostBindings;I&&rA(a,I);const S=p.viewQuery,M=p.contentQueries;if(S&&kx(a,S),M&&iA(a,M),Oe(a.inputs,p.inputs),Oe(a.declaredInputs,p.declaredInputs),Oe(a.outputs,p.outputs),Ss(p)&&p.data.animation){const B=a.data;B.animation=(B.animation||[]).concat(p.data.animation)}}const _=p.features;if(_)for(let w=0;w<_.length;w++){const I=_[w];I&&I.ngInherit&&I(a),I===ev&&(u=!1)}}l=Object.getPrototypeOf(l)}!function Rx(a){let l=0,u=null;for(let f=a.length-1;f>=0;f--){const p=a[f];p.hostVars=l+=p.hostVars,p.hostAttrs=pa(p.hostAttrs,u=pa(u,p.hostAttrs))}}(f)}function tv(a){return a===U?{}:a===ie?[]:a}function kx(a,l){const u=a.viewQuery;a.viewQuery=u?(f,p)=>{l(f,p),u(f,p)}:l}function iA(a,l){const u=a.contentQueries;a.contentQueries=u?(f,p,_)=>{l(f,p,_),u(f,p,_)}:l}function rA(a,l){const u=a.hostBindings;a.hostBindings=u?(f,p)=>{l(f,p),u(f,p)}:l}function Yg(a){return!!Ph(a)&&(Array.isArray(a)||!(a instanceof Map)&&Symbol.iterator in a)}function Ph(a){return null!==a&&("function"==typeof a||"object"==typeof a)}function dl(a,l,u){return a[l]=u}function Yr(a,l,u){return!Object.is(a[l],u)&&(a[l]=u,!0)}function rv(a,l,u,f){const p=De();return Yr(p,Rl(),l)&&(fn(),ll(ai(),p,a,l,u,f)),rv}function nd(a,l,u,f,p,_){const I=function br(a,l,u,f){const p=Yr(a,l,u);return Yr(a,l+1,f)||p}(a,function _r(){return nn.lFrame.bindingIndex}(),u,p);return co(2),I?l+qe(u)+f+qe(p)+_:mn}function ln(a,l,u,f,p,_,w,I){const S=De(),M=fn(),B=a+ti,K=M.firstCreatePass?function Qn(a,l,u,f,p,_,w,I,S){const M=l.consts,B=Hm(l,a,4,w||null,Bo(M,I));j0(l,u,B,Bo(M,S)),Ol(l,B);const K=B.tView=$0(2,B,f,p,_,l.directiveRegistry,l.pipeRegistry,null,l.schemas,M);return null!==l.queries&&(l.queries.template(l,B),K.queries=l.queries.embeddedTView(B)),B}(B,M,S,l,u,f,p,_,w):M.data[B];ar(K,!1);const se=S[en].createComment("");qc(M,S,se,K),ae(se,S),zm(S,S[B]=Ai(se,S,se,K)),zs(K)&&hs(M,S,K),null!=w&&V0(S,K,I)}function Zg(a){return jr(function Dl(){return nn.lFrame.contextLView}(),ti+a)}function uv(a,l,u){const f=De();return Yr(f,Rl(),l)&&Eo(fn(),ai(),f,a,l,f[en],u,!1),uv}function Qg(a,l,u,f,p){const w=p?"class":"style";Kg(a,u,l.inputs[w],w,f)}function Xl(a,l,u,f){const p=De(),_=fn(),w=ti+a,I=p[en],S=_.firstCreatePass?function Bx(a,l,u,f,p,_){const w=l.consts,S=Hm(l,a,2,f,Bo(w,p));return j0(l,u,S,Bo(w,_)),null!==S.attrs&&Ym(S,S.attrs,!1),null!==S.mergedAttrs&&Ym(S,S.mergedAttrs,!0),null!==l.queries&&l.queries.elementStart(l,S),S}(w,_,p,l,u,f):_.data[w],M=p[w]=Tm(I,l,function ku(){return nn.lFrame.currentNamespace}()),B=zs(S);return ar(S,!0),Dm(I,M,S),32!=(32&S.flags)&&qc(_,p,M,S),0===function xc(){return nn.lFrame.elementDepthCount}()&&ae(M,p),function Pd(){nn.lFrame.elementDepthCount++}(),B&&(hs(_,p,S),Hg(_,S,p)),null!==f&&V0(p,S),Xl}function $h(){let a=or();Du()?Au():(a=a.parent,ar(a,!1));const l=a;!function Nd(){nn.lFrame.elementDepthCount--}();const u=fn();return u.firstCreatePass&&(Ol(u,a),ua(a)&&u.queries.elementEnd(a)),null!=l.classesWithoutHost&&function lm(a){return 0!=(8&a.flags)}(l)&&Qg(u,l,De(),l.classesWithoutHost,!0),null!=l.stylesWithoutHost&&function cm(a){return 0!=(16&a.flags)}(l)&&Qg(u,l,De(),l.stylesWithoutHost,!1),$h}function dv(a,l,u,f){return Xl(a,l,u,f),$h(),dv}function Jm(){return De()}function ep(a){return!!a&&"function"==typeof a.then}function Ux(a){return!!a&&"function"==typeof a.subscribe}const Vx=Ux;function fv(a,l,u,f){const p=De(),_=fn(),w=or();return $x(_,p,p[en],w,a,l,f),fv}function tp(a,l){const u=or(),f=De(),p=fn();return $x(p,f,xx(as(p.data),u,f),u,a,l),tp}function $x(a,l,u,f,p,_,w){const I=zs(f),M=a.firstCreatePass&&qm(a),B=l[hn],K=Km(l);let se=!0;if(3&f.type||w){const ot=gr(f,l),ft=w?w(ot):ot,Ot=K.length,rn=w?gn=>w(In(gn[f.index])):f.index;let Ke=null;if(!w&&I&&(Ke=function np(a,l,u,f){const p=a.cleanup;if(null!=p)for(let _=0;_<p.length-1;_+=2){const w=p[_];if(w===u&&p[_+1]===f){const I=l[aa],S=p[_+2];return I.length>S?I[S]:null}"string"==typeof w&&(_+=2)}return null}(a,l,p,f.index)),null!==Ke)(Ke.__ngLastListenerFn__||Ke).__ngNextListenerFn__=_,Ke.__ngLastListenerFn__=_,se=!1;else{_=Hh(f,l,B,_,!1);const gn=u.listen(ft,p,_);K.push(_,gn),M&&M.push(p,rn,Ot,Ot+1)}}else _=Hh(f,l,B,_,!1);const he=f.outputs;let ke;if(se&&null!==he&&(ke=he[p])){const ot=ke.length;if(ot)for(let ft=0;ft<ot;ft+=2){const Ti=l[ke[ft]][ke[ft+1]].subscribe(_),Qi=K.length;K.push(_,Ti),M&&M.push(p,f.index,Qi,-(Qi+1))}}}function mv(a,l,u,f){try{return Pi(6,l,u),!1!==u(f)}catch(p){return Tx(a,p),!1}finally{Pi(7,l,u)}}function Hh(a,l,u,f,p){return function _(w){if(w===Function)return f;zg(a.componentOffset>-1?sr(a.index,l):l);let S=mv(l,u,f,w),M=_.__ngNextListenerFn__;for(;M;)S=mv(l,u,M,w)&&S,M=M.__ngNextListenerFn__;return p&&!1===S&&(w.preventDefault(),w.returnValue=!1),S}}function Jg(a=1){return function Ic(a){return(nn.lFrame.contextLView=function Gd(a,l){for(;a>0;)l=l[Ha],a--;return l}(a,nn.lFrame.contextLView))[hn]}(a)}function Hx(a,l){let u=null;const f=function Ng(a){const l=a.attrs;if(null!=l){const u=l.indexOf(5);if(!(1&u))return l[u+1]}return null}(a);for(let p=0;p<l.length;p++){const _=l[p];if("*"!==_){if(null===f?Bm(a,_,!0):ID(f,_))return p}else u=p}return u}function jx(a){const l=De()[rr][Tr];if(!l.projection){const f=l.projection=Pc(a?a.length:1,null),p=f.slice();let _=l.child;for(;null!==_;){const w=a?Hx(_,a):0;null!==w&&(p[w]?p[w].projectionNext=_:f[w]=_,p[w]=_),_=_.next}}}function Gx(a,l=0,u){const f=De(),p=fn(),_=Hm(p,ti+a,16,null,u||null);null===_.projection&&(_.projection=l),Au(),32!=(32&_.flags)&&function TE(a,l,u){r0(l[en],0,l,u,Fe(a,u,l),ph(u.parent||l[Tr],u,l))}(p,f,_)}function jh(a,l){return a<<17|l<<2}function Jl(a){return a>>17&32767}function n_(a){return 2|a}function od(a){return(131068&a)>>2}function ad(a,l){return-131069&a|l<<2}function wv(a){return 1|a}function qx(a,l,u,f,p){const _=a[u+1],w=null===l;let I=f?Jl(_):od(_),S=!1;for(;0!==I&&(!1===S||w);){const B=a[I+1];mA(a[I],l)&&(S=!0,a[I+1]=f?wv(B):n_(B)),I=f?Jl(B):od(B)}S&&(a[u+1]=f?n_(_):wv(_))}function mA(a,l){return null===a||null==l||(Array.isArray(a)?a[1]:a)===l||!(!Array.isArray(a)||"string"!=typeof l)&&Fr(a,l)>=0}function Tv(a,l,u){return Ra(a,l,u,!1),Tv}function Iv(a,l){return Ra(a,l,null,!0),Iv}function Ra(a,l,u,f){const p=De(),_=fn(),w=co(2);_.firstUpdatePass&&function o_(a,l,u,f){const p=a.data;if(null===p[u+1]){const _=p[Si()],w=function Cv(a,l){return l>=a.expandoStartIndex}(a,u);(function nT(a,l){return 0!=(a.flags&(l?8:16))})(_,f)&&null===l&&!w&&(l=!1),l=function _A(a,l,u,f){const p=as(a);let _=f?l.residualClasses:l.residualStyles;if(null===p)0===(f?l.classBindings:l.styleBindings)&&(u=sp(u=Dv(null,a,l,u,f),l.attrs,f),_=null);else{const w=l.directiveStylingLast;if(-1===w||a[w]!==p)if(u=Dv(p,a,l,u,f),null===_){let S=function yA(a,l,u){const f=u?l.classBindings:l.styleBindings;if(0!==od(f))return a[Jl(f)]}(a,l,f);void 0!==S&&Array.isArray(S)&&(S=Dv(null,a,l,S[1],f),S=sp(S,l.attrs,f),function vA(a,l,u,f){a[Jl(u?l.classBindings:l.styleBindings)]=f}(a,l,f,S))}else _=function Xx(a,l,u){let f;const p=l.directiveEnd;for(let _=1+l.directiveStylingLast;_<p;_++)f=sp(f,a[_].hostAttrs,u);return sp(f,l.attrs,u)}(a,l,f)}return void 0!==_&&(f?l.residualClasses=_:l.residualStyles=_),u}(p,_,l,f),function fs(a,l,u,f,p,_){let w=_?l.classBindings:l.styleBindings,I=Jl(w),S=od(w);a[f]=u;let B,M=!1;if(Array.isArray(u)?(B=u[1],(null===B||Fr(u,B)>0)&&(M=!0)):B=u,p)if(0!==S){const se=Jl(a[I+1]);a[f+1]=jh(se,I),0!==se&&(a[se+1]=ad(a[se+1],f)),a[I+1]=function fA(a,l){return 131071&a|l<<17}(a[I+1],f)}else a[f+1]=jh(I,0),0!==I&&(a[I+1]=ad(a[I+1],f)),I=f;else a[f+1]=jh(S,0),0===I?I=f:a[S+1]=ad(a[S+1],f),S=f;M&&(a[f+1]=n_(a[f+1])),qx(a,B,f,!0),qx(a,B,f,!1),function Yo(a,l,u,f,p){const _=p?a.residualClasses:a.residualStyles;null!=_&&"string"==typeof l&&Fr(_,l)>=0&&(u[f+1]=wv(u[f+1]))}(l,B,a,f,_),w=jh(I,S),_?l.classBindings=w:l.styleBindings=w}(p,_,l,u,w,f)}}(_,a,w,f),l!==mn&&Yr(p,w,l)&&function eT(a,l,u,f,p,_,w,I){if(!(3&l.type))return;const S=a.data,M=S[I+1],B=function bv(a){return 1==(1&a)}(M)?We(S,l,u,p,od(M),w):void 0;Gh(B)||(Gh(_)||function t_(a){return 2==(2&a)}(M)&&(_=We(S,null,u,p,I,w)),function ol(a,l,u,f,p){if(l)p?a.addClass(u,f):a.removeClass(u,f);else{let _=-1===f.indexOf("-")?void 0:Zt.DashCase;null==p?a.removeStyle(u,f,_):("string"==typeof p&&p.endsWith("!important")&&(p=p.slice(0,-10),_|=Zt.Important),a.setStyle(u,f,p,_))}}(f,w,za(Si(),u),p,_))}(_,_.data[Si()],p,p[en],a,p[w+1]=function tT(a,l){return null==a||""===a||("string"==typeof l?a+=l:"object"==typeof a&&(a=Le(Ia(a)))),a}(l,u),f,w)}function Dv(a,l,u,f,p){let _=null;const w=u.directiveEnd;let I=u.directiveStylingLast;for(-1===I?I=u.directiveStart:I++;I<w&&(_=l[I],f=sp(f,_.hostAttrs,p),_!==a);)I++;return null!==a&&(u.directiveStylingLast=I),f}function sp(a,l,u){const f=u?1:2;let p=-1;if(null!==l)for(let _=0;_<l.length;_++){const w=l[_];"number"==typeof w?p=w:p===f&&(Array.isArray(a)||(a=void 0===a?[]:["",a]),cs(a,w,!!u||l[++_]))}return void 0===a?null:a}function We(a,l,u,f,p,_){const w=null===l;let I;for(;p>0;){const S=a[p],M=Array.isArray(S),B=M?S[1]:S,K=null===B;let se=u[p+1];se===mn&&(se=K?ie:void 0);let he=K?Wn(se,f):B===f?se:void 0;if(M&&!Gh(he)&&(he=Wn(S,f)),Gh(he)&&(I=he,w))return I;const ke=a[p+1];p=w?Jl(ke):od(ke)}if(null!==l){let S=_?l.residualClasses:l.residualStyles;null!=S&&(I=Wn(S,f))}return I}function Gh(a){return void 0!==a}function iT(a,l=""){const u=De(),f=fn(),p=a+ti,_=f.firstCreatePass?Hm(f,p,1,l,null):f.data[p],w=u[p]=function Kc(a,l){return a.createText(l)}(u[en],l);qc(f,u,w,_),ar(_,!1)}function a_(a,l,u){const f=De(),p=function Bh(a,l,u,f){return Yr(a,Rl(),u)?l+qe(u)+f:mn}(f,a,l,u);return p!==mn&&Zl(f,Si(),p),a_}function Rv(a,l,u,f,p){const _=De(),w=nd(_,a,l,u,f,p);return w!==mn&&Zl(_,Si(),w),Rv}function Nv(a,l,u){const f=De();if(Yr(f,Rl(),l)){const _=fn(),w=ai();Eo(_,w,f,a,l,xx(as(_.data),w,f),u,!0)}return Nv}const ld=void 0;var ap=["en",[["a","p"],["AM","PM"],ld],[["AM","PM"],ld,ld],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ld,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ld,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ld,"{1} 'at' {0}",ld],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function zh(a){const u=Math.floor(Math.abs(a)),f=a.toString().replace(/^[^.]*\.?/,"").length;return 1===u&&0===f?1:5}];let Wh={};function fl(a){const l=function OA(a){return a.toLowerCase().replace(/_/g,"-")}(a);let u=f_(l);if(u)return u;const f=l.split("-")[0];if(u=f_(f),u)return u;if("en"===f)return ap;throw new Se(701,!1)}function Fv(a){return fl(a)[Qt.PluralCase]}function f_(a){return a in Wh||(Wh[a]=ni.ng&&ni.ng.common&&ni.ng.common.locales&&ni.ng.common.locales[a]),Wh[a]}var Qt=(()=>((Qt=Qt||{})[Qt.LocaleId=0]="LocaleId",Qt[Qt.DayPeriodsFormat=1]="DayPeriodsFormat",Qt[Qt.DayPeriodsStandalone=2]="DayPeriodsStandalone",Qt[Qt.DaysFormat=3]="DaysFormat",Qt[Qt.DaysStandalone=4]="DaysStandalone",Qt[Qt.MonthsFormat=5]="MonthsFormat",Qt[Qt.MonthsStandalone=6]="MonthsStandalone",Qt[Qt.Eras=7]="Eras",Qt[Qt.FirstDayOfWeek=8]="FirstDayOfWeek",Qt[Qt.WeekendRange=9]="WeekendRange",Qt[Qt.DateFormat=10]="DateFormat",Qt[Qt.TimeFormat=11]="TimeFormat",Qt[Qt.DateTimeFormat=12]="DateTimeFormat",Qt[Qt.NumberSymbols=13]="NumberSymbols",Qt[Qt.NumberFormats=14]="NumberFormats",Qt[Qt.CurrencyCode=15]="CurrencyCode",Qt[Qt.CurrencySymbol=16]="CurrencySymbol",Qt[Qt.CurrencyName=17]="CurrencyName",Qt[Qt.Currencies=18]="Currencies",Qt[Qt.Directionality=19]="Directionality",Qt[Qt.PluralCase=20]="PluralCase",Qt[Qt.ExtraData=21]="ExtraData",Qt))();const Kh="en-US";let Bv=Kh;function fp(a,l,u,f,p){if(a=le(a),Array.isArray(a))for(let _=0;_<a.length;_++)fp(a[_],l,u,f,p);else{const _=fn(),w=De();let I=ql(a)?a:le(a.provide),S=E0(a);const M=or(),B=1048575&M.providerIndexes,K=M.directiveStart,se=M.providerIndexes>>20;if(ql(a)||!a.multi){const he=new Vo(S,p,Lh),ke=tb(I,l,p?B:B+se,K);-1===ke?(jo(qd(M,w),_,I),I_(_,a,l.length),l.push(I),M.directiveStart++,M.directiveEnd++,p&&(M.providerIndexes+=1048576),u.push(he),w.push(he)):(u[ke]=he,w[ke]=he)}else{const he=tb(I,l,B+se,K),ke=tb(I,l,B,B+se),ft=ke>=0&&u[ke];if(p&&!ft||!p&&!(he>=0&&u[he])){jo(qd(M,w),_,I);const Ot=function jT(a,l,u,f,p){const _=new Vo(a,u,Lh);return _.multi=[],_.index=l,_.componentProviders=0,eb(_,p,f&&!u),_}(p?JA:HT,u.length,p,f,S);!p&&ft&&(u[ke].providerFactory=Ot),I_(_,a,l.length,0),l.push(I),M.directiveStart++,M.directiveEnd++,p&&(M.providerIndexes+=1048576),u.push(Ot),w.push(Ot)}else I_(_,a,he>-1?he:ke,eb(u[p?ke:he],S,!p&&f));!p&&f&&ft&&u[ke].componentProviders++}}}function I_(a,l,u,f){const p=ql(l),_=function kg(a){return!!a.useClass}(l);if(p||_){const S=(_?le(l.useClass):l).prototype.ngOnDestroy;if(S){const M=a.destroyHooks||(a.destroyHooks=[]);if(!p&&l.multi){const B=M.indexOf(u);-1===B?M.push(u,[f,S]):M[B+1].push(f,S)}else M.push(u,S)}}}function eb(a,l,u){return u&&a.componentProviders++,a.multi.push(l)-1}function tb(a,l,u,f){for(let p=u;p<f;p++)if(l[p]===a)return p;return-1}function HT(a,l,u,f){return mp(this.multi,[])}function JA(a,l,u,f){const p=this.multi;let _;if(this.providerFactory){const w=this.providerFactory.componentProviders,I=mo(u,u[vt],this.providerFactory.index,f);_=I.slice(0,w),mp(p,_);for(let S=w;S<I.length;S++)_.push(I[S])}else _=[],mp(p,_);return _}function mp(a,l){for(let u=0;u<a.length;u++)l.push((0,a[u])());return l}function nb(a,l=[]){return u=>{u.providersResolver=(f,p)=>function XA(a,l,u){const f=fn();if(f.firstCreatePass){const p=Ss(a);fp(u,f.data,f.blueprint,p,!0),fp(l,f.data,f.blueprint,p,!1)}}(f,p?p(a):a,l)}}class Jh{}class S_{}function GT(a,l){return new WT(a,l??null)}class WT extends Jh{constructor(l,u){super(),this._parent=u,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Ix(this);const f=ei(l);this._bootstrapComponents=al(f.bootstrap),this._r3Injector=O0(l,u,[{provide:Jh,useValue:this},{provide:Ch,useValue:this.componentFactoryResolver}],Le(l),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(l)}get injector(){return this._r3Injector}destroy(){const l=this._r3Injector;!l.destroyed&&l.destroy(),this.destroyCbs.forEach(u=>u()),this.destroyCbs=null}onDestroy(l){this.destroyCbs.push(l)}}class ib extends S_{constructor(l){super(),this.moduleType=l}create(l){return new WT(this.moduleType,l)}}class eR extends Jh{constructor(l,u,f){super(),this.componentFactoryResolver=new Ix(this),this.instance=null;const p=new GE([...l,{provide:Jh,useValue:this},{provide:Ch,useValue:this.componentFactoryResolver}],u||Lg(),f,new Set(["environment"]));this.injector=p,p.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(l){this.injector.onDestroy(l)}}function rb(a,l,u=null){return new eR(a,l,u).injector}let tR=(()=>{class a{constructor(u){this._injector=u,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(u){if(!u.standalone)return null;if(!this.cachedInjectors.has(u.id)){const f=Th(0,u.type),p=f.length>0?rb([f],this._injector,`Standalone[${u.type.name}]`):null;this.cachedInjectors.set(u.id,p)}return this.cachedInjectors.get(u.id)}ngOnDestroy(){try{for(const u of this.cachedInjectors.values())null!==u&&u.destroy()}finally{this.cachedInjectors.clear()}}}return a.\u0275prov=Dt({token:a,providedIn:"environment",factory:()=>new a(En(Ju))}),a})();function sb(a){a.getStandaloneInjector=l=>l.get(tR).getOrCreateStandaloneInjector(a)}function ab(a,l,u){const f=fi()+a,p=De();return p[f]===mn?dl(p,f,u?l.call(u):l()):function Nh(a,l){return a[l]}(p,f)}function QT(a,l,u,f,p,_){const w=l+u;return Yr(a,w,p)?dl(a,w+1,_?f.call(_,p):f(p)):function _p(a,l){const u=a[l];return u===mn?void 0:u}(a,w+1)}function cd(a,l){const u=fn();let f;const p=a+ti;u.firstCreatePass?(f=function nu(a,l){if(l)for(let u=l.length-1;u>=0;u--){const f=l[u];if(a===f.name)return f}}(l,u.pipeRegistry),u.data[p]=f,f.onDestroy&&(u.destroyHooks??(u.destroyHooks=[])).push(p,f.onDestroy)):f=u.data[p];const _=f.factory||(f.factory=da(f.type)),w=Pn(Lh);try{const I=qa(!1),S=_();return qa(I),function Fx(a,l,u,f){u>=a.data.length&&(a.data[u]=null,a.blueprint[u]=null),l[u]=f}(u,De(),p,S),S}finally{Pn(w)}}function JT(a,l,u){const f=a+ti,p=De(),_=jr(p,f);return function iu(a,l){return a[vt].data[l].pure}(p,f)?QT(p,fi(),l,_.transform,u,_):_.transform(u)}function cb(a){return l=>{setTimeout(a,void 0,l)}}const Zo=class yp extends h.x{constructor(l=!1){super(),this.__isAsync=l}emit(l){super.next(l)}subscribe(l,u,f){let p=l,_=u||(()=>null),w=f;if(l&&"object"==typeof l){const S=l;p=S.next?.bind(S),_=S.error?.bind(S),w=S.complete?.bind(S)}this.__isAsync&&(_=cb(_),p&&(p=cb(p)),w&&(w=cb(w)));const I=super.subscribe({next:p,error:_,complete:w});return l instanceof X.w0&&l.add(I),I}};function _R(){return this._results[Symbol.iterator]()}class A_{get changes(){return this._changes||(this._changes=new Zo)}constructor(l=!1){this._emitDistinctChangesOnly=l,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const u=A_.prototype;u[Symbol.iterator]||(u[Symbol.iterator]=_R)}get(l){return this._results[l]}map(l){return this._results.map(l)}filter(l){return this._results.filter(l)}find(l){return this._results.find(l)}reduce(l,u){return this._results.reduce(l,u)}forEach(l){this._results.forEach(l)}some(l){return this._results.some(l)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(l,u){const f=this;f.dirty=!1;const p=function Ks(a){return a.flat(Number.POSITIVE_INFINITY)}(l);(this._changesDetected=!function sh(a,l,u){if(a.length!==l.length)return!1;for(let f=0;f<a.length;f++){let p=a[f],_=l[f];if(u&&(p=u(p),_=u(_)),_!==p)return!1}return!0}(f._results,p,u))&&(f._results=p,f.length=p.length,f.last=p[this.length-1],f.first=p[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let vp=(()=>{class a{}return a.__NG_ELEMENT_ID__=Ur,a})();const ms=vp,R_=class extends ms{constructor(l,u,f){super(),this._declarationLView=l,this._declarationTContainer=u,this.elementRef=f}createEmbeddedView(l,u){const f=this._declarationTContainer.tView,p=Ug(this._declarationLView,f,l,16,null,f.declTNode,null,null,null,null,u||null);p[El]=this._declarationLView[this._declarationTContainer.index];const w=this._declarationLView[js];return null!==w&&(p[js]=w.createEmbeddedView(f)),U0(f,p,l),new Zm(p)}};function Ur(){return Pa(or(),De())}function Pa(a,l){return 4&a.type?new R_(l,a,Yl(a,l)):null}let k_=(()=>{class a{}return a.__NG_ELEMENT_ID__=eI,a})();function eI(){return ef(or(),De())}const ub=k_,db=class extends ub{constructor(l,u,f){super(),this._lContainer=l,this._hostTNode=u,this._hostLView=f}get element(){return Yl(this._hostTNode,this._hostLView)}get injector(){return new _a(this._hostTNode,this._hostLView)}get parentInjector(){const l=Ho(this._hostTNode,this._hostLView);if(Fl(l)){const u=Ac(l,this._hostLView),f=Bl(l);return new _a(u[vt].data[f+8],u)}return new _a(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(l){const u=Qr(this._lContainer);return null!==u&&u[l]||null}get length(){return this._lContainer.length-pr}createEmbeddedView(l,u,f){let p,_;"number"==typeof f?p=f:null!=f&&(p=f.index,_=f.injector);const w=l.createEmbeddedView(u||{},_);return this.insert(w,p),w}createComponent(l,u,f,p,_){const w=l&&!function Oc(a){return"function"==typeof a}(l);let I;if(w)I=u;else{const K=u||{};I=K.index,f=K.injector,p=K.projectableNodes,_=K.environmentInjector||K.ngModuleRef}const S=w?l:new Qm(Lt(l)),M=f||this.parentInjector;if(!_&&null==S.ngModule){const se=(w?M:this.parentInjector).get(Ju,null);se&&(_=se)}const B=S.create(M,p,void 0,_);return this.insert(B.hostView,I),B}insert(l,u){const f=l._lView,p=f[vt];if(function Ld(a){return Gs(a[ii])}(f)){const B=this.indexOf(l);if(-1!==B)this.detach(B);else{const K=f[ii],se=new db(K,K[Tr],K[ii]);se.detach(se.indexOf(l))}}const _=this._adjustIndex(u),w=this._lContainer;!function y(a,l,u,f){const p=pr+f,_=u.length;f>0&&(u[p-1][Nr]=l),f<_-pr?(l[Nr]=u[p],_m(u,pr+f,l)):(u.push(l),l[Nr]=null),l[ii]=u;const w=l[El];null!==w&&u!==w&&function b(a,l){const u=a[Is];l[rr]!==l[ii][ii][rr]&&(a[Ir]=!0),null===u?a[Is]=[l]:u.push(l)}(w,l);const I=l[js];null!==I&&I.insertView(a),l[yn]|=64}(p,f,w,_);const I=sl(_,w),S=f[en],M=ur(S,w[pc]);return null!==M&&function t0(a,l,u,f,p,_){f[rs]=p,f[Tr]=l,Sm(a,f,u,1,p,_)}(p,w[Tr],S,f,M,I),l.attachToViewContainerRef(),_m(hb(w),_,l),l}move(l,u){return this.insert(l,u)}indexOf(l){const u=Qr(this._lContainer);return null!==u?u.indexOf(l):-1}remove(l){const u=this._adjustIndex(l,-1),f=O(this._lContainer,u);f&&(Vl(hb(this._lContainer),u),F(f[vt],f))}detach(l){const u=this._adjustIndex(l,-1),f=O(this._lContainer,u);return f&&null!=Vl(hb(this._lContainer),u)?new Zm(f):null}_adjustIndex(l,u=0){return l??this.length+u}};function Qr(a){return a[xl]}function hb(a){return a[xl]||(a[xl]=[])}function ef(a,l){let u;const f=l[a.index];if(Gs(f))u=f;else{let p;if(8&a.type)p=In(f);else{const _=l[en];p=_.createComment("");const w=gr(a,l);kt(_,ur(_,w),p,function Kl(a,l){return a.nextSibling(l)}(_,w),!1)}l[a.index]=u=Ai(f,l,p,a),zm(l,u)}return new db(u,a,l)}class tf{constructor(l){this.queryList=l,this.matches=null}clone(){return new tf(this.queryList)}setDirty(){this.queryList.setDirty()}}class Qo{constructor(l=[]){this.queries=l}createEmbeddedView(l){const u=l.queries;if(null!==u){const f=null!==l.contentQueries?l.contentQueries[0]:u.length,p=[];for(let _=0;_<f;_++){const w=u.getByIndex(_);p.push(this.queries[w.indexInDeclarationView].clone())}return new Qo(p)}return null}insertView(l){this.dirtyQueriesWithMatches(l)}detachView(l){this.dirtyQueriesWithMatches(l)}dirtyQueriesWithMatches(l){for(let u=0;u<this.queries.length;u++)null!==sI(l,u).matches&&this.queries[u].setDirty()}}class M_{constructor(l,u,f=null){this.predicate=l,this.flags=u,this.read=f}}class fb{constructor(l=[]){this.queries=l}elementStart(l,u){for(let f=0;f<this.queries.length;f++)this.queries[f].elementStart(l,u)}elementEnd(l){for(let u=0;u<this.queries.length;u++)this.queries[u].elementEnd(l)}embeddedTView(l){let u=null;for(let f=0;f<this.length;f++){const p=null!==u?u.length:0,_=this.getByIndex(f).embeddedTView(l,p);_&&(_.indexInDeclarationView=f,null!==u?u.push(_):u=[_])}return null!==u?new fb(u):null}template(l,u){for(let f=0;f<this.queries.length;f++)this.queries[f].template(l,u)}getByIndex(l){return this.queries[l]}get length(){return this.queries.length}track(l){this.queries.push(l)}}class mb{constructor(l,u=-1){this.metadata=l,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=u}elementStart(l,u){this.isApplyingToNode(u)&&this.matchTNode(l,u)}elementEnd(l){this._declarationNodeIndex===l.index&&(this._appliesToNextNode=!1)}template(l,u){this.elementStart(l,u)}embeddedTView(l,u){return this.isApplyingToNode(l)?(this.crossesNgTemplate=!0,this.addMatch(-l.index,u),new mb(this.metadata)):null}isApplyingToNode(l){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const u=this._declarationNodeIndex;let f=l.parent;for(;null!==f&&8&f.type&&f.index!==u;)f=f.parent;return u===(null!==f?f.index:-1)}return this._appliesToNextNode}matchTNode(l,u){const f=this.metadata.predicate;if(Array.isArray(f))for(let p=0;p<f.length;p++){const _=f[p];this.matchTNodeWithReadOption(l,u,nf(u,_)),this.matchTNodeWithReadOption(l,u,fo(u,l,_,!1,!1))}else f===vp?4&u.type&&this.matchTNodeWithReadOption(l,u,-1):this.matchTNodeWithReadOption(l,u,fo(u,l,f,!1,!1))}matchTNodeWithReadOption(l,u,f){if(null!==f){const p=this.metadata.read;if(null!==p)if(p===Dh||p===k_||p===vp&&4&u.type)this.addMatch(u.index,-2);else{const _=fo(u,l,p,!1,!1);null!==_&&this.addMatch(u.index,_)}else this.addMatch(u.index,f)}}addMatch(l,u){null===this.matches?this.matches=[l,u]:this.matches.push(l,u)}}function nf(a,l){const u=a.localNames;if(null!==u)for(let f=0;f<u.length;f+=2)if(u[f]===l)return u[f+1];return null}function pb(a,l,u,f){return-1===u?function tI(a,l){return 11&a.type?Yl(a,l):4&a.type?Pa(a,l):null}(l,a):-2===u?function nI(a,l,u){return u===Dh?Yl(l,a):u===vp?Pa(l,a):u===k_?ef(l,a):void 0}(a,l,f):mo(a,a[vt],u,l)}function iI(a,l,u,f){const p=l[js].queries[f];if(null===p.matches){const _=a.data,w=u.matches,I=[];for(let S=0;S<w.length;S+=2){const M=w[S];I.push(M<0?null:pb(l,_[M],w[S+1],u.metadata.read))}p.matches=I}return p.matches}function L_(a,l,u,f){const p=a.queries.getByIndex(u),_=p.matches;if(null!==_){const w=iI(a,l,p,u);for(let I=0;I<_.length;I+=2){const S=_[I];if(S>0)f.push(w[I/2]);else{const M=_[I+1],B=l[-S];for(let K=pr;K<B.length;K++){const se=B[K];se[El]===se[ii]&&L_(se[vt],se,M,f)}if(null!==B[Is]){const K=B[Is];for(let se=0;se<K.length;se++){const he=K[se];L_(he[vt],he,M,f)}}}}}return f}function O_(a){const l=De(),u=fn(),f=Tc();Cr(f+1);const p=sI(u,f);if(a.dirty&&function Md(a){return 4==(4&a[yn])}(l)===(2==(2&p.metadata.flags))){if(null===p.matches)a.reset([]);else{const _=p.crossesNgTemplate?L_(u,l,f,[]):iI(u,l,p,f);a.reset(_,Pm),a.notifyOnChanges()}return!0}return!1}function P_(a,l,u){const f=fn();f.firstCreatePass&&(rI(f,new M_(a,l,u),-1),2==(2&l)&&(f.staticViewQueries=!0)),_b(f,De(),l)}function N_(a,l,u,f){const p=fn();if(p.firstCreatePass){const _=or();rI(p,new M_(l,u,f),_.index),function bp(a,l){const u=a.contentQueries||(a.contentQueries=[]);l!==(u.length?u[u.length-1]:-1)&&u.push(a.queries.length-1,l)}(p,a),2==(2&u)&&(p.staticContentQueries=!0)}_b(p,De(),u)}function F_(){return function gb(a,l){return a[js].queries[l].queryList}(De(),Tc())}function _b(a,l,u){const f=new A_(4==(4&u));N(a,l,f,f.destroy),null===l[js]&&(l[js]=new Qo),l[js].queries.push(new tf(f))}function rI(a,l,u){null===a.queries&&(a.queries=new fb),a.queries.track(new mb(l,u))}function sI(a,l){return a.queries.getByIndex(l)}function rf(a,l){return Pa(a,l)}function U_(a){return!!ei(a)}function Tp(...a){}const Mb=new Ln("Application Initializer");let su=(()=>{class a{constructor(u){this.appInits=u,this.resolve=Tp,this.reject=Tp,this.initialized=!1,this.done=!1,this.donePromise=new Promise((f,p)=>{this.resolve=f,this.reject=p})}runInitializers(){if(this.initialized)return;const u=[],f=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let p=0;p<this.appInits.length;p++){const _=this.appInits[p]();if(ep(_))u.push(_);else if(Vx(_)){const w=new Promise((I,S)=>{_.subscribe({complete:I,error:S})});u.push(w)}}Promise.all(u).then(()=>{f()}).catch(p=>{this.reject(p)}),0===u.length&&f(),this.initialized=!0}}return a.\u0275fac=function(u){return new(u||a)(En(Mb,8))},a.\u0275prov=Dt({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();const Ip=new Ln("AppId",{providedIn:"root",factory:function Lb(){return`${Z_()}${Z_()}${Z_()}`}});function Z_(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Ob=new Ln("Platform Initializer"),Sp=new Ln("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Pb=new Ln("AnimationModuleType");let Nb=(()=>{class a{log(u){console.log(u)}warn(u){console.warn(u)}}return a.\u0275fac=function(u){return new(u||a)},a.\u0275prov=Dt({token:a,factory:a.\u0275fac,providedIn:"platform"}),a})();const ou=new Ln("LocaleId",{providedIn:"root",factory:()=>Wi(ou,Bt.Optional|Bt.SkipSelf)||function Q_(){return typeof $localize<"u"&&$localize.locale||Kh}()}),gI=new Ln("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class Bb{constructor(l,u){this.ngModuleFactory=l,this.componentFactories=u}}let yI=(()=>{class a{compileModuleSync(u){return new ib(u)}compileModuleAsync(u){return Promise.resolve(this.compileModuleSync(u))}compileModuleAndAllComponentsSync(u){const f=this.compileModuleSync(u),_=al(ei(u).declarations).reduce((w,I)=>{const S=Lt(I);return S&&w.push(new Qm(S)),w},[]);return new Bb(f,_)}compileModuleAndAllComponentsAsync(u){return Promise.resolve(this.compileModuleAndAllComponentsSync(u))}clearCache(){}clearCacheFor(u){}getModuleId(u){}}return a.\u0275fac=function(u){return new(u||a)},a.\u0275prov=Dt({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();const ud=(()=>Promise.resolve(0))();function Cp(a){typeof Zone>"u"?ud.then(()=>{a&&a.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",a)}class So{constructor({enableLongStackTrace:l=!1,shouldCoalesceEventChangeDetection:u=!1,shouldCoalesceRunChangeDetection:f=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Zo(!1),this.onMicrotaskEmpty=new Zo(!1),this.onStable=new Zo(!1),this.onError=new Zo(!1),typeof Zone>"u")throw new Se(908,!1);Zone.assertZonePatched();const p=this;p._nesting=0,p._outer=p._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(p._inner=p._inner.fork(new Zone.TaskTrackingZoneSpec)),l&&Zone.longStackTraceZoneSpec&&(p._inner=p._inner.fork(Zone.longStackTraceZoneSpec)),p.shouldCoalesceEventChangeDetection=!f&&u,p.shouldCoalesceRunChangeDetection=f,p.lastRequestAnimationFrameId=-1,p.nativeRequestAnimationFrame=function AR(){let a=ni.requestAnimationFrame,l=ni.cancelAnimationFrame;if(typeof Zone<"u"&&a&&l){const u=a[Zone.__symbol__("OriginalDelegate")];u&&(a=u);const f=l[Zone.__symbol__("OriginalDelegate")];f&&(l=f)}return{nativeRequestAnimationFrame:a,nativeCancelAnimationFrame:l}}().nativeRequestAnimationFrame,function ic(a){const l=()=>{!function dd(a){a.isCheckStableRunning||-1!==a.lastRequestAnimationFrameId||(a.lastRequestAnimationFrameId=a.nativeRequestAnimationFrame.call(ni,()=>{a.fakeTopEventTask||(a.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{a.lastRequestAnimationFrameId=-1,hf(a),a.isCheckStableRunning=!0,$b(a),a.isCheckStableRunning=!1},void 0,()=>{},()=>{})),a.fakeTopEventTask.invoke()}),hf(a))}(a)};a._inner=a._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(u,f,p,_,w,I)=>{try{return Dp(a),u.invokeTask(p,_,w,I)}finally{(a.shouldCoalesceEventChangeDetection&&"eventTask"===_.type||a.shouldCoalesceRunChangeDetection)&&l(),Hb(a)}},onInvoke:(u,f,p,_,w,I,S)=>{try{return Dp(a),u.invoke(p,_,w,I,S)}finally{a.shouldCoalesceRunChangeDetection&&l(),Hb(a)}},onHasTask:(u,f,p,_)=>{u.hasTask(p,_),f===p&&("microTask"==_.change?(a._hasPendingMicrotasks=_.microTask,hf(a),$b(a)):"macroTask"==_.change&&(a.hasPendingMacrotasks=_.macroTask))},onHandleError:(u,f,p,_)=>(u.handleError(p,_),a.runOutsideAngular(()=>a.onError.emit(_)),!1)})}(p)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!So.isInAngularZone())throw new Se(909,!1)}static assertNotInAngularZone(){if(So.isInAngularZone())throw new Se(909,!1)}run(l,u,f){return this._inner.run(l,u,f)}runTask(l,u,f,p){const _=this._inner,w=_.scheduleEventTask("NgZoneEvent: "+p,l,bI,Tp,Tp);try{return _.runTask(w,u,f)}finally{_.cancelTask(w)}}runGuarded(l,u,f){return this._inner.runGuarded(l,u,f)}runOutsideAngular(l){return this._outer.run(l)}}const bI={};function $b(a){if(0==a._nesting&&!a.hasPendingMicrotasks&&!a.isStable)try{a._nesting++,a.onMicrotaskEmpty.emit(null)}finally{if(a._nesting--,!a.hasPendingMicrotasks)try{a.runOutsideAngular(()=>a.onStable.emit(null))}finally{a.isStable=!0}}}function hf(a){a.hasPendingMicrotasks=!!(a._hasPendingMicrotasks||(a.shouldCoalesceEventChangeDetection||a.shouldCoalesceRunChangeDetection)&&-1!==a.lastRequestAnimationFrameId)}function Dp(a){a._nesting++,a.isStable&&(a.isStable=!1,a.onUnstable.emit(null))}function Hb(a){a._nesting--,$b(a)}class xi{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Zo,this.onMicrotaskEmpty=new Zo,this.onStable=new Zo,this.onError=new Zo}run(l,u,f){return l.apply(u,f)}runGuarded(l,u,f){return l.apply(u,f)}runOutsideAngular(l){return l()}runTask(l,u,f,p){return l.apply(u,f)}}const Ap=new Ln(""),ff=new Ln("");let jb,Rp=(()=>{class a{constructor(u,f,p){this._ngZone=u,this.registry=f,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,jb||(function EI(a){jb=a}(p),p.addToWindow(f)),this._watchAngularEvents(),u.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{So.assertNotInAngularZone(),Cp(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Cp(()=>{for(;0!==this._callbacks.length;){let u=this._callbacks.pop();clearTimeout(u.timeoutId),u.doneCb(this._didWork)}this._didWork=!1});else{let u=this.getPendingTasks();this._callbacks=this._callbacks.filter(f=>!f.updateCb||!f.updateCb(u)||(clearTimeout(f.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(u=>({source:u.source,creationLocation:u.creationLocation,data:u.data})):[]}addCallback(u,f,p){let _=-1;f&&f>0&&(_=setTimeout(()=>{this._callbacks=this._callbacks.filter(w=>w.timeoutId!==_),u(this._didWork,this.getPendingTasks())},f)),this._callbacks.push({doneCb:u,timeoutId:_,updateCb:p})}whenStable(u,f,p){if(p&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(u,f,p),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(u){this.registry.registerApplication(u,this)}unregisterApplication(u){this.registry.unregisterApplication(u)}findProviders(u,f,p){return[]}}return a.\u0275fac=function(u){return new(u||a)(En(So),En(wI),En(ff))},a.\u0275prov=Dt({token:a,factory:a.\u0275fac}),a})(),wI=(()=>{class a{constructor(){this._applications=new Map}registerApplication(u,f){this._applications.set(u,f)}unregisterApplication(u){this._applications.delete(u)}unregisterAllApplications(){this._applications.clear()}getTestability(u){return this._applications.get(u)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(u,f=!0){return jb?.findTestabilityInTree(this,u,f)??null}}return a.\u0275fac=function(u){return new(u||a)},a.\u0275prov=Dt({token:a,factory:a.\u0275fac,providedIn:"platform"}),a})();const rc=!1;let au=null;const xI=new Ln("AllowMultipleToken"),hd=new Ln("PlatformDestroyListeners"),sc=new Ln("appBootstrapListener");class mf{constructor(l,u){this.name=l,this.token=u}}function zb(a,l,u=[]){const f=`Platform: ${l}`,p=new Ln(f);return(_=[])=>{let w=J_();if(!w||w.injector.get(xI,!1)){const I=[...u,..._,{provide:p,useValue:!0}];a?a(I):function kR(a){if(au&&!au.get(xI,!1))throw new Se(400,!1);au=a;const l=a.get(Wb);(function Gb(a){const l=a.get(Ob,null);l&&l.forEach(u=>u())})(a)}(function X_(a=[],l){return Rh.create({name:l,providers:[{provide:Qc,useValue:"platform"},{provide:hd,useValue:new Set([()=>au=null])},...a]})}(I,f))}return function SI(a){const l=J_();if(!l)throw new Se(401,!1);return l}()}}function J_(){return au?.get(Wb)??null}let Wb=(()=>{class a{constructor(u){this._injector=u,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(u,f){const p=function AI(a,l){let u;return u="noop"===a?new xi:("zone.js"===a?void 0:a)||new So(l),u}(f?.ngZone,function DI(a){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!a||!a.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!a||!a.ngZoneRunCoalescing)||!1}}(f)),_=[{provide:So,useValue:p}];return p.run(()=>{const w=Rh.create({providers:_,parent:this.injector,name:u.moduleType.name}),I=u.create(w),S=I.injector.get(Nm,null);if(!S)throw new Se(402,!1);return p.runOutsideAngular(()=>{const M=p.onError.subscribe({next:B=>{S.handleError(B)}});I.onDestroy(()=>{lu(this._modules,I),M.unsubscribe()})}),function RI(a,l,u){try{const f=u();return ep(f)?f.catch(p=>{throw l.runOutsideAngular(()=>a.handleError(p)),p}):f}catch(f){throw l.runOutsideAngular(()=>a.handleError(f)),f}}(S,p,()=>{const M=I.injector.get(su);return M.runInitializers(),M.donePromise.then(()=>(function Uv(a){Ie(a,"Expected localeId to be defined"),"string"==typeof a&&(Bv=a.toLowerCase().replace(/_/g,"-"))}(I.injector.get(ou,Kh)||Kh),this._moduleDoBootstrap(I),I))})})}bootstrapModule(u,f=[]){const p=kI({},f);return function TI(a,l,u){const f=new ib(u);return Promise.resolve(f)}(0,0,u).then(_=>this.bootstrapModuleFactory(_,p))}_moduleDoBootstrap(u){const f=u.injector.get(fd);if(u._bootstrapComponents.length>0)u._bootstrapComponents.forEach(p=>f.bootstrap(p));else{if(!u.instance.ngDoBootstrap)throw new Se(-403,!1);u.instance.ngDoBootstrap(f)}this._modules.push(u)}onDestroy(u){this._destroyListeners.push(u)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Se(404,!1);this._modules.slice().forEach(f=>f.destroy()),this._destroyListeners.forEach(f=>f());const u=this._injector.get(hd,null);u&&(u.forEach(f=>f()),u.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return a.\u0275fac=function(u){return new(u||a)(En(Rh))},a.\u0275prov=Dt({token:a,factory:a.\u0275fac,providedIn:"platform"}),a})();function kI(a,l){return Array.isArray(l)?l.reduce(kI,a):{...a,...l}}let fd=(()=>{class a{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(u,f,p){this._zone=u,this._injector=f,this._exceptionHandler=p,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const _=new V.y(I=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{I.next(this._stable),I.complete()})}),w=new V.y(I=>{let S;this._zone.runOutsideAngular(()=>{S=this._zone.onStable.subscribe(()=>{So.assertNotInAngularZone(),Cp(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,I.next(!0))})})});const M=this._zone.onUnstable.subscribe(()=>{So.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{I.next(!1)}))});return()=>{S.unsubscribe(),M.unsubscribe()}});this.isStable=(0,de.T)(_,w.pipe((0,ye.B)()))}bootstrap(u,f){const p=u instanceof WE;if(!this._injector.get(su).done){!p&&Xe(u);throw new Se(405,rc)}let w;w=p?u:this._injector.get(Ch).resolveComponentFactory(u),this.componentTypes.push(w.componentType);const I=function II(a){return a.isBoundToModule}(w)?void 0:this._injector.get(Jh),M=w.create(Rh.NULL,[],f||w.selector,I),B=M.location.nativeElement,K=M.injector.get(Ap,null);return K?.registerApplication(B),M.onDestroy(()=>{this.detachView(M.hostView),lu(this.components,M),K?.unregisterApplication(B)}),this._loadComponent(M),M}tick(){if(this._runningTick)throw new Se(101,!1);try{this._runningTick=!0;for(let u of this._views)u.detectChanges()}catch(u){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(u))}finally{this._runningTick=!1}}attachView(u){const f=u;this._views.push(f),f.attachToAppRef(this)}detachView(u){const f=u;lu(this._views,f),f.detachFromAppRef()}_loadComponent(u){this.attachView(u.hostView),this.tick(),this.components.push(u);const f=this._injector.get(sc,[]);f.push(...this._bootstrapListeners),f.forEach(p=>p(u))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(u=>u()),this._views.slice().forEach(u=>u.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(u){return this._destroyListeners.push(u),()=>lu(this._destroyListeners,u)}destroy(){if(this._destroyed)throw new Se(406,!1);const u=this._injector;u.destroy&&!u.destroyed&&u.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return a.\u0275fac=function(u){return new(u||a)(En(So),En(Ju),En(Nm))},a.\u0275prov=Dt({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();function lu(a,l){const u=a.indexOf(l);u>-1&&a.splice(u,1)}function MI(){return!1}let LI=(()=>{class a{}return a.__NG_ELEMENT_ID__=LR,a})();function LR(a){return function OR(a,l,u){if(os(a)&&!u){const f=sr(a.index,l);return new Zm(f,f)}return 47&a.type?new Zm(l[rr],l):null}(or(),De(),16==(16&a))}class ay{constructor(){}supports(l){return Yg(l)}create(l){return new NI(l)}}const Zb=(a,l)=>l;class NI{constructor(l){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=l||Zb}forEachItem(l){let u;for(u=this._itHead;null!==u;u=u._next)l(u)}forEachOperation(l){let u=this._itHead,f=this._removalsHead,p=0,_=null;for(;u||f;){const w=!f||u&&u.currentIndex<cu(f,p,_)?u:f,I=cu(w,p,_),S=w.currentIndex;if(w===f)p--,f=f._nextRemoved;else if(u=u._next,null==w.previousIndex)p++;else{_||(_=[]);const M=I-p,B=S-p;if(M!=B){for(let se=0;se<M;se++){const he=se<_.length?_[se]:_[se]=0,ke=he+se;B<=ke&&ke<M&&(_[se]=he+1)}_[w.previousIndex]=B-M}}I!==S&&l(w,I,S)}}forEachPreviousItem(l){let u;for(u=this._previousItHead;null!==u;u=u._nextPrevious)l(u)}forEachAddedItem(l){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)l(u)}forEachMovedItem(l){let u;for(u=this._movesHead;null!==u;u=u._nextMoved)l(u)}forEachRemovedItem(l){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)l(u)}forEachIdentityChange(l){let u;for(u=this._identityChangesHead;null!==u;u=u._nextIdentityChange)l(u)}diff(l){if(null==l&&(l=[]),!Yg(l))throw new Se(900,!1);return this.check(l)?this:null}onDestroy(){}check(l){this._reset();let p,_,w,u=this._itHead,f=!1;if(Array.isArray(l)){this.length=l.length;for(let I=0;I<this.length;I++)_=l[I],w=this._trackByFn(I,_),null!==u&&Object.is(u.trackById,w)?(f&&(u=this._verifyReinsertion(u,_,w,I)),Object.is(u.item,_)||this._addIdentityChange(u,_)):(u=this._mismatch(u,_,w,I),f=!0),u=u._next}else p=0,function dA(a,l){if(Array.isArray(a))for(let u=0;u<a.length;u++)l(a[u]);else{const u=a[Symbol.iterator]();let f;for(;!(f=u.next()).done;)l(f.value)}}(l,I=>{w=this._trackByFn(p,I),null!==u&&Object.is(u.trackById,w)?(f&&(u=this._verifyReinsertion(u,I,w,p)),Object.is(u.item,I)||this._addIdentityChange(u,I)):(u=this._mismatch(u,I,w,p),f=!0),u=u._next,p++}),this.length=p;return this._truncate(u),this.collection=l,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let l;for(l=this._previousItHead=this._itHead;null!==l;l=l._next)l._nextPrevious=l._next;for(l=this._additionsHead;null!==l;l=l._nextAdded)l.previousIndex=l.currentIndex;for(this._additionsHead=this._additionsTail=null,l=this._movesHead;null!==l;l=l._nextMoved)l.previousIndex=l.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(l,u,f,p){let _;return null===l?_=this._itTail:(_=l._prev,this._remove(l)),null!==(l=null===this._unlinkedRecords?null:this._unlinkedRecords.get(f,null))?(Object.is(l.item,u)||this._addIdentityChange(l,u),this._reinsertAfter(l,_,p)):null!==(l=null===this._linkedRecords?null:this._linkedRecords.get(f,p))?(Object.is(l.item,u)||this._addIdentityChange(l,u),this._moveAfter(l,_,p)):l=this._addAfter(new ly(u,f),_,p),l}_verifyReinsertion(l,u,f,p){let _=null===this._unlinkedRecords?null:this._unlinkedRecords.get(f,null);return null!==_?l=this._reinsertAfter(_,l._prev,p):l.currentIndex!=p&&(l.currentIndex=p,this._addToMoves(l,p)),l}_truncate(l){for(;null!==l;){const u=l._next;this._addToRemovals(this._unlink(l)),l=u}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(l,u,f){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(l);const p=l._prevRemoved,_=l._nextRemoved;return null===p?this._removalsHead=_:p._nextRemoved=_,null===_?this._removalsTail=p:_._prevRemoved=p,this._insertAfter(l,u,f),this._addToMoves(l,f),l}_moveAfter(l,u,f){return this._unlink(l),this._insertAfter(l,u,f),this._addToMoves(l,f),l}_addAfter(l,u,f){return this._insertAfter(l,u,f),this._additionsTail=null===this._additionsTail?this._additionsHead=l:this._additionsTail._nextAdded=l,l}_insertAfter(l,u,f){const p=null===u?this._itHead:u._next;return l._next=p,l._prev=u,null===p?this._itTail=l:p._prev=l,null===u?this._itHead=l:u._next=l,null===this._linkedRecords&&(this._linkedRecords=new Qb),this._linkedRecords.put(l),l.currentIndex=f,l}_remove(l){return this._addToRemovals(this._unlink(l))}_unlink(l){null!==this._linkedRecords&&this._linkedRecords.remove(l);const u=l._prev,f=l._next;return null===u?this._itHead=f:u._next=f,null===f?this._itTail=u:f._prev=u,l}_addToMoves(l,u){return l.previousIndex===u||(this._movesTail=null===this._movesTail?this._movesHead=l:this._movesTail._nextMoved=l),l}_addToRemovals(l){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Qb),this._unlinkedRecords.put(l),l.currentIndex=null,l._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=l,l._prevRemoved=null):(l._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=l),l}_addIdentityChange(l,u){return l.item=u,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=l:this._identityChangesTail._nextIdentityChange=l,l}}class ly{constructor(l,u){this.item=l,this.trackById=u,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class FI{constructor(){this._head=null,this._tail=null}add(l){null===this._head?(this._head=this._tail=l,l._nextDup=null,l._prevDup=null):(this._tail._nextDup=l,l._prevDup=this._tail,l._nextDup=null,this._tail=l)}get(l,u){let f;for(f=this._head;null!==f;f=f._nextDup)if((null===u||u<=f.currentIndex)&&Object.is(f.trackById,l))return f;return null}remove(l){const u=l._prevDup,f=l._nextDup;return null===u?this._head=f:u._nextDup=f,null===f?this._tail=u:f._prevDup=u,null===this._head}}class Qb{constructor(){this.map=new Map}put(l){const u=l.trackById;let f=this.map.get(u);f||(f=new FI,this.map.set(u,f)),f.add(l)}get(l,u){const p=this.map.get(l);return p?p.get(l,u):null}remove(l){const u=l.trackById;return this.map.get(u).remove(l)&&this.map.delete(u),l}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function cu(a,l,u){const f=a.previousIndex;if(null===f)return f;let p=0;return u&&f<u.length&&(p=u[f]),f+l+p}class Xb{constructor(){}supports(l){return l instanceof Map||Ph(l)}create(){return new BI}}class BI{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(l){let u;for(u=this._mapHead;null!==u;u=u._next)l(u)}forEachPreviousItem(l){let u;for(u=this._previousMapHead;null!==u;u=u._nextPrevious)l(u)}forEachChangedItem(l){let u;for(u=this._changesHead;null!==u;u=u._nextChanged)l(u)}forEachAddedItem(l){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)l(u)}forEachRemovedItem(l){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)l(u)}diff(l){if(l){if(!(l instanceof Map||Ph(l)))throw new Se(900,!1)}else l=new Map;return this.check(l)?this:null}onDestroy(){}check(l){this._reset();let u=this._mapHead;if(this._appendAfter=null,this._forEach(l,(f,p)=>{if(u&&u.key===p)this._maybeAddToChanges(u,f),this._appendAfter=u,u=u._next;else{const _=this._getOrCreateRecordForKey(p,f);u=this._insertBeforeOrAppend(u,_)}}),u){u._prev&&(u._prev._next=null),this._removalsHead=u;for(let f=u;null!==f;f=f._nextRemoved)f===this._mapHead&&(this._mapHead=null),this._records.delete(f.key),f._nextRemoved=f._next,f.previousValue=f.currentValue,f.currentValue=null,f._prev=null,f._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(l,u){if(l){const f=l._prev;return u._next=l,u._prev=f,l._prev=u,f&&(f._next=u),l===this._mapHead&&(this._mapHead=u),this._appendAfter=l,l}return this._appendAfter?(this._appendAfter._next=u,u._prev=this._appendAfter):this._mapHead=u,this._appendAfter=u,null}_getOrCreateRecordForKey(l,u){if(this._records.has(l)){const p=this._records.get(l);this._maybeAddToChanges(p,u);const _=p._prev,w=p._next;return _&&(_._next=w),w&&(w._prev=_),p._next=null,p._prev=null,p}const f=new UI(l);return this._records.set(l,f),f.currentValue=u,this._addToAdditions(f),f}_reset(){if(this.isDirty){let l;for(this._previousMapHead=this._mapHead,l=this._previousMapHead;null!==l;l=l._next)l._nextPrevious=l._next;for(l=this._changesHead;null!==l;l=l._nextChanged)l.previousValue=l.currentValue;for(l=this._additionsHead;null!=l;l=l._nextAdded)l.previousValue=l.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(l,u){Object.is(u,l.currentValue)||(l.previousValue=l.currentValue,l.currentValue=u,this._addToChanges(l))}_addToAdditions(l){null===this._additionsHead?this._additionsHead=this._additionsTail=l:(this._additionsTail._nextAdded=l,this._additionsTail=l)}_addToChanges(l){null===this._changesHead?this._changesHead=this._changesTail=l:(this._changesTail._nextChanged=l,this._changesTail=l)}_forEach(l,u){l instanceof Map?l.forEach(u):Object.keys(l).forEach(f=>u(l[f],f))}}class UI{constructor(l){this.key=l,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Jb(){return new _f([new ay])}let _f=(()=>{class a{constructor(u){this.factories=u}static create(u,f){if(null!=f){const p=f.factories.slice();u=u.concat(p)}return new a(u)}static extend(u){return{provide:a,useFactory:f=>a.create(u,f||Jb()),deps:[[a,new bt,new wa]]}}find(u){const f=this.factories.find(p=>p.supports(u));if(null!=f)return f;throw new Se(901,!1)}}return a.\u0275prov=Dt({token:a,providedIn:"root",factory:Jb}),a})();function ew(){return new cy([new Xb])}let cy=(()=>{class a{constructor(u){this.factories=u}static create(u,f){if(f){const p=f.factories.slice();u=u.concat(p)}return new a(u)}static extend(u){return{provide:a,useFactory:f=>a.create(u,f||ew()),deps:[[a,new bt,new wa]]}}find(u){const f=this.factories.find(p=>p.supports(u));if(f)return f;throw new Se(901,!1)}}return a.\u0275prov=Dt({token:a,providedIn:"root",factory:ew}),a})();const li=zb(null,"core",[]);let jR=(()=>{class a{constructor(u){}}return a.\u0275fac=function(u){return new(u||a)(En(fd))},a.\u0275mod=fe({type:a}),a.\u0275inj=Vt({}),a})();function tw(a){return"boolean"==typeof a?a:null!=a&&"false"!==a}},3942:(Ft,Be,z)=>{z.d(Be,{Z:()=>lt});var h=z(2090),X=z(4859),V=z(6881),de=z(1877);class ye{constructor(Se,ze){this._delegate=Se,this.firebase=ze,(0,V._addComponent)(Se,new X.wA("app-compat",()=>this,"PUBLIC")),this.container=Se.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Se){this._delegate.automaticDataCollectionEnabled=Se}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(Se=>{this._delegate.checkDestroyed(),Se()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,V.deleteApp)(this._delegate)))}_getService(Se,ze=V._DEFAULT_ENTRY_NAME){var qe;this._delegate.checkDestroyed();const st=this._delegate.container.getProvider(Se);return!st.isInitialized()&&"EXPLICIT"===(null===(qe=st.getComponent())||void 0===qe?void 0:qe.instantiationMode)&&st.initialize(),st.getImmediate({identifier:ze})}_removeServiceInstance(Se,ze=V._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(Se).clearInstance(ze)}_addComponent(Se){(0,V._addComponent)(this._delegate,Se)}_addOrOverwriteComponent(Se){(0,V._addOrOverwriteComponent)(this._delegate,Se)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Oe=new h.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),ee=function Ce(){const Et=function Le(Et){const Se={},ze={__esModule:!0,initializeApp:function Ye(Je,wt={}){const At=V.initializeApp(Je,wt);if((0,h.r3)(Se,At.name))return Se[At.name];const cn=new Et(At,ze);return Se[At.name]=cn,cn},app:st,registerVersion:V.registerVersion,setLogLevel:V.setLogLevel,onLog:V.onLog,apps:null,SDK_VERSION:V.SDK_VERSION,INTERNAL:{registerComponent:function je(Je){const wt=Je.name,At=wt.replace("-compat","");if(V._registerComponent(Je)&&"PUBLIC"===Je.type){const cn=(xt=st())=>{if("function"!=typeof xt[At])throw Oe.create("invalid-app-argument",{appName:wt});return xt[At]()};void 0!==Je.serviceProps&&(0,h.ZB)(cn,Je.serviceProps),ze[At]=cn,Et.prototype[At]=function(...xt){return this._getService.bind(this,wt).apply(this,Je.multipleInstances?xt:[])}}return"PUBLIC"===Je.type?ze[At]:null},removeApp:function qe(Je){delete Se[Je]},useAsService:function at(Je,wt){return"serverAuth"===wt?null:wt},modularAPIs:V}};function st(Je){if(!(0,h.r3)(Se,Je=Je||V._DEFAULT_ENTRY_NAME))throw Oe.create("no-app",{appName:Je});return Se[Je]}return ze.default=ze,Object.defineProperty(ze,"apps",{get:function He(){return Object.keys(Se).map(Je=>Se[Je])}}),st.App=Et,ze}(ye);return Et.INTERNAL=Object.assign(Object.assign({},Et.INTERNAL),{createFirebaseNamespace:Ce,extendNamespace:function Se(ze){(0,h.ZB)(Et,ze)},createSubscribe:h.ne,ErrorFactory:h.LL,deepExtend:h.ZB}),Et}(),J=new de.Yd("@firebase/app-compat");if((0,h.jU)()&&void 0!==self.firebase){J.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Et=self.firebase.SDK_VERSION;Et&&Et.indexOf("LITE")>=0&&J.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const lt=ee;!function Ue(Et){(0,V.registerVersion)("@firebase/app-compat","0.2.13",Et)}()},6881:(Ft,Be,z)=>{z.r(Be),z.d(Be,{FirebaseError:()=>de.ZR,SDK_VERSION:()=>En,_DEFAULT_ENTRY_NAME:()=>Mn,_addComponent:()=>ui,_addOrOverwriteComponent:()=>wi,_apps:()=>zt,_clearComponents:()=>zn,_components:()=>nr,_getProvider:()=>zi,_registerComponent:()=>mr,_removeServiceInstance:()=>oa,deleteApp:()=>ns,getApp:()=>Wi,getApps:()=>ir,initializeApp:()=>Or,onLog:()=>bs,registerVersion:()=>Ki,setLogLevel:()=>ws});var h=z(5861),X=z(4859),V=z(1877),de=z(2090);const ye=(xe,fe)=>fe.some(Qe=>xe instanceof Qe);let ue,Oe;const ee=new WeakMap,J=new WeakMap,le=new WeakMap,tt=new WeakMap,Ue=new WeakMap;let Se={get(xe,fe,Qe){if(xe instanceof IDBTransaction){if("done"===fe)return J.get(xe);if("objectStoreNames"===fe)return xe.objectStoreNames||le.get(xe);if("store"===fe)return Qe.objectStoreNames[1]?void 0:Qe.objectStore(Qe.objectStoreNames[0])}return Ye(xe[fe])},set:(xe,fe,Qe)=>(xe[fe]=Qe,!0),has:(xe,fe)=>xe instanceof IDBTransaction&&("done"===fe||"store"===fe)||fe in xe};function st(xe){return"function"==typeof xe?function qe(xe){return xe!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Ce(){return Oe||(Oe=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(xe)?function(...fe){return xe.apply(He(this),fe),Ye(ee.get(this))}:function(...fe){return Ye(xe.apply(He(this),fe))}:function(fe,...Qe){const Tt=xe.call(He(this),fe,...Qe);return le.set(Tt,fe.sort?fe.sort():[fe]),Ye(Tt)}}(xe):(xe instanceof IDBTransaction&&function Et(xe){if(J.has(xe))return;const fe=new Promise((Qe,Tt)=>{const It=()=>{xe.removeEventListener("complete",$t),xe.removeEventListener("error",Lt),xe.removeEventListener("abort",Lt)},$t=()=>{Qe(),It()},Lt=()=>{Tt(xe.error||new DOMException("AbortError","AbortError")),It()};xe.addEventListener("complete",$t),xe.addEventListener("error",Lt),xe.addEventListener("abort",Lt)});J.set(xe,fe)}(xe),ye(xe,function Le(){return ue||(ue=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(xe,Se):xe)}function Ye(xe){if(xe instanceof IDBRequest)return function lt(xe){const fe=new Promise((Qe,Tt)=>{const It=()=>{xe.removeEventListener("success",$t),xe.removeEventListener("error",Lt)},$t=()=>{Qe(Ye(xe.result)),It()},Lt=()=>{Tt(xe.error),It()};xe.addEventListener("success",$t),xe.addEventListener("error",Lt)});return fe.then(Qe=>{Qe instanceof IDBCursor&&ee.set(Qe,xe)}).catch(()=>{}),Ue.set(fe,xe),fe}(xe);if(tt.has(xe))return tt.get(xe);const fe=st(xe);return fe!==xe&&(tt.set(xe,fe),Ue.set(fe,xe)),fe}const He=xe=>Ue.get(xe),Je=["get","getKey","getAll","getAllKeys","count"],wt=["put","add","delete","clear"],At=new Map;function cn(xe,fe){var Qe;if(!(xe instanceof IDBDatabase)||fe in xe||"string"!=typeof fe)return;if(At.get(fe))return At.get(fe);const Tt=fe.replace(/FromIndex$/,""),It=fe!==Tt,$t=wt.includes(Tt);if(!(Tt in(It?IDBIndex:IDBObjectStore).prototype)||!$t&&!Je.includes(Tt))return;const Lt=function(kn){return(Qe=Qe||(0,h.Z)(function*(Xe,...ei){const Pr=this.transaction(Xe,$t?"readwrite":"readonly");let oo=Pr.store;return It&&(oo=oo.index(ei.shift())),(yield Promise.all([oo[Tt](...ei),$t&&Pr.done]))[0]})).apply(this,arguments)};return At.set(fe,Lt),Lt}var xt,_n,Rt;!function ze(xe){Se=xe(Se)}(xe=>({...xe,get:(fe,Qe,Tt)=>cn(fe,Qe)||xe.get(fe,Qe,Tt),has:(fe,Qe)=>!!cn(fe,Qe)||xe.has(fe,Qe)}));class ro{constructor(fe){this.container=fe}getPlatformInfoString(){return this.container.getProviders().map(Qe=>{if(function es(xe){return"VERSION"===xe.getComponent()?.type}(Qe)){const Tt=Qe.getImmediate();return`${Tt.library}/${Tt.version}`}return null}).filter(Qe=>Qe).join(" ")}}const ts="@firebase/app",_e=new V.Yd("@firebase/app"),Mn="[DEFAULT]",Gt={[ts]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},zt=new Map,nr=new Map;function ui(xe,fe){try{xe.container.addComponent(fe)}catch(Qe){_e.debug(`Component ${fe.name} failed to register with FirebaseApp ${xe.name}`,Qe)}}function wi(xe,fe){xe.container.addOrOverwriteComponent(fe)}function mr(xe){const fe=xe.name;if(nr.has(fe))return _e.debug(`There were multiple attempts to register component ${fe}.`),!1;nr.set(fe,xe);for(const Qe of zt.values())ui(Qe,xe);return!0}function zi(xe,fe){const Qe=xe.container.getProvider("heartbeat").getImmediate({optional:!0});return Qe&&Qe.triggerHeartbeat(),xe.container.getProvider(fe)}function oa(xe,fe,Qe=Mn){zi(xe,fe).clearInstance(Qe)}function zn(){nr.clear()}const sn=new de.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class so{constructor(fe,Qe,Tt){this._isDeleted=!1,this._options=Object.assign({},fe),this._config=Object.assign({},Qe),this._name=Qe.name,this._automaticDataCollectionEnabled=Qe.automaticDataCollectionEnabled,this._container=Tt,this.container.addComponent(new X.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(fe){this.checkDestroyed(),this._automaticDataCollectionEnabled=fe}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(fe){this._isDeleted=fe}checkDestroyed(){if(this.isDeleted)throw sn.create("app-deleted",{appName:this._name})}}const En="9.23.0";function Or(xe,fe={}){let Qe=xe;"object"!=typeof fe&&(fe={name:fe});const Tt=Object.assign({name:Mn,automaticDataCollectionEnabled:!1},fe),It=Tt.name;if("string"!=typeof It||!It)throw sn.create("bad-app-name",{appName:String(It)});if(Qe||(Qe=(0,de.aH)()),!Qe)throw sn.create("no-options");const $t=zt.get(It);if($t){if((0,de.vZ)(Qe,$t.options)&&(0,de.vZ)(Tt,$t.config))return $t;throw sn.create("duplicate-app",{appName:It})}const Lt=new X.H0(It);for(const kn of nr.values())Lt.addComponent(kn);const Rn=new so(Qe,Tt,Lt);return zt.set(It,Rn),Rn}function Wi(xe=Mn){const fe=zt.get(xe);if(!fe&&xe===Mn&&(0,de.aH)())return Or();if(!fe)throw sn.create("no-app",{appName:xe});return fe}function ir(){return Array.from(zt.values())}function ns(xe){return(xt=xt||(0,h.Z)(function*(fe){const Qe=fe.name;zt.has(Qe)&&(zt.delete(Qe),yield Promise.all(fe.container.getProviders().map(Tt=>Tt.delete())),fe.isDeleted=!0)})).apply(this,arguments)}function Ki(xe,fe,Qe){var Tt;let It=null!==(Tt=Gt[xe])&&void 0!==Tt?Tt:xe;Qe&&(It+=`-${Qe}`);const $t=It.match(/\s|\//),Lt=fe.match(/\s|\//);if($t||Lt){const Rn=[`Unable to register library "${It}" with version "${fe}":`];return $t&&Rn.push(`library name "${It}" contains illegal characters (whitespace or "/")`),$t&&Lt&&Rn.push("and"),Lt&&Rn.push(`version name "${fe}" contains illegal characters (whitespace or "/")`),void _e.warn(Rn.join(" "))}mr(new X.wA(`${It}-version`,()=>({library:It,version:fe}),"VERSION"))}function bs(xe,fe){if(null!==xe&&"function"!=typeof xe)throw sn.create("invalid-log-argument");(0,V.Am)(xe,fe)}function ws(xe){(0,V.Ub)(xe)}const ne="firebase-heartbeat-database",Z=1,$="firebase-heartbeat-store";let j=null;function U(){return j||(j=function je(xe,fe,{blocked:Qe,upgrade:Tt,blocking:It,terminated:$t}={}){const Lt=indexedDB.open(xe,fe),Rn=Ye(Lt);return Tt&&Lt.addEventListener("upgradeneeded",kn=>{Tt(Ye(Lt.result),kn.oldVersion,kn.newVersion,Ye(Lt.transaction),kn)}),Qe&&Lt.addEventListener("blocked",kn=>Qe(kn.oldVersion,kn.newVersion,kn)),Rn.then(kn=>{$t&&kn.addEventListener("close",()=>$t()),It&&kn.addEventListener("versionchange",Xe=>It(Xe.oldVersion,Xe.newVersion,Xe))}).catch(()=>{}),Rn}(ne,Z,{upgrade:(xe,fe)=>{0===fe&&xe.createObjectStore($)}}).catch(xe=>{throw sn.create("idb-open",{originalErrorMessage:xe.message})})),j}function Re(xe,fe){return(Rt=Rt||(0,h.Z)(function*(Qe,Tt){try{const $t=(yield U()).transaction($,"readwrite");yield $t.objectStore($).put(Tt,ut(Qe)),yield $t.done}catch(It){if(It instanceof de.ZR)_e.warn(It.message);else{const $t=sn.create("idb-set",{originalErrorMessage:It?.message});_e.warn($t.message)}}})).apply(this,arguments)}function ut(xe){return`${xe.name}!${xe.options.appId}`}class dn{constructor(fe){this.container=fe,this._heartbeatsCache=null;const Qe=this.container.getProvider("app").getImmediate();this._storage=new On(Qe),this._heartbeatsCachePromise=this._storage.read().then(Tt=>(this._heartbeatsCache=Tt,Tt))}triggerHeartbeat(){var fe=this;return(0,h.Z)(function*(){const Tt=fe.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),It=Ut();if(null===fe._heartbeatsCache&&(fe._heartbeatsCache=yield fe._heartbeatsCachePromise),fe._heartbeatsCache.lastSentHeartbeatDate!==It&&!fe._heartbeatsCache.heartbeats.some($t=>$t.date===It))return fe._heartbeatsCache.heartbeats.push({date:It,agent:Tt}),fe._heartbeatsCache.heartbeats=fe._heartbeatsCache.heartbeats.filter($t=>{const Lt=new Date($t.date).valueOf();return Date.now()-Lt<=2592e6}),fe._storage.overwrite(fe._heartbeatsCache)})()}getHeartbeatsHeader(){var fe=this;return(0,h.Z)(function*(){if(null===fe._heartbeatsCache&&(yield fe._heartbeatsCachePromise),null===fe._heartbeatsCache||0===fe._heartbeatsCache.heartbeats.length)return"";const Qe=Ut(),{heartbeatsToSend:Tt,unsentEntries:It}=function qn(xe,fe=1024){const Qe=[];let Tt=xe.slice();for(const It of xe){const $t=Qe.find(Lt=>Lt.agent===It.agent);if($t){if($t.dates.push(It.date),Hr(Qe)>fe){$t.dates.pop();break}}else if(Qe.push({agent:It.agent,dates:[It.date]}),Hr(Qe)>fe){Qe.pop();break}Tt=Tt.slice(1)}return{heartbeatsToSend:Qe,unsentEntries:Tt}}(fe._heartbeatsCache.heartbeats),$t=(0,de.L)(JSON.stringify({version:2,heartbeats:Tt}));return fe._heartbeatsCache.lastSentHeartbeatDate=Qe,It.length>0?(fe._heartbeatsCache.heartbeats=It,yield fe._storage.overwrite(fe._heartbeatsCache)):(fe._heartbeatsCache.heartbeats=[],fe._storage.overwrite(fe._heartbeatsCache)),$t})()}}function Ut(){return(new Date).toISOString().substring(0,10)}class On{constructor(fe){this.app=fe,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,h.Z)(function*(){return!!(0,de.hl)()&&(0,de.eu)().then(()=>!0).catch(()=>!1)})()}read(){var fe=this;return(0,h.Z)(function*(){return(yield fe._canUseIndexedDBPromise)&&(yield function ie(xe){return(_n=_n||(0,h.Z)(function*(fe){try{return yield(yield U()).transaction($).objectStore($).get(ut(fe))}catch(Qe){if(Qe instanceof de.ZR)_e.warn(Qe.message);else{const Tt=sn.create("idb-get",{originalErrorMessage:Qe?.message});_e.warn(Tt.message)}}})).apply(this,arguments)}(fe.app))||{heartbeats:[]}})()}overwrite(fe){var Qe=this;return(0,h.Z)(function*(){var Tt;if(yield Qe._canUseIndexedDBPromise){const $t=yield Qe.read();return Re(Qe.app,{lastSentHeartbeatDate:null!==(Tt=fe.lastSentHeartbeatDate)&&void 0!==Tt?Tt:$t.lastSentHeartbeatDate,heartbeats:fe.heartbeats})}})()}add(fe){var Qe=this;return(0,h.Z)(function*(){var Tt;if(yield Qe._canUseIndexedDBPromise){const $t=yield Qe.read();return Re(Qe.app,{lastSentHeartbeatDate:null!==(Tt=fe.lastSentHeartbeatDate)&&void 0!==Tt?Tt:$t.lastSentHeartbeatDate,heartbeats:[...$t.heartbeats,...fe.heartbeats]})}})()}}function Hr(xe){return(0,de.L)(JSON.stringify({version:2,heartbeats:xe})).length}!function is(xe){mr(new X.wA("platform-logger",fe=>new ro(fe),"PRIVATE")),mr(new X.wA("heartbeat",fe=>new dn(fe),"PRIVATE")),Ki(ts,"0.9.13",xe),Ki(ts,"0.9.13","esm2017"),Ki("fire-js","")}("")},4859:(Ft,Be,z)=>{z.d(Be,{H0:()=>Le,wA:()=>V});var h=z(5861),X=z(2090);class V{constructor(ee,J,le){this.name=ee,this.instanceFactory=J,this.type=le,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(ee){return this.instantiationMode=ee,this}setMultipleInstances(ee){return this.multipleInstances=ee,this}setServiceProps(ee){return this.serviceProps=ee,this}setInstanceCreatedCallback(ee){return this.onInstanceCreated=ee,this}}const de="[DEFAULT]";class ye{constructor(ee,J){this.name=ee,this.container=J,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(ee){const J=this.normalizeInstanceIdentifier(ee);if(!this.instancesDeferred.has(J)){const le=new X.BH;if(this.instancesDeferred.set(J,le),this.isInitialized(J)||this.shouldAutoInitialize())try{const tt=this.getOrInitializeService({instanceIdentifier:J});tt&&le.resolve(tt)}catch{}}return this.instancesDeferred.get(J).promise}getImmediate(ee){var J;const le=this.normalizeInstanceIdentifier(ee?.identifier),tt=null!==(J=ee?.optional)&&void 0!==J&&J;if(!this.isInitialized(le)&&!this.shouldAutoInitialize()){if(tt)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:le})}catch(Ue){if(tt)return null;throw Ue}}getComponent(){return this.component}setComponent(ee){if(ee.name!==this.name)throw Error(`Mismatching Component ${ee.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=ee,this.shouldAutoInitialize()){if(function Oe(Ce){return"EAGER"===Ce.instantiationMode}(ee))try{this.getOrInitializeService({instanceIdentifier:de})}catch{}for(const[J,le]of this.instancesDeferred.entries()){const tt=this.normalizeInstanceIdentifier(J);try{const Ue=this.getOrInitializeService({instanceIdentifier:tt});le.resolve(Ue)}catch{}}}}clearInstance(ee=de){this.instancesDeferred.delete(ee),this.instancesOptions.delete(ee),this.instances.delete(ee)}delete(){var ee=this;return(0,h.Z)(function*(){const J=Array.from(ee.instances.values());yield Promise.all([...J.filter(le=>"INTERNAL"in le).map(le=>le.INTERNAL.delete()),...J.filter(le=>"_delete"in le).map(le=>le._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(ee=de){return this.instances.has(ee)}getOptions(ee=de){return this.instancesOptions.get(ee)||{}}initialize(ee={}){const{options:J={}}=ee,le=this.normalizeInstanceIdentifier(ee.instanceIdentifier);if(this.isInitialized(le))throw Error(`${this.name}(${le}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const tt=this.getOrInitializeService({instanceIdentifier:le,options:J});for(const[Ue,lt]of this.instancesDeferred.entries())le===this.normalizeInstanceIdentifier(Ue)&&lt.resolve(tt);return tt}onInit(ee,J){var le;const tt=this.normalizeInstanceIdentifier(J),Ue=null!==(le=this.onInitCallbacks.get(tt))&&void 0!==le?le:new Set;Ue.add(ee),this.onInitCallbacks.set(tt,Ue);const lt=this.instances.get(tt);return lt&&ee(lt,tt),()=>{Ue.delete(ee)}}invokeOnInitCallbacks(ee,J){const le=this.onInitCallbacks.get(J);if(le)for(const tt of le)try{tt(ee,J)}catch{}}getOrInitializeService({instanceIdentifier:ee,options:J={}}){let le=this.instances.get(ee);if(!le&&this.component&&(le=this.component.instanceFactory(this.container,{instanceIdentifier:(Ce=ee,Ce===de?void 0:Ce),options:J}),this.instances.set(ee,le),this.instancesOptions.set(ee,J),this.invokeOnInitCallbacks(le,ee),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,ee,le)}catch{}var Ce;return le||null}normalizeInstanceIdentifier(ee=de){return this.component?this.component.multipleInstances?ee:de:ee}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Le{constructor(ee){this.name=ee,this.providers=new Map}addComponent(ee){const J=this.getProvider(ee.name);if(J.isComponentSet())throw new Error(`Component ${ee.name} has already been registered with ${this.name}`);J.setComponent(ee)}addOrOverwriteComponent(ee){this.getProvider(ee.name).isComponentSet()&&this.providers.delete(ee.name),this.addComponent(ee)}getProvider(ee){if(this.providers.has(ee))return this.providers.get(ee);const J=new ye(ee,this);return this.providers.set(ee,J),J}getProviders(){return Array.from(this.providers.values())}}},1877:(Ft,Be,z)=>{z.d(Be,{Am:()=>Ce,Ub:()=>Le,Yd:()=>Oe,in:()=>X});const h=[];var X=(()=>{return(ee=X||(X={}))[ee.DEBUG=0]="DEBUG",ee[ee.VERBOSE=1]="VERBOSE",ee[ee.INFO=2]="INFO",ee[ee.WARN=3]="WARN",ee[ee.ERROR=4]="ERROR",ee[ee.SILENT=5]="SILENT",X;var ee})();const V={debug:X.DEBUG,verbose:X.VERBOSE,info:X.INFO,warn:X.WARN,error:X.ERROR,silent:X.SILENT},de=X.INFO,ye={[X.DEBUG]:"log",[X.VERBOSE]:"log",[X.INFO]:"info",[X.WARN]:"warn",[X.ERROR]:"error"},ue=(ee,J,...le)=>{if(J<ee.logLevel)return;const tt=(new Date).toISOString(),Ue=ye[J];if(!Ue)throw new Error(`Attempted to log a message with an invalid logType (value: ${J})`);console[Ue](`[${tt}]  ${ee.name}:`,...le)};class Oe{constructor(J){this.name=J,this._logLevel=de,this._logHandler=ue,this._userLogHandler=null,h.push(this)}get logLevel(){return this._logLevel}set logLevel(J){if(!(J in X))throw new TypeError(`Invalid value "${J}" assigned to \`logLevel\``);this._logLevel=J}setLogLevel(J){this._logLevel="string"==typeof J?V[J]:J}get logHandler(){return this._logHandler}set logHandler(J){if("function"!=typeof J)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=J}get userLogHandler(){return this._userLogHandler}set userLogHandler(J){this._userLogHandler=J}debug(...J){this._userLogHandler&&this._userLogHandler(this,X.DEBUG,...J),this._logHandler(this,X.DEBUG,...J)}log(...J){this._userLogHandler&&this._userLogHandler(this,X.VERBOSE,...J),this._logHandler(this,X.VERBOSE,...J)}info(...J){this._userLogHandler&&this._userLogHandler(this,X.INFO,...J),this._logHandler(this,X.INFO,...J)}warn(...J){this._userLogHandler&&this._userLogHandler(this,X.WARN,...J),this._logHandler(this,X.WARN,...J)}error(...J){this._userLogHandler&&this._userLogHandler(this,X.ERROR,...J),this._logHandler(this,X.ERROR,...J)}}function Le(ee){h.forEach(J=>{J.setLogLevel(ee)})}function Ce(ee,J){for(const le of h){let tt=null;J&&J.level&&(tt=V[J.level]),le.userLogHandler=null===ee?null:(Ue,lt,...Et)=>{const Se=Et.map(ze=>{if(null==ze)return null;if("string"==typeof ze)return ze;if("number"==typeof ze||"boolean"==typeof ze)return ze.toString();if(ze instanceof Error)return ze.message;try{return JSON.stringify(ze)}catch{return null}}).filter(ze=>ze).join(" ");lt>=(tt??Ue.logLevel)&&ee({level:X[lt].toLowerCase(),message:Se,args:Et,type:Ue.name})}}}},259:(Ft,Be,z)=>{z.d(Be,{C6:()=>h.getApps,KN:()=>h.registerVersion,Mq:()=>h.getApp,ZF:()=>h.initializeApp});var h=z(6881);(0,h.registerVersion)("firebase","9.23.0","app")},9260:(Ft,Be,z)=>{z.d(Be,{Z:()=>h.Z});var h=z(3942);h.Z.registerVersion("firebase","9.23.0","app-compat")},9568:(Ft,Be,z)=>{z.r(Be);var Le,Ce,ee,J,le,h=z(5861),X=z(3942),V=z(1389),de=z(2090),Oe=(z(6881),z(1877),z(4859));function tt(){return window}const Ue=2e3;const He=20;class je extends V.aB{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(j=>{this.resolveInialized=j})}addPassiveListener(j){this.passiveListeners.add(j)}removePassiveListener(j){this.passiveListeners.delete(j)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(j){return this.resolveInialized(),this.passiveListeners.forEach(U=>U(j)),super.onEvent(j)}initialized(){var j=this;return(0,h.Z)(function*(){yield j.initPromise})()}}function wt($){return(le=le||(0,h.Z)(function*(j){const U=yield xt()._get(_n(j));return U&&(yield xt()._remove(_n(j))),U})).apply(this,arguments)}function cn(){const $=[],j="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let U=0;U<He;U++){const ie=Math.floor(Math.random()*j.length);$.push(j.charAt(ie))}return $.join("")}function xt(){return(0,V.aC)(V.b)}function _n($){return(0,V.aD)("authEvent",$.config.apiKey,$.name)}function es($){if(!$?.includes("?"))return{};const[j,...U]=$.split("?");return(0,de.zd)(U.join("?"))}const _e=class Hs{constructor(){this._redirectPersistence=V.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=V.aE,this._overrideRedirectResult=V.aF}_initialize(j){var U=this;return(0,h.Z)(function*(){const ie=j._key();let Re=U.eventManagers.get(ie);return Re||(Re=new je(j),U.eventManagers.set(ie,Re),U.attachCallbackListeners(j,Re)),Re})()}_openPopup(j){(0,V.av)(j,"operation-not-supported-in-this-environment")}_openRedirect(j,U,ie,Re){var ut=this;return(0,h.Z)(function*(){!function qe($){var j,U,ie,Re,ut,tn,Yt,dn,Ut,qn;const On=tt();(0,V.aA)("function"==typeof(null===(j=On?.universalLinks)||void 0===j?void 0:j.subscribe),$,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,V.aA)(typeof(null===(U=On?.BuildInfo)||void 0===U?void 0:U.packageName)<"u",$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,V.aA)("function"==typeof(null===(ut=null===(Re=null===(ie=On?.cordova)||void 0===ie?void 0:ie.plugins)||void 0===Re?void 0:Re.browsertab)||void 0===ut?void 0:ut.openUrl),$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,V.aA)("function"==typeof(null===(dn=null===(Yt=null===(tn=On?.cordova)||void 0===tn?void 0:tn.plugins)||void 0===Yt?void 0:Yt.browsertab)||void 0===dn?void 0:dn.isAvailable),$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,V.aA)("function"==typeof(null===(qn=null===(Ut=On?.cordova)||void 0===Ut?void 0:Ut.InAppBrowser)||void 0===qn?void 0:qn.open),$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(j);const tn=yield ut._initialize(j);yield tn.initialized(),tn.resetRedirect(),(0,V.aG)(),yield ut._originValidation(j);const Yt=function at($,j,U=null){return{type:j,eventId:U,urlResponse:null,sessionId:cn(),postBody:null,tenantId:$.tenantId,error:(0,V.az)($,"no-auth-event")}}(j,ie,Re);yield function Je($,j){return xt()._set(_n($),j)}(j,Yt);const dn=yield function lt($,j,U){return(Le=Le||(0,h.Z)(function*(ie,Re,ut){var tn;const{BuildInfo:Yt}=tt();(0,V.as)(Re.sessionId,"AuthEvent did not contain a session ID");const dn=yield function st($){return(J=J||(0,h.Z)(function*(j){const U=function Ye($){if((0,V.as)(/[0-9a-zA-Z]+/.test($),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode($);const j=new ArrayBuffer($.length),U=new Uint8Array(j);for(let ie=0;ie<$.length;ie++)U[ie]=$.charCodeAt(ie);return U}(j),ie=yield crypto.subtle.digest("SHA-256",U);return Array.from(new Uint8Array(ie)).map(ut=>ut.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}(Re.sessionId),Ut={};return(0,V.at)()?Ut.ibi=Yt.packageName:(0,V.au)()?Ut.apn=Yt.packageName:(0,V.av)(ie,"operation-not-supported-in-this-environment"),Yt.displayName&&(Ut.appDisplayName=Yt.displayName),Ut.sessionId=dn,(0,V.aw)(ie,ut,Re.type,void 0,null!==(tn=Re.eventId)&&void 0!==tn?tn:void 0,Ut)})).apply(this,arguments)}(j,Yt,U),Ut=yield function Se($){const{cordova:j}=tt();return new Promise(U=>{j.plugins.browsertab.isAvailable(ie=>{let Re=null;ie?j.plugins.browsertab.openUrl($):Re=j.InAppBrowser.open($,(0,V.ay)()?"_blank":"_system","location=yes"),U(Re)})})}(dn);return function ze($,j,U){return(ee=ee||(0,h.Z)(function*(ie,Re,ut){const{cordova:tn}=tt();let Yt=()=>{};try{yield new Promise((dn,Ut)=>{let qn=null;function On(){var xe;dn();const fe=null===(xe=tn.plugins.browsertab)||void 0===xe?void 0:xe.close;"function"==typeof fe&&fe(),"function"==typeof ut?.close&&ut.close()}function Hr(){qn||(qn=window.setTimeout(()=>{Ut((0,V.az)(ie,"redirect-cancelled-by-user"))},Ue))}function is(){"visible"===document?.visibilityState&&Hr()}Re.addPassiveListener(On),document.addEventListener("resume",Hr,!1),(0,V.au)()&&document.addEventListener("visibilitychange",is,!1),Yt=()=>{Re.removePassiveListener(On),document.removeEventListener("resume",Hr,!1),document.removeEventListener("visibilitychange",is,!1),qn&&window.clearTimeout(qn)}})}finally{Yt()}})).apply(this,arguments)}(j,tn,Ut)})()}_isIframeWebStorageSupported(j,U){throw new Error("Method not implemented.")}_originValidation(j){const U=j._key();return this.originValidationPromises[U]||(this.originValidationPromises[U]=function Et($){return(Ce=Ce||(0,h.Z)(function*(j){const{BuildInfo:U}=tt(),ie={};(0,V.at)()?ie.iosBundleId=U.packageName:(0,V.au)()?ie.androidPackageName=U.packageName:(0,V.av)(j,"operation-not-supported-in-this-environment"),yield(0,V.ax)(j,ie)})).apply(this,arguments)}(j)),this.originValidationPromises[U]}attachCallbackListeners(j,U){var ie,Re;const{universalLinks:ut,handleOpenURL:tn,BuildInfo:Yt}=tt(),dn=setTimeout((0,h.Z)(function*(){yield wt(j),U.onEvent(Ee())}),500),Ut=function(is){return(ie=ie||(0,h.Z)(function*(xe){clearTimeout(dn);const fe=yield wt(j);let Qe=null;fe&&xe?.url&&(Qe=function At($,j){var U,ie;const Re=function ro($){const j=es($),U=j.link?decodeURIComponent(j.link):void 0,ie=es(U).link,Re=j.deep_link_id?decodeURIComponent(j.deep_link_id):void 0;return es(Re).link||Re||ie||U||$}(j);if(Re.includes("/__/auth/callback")){const ut=es(Re),tn=ut.firebaseError?function Rt($){try{return JSON.parse($)}catch{return null}}(decodeURIComponent(ut.firebaseError)):null,Yt=null===(ie=null===(U=tn?.code)||void 0===U?void 0:U.split("auth/"))||void 0===ie?void 0:ie[1],dn=Yt?(0,V.az)(Yt):null;return dn?{type:$.type,eventId:$.eventId,tenantId:$.tenantId,error:dn,urlResponse:null,sessionId:null,postBody:null}:{type:$.type,eventId:$.eventId,tenantId:$.tenantId,sessionId:$.sessionId,urlResponse:Re,postBody:null}}return null}(fe,xe.url)),U.onEvent(Qe||Ee())})).apply(this,arguments)};typeof ut<"u"&&"function"==typeof ut.subscribe&&ut.subscribe(null,Ut);const qn=tn,On=`${Yt.packageName.toLowerCase()}://`;tt().handleOpenURL=function(Hr){return(Re=Re||(0,h.Z)(function*(is){if(is.toLowerCase().startsWith(On)&&Ut({url:is}),"function"==typeof qn)try{qn(is)}catch(xe){console.error(xe)}})).apply(this,arguments)}}};function Ee(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,V.az)("no-auth-event")}}var pe,it,Ze;const ci=1e3;function Vt(){var $;return(null===($=self?.location)||void 0===$?void 0:$.protocol)||null}function si($=(0,de.z$)()){return!("file:"!==Vt()&&"ionic:"!==Vt()&&"capacitor:"!==Vt()||!$.toLowerCase().match(/iphone|ipad|ipod|android/))}function Oi(){try{const $=self.localStorage,j=V.aL();if($)return $.setItem(j,"1"),$.removeItem(j),!function gi($=(0,de.z$)()){return function Mi(){return(0,de.w1)()&&11===document?.documentMode}()||function Li($=(0,de.z$)()){return/Edge\/\d+/.test($)}($)}()||(0,de.hl)()}catch{return tr()&&(0,de.hl)()}return!1}function tr(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function bi(){return(function Tn(){return"http:"===Vt()||"https:"===Vt()}()||(0,de.ru)()||si())&&!function Gn(){return(0,de.b$)()||(0,de.UG)()}()&&Oi()&&!tr()}function Bt(){return si()&&typeof document<"u"}const Pn={LOCAL:"local",NONE:"none",SESSION:"session"},$r=V.aA,Ii="persistence";function Mn($){return(it=it||(0,h.Z)(function*(j){yield j._initializationPromise;const U=zt(),ie=V.aD(Ii,j.config.apiKey,j.name);U&&U.setItem(ie,j._getPersistence())})).apply(this,arguments)}function zt(){var $;try{return(null===($=function sa(){return typeof window<"u"?window:null}())||void 0===$?void 0:$.sessionStorage)||null}catch{return null}}const nr=V.aA;class ui{constructor(){this.browserResolver=V.aC(V.k),this.cordovaResolver=V.aC(_e),this.underlyingResolver=null,this._redirectPersistence=V.a,this._completeRedirectFn=V.aE,this._overrideRedirectResult=V.aF}_initialize(j){var U=this;return(0,h.Z)(function*(){return yield U.selectUnderlyingResolver(),U.assertedUnderlyingResolver._initialize(j)})()}_openPopup(j,U,ie,Re){var ut=this;return(0,h.Z)(function*(){return yield ut.selectUnderlyingResolver(),ut.assertedUnderlyingResolver._openPopup(j,U,ie,Re)})()}_openRedirect(j,U,ie,Re){var ut=this;return(0,h.Z)(function*(){return yield ut.selectUnderlyingResolver(),ut.assertedUnderlyingResolver._openRedirect(j,U,ie,Re)})()}_isIframeWebStorageSupported(j,U){this.assertedUnderlyingResolver._isIframeWebStorageSupported(j,U)}_originValidation(j){return this.assertedUnderlyingResolver._originValidation(j)}get _shouldInitProactively(){return Bt()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return nr(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var j=this;return(0,h.Z)(function*(){if(j.underlyingResolver)return;const U=yield function vs(){return(pe=pe||(0,h.Z)(function*(){return!!Bt()&&new Promise($=>{const j=setTimeout(()=>{$(!1)},ci);document.addEventListener("deviceready",()=>{clearTimeout(j),$(!0)})})})).apply(this,arguments)}();j.underlyingResolver=U?j.cordovaResolver:j.browserResolver})()}}function wi($){return $.unwrap()}function zi($){return zn($)}function zn($){const{_tokenResponse:j}=$ instanceof de.ZR?$.customData:$;if(!j)return null;if(!($ instanceof de.ZR)&&"temporaryProof"in j&&"phoneNumber"in j)return V.P.credentialFromResult($);const U=j.providerId;if(!U||U===V.p.PASSWORD)return null;let ie;switch(U){case V.p.GOOGLE:ie=V.V;break;case V.p.FACEBOOK:ie=V.U;break;case V.p.GITHUB:ie=V.W;break;case V.p.TWITTER:ie=V.Z;break;default:const{oauthIdToken:Re,oauthAccessToken:ut,oauthTokenSecret:tn,pendingToken:Yt,nonce:dn}=j;return ut||tn||Re||Yt?Yt?U.startsWith("saml.")?V.aO._create(U,Yt):V.L._fromParams({providerId:U,signInMethod:U,pendingToken:Yt,idToken:Re,accessToken:ut}):new V.X(U).credential({idToken:Re,accessToken:ut,rawNonce:dn}):null}return $ instanceof de.ZR?ie.credentialFromError($):ie.credentialFromResult($)}function di($,j){return j.catch(U=>{throw U instanceof de.ZR&&function oa($,j){var U;const ie=null===(U=j.customData)||void 0===U?void 0:U._tokenResponse;if("auth/multi-factor-auth-required"===j?.code)j.resolver=new so($,V.aq($,j));else if(ie){const Re=zn(j),ut=j;Re&&(ut.credential=Re,ut.tenantId=ie.tenantId||void 0,ut.email=ie.email||void 0,ut.phoneNumber=ie.phoneNumber||void 0)}}($,U),U}).then(U=>{const Re=U.user;return{operationType:U.operationType,credential:zi(U),additionalUserInfo:V.ao(U),user:En.getOrCreate(Re)}})}function sn($,j){return(Ze=Ze||(0,h.Z)(function*(U,ie){const Re=yield ie;return{verificationId:Re.verificationId,confirm:ut=>di(U,Re.confirm(ut))}})).apply(this,arguments)}class so{constructor(j,U){this.resolver=U,this.auth=function mr($){return $.wrapped()}(j)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(j){return di(wi(this.auth),this.resolver.resolveSignIn(j))}}class En{constructor(j){this._delegate=j,this.multiFactor=V.ar(j)}static getOrCreate(j){return En.USER_MAP.has(j)||En.USER_MAP.set(j,new En(j)),En.USER_MAP.get(j)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(j){return this._delegate.getIdTokenResult(j)}getIdToken(j){return this._delegate.getIdToken(j)}linkAndRetrieveDataWithCredential(j){return this.linkWithCredential(j)}linkWithCredential(j){var U=this;return(0,h.Z)(function*(){return di(U.auth,V.a0(U._delegate,j))})()}linkWithPhoneNumber(j,U){var ie=this;return(0,h.Z)(function*(){return sn(ie.auth,V.l(ie._delegate,j,U))})()}linkWithPopup(j){var U=this;return(0,h.Z)(function*(){return di(U.auth,V.d(U._delegate,j,ui))})()}linkWithRedirect(j){var U=this;return(0,h.Z)(function*(){return yield Mn(V.aH(U.auth)),V.g(U._delegate,j,ui)})()}reauthenticateAndRetrieveDataWithCredential(j){return this.reauthenticateWithCredential(j)}reauthenticateWithCredential(j){var U=this;return(0,h.Z)(function*(){return di(U.auth,V.a1(U._delegate,j))})()}reauthenticateWithPhoneNumber(j,U){return sn(this.auth,V.r(this._delegate,j,U))}reauthenticateWithPopup(j){return di(this.auth,V.e(this._delegate,j,ui))}reauthenticateWithRedirect(j){var U=this;return(0,h.Z)(function*(){return yield Mn(V.aH(U.auth)),V.h(U._delegate,j,ui)})()}sendEmailVerification(j){return V.ae(this._delegate,j)}unlink(j){var U=this;return(0,h.Z)(function*(){return yield V.an(U._delegate,j),U})()}updateEmail(j){return V.aj(this._delegate,j)}updatePassword(j){return V.ak(this._delegate,j)}updatePhoneNumber(j){return V.u(this._delegate,j)}updateProfile(j){return V.ai(this._delegate,j)}verifyBeforeUpdateEmail(j,U){return V.af(this._delegate,j,U)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}En.USER_MAP=new WeakMap;const Or=V.aA;let Wi=(()=>{class ${constructor(U,ie){if(this.app=U,ie.isInitialized())return this._delegate=ie.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:Re}=U.options;Or(Re,"invalid-api-key",{appName:U.name}),Or(Re,"invalid-api-key",{appName:U.name});const ut=typeof window<"u"?ui:void 0;this._delegate=ie.initialize({options:{persistence:ns(Re,U.name),popupRedirectResolver:ut}}),this._delegate._updateErrorMap(V.D),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?En.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(U){this._delegate.languageCode=U}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(U){this._delegate.tenantId=U}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(U,ie){V.I(this._delegate,U,ie)}applyActionCode(U){return V.a5(this._delegate,U)}checkActionCode(U){return V.a6(this._delegate,U)}confirmPasswordReset(U,ie){return V.a4(this._delegate,U,ie)}createUserWithEmailAndPassword(U,ie){var Re=this;return(0,h.Z)(function*(){return di(Re._delegate,V.a8(Re._delegate,U,ie))})()}fetchProvidersForEmail(U){return this.fetchSignInMethodsForEmail(U)}fetchSignInMethodsForEmail(U){return V.ad(this._delegate,U)}isSignInWithEmailLink(U){return V.ab(this._delegate,U)}getRedirectResult(){var U=this;return(0,h.Z)(function*(){Or(bi(),U._delegate,"operation-not-supported-in-this-environment");const ie=yield V.j(U._delegate,ui);return ie?di(U._delegate,Promise.resolve(ie)):{credential:null,user:null}})()}addFrameworkForLogging(U){!function Ie($,j){(0,V.aH)($)._logFramework(j)}(this._delegate,U)}onAuthStateChanged(U,ie,Re){const{next:ut,error:tn,complete:Yt}=ir(U,ie,Re);return this._delegate.onAuthStateChanged(ut,tn,Yt)}onIdTokenChanged(U,ie,Re){const{next:ut,error:tn,complete:Yt}=ir(U,ie,Re);return this._delegate.onIdTokenChanged(ut,tn,Yt)}sendSignInLinkToEmail(U,ie){return V.aa(this._delegate,U,ie)}sendPasswordResetEmail(U,ie){return V.a3(this._delegate,U,ie||void 0)}setPersistence(U){var ie=this;return(0,h.Z)(function*(){let Re;switch(function ni($,j){$r(Object.values(Pn).includes(j),$,"invalid-persistence-type"),(0,de.b$)()?$r(j!==Pn.SESSION,$,"unsupported-persistence-type"):(0,de.UG)()?$r(j===Pn.NONE,$,"unsupported-persistence-type"):tr()?$r(j===Pn.NONE||j===Pn.LOCAL&&(0,de.hl)(),$,"unsupported-persistence-type"):$r(j===Pn.NONE||Oi(),$,"unsupported-persistence-type")}(ie._delegate,U),U){case Pn.SESSION:Re=V.a;break;case Pn.LOCAL:Re=(yield V.aC(V.i)._isAvailable())?V.i:V.b;break;case Pn.NONE:Re=V.N;break;default:return V.av("argument-error",{appName:ie._delegate.name})}return ie._delegate.setPersistence(Re)})()}signInAndRetrieveDataWithCredential(U){return this.signInWithCredential(U)}signInAnonymously(){return di(this._delegate,V._(this._delegate))}signInWithCredential(U){return di(this._delegate,V.$(this._delegate,U))}signInWithCustomToken(U){return di(this._delegate,V.a2(this._delegate,U))}signInWithEmailAndPassword(U,ie){return di(this._delegate,V.a9(this._delegate,U,ie))}signInWithEmailLink(U,ie){return di(this._delegate,V.ac(this._delegate,U,ie))}signInWithPhoneNumber(U,ie){return sn(this._delegate,V.s(this._delegate,U,ie))}signInWithPopup(U){var ie=this;return(0,h.Z)(function*(){return Or(bi(),ie._delegate,"operation-not-supported-in-this-environment"),di(ie._delegate,V.c(ie._delegate,U,ui))})()}signInWithRedirect(U){var ie=this;return(0,h.Z)(function*(){return Or(bi(),ie._delegate,"operation-not-supported-in-this-environment"),yield Mn(ie._delegate),V.f(ie._delegate,U,ui)})()}updateCurrentUser(U){return this._delegate.updateCurrentUser(U)}verifyPasswordResetCode(U){return V.a7(this._delegate,U)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return $.Persistence=Pn,$})();function ir($,j,U){let ie=$;"function"!=typeof $&&({next:ie,error:j,complete:U}=$);const Re=ie;return{next:tn=>Re(tn&&En.getOrCreate(tn)),error:j,complete:U}}function ns($,j){const U=function Gt($,j){const U=zt();if(!U)return[];const ie=V.aD(Ii,$,j);switch(U.getItem(ie)){case Pn.NONE:return[V.N];case Pn.LOCAL:return[V.i,V.a];case Pn.SESSION:return[V.a];default:return[]}}($,j);if(typeof self<"u"&&!U.includes(V.i)&&U.push(V.i),typeof window<"u")for(const ie of[V.b,V.a])U.includes(ie)||U.push(ie);return U.includes(V.N)||U.push(V.N),U}class Ki{constructor(){this.providerId="phone",this._delegate=new V.P(wi(X.Z.auth()))}static credential(j,U){return V.P.credential(j,U)}verifyPhoneNumber(j,U){return this._delegate.verifyPhoneNumber(j,U)}unwrap(){return this._delegate}}Ki.PHONE_SIGN_IN_METHOD=V.P.PHONE_SIGN_IN_METHOD,Ki.PROVIDER_ID=V.P.PROVIDER_ID;const bs=V.aA;class ws{constructor(j,U,ie=X.Z.app()){var Re;bs(null===(Re=ie.options)||void 0===Re?void 0:Re.apiKey,"invalid-api-key",{appName:ie.name}),this._delegate=new V.R(j,U,ie.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function Z($){$.INTERNAL.registerComponent(new Oe.wA("auth-compat",j=>{const U=j.getProvider("app-compat").getImmediate(),ie=j.getProvider("auth");return new Wi(U,ie)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:V.A.EMAIL_SIGNIN,PASSWORD_RESET:V.A.PASSWORD_RESET,RECOVER_EMAIL:V.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:V.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:V.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:V.A.VERIFY_EMAIL}},EmailAuthProvider:V.Q,FacebookAuthProvider:V.U,GithubAuthProvider:V.W,GoogleAuthProvider:V.V,OAuthProvider:V.X,SAMLAuthProvider:V.Y,PhoneAuthProvider:Ki,PhoneMultiFactorGenerator:V.m,RecaptchaVerifier:ws,TwitterAuthProvider:V.Z,Auth:Wi,AuthCredential:V.J,Error:de.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),$.registerVersion("@firebase/auth-compat","0.4.2")}(X.Z)},5861:(Ft,Be,z)=>{function h(V,de,ye,ue,Oe,Le,Ce){try{var ee=V[Le](Ce),J=ee.value}catch(le){return void ye(le)}ee.done?de(J):Promise.resolve(J).then(ue,Oe)}function X(V){return function(){var de=this,ye=arguments;return new Promise(function(ue,Oe){var Le=V.apply(de,ye);function Ce(J){h(Le,ue,Oe,Ce,ee,"next",J)}function ee(J){h(Le,ue,Oe,Ce,ee,"throw",J)}Ce(void 0)})}}z.d(Be,{Z:()=>X})},7582:(Ft,Be,z)=>{function de(_e,Ee){var Ie={};for(var pe in _e)Object.prototype.hasOwnProperty.call(_e,pe)&&Ee.indexOf(pe)<0&&(Ie[pe]=_e[pe]);if(null!=_e&&"function"==typeof Object.getOwnPropertySymbols){var it=0;for(pe=Object.getOwnPropertySymbols(_e);it<pe.length;it++)Ee.indexOf(pe[it])<0&&Object.prototype.propertyIsEnumerable.call(_e,pe[it])&&(Ie[pe[it]]=_e[pe[it]])}return Ie}function le(_e,Ee,Ie,pe){return new(Ie||(Ie=Promise))(function(Ze,jt){function Dt(Tn){try{Vt(pe.next(Tn))}catch(si){jt(si)}}function ci(Tn){try{Vt(pe.throw(Tn))}catch(si){jt(si)}}function Vt(Tn){Tn.done?Ze(Tn.value):function it(Ze){return Ze instanceof Ie?Ze:new Ie(function(jt){jt(Ze)})}(Tn.value).then(Dt,ci)}Vt((pe=pe.apply(_e,Ee||[])).next())})}function Ye(_e){return this instanceof Ye?(this.v=_e,this):new Ye(_e)}function He(_e,Ee,Ie){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var it,pe=Ie.apply(_e,Ee||[]),Ze=[];return it={},jt("next"),jt("throw"),jt("return"),it[Symbol.asyncIterator]=function(){return this},it;function jt(Gn){pe[Gn]&&(it[Gn]=function(Mi){return new Promise(function(Li,gi){Ze.push([Gn,Mi,Li,gi])>1||Dt(Gn,Mi)})})}function Dt(Gn,Mi){try{!function ci(Gn){Gn.value instanceof Ye?Promise.resolve(Gn.value.v).then(Vt,Tn):si(Ze[0][2],Gn)}(pe[Gn](Mi))}catch(Li){si(Ze[0][3],Li)}}function Vt(Gn){Dt("next",Gn)}function Tn(Gn){Dt("throw",Gn)}function si(Gn,Mi){Gn(Mi),Ze.shift(),Ze.length&&Dt(Ze[0][0],Ze[0][1])}}function at(_e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Ie,Ee=_e[Symbol.asyncIterator];return Ee?Ee.call(_e):(_e=function Et(_e){var Ee="function"==typeof Symbol&&Symbol.iterator,Ie=Ee&&_e[Ee],pe=0;if(Ie)return Ie.call(_e);if(_e&&"number"==typeof _e.length)return{next:function(){return _e&&pe>=_e.length&&(_e=void 0),{value:_e&&_e[pe++],done:!_e}}};throw new TypeError(Ee?"Object is not iterable.":"Symbol.iterator is not defined.")}(_e),Ie={},pe("next"),pe("throw"),pe("return"),Ie[Symbol.asyncIterator]=function(){return this},Ie);function pe(Ze){Ie[Ze]=_e[Ze]&&function(jt){return new Promise(function(Dt,ci){!function it(Ze,jt,Dt,ci){Promise.resolve(ci).then(function(Vt){Ze({value:Vt,done:Dt})},jt)}(Dt,ci,(jt=_e[Ze](jt)).done,jt.value)})}}}z.d(Be,{FC:()=>He,KL:()=>at,_T:()=>de,mG:()=>le,qq:()=>Ye}),"function"==typeof SuppressedError&&SuppressedError}},Ft=>{Ft(Ft.s=381)}]);