"use strict";(self.webpackChunkTV_Project=self.webpackChunkTV_Project||[]).push([[179],{2011:(Ft,Be,z)=>{z.d(Be,{Dh:()=>Me,GT:()=>ue,cc:()=>Ue,hO:()=>tt,on:()=>ee,pX:()=>ye,xv:()=>Se});var d=z(4650),Q=z(9260),V=z(4976);Ft=z.hmd(Ft);const he=["ngOnDestroy"],ye=(Ke,qe,it,Ye={})=>new Proxy(Ke,{get:(je,Ge)=>it.runOutsideAngular(()=>{var at;if(Ke[Ge])return!(null===(at=Ye?.spy)||void 0===at)&&at.get&&Ye.spy.get(Ge,Ke[Ge]),Ke[Ge];if(he.indexOf(Ge)>-1)return()=>{};const Je=qe.toPromise().then(Et=>{const kt=Et&&Et[Ge];return"function"==typeof kt?kt.bind(Et):kt&&kt.then?kt.then(cn=>it.run(()=>cn)):it.run(()=>kt)});return new Proxy(()=>{},{get:(Et,kt)=>Je[kt],apply:(Et,kt,cn)=>Je.then(Tt=>{var yn;const Rt=Tt&&Tt(...cn);return!(null===(yn=Ye?.spy)||void 0===yn)&&yn.apply&&Ye.spy.apply(Ge,cn,Rt),Rt})})})}),ue=(Ke,qe)=>{qe.forEach(it=>{Object.getOwnPropertyNames(it.prototype||it).forEach(Ye=>{Object.defineProperty(Ke.prototype,Ye,Object.getOwnPropertyDescriptor(it.prototype||it,Ye))})})};class Oe{constructor(qe){return qe}}const Me=new d.OlP("angularfire2.app.options"),Se=new d.OlP("angularfire2.app.name");function ee(Ke,qe,it){const je="object"==typeof it&&it||{};je.name=je.name||"string"==typeof it&&it||"[DEFAULT]";const at=Q.Z.apps.filter(Je=>Je&&Je.name===je.name)[0]||qe.runOutsideAngular(()=>Q.Z.initializeApp(Ke,je));try{JSON.stringify(Ke)!==JSON.stringify(at.options)&&J("error",`${at.name} Firebase App already initialized with different options${Ft.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch{}return new Oe(at)}const J=(Ke,...qe)=>{(0,d.X6Q)()&&typeof console<"u"&&console[Ke](...qe)},ce={provide:Oe,useFactory:ee,deps:[Me,d.R0b,[new d.FiY,Se]]};let tt=(()=>{class Ke{constructor(it){Q.Z.registerVersion("angularfire",V.q4.full,"core"),Q.Z.registerVersion("angularfire",V.q4.full,"app-compat"),Q.Z.registerVersion("angular",d.q4F.full,it.toString())}static initializeApp(it,Ye){return{ngModule:Ke,providers:[{provide:Me,useValue:it},{provide:Se,useValue:Ye}]}}}return Ke.\u0275fac=function(it){return new(it||Ke)(d.LFG(d.Lbi))},Ke.\u0275mod=d.oAB({type:Ke}),Ke.\u0275inj=d.cJS({providers:[ce]}),Ke})();function Ue(Ke,qe,it,Ye,je){const[,Ge,at]=globalThis.\u0275AngularfireInstanceCache.find(Je=>Je[0]===Ke)||[];if(Ge)return function lt(Ke,qe){try{return Ke.toString()===qe.toString()}catch{return Ke===qe}}(je,at)||(Ce("error",`${qe} was already initialized on the ${it} Firebase App with different settings.${xt?" You may need to reload as Firebase is not HMR aware.":""}`),Ce("warn",{is:je,was:at})),Ge;{const Je=Ye();return globalThis.\u0275AngularfireInstanceCache.push([Ke,Je,je]),Je}}const xt=!!Ft.hot,Ce=(Ke,...qe)=>{(0,d.X6Q)()&&typeof console<"u"&&console[Ke](...qe)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},4976:(Ft,Be,z)=>{z.d(Be,{q4:()=>Xi,iC:()=>Hu,HU:()=>rl,vb:()=>uh,JM:()=>jc,u3:()=>lg});var d=z(4650),Q=z(259),V=z(5861),he=z(6881),ye=z(2090),ue=z(4859),Oe=z(1877);const Me=(D,A)=>A.some(O=>D instanceof O);let Se,ee;const tt=new WeakMap,Ue=new WeakMap,lt=new WeakMap,xt=new WeakMap,Ce=new WeakMap;let it={get(D,A,O){if(D instanceof IDBTransaction){if("done"===A)return Ue.get(D);if("objectStoreNames"===A)return D.objectStoreNames||lt.get(D);if("store"===A)return O.objectStoreNames[1]?void 0:O.objectStore(O.objectStoreNames[0])}return at(D[A])},set:(D,A,O)=>(D[A]=O,!0),has:(D,A)=>D instanceof IDBTransaction&&("done"===A||"store"===A)||A in D};function Ge(D){return"function"==typeof D?function je(D){return D!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function ce(){return ee||(ee=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(D)?function(...A){return D.apply(Je(this),A),at(tt.get(this))}:function(...A){return at(D.apply(Je(this),A))}:function(A,...O){const H=D.call(Je(this),A,...O);return lt.set(H,A.sort?A.sort():[A]),at(H)}}(D):(D instanceof IDBTransaction&&function qe(D){if(Ue.has(D))return;const A=new Promise((O,H)=>{const X=()=>{D.removeEventListener("complete",le),D.removeEventListener("error",ve),D.removeEventListener("abort",ve)},le=()=>{O(),X()},ve=()=>{H(D.error||new DOMException("AbortError","AbortError")),X()};D.addEventListener("complete",le),D.addEventListener("error",ve),D.addEventListener("abort",ve)});Ue.set(D,A)}(D),Me(D,function J(){return Se||(Se=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(D,it):D)}function at(D){if(D instanceof IDBRequest)return function Ke(D){const A=new Promise((O,H)=>{const X=()=>{D.removeEventListener("success",le),D.removeEventListener("error",ve)},le=()=>{O(at(D.result)),X()},ve=()=>{H(D.error),X()};D.addEventListener("success",le),D.addEventListener("error",ve)});return A.then(O=>{O instanceof IDBCursor&&tt.set(O,D)}).catch(()=>{}),Ce.set(A,D),A}(D);if(xt.has(D))return xt.get(D);const A=Ge(D);return A!==D&&(xt.set(D,A),Ce.set(A,D)),A}const Je=D=>Ce.get(D),cn=["get","getKey","getAll","getAllKeys","count"],Tt=["put","add","delete","clear"],yn=new Map;function Rt(D,A){var O;if(!(D instanceof IDBDatabase)||A in D||"string"!=typeof A)return;if(yn.get(A))return yn.get(A);const H=A.replace(/FromIndex$/,""),X=A!==H,le=Tt.includes(H);if(!(H in(X?IDBIndex:IDBObjectStore).prototype)||!le&&!cn.includes(H))return;const ve=function(et){return(O=O||(0,V.Z)(function*(ft,...Dt){const Lt=this.transaction(ft,le?"readwrite":"readonly");let un=Lt.store;return X&&(un=un.index(Dt.shift())),(yield Promise.all([un[H](...Dt),le&&Lt.done]))[0]})).apply(this,arguments)};return yn.set(A,ve),ve}var co,ns,is,zs,_e,Ee,Te,pe,rt,Ze,jt,At,li,Vt,Sn,si;!function Ye(D){it=D(it)}(D=>({...D,get:(A,O,H)=>Rt(A,O)||D.get(A,O,H),has:(A,O)=>!!Rt(A,O)||D.has(A,O)}));const Ri="@firebase/installations",pi="0.6.4",Mi=1e4,ir=`w:${pi}`,yi="FIS_v2",Bt="https://firebaseinstallations.googleapis.com/v1",Ts=36e5,Ti=new ye.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function ni(D){return D instanceof ye.ZR&&D.code.includes("request-failed")}function On({projectId:D}){return`${Bt}/projects/${D}/installations`}function Gt(D){return{token:D.token,requestStatus:2,expiresIn:fr(D.expiresIn),creationTime:Date.now()}}function zt(D,A){return(co=co||(0,V.Z)(function*(O,H){const le=(yield H.json()).error;return Ti.create("request-failed",{requestName:O,serverCode:le.code,serverMessage:le.message,serverStatus:le.status})})).apply(this,arguments)}function rr({apiKey:D}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":D})}function vi(D){return(ns=ns||(0,V.Z)(function*(A){const O=yield A();return O.status>=500&&O.status<600?A():O})).apply(this,arguments)}function fr(D){return Number(D.replace("s","000"))}function Gn(D){return new Promise(A=>{setTimeout(A,D)})}const sn=/^[cdef][\w-]{21}$/,uo="";function Tn(){try{const D=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(D),D[0]=112+D[0]%16;const O=function Pr(D){return function ui(D){return btoa(String.fromCharCode(...D)).replace(/\+/g,"-").replace(/\//g,"_")}(D).substr(0,22)}(D);return sn.test(O)?O:uo}catch{return uo}}function Ki(D){return`${D.appName}!${D.appId}`}const sr=new Map;function rs(D,A){const O=Ki(D);Cs(O,A),function ne(D,A){const O=function $(){return!Z&&"BroadcastChannel"in self&&(Z=new BroadcastChannel("[Firebase] FID Change"),Z.onmessage=D=>{Cs(D.data.key,D.data.fid)}),Z}();O&&O.postMessage({key:D,fid:A}),function j(){0===sr.size&&Z&&(Z.close(),Z=null)}()}(O,A)}function Cs(D,A){const O=sr.get(D);if(O)for(const H of O)H(A)}let Z=null;const U="firebase-installations-database",ie=1,ke="firebase-installations-store";let ut=null;function tn(){return ut||(ut=function Et(D,A,{blocked:O,upgrade:H,blocking:X,terminated:le}={}){const ve=indexedDB.open(D,A),Ne=at(ve);return H&&ve.addEventListener("upgradeneeded",et=>{H(at(ve.result),et.oldVersion,et.newVersion,at(ve.transaction))}),O&&ve.addEventListener("blocked",()=>O()),Ne.then(et=>{le&&et.addEventListener("close",()=>le()),X&&et.addEventListener("versionchange",()=>X())}).catch(()=>{}),Ne}(U,ie,{upgrade:(D,A)=>{0===A&&D.createObjectStore(ke)}})),ut}function Zt(D,A){return(zs=zs||(0,V.Z)(function*(O,H){const X=Ki(O),ve=(yield tn()).transaction(ke,"readwrite"),Ne=ve.objectStore(ke),et=yield Ne.get(X);return yield Ne.put(H,X),yield ve.done,(!et||et.fid!==H.fid)&&rs(O,H.fid),H})).apply(this,arguments)}function hn(D){return(_e=_e||(0,V.Z)(function*(A){const O=Ki(A),X=(yield tn()).transaction(ke,"readwrite");yield X.objectStore(ke).delete(O),yield X.done})).apply(this,arguments)}function Ut(D,A){return(Ee=Ee||(0,V.Z)(function*(O,H){const X=Ki(O),ve=(yield tn()).transaction(ke,"readwrite"),Ne=ve.objectStore(ke),et=yield Ne.get(X),ft=H(et);return void 0===ft?yield Ne.delete(X):yield Ne.put(ft,X),yield ve.done,ft&&(!et||et.fid!==ft.fid)&&rs(O,ft.fid),ft})).apply(this,arguments)}function Yn(D){return(Te=Te||(0,V.Z)(function*(A){let O;const H=yield Ut(A.appConfig,X=>{const le=function Ln(D){return Xe(D||{fid:Tn(),registrationStatus:0})}(X),ve=function jr(D,A){if(0===A.registrationStatus){if(!navigator.onLine)return{installationEntry:A,registrationPromise:Promise.reject(Ti.create("app-offline"))};const O={fid:A.fid,registrationStatus:1,registrationTime:Date.now()},H=function ss(D,A){return(pe=pe||(0,V.Z)(function*(O,H){try{const X=yield function ca(D,A){return(is=is||(0,V.Z)(function*({appConfig:O,heartbeatServiceProvider:H},{fid:X}){const le=On(O),ve=rr(O),Ne=H.getImmediate({optional:!0});if(Ne){const Lt=yield Ne.getHeartbeatsHeader();Lt&&ve.append("x-firebase-client",Lt)}const ft={method:"POST",headers:ve,body:JSON.stringify({fid:X,authVersion:yi,appId:O.appId,sdkVersion:ir})},Dt=yield vi(()=>fetch(le,ft));if(Dt.ok){const Lt=yield Dt.json();return{fid:Lt.fid||X,registrationStatus:2,refreshToken:Lt.refreshToken,authToken:Gt(Lt.authToken)}}throw yield zt("Create Installation",Dt)})).apply(this,arguments)}(O,H);return Zt(O.appConfig,X)}catch(X){throw ni(X)&&409===X.customData.serverCode?yield hn(O.appConfig):yield Zt(O.appConfig,{fid:H.fid,registrationStatus:0}),X}})).apply(this,arguments)}(D,O);return{installationEntry:O,registrationPromise:H}}return 1===A.registrationStatus?{installationEntry:A,registrationPromise:xe(D)}:{installationEntry:A}}(A,le);return O=ve.registrationPromise,ve.installationEntry});return H.fid===uo?{installationEntry:yield O}:{installationEntry:H,registrationPromise:O}})).apply(this,arguments)}function xe(D){return(rt=rt||(0,V.Z)(function*(A){let O=yield fe(A.appConfig);for(;1===O.registrationStatus;)yield Gn(100),O=yield fe(A.appConfig);if(0===O.registrationStatus){const{installationEntry:H,registrationPromise:X}=yield Yn(A);return X||H}return O})).apply(this,arguments)}function fe(D){return Ut(D,A=>{if(!A)throw Ti.create("installation-not-found");return Xe(A)})}function Xe(D){return function It(D){return 1===D.registrationStatus&&D.registrationTime+Mi<Date.now()}(D)?{fid:D.fid,registrationStatus:0}:D}function Ct(D,A){return(Ze=Ze||(0,V.Z)(function*({appConfig:O,heartbeatServiceProvider:H},X){const le=function $t(D,{fid:A}){return`${On(D)}/${A}/authTokens:generate`}(O,X),ve=function ci(D,{refreshToken:A}){const O=rr(D);return O.append("Authorization",function Wi(D){return`${yi} ${D}`}(A)),O}(O,X),Ne=H.getImmediate({optional:!0});if(Ne){const Lt=yield Ne.getHeartbeatsHeader();Lt&&ve.append("x-firebase-client",Lt)}const ft={method:"POST",headers:ve,body:JSON.stringify({installation:{sdkVersion:ir,appId:O.appId}})},Dt=yield vi(()=>fetch(le,ft));if(Dt.ok)return Gt(yield Dt.json());throw yield zt("Generate Auth Token",Dt)})).apply(this,arguments)}function Pt(D){return(jt=jt||(0,V.Z)(function*(A,O=!1){let H;const X=yield Ut(A.appConfig,ve=>{if(!Jn(ve))throw Ti.create("not-registered");const Ne=ve.authToken;if(!O&&function Lr(D){return 2===D.requestStatus&&!function ho(D){const A=Date.now();return A<D.creationTime||D.creationTime+D.expiresIn<A+Ts}(D)}(Ne))return ve;if(1===Ne.requestStatus)return H=function Rn(D,A){return(At=At||(0,V.Z)(function*(O,H){let X=yield Mn(O.appConfig);for(;1===X.authToken.requestStatus;)yield Gn(100),X=yield Mn(O.appConfig);const le=X.authToken;return 0===le.requestStatus?Pt(O,H):le})).apply(this,arguments)}(A,O),ve;{if(!navigator.onLine)throw Ti.create("app-offline");const et=function Ga(D){const A={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},D),{authToken:A})}(ve);return H=function Qe(D,A){return(li=li||(0,V.Z)(function*(O,H){try{const X=yield Ct(O,H),le=Object.assign(Object.assign({},H),{authToken:X});return yield Zt(O.appConfig,le),X}catch(X){if(!ni(X)||401!==X.customData.serverCode&&404!==X.customData.serverCode){const le=Object.assign(Object.assign({},H),{authToken:{requestStatus:0}});yield Zt(O.appConfig,le)}else yield hn(O.appConfig);throw X}})).apply(this,arguments)}(A,et),et}});return H?yield H:X.authToken})).apply(this,arguments)}function Mn(D){return Ut(D,A=>{if(!Jn(A))throw Ti.create("not-registered");return function os(D){return 1===D.requestStatus&&D.requestTime+Mi<Date.now()}(A.authToken)?Object.assign(Object.assign({},A),{authToken:{requestStatus:0}}):A})}function Jn(D){return void 0!==D&&2===D.registrationStatus}function as(D){return Ti.create("missing-app-config-values",{valueName:D})}const Jt="installations",da=D=>{const A=D.getProvider("app").getImmediate(),O=function oi(D){if(!D||!D.options)throw as("App Configuration");if(!D.name)throw as("App Name");const A=["projectId","apiKey","appId"];for(const O of A)if(!D.options[O])throw as(O);return{appName:D.name,projectId:D.options.projectId,apiKey:D.options.apiKey,appId:D.options.appId}}(A);return{app:A,appConfig:O,heartbeatServiceProvider:(0,he._getProvider)(A,"heartbeat"),_delete:()=>Promise.resolve()}},Lo=D=>{const A=D.getProvider("app").getImmediate(),O=(0,he._getProvider)(A,Jt).getImmediate();return{getId:()=>function bt(D){return(Vt=Vt||(0,V.Z)(function*(A){const O=A,{installationEntry:H,registrationPromise:X}=yield Yn(O);return X?X.catch(console.error):Pt(O).catch(console.error),H.fid})).apply(this,arguments)}(O),getToken:X=>function vn(D){return(Sn=Sn||(0,V.Z)(function*(A,O=!1){const H=A;return yield function ii(D){return(si=si||(0,V.Z)(function*(A){const{registrationPromise:O}=yield Yn(A);O&&(yield O)})).apply(this,arguments)}(H),(yield Pt(H,O)).token})).apply(this,arguments)}(O,X)}};var Ws;(function za(){(0,he._registerComponent)(new ue.wA(Jt,da,"PUBLIC")),(0,he._registerComponent)(new ue.wA("installations-internal",Lo,"PRIVATE"))})(),(0,he.registerVersion)(Ri,pi),(0,he.registerVersion)(Ri,pi,"esm2017");const ha="@firebase/remote-config",xr=new ye.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class Sd{constructor(A,O,H,X){this.client=A,this.storage=O,this.storageCache=H,this.logger=X}isCachedDataFresh(A,O){if(!O)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const H=Date.now()-O,X=H<=A;return this.logger.debug(`Config fetch cache check. Cache age millis: ${H}. Cache max age millis (minimumFetchIntervalMillis setting): ${A}. Is cache hit: ${X}.`),X}fetch(A){var O=this;return(0,V.Z)(function*(){const[H,X]=yield Promise.all([O.storage.getLastSuccessfulFetchTimestampMillis(),O.storage.getLastSuccessfulFetchResponse()]);if(X&&O.isCachedDataFresh(A.cacheMaxAgeMillis,H))return X;A.eTag=X&&X.eTag;const le=yield O.client.fetch(A),ve=[O.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===le.status&&ve.push(O.storage.setLastSuccessfulFetchResponse(le)),yield Promise.all(ve),le})()}}function Dd(D=navigator){return D.languages&&D.languages[0]||D.language}class Ff{constructor(A,O,H,X,le,ve){this.firebaseInstallations=A,this.sdkVersion=O,this.namespace=H,this.projectId=X,this.apiKey=le,this.appId=ve}fetch(A){var O=this;return(0,V.Z)(function*(){const[H,X]=yield Promise.all([O.firebaseInstallations.getId(),O.firebaseInstallations.getToken()]),ve=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${O.projectId}/namespaces/${O.namespace}:fetch?key=${O.apiKey}`,Ne={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":A.eTag||"*"},et={sdk_version:O.sdkVersion,app_instance_id:H,app_instance_id_token:X,app_id:O.appId,language_code:Dd()},ft={method:"POST",headers:Ne,body:JSON.stringify(et)},Dt=fetch(ve,ft),Lt=new Promise((on,Li)=>{A.signal.addEventListener(()=>{const Co=new Error("The operation was aborted.");Co.name="AbortError",Li(Co)})});let un;try{yield Promise.race([Dt,Lt]),un=yield Dt}catch(on){let Li="fetch-client-network";throw"AbortError"===on?.name&&(Li="fetch-timeout"),xr.create(Li,{originalErrorMessage:on?.message})}let Nt=un.status;const Zn=un.headers.get("ETag")||void 0;let Cr,bi;if(200===un.status){let on;try{on=yield un.json()}catch(Li){throw xr.create("fetch-client-parse",{originalErrorMessage:Li?.message})}Cr=on.entries,bi=on.state}if("INSTANCE_STATE_UNSPECIFIED"===bi?Nt=500:"NO_CHANGE"===bi?Nt=304:("NO_TEMPLATE"===bi||"EMPTY_CONFIG"===bi)&&(Cr={}),304!==Nt&&200!==Nt)throw xr.create("fetch-status",{httpStatus:Nt});return{status:Nt,eTag:Zn,config:Cr}})()}}class gu{constructor(A,O){this.client=A,this.storage=O}fetch(A){var O=this;return(0,V.Z)(function*(){const H=(yield O.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return O.attemptFetch(A,H)})()}attemptFetch(A,{throttleEndTimeMillis:O,backoffCount:H}){var X=this;return(0,V.Z)(function*(){yield function Bf(D,A){return new Promise((O,H)=>{const X=Math.max(A-Date.now(),0),le=setTimeout(O,X);D.addEventListener(()=>{clearTimeout(le),H(xr.create("fetch-throttle",{throttleEndTimeMillis:A}))})})}(A.signal,O);try{const le=yield X.client.fetch(A);return yield X.storage.deleteThrottleMetadata(),le}catch(le){if(!function pc(D){if(!(D instanceof ye.ZR&&D.customData))return!1;const A=Number(D.customData.httpStatus);return 429===A||500===A||503===A||504===A}(le))throw le;const ve={throttleEndTimeMillis:Date.now()+(0,ye.$s)(H),backoffCount:H+1};return yield X.storage.setThrottleMetadata(ve),X.attemptFetch(A,ve)}})()}}class Ad{constructor(A,O,H,X,le){this.app=A,this._client=O,this._storageCache=H,this._storage=X,this._logger=le,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function gc(D,A){const O=D.target.error||void 0;return xr.create(A,{originalErrorMessage:O&&O?.message})}const Fo="app_namespace_store";class Vf{constructor(A,O,H,X=function Uf(){return new Promise((D,A)=>{try{const O=indexedDB.open("firebase_remote_config",1);O.onerror=H=>{A(gc(H,"storage-open"))},O.onsuccess=H=>{D(H.target.result)},O.onupgradeneeded=H=>{0===H.oldVersion&&H.target.result.createObjectStore(Fo,{keyPath:"compositeKey"})}}catch(O){A(xr.create("storage-open",{originalErrorMessage:O?.message}))}})}()){this.appId=A,this.appName=O,this.namespace=H,this.openDbPromise=X}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(A){return this.set("last_fetch_status",A)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(A){return this.set("last_successful_fetch_timestamp_millis",A)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(A){return this.set("last_successful_fetch_response",A)}getActiveConfig(){return this.get("active_config")}setActiveConfig(A){return this.set("active_config",A)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(A){return this.set("active_config_etag",A)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(A){return this.set("throttle_metadata",A)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(A){var O=this;return(0,V.Z)(function*(){const H=yield O.openDbPromise;return new Promise((X,le)=>{const Ne=H.transaction([Fo],"readonly").objectStore(Fo),et=O.createCompositeKey(A);try{const ft=Ne.get(et);ft.onerror=Dt=>{le(gc(Dt,"storage-get"))},ft.onsuccess=Dt=>{const Lt=Dt.target.result;X(Lt?Lt.value:void 0)}}catch(ft){le(xr.create("storage-get",{originalErrorMessage:ft?.message}))}})})()}set(A,O){var H=this;return(0,V.Z)(function*(){const X=yield H.openDbPromise;return new Promise((le,ve)=>{const et=X.transaction([Fo],"readwrite").objectStore(Fo),ft=H.createCompositeKey(A);try{const Dt=et.put({compositeKey:ft,value:O});Dt.onerror=Lt=>{ve(gc(Lt,"storage-set"))},Dt.onsuccess=()=>{le()}}catch(Dt){ve(xr.create("storage-set",{originalErrorMessage:Dt?.message}))}})})()}delete(A){var O=this;return(0,V.Z)(function*(){const H=yield O.openDbPromise;return new Promise((X,le)=>{const Ne=H.transaction([Fo],"readwrite").objectStore(Fo),et=O.createCompositeKey(A);try{const ft=Ne.delete(et);ft.onerror=Dt=>{le(gc(Dt,"storage-delete"))},ft.onsuccess=()=>{X()}}catch(ft){le(xr.create("storage-delete",{originalErrorMessage:ft?.message}))}})})()}createCompositeKey(A){return[this.appId,this.appName,this.namespace,A].join()}}class ma{constructor(A){this.storage=A}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var A=this;return(0,V.Z)(function*(){const O=A.storage.getLastFetchStatus(),H=A.storage.getLastSuccessfulFetchTimestampMillis(),X=A.storage.getActiveConfig(),le=yield O;le&&(A.lastFetchStatus=le);const ve=yield H;ve&&(A.lastSuccessfulFetchTimestampMillis=ve);const Ne=yield X;Ne&&(A.activeConfig=Ne)})()}setLastFetchStatus(A){return this.lastFetchStatus=A,this.storage.setLastFetchStatus(A)}setLastSuccessfulFetchTimestampMillis(A){return this.lastSuccessfulFetchTimestampMillis=A,this.storage.setLastSuccessfulFetchTimestampMillis(A)}setActiveConfig(A){return this.activeConfig=A,this.storage.setActiveConfig(A)}}function vu(){return(Ws=Ws||(0,V.Z)(function*(){if(!(0,ye.hl)())return!1;try{return yield(0,ye.eu)()}catch{return!1}})).apply(this,arguments)}!function $f(){(0,he._registerComponent)(new ue.wA("remote-config",function D(A,{instanceIdentifier:O}){const H=A.getProvider("app").getImmediate(),X=A.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw xr.create("registration-window");if(!(0,ye.hl)())throw xr.create("indexed-db-unavailable");const{projectId:le,apiKey:ve,appId:Ne}=H.options;if(!le)throw xr.create("registration-project-id");if(!ve)throw xr.create("registration-api-key");if(!Ne)throw xr.create("registration-app-id");const et=new Vf(Ne,H.name,O=O||"firebase"),ft=new ma(et),Dt=new Oe.Yd(ha);Dt.logLevel=Oe.in.ERROR;const Lt=new Ff(X,he.SDK_VERSION,O,le,ve,Ne),un=new gu(Lt,et),Nt=new Sd(un,et,ft,Dt),Zn=new Ad(H,Nt,ft,et,Dt);return function us(D){const A=(0,ye.m9)(D);A._initializePromise||(A._initializePromise=A._storageCache.loadFromStorage().then(()=>{A._isInitializationComplete=!0}))}(Zn),Zn},"PUBLIC").setMultipleInstances(!0)),(0,he.registerVersion)(ha,"0.4.4"),(0,he.registerVersion)(ha,"0.4.4","esm2017")}();const Hf=(D,A)=>A.some(O=>D instanceof O);let Cl,_c;const bu=new WeakMap,Ka=new WeakMap,Oi=new WeakMap,yc=new WeakMap,vc=new WeakMap;let qa={get(D,A,O){if(D instanceof IDBTransaction){if("done"===A)return Ka.get(D);if("objectStoreNames"===A)return D.objectStoreNames||Oi.get(D);if("store"===A)return O.objectStoreNames[1]?void 0:O.objectStore(O.objectStoreNames[0])}return Gr(D[A])},set:(D,A,O)=>(D[A]=O,!0),has:(D,A)=>D instanceof IDBTransaction&&("done"===A||"store"===A)||A in D};function wu(D){return"function"==typeof D?function Rd(D){return D!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Gf(){return _c||(_c=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(D)?function(...A){return D.apply(ar(this),A),Gr(bu.get(this))}:function(...A){return Gr(D.apply(ar(this),A))}:function(A,...O){const H=D.call(ar(this),A,...O);return Oi.set(H,A.sort?A.sort():[A]),Gr(H)}}(D):(D instanceof IDBTransaction&&function Sl(D){if(Ka.has(D))return;const A=new Promise((O,H)=>{const X=()=>{D.removeEventListener("complete",le),D.removeEventListener("error",ve),D.removeEventListener("abort",ve)},le=()=>{O(),X()},ve=()=>{H(D.error||new DOMException("AbortError","AbortError")),X()};D.addEventListener("complete",le),D.addEventListener("error",ve),D.addEventListener("abort",ve)});Ka.set(D,A)}(D),Hf(D,function jf(){return Cl||(Cl=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(D,qa):D)}function Gr(D){if(D instanceof IDBRequest)return function Dn(D){const A=new Promise((O,H)=>{const X=()=>{D.removeEventListener("success",le),D.removeEventListener("error",ve)},le=()=>{O(Gr(D.result)),X()},ve=()=>{H(D.error),X()};D.addEventListener("success",le),D.addEventListener("error",ve)});return A.then(O=>{O instanceof IDBCursor&&bu.set(O,D)}).catch(()=>{}),vc.set(A,D),A}(D);if(yc.has(D))return yc.get(D);const A=wu(D);return A!==D&&(yc.set(D,A),vc.set(A,D)),A}const ar=D=>vc.get(D);function Md(D,A,{blocked:O,upgrade:H,blocking:X,terminated:le}={}){const ve=indexedDB.open(D,A),Ne=Gr(ve);return H&&ve.addEventListener("upgradeneeded",et=>{H(Gr(ve.result),et.oldVersion,et.newVersion,Gr(ve.transaction))}),O&&ve.addEventListener("blocked",()=>O()),Ne.then(et=>{le&&et.addEventListener("close",()=>le()),X&&et.addEventListener("versionchange",()=>X())}).catch(()=>{}),Ne}function As(D,{blocked:A}={}){const O=indexedDB.deleteDatabase(D);return A&&O.addEventListener("blocked",()=>A()),Gr(O).then(()=>{})}const Od=["get","getKey","getAll","getAllKeys","count"],Bo=["put","add","delete","clear"],bc=new Map;function Ya(D,A){var O;if(!(D instanceof IDBDatabase)||A in D||"string"!=typeof A)return;if(bc.get(A))return bc.get(A);const H=A.replace(/FromIndex$/,""),X=A!==H,le=Bo.includes(H);if(!(H in(X?IDBIndex:IDBObjectStore).prototype)||!le&&!Od.includes(H))return;const ve=function(et){return(O=O||(0,V.Z)(function*(ft,...Dt){const Lt=this.transaction(ft,le?"readwrite":"readonly");let un=Lt.store;return X&&(un=un.index(Dt.shift())),(yield Promise.all([un[H](...Dt),le&&Lt.done]))[0]})).apply(this,arguments)};return bc.set(A,ve),ve}var nn,Eu,Pd,wc,Ld,Nd,xu,Dl,Ys,De,mn,Fd,Bd,lr,Ud,Al,cr,Tu,Iu,kl;!function pr(D){qa=D(qa)}(D=>({...D,get:(A,O,H)=>Ya(A,O)||D.get(A,O,H),has:(A,O)=>!!Ya(A,O)||D.has(A,O)}));const di="/firebase-messaging-sw.js",gr="/firebase-cloud-messaging-push-scope",ks="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Ml="https://fcmregistrations.googleapis.com/v1",po="google.c.a.c_id",Vd="google.c.a.c_l",Cu="google.c.a.ts",Ol="google.c.a.e";var Rs=(()=>{return(D=Rs||(Rs={})).PUSH_RECEIVED="push-received",D.NOTIFICATION_CLICKED="notification-clicked",Rs;var D})();function hs(D){const A=new Uint8Array(D);return btoa(String.fromCharCode(...A)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Ec(D){const O=(D+"=".repeat((4-D.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),H=atob(O),X=new Uint8Array(H.length);for(let le=0;le<H.length;++le)X[le]=H.charCodeAt(le);return X}const Ir="fcm_token_details_db",Wf=5,$d="fcm_token_object_Store",jd="firebase-messaging-database",Kf=1,go="firebase-messaging-store";let pa=null;function xc(){return pa||(pa=Md(jd,Kf,{upgrade:(D,A)=>{0===A&&D.createObjectStore(go)}})),pa}function Gd(D){return(Eu=Eu||(0,V.Z)(function*(A){const O=ai(A),X=yield(yield xc()).transaction(go).objectStore(go).get(O);if(X)return X;{const le=yield function Pl(D){return(nn=nn||(0,V.Z)(function*(A){var O;if("databases"in indexedDB&&!(yield indexedDB.databases()).map(Ne=>Ne.name).includes(Ir))return null;let H=null;return(yield Md(Ir,Wf,{upgrade:function(ve,Ne,et,ft){return(O=O||(0,V.Z)(function*(Dt,Lt,un,Nt){var Zn;if(Lt<2||!Dt.objectStoreNames.contains($d))return;const Cr=Nt.objectStore($d),bi=yield Cr.index("fcmSenderId").get(A);if(yield Cr.clear(),bi)if(2===Lt){const on=bi;if(!on.auth||!on.p256dh||!on.endpoint)return;H={token:on.fcmToken,createTime:null!==(Zn=on.createTime)&&void 0!==Zn?Zn:Date.now(),subscriptionOptions:{auth:on.auth,p256dh:on.p256dh,endpoint:on.endpoint,swScope:on.swScope,vapidKey:"string"==typeof on.vapidKey?on.vapidKey:hs(on.vapidKey)}}}else if(3===Lt){const on=bi;H={token:on.fcmToken,createTime:on.createTime,subscriptionOptions:{auth:hs(on.auth),p256dh:hs(on.p256dh),endpoint:on.endpoint,swScope:on.swScope,vapidKey:hs(on.vapidKey)}}}else if(4===Lt){const on=bi;H={token:on.fcmToken,createTime:on.createTime,subscriptionOptions:{auth:hs(on.auth),p256dh:hs(on.p256dh),endpoint:on.endpoint,swScope:on.swScope,vapidKey:hs(on.vapidKey)}}}})).apply(this,arguments)}})).close(),yield As(Ir),yield As("fcm_vapid_details_db"),yield As("undefined"),function Hd(D){if(!D||!D.subscriptionOptions)return!1;const{subscriptionOptions:A}=D;return"number"==typeof D.createTime&&D.createTime>0&&"string"==typeof D.token&&D.token.length>0&&"string"==typeof A.auth&&A.auth.length>0&&"string"==typeof A.p256dh&&A.p256dh.length>0&&"string"==typeof A.endpoint&&A.endpoint.length>0&&"string"==typeof A.swScope&&A.swScope.length>0&&"string"==typeof A.vapidKey&&A.vapidKey.length>0}(H)?H:null})).apply(this,arguments)}(A.appConfig.senderId);if(le)return yield Ii(A,le),le}})).apply(this,arguments)}function Ii(D,A){return(Pd=Pd||(0,V.Z)(function*(O,H){const X=ai(O),ve=(yield xc()).transaction(go,"readwrite");return yield ve.objectStore(go).put(H,X),yield ve.done,H})).apply(this,arguments)}function ai({appConfig:D}){return D.appId}const _r=new ye.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function Ll(D,A){return(Ld=Ld||(0,V.Z)(function*(O,H){const X=yield Nl(O),le=Tc(H),ve={method:"POST",headers:X,body:JSON.stringify(le)};let Ne;try{Ne=yield(yield fetch(ga(O.appConfig),ve)).json()}catch(et){throw _r.create("token-subscribe-failed",{errorInfo:et?.toString()})}if(Ne.error)throw _r.create("token-subscribe-failed",{errorInfo:Ne.error.message});if(!Ne.token)throw _r.create("token-subscribe-no-token");return Ne.token})).apply(this,arguments)}function Su(D,A){return(xu=xu||(0,V.Z)(function*(O,H){const le={method:"DELETE",headers:yield Nl(O)};try{const Ne=yield(yield fetch(`${ga(O.appConfig)}/${H}`,le)).json();if(Ne.error)throw _r.create("token-unsubscribe-failed",{errorInfo:Ne.error.message})}catch(ve){throw _r.create("token-unsubscribe-failed",{errorInfo:ve?.toString()})}})).apply(this,arguments)}function ga({projectId:D}){return`${Ml}/projects/${D}/registrations`}function Nl(D){return(Dl=Dl||(0,V.Z)(function*({appConfig:A,installations:O}){const H=yield O.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":A.apiKey,"x-goog-firebase-installations-auth":`FIS ${H}`})})).apply(this,arguments)}function Tc({p256dh:D,auth:A,endpoint:O,vapidKey:H}){const X={web:{endpoint:O,auth:A,p256dh:D}};return H!==ks&&(X.web.applicationPubKey=H),X}const Du=6048e5;function Ic(D){return(Ys=Ys||(0,V.Z)(function*(A){const O=yield function Vo(D,A){return(Bd=Bd||(0,V.Z)(function*(O,H){return(yield O.pushManager.getSubscription())||O.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Ec(H)})})).apply(this,arguments)}(A.swRegistration,A.vapidKey),H={vapidKey:A.vapidKey,swScope:A.swRegistration.scope,endpoint:O.endpoint,auth:hs(O.getKey("auth")),p256dh:hs(O.getKey("p256dh"))},X=yield Gd(A.firebaseDependencies);if(X){if(function Yf(D,A){return A.vapidKey===D.vapidKey&&A.endpoint===D.endpoint&&A.auth===D.auth&&A.p256dh===D.p256dh}(X.subscriptionOptions,H))return Date.now()>=X.createTime+Du?function Bl(D,A){return(mn=mn||(0,V.Z)(function*(O,H){try{const X=yield function zd(D,A){return(Nd=Nd||(0,V.Z)(function*(O,H){const X=yield Nl(O),le=Tc(H.subscriptionOptions),ve={method:"PATCH",headers:X,body:JSON.stringify(le)};let Ne;try{Ne=yield(yield fetch(`${ga(O.appConfig)}/${H.token}`,ve)).json()}catch(et){throw _r.create("token-update-failed",{errorInfo:et?.toString()})}if(Ne.error)throw _r.create("token-update-failed",{errorInfo:Ne.error.message});if(!Ne.token)throw _r.create("token-update-no-token");return Ne.token})).apply(this,arguments)}(O.firebaseDependencies,H),le=Object.assign(Object.assign({},H),{token:X,createTime:Date.now()});return yield Ii(O.firebaseDependencies,le),X}catch(X){throw yield function Fl(D){return(De=De||(0,V.Z)(function*(A){const O=yield Gd(A.firebaseDependencies);O&&(yield Su(A.firebaseDependencies,O.token),yield function Uo(D){return(wc=wc||(0,V.Z)(function*(A){const O=ai(A),X=(yield xc()).transaction(go,"readwrite");yield X.objectStore(go).delete(O),yield X.done})).apply(this,arguments)}(A.firebaseDependencies));const H=yield A.swRegistration.pushManager.getSubscription();return!H||H.unsubscribe()})).apply(this,arguments)}(O),X}})).apply(this,arguments)}(A,{token:X.token,createTime:Date.now(),subscriptionOptions:H}):X.token;try{yield Su(A.firebaseDependencies,X.token)}catch(le){console.warn(le)}return _a(A.firebaseDependencies,H)}return _a(A.firebaseDependencies,H)})).apply(this,arguments)}function _a(D,A){return(Fd=Fd||(0,V.Z)(function*(O,H){const le={token:yield Ll(O,H),createTime:Date.now(),subscriptionOptions:H};return yield Ii(O,le),le.token})).apply(this,arguments)}function Wd(D){const A={from:D.from,collapseKey:D.collapse_key,messageId:D.fcmMessageId};return function Au(D,A){if(!A.notification)return;D.notification={};const O=A.notification.title;O&&(D.notification.title=O);const H=A.notification.body;H&&(D.notification.body=H);const X=A.notification.image;X&&(D.notification.image=X);const le=A.notification.icon;le&&(D.notification.icon=le)}(A,D),function tg(D,A){A.data&&(D.data=A.data)}(A,D),function Zf(D,A){var O,H,X,le,ve;if(!(A.fcmOptions||null!==(O=A.notification)&&void 0!==O&&O.click_action))return;D.fcmOptions={};const Ne=null!==(X=null===(H=A.fcmOptions)||void 0===H?void 0:H.link)&&void 0!==X?X:null===(le=A.notification)||void 0===le?void 0:le.click_action;Ne&&(D.fcmOptions.link=Ne);const et=null===(ve=A.fcmOptions)||void 0===ve?void 0:ve.analytics_label;et&&(D.fcmOptions.analyticsLabel=et)}(A,D),A}function Cc(D,A){const O=[];for(let H=0;H<D.length;H++)O.push(D.charAt(H)),H<A.length&&O.push(A.charAt(H));return O.join("")}function Za(D){return _r.create("missing-app-config-values",{valueName:D})}Cc("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Cc("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Ru{constructor(A,O,H){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const X=function ku(D){if(!D||!D.options)throw Za("App Configuration Object");if(!D.name)throw Za("App Name");const A=["projectId","apiKey","appId","messagingSenderId"],{options:O}=D;for(const H of A)if(!O[H])throw Za(H);return{appName:D.name,projectId:O.projectId,apiKey:O.apiKey,appId:O.appId,senderId:O.messagingSenderId}}(A);this.firebaseDependencies={app:A,appConfig:X,installations:O,analyticsProvider:H}}_delete(){return Promise.resolve()}}function Ul(D,A){return(cr=cr||(0,V.Z)(function*(O,H){if(!navigator)throw _r.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw _r.create("permission-blocked");return yield function _o(D,A){return(Al=Al||(0,V.Z)(function*(O,H){H?O.vapidKey=H:O.vapidKey||(O.vapidKey=ks)})).apply(this,arguments)}(O,H?.vapidKey),yield function ya(D,A){return(Ud=Ud||(0,V.Z)(function*(O,H){if(!H&&!O.swRegistration&&(yield function $o(D){return(lr=lr||(0,V.Z)(function*(A){try{A.swRegistration=yield navigator.serviceWorker.register(di,{scope:gr}),A.swRegistration.update().catch(()=>{})}catch(O){throw _r.create("failed-service-worker-registration",{browserErrorMessage:O?.message})}})).apply(this,arguments)}(O)),H||!O.swRegistration){if(!(H instanceof ServiceWorkerRegistration))throw _r.create("invalid-sw-registration");O.swRegistration=H}})).apply(this,arguments)}(O,H?.serviceWorkerRegistration),Ic(O)})).apply(this,arguments)}function Sc(D,A){return(Iu=Iu||(0,V.Z)(function*(O,H){const X=H.data;if(!X.isFirebaseMessaging)return;O.onMessageHandler&&X.messageType===Rs.PUSH_RECEIVED&&("function"==typeof O.onMessageHandler?O.onMessageHandler(Wd(X)):O.onMessageHandler.next(Wd(X)));const le=X.data;(function Xf(D){return"object"==typeof D&&!!D&&po in D})(le)&&"1"===le[Ol]&&(yield function Vl(D,A,O){return(Tu=Tu||(0,V.Z)(function*(H,X,le){const ve=function Qf(D){switch(D){case Rs.NOTIFICATION_CLICKED:return"notification_open";case Rs.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(X);(yield H.firebaseDependencies.analyticsProvider.get()).logEvent(ve,{message_id:le[po],message_name:le[Vd],message_time:le[Cu],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}(O,X.messageType,le))})).apply(this,arguments)}const Dc="@firebase/messaging",My=D=>{const A=new Ru(D.getProvider("app").getImmediate(),D.getProvider("installations-internal").getImmediate(),D.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",O=>Sc(A,O)),A},Jf=D=>{const A=D.getProvider("messaging").getImmediate();return{getToken:H=>Ul(A,H)}};function Ou(){return(kl=kl||(0,V.Z)(function*(){try{yield(0,ye.eu)()}catch{return!1}return typeof window<"u"&&(0,ye.hl)()&&(0,ye.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}var jo,Pu,Lu,Ac,Zd,Nu,Fu,ba,Qd;!function Mu(){(0,he._registerComponent)(new ue.wA("messaging",My,"PUBLIC")),(0,he._registerComponent)(new ue.wA("messaging-internal",Jf,"PRIVATE")),(0,he.registerVersion)(Dc,"0.12.4"),(0,he.registerVersion)(Dc,"0.12.4","esm2017")}();const Qa="analytics",Jd="firebase_id",eh="origin",Ja=6e4,wa="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",bo="https://www.googletagmanager.com/gtag/js",ri=new Oe.Yd("@firebase/analytics"),kn=new ye.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function el(D){if(!D.startsWith(bo)){const A=kn.create("invalid-gtag-resource",{gtagURL:D});return ri.warn(A.message),""}return D}function kc(D){return Promise.all(D.map(A=>A.catch(O=>O)))}const rh=30,rm=new class im{constructor(A={},O=1e3){this.throttleMetadata=A,this.intervalMillis=O}getThrottleMetadata(A){return this.throttleMetadata[A]}setThrottleMetadata(A,O){this.throttleMetadata[A]=O}deleteThrottleMetadata(A){delete this.throttleMetadata[A]}};function Yi(D){return new Headers({Accept:"application/json","x-goog-api-key":D})}function Mc(D){return(Ac=Ac||(0,V.Z)(function*(A,O=rm,H){const{appId:X,apiKey:le,measurementId:ve}=A.options;if(!X)throw kn.create("no-app-id");if(!le){if(ve)return{measurementId:ve,appId:X};throw kn.create("no-api-key")}const Ne=O.getThrottleMetadata(X)||{backoffCount:0,throttleEndTimeMillis:Date.now()},et=new sm;return setTimeout((0,V.Z)(function*(){et.abort()}),void 0!==H?H:Ja),sh({appId:X,apiKey:le,measurementId:ve},Ne,et,O)})).apply(this,arguments)}function sh(D,A,O){return(Zd=Zd||(0,V.Z)(function*(H,{throttleEndTimeMillis:X,backoffCount:le},ve,Ne=rm){var et;const{appId:ft,measurementId:Dt}=H;try{yield function Zs(D,A){return new Promise((O,H)=>{const X=Math.max(A-Date.now(),0),le=setTimeout(O,X);D.addEventListener(()=>{clearTimeout(le),H(kn.create("fetch-throttle",{throttleEndTimeMillis:A}))})})}(ve,X)}catch(Lt){if(Dt)return ri.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${Dt} provided in the "measurementId" field in the local Firebase config. [${Lt?.message}]`),{appId:ft,measurementId:Dt};throw Lt}try{const Lt=yield function Vu(D){return(Lu=Lu||(0,V.Z)(function*(A){var O;const{appId:H,apiKey:X}=A,le={method:"GET",headers:Yi(X)},ve=wa.replace("{app-id}",H),Ne=yield fetch(ve,le);if(200!==Ne.status&&304!==Ne.status){let et="";try{const ft=yield Ne.json();null!==(O=ft.error)&&void 0!==O&&O.message&&(et=ft.error.message)}catch{}throw kn.create("config-fetch-failed",{httpStatus:Ne.status,responseMessage:et})}return Ne.json()})).apply(this,arguments)}(H);return Ne.deleteThrottleMetadata(ft),Lt}catch(Lt){const un=Lt;if(!function Ea(D){if(!(D instanceof ye.ZR&&D.customData))return!1;const A=Number(D.customData.httpStatus);return 429===A||500===A||503===A||504===A}(un)){if(Ne.deleteThrottleMetadata(ft),Dt)return ri.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${Dt} provided in the "measurementId" field in the local Firebase config. [${un?.message}]`),{appId:ft,measurementId:Dt};throw Lt}const Nt=503===Number(null===(et=un?.customData)||void 0===et?void 0:et.httpStatus)?(0,ye.$s)(le,Ne.intervalMillis,rh):(0,ye.$s)(le,Ne.intervalMillis),Zn={throttleEndTimeMillis:Date.now()+Nt,backoffCount:le+1};return Ne.setThrottleMetadata(ft,Zn),ri.debug(`Calling attemptFetch again in ${Nt} millis`),sh(H,Zn,ve,Ne)}})).apply(this,arguments)}class sm{constructor(){this.listeners=[]}addEventListener(A){this.listeners.push(A)}abort(){this.listeners.forEach(A=>A())}}let Hl,zn;function ps(D,A,O,H,X,le,ve){return(ba=ba||(0,V.Z)(function*(Ne,et,ft,Dt,Lt,un,Nt){var Zn;const Cr=Mc(Ne);Cr.then(Ls=>{ft[Ls.measurementId]=Ls.appId,Ne.options.measurementId&&Ls.measurementId!==Ne.options.measurementId&&ri.warn(`The measurement ID in the local Firebase config (${Ne.options.measurementId}) does not match the measurement ID fetched from the server (${Ls.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(Ls=>ri.error(Ls)),et.push(Cr);const bi=function pn(){return(Fu=Fu||(0,V.Z)(function*(){if(!(0,ye.hl)())return ri.warn(kn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,ye.eu)()}catch(D){return ri.warn(kn.create("indexeddb-unavailable",{errorInfo:D?.toString()}).message),!1}return!0})).apply(this,arguments)}().then(Ls=>{if(Ls)return Dt.getId()}),[on,Li]=yield Promise.all([Cr,bi]);(function Uu(D){const A=window.document.getElementsByTagName("script");for(const O of Object.values(A))if(O.src&&O.src.includes(bo)&&O.src.includes(D))return O;return null})(un)||function Pn(D,A){const O=function nh(D,A){let O;return window.trustedTypes&&(O=window.trustedTypes.createPolicy(D,A)),O}("firebase-js-sdk-policy",{createScriptURL:el}),H=document.createElement("script"),X=`${bo}?l=${D}&id=${A}`;H.src=O?O?.createScriptURL(X):X,H.async=!0,document.head.appendChild(H)}(un,on.measurementId),zn&&(Lt("consent","default",zn),function Fr(D){zn=D}(void 0)),Lt("js",new Date);const Co=null!==(Zn=Nt?.config)&&void 0!==Zn?Zn:{};return Co[eh]="firebase",Co.update=!0,null!=Li&&(Co[Jd]=Li),Lt("config",on.measurementId,Co),Hl&&(Lt("set",Hl),function St(D){Hl=D}(void 0)),on.measurementId})).apply(this,arguments)}class am{constructor(A){this.app=A}_delete(){return delete zr[this.app.options.appId],Promise.resolve()}}let zr={},Zi=[];const ah={};let xa,Br,Lc="dataLayer",Nc="gtag",Ta=!1;function lm(D,A,O){!function wt(){const D=[];if((0,ye.ru)()&&D.push("This is a browser extension environment."),(0,ye.zI)()||D.push("Cookies are not available."),D.length>0){const A=D.map((H,X)=>`(${X+1}) ${H}`).join(" "),O=kn.create("invalid-analytics-context",{errorInfo:A});ri.warn(O.message)}}();const H=D.options.appId;if(!H)throw kn.create("no-app-id");if(!D.options.apiKey){if(!D.options.measurementId)throw kn.create("no-api-key");ri.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${D.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=zr[H])throw kn.create("already-exists",{id:H});if(!Ta){!function ng(D){let A=[];Array.isArray(window[D])?A=window[D]:window[D]=A}(Lc);const{wrappedGtag:le,gtagCore:ve}=function ig(D,A,O,H,X){let le=function(...ve){window[H].push(arguments)};return window[X]&&"function"==typeof window[X]&&(le=window[X]),window[X]=function Rc(D,A,O,H){var X;return function le(ve){return(X=X||(0,V.Z)(function*(Ne,...et){try{if("event"===Ne){const[ft,Dt]=et;yield function ih(D,A,O,H,X){return(Pu=Pu||(0,V.Z)(function*(le,ve,Ne,et,ft){try{let Dt=[];if(ft&&ft.send_to){let Lt=ft.send_to;Array.isArray(Lt)||(Lt=[Lt]);const un=yield kc(Ne);for(const Nt of Lt){const Zn=un.find(bi=>bi.measurementId===Nt),Cr=Zn&&ve[Zn.appId];if(!Cr){Dt=[];break}Dt.push(Cr)}}0===Dt.length&&(Dt=Object.values(ve)),yield Promise.all(Dt),le("event",et,ft||{})}catch(Dt){ri.error(Dt)}})).apply(this,arguments)}(D,A,O,ft,Dt)}else if("config"===Ne){const[ft,Dt]=et;yield function nm(D,A,O,H,X,le){return(jo=jo||(0,V.Z)(function*(ve,Ne,et,ft,Dt,Lt){const un=ft[Dt];try{if(un)yield Ne[un];else{const Zn=(yield kc(et)).find(Cr=>Cr.measurementId===Dt);Zn&&(yield Ne[Zn.appId])}}catch(Nt){ri.error(Nt)}ve("config",Dt,Lt)})).apply(this,arguments)}(D,A,O,H,ft,Dt)}else if("consent"===Ne){const[ft]=et;D("consent","update",ft)}else if("get"===Ne){const[ft,Dt,Lt]=et;D("get",ft,Dt,Lt)}else if("set"===Ne){const[ft]=et;D("set",ft)}else D(Ne,...et)}catch(ft){ri.error(ft)}})).apply(this,arguments)}}(le,D,A,O),{gtagCore:le,wrappedGtag:window[X]}}(zr,Zi,ah,Lc,Nc);Br=le,xa=ve,Ta=!0}return zr[H]=ps(D,Zi,ah,A,xa,Lc,O),new am(D)}function Ia(){return(Qd=Qd||(0,V.Z)(function*(){if((0,ye.ru)()||!(0,ye.zI)()||!(0,ye.hl)())return!1;try{return yield(0,ye.eu)()}catch{return!1}})).apply(this,arguments)}const Xs="@firebase/analytics";!function zl(){(0,he._registerComponent)(new ue.wA(Qa,(A,{options:O})=>lm(A.getProvider("app").getImmediate(),A.getProvider("installations-internal").getImmediate(),O),"PUBLIC")),(0,he._registerComponent)(new ue.wA("analytics-internal",function D(A){try{const O=A.getProvider(Qa).getImmediate();return{logEvent:(H,X,le)=>function og(D,A,O,H){D=(0,ye.m9)(D),function Oc(D,A,O,H,X){return(Nu=Nu||(0,V.Z)(function*(le,ve,Ne,et,ft){if(ft&&ft.global)le("event",Ne,et);else{const Dt=yield ve;le("event",Ne,Object.assign(Object.assign({},et),{send_to:Dt}))}})).apply(this,arguments)}(Br,zr[D.app.options.appId],A,O,H).catch(X=>ri.error(X))}(O,H,X,le)}}catch(O){throw kn.create("interop-component-reg-failed",{reason:O})}},"PRIVATE")),(0,he.registerVersion)(Xs,"0.10.0"),(0,he.registerVersion)(Xs,"0.10.0","esm2017")}();var Qs=z(4408),Kr=z(7565);const Pi=new class wo extends Kr.v{}(class nl extends Qs.o{constructor(A,O){super(A,O),this.scheduler=A,this.work=O}schedule(A,O=0){return O>0?super.schedule(A,O):(this.delay=O,this.state=A,this.scheduler.flush(this),this)}execute(A,O){return O>0||this.closed?super.execute(A,O):this._execute(A,O)}requestAsyncId(A,O,H=0){return null!=H&&H>0||null==H&&this.delay>0?super.requestAsyncId(A,O,H):(A.flush(this),0)}});var ch=z(4986),Si=z(9751),qr=z(8505),Ms=z(9468),ti=z(5363);const Xi=new d.GfV("7.6.1"),Wl="__angularfire_symbol__analyticsIsSupportedValue",$u="__angularfire_symbol__analyticsIsSupported",Ca="__angularfire_symbol__remoteConfigIsSupportedValue",Os="__angularfire_symbol__remoteConfigIsSupported",Eo="__angularfire_symbol__messagingIsSupportedValue",gi="__angularfire_symbol__messagingIsSupported";function jc(D,A,O){if(A){if(1===A.length)return A[0];const le=A.filter(ve=>ve.app===O);if(1===le.length)return le[0]}return O.container.getProvider(D).getImmediate({optional:!0})}globalThis[$u]||(globalThis[$u]=Ia().then(D=>globalThis[Wl]=D).catch(()=>globalThis[Wl]=!1)),globalThis[gi]||(globalThis[gi]=Ou().then(D=>globalThis[Eo]=D).catch(()=>globalThis[Eo]=!1)),globalThis[Os]||(globalThis[Os]=vu().then(D=>globalThis[Ca]=D).catch(()=>globalThis[Ca]=!1));const uh=(D,A)=>{const O=A?[A]:(0,Q.C6)(),H=[];return O.forEach(X=>{X.container.getProvider(D).instances.forEach(ve=>{H.includes(ve)||H.push(ve)})}),H};function xo(){}class il{constructor(A,O=Pi){this.zone=A,this.delegate=O}now(){return this.delegate.now()}schedule(A,O,H){const X=this.zone;return this.delegate.schedule(function(ve){X.runGuarded(()=>{A.apply(this,[ve])})},O,H)}}class Xt{constructor(A){this.zone=A,this.task=null}call(A,O){const H=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",xo,{},xo,xo)),O.pipe((0,qr.b)({next:H,complete:H,error:H})).subscribe(A).add(H)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let rl=(()=>{class D{constructor(O){this.ngZone=O,this.outsideAngular=O.runOutsideAngular(()=>new il(Zone.current)),this.insideAngular=O.run(()=>new il(Zone.current,ch.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return D.\u0275fac=function(O){return new(O||D)(d.LFG(d.R0b))},D.\u0275prov=d.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})();function Sa(){const D=globalThis.\u0275AngularFireScheduler;if(!D)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return D}function Go(D){return Sa().ngZone.run(()=>D())}function Hu(D){return Sa(),function hh(D){return function(O){return(O=O.lift(new Xt(D.ngZone))).pipe((0,Ms.R)(D.outsideAngular),(0,ti.Q)(D.insideAngular))}}(Sa())(D)}const ju=(D,A)=>function(){const H=arguments;return A&&setTimeout(()=>{"scheduled"===A.state&&A.invoke()},10),Go(()=>D.apply(void 0,H))},lg=(D,A)=>function(){let O;const H=arguments;for(let le=0;le<arguments.length;le++)"function"==typeof H[le]&&(A&&(O||(O=Go(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",xo,{},xo,xo)))),H[le]=ju(H[le],O));const X=function To(D){return Sa().ngZone.runOutsideAngular(()=>D())}(()=>D.apply(this,H));if(!A){if(X instanceof Si.y){const le=Sa();return X.pipe((0,Ms.R)(le.outsideAngular),(0,ti.Q)(le.insideAngular))}return Go(()=>X)}return X instanceof Si.y?X.pipe(Hu):X instanceof Promise?Go(()=>new Promise((le,ve)=>X.then(Ne=>Go(()=>le(Ne)),Ne=>Go(()=>ve(Ne))))):"function"==typeof X&&O?function(){return setTimeout(()=>{O&&"scheduled"===O.state&&O.invoke()},10),X.apply(this,arguments)}:Go(()=>X)}},1389:(Ft,Be,z)=>{z.d(Be,{$:()=>Ii,A:()=>hn,D:()=>Ln,I:()=>Rd,J:()=>As,L:()=>mn,N:()=>Cd,P:()=>cm,Q:()=>Rl,R:()=>Lc,U:()=>Ml,V:()=>po,W:()=>Vd,X:()=>ks,Y:()=>Rs,Z:()=>hs,_:()=>$d,a:()=>Ja,a0:()=>Uo,a1:()=>ai,a2:()=>_r,a3:()=>Nl,a4:()=>Tc,a5:()=>Du,a6:()=>Ic,a7:()=>Fl,a8:()=>Bl,a9:()=>_a,aA:()=>Qe,aB:()=>gi,aC:()=>mo,aD:()=>No,aE:()=>Ca,aF:()=>Pi,aG:()=>wo,aH:()=>Dn,aL:()=>ri,aO:()=>Ol,aa:()=>Vo,ab:()=>Yf,ac:()=>Wd,ad:()=>tg,ae:()=>Zf,af:()=>Xf,ai:()=>ku,aj:()=>Za,ak:()=>Ru,an:()=>Kf,ao:()=>Xa,aq:()=>Pu,ar:()=>tm,as:()=>Lr,at:()=>_u,au:()=>pc,av:()=>Ct,aw:()=>un,ax:()=>Hc,ay:()=>Ad,az:()=>$t,b:()=>Jd,c:()=>Fc,d:()=>Bc,e:()=>og,f:()=>Si,g:()=>Xi,h:()=>Ms,i:()=>Ea,j:()=>$u,k:()=>bi,l:()=>Ta,m:()=>Co,o:()=>fh,p:()=>ut,r:()=>jl,s:()=>Br,u:()=>lm});var Oe,Me,Se,ee,J,ce,tt,Ue,lt,xt,Ce,Ke,qe,it,Ye,je,Ge,at,Je,Et,kt,cn,Tt,yn,Rt,co,ns,is,zs,_e,Ee,Te,pe,rt,Ze,jt,At,li,Vt,Sn,si,jn,ki,Ri,pi,Mi,ir,yi,Bt,Ts,la,Nn,Hr,Ti,ni,On,Gt,rr,ci,vi,fr,Wi,ca,Gn,ui,sn,uo,Tn,Pr,Ki,sr,rs,qi,Is,Cs,ne,Z,$,j,U,ie,d=z(5861),Q=z(2090),V=z(6881),he=z(7582),ye=z(1877),ue=z(4859);const ut={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},hn={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const Ln=function Ut(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend."}},jr=function Yn(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},ss=new Q.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),fe=new ye.Yd("@firebase/auth");function It(k,...v){fe.logLevel<=ye.in.ERROR&&fe.error(`Auth (${V.SDK_VERSION}): ${k}`,...v)}function Ct(k,...v){throw Mn(k,...v)}function $t(k,...v){return Mn(k,...v)}function Pt(k,v,b){const T=Object.assign(Object.assign({},jr()),{[v]:b});return new Q.LL("auth","Firebase",T).create(v,{appName:k.name})}function Rn(k,v,b){if(!(v instanceof b))throw b.name!==v.constructor.name&&Ct(k,"argument-error"),Pt(k,"argument-error",`Type of ${v.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Mn(k,...v){if("string"!=typeof k){const b=v[0],T=[...v.slice(1)];return T[0]&&(T[0].appName=k.name),k._errorFactory.create(b,...T)}return ss.create(k,...v)}function Qe(k,v,...b){if(!k)throw Mn(v,...b)}function Jn(k){const v="INTERNAL ASSERTION FAILED: "+k;throw It(v),new Error(v)}function Lr(k,v){k||Jn(v)}function ho(){var k;return typeof self<"u"&&(null===(k=self.location)||void 0===k?void 0:k.href)||""}function Ga(){return"http:"===os()||"https:"===os()}function os(){var k;return typeof self<"u"&&(null===(k=self.location)||void 0===k?void 0:k.protocol)||null}class ii{constructor(v,b){this.shortDelay=v,this.longDelay=b,Lr(b>v,"Short delay should be less than long delay!"),this.isMobile=(0,Q.uI)()||(0,Q.b$)()}get(){return function bt(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Ga()||(0,Q.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Nr(k,v){Lr(k.emulator,"Emulator should always be set here");const{url:b}=k.emulator;return v?`${b}${v.startsWith("/")?v.slice(1):v}`:b}class fo{static initialize(v,b,T){this.fetchImpl=v,b&&(this.headersImpl=b),T&&(this.responseImpl=T)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void Jn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void Jn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void Jn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Er={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},ua=new ii(3e4,6e4);function fn(k,v){return k.tenantId&&!v.tenantId?Object.assign(Object.assign({},v),{tenantId:k.tenantId}):v}function oi(k,v,b,T){return(Oe=Oe||(0,d.Z)(function*(P,F,q,re,me={}){return as(P,me,(0,d.Z)(function*(){let Fe={},Ht={};re&&("GET"===F?Ht=re:Fe={body:JSON.stringify(re)});const Mt=(0,Q.xO)(Object.assign({key:P.config.apiKey},Ht)).slice(1),Kt=yield P._getAdditionalHeaders();return Kt["Content-Type"]="application/json",P.languageCode&&(Kt["X-Firebase-Locale"]=P.languageCode),fo.fetch()(xl(P,P.config.apiHost,q,Mt),Object.assign({method:F,headers:Kt,referrerPolicy:"no-referrer"},Fe))}))})).apply(this,arguments)}function as(k,v,b){return(Me=Me||(0,d.Z)(function*(T,P,F){T._canInitEmulator=!1;const q=Object.assign(Object.assign({},Er),P);try{const re=new da(T),me=yield Promise.race([F(),re.promise]);re.clearNetworkTimeout();const Fe=yield me.json();if("needConfirmation"in Fe)throw Lo(T,"account-exists-with-different-credential",Fe);if(me.ok&&!("errorMessage"in Fe))return Fe;{const Ht=me.ok?Fe.errorMessage:Fe.error.message,[Mt,Kt]=Ht.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===Mt)throw Lo(T,"credential-already-in-use",Fe);if("EMAIL_EXISTS"===Mt)throw Lo(T,"email-already-in-use",Fe);if("USER_DISABLED"===Mt)throw Lo(T,"user-disabled",Fe);const Fn=q[Mt]||Mt.toLowerCase().replace(/[_\s]+/g,"-");if(Kt)throw Pt(T,Fn,Kt);Ct(T,Fn)}}catch(re){if(re instanceof Q.ZR)throw re;Ct(T,"network-request-failed",{message:String(re)})}})).apply(this,arguments)}function Jt(k,v,b,T){return(Se=Se||(0,d.Z)(function*(P,F,q,re,me={}){const Fe=yield oi(P,F,q,re,me);return"mfaPendingCredential"in Fe&&Ct(P,"multi-factor-auth-required",{_serverResponse:Fe}),Fe})).apply(this,arguments)}function xl(k,v,b,T){const P=`${v}${b}?${T}`;return k.config.emulator?Nr(k.config,P):`${k.config.apiScheme}://${P}`}class da{constructor(v){this.auth=v,this.timer=null,this.promise=new Promise((b,T)=>{this.timer=setTimeout(()=>T($t(this.auth,"network-request-failed")),ua.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Lo(k,v,b){const T={appName:k.name};b.email&&(T.email=b.email),b.phoneNumber&&(T.phoneNumber=b.phoneNumber);const P=$t(k,v,T);return P.customData._tokenResponse=b,P}function ls(k){if(k)try{const v=new Date(Number(k));if(!isNaN(v.getTime()))return v.toUTCString()}catch{}}function Wa(k){return 1e3*Number(k)}function ei(k){const[v,b,T]=k.split(".");if(void 0===v||void 0===b||void 0===T)return It("JWT malformed, contained fewer than 3 sections"),null;try{const P=(0,Q.tV)(b);return P?JSON.parse(P):(It("Failed to decode base64 JWT payload"),null)}catch(P){return It("Caught error parsing JWT payload as JSON",P?.toString()),null}}function Ds(k,v){return(Ue=Ue||(0,d.Z)(function*(b,T,P=!1){if(P)return T;try{return yield T}catch(F){throw F instanceof Q.ZR&&function xr({code:k}){return"auth/user-disabled"===k||"auth/user-token-expired"===k}(F)&&b.auth.currentUser===b&&(yield b.auth.signOut()),F}})).apply(this,arguments)}class fc{constructor(v){this.user=v,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(v){var b;if(v){const T=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),T}{this.errorBackoff=3e4;const P=(null!==(b=this.user.stsTokenManager.expirationTime)&&void 0!==b?b:0)-Date.now()-3e5;return Math.max(0,P)}}schedule(v=!1){var b=this;if(!this.isRunning)return;const T=this.getInterval(v);this.timerId=setTimeout((0,d.Z)(function*(){yield b.iteration()}),T)}iteration(){var v=this;return(0,d.Z)(function*(){try{yield v.user.getIdToken(!0)}catch(b){return void("auth/network-request-failed"===b?.code&&v.schedule(!0))}v.schedule()})()}}class Il{constructor(v,b){this.createdAt=v,this.lastLoginAt=b,this._initializeTime()}_initializeTime(){this.lastSignInTime=ls(this.lastLoginAt),this.creationTime=ls(this.createdAt)}_copy(v){this.createdAt=v.createdAt,this.lastLoginAt=v.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function cs(k){return(lt=lt||(0,d.Z)(function*(v){var b;const T=v.auth,P=yield v.getIdToken(),F=yield Ds(v,function Tl(k,v){return(ce=ce||(0,d.Z)(function*(b,T){return oi(b,"POST","/v1/accounts:lookup",T)})).apply(this,arguments)}(T,{idToken:P}));Qe(F?.users.length,T,"internal-error");const q=F.users[0];v._notifyReloadListener(q);const re=null!==(b=q.providerUserInfo)&&void 0!==b&&b.length?function Tr(k){return k.map(v=>{var{providerId:b}=v,T=(0,he._T)(v,["providerId"]);return{providerId:b,uid:T.rawId||"",displayName:T.displayName||null,email:T.email||null,phoneNumber:T.phoneNumber||null,photoURL:T.photoUrl||null}})}(q.providerUserInfo):[],me=function Qp(k,v){return[...k.filter(T=>!v.some(P=>P.providerId===T.providerId)),...v]}(v.providerData,re),Mt=!!v.isAnonymous&&!(v.email&&q.passwordHash||me?.length),Kt={uid:q.localId,displayName:q.displayName||null,photoURL:q.photoUrl||null,email:q.email||null,emailVerified:q.emailVerified||!1,phoneNumber:q.phoneNumber||null,tenantId:q.tenantId||null,providerData:me,metadata:new Il(q.createdAt,q.lastLoginAt),isAnonymous:Mt};Object.assign(v,Kt)})).apply(this,arguments)}class fa{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(v){Qe(v.idToken,"internal-error"),Qe(typeof v.idToken<"u","internal-error"),Qe(typeof v.refreshToken<"u","internal-error");const b="expiresIn"in v&&typeof v.expiresIn<"u"?Number(v.expiresIn):function Ss(k){const v=ei(k);return Qe(v,"internal-error"),Qe(typeof v.exp<"u","internal-error"),Qe(typeof v.iat<"u","internal-error"),Number(v.exp)-Number(v.iat)}(v.idToken);this.updateTokensAndExpiration(v.idToken,v.refreshToken,b)}getToken(v,b=!1){var T=this;return(0,d.Z)(function*(){return Qe(!T.accessToken||T.refreshToken,v,"user-token-expired"),b||!T.accessToken||T.isExpired?T.refreshToken?(yield T.refresh(v,T.refreshToken),T.accessToken):null:T.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(v,b){var T=this;return(0,d.Z)(function*(){const{accessToken:P,refreshToken:F,expiresIn:q}=yield function Ks(k,v){return(Ce=Ce||(0,d.Z)(function*(b,T){const P=yield as(b,{},(0,d.Z)(function*(){const F=(0,Q.xO)({grant_type:"refresh_token",refresh_token:T}).slice(1),{tokenApiHost:q,apiKey:re}=b.config,me=xl(b,q,"/v1/token",`key=${re}`),Fe=yield b._getAdditionalHeaders();return Fe["Content-Type"]="application/x-www-form-urlencoded",fo.fetch()(me,{method:"POST",headers:Fe,body:F})}));return{accessToken:P.access_token,expiresIn:P.expires_in,refreshToken:P.refresh_token}})).apply(this,arguments)}(v,b);T.updateTokensAndExpiration(P,F,Number(q))})()}updateTokensAndExpiration(v,b,T){this.refreshToken=b||null,this.accessToken=v||null,this.expirationTime=Date.now()+1e3*T}static fromJSON(v,b){const{refreshToken:T,accessToken:P,expirationTime:F}=b,q=new fa;return T&&(Qe("string"==typeof T,"internal-error",{appName:v}),q.refreshToken=T),P&&(Qe("string"==typeof P,"internal-error",{appName:v}),q.accessToken=P),F&&(Qe("number"==typeof F,"internal-error",{appName:v}),q.expirationTime=F),q}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(v){this.accessToken=v.accessToken,this.refreshToken=v.refreshToken,this.expirationTime=v.expirationTime}_clone(){return Object.assign(new fa,this.toJSON())}_performRefresh(){return Jn("not implemented")}}function us(k,v){Qe("string"==typeof k||typeof k>"u","internal-error",{appName:v})}class qs{constructor(v){var{uid:b,auth:T,stsTokenManager:P}=v,F=(0,he._T)(v,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new fc(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=b,this.auth=T,this.stsTokenManager=P,this.accessToken=P.accessToken,this.displayName=F.displayName||null,this.email=F.email||null,this.emailVerified=F.emailVerified||!1,this.phoneNumber=F.phoneNumber||null,this.photoURL=F.photoURL||null,this.isAnonymous=F.isAnonymous||!1,this.tenantId=F.tenantId||null,this.providerData=F.providerData?[...F.providerData]:[],this.metadata=new Il(F.createdAt||void 0,F.lastLoginAt||void 0)}getIdToken(v){var b=this;return(0,d.Z)(function*(){const T=yield Ds(b,b.stsTokenManager.getToken(b.auth,v));return Qe(T,b.auth,"internal-error"),b.accessToken!==T&&(b.accessToken=T,yield b.auth._persistUserIfCurrent(b),b.auth._notifyListenersIfCurrent(b)),T})()}getIdTokenResult(v){return function ha(k){return(tt=tt||(0,d.Z)(function*(v,b=!1){const T=(0,Q.m9)(v),P=yield T.getIdToken(b),F=ei(P);Qe(F&&F.exp&&F.auth_time&&F.iat,T.auth,"internal-error");const q="object"==typeof F.firebase?F.firebase:void 0,re=q?.sign_in_provider;return{claims:F,token:P,authTime:ls(Wa(F.auth_time)),issuedAtTime:ls(Wa(F.iat)),expirationTime:ls(Wa(F.exp)),signInProvider:re||null,signInSecondFactor:q?.sign_in_second_factor||null}})).apply(this,arguments)}(this,v)}reload(){return function mr(k){return(xt=xt||(0,d.Z)(function*(v){const b=(0,Q.m9)(v);yield cs(b),yield b.auth._persistUserIfCurrent(b),b.auth._notifyListenersIfCurrent(b)})).apply(this,arguments)}(this)}_assign(v){this!==v&&(Qe(this.uid===v.uid,this.auth,"internal-error"),this.displayName=v.displayName,this.photoURL=v.photoURL,this.email=v.email,this.emailVerified=v.emailVerified,this.phoneNumber=v.phoneNumber,this.isAnonymous=v.isAnonymous,this.tenantId=v.tenantId,this.providerData=v.providerData.map(b=>Object.assign({},b)),this.metadata._copy(v.metadata),this.stsTokenManager._assign(v.stsTokenManager))}_clone(v){const b=new qs(Object.assign(Object.assign({},this),{auth:v,stsTokenManager:this.stsTokenManager._clone()}));return b.metadata._copy(this.metadata),b}_onReload(v){Qe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=v,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(v){this.reloadListener?this.reloadListener(v):this.reloadUserInfo=v}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(v,b=!1){var T=this;return(0,d.Z)(function*(){let P=!1;v.idToken&&v.idToken!==T.stsTokenManager.accessToken&&(T.stsTokenManager.updateFromServerResponse(v),P=!0),b&&(yield cs(T)),yield T.auth._persistUserIfCurrent(T),P&&T.auth._notifyListenersIfCurrent(T)})()}delete(){var v=this;return(0,d.Z)(function*(){const b=yield v.getIdToken();return yield Ds(v,function za(k,v){return(ee=ee||(0,d.Z)(function*(b,T){return oi(b,"POST","/v1/accounts:delete",T)})).apply(this,arguments)}(v.auth,{idToken:b})),v.stsTokenManager.clearRefreshToken(),v.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(v=>Object.assign({},v)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(v,b){var T,P,F,q,re,me,Fe,Ht;const Mt=null!==(T=b.displayName)&&void 0!==T?T:void 0,Kt=null!==(P=b.email)&&void 0!==P?P:void 0,Fn=null!==(F=b.phoneNumber)&&void 0!==F?F:void 0,ur=null!==(q=b.photoURL)&&void 0!==q?q:void 0,Ns=null!==(re=b.tenantId)&&void 0!==re?re:void 0,dr=null!==(me=b._redirectEventId)&&void 0!==me?me:void 0,Yl=null!==(Fe=b.createdAt)&&void 0!==Fe?Fe:void 0,mh=null!==(Ht=b.lastLoginAt)&&void 0!==Ht?Ht:void 0,{uid:Gu,emailVerified:ol,isAnonymous:ph,providerData:gh,stsTokenManager:Kc}=b;Qe(Gu&&Kc,v,"internal-error");const _h=fa.fromJSON(this.name,Kc);Qe("string"==typeof Gu,v,"internal-error"),us(Mt,v.name),us(Kt,v.name),Qe("boolean"==typeof ol,v,"internal-error"),Qe("boolean"==typeof ph,v,"internal-error"),us(Fn,v.name),us(ur,v.name),us(Ns,v.name),us(dr,v.name),us(Yl,v.name),us(mh,v.name);const qc=new qs({uid:Gu,auth:v,email:Kt,emailVerified:ol,displayName:Mt,isAnonymous:ph,photoURL:ur,phoneNumber:Fn,tenantId:Ns,stsTokenManager:_h,createdAt:Yl,lastLoginAt:mh});return gh&&Array.isArray(gh)&&(qc.providerData=gh.map(al=>Object.assign({},al))),dr&&(qc._redirectEventId=dr),qc}static _fromIdTokenResponse(v,b,T=!1){return(0,d.Z)(function*(){const P=new fa;P.updateFromServerResponse(b);const F=new qs({uid:b.localId,auth:v,stsTokenManager:P,isAnonymous:T});return yield cs(F),F})()}}const ds=new Map;function mo(k){Lr(k instanceof Function,"Expected a class definition");let v=ds.get(k);return v?(Lr(v instanceof k,"Instance stored in cache mismatched with class"),v):(v=new k,ds.set(k,v),v)}const Cd=(()=>{class k{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,d.Z)(function*(){return!0})()}_set(b,T){var P=this;return(0,d.Z)(function*(){P.storage[b]=T})()}_get(b){var T=this;return(0,d.Z)(function*(){const P=T.storage[b];return void 0===P?null:P})()}_remove(b){var T=this;return(0,d.Z)(function*(){delete T.storage[b]})()}_addListener(b,T){}_removeListener(b,T){}}return k.type="NONE",k})();function No(k,v,b){return`firebase:${k}:${v}:${b}`}class mc{constructor(v,b,T){this.persistence=v,this.auth=b,this.userKey=T;const{config:P,name:F}=this.auth;this.fullUserKey=No(this.userKey,P.apiKey,F),this.fullPersistenceKey=No("persistence",P.apiKey,F),this.boundEventHandler=b._onStorageEvent.bind(b),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(v){return this.persistence._set(this.fullUserKey,v.toJSON())}getCurrentUser(){var v=this;return(0,d.Z)(function*(){const b=yield v.persistence._get(v.fullUserKey);return b?qs._fromJSON(v.auth,b):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(v){var b=this;return(0,d.Z)(function*(){if(b.persistence===v)return;const T=yield b.getCurrentUser();return yield b.removeCurrentUser(),b.persistence=v,T?b.setCurrentUser(T):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(v,b,T="authUser"){return(0,d.Z)(function*(){var P,F;if(!b.length)return new mc(mo(Cd),v,T);const q=(yield Promise.all(b.map(function(Mt){return(P=P||(0,d.Z)(function*(Kt){if(yield Kt._isAvailable())return Kt})).apply(this,arguments)}))).filter(Mt=>Mt);let re=q[0]||mo(Cd);const me=No(T,v.config.apiKey,v.name);let Fe=null;for(const Mt of b)try{const Kt=yield Mt._get(me);if(Kt){const Fn=qs._fromJSON(v,Kt);Mt!==re&&(Fe=Fn),re=Mt;break}}catch{}const Ht=q.filter(Mt=>Mt._shouldAllowMigration);return re._shouldAllowMigration&&Ht.length?(re=Ht[0],Fe&&(yield re._set(me,Fe.toJSON())),yield Promise.all(b.map(function(Mt){return(F=F||(0,d.Z)(function*(Kt){if(Kt!==re)try{yield Kt._remove(me)}catch{}})).apply(this,arguments)})),new mc(re,v,T)):new mc(re,v,T)})()}}function Nf(k){const v=k.toLowerCase();if(v.includes("opera/")||v.includes("opr/")||v.includes("opios/"))return"Opera";if(Bf(v))return"IEMobile";if(v.includes("msie")||v.includes("trident/"))return"IE";if(v.includes("edge/"))return"Edge";if(Sd(v))return"Firefox";if(v.includes("silk/"))return"Silk";if(gu(v))return"Blackberry";if(Jp(v))return"Webos";if(Dd(v))return"Safari";if((v.includes("chrome/")||Ff(v))&&!v.includes("edge/"))return"Chrome";if(pc(v))return"Android";{const T=k.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===T?.length)return T[1]}return"Other"}function Sd(k=(0,Q.z$)()){return/firefox\//i.test(k)}function Dd(k=(0,Q.z$)()){const v=k.toLowerCase();return v.includes("safari/")&&!v.includes("chrome/")&&!v.includes("crios/")&&!v.includes("android")}function Ff(k=(0,Q.z$)()){return/crios\//i.test(k)}function Bf(k=(0,Q.z$)()){return/iemobile/i.test(k)}function pc(k=(0,Q.z$)()){return/android/i.test(k)}function gu(k=(0,Q.z$)()){return/blackberry/i.test(k)}function Jp(k=(0,Q.z$)()){return/webos/i.test(k)}function _u(k=(0,Q.z$)()){return/iphone|ipad|ipod/i.test(k)||/macintosh/i.test(k)&&/mobile/i.test(k)}function Ad(k=(0,Q.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(k)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(k)}function yu(k=(0,Q.z$)()){return _u(k)||pc(k)||Jp(k)||gu(k)||/windows phone/i.test(k)||Bf(k)}function Uf(k,v=[]){let b;switch(k){case"Browser":b=Nf((0,Q.z$)());break;case"Worker":b=`${Nf((0,Q.z$)())}-${k}`;break;default:b=k}const T=v.length?v.join(","):"FirebaseCore-web";return`${b}/JsCore/${V.SDK_VERSION}/${T}`}function ma(k,v){return(qe=qe||(0,d.Z)(function*(b,T){return oi(b,"GET","/v2/recaptchaConfig",fn(b,T))})).apply(this,arguments)}function $f(k){return void 0!==k&&void 0!==k.getResponse}function kd(k){return void 0!==k&&void 0!==k.enterprise}class vu{constructor(v){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===v.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=v.recaptchaKey.split("/")[3],this.emailPasswordEnabled=v.recaptchaEnforcementState.some(b=>"EMAIL_PASSWORD_PROVIDER"===b.provider&&"OFF"!==b.enforcementState)}}function Cl(k){return new Promise((v,b)=>{const T=document.createElement("script");T.setAttribute("src",k),T.onload=v,T.onerror=P=>{const F=$t("internal-error");F.customData=P,b(F)},T.type="text/javascript",T.charset="UTF-8",function Hf(){var k,v;return null!==(v=null===(k=document.getElementsByTagName("head"))||void 0===k?void 0:k[0])&&void 0!==v?v:document}().appendChild(T)})}function _c(k){return`__${k}${Math.floor(1e6*Math.random())}`}const bu="NO_RECAPTCHA";class Ka{constructor(v){this.type="recaptcha-enterprise",this.auth=Dn(v)}verify(v="verify",b=!1){var T=this;return(0,d.Z)(function*(){var P;function q(re,me,Fe){const Ht=window.grecaptcha;kd(Ht)?Ht.enterprise.ready(()=>{Ht.enterprise.execute(re,{action:v}).then(Mt=>{me(Mt)}).catch(()=>{me(bu)})}):Fe(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((re,me)=>{(function F(re){return(P=P||(0,d.Z)(function*(me){var Fe;if(!b){if(null==me.tenantId&&null!=me._agentRecaptchaConfig)return me._agentRecaptchaConfig.siteKey;if(null!=me.tenantId&&void 0!==me._tenantRecaptchaConfigs[me.tenantId])return me._tenantRecaptchaConfigs[me.tenantId].siteKey}return new Promise(function(Ht,Mt){return(Fe=Fe||(0,d.Z)(function*(Kt,Fn){ma(me,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(ur=>{if(void 0!==ur.recaptchaKey){const Ns=new vu(ur);return null==me.tenantId?me._agentRecaptchaConfig=Ns:me._tenantRecaptchaConfigs[me.tenantId]=Ns,Kt(Ns.siteKey)}Fn(new Error("recaptcha Enterprise site key undefined"))}).catch(ur=>{Fn(ur)})})).apply(this,arguments)})})).apply(this,arguments)})(T.auth).then(Fe=>{if(!b&&kd(window.grecaptcha))q(Fe,re,me);else{if(typeof window>"u")return void me(new Error("RecaptchaVerifier is only supported in browser"));Cl("https://www.google.com/recaptcha/enterprise.js?render="+Fe).then(()=>{q(Fe,re,me)}).catch(Ht=>{me(Ht)})}}).catch(Fe=>{me(Fe)})})})()}}function Oi(k,v,b){return(it=it||(0,d.Z)(function*(T,P,F,q=!1){const re=new Ka(T);let me;try{me=yield re.verify(F)}catch{me=yield re.verify(F,!0)}const Fe=Object.assign({},P);return Object.assign(Fe,q?{captchaResp:me}:{captchaResponse:me}),Object.assign(Fe,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(Fe,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),Fe})).apply(this,arguments)}class yc{constructor(v){this.auth=v,this.queue=[]}pushCallback(v,b){const T=F=>new Promise((q,re)=>{try{q(v(F))}catch(me){re(me)}});T.onAbort=b,this.queue.push(T);const P=this.queue.length-1;return()=>{this.queue[P]=()=>Promise.resolve()}}runMiddleware(v){var b=this;return(0,d.Z)(function*(){if(b.auth.currentUser===v)return;const T=[];try{for(const P of b.queue)yield P(v),P.onAbort&&T.push(P.onAbort)}catch(P){T.reverse();for(const F of T)try{F()}catch{}throw b.auth._errorFactory.create("login-blocked",{originalMessage:P?.message})}})()}}class vc{constructor(v,b,T,P){this.app=v,this.heartbeatServiceProvider=b,this.appCheckServiceProvider=T,this.config=P,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Sl(this),this.idTokenSubscription=new Sl(this),this.beforeStateQueue=new yc(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ss,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=v.name,this.clientVersion=P.sdkClientVersion}_initializeWithPersistence(v,b){var T=this;return b&&(this._popupRedirectResolver=mo(b)),this._initializationPromise=this.queue((0,d.Z)(function*(){var P,F;if(!T._deleted&&(T.persistenceManager=yield mc.create(T,v),!T._deleted)){if(null!==(P=T._popupRedirectResolver)&&void 0!==P&&P._shouldInitProactively)try{yield T._popupRedirectResolver._initialize(T)}catch{}yield T.initializeCurrentUser(b),T.lastNotifiedUid=(null===(F=T.currentUser)||void 0===F?void 0:F.uid)||null,!T._deleted&&(T._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var v=this;return(0,d.Z)(function*(){if(v._deleted)return;const b=yield v.assertedPersistence.getCurrentUser();if(v.currentUser||b){if(v.currentUser&&b&&v.currentUser.uid===b.uid)return v._currentUser._assign(b),void(yield v.currentUser.getIdToken());yield v._updateCurrentUser(b,!0)}})()}initializeCurrentUser(v){var b=this;return(0,d.Z)(function*(){var T;const P=yield b.assertedPersistence.getCurrentUser();let F=P,q=!1;if(v&&b.config.authDomain){yield b.getOrInitRedirectPersistenceManager();const re=null===(T=b.redirectUser)||void 0===T?void 0:T._redirectEventId,me=F?._redirectEventId,Fe=yield b.tryRedirectSignIn(v);(!re||re===me)&&Fe?.user&&(F=Fe.user,q=!0)}if(!F)return b.directlySetCurrentUser(null);if(!F._redirectEventId){if(q)try{yield b.beforeStateQueue.runMiddleware(F)}catch(re){F=P,b._popupRedirectResolver._overrideRedirectResult(b,()=>Promise.reject(re))}return F?b.reloadAndSetCurrentUserOrClear(F):b.directlySetCurrentUser(null)}return Qe(b._popupRedirectResolver,b,"argument-error"),yield b.getOrInitRedirectPersistenceManager(),b.redirectUser&&b.redirectUser._redirectEventId===F._redirectEventId?b.directlySetCurrentUser(F):b.reloadAndSetCurrentUserOrClear(F)})()}tryRedirectSignIn(v){var b=this;return(0,d.Z)(function*(){let T=null;try{T=yield b._popupRedirectResolver._completeRedirectFn(b,v,!0)}catch{yield b._setRedirectUser(null)}return T})()}reloadAndSetCurrentUserOrClear(v){var b=this;return(0,d.Z)(function*(){try{yield cs(v)}catch(T){if("auth/network-request-failed"!==T?.code)return b.directlySetCurrentUser(null)}return b.directlySetCurrentUser(v)})()}useDeviceLanguage(){this.languageCode=function vn(){if(typeof navigator>"u")return null;const k=navigator;return k.languages&&k.languages[0]||k.language||null}()}_delete(){var v=this;return(0,d.Z)(function*(){v._deleted=!0})()}updateCurrentUser(v){var b=this;return(0,d.Z)(function*(){const T=v?(0,Q.m9)(v):null;return T&&Qe(T.auth.config.apiKey===b.config.apiKey,b,"invalid-user-token"),b._updateCurrentUser(T&&T._clone(b))})()}_updateCurrentUser(v,b=!1){var T=this;return(0,d.Z)(function*(){if(!T._deleted)return v&&Qe(T.tenantId===v.tenantId,T,"tenant-id-mismatch"),b||(yield T.beforeStateQueue.runMiddleware(v)),T.queue((0,d.Z)(function*(){yield T.directlySetCurrentUser(v),T.notifyAuthListeners()}))})()}signOut(){var v=this;return(0,d.Z)(function*(){return yield v.beforeStateQueue.runMiddleware(null),(v.redirectPersistenceManager||v._popupRedirectResolver)&&(yield v._setRedirectUser(null)),v._updateCurrentUser(null,!0)})()}setPersistence(v){var b=this;return this.queue((0,d.Z)(function*(){yield b.assertedPersistence.setPersistence(mo(v))}))}initializeRecaptchaConfig(){var v=this;return(0,d.Z)(function*(){const b=yield ma(v,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),T=new vu(b);null==v.tenantId?v._agentRecaptchaConfig=T:v._tenantRecaptchaConfigs[v.tenantId]=T,T.emailPasswordEnabled&&new Ka(v).verify()})()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(v){this._errorFactory=new Q.LL("auth","Firebase",v())}onAuthStateChanged(v,b,T){return this.registerStateListener(this.authStateSubscription,v,b,T)}beforeAuthStateChanged(v,b){return this.beforeStateQueue.pushCallback(v,b)}onIdTokenChanged(v,b,T){return this.registerStateListener(this.idTokenSubscription,v,b,T)}toJSON(){var v;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(v=this._currentUser)||void 0===v?void 0:v.toJSON()}}_setRedirectUser(v,b){var T=this;return(0,d.Z)(function*(){const P=yield T.getOrInitRedirectPersistenceManager(b);return null===v?P.removeCurrentUser():P.setCurrentUser(v)})()}getOrInitRedirectPersistenceManager(v){var b=this;return(0,d.Z)(function*(){if(!b.redirectPersistenceManager){const T=v&&mo(v)||b._popupRedirectResolver;Qe(T,b,"argument-error"),b.redirectPersistenceManager=yield mc.create(b,[mo(T._redirectPersistence)],"redirectUser"),b.redirectUser=yield b.redirectPersistenceManager.getCurrentUser()}return b.redirectPersistenceManager})()}_redirectUserForId(v){var b=this;return(0,d.Z)(function*(){var T,P;return b._isInitialized&&(yield b.queue((0,d.Z)(function*(){}))),(null===(T=b._currentUser)||void 0===T?void 0:T._redirectEventId)===v?b._currentUser:(null===(P=b.redirectUser)||void 0===P?void 0:P._redirectEventId)===v?b.redirectUser:null})()}_persistUserIfCurrent(v){var b=this;return(0,d.Z)(function*(){if(v===b.currentUser)return b.queue((0,d.Z)(function*(){return b.directlySetCurrentUser(v)}))})()}_notifyListenersIfCurrent(v){v===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var v,b;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const T=null!==(b=null===(v=this.currentUser)||void 0===v?void 0:v.uid)&&void 0!==b?b:null;this.lastNotifiedUid!==T&&(this.lastNotifiedUid=T,this.authStateSubscription.next(this.currentUser))}registerStateListener(v,b,T,P){if(this._deleted)return()=>{};const F="function"==typeof b?b:b.next.bind(b),q=this._isInitialized?Promise.resolve():this._initializationPromise;return Qe(q,this,"internal-error"),q.then(()=>F(this.currentUser)),"function"==typeof b?v.addObserver(b,T,P):v.addObserver(b)}directlySetCurrentUser(v){var b=this;return(0,d.Z)(function*(){b.currentUser&&b.currentUser!==v&&b._currentUser._stopProactiveRefresh(),v&&b.isProactiveRefreshEnabled&&v._startProactiveRefresh(),b.currentUser=v,v?yield b.assertedPersistence.setCurrentUser(v):yield b.assertedPersistence.removeCurrentUser()})()}queue(v){return this.operations=this.operations.then(v,v),this.operations}get assertedPersistence(){return Qe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(v){!v||this.frameworks.includes(v)||(this.frameworks.push(v),this.frameworks.sort(),this.clientVersion=Uf(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var v=this;return(0,d.Z)(function*(){var b;const T={"X-Client-Version":v.clientVersion};v.app.options.appId&&(T["X-Firebase-gmpid"]=v.app.options.appId);const P=yield null===(b=v.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===b?void 0:b.getHeartbeatsHeader();P&&(T["X-Firebase-Client"]=P);const F=yield v._getAppCheckToken();return F&&(T["X-Firebase-AppCheck"]=F),T})()}_getAppCheckToken(){var v=this;return(0,d.Z)(function*(){var b;const T=yield null===(b=v.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===b?void 0:b.getToken();return T?.error&&function Xe(k,...v){fe.logLevel<=ye.in.WARN&&fe.warn(`Auth (${V.SDK_VERSION}): ${k}`,...v)}(`Error while retrieving App Check token: ${T.error}`),T?.token})()}}function Dn(k){return(0,Q.m9)(k)}class Sl{constructor(v){this.auth=v,this.observer=null,this.addObserver=(0,Q.ne)(b=>this.observer=b)}get next(){return Qe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Rd(k,v,b){const T=Dn(k);Qe(T._canInitEmulator,T,"emulator-config-failed"),Qe(/^https?:\/\//.test(v),T,"invalid-emulator-scheme");const P=!!b?.disableWarnings,F=wu(v),{host:q,port:re}=function Gr(k){const v=wu(k),b=/(\/\/)?([^?#/]+)/.exec(k.substr(v.length));if(!b)return{host:"",port:null};const T=b[2].split("@").pop()||"",P=/^(\[[^\]]+\])(:|$)/.exec(T);if(P){const F=P[1];return{host:F,port:ar(T.substr(F.length+1))}}{const[F,q]=T.split(":");return{host:F,port:ar(q)}}}(v);T.config.emulator={url:`${F}//${q}${null===re?"":`:${re}`}/`},T.settings.appVerificationDisabledForTesting=!0,T.emulatorConfig=Object.freeze({host:q,port:re,protocol:F.replace(":",""),options:Object.freeze({disableWarnings:P})}),P||function Md(){function k(){const v=document.createElement("p"),b=v.style;v.innerText="Running in emulator mode. Do not use with production credentials.",b.position="fixed",b.width="100%",b.backgroundColor="#ffffff",b.border=".1em solid #000000",b.color="#b50000",b.bottom="0px",b.left="0px",b.margin="0px",b.zIndex="10000",b.textAlign="center",v.classList.add("firebase-emulator-warning"),document.body.appendChild(v)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",k):k())}()}function wu(k){const v=k.indexOf(":");return v<0?"":k.substr(0,v+1)}function ar(k){if(!k)return null;const v=Number(k);return isNaN(v)?null:v}class As{constructor(v,b){this.providerId=v,this.signInMethod=b}toJSON(){return Jn("not implemented")}_getIdTokenResponse(v){return Jn("not implemented")}_linkToIdToken(v,b){return Jn("not implemented")}_getReauthenticationResolver(v){return Jn("not implemented")}}function Od(k,v){return(Ye=Ye||(0,d.Z)(function*(b,T){return oi(b,"POST","/v1/accounts:resetPassword",fn(b,T))})).apply(this,arguments)}function Bo(k,v){return(je=je||(0,d.Z)(function*(b,T){return oi(b,"POST","/v1/accounts:update",T)})).apply(this,arguments)}function Ya(k,v){return(at=at||(0,d.Z)(function*(b,T){return Jt(b,"POST","/v1/accounts:signInWithPassword",fn(b,T))})).apply(this,arguments)}function nn(k,v){return(Je=Je||(0,d.Z)(function*(b,T){return oi(b,"POST","/v1/accounts:sendOobCode",fn(b,T))})).apply(this,arguments)}function Pd(k,v){return(kt=kt||(0,d.Z)(function*(b,T){return nn(b,T)})).apply(this,arguments)}function wc(k,v){return(cn=cn||(0,d.Z)(function*(b,T){return nn(b,T)})).apply(this,arguments)}class Dl extends As{constructor(v,b,T,P=null){super("password",T),this._email=v,this._password=b,this._tenantId=P}static _fromEmailAndPassword(v,b){return new Dl(v,b,"password")}static _fromEmailAndCode(v,b,T=null){return new Dl(v,b,"emailLink",T)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(v){const b="string"==typeof v?JSON.parse(v):v;if(b?.email&&b?.password){if("password"===b.signInMethod)return this._fromEmailAndPassword(b.email,b.password);if("emailLink"===b.signInMethod)return this._fromEmailAndCode(b.email,b.password,b.tenantId)}return null}_getIdTokenResponse(v){var b=this;return(0,d.Z)(function*(){var T;switch(b.signInMethod){case"password":const F={returnSecureToken:!0,email:b._email,password:b._password,clientType:"CLIENT_TYPE_WEB"};if(null!==(T=v._getRecaptchaConfig())&&void 0!==T&&T.emailPasswordEnabled){const q=yield Oi(v,F,"signInWithPassword");return Ya(v,q)}var P;return Ya(v,F).catch(function(q){return(P=P||(0,d.Z)(function*(re){if("auth/missing-recaptcha-token"===re.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const me=yield Oi(v,F,"signInWithPassword");return Ya(v,me)}return Promise.reject(re)})).apply(this,arguments)});case"emailLink":return function Nd(k,v){return(yn=yn||(0,d.Z)(function*(b,T){return Jt(b,"POST","/v1/accounts:signInWithEmailLink",fn(b,T))})).apply(this,arguments)}(v,{email:b._email,oobCode:b._password});default:Ct(v,"internal-error")}})()}_linkToIdToken(v,b){var T=this;return(0,d.Z)(function*(){switch(T.signInMethod){case"password":return Bo(v,{idToken:b,returnSecureToken:!0,email:T._email,password:T._password});case"emailLink":return function xu(k,v){return(Rt=Rt||(0,d.Z)(function*(b,T){return Jt(b,"POST","/v1/accounts:signInWithEmailLink",fn(b,T))})).apply(this,arguments)}(v,{idToken:b,email:T._email,oobCode:T._password});default:Ct(v,"internal-error")}})()}_getReauthenticationResolver(v){return this._getIdTokenResponse(v)}}function Ys(k,v){return(co=co||(0,d.Z)(function*(b,T){return Jt(b,"POST","/v1/accounts:signInWithIdp",fn(b,T))})).apply(this,arguments)}class mn extends As{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(v){const b=new mn(v.providerId,v.signInMethod);return v.idToken||v.accessToken?(v.idToken&&(b.idToken=v.idToken),v.accessToken&&(b.accessToken=v.accessToken),v.nonce&&!v.pendingToken&&(b.nonce=v.nonce),v.pendingToken&&(b.pendingToken=v.pendingToken)):v.oauthToken&&v.oauthTokenSecret?(b.accessToken=v.oauthToken,b.secret=v.oauthTokenSecret):Ct("argument-error"),b}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(v){const b="string"==typeof v?JSON.parse(v):v,{providerId:T,signInMethod:P}=b,F=(0,he._T)(b,["providerId","signInMethod"]);if(!T||!P)return null;const q=new mn(T,P);return q.idToken=F.idToken||void 0,q.accessToken=F.accessToken||void 0,q.secret=F.secret,q.nonce=F.nonce,q.pendingToken=F.pendingToken||null,q}_getIdTokenResponse(v){return Ys(v,this.buildRequest())}_linkToIdToken(v,b){const T=this.buildRequest();return T.idToken=b,Ys(v,T)}_getReauthenticationResolver(v){const b=this.buildRequest();return b.autoCreate=!1,Ys(v,b)}buildRequest(){const v={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)v.pendingToken=this.pendingToken;else{const b={};this.idToken&&(b.id_token=this.idToken),this.accessToken&&(b.access_token=this.accessToken),this.secret&&(b.oauth_token_secret=this.secret),b.providerId=this.providerId,this.nonce&&!this.pendingToken&&(b.nonce=this.nonce),v.postBody=(0,Q.xO)(b)}return v}}const Ud={USER_NOT_FOUND:"user-not-found"};class cr extends As{constructor(v){super("phone","phone"),this.params=v}static _fromVerification(v,b){return new cr({verificationId:v,verificationCode:b})}static _fromTokenResponse(v,b){return new cr({phoneNumber:v,temporaryProof:b})}_getIdTokenResponse(v){return function Bd(k,v){return(is=is||(0,d.Z)(function*(b,T){return Jt(b,"POST","/v1/accounts:signInWithPhoneNumber",fn(b,T))})).apply(this,arguments)}(v,this._makeVerificationRequest())}_linkToIdToken(v,b){return function lr(k,v){return(zs=zs||(0,d.Z)(function*(b,T){const P=yield Jt(b,"POST","/v1/accounts:signInWithPhoneNumber",fn(b,T));if(P.temporaryProof)throw Lo(b,"account-exists-with-different-credential",P);return P})).apply(this,arguments)}(v,Object.assign({idToken:b},this._makeVerificationRequest()))}_getReauthenticationResolver(v){return function Al(k,v){return(_e=_e||(0,d.Z)(function*(b,T){return Jt(b,"POST","/v1/accounts:signInWithPhoneNumber",fn(b,Object.assign(Object.assign({},T),{operation:"REAUTH"})),Ud)})).apply(this,arguments)}(v,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:v,phoneNumber:b,verificationId:T,verificationCode:P}=this.params;return v&&b?{temporaryProof:v,phoneNumber:b}:{sessionInfo:T,code:P}}toJSON(){const v={providerId:this.providerId};return this.params.phoneNumber&&(v.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(v.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(v.verificationCode=this.params.verificationCode),this.params.verificationId&&(v.verificationId=this.params.verificationId),v}static fromJSON(v){"string"==typeof v&&(v=JSON.parse(v));const{verificationId:b,verificationCode:T,phoneNumber:P,temporaryProof:F}=v;return T||b||P||F?new cr({verificationId:b,verificationCode:T,phoneNumber:P,temporaryProof:F}):null}}class kl{constructor(v){var b,T,P,F,q,re;const me=(0,Q.zd)((0,Q.pd)(v)),Fe=null!==(b=me.apiKey)&&void 0!==b?b:null,Ht=null!==(T=me.oobCode)&&void 0!==T?T:null,Mt=function Tu(k){switch(k){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(P=me.mode)&&void 0!==P?P:null);Qe(Fe&&Ht&&Mt,"argument-error"),this.apiKey=Fe,this.operation=Mt,this.code=Ht,this.continueUrl=null!==(F=me.continueUrl)&&void 0!==F?F:null,this.languageCode=null!==(q=me.languageCode)&&void 0!==q?q:null,this.tenantId=null!==(re=me.tenantId)&&void 0!==re?re:null}static parseLink(v){const b=function Iu(k){const v=(0,Q.zd)((0,Q.pd)(k)).link,b=v?(0,Q.zd)((0,Q.pd)(v)).deep_link_id:null,T=(0,Q.zd)((0,Q.pd)(k)).deep_link_id;return(T?(0,Q.zd)((0,Q.pd)(T)).link:null)||T||b||v||k}(v);try{return new kl(b)}catch{return null}}}let Rl=(()=>{class k{constructor(){this.providerId=k.PROVIDER_ID}static credential(b,T){return Dl._fromEmailAndPassword(b,T)}static credentialWithLink(b,T){const P=kl.parseLink(T);return Qe(P,"argument-error"),Dl._fromEmailAndCode(b,P.code,P.tenantId)}}return k.PROVIDER_ID="password",k.EMAIL_PASSWORD_SIGN_IN_METHOD="password",k.EMAIL_LINK_SIGN_IN_METHOD="emailLink",k})();class di{constructor(v){this.providerId=v,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(v){this.defaultLanguageCode=v}setCustomParameters(v){return this.customParameters=v,this}getCustomParameters(){return this.customParameters}}class gr extends di{constructor(){super(...arguments),this.scopes=[]}addScope(v){return this.scopes.includes(v)||this.scopes.push(v),this}getScopes(){return[...this.scopes]}}class ks extends gr{static credentialFromJSON(v){const b="string"==typeof v?JSON.parse(v):v;return Qe("providerId"in b&&"signInMethod"in b,"argument-error"),mn._fromParams(b)}credential(v){return this._credential(Object.assign(Object.assign({},v),{nonce:v.rawNonce}))}_credential(v){return Qe(v.idToken||v.accessToken,"argument-error"),mn._fromParams(Object.assign(Object.assign({},v),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(v){return ks.oauthCredentialFromTaggedObject(v)}static credentialFromError(v){return ks.oauthCredentialFromTaggedObject(v.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:v}){if(!v)return null;const{oauthIdToken:b,oauthAccessToken:T,oauthTokenSecret:P,pendingToken:F,nonce:q,providerId:re}=v;if(!T&&!P&&!b&&!F||!re)return null;try{return new ks(re)._credential({idToken:b,accessToken:T,nonce:q,pendingToken:F})}catch{return null}}}let Ml=(()=>{class k extends gr{constructor(){super("facebook.com")}static credential(b){return mn._fromParams({providerId:k.PROVIDER_ID,signInMethod:k.FACEBOOK_SIGN_IN_METHOD,accessToken:b})}static credentialFromResult(b){return k.credentialFromTaggedObject(b)}static credentialFromError(b){return k.credentialFromTaggedObject(b.customData||{})}static credentialFromTaggedObject({_tokenResponse:b}){if(!b||!("oauthAccessToken"in b)||!b.oauthAccessToken)return null;try{return k.credential(b.oauthAccessToken)}catch{return null}}}return k.FACEBOOK_SIGN_IN_METHOD="facebook.com",k.PROVIDER_ID="facebook.com",k})(),po=(()=>{class k extends gr{constructor(){super("google.com"),this.addScope("profile")}static credential(b,T){return mn._fromParams({providerId:k.PROVIDER_ID,signInMethod:k.GOOGLE_SIGN_IN_METHOD,idToken:b,accessToken:T})}static credentialFromResult(b){return k.credentialFromTaggedObject(b)}static credentialFromError(b){return k.credentialFromTaggedObject(b.customData||{})}static credentialFromTaggedObject({_tokenResponse:b}){if(!b)return null;const{oauthIdToken:T,oauthAccessToken:P}=b;if(!T&&!P)return null;try{return k.credential(T,P)}catch{return null}}}return k.GOOGLE_SIGN_IN_METHOD="google.com",k.PROVIDER_ID="google.com",k})(),Vd=(()=>{class k extends gr{constructor(){super("github.com")}static credential(b){return mn._fromParams({providerId:k.PROVIDER_ID,signInMethod:k.GITHUB_SIGN_IN_METHOD,accessToken:b})}static credentialFromResult(b){return k.credentialFromTaggedObject(b)}static credentialFromError(b){return k.credentialFromTaggedObject(b.customData||{})}static credentialFromTaggedObject({_tokenResponse:b}){if(!b||!("oauthAccessToken"in b)||!b.oauthAccessToken)return null;try{return k.credential(b.oauthAccessToken)}catch{return null}}}return k.GITHUB_SIGN_IN_METHOD="github.com",k.PROVIDER_ID="github.com",k})();class Ol extends As{constructor(v,b){super(v,v),this.pendingToken=b}_getIdTokenResponse(v){return Ys(v,this.buildRequest())}_linkToIdToken(v,b){const T=this.buildRequest();return T.idToken=b,Ys(v,T)}_getReauthenticationResolver(v){const b=this.buildRequest();return b.autoCreate=!1,Ys(v,b)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(v){const b="string"==typeof v?JSON.parse(v):v,{providerId:T,signInMethod:P,pendingToken:F}=b;return T&&P&&F&&T===P?new Ol(T,F):null}static _create(v,b){return new Ol(v,b)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Rs extends di{constructor(v){Qe(v.startsWith("saml."),"argument-error"),super(v)}static credentialFromResult(v){return Rs.samlCredentialFromTaggedObject(v)}static credentialFromError(v){return Rs.samlCredentialFromTaggedObject(v.customData||{})}static credentialFromJSON(v){const b=Ol.fromJSON(v);return Qe(b,"argument-error"),b}static samlCredentialFromTaggedObject({_tokenResponse:v}){if(!v)return null;const{pendingToken:b,providerId:T}=v;if(!b||!T)return null;try{return Ol._create(T,b)}catch{return null}}}let hs=(()=>{class k extends gr{constructor(){super("twitter.com")}static credential(b,T){return mn._fromParams({providerId:k.PROVIDER_ID,signInMethod:k.TWITTER_SIGN_IN_METHOD,oauthToken:b,oauthTokenSecret:T})}static credentialFromResult(b){return k.credentialFromTaggedObject(b)}static credentialFromError(b){return k.credentialFromTaggedObject(b.customData||{})}static credentialFromTaggedObject({_tokenResponse:b}){if(!b)return null;const{oauthAccessToken:T,oauthTokenSecret:P}=b;if(!T||!P)return null;try{return k.credential(T,P)}catch{return null}}}return k.TWITTER_SIGN_IN_METHOD="twitter.com",k.PROVIDER_ID="twitter.com",k})();function Ec(k,v){return(Ee=Ee||(0,d.Z)(function*(b,T){return Jt(b,"POST","/v1/accounts:signUp",fn(b,T))})).apply(this,arguments)}class Ir{constructor(v){this.user=v.user,this.providerId=v.providerId,this._tokenResponse=v._tokenResponse,this.operationType=v.operationType}static _fromIdTokenResponse(v,b,T,P=!1){return(0,d.Z)(function*(){const F=yield qs._fromIdTokenResponse(v,T,P),q=Wf(T);return new Ir({user:F,providerId:q,_tokenResponse:T,operationType:b})})()}static _forOperation(v,b,T){return(0,d.Z)(function*(){yield v._updateTokensIfNecessary(T,!0);const P=Wf(T);return new Ir({user:v,providerId:P,_tokenResponse:T,operationType:b})})()}}function Wf(k){return k.providerId?k.providerId:"phoneNumber"in k?"phone":null}function $d(k){return(Te=Te||(0,d.Z)(function*(v){var b;const T=Dn(v);if(yield T._initializationPromise,null!==(b=T.currentUser)&&void 0!==b&&b.isAnonymous)return new Ir({user:T.currentUser,providerId:null,operationType:"signIn"});const P=yield Ec(T,{returnSecureToken:!0}),F=yield Ir._fromIdTokenResponse(T,"signIn",P,!0);return yield T._updateCurrentUser(F.user),F})).apply(this,arguments)}class Pl extends Q.ZR{constructor(v,b,T,P){var F;super(b.code,b.message),this.operationType=T,this.user=P,Object.setPrototypeOf(this,Pl.prototype),this.customData={appName:v.name,tenantId:null!==(F=v.tenantId)&&void 0!==F?F:void 0,_serverResponse:b.customData._serverResponse,operationType:T}}static _fromErrorAndOperation(v,b,T,P){return new Pl(v,b,T,P)}}function Hd(k,v,b,T){return("reauthenticate"===v?b._getReauthenticationResolver(k):b._getIdTokenResponse(k)).catch(F=>{throw"auth/multi-factor-auth-required"===F.code?Pl._fromErrorAndOperation(k,F,v,T):F})}function jd(k){return new Set(k.map(({providerId:v})=>v).filter(v=>!!v))}function Kf(k,v){return(pe=pe||(0,d.Z)(function*(b,T){const P=(0,Q.m9)(b);yield pa(!0,P,T);const{providerUserInfo:F}=yield function or(k,v){return(J=J||(0,d.Z)(function*(b,T){return oi(b,"POST","/v1/accounts:update",T)})).apply(this,arguments)}(P.auth,{idToken:yield P.getIdToken(),deleteProvider:[T]}),q=jd(F||[]);return P.providerData=P.providerData.filter(re=>q.has(re.providerId)),q.has("phone")||(P.phoneNumber=null),yield P.auth._persistUserIfCurrent(P),P})).apply(this,arguments)}function go(k,v){return(rt=rt||(0,d.Z)(function*(b,T,P=!1){const F=yield Ds(b,T._linkToIdToken(b.auth,yield b.getIdToken()),P);return Ir._forOperation(b,"link",F)})).apply(this,arguments)}function pa(k,v,b){return(Ze=Ze||(0,d.Z)(function*(T,P,F){yield cs(P);const re=!1===T?"provider-already-linked":"no-such-provider";Qe(jd(P.providerData).has(F)===T,P.auth,re)})).apply(this,arguments)}function xc(k,v){return(jt=jt||(0,d.Z)(function*(b,T,P=!1){const{auth:F}=b,q="reauthenticate";try{const re=yield Ds(b,Hd(F,q,T,b),P);Qe(re.idToken,F,"internal-error");const me=ei(re.idToken);Qe(me,F,"internal-error");const{sub:Fe}=me;return Qe(b.uid===Fe,F,"user-mismatch"),Ir._forOperation(b,q,re)}catch(re){throw"auth/user-not-found"===re?.code&&Ct(F,"user-mismatch"),re}})).apply(this,arguments)}function Gd(k,v){return(At=At||(0,d.Z)(function*(b,T,P=!1){const F="signIn",q=yield Hd(b,F,T),re=yield Ir._fromIdTokenResponse(b,F,q);return P||(yield b._updateCurrentUser(re.user)),re})).apply(this,arguments)}function Ii(k,v){return(li=li||(0,d.Z)(function*(b,T){return Gd(Dn(b),T)})).apply(this,arguments)}function Uo(k,v){return(Vt=Vt||(0,d.Z)(function*(b,T){const P=(0,Q.m9)(b);return yield pa(!1,P,T.providerId),go(P,T)})).apply(this,arguments)}function ai(k,v){return(Sn=Sn||(0,d.Z)(function*(b,T){return xc((0,Q.m9)(b),T)})).apply(this,arguments)}function _r(k,v){return(jn=jn||(0,d.Z)(function*(b,T){const P=Dn(b),F=yield function qf(k,v){return(si=si||(0,d.Z)(function*(b,T){return Jt(b,"POST","/v1/accounts:signInWithCustomToken",fn(b,T))})).apply(this,arguments)}(P,{token:T,returnSecureToken:!0}),q=yield Ir._fromIdTokenResponse(P,"signIn",F);return yield P._updateCurrentUser(q.user),q})).apply(this,arguments)}class Ll{constructor(v,b){this.factorId=v,this.uid=b.mfaEnrollmentId,this.enrollmentTime=new Date(b.enrolledAt).toUTCString(),this.displayName=b.displayName}static _fromServerResponse(v,b){return"phoneInfo"in b?zd._fromServerResponse(v,b):"totpInfo"in b?Su._fromServerResponse(v,b):Ct(v,"internal-error")}}class zd extends Ll{constructor(v){super("phone",v),this.phoneNumber=v.phoneInfo}static _fromServerResponse(v,b){return new zd(b)}}class Su extends Ll{constructor(v){super("totp",v)}static _fromServerResponse(v,b){return new Su(b)}}function ga(k,v,b){var T;Qe((null===(T=b.url)||void 0===T?void 0:T.length)>0,k,"invalid-continue-uri"),Qe(typeof b.dynamicLinkDomain>"u"||b.dynamicLinkDomain.length>0,k,"invalid-dynamic-link-domain"),v.continueUrl=b.url,v.dynamicLinkDomain=b.dynamicLinkDomain,v.canHandleCodeInApp=b.handleCodeInApp,b.iOS&&(Qe(b.iOS.bundleId.length>0,k,"missing-ios-bundle-id"),v.iOSBundleId=b.iOS.bundleId),b.android&&(Qe(b.android.packageName.length>0,k,"missing-android-pkg-name"),v.androidInstallApp=b.android.installApp,v.androidMinimumVersionCode=b.android.minimumVersion,v.androidPackageName=b.android.packageName)}function Nl(k,v,b){return(ki=ki||(0,d.Z)(function*(T,P,F){var q;const re=Dn(T),me={requestType:"PASSWORD_RESET",email:P,clientType:"CLIENT_TYPE_WEB"};if(null!==(q=re._getRecaptchaConfig())&&void 0!==q&&q.emailPasswordEnabled){const Ht=yield Oi(re,me,"getOobCode",!0);F&&ga(re,Ht,F),yield Pd(re,Ht)}else{var Fe;F&&ga(re,me,F),yield Pd(re,me).catch(function(Ht){return(Fe=Fe||(0,d.Z)(function*(Mt){if("auth/missing-recaptcha-token"!==Mt.code)return Promise.reject(Mt);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const Kt=yield Oi(re,me,"getOobCode",!0);F&&ga(re,Kt,F),yield Pd(re,Kt)}})).apply(this,arguments)})}})).apply(this,arguments)}function Tc(k,v,b){return(Ri=Ri||(0,d.Z)(function*(T,P,F){yield Od((0,Q.m9)(T),{oobCode:P,newPassword:F})})).apply(this,arguments)}function Du(k,v){return(pi=pi||(0,d.Z)(function*(b,T){yield function bc(k,v){return(Ge=Ge||(0,d.Z)(function*(b,T){return oi(b,"POST","/v1/accounts:update",fn(b,T))})).apply(this,arguments)}((0,Q.m9)(b),{oobCode:T})})).apply(this,arguments)}function Ic(k,v){return(Mi=Mi||(0,d.Z)(function*(b,T){const P=(0,Q.m9)(b),F=yield Od(P,{oobCode:T}),q=F.requestType;switch(Qe(q,P,"internal-error"),q){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Qe(F.newEmail,P,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Qe(F.mfaInfo,P,"internal-error");default:Qe(F.email,P,"internal-error")}let re=null;return F.mfaInfo&&(re=Ll._fromServerResponse(Dn(P),F.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===F.requestType?F.newEmail:F.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===F.requestType?F.email:F.newEmail)||null,multiFactorInfo:re},operation:q}})).apply(this,arguments)}function Fl(k,v){return(ir=ir||(0,d.Z)(function*(b,T){const{data:P}=yield Ic((0,Q.m9)(b),T);return P.email})).apply(this,arguments)}function Bl(k,v,b){return(yi=yi||(0,d.Z)(function*(T,P,F){var q;const re=Dn(T),me={returnSecureToken:!0,email:P,password:F,clientType:"CLIENT_TYPE_WEB"};let Fe;if(null!==(q=re._getRecaptchaConfig())&&void 0!==q&&q.emailPasswordEnabled){const Fn=yield Oi(re,me,"signUpPassword");Fe=Ec(re,Fn)}else{var Ht;Fe=Ec(re,me).catch(function(Fn){return(Ht=Ht||(0,d.Z)(function*(ur){if("auth/missing-recaptcha-token"===ur.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const Ns=yield Oi(re,me,"signUpPassword");return Ec(re,Ns)}return Promise.reject(ur)})).apply(this,arguments)})}const Mt=yield Fe.catch(Fn=>Promise.reject(Fn)),Kt=yield Ir._fromIdTokenResponse(re,"signIn",Mt);return yield re._updateCurrentUser(Kt.user),Kt})).apply(this,arguments)}function _a(k,v,b){return Ii((0,Q.m9)(k),Rl.credential(v,b))}function Vo(k,v,b){return(Bt=Bt||(0,d.Z)(function*(T,P,F){var q;const re=Dn(T),me={requestType:"EMAIL_SIGNIN",email:P,clientType:"CLIENT_TYPE_WEB"};function Fe(Mt,Kt){Qe(Kt.handleCodeInApp,re,"argument-error"),Kt&&ga(re,Mt,Kt)}if(null!==(q=re._getRecaptchaConfig())&&void 0!==q&&q.emailPasswordEnabled){const Mt=yield Oi(re,me,"getOobCode",!0);Fe(Mt,F),yield wc(re,Mt)}else{var Ht;Fe(me,F),yield wc(re,me).catch(function(Mt){return(Ht=Ht||(0,d.Z)(function*(Kt){if("auth/missing-recaptcha-token"!==Kt.code)return Promise.reject(Kt);{console.log("Email link sign-in is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const Fn=yield Oi(re,me,"getOobCode",!0);Fe(Fn,F),yield wc(re,Fn)}})).apply(this,arguments)})}})).apply(this,arguments)}function Yf(k,v){return"EMAIL_SIGNIN"===kl.parseLink(v)?.operation}function Wd(k,v,b){return(Ts=Ts||(0,d.Z)(function*(T,P,F){const q=(0,Q.m9)(T),re=Rl.credentialWithLink(P,F||ho());return Qe(re._tenantId===(q.tenantId||null),q,"tenant-id-mismatch"),Ii(q,re)})).apply(this,arguments)}function tg(k,v){return(Nn=Nn||(0,d.Z)(function*(b,T){const F={identifier:T,continueUri:Ga()?ho():"http://localhost"},{signinMethods:q}=yield function Au(k,v){return(la=la||(0,d.Z)(function*(b,T){return oi(b,"POST","/v1/accounts:createAuthUri",fn(b,T))})).apply(this,arguments)}((0,Q.m9)(b),F);return q||[]})).apply(this,arguments)}function Zf(k,v){return(Hr=Hr||(0,d.Z)(function*(b,T){const P=(0,Q.m9)(b),q={requestType:"VERIFY_EMAIL",idToken:yield b.getIdToken()};T&&ga(P.auth,q,T);const{email:re}=yield function Eu(k,v){return(Et=Et||(0,d.Z)(function*(b,T){return nn(b,T)})).apply(this,arguments)}(P.auth,q);re!==b.email&&(yield b.reload())})).apply(this,arguments)}function Xf(k,v,b){return(Ti=Ti||(0,d.Z)(function*(T,P,F){const q=(0,Q.m9)(T),me={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield T.getIdToken(),newEmail:P};F&&ga(q.auth,me,F);const{email:Fe}=yield function Ld(k,v){return(Tt=Tt||(0,d.Z)(function*(b,T){return nn(b,T)})).apply(this,arguments)}(q.auth,me);Fe!==T.email&&(yield T.reload())})).apply(this,arguments)}function ku(k,v){return(On=On||(0,d.Z)(function*(b,{displayName:T,photoURL:P}){if(void 0===T&&void 0===P)return;const F=(0,Q.m9)(b),re={idToken:yield F.getIdToken(),displayName:T,photoUrl:P,returnSecureToken:!0},me=yield Ds(F,function Cc(k,v){return(ni=ni||(0,d.Z)(function*(b,T){return oi(b,"POST","/v1/accounts:update",T)})).apply(this,arguments)}(F.auth,re));F.displayName=me.displayName||null,F.photoURL=me.photoUrl||null;const Fe=F.providerData.find(({providerId:Ht})=>"password"===Ht);Fe&&(Fe.displayName=F.displayName,Fe.photoURL=F.photoURL),yield F._updateTokensIfNecessary(me)})).apply(this,arguments)}function Za(k,v){return $o((0,Q.m9)(k),v,null)}function Ru(k,v){return $o((0,Q.m9)(k),null,v)}function $o(k,v,b){return(Gt=Gt||(0,d.Z)(function*(T,P,F){const{auth:q}=T,me={idToken:yield T.getIdToken(),returnSecureToken:!0};P&&(me.email=P),F&&(me.password=F);const Fe=yield Ds(T,Bo(q,me));yield T._updateTokensIfNecessary(Fe,!0)})).apply(this,arguments)}class _o{constructor(v,b,T={}){this.isNewUser=v,this.providerId=b,this.profile=T}}class Ul extends _o{constructor(v,b,T,P){super(v,b,T),this.username=P}}class Vl extends _o{constructor(v,b){super(v,"facebook.com",b)}}class Qf extends Ul{constructor(v,b){super(v,"github.com",b,"string"==typeof b?.login?b?.login:null)}}class Sc extends _o{constructor(v,b){super(v,"google.com",b)}}class Dc extends Ul{constructor(v,b,T){super(v,"twitter.com",b,T)}}function Xa(k){const{user:v,_tokenResponse:b}=k;return v.isAnonymous&&!b?{providerId:null,isNewUser:!1,profile:null}:function ya(k){var v,b;if(!k)return null;const{providerId:T}=k,P=k.rawUserInfo?JSON.parse(k.rawUserInfo):{},F=k.isNewUser||"identitytoolkit#SignupNewUserResponse"===k.kind;if(!T&&k?.idToken){const q=null===(b=null===(v=ei(k.idToken))||void 0===v?void 0:v.firebase)||void 0===b?void 0:b.sign_in_provider;if(q)return new _o(F,"anonymous"!==q&&"custom"!==q?q:null)}if(!T)return null;switch(T){case"facebook.com":return new Vl(F,P);case"github.com":return new Qf(F,P);case"google.com":return new Sc(F,P);case"twitter.com":return new Dc(F,P,k.screenName||null);case"custom":case"anonymous":return new _o(F,null);default:return new _o(F,T,P)}}(b)}class Ho{constructor(v,b,T){this.type=v,this.credential=b,this.auth=T}static _fromIdtoken(v,b){return new Ho("enroll",v,b)}static _fromMfaPendingCredential(v){return new Ho("signin",v)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(v){var b,T;if(v?.multiFactorSession){if(null!==(b=v.multiFactorSession)&&void 0!==b&&b.pendingCredential)return Ho._fromMfaPendingCredential(v.multiFactorSession.pendingCredential);if(null!==(T=v.multiFactorSession)&&void 0!==T&&T.idToken)return Ho._fromIdtoken(v.multiFactorSession.idToken)}return null}}class jo{constructor(v,b,T){this.session=v,this.hints=b,this.signInResolver=T}static _fromError(v,b){var T;const P=Dn(v),F=b.customData._serverResponse,q=(F.mfaInfo||[]).map(me=>Ll._fromServerResponse(P,me));Qe(F.mfaPendingCredential,P,"internal-error");const re=Ho._fromMfaPendingCredential(F.mfaPendingCredential);return new jo(re,q,function(me){return(T=T||(0,d.Z)(function*(Fe){const Ht=yield Fe._process(P,re);delete F.mfaInfo,delete F.mfaPendingCredential;const Mt=Object.assign(Object.assign({},F),{idToken:Ht.idToken,refreshToken:Ht.refreshToken});switch(b.operationType){case"signIn":const Kt=yield Ir._fromIdTokenResponse(P,b.operationType,Mt);return yield P._updateCurrentUser(Kt.user),Kt;case"reauthenticate":return Qe(b.user,P,"internal-error"),Ir._forOperation(b.user,b.operationType,Mt);default:Ct(P,"internal-error")}})).apply(this,arguments)})}resolveSignIn(v){var b=this;return(0,d.Z)(function*(){return b.signInResolver(v)})()}}function Pu(k,v){var b;const T=(0,Q.m9)(k),P=v;return Qe(v.customData.operationType,T,"argument-error"),Qe(null===(b=P.customData._serverResponse)||void 0===b?void 0:b.mfaPendingCredential,T,"argument-error"),jo._fromError(T,P)}class yo{constructor(v){this.user=v,this.enrolledFactors=[],v._onReload(b=>{b.mfaInfo&&(this.enrolledFactors=b.mfaInfo.map(T=>Ll._fromServerResponse(v.auth,T)))})}static _fromUser(v){return new yo(v)}getSession(){var v=this;return(0,d.Z)(function*(){return Ho._fromIdtoken(yield v.user.getIdToken(),v.user.auth)})()}enroll(v,b){var T=this;return(0,d.Z)(function*(){const P=v,F=yield T.getSession(),q=yield Ds(T.user,P._process(T.user.auth,F,b));return yield T.user._updateTokensIfNecessary(q),T.user.reload()})()}unenroll(v){var b=this;return(0,d.Z)(function*(){const T="string"==typeof v?v:v.uid,P=yield b.user.getIdToken();try{const F=yield Ds(b.user,function Xd(k,v){return oi(k,"POST","/v2/accounts/mfaEnrollment:withdraw",fn(k,v))}(b.user.auth,{idToken:P,mfaEnrollmentId:T}));b.enrolledFactors=b.enrolledFactors.filter(({uid:q})=>q!==T),yield b.user._updateTokensIfNecessary(F),yield b.user.reload()}catch(F){throw F}})()}}const vo=new WeakMap;function tm(k){const v=(0,Q.m9)(k);return vo.has(v)||vo.set(v,yo._fromUser(v)),vo.get(v)}const va="__sak";class Fu{constructor(v,b){this.storageRetriever=v,this.type=b}_isAvailable(){try{return this.storage?(this.storage.setItem(va,"1"),this.storage.removeItem(va),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(v,b){return this.storage.setItem(v,JSON.stringify(b)),Promise.resolve()}_get(v){const b=this.storage.getItem(v);return Promise.resolve(b?JSON.parse(b):null)}_remove(v){return this.storage.removeItem(v),Promise.resolve()}get storage(){return this.storageRetriever()}}const Jd=(()=>{class k extends Fu{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(b,T)=>this.onStorageEvent(b,T),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function ba(){const k=(0,Q.z$)();return Dd(k)||_u(k)}()&&function eg(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=yu(),this._shouldAllowMigration=!0}forAllChangedKeys(b){for(const T of Object.keys(this.listeners)){const P=this.storage.getItem(T),F=this.localCache[T];P!==F&&b(T,F,P)}}onStorageEvent(b,T=!1){if(!b.key)return void this.forAllChangedKeys((re,me,Fe)=>{this.notifyListeners(re,Fe)});const P=b.key;if(T?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const re=this.storage.getItem(P);if(b.newValue!==re)null!==b.newValue?this.storage.setItem(P,b.newValue):this.storage.removeItem(P);else if(this.localCache[P]===b.newValue&&!T)return}const F=()=>{const re=this.storage.getItem(P);!T&&this.localCache[P]===re||this.notifyListeners(P,re)},q=this.storage.getItem(P);!function Fo(){return(0,Q.w1)()&&10===document.documentMode}()||q===b.newValue||b.newValue===b.oldValue?F():setTimeout(F,10)}notifyListeners(b,T){this.localCache[b]=T;const P=this.listeners[b];if(P)for(const F of Array.from(P))F(T&&JSON.parse(T))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((b,T,P)=>{this.onStorageEvent(new StorageEvent("storage",{key:b,oldValue:T,newValue:P}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(b,T){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[b]||(this.listeners[b]=new Set,this.localCache[b]=this.storage.getItem(b)),this.listeners[b].add(T)}_removeListener(b,T){this.listeners[b]&&(this.listeners[b].delete(T),0===this.listeners[b].size&&delete this.listeners[b]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(b,T){var P=()=>super._set,F=this;return(0,d.Z)(function*(){yield P().call(F,b,T),F.localCache[b]=JSON.stringify(T)})()}_get(b){var T=()=>super._get,P=this;return(0,d.Z)(function*(){const F=yield T().call(P,b);return P.localCache[b]=JSON.stringify(F),F})()}_remove(b){var T=()=>super._remove,P=this;return(0,d.Z)(function*(){yield T().call(P,b),delete P.localCache[b]})()}}return k.type="LOCAL",k})(),Ja=(()=>{class k extends Fu{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(b,T){}_removeListener(b,T){}}return k.type="SESSION",k})();let bo=(()=>{class k{constructor(b){this.eventTarget=b,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(b){const T=this.receivers.find(F=>F.isListeningto(b));if(T)return T;const P=new k(b);return this.receivers.push(P),P}isListeningto(b){return this.eventTarget===b}handleEvent(b){var T=this;return(0,d.Z)(function*(){var P;const F=b,{eventId:q,eventType:re,data:me}=F.data,Fe=T.handlersMap[re];if(!Fe?.size)return;F.ports[0].postMessage({status:"ack",eventId:q,eventType:re});const Ht=Array.from(Fe).map(function(Kt){return(P=P||(0,d.Z)(function*(Fn){return Fn(F.origin,me)})).apply(this,arguments)}),Mt=yield function wa(k){var v;return Promise.all(k.map(function(b){return(v=v||(0,d.Z)(function*(T){try{return{fulfilled:!0,value:yield T}}catch(P){return{fulfilled:!1,reason:P}}})).apply(this,arguments)}))}(Ht);F.ports[0].postMessage({status:"done",eventId:q,eventType:re,response:Mt})})()}_subscribe(b,T){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[b]||(this.handlersMap[b]=new Set),this.handlersMap[b].add(T)}_unsubscribe(b,T){this.handlersMap[b]&&T&&this.handlersMap[b].delete(T),(!T||0===this.handlersMap[b].size)&&delete this.handlersMap[b],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return k.receivers=[],k})();function ri(k="",v=10){let b="";for(let T=0;T<v;T++)b+=Math.floor(10*Math.random());return k+b}class th{constructor(v){this.target=v,this.handlers=new Set}removeMessageHandler(v){v.messageChannel&&(v.messageChannel.port1.removeEventListener("message",v.onMessage),v.messageChannel.port1.close()),this.handlers.delete(v)}_send(v,b,T=50){var P=this;return(0,d.Z)(function*(){const F=typeof MessageChannel<"u"?new MessageChannel:null;if(!F)throw new Error("connection_unavailable");let q,re;return new Promise((me,Fe)=>{const Ht=ri("",20);F.port1.start();const Mt=setTimeout(()=>{Fe(new Error("unsupported_event"))},T);re={messageChannel:F,onMessage(Kt){const Fn=Kt;if(Fn.data.eventId===Ht)switch(Fn.data.status){case"ack":clearTimeout(Mt),q=setTimeout(()=>{Fe(new Error("timeout"))},3e3);break;case"done":clearTimeout(q),me(Fn.data.response);break;default:clearTimeout(Mt),clearTimeout(q),Fe(new Error("invalid_response"))}}},P.handlers.add(re),F.port1.addEventListener("message",re.onMessage),P.target.postMessage({eventType:v,eventId:Ht,data:b},[F.port2])}).finally(()=>{re&&P.removeMessageHandler(re)})})()}}function kn(){return window}function kc(){return typeof kn().WorkerGlobalScope<"u"&&"function"==typeof kn().importScripts}const nm="firebaseLocalStorageDb",ih=1,Rc="firebaseLocalStorage",ig="fbase_key";class Uu{constructor(v){this.request=v}toPromise(){return new Promise((v,b)=>{this.request.addEventListener("success",()=>{v(this.request.result)}),this.request.addEventListener("error",()=>{b(this.request.error)})})}}function rh(k,v){return k.transaction([Rc],v?"readwrite":"readonly").objectStore(Rc)}function im(){const k=indexedDB.open(nm,ih);return new Promise((v,b)=>{k.addEventListener("error",()=>{b(k.error)}),k.addEventListener("upgradeneeded",()=>{const T=k.result;try{T.createObjectStore(Rc,{keyPath:ig})}catch(P){b(P)}}),k.addEventListener("success",(0,d.Z)(function*(){const T=k.result;T.objectStoreNames.contains(Rc)?v(T):(T.close(),yield function $l(){const k=indexedDB.deleteDatabase(nm);return new Uu(k).toPromise()}(),v(yield im()))}))})}function rm(k,v,b){return(ci=ci||(0,d.Z)(function*(T,P,F){const q=rh(T,!0).put({[ig]:P,value:F});return new Uu(q).toPromise()})).apply(this,arguments)}function Vu(k,v){const b=rh(k,!0).delete(v);return new Uu(b).toPromise()}const Ea=(()=>{class k{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var b=this;return(0,d.Z)(function*(){return b.db||(b.db=yield im()),b.db})()}_withRetries(b){var T=this;return(0,d.Z)(function*(){let P=0;for(;;)try{const F=yield T._openDb();return yield b(F)}catch(F){if(P++>3)throw F;T.db&&(T.db.close(),T.db=void 0)}})()}initializeServiceWorkerMessaging(){var b=this;return(0,d.Z)(function*(){return kc()?b.initializeReceiver():b.initializeSender()})()}initializeReceiver(){var b=this;return(0,d.Z)(function*(){var T,P;b.receiver=bo._getInstance(function ng(){return kc()?self:null}()),b.receiver._subscribe("keyChanged",function(F,q){return(T=T||(0,d.Z)(function*(re,me){return{keyProcessed:(yield b._poll()).includes(me.key)}})).apply(this,arguments)}),b.receiver._subscribe("ping",function(F,q){return(P=P||(0,d.Z)(function*(re,me){return["keyChanged"]})).apply(this,arguments)})})()}initializeSender(){var b=this;return(0,d.Z)(function*(){var T,P;if(b.activeServiceWorker=yield function nh(){return(rr=rr||(0,d.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}(),!b.activeServiceWorker)return;b.sender=new th(b.activeServiceWorker);const F=yield b.sender._send("ping",{},800);F&&null!==(T=F[0])&&void 0!==T&&T.fulfilled&&null!==(P=F[0])&&void 0!==P&&P.value.includes("keyChanged")&&(b.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(b){var T=this;return(0,d.Z)(function*(){if(T.sender&&T.activeServiceWorker&&function Pn(){var k;return(null===(k=navigator?.serviceWorker)||void 0===k?void 0:k.controller)||null}()===T.activeServiceWorker)try{yield T.sender._send("keyChanged",{key:b},T.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,d.Z)(function*(){try{if(!indexedDB)return!1;const b=yield im();return yield rm(b,va,"1"),yield Vu(b,va),!0}catch{}return!1})()}_withPendingWrite(b){var T=this;return(0,d.Z)(function*(){T.pendingWrites++;try{yield b()}finally{T.pendingWrites--}})()}_set(b,T){var P=this;return(0,d.Z)(function*(){return P._withPendingWrite((0,d.Z)(function*(){return yield P._withRetries(F=>rm(F,b,T)),P.localCache[b]=T,P.notifyServiceWorker(b)}))})()}_get(b){var T=this;return(0,d.Z)(function*(){const P=yield T._withRetries(F=>function Yi(k,v){return(vi=vi||(0,d.Z)(function*(b,T){const P=rh(b,!1).get(T),F=yield new Uu(P).toPromise();return void 0===F?null:F.value})).apply(this,arguments)}(F,b));return T.localCache[b]=P,P})()}_remove(b){var T=this;return(0,d.Z)(function*(){return T._withPendingWrite((0,d.Z)(function*(){return yield T._withRetries(P=>Vu(P,b)),delete T.localCache[b],T.notifyServiceWorker(b)}))})()}_poll(){var b=this;return(0,d.Z)(function*(){const T=yield b._withRetries(q=>{const re=rh(q,!1).getAll();return new Uu(re).toPromise()});if(!T)return[];if(0!==b.pendingWrites)return[];const P=[],F=new Set;for(const{fbase_key:q,value:re}of T)F.add(q),JSON.stringify(b.localCache[q])!==JSON.stringify(re)&&(b.notifyListeners(q,re),P.push(q));for(const q of Object.keys(b.localCache))b.localCache[q]&&!F.has(q)&&(b.notifyListeners(q,null),P.push(q));return P})()}notifyListeners(b,T){this.localCache[b]=T;const P=this.listeners[b];if(P)for(const F of Array.from(P))F(T)}startPolling(){var b=this;this.stopPolling(),this.pollTimer=setInterval((0,d.Z)(function*(){return b._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(b,T){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[b]||(this.listeners[b]=new Set,this._get(b)),this.listeners[b].add(T)}_removeListener(b,T){this.listeners[b]&&(this.listeners[b].delete(T),0===this.listeners[b].size&&delete this.listeners[b]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return k.type="LOCAL",k})(),Pc=1e12;class om{constructor(v){this.auth=v,this.counter=Pc,this._widgets=new Map}render(v,b){const T=this.counter;return this._widgets.set(T,new ms(v,this.auth.name,b||{})),this.counter++,T}reset(v){var b;const T=v||Pc;null===(b=this._widgets.get(T))||void 0===b||b.delete(),this._widgets.delete(T)}getResponse(v){var b;return(null===(b=this._widgets.get(v||Pc))||void 0===b?void 0:b.getResponse())||""}execute(v){var b=this;return(0,d.Z)(function*(){var T;return null===(T=b._widgets.get(v||Pc))||void 0===T||T.execute(),""})()}}class ms{constructor(v,b,T){this.params=T,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const P="string"==typeof v?document.getElementById(v):v;Qe(P,"argument-error",{appName:b}),this.container=P,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function zn(k){const v=[],b="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let T=0;T<k;T++)v.push(b.charAt(Math.floor(Math.random()*b.length)));return v.join("")}(50);const{callback:v,"expired-callback":b}=this.params;if(v)try{v(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,b)try{b()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Fr=_c("rcb"),St=new ii(3e4,6e4);class ps{constructor(){var v;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(v=kn().grecaptcha)||void 0===v||!v.render)}load(v,b=""){return Qe(function am(k){return k.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(k)}(b),v,"argument-error"),this.shouldResolveImmediately(b)&&$f(kn().grecaptcha)?Promise.resolve(kn().grecaptcha):new Promise((T,P)=>{const F=kn().setTimeout(()=>{P($t(v,"network-request-failed"))},St.get());kn()[Fr]=()=>{kn().clearTimeout(F),delete kn()[Fr];const re=kn().grecaptcha;if(!re||!$f(re))return void P($t(v,"internal-error"));const me=re.render;re.render=(Fe,Ht)=>{const Mt=me(Fe,Ht);return this.counter++,Mt},this.hostLanguage=b,T(re)},Cl(`https://www.google.com/recaptcha/api.js??${(0,Q.xO)({onload:Fr,render:"explicit",hl:b})}`).catch(()=>{clearTimeout(F),P($t(v,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(v){var b;return!(null===(b=kn().grecaptcha)||void 0===b||!b.render)&&(v===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class zr{load(v){return(0,d.Z)(function*(){return new om(v)})()}clearedOneInstance(){}}const Zi="recaptcha",ah={theme:"light",type:"image"};class Lc{constructor(v,b=Object.assign({},ah),T){this.parameters=b,this.type=Zi,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Dn(T),this.isInvisible="invisible"===this.parameters.size,Qe(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const P="string"==typeof v?document.getElementById(v):v;Qe(P,this.auth,"argument-error"),this.container=P,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new zr:new ps,this.validateStartingState()}verify(){var v=this;return(0,d.Z)(function*(){v.assertNotDestroyed();const b=yield v.render(),T=v.getAssertedRecaptcha();return T.getResponse(b)||new Promise(F=>{const q=re=>{re&&(v.tokenChangeListeners.delete(q),F(re))};v.tokenChangeListeners.add(q),v.isInvisible&&T.execute(b)})})()}render(){try{this.assertNotDestroyed()}catch(v){return Promise.reject(v)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(v=>{throw this.renderPromise=null,v})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(v=>{this.container.removeChild(v)})}validateStartingState(){Qe(!this.parameters.sitekey,this.auth,"argument-error"),Qe(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Qe(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(v){return b=>{if(this.tokenChangeListeners.forEach(T=>T(b)),"function"==typeof v)v(b);else if("string"==typeof v){const T=kn()[v];"function"==typeof T&&T(b)}}}assertNotDestroyed(){Qe(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var v=this;return(0,d.Z)(function*(){if(yield v.init(),!v.widgetId){let b=v.container;if(!v.isInvisible){const T=document.createElement("div");b.appendChild(T),b=T}v.widgetId=v.getAssertedRecaptcha().render(b,v.parameters)}return v.widgetId})()}init(){var v=this;return(0,d.Z)(function*(){Qe(Ga()&&!kc(),v.auth,"internal-error"),yield function Nc(){let k=null;return new Promise(v=>{"complete"!==document.readyState?(k=()=>v(),window.addEventListener("load",k)):v()}).catch(v=>{throw k&&window.removeEventListener("load",k),v})}(),v.recaptcha=yield v._recaptchaLoader.load(v.auth,v.auth.languageCode||void 0);const b=yield function Vf(k){return(Ke=Ke||(0,d.Z)(function*(v){return(yield oi(v,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}(v.auth);Qe(b,v.auth,"internal-error"),v.parameters.sitekey=b})()}getAssertedRecaptcha(){return Qe(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class xa{constructor(v,b){this.verificationId=v,this.onConfirmation=b}confirm(v){const b=cr._fromVerification(this.verificationId,v);return this.onConfirmation(b)}}function Br(k,v,b){return(fr=fr||(0,d.Z)(function*(T,P,F){const q=Dn(T),re=yield wt(q,P,(0,Q.m9)(F));return new xa(re,me=>Ii(q,me))})).apply(this,arguments)}function Ta(k,v,b){return(Wi=Wi||(0,d.Z)(function*(T,P,F){const q=(0,Q.m9)(T);yield pa(!1,q,"phone");const re=yield wt(q.auth,P,(0,Q.m9)(F));return new xa(re,me=>Uo(q,me))})).apply(this,arguments)}function jl(k,v,b){return(ca=ca||(0,d.Z)(function*(T,P,F){const q=(0,Q.m9)(T),re=yield wt(q.auth,P,(0,Q.m9)(F));return new xa(re,me=>ai(q,me))})).apply(this,arguments)}function wt(k,v,b){return(Gn=Gn||(0,d.Z)(function*(T,P,F){var q;const re=yield F.verify();try{let me;if(Qe("string"==typeof re,T,"argument-error"),Qe(F.type===Zi,T,"argument-error"),me="string"==typeof P?{phoneNumber:P}:P,"session"in me){const Fe=me.session;if("phoneNumber"in me)return Qe("enroll"===Fe.type,T,"internal-error"),(yield function Lu(k,v){return oi(k,"POST","/v2/accounts/mfaEnrollment:start",fn(k,v))}(T,{idToken:Fe.credential,phoneEnrollmentInfo:{phoneNumber:me.phoneNumber,recaptchaToken:re}})).phoneSessionInfo.sessionInfo;{Qe("signin"===Fe.type,T,"internal-error");const Ht=(null===(q=me.multiFactorHint)||void 0===q?void 0:q.uid)||me.multiFactorUid;return Qe(Ht,T,"missing-multi-factor-info"),(yield function sm(k,v){return oi(k,"POST","/v2/accounts/mfaSignIn:start",fn(k,v))}(T,{mfaPendingCredential:Fe.credential,mfaEnrollmentId:Ht,phoneSignInInfo:{recaptchaToken:re}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:Fe}=yield function Fd(k,v){return(ns=ns||(0,d.Z)(function*(b,T){return oi(b,"POST","/v1/accounts:sendVerificationCode",fn(b,T))})).apply(this,arguments)}(T,{phoneNumber:me.phoneNumber,recaptchaToken:re});return Fe}}finally{F._reset()}})).apply(this,arguments)}function lm(k,v){return(ui=ui||(0,d.Z)(function*(b,T){yield go((0,Q.m9)(b),T)})).apply(this,arguments)}let cm=(()=>{class k{constructor(b){this.providerId=k.PROVIDER_ID,this.auth=Dn(b)}verifyPhoneNumber(b,T){return wt(this.auth,b,(0,Q.m9)(T))}static credential(b,T){return cr._fromVerification(b,T)}static credentialFromResult(b){return k.credentialFromTaggedObject(b)}static credentialFromError(b){return k.credentialFromTaggedObject(b.customData||{})}static credentialFromTaggedObject({_tokenResponse:b}){if(!b)return null;const{phoneNumber:T,temporaryProof:P}=b;return T&&P?cr._fromTokenResponse(T,P):null}}return k.PROVIDER_ID="phone",k.PHONE_SIGN_IN_METHOD="phone",k})();function Wr(k,v){return v?mo(v):(Qe(k._popupRedirectResolver,k,"argument-error"),k._popupRedirectResolver)}class Ia extends As{constructor(v){super("custom","custom"),this.params=v}_getIdTokenResponse(v){return Ys(v,this._buildIdpRequest())}_linkToIdToken(v,b){return Ys(v,this._buildIdpRequest(b))}_getReauthenticationResolver(v){return Ys(v,this._buildIdpRequest())}_buildIdpRequest(v){const b={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return v&&(b.idToken=v),b}}function Ci(k){return Gd(k.auth,new Ia(k),k.bypassAuthState)}function sg(k){const{auth:v,user:b}=k;return Qe(b,v,"internal-error"),xc(b,new Ia(k),k.bypassAuthState)}function lh(k){return(sn=sn||(0,d.Z)(function*(v){const{auth:b,user:T}=v;return Qe(T,b,"internal-error"),go(T,new Ia(v),v.bypassAuthState)})).apply(this,arguments)}class tl{constructor(v,b,T,P,F=!1){this.auth=v,this.resolver=T,this.user=P,this.bypassAuthState=F,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(b)?b:[b]}execute(){var b,v=this;return new Promise(function(T,P){return(b=b||(0,d.Z)(function*(F,q){v.pendingPromise={resolve:F,reject:q};try{v.eventManager=yield v.resolver._initialize(v.auth),yield v.onExecution(),v.eventManager.registerConsumer(v)}catch(re){v.reject(re)}})).apply(this,arguments)})}onAuthEvent(v){var b=this;return(0,d.Z)(function*(){const{urlResponse:T,sessionId:P,postBody:F,tenantId:q,error:re,type:me}=v;if(re)return void b.reject(re);const Fe={auth:b.auth,requestUri:T,sessionId:P,tenantId:q||void 0,postBody:F||void 0,user:b.user,bypassAuthState:b.bypassAuthState};try{b.resolve(yield b.getIdpTask(me)(Fe))}catch(Ht){b.reject(Ht)}})()}onError(v){this.reject(v)}getIdpTask(v){switch(v){case"signInViaPopup":case"signInViaRedirect":return Ci;case"linkViaPopup":case"linkViaRedirect":return lh;case"reauthViaPopup":case"reauthViaRedirect":return sg;default:Ct(this.auth,"internal-error")}}resolve(v){Lr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(v),this.unregisterAndCleanUp()}reject(v){Lr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(v),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Gl=new ii(2e3,1e4);function Fc(k,v,b){return(uo=uo||(0,d.Z)(function*(T,P,F){const q=Dn(T);Rn(T,P,di);const re=Wr(q,F);return new Xs(q,"signInViaPopup",P,re).executeNotNull()})).apply(this,arguments)}function og(k,v,b){return(Tn=Tn||(0,d.Z)(function*(T,P,F){const q=(0,Q.m9)(T);Rn(q.auth,P,di);const re=Wr(q.auth,F);return new Xs(q.auth,"reauthViaPopup",P,re,q).executeNotNull()})).apply(this,arguments)}function Bc(k,v,b){return(Pr=Pr||(0,d.Z)(function*(T,P,F){const q=(0,Q.m9)(T);Rn(q.auth,P,di);const re=Wr(q.auth,F);return new Xs(q.auth,"linkViaPopup",P,re,q).executeNotNull()})).apply(this,arguments)}let Xs=(()=>{class k extends tl{constructor(b,T,P,F,q){super(b,T,F,q),this.provider=P,this.authWindow=null,this.pollId=null,k.currentPopupAction&&k.currentPopupAction.cancel(),k.currentPopupAction=this}executeNotNull(){var b=this;return(0,d.Z)(function*(){const T=yield b.execute();return Qe(T,b.auth,"internal-error"),T})()}onExecution(){var b=this;return(0,d.Z)(function*(){Lr(1===b.filter.length,"Popup operations only handle one event");const T=ri();b.authWindow=yield b.resolver._openPopup(b.auth,b.provider,b.filter[0],T),b.authWindow.associatedEvent=T,b.resolver._originValidation(b.auth).catch(P=>{b.reject(P)}),b.resolver._isIframeWebStorageSupported(b.auth,P=>{P||b.reject($t(b.auth,"web-storage-unsupported"))}),b.pollUserCancellation()})()}get eventId(){var b;return(null===(b=this.authWindow)||void 0===b?void 0:b.associatedEvent)||null}cancel(){this.reject($t(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,k.currentPopupAction=null}pollUserCancellation(){const b=()=>{var T,P;this.pollId=null!==(P=null===(T=this.authWindow)||void 0===T?void 0:T.window)&&void 0!==P&&P.closed?window.setTimeout(()=>{this.pollId=null,this.reject($t(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(b,Gl.get())};b()}}return k.currentPopupAction=null,k})();const Uc="pendingRedirect",zl=new Map;class Qs extends tl{constructor(v,b,T=!1){super(v,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],b,void 0,T),this.eventId=null}execute(){var v=()=>super.execute,b=this;return(0,d.Z)(function*(){let T=zl.get(b.auth._key());if(!T){try{const F=(yield function nl(k,v){return(Ki=Ki||(0,d.Z)(function*(b,T){const P=ch(T),F=Vc(b);if(!(yield F._isAvailable()))return!1;const q="true"===(yield F._get(P));return yield F._remove(P),q})).apply(this,arguments)}(b.resolver,b.auth))?yield v().call(b):null;T=()=>Promise.resolve(F)}catch(P){T=()=>Promise.reject(P)}zl.set(b.auth._key(),T)}return b.bypassAuthState||zl.set(b.auth._key(),()=>Promise.resolve(null)),T()})()}onAuthEvent(v){var b=()=>super.onAuthEvent,T=this;return(0,d.Z)(function*(){if("signInViaRedirect"===v.type)return b().call(T,v);if("unknown"!==v.type){if(v.eventId){const P=yield T.auth._redirectUserForId(v.eventId);if(P)return T.user=P,b().call(T,v);T.resolve(null)}}else T.resolve(null)})()}onExecution(){return(0,d.Z)(function*(){})()}cleanUp(){}}function Kr(k,v){return(sr=sr||(0,d.Z)(function*(b,T){return Vc(b)._set(ch(T),"true")})).apply(this,arguments)}function wo(){zl.clear()}function Pi(k,v){zl.set(k._key(),v)}function Vc(k){return mo(k._redirectPersistence)}function ch(k){return No(Uc,k.config.apiKey,k.name)}function Si(k,v,b){return function qr(k,v,b){return(rs=rs||(0,d.Z)(function*(T,P,F){const q=Dn(T);Rn(T,P,di),yield q._initializationPromise;const re=Wr(q,F);return yield Kr(re,q),re._openRedirect(q,P,"signInViaRedirect")})).apply(this,arguments)}(k,v,b)}function Ms(k,v,b){return function ti(k,v,b){return(qi=qi||(0,d.Z)(function*(T,P,F){const q=(0,Q.m9)(T);Rn(q.auth,P,di),yield q.auth._initializationPromise;const re=Wr(q.auth,F);yield Kr(re,q.auth);const me=yield Os(q);return re._openRedirect(q.auth,P,"reauthViaRedirect",me)})).apply(this,arguments)}(k,v,b)}function Xi(k,v,b){return function Wl(k,v,b){return(Is=Is||(0,d.Z)(function*(T,P,F){const q=(0,Q.m9)(T);Rn(q.auth,P,di),yield q.auth._initializationPromise;const re=Wr(q.auth,F);yield pa(!1,q,P.providerId),yield Kr(re,q.auth);const me=yield Os(q);return re._openRedirect(q.auth,P,"linkViaRedirect",me)})).apply(this,arguments)}(k,v,b)}function $u(k,v){return(Cs=Cs||(0,d.Z)(function*(b,T){return yield Dn(b)._initializationPromise,Ca(b,T,!1)})).apply(this,arguments)}function Ca(k,v){return(ne=ne||(0,d.Z)(function*(b,T,P=!1){const F=Dn(b),q=Wr(F,T),me=yield new Qs(F,q,P).execute();return me&&!P&&(delete me.user._redirectEventId,yield F._persistUserIfCurrent(me.user),yield F._setRedirectUser(null,T)),me})).apply(this,arguments)}function Os(k){return(Z=Z||(0,d.Z)(function*(v){const b=ri(`${v.uid}:::`);return v._redirectEventId=b,yield v.auth._setRedirectUser(v),yield v.auth._persistUserIfCurrent(v),b})).apply(this,arguments)}class gi{constructor(v){this.auth=v,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(v){this.consumers.add(v),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,v)&&(this.sendToConsumer(this.queuedRedirectEvent,v),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(v){this.consumers.delete(v)}onEvent(v){if(this.hasEventBeenHandled(v))return!1;let b=!1;return this.consumers.forEach(T=>{this.isEventForConsumer(v,T)&&(b=!0,this.sendToConsumer(v,T),this.saveEventToCache(v))}),this.hasHandledPotentialRedirect||!function $c(k){switch(k.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ag(k);default:return!1}}(v)||(this.hasHandledPotentialRedirect=!0,b||(this.queuedRedirectEvent=v,b=!0)),b}sendToConsumer(v,b){var T;if(v.error&&!ag(v)){const P=(null===(T=v.error.code)||void 0===T?void 0:T.split("auth/")[1])||"internal-error";b.onError($t(this.auth,P))}else b.onAuthEvent(v)}isEventForConsumer(v,b){const T=null===b.eventId||!!v.eventId&&v.eventId===b.eventId;return b.filter.includes(v.type)&&T}hasEventBeenHandled(v){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ps(v))}saveEventToCache(v){this.cachedEventUids.add(Ps(v)),this.lastProcessedEventTime=Date.now()}}function Ps(k){return[k.type,k.eventId,k.sessionId,k.tenantId].filter(v=>v).join("-")}function ag({type:k,error:v}){return"unknown"===k&&"auth/no-auth-event"===v?.code}function Hc(k){return($=$||(0,d.Z)(function*(v,b={}){return oi(v,"GET","/v1/projects",b)})).apply(this,arguments)}const jc=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,uh=/^https?/;function il(k){const v=ho(),{protocol:b,hostname:T}=new URL(v);if(k.startsWith("chrome-extension://")){const q=new URL(k);return""===q.hostname&&""===T?"chrome-extension:"===b&&k.replace("chrome-extension://","")===v.replace("chrome-extension://",""):"chrome-extension:"===b&&q.hostname===T}if(!uh.test(b))return!1;if(jc.test(k))return T===k;const P=k.replace(/\./g,"\\.");return new RegExp("^(.+\\."+P+"|"+P+")$","i").test(T)}const Xt=new ii(3e4,6e4);function rl(){const k=kn().___jsl;if(k?.H)for(const v of Object.keys(k.H))if(k.H[v].r=k.H[v].r||[],k.H[v].L=k.H[v].L||[],k.H[v].r=[...k.H[v].L],k.CP)for(let b=0;b<k.CP.length;b++)k.CP[b]=null}let To=null;const dh=new ii(5e3,15e3),Io="__/auth/iframe",Hu="emulator/auth/iframe",hh={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ju=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function lg(k){const v=k.config;Qe(v.authDomain,k,"auth-domain-config-required");const b=v.emulator?Nr(v,Hu):`https://${k.config.authDomain}/${Io}`,T={apiKey:v.apiKey,appName:k.name,v:V.SDK_VERSION},P=ju.get(k.config.apiHost);P&&(T.eid=P);const F=k._getFrameworks();return F.length&&(T.fw=F.join(",")),`${b}?${(0,Q.xO)(T).slice(1)}`}const A={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},O=500,H=600,X="_blank",le="http://localhost";class ve{constructor(v){this.window=v,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const ft="__/auth/handler",Dt="emulator/auth/handler",Lt=encodeURIComponent("fac");function un(k,v,b,T,P,F){return(ie=ie||(0,d.Z)(function*(q,re,me,Fe,Ht,Mt){Qe(q.config.authDomain,q,"auth-domain-config-required"),Qe(q.config.apiKey,q,"invalid-api-key");const Kt={apiKey:q.config.apiKey,appName:q.name,authType:me,redirectUrl:Fe,v:V.SDK_VERSION,eventId:Ht};if(re instanceof di){re.setDefaultLanguage(q.languageCode),Kt.providerId=re.providerId||"",(0,Q.xb)(re.getCustomParameters())||(Kt.customParameters=JSON.stringify(re.getCustomParameters()));for(const[dr,Yl]of Object.entries(Mt||{}))Kt[dr]=Yl}if(re instanceof gr){const dr=re.getScopes().filter(Yl=>""!==Yl);dr.length>0&&(Kt.scopes=dr.join(","))}q.tenantId&&(Kt.tid=q.tenantId);const Fn=Kt;for(const dr of Object.keys(Fn))void 0===Fn[dr]&&delete Fn[dr];const ur=yield q._getAppCheckToken(),Ns=ur?`#${Lt}=${encodeURIComponent(ur)}`:"";return`${function Nt({config:k}){return k.emulator?Nr(k,Dt):`https://${k.authDomain}/${ft}`}(q)}?${(0,Q.xO)(Fn).slice(1)}${Ns}`})).apply(this,arguments)}const Zn="webStorageSupport",bi=class Cr{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ja,this._completeRedirectFn=Ca,this._overrideRedirectResult=Pi}_openPopup(v,b,T,P){var F=this;return(0,d.Z)(function*(){var q;Lr(null===(q=F.eventManagers[v._key()])||void 0===q?void 0:q.manager,"_initialize() not called before _openPopup()");const re=yield un(v,b,T,ho(),P);return function Ne(k,v,b,T=O,P=H){const F=Math.max((window.screen.availHeight-P)/2,0).toString(),q=Math.max((window.screen.availWidth-T)/2,0).toString();let re="";const me=Object.assign(Object.assign({},A),{width:T.toString(),height:P.toString(),top:F,left:q}),Fe=(0,Q.z$)().toLowerCase();b&&(re=Ff(Fe)?X:b),Sd(Fe)&&(v=v||le,me.scrollbars="yes");const Ht=Object.entries(me).reduce((Kt,[Fn,ur])=>`${Kt}${Fn}=${ur},`,"");if(function gc(k=(0,Q.z$)()){var v;return _u(k)&&!(null===(v=window.navigator)||void 0===v||!v.standalone)}(Fe)&&"_self"!==re)return function et(k,v){const b=document.createElement("a");b.href=k,b.target=v;const T=document.createEvent("MouseEvent");T.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),b.dispatchEvent(T)}(v||"",re),new ve(null);const Mt=window.open(v||"",re,Ht);Qe(Mt,k,"popup-blocked");try{Mt.focus()}catch{}return new ve(Mt)}(v,re,ri())})()}_openRedirect(v,b,T,P){var F=this;return(0,d.Z)(function*(){return yield F._originValidation(v),function el(k){kn().location.href=k}(yield un(v,b,T,ho(),P)),new Promise(()=>{})})()}_initialize(v){const b=v._key();if(this.eventManagers[b]){const{manager:P,promise:F}=this.eventManagers[b];return P?Promise.resolve(P):(Lr(F,"If manager is not set, promise should be"),F)}const T=this.initAndGetManager(v);return this.eventManagers[b]={promise:T},T.catch(()=>{delete this.eventManagers[b]}),T}initAndGetManager(v){var b=this;return(0,d.Z)(function*(){const T=yield function D(k){return(U=U||(0,d.Z)(function*(v){const b=yield function Go(k){return To=To||function Sa(k){return new Promise((v,b)=>{var T,P,F;function q(){rl(),gapi.load("gapi.iframes",{callback:()=>{v(gapi.iframes.getContext())},ontimeout:()=>{rl(),b($t(k,"network-request-failed"))},timeout:Xt.get()})}if(null!==(P=null===(T=kn().gapi)||void 0===T?void 0:T.iframes)&&void 0!==P&&P.Iframe)v(gapi.iframes.getContext());else{if(null===(F=kn().gapi)||void 0===F||!F.load){const re=_c("iframefcb");return kn()[re]=()=>{gapi.load?q():b($t(k,"network-request-failed"))},Cl(`https://apis.google.com/js/api.js?onload=${re}`).catch(me=>b(me))}q()}}).catch(v=>{throw To=null,v})}(k),To}(v),T=kn().gapi;return Qe(T,v,"internal-error"),b.open({where:document.body,url:lg(v),messageHandlersFilter:T.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:hh,dontclear:!0},P=>{var F;return new Promise(function(q,re){return(F=F||(0,d.Z)(function*(me,Fe){yield P.restyle({setHideOnLeave:!1});const Ht=$t(v,"network-request-failed"),Mt=kn().setTimeout(()=>{Fe(Ht)},dh.get());function Kt(){kn().clearTimeout(Mt),me(P)}P.ping(Kt).then(Kt,()=>{Fe(Ht)})})).apply(this,arguments)})})})).apply(this,arguments)}(v),P=new gi(v);return T.register("authEvent",F=>(Qe(F?.authEvent,v,"invalid-auth-event"),{status:P.onEvent(F.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),b.eventManagers[v._key()]={manager:P},b.iframes[v._key()]=T,P})()}_isIframeWebStorageSupported(v,b){this.iframes[v._key()].send(Zn,{type:Zn},P=>{var F;const q=null===(F=P?.[0])||void 0===F?void 0:F[Zn];void 0!==q&&b(!!q),Ct(v,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(v){const b=v._key();return this.originValidationPromises[b]||(this.originValidationPromises[b]=function xo(k){return(j=j||(0,d.Z)(function*(v){if(v.config.emulator)return;const{authorizedDomains:b}=yield Hc(v);for(const T of b)try{if(il(T))return}catch{}Ct(v,"unauthorized-domain")})).apply(this,arguments)}(v)),this.originValidationPromises[b]}get _shouldInitProactively(){return yu()||Dd()||_u()}};class on{constructor(v){this.factorId=v}_process(v,b,T){switch(b.type){case"enroll":return this._finalizeEnroll(v,b.credential,T);case"signin":return this._finalizeSignIn(v,b.credential);default:return Jn("unexpected MultiFactorSessionType")}}}class Li extends on{constructor(v){super("phone"),this.credential=v}static _fromCredential(v){return new Li(v)}_finalizeEnroll(v,b,T){return function Ac(k,v){return oi(k,"POST","/v2/accounts/mfaEnrollment:finalize",fn(k,v))}(v,{idToken:b,displayName:T,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(v,b){return function Hl(k,v){return oi(k,"POST","/v2/accounts/mfaSignIn:finalize",fn(k,v))}(v,{mfaPendingCredential:b,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let Co=(()=>{class k{constructor(){}static assertion(b){return Li._fromCredential(b)}}return k.FACTOR_ID="phone",k})();var ql="@firebase/auth";class sl{constructor(v){this.auth=v,this.internalListeners=new Map}getUid(){var v;return this.assertAuthConfigured(),(null===(v=this.auth.currentUser)||void 0===v?void 0:v.uid)||null}getToken(v){var b=this;return(0,d.Z)(function*(){return b.assertAuthConfigured(),yield b.auth._initializationPromise,b.auth.currentUser?{accessToken:yield b.auth.currentUser.getIdToken(v)}:null})()}addAuthTokenListener(v){if(this.assertAuthConfigured(),this.internalListeners.has(v))return;const b=this.auth.onIdTokenChanged(T=>{v(T?.stsTokenManager.accessToken||null)});this.internalListeners.set(v,b),this.updateProactiveRefresh()}removeAuthTokenListener(v){this.assertAuthConfigured();const b=this.internalListeners.get(v);b&&(this.internalListeners.delete(v),b(),this.updateProactiveRefresh())}assertAuthConfigured(){Qe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const hm=(0,Q.Pz)("authIdTokenMaxAge")||300;let ug=null;const Oy=k=>{var v;return function(b){return(v=v||(0,d.Z)(function*(T){const P=T&&(yield T.getIdTokenResult()),F=P&&((new Date).getTime()-Date.parse(P.issuedAtTime))/1e3;if(F&&F>hm)return;const q=P?.token;ug!==q&&(ug=q,yield fetch(k,{method:q?"POST":"DELETE",headers:q?{Authorization:`Bearer ${q}`}:{}}))})).apply(this,arguments)}};function fh(k=(0,V.getApp)()){const v=(0,V._getProvider)(k,"auth");if(v.isInitialized())return v.getImmediate();const b=function qa(k,v){const b=(0,V._getProvider)(k,"auth");if(b.isInitialized()){const P=b.getImmediate(),F=b.getOptions();if((0,Q.vZ)(F,v??{}))return P;Ct(P,"already-initialized")}return b.initialize({options:v})}(k,{popupRedirectResolver:bi,persistence:[Ea,Jd,Ja]}),T=(0,Q.Pz)("authTokenSyncURL");if(T){const F=Oy(T);(function Ou(k,v,b){(0,Q.m9)(k).beforeAuthStateChanged(v,b)})(b,F,()=>F(b.currentUser)),function Mu(k,v,b,T){(0,Q.m9)(k).onIdTokenChanged(v,b,T)}(b,q=>F(q))}const P=(0,Q.q4)("auth");return P&&Rd(b,`http://${P}`),b}!function dm(k){(0,V._registerComponent)(new ue.wA("auth",(v,{options:b})=>{const T=v.getProvider("app").getImmediate(),P=v.getProvider("heartbeat"),F=v.getProvider("app-check-internal"),{apiKey:q,authDomain:re}=T.options;Qe(q&&!q.includes(":"),"invalid-api-key",{appName:T.name});const me={apiKey:q,authDomain:re,clientPlatform:k,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Uf(k)},Fe=new vc(T,P,F,me);return function pr(k,v){const b=v?.persistence||[],T=(Array.isArray(b)?b:[b]).map(mo);v?.errorMap&&k._updateErrorMap(v.errorMap),k._initializeWithPersistence(T,v?.popupRedirectResolver)}(Fe,b),Fe},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((v,b,T)=>{v.getProvider("auth-internal").initialize()})),(0,V._registerComponent)(new ue.wA("auth-internal",v=>{const b=Dn(v.getProvider("auth").getImmediate());return new sl(b)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,V.registerVersion)(ql,"0.23.2",function Wc(k){switch(k){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(k)),(0,V.registerVersion)(ql,"0.23.2","esm2017")}("Browser")},2090:(Ft,Be,z)=>{z.d(Be,{$s:()=>rs,BH:()=>Ge,G6:()=>zs,L:()=>Se,LL:()=>Ze,P0:()=>it,Pz:()=>je,Sg:()=>at,UG:()=>kt,US:()=>ue,ZB:()=>ce,ZR:()=>rt,aH:()=>Ye,b$:()=>yn,eu:()=>Ee,hl:()=>_e,jU:()=>cn,m9:()=>Cs,ne:()=>On,pd:()=>Ti,q4:()=>qe,r3:()=>pi,ru:()=>Tt,tV:()=>ee,uI:()=>Et,vZ:()=>Bt,w1:()=>co,xO:()=>Nn,xb:()=>ir,z$:()=>Je,zI:()=>Te,zd:()=>Hr});const he=function(ne){const Z=[];let $=0;for(let j=0;j<ne.length;j++){let U=ne.charCodeAt(j);U<128?Z[$++]=U:U<2048?(Z[$++]=U>>6|192,Z[$++]=63&U|128):55296==(64512&U)&&j+1<ne.length&&56320==(64512&ne.charCodeAt(j+1))?(U=65536+((1023&U)<<10)+(1023&ne.charCodeAt(++j)),Z[$++]=U>>18|240,Z[$++]=U>>12&63|128,Z[$++]=U>>6&63|128,Z[$++]=63&U|128):(Z[$++]=U>>12|224,Z[$++]=U>>6&63|128,Z[$++]=63&U|128)}return Z},ue={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(ne,Z){if(!Array.isArray(ne))throw Error("encodeByteArray takes an array as a parameter");this.init_();const $=Z?this.byteToCharMapWebSafe_:this.byteToCharMap_,j=[];for(let U=0;U<ne.length;U+=3){const ie=ne[U],ke=U+1<ne.length,ut=ke?ne[U+1]:0,tn=U+2<ne.length,Zt=tn?ne[U+2]:0;let Yn=(15&ut)<<2|Zt>>6,Ln=63&Zt;tn||(Ln=64,ke||(Yn=64)),j.push($[ie>>2],$[(3&ie)<<4|ut>>4],$[Yn],$[Ln])}return j.join("")},encodeString(ne,Z){return this.HAS_NATIVE_SUPPORT&&!Z?btoa(ne):this.encodeByteArray(he(ne),Z)},decodeString(ne,Z){return this.HAS_NATIVE_SUPPORT&&!Z?atob(ne):function(ne){const Z=[];let $=0,j=0;for(;$<ne.length;){const U=ne[$++];if(U<128)Z[j++]=String.fromCharCode(U);else if(U>191&&U<224){const ie=ne[$++];Z[j++]=String.fromCharCode((31&U)<<6|63&ie)}else if(U>239&&U<365){const tn=((7&U)<<18|(63&ne[$++])<<12|(63&ne[$++])<<6|63&ne[$++])-65536;Z[j++]=String.fromCharCode(55296+(tn>>10)),Z[j++]=String.fromCharCode(56320+(1023&tn))}else{const ie=ne[$++],ke=ne[$++];Z[j++]=String.fromCharCode((15&U)<<12|(63&ie)<<6|63&ke)}}return Z.join("")}(this.decodeStringToByteArray(ne,Z))},decodeStringToByteArray(ne,Z){this.init_();const $=Z?this.charToByteMapWebSafe_:this.charToByteMap_,j=[];for(let U=0;U<ne.length;){const ie=$[ne.charAt(U++)],ut=U<ne.length?$[ne.charAt(U)]:0;++U;const Zt=U<ne.length?$[ne.charAt(U)]:64;++U;const Ut=U<ne.length?$[ne.charAt(U)]:64;if(++U,null==ie||null==ut||null==Zt||null==Ut)throw new Oe;j.push(ie<<2|ut>>4),64!==Zt&&(j.push(ut<<4&240|Zt>>2),64!==Ut&&j.push(Zt<<6&192|Ut))}return j},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let ne=0;ne<this.ENCODED_VALS.length;ne++)this.byteToCharMap_[ne]=this.ENCODED_VALS.charAt(ne),this.charToByteMap_[this.byteToCharMap_[ne]]=ne,this.byteToCharMapWebSafe_[ne]=this.ENCODED_VALS_WEBSAFE.charAt(ne),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[ne]]=ne,ne>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(ne)]=ne,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(ne)]=ne)}}};class Oe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Se=function(ne){return function(ne){const Z=he(ne);return ue.encodeByteArray(Z,!0)}(ne).replace(/\./g,"")},ee=function(ne){try{return ue.decodeString(ne,!0)}catch(Z){console.error("base64Decode failed: ",Z)}return null};function ce(ne,Z){if(!(Z instanceof Object))return Z;switch(Z.constructor){case Date:return new Date(Z.getTime());case Object:void 0===ne&&(ne={});break;case Array:ne=[];break;default:return Z}for(const $ in Z)!Z.hasOwnProperty($)||!tt($)||(ne[$]=ce(ne[$],Z[$]));return ne}function tt(ne){return"__proto__"!==ne}const Ke=()=>{try{return function Ue(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const ne=process.env.__FIREBASE_DEFAULTS__;return ne?JSON.parse(ne):void 0})()||(()=>{if(typeof document>"u")return;let ne;try{ne=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const Z=ne&&ee(ne[1]);return Z&&JSON.parse(Z)})()}catch(ne){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${ne}`)}},qe=ne=>{var Z,$;return null===($=null===(Z=Ke())||void 0===Z?void 0:Z.emulatorHosts)||void 0===$?void 0:$[ne]},it=ne=>{const Z=qe(ne);if(!Z)return;const $=Z.lastIndexOf(":");if($<=0||$+1===Z.length)throw new Error(`Invalid host ${Z} with no separate hostname and port!`);const j=parseInt(Z.substring($+1),10);return"["===Z[0]?[Z.substring(1,$-1),j]:[Z.substring(0,$),j]},Ye=()=>{var ne;return null===(ne=Ke())||void 0===ne?void 0:ne.config},je=ne=>{var Z;return null===(Z=Ke())||void 0===Z?void 0:Z[`_${ne}`]};class Ge{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((Z,$)=>{this.resolve=Z,this.reject=$})}wrapCallback(Z){return($,j)=>{$?this.reject($):this.resolve(j),"function"==typeof Z&&(this.promise.catch(()=>{}),1===Z.length?Z($):Z($,j))}}}function at(ne,Z){if(ne.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const j=Z||"demo-project",U=ne.iat||0,ie=ne.sub||ne.user_id;if(!ie)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const ke=Object.assign({iss:`https://securetoken.google.com/${j}`,aud:j,iat:U,exp:U+3600,auth_time:U,sub:ie,user_id:ie,firebase:{sign_in_provider:"custom",identities:{}}},ne);return[Se(JSON.stringify({alg:"none",type:"JWT"})),Se(JSON.stringify(ke)),""].join(".")}function Je(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Et(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Je())}function kt(){var ne;const Z=null===(ne=Ke())||void 0===ne?void 0:ne.forceEnvironment;if("node"===Z)return!0;if("browser"===Z)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function cn(){return"object"==typeof self&&self.self===self}function Tt(){const ne="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof ne&&void 0!==ne.id}function yn(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function co(){const ne=Je();return ne.indexOf("MSIE ")>=0||ne.indexOf("Trident/")>=0}function zs(){return!kt()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _e(){try{return"object"==typeof indexedDB}catch{return!1}}function Ee(){return new Promise((ne,Z)=>{try{let $=!0;const j="validate-browser-context-for-indexeddb-analytics-module",U=self.indexedDB.open(j);U.onsuccess=()=>{U.result.close(),$||self.indexedDB.deleteDatabase(j),ne(!0)},U.onupgradeneeded=()=>{$=!1},U.onerror=()=>{var ie;Z((null===(ie=U.error)||void 0===ie?void 0:ie.message)||"")}}catch($){Z($)}})}function Te(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class rt extends Error{constructor(Z,$,j){super($),this.code=Z,this.customData=j,this.name="FirebaseError",Object.setPrototypeOf(this,rt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ze.prototype.create)}}class Ze{constructor(Z,$,j){this.service=Z,this.serviceName=$,this.errors=j}create(Z,...$){const j=$[0]||{},U=`${this.service}/${Z}`,ie=this.errors[Z],ke=ie?function jt(ne,Z){return ne.replace(At,($,j)=>{const U=Z[j];return null!=U?String(U):`<${j}?>`})}(ie,j):"Error";return new rt(U,`${this.serviceName}: ${ke} (${U}).`,j)}}const At=/\{\$([^}]+)}/g;function pi(ne,Z){return Object.prototype.hasOwnProperty.call(ne,Z)}function ir(ne){for(const Z in ne)if(Object.prototype.hasOwnProperty.call(ne,Z))return!1;return!0}function Bt(ne,Z){if(ne===Z)return!0;const $=Object.keys(ne),j=Object.keys(Z);for(const U of $){if(!j.includes(U))return!1;const ie=ne[U],ke=Z[U];if(Ts(ie)&&Ts(ke)){if(!Bt(ie,ke))return!1}else if(ie!==ke)return!1}for(const U of j)if(!$.includes(U))return!1;return!0}function Ts(ne){return null!==ne&&"object"==typeof ne}function Nn(ne){const Z=[];for(const[$,j]of Object.entries(ne))Array.isArray(j)?j.forEach(U=>{Z.push(encodeURIComponent($)+"="+encodeURIComponent(U))}):Z.push(encodeURIComponent($)+"="+encodeURIComponent(j));return Z.length?"&"+Z.join("&"):""}function Hr(ne){const Z={};return ne.replace(/^\?/,"").split("&").forEach(j=>{if(j){const[U,ie]=j.split("=");Z[decodeURIComponent(U)]=decodeURIComponent(ie)}}),Z}function Ti(ne){const Z=ne.indexOf("?");if(!Z)return"";const $=ne.indexOf("#",Z);return ne.substring(Z,$>0?$:void 0)}function On(ne,Z){const $=new Gt(ne,Z);return $.subscribe.bind($)}class Gt{constructor(Z,$){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=$,this.task.then(()=>{Z(this)}).catch(j=>{this.error(j)})}next(Z){this.forEachObserver($=>{$.next(Z)})}error(Z){this.forEachObserver($=>{$.error(Z)}),this.close(Z)}complete(){this.forEachObserver(Z=>{Z.complete()}),this.close()}subscribe(Z,$,j){let U;if(void 0===Z&&void 0===$&&void 0===j)throw new Error("Missing Observer.");U=function rr(ne,Z){if("object"!=typeof ne||null===ne)return!1;for(const $ of Z)if($ in ne&&"function"==typeof ne[$])return!0;return!1}(Z,["next","error","complete"])?Z:{next:Z,error:$,complete:j},void 0===U.next&&(U.next=ci),void 0===U.error&&(U.error=ci),void 0===U.complete&&(U.complete=ci);const ie=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?U.error(this.finalError):U.complete()}catch{}}),this.observers.push(U),ie}unsubscribeOne(Z){void 0===this.observers||void 0===this.observers[Z]||(delete this.observers[Z],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(Z){if(!this.finalized)for(let $=0;$<this.observers.length;$++)this.sendOne($,Z)}sendOne(Z,$){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[Z])try{$(this.observers[Z])}catch(j){typeof console<"u"&&console.error&&console.error(j)}})}close(Z){this.finalized||(this.finalized=!0,void 0!==Z&&(this.finalError=Z),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ci(){}const Tn=1e3,Pr=2,Ki=144e5,sr=.5;function rs(ne,Z=Tn,$=Pr){const j=Z*Math.pow($,ne),U=Math.round(sr*j*(Math.random()-.5)*2);return Math.min(Ki,j+U)}function Cs(ne){return ne&&ne._delegate?ne._delegate:ne}},6413:(Ft,Be,z)=>{var d=z(4650);let Q=null;function V(){return Q}class ye{}const ue=new d.OlP("DocumentToken");let Oe=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d.Yz7({token:i,factory:function(){return function Me(){return(0,d.LFG)(ee)}()},providedIn:"platform"}),i})();const Se=new d.OlP("Location Initialized");let ee=(()=>{class i extends Oe{constructor(t){super(),this._doc=t,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return V().getBaseHref(this._doc)}onPopState(t){const n=V().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",t,!1),()=>n.removeEventListener("popstate",t)}onHashChange(t){const n=V().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",t,!1),()=>n.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,n,r){J()?this._history.pushState(t,n,r):this._location.hash=r}replaceState(t,n,r){J()?this._history.replaceState(t,n,r):this._location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(ue))},i.\u0275prov=d.Yz7({token:i,factory:function(){return function ce(){return new ee((0,d.LFG)(ue))}()},providedIn:"platform"}),i})();function J(){return!!window.history.pushState}function tt(i,e){if(0==i.length)return e;if(0==e.length)return i;let t=0;return i.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?i+e.substring(1):1==t?i+e:i+"/"+e}function Ue(i){const e=i.match(/#|\?|$/),t=e&&e.index||i.length;return i.slice(0,t-("/"===i[t-1]?1:0))+i.slice(t)}function lt(i){return i&&"?"!==i[0]?"?"+i:i}let xt=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d.Yz7({token:i,factory:function(){return(0,d.f3M)(Ke)},providedIn:"root"}),i})();const Ce=new d.OlP("appBaseHref");let Ke=(()=>{class i extends xt{constructor(t,n){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=n??this._platformLocation.getBaseHrefFromDOM()??(0,d.f3M)(ue).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return tt(this._baseHref,t)}path(t=!1){const n=this._platformLocation.pathname+lt(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${n}${r}`:n}pushState(t,n,r,s){const o=this.prepareExternalUrl(r+lt(s));this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){const o=this.prepareExternalUrl(r+lt(s));this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(Oe),d.LFG(Ce,8))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),qe=(()=>{class i extends xt{constructor(t,n){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=n&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let n=this._platformLocation.hash;return null==n&&(n="#"),n.length>0?n.substring(1):n}prepareExternalUrl(t){const n=tt(this._baseHref,t);return n.length>0?"#"+n:n}pushState(t,n,r,s){let o=this.prepareExternalUrl(r+lt(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){let o=this.prepareExternalUrl(r+lt(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(Oe),d.LFG(Ce,8))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac}),i})(),it=(()=>{class i{constructor(t){this._subject=new d.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const n=this._locationStrategy.getBaseHref();this._basePath=function at(i){if(new RegExp("^(https?:)?//").test(i)){const[,t]=i.split(/\/\/[^\/]+/);return t}return i}(Ue(Ge(n))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,n=""){return this.path()==this.normalize(t+lt(n))}normalize(t){return i.stripTrailingSlash(function je(i,e){if(!i||!e.startsWith(i))return e;const t=e.substring(i.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,Ge(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,n="",r=null){this._locationStrategy.pushState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+lt(n)),r)}replaceState(t,n="",r=null){this._locationStrategy.replaceState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+lt(n)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)})),()=>{const n=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(n,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",n){this._urlChangeListeners.forEach(r=>r(t,n))}subscribe(t,n,r){return this._subject.subscribe({next:t,error:n,complete:r})}}return i.normalizeQueryParams=lt,i.joinWithSlash=tt,i.stripTrailingSlash=Ue,i.\u0275fac=function(t){return new(t||i)(d.LFG(xt))},i.\u0275prov=d.Yz7({token:i,factory:function(){return function Ye(){return new it((0,d.LFG)(xt))}()},providedIn:"root"}),i})();function Ge(i){return i.replace(/\/index.html$/,"")}var cn=(()=>((cn=cn||{})[cn.Format=0]="Format",cn[cn.Standalone=1]="Standalone",cn))(),Tt=(()=>((Tt=Tt||{})[Tt.Narrow=0]="Narrow",Tt[Tt.Abbreviated=1]="Abbreviated",Tt[Tt.Wide=2]="Wide",Tt[Tt.Short=3]="Short",Tt))(),yn=(()=>((yn=yn||{})[yn.Short=0]="Short",yn[yn.Medium=1]="Medium",yn[yn.Long=2]="Long",yn[yn.Full=3]="Full",yn))(),Rt=(()=>((Rt=Rt||{})[Rt.Decimal=0]="Decimal",Rt[Rt.Group=1]="Group",Rt[Rt.List=2]="List",Rt[Rt.PercentSign=3]="PercentSign",Rt[Rt.PlusSign=4]="PlusSign",Rt[Rt.MinusSign=5]="MinusSign",Rt[Rt.Exponential=6]="Exponential",Rt[Rt.SuperscriptingExponent=7]="SuperscriptingExponent",Rt[Rt.PerMille=8]="PerMille",Rt[Rt.Infinity=9]="Infinity",Rt[Rt.NaN=10]="NaN",Rt[Rt.TimeSeparator=11]="TimeSeparator",Rt[Rt.CurrencyDecimal=12]="CurrencyDecimal",Rt[Rt.CurrencyGroup=13]="CurrencyGroup",Rt))();function rt(i,e){return yi((0,d.cg1)(i)[d.wAp.DateFormat],e)}function Ze(i,e){return yi((0,d.cg1)(i)[d.wAp.TimeFormat],e)}function jt(i,e){return yi((0,d.cg1)(i)[d.wAp.DateTimeFormat],e)}function At(i,e){const t=(0,d.cg1)(i),n=t[d.wAp.NumberSymbols][e];if(typeof n>"u"){if(e===Rt.CurrencyDecimal)return t[d.wAp.NumberSymbols][Rt.Decimal];if(e===Rt.CurrencyGroup)return t[d.wAp.NumberSymbols][Rt.Group]}return n}function Ri(i){if(!i[d.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${i[d.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function yi(i,e){for(let t=e;t>-1;t--)if(typeof i[t]<"u")return i[t];throw new Error("Locale data API: locale data undefined")}function Bt(i){const[e,t]=i.split(":");return{hours:+e,minutes:+t}}const Hr=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Ti={},ni=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var On=(()=>((On=On||{})[On.Short=0]="Short",On[On.ShortGMT=1]="ShortGMT",On[On.Long=2]="Long",On[On.Extended=3]="Extended",On))(),Gt=(()=>((Gt=Gt||{})[Gt.FullYear=0]="FullYear",Gt[Gt.Month=1]="Month",Gt[Gt.Date=2]="Date",Gt[Gt.Hours=3]="Hours",Gt[Gt.Minutes=4]="Minutes",Gt[Gt.Seconds=5]="Seconds",Gt[Gt.FractionalSeconds=6]="FractionalSeconds",Gt[Gt.Day=7]="Day",Gt))(),zt=(()=>((zt=zt||{})[zt.DayPeriods=0]="DayPeriods",zt[zt.Days=1]="Days",zt[zt.Months=2]="Months",zt[zt.Eras=3]="Eras",zt))();function rr(i,e,t,n){let r=function U(i){if(ke(i))return i;if("number"==typeof i&&!isNaN(i))return new Date(i);if("string"==typeof i){if(i=i.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(i)){const[r,s=1,o=1]=i.split("-").map(c=>+c);return ci(r,s-1,o)}const t=parseFloat(i);if(!isNaN(i-t))return new Date(t);let n;if(n=i.match(Hr))return function ie(i){const e=new Date(0);let t=0,n=0;const r=i[8]?e.setUTCFullYear:e.setFullYear,s=i[8]?e.setUTCHours:e.setHours;i[9]&&(t=Number(i[9]+i[10]),n=Number(i[9]+i[11])),r.call(e,Number(i[1]),Number(i[2])-1,Number(i[3]));const o=Number(i[4]||0)-t,c=Number(i[5]||0)-n,h=Number(i[6]||0),m=Math.floor(1e3*parseFloat("0."+(i[7]||0)));return s.call(e,o,c,h,m),e}(n)}const e=new Date(i);if(!ke(e))throw new Error(`Unable to convert "${i}" into a date`);return e}(i);e=vi(t,e)||e;let c,o=[];for(;e;){if(c=ni.exec(e),!c){o.push(e);break}{o=o.concat(c.slice(1));const g=o.pop();if(!g)break;e=g}}let h=r.getTimezoneOffset();n&&(h=Z(n,h),r=function j(i,e,t){const n=t?-1:1,r=i.getTimezoneOffset();return function $(i,e){return(i=new Date(i.getTime())).setMinutes(i.getMinutes()+e),i}(i,n*(Z(e,r)-r))}(r,n,!0));let m="";return o.forEach(g=>{const y=function ne(i){if(Cs[i])return Cs[i];let e;switch(i){case"G":case"GG":case"GGG":e=sn(zt.Eras,Tt.Abbreviated);break;case"GGGG":e=sn(zt.Eras,Tt.Wide);break;case"GGGGG":e=sn(zt.Eras,Tt.Narrow);break;case"y":e=Gn(Gt.FullYear,1,0,!1,!0);break;case"yy":e=Gn(Gt.FullYear,2,0,!0,!0);break;case"yyy":e=Gn(Gt.FullYear,3,0,!1,!0);break;case"yyyy":e=Gn(Gt.FullYear,4,0,!1,!0);break;case"Y":e=Is(1);break;case"YY":e=Is(2,!0);break;case"YYY":e=Is(3);break;case"YYYY":e=Is(4);break;case"M":case"L":e=Gn(Gt.Month,1,1);break;case"MM":case"LL":e=Gn(Gt.Month,2,1);break;case"MMM":e=sn(zt.Months,Tt.Abbreviated);break;case"MMMM":e=sn(zt.Months,Tt.Wide);break;case"MMMMM":e=sn(zt.Months,Tt.Narrow);break;case"LLL":e=sn(zt.Months,Tt.Abbreviated,cn.Standalone);break;case"LLLL":e=sn(zt.Months,Tt.Wide,cn.Standalone);break;case"LLLLL":e=sn(zt.Months,Tt.Narrow,cn.Standalone);break;case"w":e=qi(1);break;case"ww":e=qi(2);break;case"W":e=qi(1,!0);break;case"d":e=Gn(Gt.Date,1);break;case"dd":e=Gn(Gt.Date,2);break;case"c":case"cc":e=Gn(Gt.Day,1);break;case"ccc":e=sn(zt.Days,Tt.Abbreviated,cn.Standalone);break;case"cccc":e=sn(zt.Days,Tt.Wide,cn.Standalone);break;case"ccccc":e=sn(zt.Days,Tt.Narrow,cn.Standalone);break;case"cccccc":e=sn(zt.Days,Tt.Short,cn.Standalone);break;case"E":case"EE":case"EEE":e=sn(zt.Days,Tt.Abbreviated);break;case"EEEE":e=sn(zt.Days,Tt.Wide);break;case"EEEEE":e=sn(zt.Days,Tt.Narrow);break;case"EEEEEE":e=sn(zt.Days,Tt.Short);break;case"a":case"aa":case"aaa":e=sn(zt.DayPeriods,Tt.Abbreviated);break;case"aaaa":e=sn(zt.DayPeriods,Tt.Wide);break;case"aaaaa":e=sn(zt.DayPeriods,Tt.Narrow);break;case"b":case"bb":case"bbb":e=sn(zt.DayPeriods,Tt.Abbreviated,cn.Standalone,!0);break;case"bbbb":e=sn(zt.DayPeriods,Tt.Wide,cn.Standalone,!0);break;case"bbbbb":e=sn(zt.DayPeriods,Tt.Narrow,cn.Standalone,!0);break;case"B":case"BB":case"BBB":e=sn(zt.DayPeriods,Tt.Abbreviated,cn.Format,!0);break;case"BBBB":e=sn(zt.DayPeriods,Tt.Wide,cn.Format,!0);break;case"BBBBB":e=sn(zt.DayPeriods,Tt.Narrow,cn.Format,!0);break;case"h":e=Gn(Gt.Hours,1,-12);break;case"hh":e=Gn(Gt.Hours,2,-12);break;case"H":e=Gn(Gt.Hours,1);break;case"HH":e=Gn(Gt.Hours,2);break;case"m":e=Gn(Gt.Minutes,1);break;case"mm":e=Gn(Gt.Minutes,2);break;case"s":e=Gn(Gt.Seconds,1);break;case"ss":e=Gn(Gt.Seconds,2);break;case"S":e=Gn(Gt.FractionalSeconds,1);break;case"SS":e=Gn(Gt.FractionalSeconds,2);break;case"SSS":e=Gn(Gt.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=Tn(On.Short);break;case"ZZZZZ":e=Tn(On.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Tn(On.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=Tn(On.Long);break;default:return null}return Cs[i]=e,e}(g);m+=y?y(r,t,h):"''"===g?"'":g.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),m}function ci(i,e,t){const n=new Date(0);return n.setFullYear(i,e,t),n.setHours(0,0,0),n}function vi(i,e){const t=function ns(i){return(0,d.cg1)(i)[d.wAp.LocaleId]}(i);if(Ti[t]=Ti[t]||{},Ti[t][e])return Ti[t][e];let n="";switch(e){case"shortDate":n=rt(i,yn.Short);break;case"mediumDate":n=rt(i,yn.Medium);break;case"longDate":n=rt(i,yn.Long);break;case"fullDate":n=rt(i,yn.Full);break;case"shortTime":n=Ze(i,yn.Short);break;case"mediumTime":n=Ze(i,yn.Medium);break;case"longTime":n=Ze(i,yn.Long);break;case"fullTime":n=Ze(i,yn.Full);break;case"short":const r=vi(i,"shortTime"),s=vi(i,"shortDate");n=fr(jt(i,yn.Short),[r,s]);break;case"medium":const o=vi(i,"mediumTime"),c=vi(i,"mediumDate");n=fr(jt(i,yn.Medium),[o,c]);break;case"long":const h=vi(i,"longTime"),m=vi(i,"longDate");n=fr(jt(i,yn.Long),[h,m]);break;case"full":const g=vi(i,"fullTime"),y=vi(i,"fullDate");n=fr(jt(i,yn.Full),[g,y])}return n&&(Ti[t][e]=n),n}function fr(i,e){return e&&(i=i.replace(/\{([^}]+)}/g,function(t,n){return null!=e&&n in e?e[n]:t})),i}function Wi(i,e,t="-",n,r){let s="";(i<0||r&&i<=0)&&(r?i=1-i:(i=-i,s=t));let o=String(i);for(;o.length<e;)o="0"+o;return n&&(o=o.slice(o.length-e)),s+o}function Gn(i,e,t=0,n=!1,r=!1){return function(s,o){let c=function ui(i,e){switch(i){case Gt.FullYear:return e.getFullYear();case Gt.Month:return e.getMonth();case Gt.Date:return e.getDate();case Gt.Hours:return e.getHours();case Gt.Minutes:return e.getMinutes();case Gt.Seconds:return e.getSeconds();case Gt.FractionalSeconds:return e.getMilliseconds();case Gt.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${i}".`)}}(i,s);if((t>0||c>-t)&&(c+=t),i===Gt.Hours)0===c&&-12===t&&(c=12);else if(i===Gt.FractionalSeconds)return function ca(i,e){return Wi(i,3).substring(0,e)}(c,e);const h=At(o,Rt.MinusSign);return Wi(c,e,h,n,r)}}function sn(i,e,t=cn.Format,n=!1){return function(r,s){return function uo(i,e,t,n,r,s){switch(t){case zt.Months:return function _e(i,e,t){const n=(0,d.cg1)(i),s=yi([n[d.wAp.MonthsFormat],n[d.wAp.MonthsStandalone]],e);return yi(s,t)}(e,r,n)[i.getMonth()];case zt.Days:return function zs(i,e,t){const n=(0,d.cg1)(i),s=yi([n[d.wAp.DaysFormat],n[d.wAp.DaysStandalone]],e);return yi(s,t)}(e,r,n)[i.getDay()];case zt.DayPeriods:const o=i.getHours(),c=i.getMinutes();if(s){const m=function pi(i){const e=(0,d.cg1)(i);return Ri(e),(e[d.wAp.ExtraData][2]||[]).map(n=>"string"==typeof n?Bt(n):[Bt(n[0]),Bt(n[1])])}(e),g=function Mi(i,e,t){const n=(0,d.cg1)(i);Ri(n);const s=yi([n[d.wAp.ExtraData][0],n[d.wAp.ExtraData][1]],e)||[];return yi(s,t)||[]}(e,r,n),y=m.findIndex(E=>{if(Array.isArray(E)){const[x,S]=E,R=o>=x.hours&&c>=x.minutes,L=o<S.hours||o===S.hours&&c<S.minutes;if(x.hours<S.hours){if(R&&L)return!0}else if(R||L)return!0}else if(E.hours===o&&E.minutes===c)return!0;return!1});if(-1!==y)return g[y]}return function is(i,e,t){const n=(0,d.cg1)(i),s=yi([n[d.wAp.DayPeriodsFormat],n[d.wAp.DayPeriodsStandalone]],e);return yi(s,t)}(e,r,n)[o<12?0:1];case zt.Eras:return function Ee(i,e){return yi((0,d.cg1)(i)[d.wAp.Eras],e)}(e,n)[i.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${t}`)}}(r,s,i,e,t,n)}}function Tn(i){return function(e,t,n){const r=-1*n,s=At(t,Rt.MinusSign),o=r>0?Math.floor(r/60):Math.ceil(r/60);switch(i){case On.Short:return(r>=0?"+":"")+Wi(o,2,s)+Wi(Math.abs(r%60),2,s);case On.ShortGMT:return"GMT"+(r>=0?"+":"")+Wi(o,1,s);case On.Long:return"GMT"+(r>=0?"+":"")+Wi(o,2,s)+":"+Wi(Math.abs(r%60),2,s);case On.Extended:return 0===n?"Z":(r>=0?"+":"")+Wi(o,2,s)+":"+Wi(Math.abs(r%60),2,s);default:throw new Error(`Unknown zone width "${i}"`)}}}const Pr=0,Ki=4;function rs(i){return ci(i.getFullYear(),i.getMonth(),i.getDate()+(Ki-i.getDay()))}function qi(i,e=!1){return function(t,n){let r;if(e){const s=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,o=t.getDate();r=1+Math.floor((o+s)/7)}else{const s=rs(t),o=function sr(i){const e=ci(i,Pr,1).getDay();return ci(i,0,1+(e<=Ki?Ki:Ki+7)-e)}(s.getFullYear()),c=s.getTime()-o.getTime();r=1+Math.round(c/6048e5)}return Wi(r,i,At(n,Rt.MinusSign))}}function Is(i,e=!1){return function(t,n){return Wi(rs(t).getFullYear(),i,At(n,Rt.MinusSign),e)}}const Cs={};function Z(i,e){i=i.replace(/:/g,"");const t=Date.parse("Jan 01, 1970 00:00:00 "+i)/6e4;return isNaN(t)?e:t}function ke(i){return i instanceof Date&&!isNaN(i.valueOf())}class Er{constructor(e,t,n,r){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let ua=(()=>{class i{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,n,r){this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const n=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)n.createEmbeddedView(this._template,new Er(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)n.remove(null===s?void 0:s);else if(null!==s){const c=n.get(s);n.move(c,o),fn(c,r)}});for(let r=0,s=n.length;r<s;r++){const c=n.get(r).context;c.index=r,c.count=s,c.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{fn(n.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,n){return!0}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(d.s_b),d.Y36(d.Rgc),d.Y36(d.ZZ4))},i.\u0275dir=d.lG2({type:i,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),i})();function fn(i,e){i.context.$implicit=e.item}let as=(()=>{class i{constructor(t,n){this._viewContainer=t,this._context=new Jt,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){xl("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){xl("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,n){return!0}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(d.s_b),d.Y36(d.Rgc))},i.\u0275dir=d.lG2({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),i})();class Jt{constructor(){this.$implicit=null,this.ngIf=null}}function xl(i,e){if(e&&!e.createEmbeddedView)throw new Error(`${i} must be a TemplateRef, but received '${(0,d.AaK)(e)}'.`)}function Ss(i,e){return new d.vHH(2100,!1)}class Ds{createSubscription(e,t){return e.subscribe({next:t,error:n=>{throw n}})}dispose(e){e.unsubscribe()}}class xr{createSubscription(e,t){return e.then(t,n=>{throw n})}dispose(e){}}const fc=new xr,Il=new Ds;let cs=(()=>{class i{constructor(t){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,n=>this._updateLatestValue(t,n))}_selectStrategy(t){if((0,d.QGY)(t))return fc;if((0,d.F4k)(t))return Il;throw Ss()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,n){t===this._obj&&(this._latestValue=n,this._ref.markForCheck())}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(d.sBO,16))},i.\u0275pipe=d.Yjl({name:"async",type:i,pure:!1,standalone:!0}),i})();const us=new d.OlP("DATE_PIPE_DEFAULT_TIMEZONE"),qs=new d.OlP("DATE_PIPE_DEFAULT_OPTIONS");let ds=(()=>{class i{constructor(t,n,r){this.locale=t,this.defaultTimezone=n,this.defaultOptions=r}transform(t,n,r,s){if(null==t||""===t||t!=t)return null;try{return rr(t,n??this.defaultOptions?.dateFormat??"mediumDate",s||this.locale,r??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(o){throw Ss()}}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(d.soG,16),d.Y36(us,24),d.Y36(qs,24))},i.\u0275pipe=d.Yjl({name:"date",type:i,pure:!0,standalone:!0}),i})(),Ad=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({}),i})();const gc="browser",Fo="server";function Vf(i){return i===Fo}let vu=(()=>{class i{}return i.\u0275prov=(0,d.Yz7)({token:i,providedIn:"root",factory:()=>new Hf((0,d.LFG)(ue),window)}),i})();class Hf{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function _c(i,e){const t=i.getElementById(e)||i.getElementsByName(e)[0];if(t)return t;if("function"==typeof i.createTreeWalker&&i.body&&(i.body.createShadowRoot||i.body.attachShadow)){const n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT);let r=n.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(n-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=Cl(this.window.history)||Cl(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function Cl(i){return Object.getOwnPropertyDescriptor(i,"scrollRestoration")}class Ic extends ye{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Fl extends Ic{static makeCurrent(){!function he(i){Q||(Q=i)}(new Fl)}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function _a(){return Bl=Bl||document.querySelector("base"),Bl?Bl.getAttribute("href"):null}();return null==t?null:function Yf(i){Vo=Vo||document.createElement("a"),Vo.setAttribute("href",i);const e=Vo.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Bl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function Ga(i,e){e=encodeURIComponent(e);for(const t of i.split(";")){const n=t.indexOf("="),[r,s]=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let Vo,Bl=null;const Wd=new d.OlP("TRANSITION_ID"),tg=[{provide:d.ip1,useFactory:function Au(i,e,t){return()=>{t.get(d.CZH).donePromise.then(()=>{const n=V(),r=e.querySelectorAll(`style[ng-transition="${i}"]`);for(let s=0;s<r.length;s++)n.remove(r[s])})}},deps:[Wd,ue,d.zs3],multi:!0}];let Xf=(()=>{class i{build(){return new XMLHttpRequest}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac}),i})();const Cc=new d.OlP("EventManagerPlugins");let ku=(()=>{class i{constructor(t,n){this._zone=n,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,n,r){return this._findPluginFor(n).addEventListener(t,n,r)}addGlobalEventListener(t,n,r){return this._findPluginFor(n).addGlobalEventListener(t,n,r)}getZone(){return this._zone}_findPluginFor(t){const n=this._eventNameToPlugin.get(t);if(n)return n;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(Cc),d.LFG(d.R0b))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac}),i})();class Za{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const r=V().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,n)}}let Ru=(()=>{class i{constructor(){this.usageCount=new Map}addStyles(t){for(const n of t)1===this.changeUsageCount(n,1)&&this.onStyleAdded(n)}removeStyles(t){for(const n of t)0===this.changeUsageCount(n,-1)&&this.onStyleRemoved(n)}onStyleRemoved(t){}onStyleAdded(t){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(t,n){const r=this.usageCount;let s=r.get(t)??0;return s+=n,s>0?r.set(t,s):r.delete(t),s}ngOnDestroy(){for(const t of this.getAllStyles())this.onStyleRemoved(t);this.usageCount.clear()}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac}),i})(),$o=(()=>{class i extends Ru{constructor(t){super(),this.doc=t,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(t){for(const n of this.hostNodes)this.addStyleToHost(n,t)}onStyleRemoved(t){const n=this.styleRef;n.get(t)?.forEach(s=>s.remove()),n.delete(t)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const n of this.getAllStyles())this.addStyleToHost(t,n)}removeHost(t){this.hostNodes.delete(t)}addStyleToHost(t,n){const r=this.doc.createElement("style");r.textContent=n,t.appendChild(r);const s=this.styleRef.get(n);s?s.push(r):this.styleRef.set(n,[r])}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(ue))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac}),i})();const ya={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},_o=/%COMP%/g,Xa=new d.OlP("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function Mu(i,e){return e.flat(100).map(t=>t.replace(_o,i))}function Ou(i){return e=>{if("__ngUnwrap__"===e)return i;!1===i(e)&&(e.preventDefault(),e.returnValue=!1)}}let fs=(()=>{class i{constructor(t,n,r,s){this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.removeStylesOnCompDestory=s,this.rendererByCompId=new Map,this.defaultRenderer=new Kd(t)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;const r=this.getOrCreateRenderer(t,n);return r instanceof Pu?r.applyToHost(t):r instanceof jo&&r.applyStyles(),r}getOrCreateRenderer(t,n){const r=this.rendererByCompId;let s=r.get(n.id);if(!s){const o=this.eventManager,c=this.sharedStylesHost,h=this.removeStylesOnCompDestory;switch(n.encapsulation){case d.ifc.Emulated:s=new Pu(o,c,n,this.appId,h);break;case d.ifc.ShadowDom:return new Ho(o,c,t,n);default:s=new jo(o,c,n,h)}s.onDestroy=()=>r.delete(n.id),r.set(n.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(ku),d.LFG($o),d.LFG(d.AFp),d.LFG(Xa))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac}),i})();class Kd{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(ya[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(em(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(em(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;const s=ya[r];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const r=ya[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(d.JOm.DashCase|d.JOm.Important)?e.style.setProperty(t,n,r&d.JOm.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&d.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,Ou(n)):this.eventManager.addEventListener(e,t,Ou(n))}}function em(i){return"TEMPLATE"===i.tagName&&void 0!==i.content}class Ho extends Kd{constructor(e,t,n,r){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=Mu(r.id,r.styles);for(const o of s){const c=document.createElement("style");c.textContent=o,this.shadowRoot.appendChild(c)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class jo extends Kd{constructor(e,t,n,r,s=n.id){super(e),this.sharedStylesHost=t,this.removeStylesOnCompDestory=r,this.rendererUsageCount=0,this.styles=Mu(s,n.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class Pu extends jo{constructor(e,t,n,r,s){const o=r+"-"+n.id;super(e,t,n,s,o),this.contentAttr=function My(i){return"_ngcontent-%COMP%".replace(_o,i)}(o),this.hostAttr=function Jf(i){return"_nghost-%COMP%".replace(_o,i)}(o)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}let Lu=(()=>{class i extends Za{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,r){return t.addEventListener(n,r,!1),()=>this.removeEventListener(t,n,r)}removeEventListener(t,n,r){return t.removeEventListener(n,r)}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(ue))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac}),i})();const Ac=["alt","control","meta","shift"],Zd={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Nu={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey};let Xd=(()=>{class i extends Za{constructor(t){super(t)}supports(t){return null!=i.parseEventName(t)}addEventListener(t,n,r){const s=i.parseEventName(n),o=i.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>V().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const n=t.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const s=i._normalizeKey(n.pop());let o="",c=n.indexOf("code");if(c>-1&&(n.splice(c,1),o="code."),Ac.forEach(m=>{const g=n.indexOf(m);g>-1&&(n.splice(g,1),o+=m+".")}),o+=s,0!=n.length||0===s.length)return null;const h={};return h.domEventName=r,h.fullKey=o,h}static matchEventFullKeyCode(t,n){let r=Zd[t.key]||t.key,s="";return n.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),Ac.forEach(o=>{o!==r&&(0,Nu[o])(t)&&(s+=o+".")}),s+=r,s===n)}static eventCallback(t,n,r){return s=>{i.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>n(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(ue))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac}),i})();const Jd=(0,d.eFA)(d._c5,"browser",[{provide:d.Lbi,useValue:gc},{provide:d.g9A,useValue:function ba(){Fl.makeCurrent()},multi:!0},{provide:ue,useFactory:function Bu(){return(0,d.RDi)(document),document},deps:[]}]),eh=new d.OlP(""),Ja=[{provide:d.rWj,useClass:class Zf{addToWindow(e){d.dqk.getAngularTestability=(n,r=!0)=>{const s=e.findTestabilityInTree(n,r);if(null==s)throw new Error("Could not find testability for element.");return s},d.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),d.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),d.dqk.frameworkStabilizers||(d.dqk.frameworkStabilizers=[]),d.dqk.frameworkStabilizers.push(n=>{const r=d.dqk.getAllAngularTestabilities();let s=r.length,o=!1;const c=function(h){o=o||h,s--,0==s&&n(o)};r.forEach(function(h){h.whenStable(c)})})}findTestabilityInTree(e,t,n){return null==t?null:e.getTestability(t)??(n?V().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:d.lri,useClass:d.dDg,deps:[d.R0b,d.eoX,d.rWj]},{provide:d.dDg,useClass:d.dDg,deps:[d.R0b,d.eoX,d.rWj]}],wa=[{provide:d.zSh,useValue:"root"},{provide:d.qLn,useFactory:function Qd(){return new d.qLn},deps:[]},{provide:Cc,useClass:Lu,multi:!0,deps:[ue,d.R0b,d.Lbi]},{provide:Cc,useClass:Xd,multi:!0,deps:[ue]},{provide:fs,useClass:fs,deps:[ku,$o,d.AFp,Xa]},{provide:d.FYo,useExisting:fs},{provide:Ru,useExisting:$o},{provide:$o,useClass:$o,deps:[ue]},{provide:ku,useClass:ku,deps:[Cc,d.R0b]},{provide:class Gf{},useClass:Xf,deps:[]},[]];let bo=(()=>{class i{constructor(t){}static withServerTransition(t){return{ngModule:i,providers:[{provide:d.AFp,useValue:t.appId},{provide:Wd,useExisting:d.AFp},tg]}}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(eh,12))},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({providers:[...wa,...Ja],imports:[Ad,d.hGG]}),i})(),kc=(()=>{class i{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(ue))},i.\u0275prov=d.Yz7({token:i,factory:function(t){let n=null;return n=t?new t:function el(){return new kc((0,d.LFG)(ue))}(),n},providedIn:"root"}),i})();typeof window<"u"&&window;var zn=z(8996),Fr=z(3269);function St(...i){const e=(0,Fr.yG)(i);return(0,zn.D)(i,e)}var pn=z(7579);class ps extends pn.x{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}const zr=(0,z(3888).d)(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"});var Zi=z(9751);const{isArray:ah}=Array,{getPrototypeOf:Lc,prototype:Nc,keys:xa}=Object;function Br(i){if(1===i.length){const e=i[0];if(ah(e))return{args:e,keys:null};if(function Ta(i){return i&&"object"==typeof i&&Lc(i)===Nc}(e)){const t=xa(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:i,keys:null}}var jl=z(4671),wt=z(4004);const{isArray:lm}=Array;function Wr(i){return(0,wt.U)(e=>function cm(i,e){return lm(e)?i(...e):i(e)}(i,e))}function Ia(i,e){return i.reduce((t,n,r)=>(t[n]=e[r],t),{})}var Ci=z(5403),sg=z(9672);function lh(...i){const e=(0,Fr.yG)(i),t=(0,Fr.jO)(i),{args:n,keys:r}=Br(i);if(0===n.length)return(0,zn.D)([],e);const s=new Zi.y(function tl(i,e,t=jl.y){return n=>{Gl(e,()=>{const{length:r}=i,s=new Array(r);let o=r,c=r;for(let h=0;h<r;h++)Gl(e,()=>{const m=(0,zn.D)(i[h],e);let g=!1;m.subscribe((0,Ci.x)(n,y=>{s[h]=y,g||(g=!0,c--),c||n.next(t(s.slice()))},()=>{--o||n.complete()}))},n)},n)}}(n,e,r?o=>Ia(r,o):jl.y));return t?s.pipe(Wr(t)):s}function Gl(i,e,t){i?(0,sg.f)(t,i,e):e()}var Fc=z(8189);function Bc(...i){return function og(){return(0,Fc.J)(1)}()((0,zn.D)(i,(0,Fr.yG)(i)))}var Xs=z(8421);function Uc(i){return new Zi.y(e=>{(0,Xs.Xf)(i()).subscribe(e)})}var zl=z(9635),Qs=z(576);function nl(i,e){const t=(0,Qs.m)(i)?i:()=>i,n=r=>r.error(t());return new Zi.y(e?r=>e.schedule(n,0,r):n)}var Kr=z(515),wo=z(727),Pi=z(4482);function Vc(){return(0,Pi.e)((i,e)=>{let t=null;i._refCount++;const n=(0,Ci.x)(e,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount)return void(t=null);const r=i._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});i.subscribe(n),n.closed||(t=i.connect())})}class ch extends Zi.y{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,(0,Pi.A)(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new wo.w0;const t=this.getSubject();e.add(this.source.subscribe((0,Ci.x)(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=wo.w0.EMPTY)}return e}refCount(){return Vc()(this)}}function Si(i,e){return(0,Pi.e)((t,n)=>{let r=null,s=0,o=!1;const c=()=>o&&!r&&n.complete();t.subscribe((0,Ci.x)(n,h=>{r?.unsubscribe();let m=0;const g=s++;(0,Xs.Xf)(i(h,g)).subscribe(r=(0,Ci.x)(n,y=>n.next(e?e(h,y,g,m++):y),()=>{r=null,c()}))},()=>{o=!0,c()}))})}function qr(i){return i<=0?()=>Kr.E:(0,Pi.e)((e,t)=>{let n=0;e.subscribe((0,Ci.x)(t,r=>{++n<=i&&(t.next(r),i<=n&&t.complete())}))})}function Ms(...i){const e=(0,Fr.yG)(i);return(0,Pi.e)((t,n)=>{(e?Bc(i,t,e):Bc(i,t)).subscribe(n)})}function ti(i,e){return(0,Pi.e)((t,n)=>{let r=0;t.subscribe((0,Ci.x)(n,s=>i.call(e,s,r++)&&n.next(s)))})}var Xi=z(5577);function Wl(i){return(0,Pi.e)((e,t)=>{let n=!1;e.subscribe((0,Ci.x)(t,r=>{n=!0,t.next(r)},()=>{n||t.next(i),t.complete()}))})}function $u(i=Ca){return(0,Pi.e)((e,t)=>{let n=!1;e.subscribe((0,Ci.x)(t,r=>{n=!0,t.next(r)},()=>n?t.complete():t.error(i())))})}function Ca(){return new zr}function Os(i,e){const t=arguments.length>=2;return n=>n.pipe(i?ti((r,s)=>i(r,s,n)):jl.y,qr(1),t?Wl(e):$u(()=>new zr))}function Eo(i,e){return(0,Qs.m)(e)?(0,Xi.z)(i,e,1):(0,Xi.z)(i,1)}var gi=z(8505);function Ps(i){return(0,Pi.e)((e,t)=>{let s,n=null,r=!1;n=e.subscribe((0,Ci.x)(t,void 0,void 0,o=>{s=(0,Xs.Xf)(i(o,Ps(i)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):r=!0})),r&&(n.unsubscribe(),n=null,s.subscribe(t))})}function $c(i,e){return(0,Pi.e)(function ag(i,e,t,n,r){return(s,o)=>{let c=t,h=e,m=0;s.subscribe((0,Ci.x)(o,g=>{const y=m++;h=c?i(h,g,y):(c=!0,g),n&&o.next(h)},r&&(()=>{c&&o.next(h),o.complete()})))}}(i,e,arguments.length>=2,!0))}function Hc(i){return i<=0?()=>Kr.E:(0,Pi.e)((e,t)=>{let n=[];e.subscribe((0,Ci.x)(t,r=>{n.push(r),i<n.length&&n.shift()},()=>{for(const r of n)t.next(r);t.complete()},void 0,()=>{n=null}))})}function jc(i,e){const t=arguments.length>=2;return n=>n.pipe(i?ti((r,s)=>i(r,s,n)):jl.y,Hc(1),t?Wl(e):$u(()=>new zr))}function xo(i){return(0,wt.U)(()=>i)}function il(i){return(0,Pi.e)((e,t)=>{try{e.subscribe(t)}finally{t.add(i)}})}const Xt="primary",rl=Symbol("RouteTitle");class Sa{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function To(i){return new Sa(i)}function Go(i,e,t){const n=t.path.split("/");if(n.length>i.length||"full"===t.pathMatch&&(e.hasChildren()||n.length<i.length))return null;const r={};for(let s=0;s<n.length;s++){const o=n[s],c=i[s];if(o.startsWith(":"))r[o.substring(1)]=c;else if(o!==c.path)return null}return{consumed:i.slice(0,n.length),posParams:r}}function Io(i,e){const t=i?Object.keys(i):void 0,n=e?Object.keys(e):void 0;if(!t||!n||t.length!=n.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!Hu(i[r],e[r]))return!1;return!0}function Hu(i,e){if(Array.isArray(i)&&Array.isArray(e)){if(i.length!==e.length)return!1;const t=[...i].sort(),n=[...e].sort();return t.every((r,s)=>n[s]===r)}return i===e}function hh(i){return Array.prototype.concat.apply([],i)}function ju(i){return i.length>0?i[i.length-1]:null}function D(i,e){for(const t in i)i.hasOwnProperty(t)&&e(i[t],t)}function A(i){return(0,d.CqO)(i)?i:(0,d.QGY)(i)?(0,zn.D)(Promise.resolve(i)):St(i)}const O=!1,H={exact:function Ne(i,e,t){if(!bi(i.segments,e.segments)||!Lt(i.segments,e.segments,t)||i.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children)if(!i.children[n]||!Ne(i.children[n],e.children[n],t))return!1;return!0},subset:ft},X={exact:function ve(i,e){return Io(i,e)},subset:function et(i,e){return Object.keys(e).length<=Object.keys(i).length&&Object.keys(e).every(t=>Hu(i[t],e[t]))},ignored:()=>!0};function le(i,e,t){return H[t.paths](i.root,e.root,t.matrixParams)&&X[t.queryParams](i.queryParams,e.queryParams)&&!("exact"===t.fragment&&i.fragment!==e.fragment)}function ft(i,e,t){return Dt(i,e,e.segments,t)}function Dt(i,e,t,n){if(i.segments.length>t.length){const r=i.segments.slice(0,t.length);return!(!bi(r,t)||e.hasChildren()||!Lt(r,t,n))}if(i.segments.length===t.length){if(!bi(i.segments,t)||!Lt(i.segments,t,n))return!1;for(const r in e.children)if(!i.children[r]||!ft(i.children[r],e.children[r],n))return!1;return!0}{const r=t.slice(0,i.segments.length),s=t.slice(i.segments.length);return!!(bi(i.segments,r)&&Lt(i.segments,r,n)&&i.children[Xt])&&Dt(i.children[Xt],e,s,n)}}function Lt(i,e,t){return e.every((n,r)=>X[t](i[r].parameters,n.parameters))}class un{constructor(e=new Nt([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=To(this.queryParams)),this._queryParamMap}toString(){return Ls.serialize(this)}}class Nt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,D(t,(n,r)=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Gc(this)}}class Zn{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=To(this.parameters)),this._parameterMap}toString(){return cg(this)}}function bi(i,e){return i.length===e.length&&i.every((t,n)=>t.path===e[n].path)}let Li=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d.Yz7({token:i,factory:function(){return new Co},providedIn:"root"}),i})();class Co{parse(e){const t=new P(e);return new un(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${zc(e.root,!0)}`,n=function ug(i){const e=Object.keys(i).map(t=>{const n=i[t];return Array.isArray(n)?n.map(r=>`${ql(t)}=${ql(r)}`).join("&"):`${ql(t)}=${ql(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${n}${"string"==typeof e.fragment?`#${function um(i){return encodeURI(i)}(e.fragment)}`:""}`}}const Ls=new Co;function Gc(i){return i.segments.map(e=>cg(e)).join("/")}function zc(i,e){if(!i.hasChildren())return Gc(i);if(e){const t=i.children[Xt]?zc(i.children[Xt],!1):"",n=[];return D(i.children,(r,s)=>{s!==Xt&&n.push(`${s}:${zc(r,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function on(i,e){let t=[];return D(i.children,(n,r)=>{r===Xt&&(t=t.concat(e(n,r)))}),D(i.children,(n,r)=>{r!==Xt&&(t=t.concat(e(n,r)))}),t}(i,(n,r)=>r===Xt?[zc(i.children[Xt],!1)]:[`${r}:${zc(n,!1)}`]);return 1===Object.keys(i.children).length&&null!=i.children[Xt]?`${Gc(i)}/${t[0]}`:`${Gc(i)}/(${t.join("//")})`}}function Kl(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ql(i){return Kl(i).replace(/%3B/gi,";")}function sl(i){return Kl(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Wc(i){return decodeURIComponent(i)}function dm(i){return Wc(i.replace(/\+/g,"%20"))}function cg(i){return`${sl(i.path)}${function hm(i){return Object.keys(i).map(e=>`;${sl(e)}=${sl(i[e])}`).join("")}(i.parameters)}`}const Oy=/^[^\/()?;=#]+/;function fh(i){const e=i.match(Oy);return e?e[0]:""}const k=/^[^=?&#]+/,b=/^[^&#]+/;class P{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Nt([],{}):new Nt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[Xt]=new Nt(e,t)),n}parseSegment(){const e=fh(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new d.vHH(4009,O);return this.capture(e),new Zn(Wc(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=fh(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const r=fh(this.remaining);r&&(n=r,this.capture(n))}e[Wc(t)]=Wc(n)}parseQueryParam(e){const t=function v(i){const e=i.match(k);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const o=function T(i){const e=i.match(b);return e?e[0]:""}(this.remaining);o&&(n=o,this.capture(n))}const r=dm(t),s=dm(n);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=fh(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new d.vHH(4010,O);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Xt);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[Xt]:new Nt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new d.vHH(4011,O)}}function F(i){return i.segments.length>0?new Nt([],{[Xt]:i}):i}function q(i){const e={};for(const n of Object.keys(i.children)){const s=q(i.children[n]);(s.segments.length>0||s.hasChildren())&&(e[n]=s)}return function re(i){if(1===i.numberOfChildren&&i.children[Xt]){const e=i.children[Xt];return new Nt(i.segments.concat(e.segments),e.children)}return i}(new Nt(i.segments,e))}function me(i){return i instanceof un}const Fe=!1;function Fn(i,e,t,n,r){if(0===t.length)return dr(e.root,e.root,e.root,n,r);const s=function Gu(i){if("string"==typeof i[0]&&1===i.length&&"/"===i[0])return new mh(!0,0,i);let e=0,t=!1;const n=i.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const c={};return D(s.outlets,(h,m)=>{c[m]="string"==typeof h?h.split("/"):h}),[...r,{outlets:c}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((c,h)=>{0==h&&"."===c||(0==h&&""===c?t=!0:".."===c?e++:""!=c&&r.push(c))}),r):[...r,s]},[]);return new mh(t,e,n)}(t);return s.toRoot()?dr(e.root,e.root,new Nt([],{}),n,r):function o(h){const m=function gh(i,e,t,n){if(i.isAbsolute)return new ol(e.root,!0,0);if(-1===n)return new ol(t,t===e.root,0);return function Kc(i,e,t){let n=i,r=e,s=t;for(;s>r;){if(s-=r,n=n.parent,!n)throw new d.vHH(4005,Fe&&"Invalid number of '../'");r=n.segments.length}return new ol(n,!1,r-s)}(t,n+(ur(i.commands[0])?0:1),i.numberOfDoubleDots)}(s,e,i.snapshot?._urlSegment,h),g=m.processChildren?al(m.segmentGroup,m.index,s.commands):qc(m.segmentGroup,m.index,s.commands);return dr(e.root,m.segmentGroup,g,n,r)}(i.snapshot?._lastPathIndex)}function ur(i){return"object"==typeof i&&null!=i&&!i.outlets&&!i.segmentPath}function Ns(i){return"object"==typeof i&&null!=i&&i.outlets}function dr(i,e,t,n,r){let o,s={};n&&D(n,(h,m)=>{s[m]=Array.isArray(h)?h.map(g=>`${g}`):`${h}`}),o=i===e?t:Yl(i,e,t);const c=F(q(o));return new un(c,s,r)}function Yl(i,e,t){const n={};return D(i.children,(r,s)=>{n[s]=r===e?t:Yl(r,e,t)}),new Nt(i.segments,n)}class mh{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&ur(n[0]))throw new d.vHH(4003,Fe&&"Root segment cannot have matrix parameters");const r=n.find(Ns);if(r&&r!==ju(n))throw new d.vHH(4004,Fe&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ol{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function qc(i,e,t){if(i||(i=new Nt([],{})),0===i.segments.length&&i.hasChildren())return al(i,e,t);const n=function Py(i,e,t){let n=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<i.segments.length;){if(n>=t.length)return s;const o=i.segments[r],c=t[n];if(Ns(c))break;const h=`${c}`,m=n<t.length-1?t[n+1]:null;if(r>0&&void 0===h)break;if(h&&m&&"object"==typeof m&&void 0===m.outlets){if(!Ly(h,m,o))return s;n+=2}else{if(!Ly(h,{},o))return s;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}(i,e,t),r=t.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){const s=new Nt(i.segments.slice(0,n.pathIndex),{});return s.children[Xt]=new Nt(i.segments.slice(n.pathIndex),i.children),al(s,0,r)}return n.match&&0===r.length?new Nt(i.segments,{}):n.match&&!i.hasChildren()?fm(i,e,t):n.match?al(i,0,r):fm(i,e,t)}function al(i,e,t){if(0===t.length)return new Nt(i.segments,{});{const n=function _h(i){return Ns(i[0])?i[0].outlets:{[Xt]:i}}(t),r={};if(!n[Xt]&&i.children[Xt]&&1===i.numberOfChildren&&0===i.children[Xt].segments.length){const s=al(i.children[Xt],e,t);return new Nt(i.segments,s.children)}return D(n,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=qc(i.children[o],e,s))}),D(i.children,(s,o)=>{void 0===n[o]&&(r[o]=s)}),new Nt(i.segments,r)}}function fm(i,e,t){const n=i.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(Ns(s)){const h=mm(s.outlets);return new Nt(n,h)}if(0===r&&ur(t[0])){n.push(new Zn(i.segments[e].path,lE(t[0]))),r++;continue}const o=Ns(s)?s.outlets[Xt]:`${s}`,c=r<t.length-1?t[r+1]:null;o&&c&&ur(c)?(n.push(new Zn(o,lE(c))),r+=2):(n.push(new Zn(o,{})),r++)}return new Nt(n,{})}function mm(i){const e={};return D(i,(t,n)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[n]=fm(new Nt([],{}),0,t))}),e}function lE(i){const e={};return D(i,(t,n)=>e[n]=`${t}`),e}function Ly(i,e,t){return i==t.path&&Io(e,t.parameters)}const pm="imperative";class ll{constructor(e,t){this.id=e,this.url=t}}class Ny extends ll{constructor(e,t,n="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Yc extends ll{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class gm extends ll{constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class zu extends ll{constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r,this.type=16}}class _m extends ll{constructor(e,t,n,r){super(e,t),this.error=n,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class yh extends ll{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class gD extends ll{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class _D extends ll{constructor(e,t,n,r,s){super(e,t),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class vP extends ll{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class yD extends ll{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Fy{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class vD{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class cE{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class dg{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class By{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class uE{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Uy{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let bD=(()=>{class i{createUrlTree(t,n,r,s,o,c){return Fn(t||n.root,r,s,o,c)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac}),i})(),ED=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d.Yz7({token:i,factory:function(e){return bD.\u0275fac(e)},providedIn:"root"}),i})();class hE{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Vy(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){const t=Vy(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=Da(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return Da(e,this._root).map(t=>t.value)}}function Vy(i,e){if(i===e.value)return e;for(const t of e.children){const n=Vy(i,t);if(n)return n}return null}function Da(i,e){if(i===e.value)return[e];for(const t of e.children){const n=Da(i,t);if(n.length)return n.unshift(e),n}return[]}class Js{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function vh(i){const e={};return i&&i.children.forEach(t=>e[t.value.outlet]=t),e}class fE extends hE{constructor(e,t){super(e),this.snapshot=t,$y(this,e)}toString(){return this.snapshot.toString()}}function mE(i,e){const t=function xD(i,e){const o=new hg([],{},{},"",{},Xt,e,null,i.root,-1,{});return new _E("",new Js(o,[]))}(i,e),n=new ps([new Zn("",{})]),r=new ps({}),s=new ps({}),o=new ps({}),c=new ps(""),h=new Ku(n,r,o,c,s,Xt,e,t.root);return h.snapshot=t.root,new fE(new Js(h,[]),t)}class Ku{constructor(e,t,n,r,s,o,c,h){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=c,this.title=this.data?.pipe((0,wt.U)(m=>m[rl]))??St(void 0),this._futureSnapshot=h}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,wt.U)(e=>To(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,wt.U)(e=>To(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function pE(i,e="emptyOnly"){const t=i.pathFromRoot;let n=0;if("always"!==e)for(n=t.length-1;n>=1;){const r=t[n],s=t[n-1];if(r.routeConfig&&""===r.routeConfig.path)n--;else{if(s.component)break;n--}}return function gE(i){return i.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(n))}class hg{get title(){return this.data?.[rl]}constructor(e,t,n,r,s,o,c,h,m,g,y){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=c,this.routeConfig=h,this._urlSegment=m,this._lastPathIndex=g,this._resolve=y}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=To(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=To(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class _E extends hE{constructor(e,t){super(t),this.url=e,$y(this,t)}toString(){return yE(this._root)}}function $y(i,e){e.value._routerState=i,e.children.forEach(t=>$y(i,t))}function yE(i){const e=i.children.length>0?` { ${i.children.map(yE).join(", ")} } `:"";return`${i.value}${e}`}function bh(i){if(i.snapshot){const e=i.snapshot,t=i._futureSnapshot;i.snapshot=t,Io(e.queryParams,t.queryParams)||i.queryParams.next(t.queryParams),e.fragment!==t.fragment&&i.fragment.next(t.fragment),Io(e.params,t.params)||i.params.next(t.params),function dh(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;++t)if(!Io(i[t],e[t]))return!1;return!0}(e.url,t.url)||i.url.next(t.url),Io(e.data,t.data)||i.data.next(t.data)}else i.snapshot=i._futureSnapshot,i.data.next(i._futureSnapshot.data)}function Aa(i,e){const t=Io(i.params,e.params)&&function Cr(i,e){return bi(i,e)&&i.every((t,n)=>Io(t.parameters,e[n].parameters))}(i.url,e.url);return t&&!(!i.parent!=!e.parent)&&(!i.parent||Aa(i.parent,e.parent))}function wh(i,e,t){if(t&&i.shouldReuseRoute(e.value,t.value.snapshot)){const n=t.value;n._futureSnapshot=e.value;const r=function vE(i,e,t){return e.children.map(n=>{for(const r of t.children)if(i.shouldReuseRoute(n.value,r.value.snapshot))return wh(i,n,r);return wh(i,n)})}(i,e,t);return new Js(n,r)}{if(i.shouldAttach(e.value)){const s=i.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(c=>wh(i,c)),o}}const n=function bE(i){return new Ku(new ps(i.url),new ps(i.params),new ps(i.queryParams),new ps(i.fragment),new ps(i.data),i.outlet,i.component,i)}(e.value),r=e.children.map(s=>wh(i,s));return new Js(n,r)}}const wE="ngNavigationCancelingError";function TD(i,e){const{redirectTo:t,navigationBehaviorOptions:n}=me(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=ID(!1,0,e);return r.url=t,r.navigationBehaviorOptions=n,r}function ID(i,e,t){const n=new Error("NavigationCancelingError: "+(i||""));return n[wE]=!0,n.cancellationCode=e,t&&(n.url=t),n}function fg(i){return mg(i)&&me(i.url)}function mg(i){return i&&i[wE]}class bP{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new pg,this.attachRef=null}}let pg=(()=>{class i{constructor(){this.contexts=new Map}onChildOutletCreated(t,n){const r=this.getOrCreateContext(t);r.outlet=n,this.contexts.set(t,r)}onChildOutletDestroyed(t){const n=this.getContext(t);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let n=this.getContext(t);return n||(n=new bP,this.contexts.set(t,n)),n}getContext(t){return this.contexts.get(t)||null}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const vm=!1;let gg=(()=>{class i{constructor(){this.activated=null,this._activatedRoute=null,this.name=Xt,this.activateEvents=new d.vpe,this.deactivateEvents=new d.vpe,this.attachEvents=new d.vpe,this.detachEvents=new d.vpe,this.parentContexts=(0,d.f3M)(pg),this.location=(0,d.f3M)(d.s_b),this.changeDetector=(0,d.f3M)(d.sBO),this.environmentInjector=(0,d.f3M)(d.lqb)}ngOnChanges(t){if(t.name){const{firstChange:n,previousValue:r}=t.name;if(n)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new d.vHH(4012,vm);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new d.vHH(4012,vm);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new d.vHH(4012,vm);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,n){this.activated=t,this._activatedRoute=n,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,n){if(this.isActivated)throw new d.vHH(4013,vm);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,h=new CD(t,c,r.injector);if(n&&function SD(i){return!!i.resolveComponentFactory}(n)){const m=n.resolveComponentFactory(o);this.activated=r.createComponent(m,r.length,h)}else this.activated=r.createComponent(o,{index:r.length,injector:h,environmentInjector:n??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=d.lG2({type:i,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[d.TTD]}),i})();class CD{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===Ku?this.route:e===pg?this.childContexts:this.parent.get(e,t)}}let Hy=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=d.Xpm({type:i,selectors:[["ng-component"]],standalone:!0,features:[d.jDz],decls:1,vars:0,template:function(t,n){1&t&&d._UZ(0,"router-outlet")},dependencies:[gg],encapsulation:2}),i})();function jy(i,e){return i.providers&&!i._injector&&(i._injector=(0,d.MMx)(i.providers,e,`Route: ${i.path}`)),i._injector??e}function _g(i){const e=i.children&&i.children.map(_g),t=e?{...i,children:e}:{...i};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Xt&&(t.component=Hy),t}function zo(i){return i.outlet||Xt}function xE(i,e){const t=i.filter(n=>zo(n)===e);return t.push(...i.filter(n=>zo(n)!==e)),t}function bm(i){if(!i)return null;if(i.routeConfig?._injector)return i.routeConfig._injector;for(let e=i.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class TE{constructor(e,t,n,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),bh(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const r=vh(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],n),delete r[o]}),D(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=n.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=vh(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(n&&n.outlet){const o=n.outlet.detach(),c=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:c})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=vh(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(e,t,n){const r=vh(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],n),this.forwardEvent(new uE(s.value.snapshot))}),e.children.length&&this.forwardEvent(new dg(e.value.snapshot))}activateRoutes(e,t,n){const r=e.value,s=t?t.value:null;if(bh(r),r===s)if(r.component){const o=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(r.component){const o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const c=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(c.contexts),o.attachRef=c.componentRef,o.route=c.route.value,o.outlet&&o.outlet.attach(c.componentRef,c.route.value),bh(c.route.value),this.activateChildRoutes(e,null,o.children)}else{const c=bm(r.snapshot),h=c?.get(d._Vd)??null;o.attachRef=null,o.route=r,o.resolver=h,o.injector=c,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}class MD{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Wy{constructor(e,t){this.component=e,this.route=t}}function wm(i,e,t){const n=i._root;return Eh(n,e?e._root:null,t,[n.value])}function qu(i,e){const t=Symbol(),n=e.get(i,t);return n===t?"function"!=typeof i||(0,d.Z0I)(i)?e.get(i):i:n}function Eh(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=vh(e);return i.children.forEach(o=>{(function IE(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=i.value,o=e?e.value:null,c=t?t.getContext(i.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const h=function EP(i,e,t){if("function"==typeof t)return t(i,e);switch(t){case"pathParamsChange":return!bi(i.url,e.url);case"pathParamsOrQueryParamsChange":return!bi(i.url,e.url)||!Io(i.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Aa(i,e)||!Io(i.queryParams,e.queryParams);default:return!Aa(i,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);h?r.canActivateChecks.push(new MD(n)):(s.data=o.data,s._resolvedData=o._resolvedData),Eh(i,e,s.component?c?c.children:null:t,n,r),h&&c&&c.outlet&&c.outlet.isActivated&&r.canDeactivateChecks.push(new Wy(c.outlet.component,o))}else o&&Em(e,c,r),r.canActivateChecks.push(new MD(n)),Eh(i,null,s.component?c?c.children:null:t,n,r)})(o,s[o.value.outlet],t,n.concat([o.value]),r),delete s[o.value.outlet]}),D(s,(o,c)=>Em(o,t.getContext(c),r)),r}function Em(i,e,t){const n=vh(i),r=i.value;D(n,(s,o)=>{Em(s,r.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new Wy(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function xh(i){return"function"==typeof i}function Zl(i){return i instanceof zr||"EmptyError"===i?.name}const yg=Symbol("INITIAL_VALUE");function Zc(){return Si(i=>lh(i.map(e=>e.pipe(qr(1),Ms(yg)))).pipe((0,wt.U)(e=>{for(const t of e)if(!0!==t){if(t===yg)return yg;if(!1===t||t instanceof un)return t}return!0}),ti(e=>e!==yg),qr(1)))}function Jy(i){return(0,zl.z)((0,gi.b)(e=>{if(me(e))throw TD(0,e)}),(0,wt.U)(e=>!0===e))}const ev={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function AE(i,e,t,n,r){const s=tv(i,e,t);return s.matched?function Th(i,e,t,n){const r=e.canMatch;return r&&0!==r.length?St(r.map(o=>{const c=qu(o,i);return A(function Zy(i){return i&&xh(i.canMatch)}(c)?c.canMatch(e,t):i.runInContext(()=>c(e,t)))})).pipe(Zc(),Jy()):St(!0)}(n=jy(e,n),e,t).pipe((0,wt.U)(o=>!0===o?s:{...ev})):St(s)}function tv(i,e,t){if(""===e.path)return"full"===e.pathMatch&&(i.hasChildren()||t.length>0)?{...ev}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||Go)(t,i,e);if(!r)return{...ev};const s={};D(r.posParams,(c,h)=>{s[h]=c.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function Ih(i,e,t,n){if(t.length>0&&function UD(i,e,t){return t.some(n=>nv(i,e,n)&&zo(n)!==Xt)}(i,t,n)){const s=new Nt(e,function kE(i,e,t,n){const r={};r[Xt]=n,n._sourceSegment=i,n._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&zo(s)!==Xt){const o=new Nt([],{});o._sourceSegment=i,o._segmentIndexShift=e.length,r[zo(s)]=o}return r}(i,e,n,new Nt(t,i.children)));return s._sourceSegment=i,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:[]}}if(0===t.length&&function RE(i,e,t){return t.some(n=>nv(i,e,n))}(i,t,n)){const s=new Nt(i.segments,function BD(i,e,t,n,r){const s={};for(const o of n)if(nv(i,t,o)&&!r[zo(o)]){const c=new Nt([],{});c._sourceSegment=i,c._segmentIndexShift=e.length,s[zo(o)]=c}return{...r,...s}}(i,e,t,n,i.children));return s._sourceSegment=i,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}const r=new Nt(i.segments,i.children);return r._sourceSegment=i,r._segmentIndexShift=e.length,{segmentGroup:r,slicedSegments:t}}function nv(i,e,t){return(!(i.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function ME(i,e,t,n){return!!(zo(i)===n||n!==Xt&&nv(e,t,i))&&("**"===i.path||tv(e,i,t).matched)}function Ch(i,e,t){return 0===e.length&&!i.children[t]}const wg=!1;class Xl{constructor(e){this.segmentGroup=e||null}}class Sh{constructor(e){this.urlTree=e}}function xm(i){return nl(new Xl(i))}function iv(i){return nl(new Sh(i))}class OE{constructor(e,t,n,r,s){this.injector=e,this.configLoader=t,this.urlSerializer=n,this.urlTree=r,this.config=s,this.allowRedirects=!0}apply(){const e=Ih(this.urlTree.root,[],[],this.config).segmentGroup,t=new Nt(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,Xt).pipe((0,wt.U)(s=>this.createUrlTree(q(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Ps(s=>{if(s instanceof Sh)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof Xl?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,Xt).pipe((0,wt.U)(r=>this.createUrlTree(q(r),e.queryParams,e.fragment))).pipe(Ps(r=>{throw r instanceof Xl?this.noMatchError(r):r}))}noMatchError(e){return new d.vHH(4002,wg)}createUrlTree(e,t,n){const r=F(e);return new un(r,t,n)}expandSegmentGroup(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe((0,wt.U)(s=>new Nt([],s))):this.expandSegment(e,n,t,n.segments,r,!0)}expandChildren(e,t,n){const r=[];for(const s of Object.keys(n.children))"primary"===s?r.unshift(s):r.push(s);return(0,zn.D)(r).pipe(Eo(s=>{const o=n.children[s],c=xE(t,s);return this.expandSegmentGroup(e,c,o,s).pipe((0,wt.U)(h=>({segment:h,outlet:s})))}),$c((s,o)=>(s[o.outlet]=o.segment,s),{}),jc())}expandSegment(e,t,n,r,s,o){return(0,zn.D)(n).pipe(Eo(c=>this.expandSegmentAgainstRoute(e,t,n,c,r,s,o).pipe(Ps(m=>{if(m instanceof Xl)return St(null);throw m}))),Os(c=>!!c),Ps((c,h)=>{if(Zl(c))return Ch(t,r,s)?St(new Nt([],{})):xm(t);throw c}))}expandSegmentAgainstRoute(e,t,n,r,s,o,c){return ME(r,t,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,o):c&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o):xm(t):xm(t)}expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,r){const s=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?iv(s):this.lineralizeSegments(n,s).pipe((0,Xi.z)(o=>{const c=new Nt(o,{});return this.expandSegment(e,c,t,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o){const{matched:c,consumedSegments:h,remainingSegments:m,positionalParamSegments:g}=tv(t,r,s);if(!c)return xm(t);const y=this.applyRedirectCommands(h,r.redirectTo,g);return r.redirectTo.startsWith("/")?iv(y):this.lineralizeSegments(r,y).pipe((0,Xi.z)(E=>this.expandSegment(e,t,n,E.concat(m),o,!1)))}matchSegmentAgainstRoute(e,t,n,r,s){return"**"===n.path?(e=jy(n,e),n.loadChildren?(n._loadedRoutes?St({routes:n._loadedRoutes,injector:n._loadedInjector}):this.configLoader.loadChildren(e,n)).pipe((0,wt.U)(c=>(n._loadedRoutes=c.routes,n._loadedInjector=c.injector,new Nt(r,{})))):St(new Nt(r,{}))):AE(t,n,r,e).pipe(Si(({matched:o,consumedSegments:c,remainingSegments:h})=>o?this.getChildConfig(e=n._injector??e,n,r).pipe((0,Xi.z)(g=>{const y=g.injector??e,E=g.routes,{segmentGroup:x,slicedSegments:S}=Ih(t,c,h,E),R=new Nt(x.segments,x.children);if(0===S.length&&R.hasChildren())return this.expandChildren(y,E,R).pipe((0,wt.U)(K=>new Nt(c,K)));if(0===E.length&&0===S.length)return St(new Nt(c,{}));const L=zo(n)===s;return this.expandSegment(y,R,E,S,L?Xt:s,!0).pipe((0,wt.U)(Y=>new Nt(c.concat(Y.segments),Y.children)))})):xm(t)))}getChildConfig(e,t,n){return t.children?St({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?St({routes:t._loadedRoutes,injector:t._loadedInjector}):function FD(i,e,t,n){const r=e.canLoad;return void 0===r||0===r.length?St(!0):St(r.map(o=>{const c=qu(o,i);return A(function qy(i){return i&&xh(i.canLoad)}(c)?c.canLoad(e,t):i.runInContext(()=>c(e,t)))})).pipe(Zc(),Jy())}(e,t,n).pipe((0,Xi.z)(r=>r?this.configLoader.loadChildren(e,t).pipe((0,gi.b)(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function $D(i){return nl(ID(wg,3))}())):St({routes:[],injector:e})}lineralizeSegments(e,t){let n=[],r=t.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return St(n);if(r.numberOfChildren>1||!r.children[Xt])return e.redirectTo,nl(new d.vHH(4e3,wg));r=r.children[Xt]}}applyRedirectCommands(e,t,n){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreateUrlTree(e,t,n,r){const s=this.createSegmentGroup(e,t.root,n,r);return new un(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return D(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const c=r.substring(1);n[s]=t[c]}else n[s]=r}),n}createSegmentGroup(e,t,n,r){const s=this.createSegments(e,t.segments,n,r);let o={};return D(t.children,(c,h)=>{o[h]=this.createSegmentGroup(e,c,n,r)}),new Nt(s,o)}createSegments(e,t,n,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,n))}findPosParam(e,t,n){const r=n[t.path.substring(1)];if(!r)throw new d.vHH(4001,wg);return r}findOrReturn(e,t){let n=0;for(const r of t){if(r.path===e.path)return t.splice(n),r;n++}return e}}class rv{}class Tm{constructor(e,t,n,r,s,o,c){this.injector=e,this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=s,this.paramsInheritanceStrategy=o,this.urlSerializer=c}recognize(){const e=Ih(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,Xt).pipe((0,wt.U)(t=>{if(null===t)return null;const n=new hg([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Xt,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Js(n,t),s=new _E(this.url,r);return this.inheritParamsAndData(s._root),s}))}inheritParamsAndData(e){const t=e.value,n=pE(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.processChildren(e,t,n):this.processSegment(e,t,n,n.segments,r)}processChildren(e,t,n){return(0,zn.D)(Object.keys(n.children)).pipe(Eo(r=>{const s=n.children[r],o=xE(t,r);return this.processSegmentGroup(e,o,s,r)}),$c((r,s)=>r&&s?(r.push(...s),r):null),function uh(i,e=!1){return(0,Pi.e)((t,n)=>{let r=0;t.subscribe((0,Ci.x)(n,s=>{const o=i(s,r++);(o||e)&&n.next(s),!o&&n.complete()}))})}(r=>null!==r),Wl(null),jc(),(0,wt.U)(r=>{if(null===r)return null;const s=LE(r);return function GD(i){i.sort((e,t)=>e.value.outlet===Xt?-1:t.value.outlet===Xt?1:e.value.outlet.localeCompare(t.value.outlet))}(s),s}))}processSegment(e,t,n,r,s){return(0,zn.D)(t).pipe(Eo(o=>this.processSegmentAgainstRoute(o._injector??e,o,n,r,s)),Os(o=>!!o),Ps(o=>{if(Zl(o))return Ch(n,r,s)?St([]):St(null);throw o}))}processSegmentAgainstRoute(e,t,n,r,s){if(t.redirectTo||!ME(t,n,r,s))return St(null);let o;if("**"===t.path){const c=r.length>0?ju(r).parameters:{},h=BE(n)+r.length;o=St({snapshot:new hg(r,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,cl(t),zo(t),t.component??t._loadedComponent??null,t,FE(n),h,UE(t)),consumedSegments:[],remainingSegments:[]})}else o=AE(n,t,r,e).pipe((0,wt.U)(({matched:c,consumedSegments:h,remainingSegments:m,parameters:g})=>{if(!c)return null;const y=BE(n)+h.length;return{snapshot:new hg(h,g,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,cl(t),zo(t),t.component??t._loadedComponent??null,t,FE(n),y,UE(t)),consumedSegments:h,remainingSegments:m}}));return o.pipe(Si(c=>{if(null===c)return St(null);const{snapshot:h,consumedSegments:m,remainingSegments:g}=c;e=t._injector??e;const y=t._loadedInjector??e,E=function zD(i){return i.children?i.children:i.loadChildren?i._loadedRoutes:[]}(t),{segmentGroup:x,slicedSegments:S}=Ih(n,m,g,E.filter(L=>void 0===L.redirectTo));if(0===S.length&&x.hasChildren())return this.processChildren(y,E,x).pipe((0,wt.U)(L=>null===L?null:[new Js(h,L)]));if(0===E.length&&0===S.length)return St([new Js(h,[])]);const R=zo(t)===s;return this.processSegment(y,E,x,S,R?Xt:s).pipe((0,wt.U)(L=>null===L?null:[new Js(h,L)]))}))}}function WD(i){const e=i.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function LE(i){const e=[],t=new Set;for(const n of i){if(!WD(n)){e.push(n);continue}const r=e.find(s=>n.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...n.children),t.add(r)):e.push(n)}for(const n of t){const r=LE(n.children);e.push(new Js(n.value,r))}return e.filter(n=>!t.has(n))}function FE(i){let e=i;for(;e._sourceSegment;)e=e._sourceSegment;return e}function BE(i){let e=i,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function cl(i){return i.data||{}}function UE(i){return i.resolve||{}}function ov(i){return"string"==typeof i.title||null===i.title}function av(i){return Si(e=>{const t=i(e);return t?(0,zn.D)(t).pipe((0,wt.U)(()=>e)):St(e)})}const Dh=new d.OlP("ROUTES");let cv=(()=>{class i{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,d.f3M)(d.Sil)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return St(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const n=A(t.loadComponent()).pipe((0,wt.U)(HE),(0,gi.b)(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),il(()=>{this.componentLoaders.delete(t)})),r=new ch(n,()=>new pn.x).pipe(Vc());return this.componentLoaders.set(t,r),r}loadChildren(t,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return St({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);const s=this.loadModuleFactoryOrRoutes(n.loadChildren).pipe((0,wt.U)(c=>{this.onLoadEndListener&&this.onLoadEndListener(n);let h,m,g=!1;Array.isArray(c)?m=c:(h=c.create(t).injector,m=hh(h.get(Dh,[],d.XFs.Self|d.XFs.Optional)));return{routes:m.map(_g),injector:h}}),il(()=>{this.childrenLoaders.delete(n)})),o=new ch(s,()=>new pn.x).pipe(Vc());return this.childrenLoaders.set(n,o),o}loadModuleFactoryOrRoutes(t){return A(t()).pipe((0,wt.U)(HE),(0,Xi.z)(n=>n instanceof d.YKP||Array.isArray(n)?St(n):(0,zn.D)(this.compiler.compileModuleAsync(n))))}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function HE(i){return function ka(i){return i&&"object"==typeof i&&"default"in i}(i)?i.default:i}let xg=(()=>{class i{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new pn.x,this.configLoader=(0,d.f3M)(cv),this.environmentInjector=(0,d.f3M)(d.lqb),this.urlSerializer=(0,d.f3M)(Li),this.rootContexts=(0,d.f3M)(pg),this.navigationId=0,this.afterPreactivation=()=>St(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new vD(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new Fy(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const n=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:n})}setupNavigations(t){return this.transitions=new ps({id:0,targetPageId:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:pm,restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(ti(n=>0!==n.id),(0,wt.U)(n=>({...n,extractedUrl:t.urlHandlingStrategy.extract(n.rawUrl)})),Si(n=>{let r=!1,s=!1;return St(n).pipe((0,gi.b)(o=>{this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Si(o=>{const c=t.browserUrlTree.toString(),h=!t.navigated||o.extractedUrl.toString()!==c||c!==t.currentUrlTree.toString();if(!h&&"reload"!==(o.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const g="";return this.events.next(new zu(o.id,t.serializeUrl(n.rawUrl),g,0)),t.rawUrlTree=o.rawUrl,o.resolve(null),Kr.E}if(t.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return jE(o.source)&&(t.browserUrlTree=o.extractedUrl),St(o).pipe(Si(g=>{const y=this.transitions?.getValue();return this.events.next(new Ny(g.id,this.urlSerializer.serialize(g.extractedUrl),g.source,g.restoredState)),y!==this.transitions?.getValue()?Kr.E:Promise.resolve(g)}),function PE(i,e,t,n){return Si(r=>function HD(i,e,t,n,r){return new OE(i,e,t,n,r).apply()}(i,e,t,r.extractedUrl,n).pipe((0,wt.U)(s=>({...r,urlAfterRedirects:s}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,t.config),(0,gi.b)(g=>{this.currentNavigation={...this.currentNavigation,finalUrl:g.urlAfterRedirects},n.urlAfterRedirects=g.urlAfterRedirects}),function KD(i,e,t,n,r){return(0,Xi.z)(s=>function sv(i,e,t,n,r,s,o="emptyOnly"){return new Tm(i,e,t,n,r,o,s).recognize().pipe(Si(c=>null===c?function jD(i){return new Zi.y(e=>e.error(i))}(new rv):St(c)))}(i,e,t,s.urlAfterRedirects,n.serialize(s.urlAfterRedirects),n,r).pipe((0,wt.U)(o=>({...s,targetSnapshot:o}))))}(this.environmentInjector,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),(0,gi.b)(g=>{if(n.targetSnapshot=g.targetSnapshot,"eager"===t.urlUpdateStrategy){if(!g.extras.skipLocationChange){const E=t.urlHandlingStrategy.merge(g.urlAfterRedirects,g.rawUrl);t.setBrowserUrl(E,g)}t.browserUrlTree=g.urlAfterRedirects}const y=new yh(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot);this.events.next(y)}));if(h&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:g,extractedUrl:y,source:E,restoredState:x,extras:S}=o,R=new Ny(g,this.urlSerializer.serialize(y),E,x);this.events.next(R);const L=mE(y,this.rootComponentType).snapshot;return St(n={...o,targetSnapshot:L,urlAfterRedirects:y,extras:{...S,skipLocationChange:!1,replaceUrl:!1}})}{const g="";return this.events.next(new zu(o.id,t.serializeUrl(n.extractedUrl),g,1)),t.rawUrlTree=o.rawUrl,o.resolve(null),Kr.E}}),(0,gi.b)(o=>{const c=new gD(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(c)}),(0,wt.U)(o=>n={...o,guards:wm(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),function vg(i,e){return(0,Xi.z)(t=>{const{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?St({...t,guardsResult:!0}):function LD(i,e,t,n){return(0,zn.D)(i).pipe((0,Xi.z)(r=>function ND(i,e,t,n,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||0===s.length)return St(!0);const o=s.map(c=>{const h=bm(e)??r,m=qu(c,h);return A(function OD(i){return i&&xh(i.canDeactivate)}(m)?m.canDeactivate(i,e,t,n):h.runInContext(()=>m(i,e,t,n))).pipe(Os())});return St(o).pipe(Zc())}(r.component,r.route,t,e,n)),Os(r=>!0!==r,!0))}(o,n,r,i).pipe((0,Xi.z)(c=>c&&function CE(i){return"boolean"==typeof i}(c)?function Xy(i,e,t,n){return(0,zn.D)(e).pipe(Eo(r=>Bc(function Yu(i,e){return null!==i&&e&&e(new cE(i)),St(!0)}(r.route.parent,n),function bg(i,e){return null!==i&&e&&e(new By(i)),St(!0)}(r.route,n),function Qy(i,e,t){const n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function Ky(i){const e=i.routeConfig?i.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:i,guards:e}:null}(o)).filter(o=>null!==o).map(o=>Uc(()=>St(o.guards.map(h=>{const m=bm(o.node)??t,g=qu(h,m);return A(function Yy(i){return i&&xh(i.canActivateChild)}(g)?g.canActivateChild(n,i):m.runInContext(()=>g(n,i))).pipe(Os())})).pipe(Zc())));return St(s).pipe(Zc())}(i,r.path,t),function DE(i,e,t){const n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||0===n.length)return St(!0);const r=n.map(s=>Uc(()=>{const o=bm(e)??t,c=qu(s,o);return A(function xP(i){return i&&xh(i.canActivate)}(c)?c.canActivate(e,i):o.runInContext(()=>c(e,i))).pipe(Os())}));return St(r).pipe(Zc())}(i,r.route,t))),Os(r=>!0!==r,!0))}(n,s,i,e):St(c)),(0,wt.U)(c=>({...t,guardsResult:c})))})}(this.environmentInjector,o=>this.events.next(o)),(0,gi.b)(o=>{if(n.guardsResult=o.guardsResult,me(o.guardsResult))throw TD(0,o.guardsResult);const c=new _D(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(c)}),ti(o=>!!o.guardsResult||(t.restoreHistory(o),this.cancelNavigationTransition(o,"",3),!1)),av(o=>{if(o.guards.canActivateChecks.length)return St(o).pipe((0,gi.b)(c=>{const h=new vP(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(h)}),Si(c=>{let h=!1;return St(c).pipe(function TP(i,e){return(0,Xi.z)(t=>{const{targetSnapshot:n,guards:{canActivateChecks:r}}=t;if(!r.length)return St(t);let s=0;return(0,zn.D)(r).pipe(Eo(o=>function IP(i,e,t,n){const r=i.routeConfig,s=i._resolve;return void 0!==r?.title&&!ov(r)&&(s[rl]=r.title),function VE(i,e,t,n){const r=function CP(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}(i);if(0===r.length)return St({});const s={};return(0,zn.D)(r).pipe((0,Xi.z)(o=>function $E(i,e,t,n){const r=bm(e)??n,s=qu(i,r);return A(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(i[o],e,t,n).pipe(Os(),(0,gi.b)(c=>{s[o]=c}))),Hc(1),xo(s),Ps(o=>Zl(o)?Kr.E:nl(o)))}(s,i,e,n).pipe((0,wt.U)(o=>(i._resolvedData=o,i.data=pE(i,t).resolve,r&&ov(r)&&(i.data[rl]=r.title),null)))}(o.route,n,i,e)),(0,gi.b)(()=>s++),Hc(1),(0,Xi.z)(o=>s===r.length?St(t):Kr.E))})}(t.paramsInheritanceStrategy,this.environmentInjector),(0,gi.b)({next:()=>h=!0,complete:()=>{h||(t.restoreHistory(c),this.cancelNavigationTransition(c,"",2))}}))}),(0,gi.b)(c=>{const h=new yD(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(h)}))}),av(o=>{const c=h=>{const m=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&m.push(this.configLoader.loadComponent(h.routeConfig).pipe((0,gi.b)(g=>{h.component=g}),(0,wt.U)(()=>{})));for(const g of h.children)m.push(...c(g));return m};return lh(c(o.targetSnapshot.root)).pipe(Wl(),qr(1))}),av(()=>this.afterPreactivation()),(0,wt.U)(o=>{const c=function ym(i,e,t){const n=wh(i,e._root,t?t._root:void 0);return new fE(n,e)}(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return n={...o,targetRouterState:c}}),(0,gi.b)(o=>{t.currentUrlTree=o.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(o.urlAfterRedirects,o.rawUrl),t.routerState=o.targetRouterState,"deferred"===t.urlUpdateStrategy&&(o.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,o),t.browserUrlTree=o.urlAfterRedirects)}),((i,e,t)=>(0,wt.U)(n=>(new TE(e,n.targetRouterState,n.currentRouterState,t).activate(i),n)))(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o)),qr(1),(0,gi.b)({next:o=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new Yc(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{r=!0}}),il(()=>{r||s||this.cancelNavigationTransition(n,"",1),this.currentNavigation?.id===n.id&&(this.currentNavigation=null)}),Ps(o=>{if(s=!0,mg(o)){fg(o)||(t.navigated=!0,t.restoreHistory(n,!0));const c=new gm(n.id,this.urlSerializer.serialize(n.extractedUrl),o.message,o.cancellationCode);if(this.events.next(c),fg(o)){const h=t.urlHandlingStrategy.merge(o.url,t.rawUrlTree),m={skipLocationChange:n.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||jE(n.source)};t.scheduleNavigation(h,pm,null,m,{resolve:n.resolve,reject:n.reject,promise:n.promise})}else n.resolve(!1)}else{t.restoreHistory(n,!0);const c=new _m(n.id,this.urlSerializer.serialize(n.extractedUrl),o,n.targetSnapshot??void 0);this.events.next(c);try{n.resolve(t.errorHandler(o))}catch(h){n.reject(h)}}return Kr.E}))}))}cancelNavigationTransition(t,n,r){const s=new gm(t.id,this.urlSerializer.serialize(t.extractedUrl),n,r);this.events.next(s),t.resolve(!1)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function jE(i){return i!==pm}let GE=(()=>{class i{buildTitle(t){let n,r=t.root;for(;void 0!==r;)n=this.getResolvedTitleForRoute(r)??n,r=r.children.find(s=>s.outlet===Xt);return n}getResolvedTitleForRoute(t){return t.data[rl]}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d.Yz7({token:i,factory:function(){return(0,d.f3M)(qD)},providedIn:"root"}),i})(),qD=(()=>{class i extends GE{constructor(t){super(),this.title=t}updateTitle(t){const n=this.buildTitle(t);void 0!==n&&this.title.setTitle(n)}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(kc))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),zE=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d.Yz7({token:i,factory:function(){return(0,d.f3M)(ZD)},providedIn:"root"}),i})();class YD{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let ZD=(()=>{class i extends YD{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=d.n5z(i)))(n||i)}}(),i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const gn=new d.OlP("",{providedIn:"root",factory:()=>({})});let WE=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d.Yz7({token:i,factory:function(){return(0,d.f3M)(KE)},providedIn:"root"}),i})(),KE=(()=>{class i{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,n){return t}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function QD(i){throw i}function JD(i,e,t){return e.parse("/")}const qE={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},eA={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let gs=(()=>{class i{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,d.f3M)(d.c2e),this.isNgZoneEnabled=!1,this.options=(0,d.f3M)(gn,{optional:!0})||{},this.errorHandler=this.options.errorHandler||QD,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||JD,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,d.f3M)(WE),this.routeReuseStrategy=(0,d.f3M)(zE),this.urlCreationStrategy=(0,d.f3M)(ED),this.titleStrategy=(0,d.f3M)(GE),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=hh((0,d.f3M)(Dh,{optional:!0})??[]),this.navigationTransitions=(0,d.f3M)(xg),this.urlSerializer=(0,d.f3M)(Li),this.location=(0,d.f3M)(it),this.isNgZoneEnabled=(0,d.f3M)(d.R0b)instanceof d.R0b&&d.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new un,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=mE(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId??0},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),pm,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const n="popstate"===t.type?"popstate":"hashchange";"popstate"===n&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,n,t.state)},0)}))}navigateToSyncWithBrowser(t,n,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const h={...r};delete h.navigationId,delete h.\u0275routerPageId,0!==Object.keys(h).length&&(s.state=h)}const c=this.parseUrl(t);this.scheduleNavigation(c,n,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(t){this.config=t.map(_g),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,n={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:c,preserveFragment:h}=n,m=h?this.currentUrlTree.fragment:o;let g=null;switch(c){case"merge":g={...this.currentUrlTree.queryParams,...s};break;case"preserve":g=this.currentUrlTree.queryParams;break;default:g=s||null}return null!==g&&(g=this.removeEmptyProps(g)),this.urlCreationStrategy.createUrlTree(r,this.routerState,this.currentUrlTree,t,g,m??null)}navigateByUrl(t,n={skipLocationChange:!1}){const r=me(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,pm,null,n)}navigate(t,n={skipLocationChange:!1}){return function tA(i){for(let e=0;e<i.length;e++){const t=i[e];if(null==t)throw new d.vHH(4008,false)}}(t),this.navigateByUrl(this.createUrlTree(t,n),n)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let n;try{n=this.urlSerializer.parse(t)}catch(r){n=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return n}isActive(t,n){let r;if(r=!0===n?{...qE}:!1===n?{...eA}:n,me(t))return le(this.currentUrlTree,t,r);const s=this.parseUrl(t);return le(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((n,r)=>{const s=t[r];return null!=s&&(n[r]=s),n},{})}scheduleNavigation(t,n,r,s,o){if(this.disposed)return Promise.resolve(!1);let c,h,m,g;return o?(c=o.resolve,h=o.reject,m=o.promise):m=new Promise((y,E)=>{c=y,h=E}),g="computed"===this.canceledNavigationResolution?r&&r.\u0275routerPageId?r.\u0275routerPageId:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:g,source:n,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:c,reject:h,promise:m,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),m.catch(y=>Promise.reject(y))}setBrowserUrl(t,n){const r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||n.extras.replaceUrl){const o={...n.extras.state,...this.generateNgRouterState(n.id,this.browserPageId)};this.location.replaceState(r,"",o)}else{const s={...n.extras.state,...this.generateNgRouterState(n.id,n.targetPageId)};this.location.go(r,"",s)}}restoreHistory(t,n=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-(this.browserPageId??this.currentPageId);0!==s?this.location.historyGo(s):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===s&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,n){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:n}:{navigationId:t}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class dv{}let hv=(()=>{class i{constructor(t,n,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(ti(t=>t instanceof Yc),Eo(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,n){const r=[];for(const s of n){s.providers&&!s._injector&&(s._injector=(0,d.MMx)(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,c=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(c,s.children??s._loadedRoutes))}return(0,zn.D)(r).pipe((0,Fc.J)())}preloadConfig(t,n){return this.preloadingStrategy.preload(n,()=>{let r;r=n.loadChildren&&void 0===n.canLoad?this.loader.loadChildren(t,n):St(null);const s=r.pipe((0,Xi.z)(o=>null===o?St(void 0):(n._loadedRoutes=o.routes,n._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));if(n.loadComponent&&!n._loadedComponent){const o=this.loader.loadComponent(n);return(0,zn.D)([s,o]).pipe((0,Fc.J)())}return s})}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(gs),d.LFG(d.Sil),d.LFG(d.lqb),d.LFG(dv),d.LFG(cv))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Sm=new d.OlP("");let ZE=(()=>{class i{constructor(t,n,r,s,o={}){this.urlSerializer=t,this.transitions=n,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Ny?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Yc&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Uy&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,n){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Uy(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,n))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return i.\u0275fac=function(t){d.$Z()},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac}),i})();var Wo=(()=>((Wo=Wo||{})[Wo.COMPLETE=0]="COMPLETE",Wo[Wo.FAILED=1]="FAILED",Wo[Wo.REDIRECTING=2]="REDIRECTING",Wo))();const Dm=!1;function Zu(i,e){return{\u0275kind:i,\u0275providers:e}}const mv=new d.OlP("",{providedIn:"root",factory:()=>!1});function Am(){const i=(0,d.f3M)(d.zs3);return e=>{const t=i.get(d.z2F);if(e!==t.components[0])return;const n=i.get(gs),r=i.get(XE);1===i.get(Ig)&&n.initialNavigation(),i.get(QE,null,d.XFs.Optional)?.setUpPreloading(),i.get(Sm,null,d.XFs.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const XE=new d.OlP(Dm?"bootstrap done indicator":"",{factory:()=>new pn.x}),Ig=new d.OlP(Dm?"initial navigation":"",{providedIn:"root",factory:()=>1});function sA(){let i=[];return i=Dm?[{provide:d.Xts,multi:!0,useFactory:()=>{const e=(0,d.f3M)(gs);return()=>e.events.subscribe(t=>{console.group?.(`Router Event: ${t.constructor.name}`),console.log(function dE(i){if(!("type"in i))return`Unknown Router Event: ${i.constructor.name}`;switch(i.type){case 14:return`ActivationEnd(path: '${i.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${i.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${i.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${i.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${i.id}, url: '${i.url}', urlAfterRedirects: '${i.urlAfterRedirects}', state: ${i.state}, shouldActivate: ${i.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${i.id}, url: '${i.url}', urlAfterRedirects: '${i.urlAfterRedirects}', state: ${i.state})`;case 2:return`NavigationCancel(id: ${i.id}, url: '${i.url}')`;case 16:return`NavigationSkipped(id: ${i.id}, url: '${i.url}')`;case 1:return`NavigationEnd(id: ${i.id}, url: '${i.url}', urlAfterRedirects: '${i.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${i.id}, url: '${i.url}', error: ${i.error})`;case 0:return`NavigationStart(id: ${i.id}, url: '${i.url}')`;case 6:return`ResolveEnd(id: ${i.id}, url: '${i.url}', urlAfterRedirects: '${i.urlAfterRedirects}', state: ${i.state})`;case 5:return`ResolveStart(id: ${i.id}, url: '${i.url}', urlAfterRedirects: '${i.urlAfterRedirects}', state: ${i.state})`;case 10:return`RouteConfigLoadEnd(path: ${i.route.path})`;case 9:return`RouteConfigLoadStart(path: ${i.route.path})`;case 4:return`RoutesRecognized(id: ${i.id}, url: '${i.url}', urlAfterRedirects: '${i.urlAfterRedirects}', state: ${i.state})`;case 15:return`Scroll(anchor: '${i.anchor}', position: '${i.position?`${i.position[0]}, ${i.position[1]}`:null}')`}}(t)),console.log(t),console.groupEnd?.()})}}]:[],Zu(1,i)}const QE=new d.OlP(Dm?"router preloader":"");function oA(i){return Zu(0,[{provide:QE,useExisting:hv},{provide:dv,useExisting:i}])}const Rh=!1,cA=new d.OlP(Rh?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),pv=[it,{provide:Li,useClass:Co},gs,pg,{provide:Ku,useFactory:function fv(i){return i.routerState.root},deps:[gs]},cv,Rh?{provide:mv,useValue:!0}:[]];function uA(){return new d.PXZ("Router",gs)}let dA=(()=>{class i{constructor(t){}static forRoot(t,n){return{ngModule:i,providers:[pv,Rh&&n?.enableTracing?sA().\u0275providers:[],{provide:Dh,multi:!0,useValue:t},{provide:cA,useFactory:tx,deps:[[gs,new d.FiY,new d.tp0]]},{provide:gn,useValue:n||{}},n?.useHash?{provide:xt,useClass:qe}:{provide:xt,useClass:Ke},{provide:Sm,useFactory:()=>{const i=(0,d.f3M)(vu),e=(0,d.f3M)(d.R0b),t=(0,d.f3M)(gn),n=(0,d.f3M)(xg),r=(0,d.f3M)(Li);return t.scrollOffset&&i.setOffset(t.scrollOffset),new ZE(r,n,i,e,t)}},n?.preloadingStrategy?oA(n.preloadingStrategy).\u0275providers:[],{provide:d.PXZ,multi:!0,useFactory:uA},n?.initialNavigation?fA(n):[],[{provide:nx,useFactory:Am},{provide:d.tb,multi:!0,useExisting:nx}]]}}static forChild(t){return{ngModule:i,providers:[{provide:Dh,multi:!0,useValue:t}]}}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(cA,8))},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({imports:[Hy]}),i})();function tx(i){if(Rh&&i)throw new d.vHH(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function fA(i){return["disabled"===i.initialNavigation?Zu(3,[{provide:d.ip1,multi:!0,useFactory:()=>{const e=(0,d.f3M)(gs);return()=>{e.setUpLocationChangeListener()}}},{provide:Ig,useValue:2}]).\u0275providers:[],"enabledBlocking"===i.initialNavigation?Zu(2,[{provide:Ig,useValue:0},{provide:d.ip1,multi:!0,deps:[d.zs3],useFactory:e=>{const t=e.get(Se,Promise.resolve());return()=>t.then(()=>new Promise(n=>{const r=e.get(gs),s=e.get(XE);(function AP(i,e){i.events.pipe(ti(t=>t instanceof Yc||t instanceof gm||t instanceof _m||t instanceof zu),(0,wt.U)(t=>t instanceof Yc||t instanceof zu?Wo.COMPLETE:t instanceof gm&&(0===t.code||1===t.code)?Wo.REDIRECTING:Wo.FAILED),ti(t=>t!==Wo.REDIRECTING),qr(1)).subscribe(()=>{e()})})(r,()=>{n(!0)}),e.get(xg).afterPreactivation=()=>(n(!0),s.closed?St(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const nx=new d.OlP(Rh?"Router Initializer":"");var Sg=z(1389),bn=z(2090),Qi=z(6881),Ra=z(1877),Xu=z(4859),Qu=z(6451),Oh=z(5363),gv=z(6063);class ix extends pn.x{constructor(e=1/0,t=1/0,n=gv.l){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:n,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:o}=this;t||(n.push(e),!r&&n.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:r}=this,s=r.slice();for(let o=0;o<s.length&&!e.closed;o+=n?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<n.length&&n.splice(0,n.length-s),!r){const o=t.now();let c=0;for(let h=1;h<n.length&&n[h]<=o;h+=2)c=h;c&&n.splice(0,c+1)}}}var Dg=z(3099);function rx(i,e,t){let n,r=!1;return i&&"object"==typeof i?({bufferSize:n=1/0,windowTime:e=1/0,refCount:r=!1,scheduler:t}=i):n=i??1/0,(0,Dg.B)({connector:()=>new ix(n,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}function sx(i,e){return(0,Qs.m)(e)?Si(()=>i,e):Si(()=>i)}var Ag=z(9468),In=z(4976),Ko=z(2011),qo=z(259);class Xc{constructor(e){return e}}class Rm{constructor(){return(0,qo.C6)()}}const _v=new d.OlP("angularfire2._apps"),OP={provide:Xc,useFactory:function mA(i){return i&&1===i.length?i[0]:new Xc((0,qo.Mq)())},deps:[[new d.FiY,_v]]},yv={provide:Rm,deps:[[new d.FiY,_v]]};function ox(i){return(e,t)=>{const n=e.runOutsideAngular(()=>i(t));return new Xc(n)}}let pA=(()=>{class i{constructor(t){(0,qo.KN)("angularfire",In.q4.full,"core"),(0,qo.KN)("angularfire",In.q4.full,"app"),(0,qo.KN)("angular",d.q4F.full,t.toString())}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(d.Lbi))},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({providers:[OP,yv]}),i})();function gA(i,...e){return{ngModule:pA,providers:[{provide:_v,useFactory:ox(i),multi:!0,deps:[d.R0b,d.zs3,In.HU,...e]}]}}const ax=(0,In.u3)(qo.Mq,!0),_A=(0,In.u3)(qo.ZF,!0);var cx,ux,hx,vv,fx,Ie=z(5861);const Mm=new Map,gx={activated:!1,tokenObservers:[]},yA={initialized:!1,enabled:!1};function wi(i){return Mm.get(i)||Object.assign({},gx)}function Ju(){return yA}const _x="https://content-firebaseappcheck.googleapis.com/v1",yx="exchangeDebugToken",wv={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class bx{constructor(e,t,n,r,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,Ie.Z)(function*(){t.stop();try{t.pending=new bn.BH,yield function Ev(i){return new Promise(e=>{setTimeout(e,i)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new bn.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(n){t.retryPolicy(n)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const yr=new bn.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function td(i){if(!wi(i).activated)throw yr.create("use-before-activation",{appName:i.name})}function Pm(i,e){return(cx=cx||(0,Ie.Z)(function*({url:t,body:n},r){const s={"Content-Type":"application/json"},o=r.getImmediate({optional:!0});if(o){const x=yield o.getHeartbeatsHeader();x&&(s["X-Firebase-Client"]=x)}const c={method:"POST",body:JSON.stringify(n),headers:s};let h,m;try{h=yield fetch(t,c)}catch(x){throw yr.create("fetch-network-error",{originalErrorMessage:x?.message})}if(200!==h.status)throw yr.create("fetch-status-error",{httpStatus:h.status});try{m=yield h.json()}catch(x){throw yr.create("fetch-parse-error",{originalErrorMessage:x?.message})}const g=m.ttl.match(/^([\d.]+)(s)$/);if(!g||!g[2]||isNaN(Number(g[1])))throw yr.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${m.ttl}`});const y=1e3*Number(g[1]),E=Date.now();return{token:m.token,expireTimeMillis:E+y,issuedAtTimeMillis:E}})).apply(this,arguments)}function Ph(i,e){const{projectId:t,appId:n,apiKey:r}=i.options;return{url:`${_x}/projects/${t}/apps/${n}:${yx}?key=${r}`,body:{debug_token:e}}}const wA="firebase-app-check-database",UP=1,Lm="firebase-app-check-store";let Mg=null;function Og(i,e){return(ux=ux||(0,Ie.Z)(function*(t,n){const s=(yield function Ex(){return Mg||(Mg=new Promise((i,e)=>{try{const t=indexedDB.open(wA,UP);t.onsuccess=n=>{i(n.target.result)},t.onerror=n=>{var r;e(yr.create("storage-open",{originalErrorMessage:null===(r=n.target.error)||void 0===r?void 0:r.message}))},t.onupgradeneeded=n=>{0===n.oldVersion&&n.target.result.createObjectStore(Lm,{keyPath:"compositeKey"})}}catch(t){e(yr.create("storage-open",{originalErrorMessage:t?.message}))}}),Mg)}()).transaction(Lm,"readwrite"),c=s.objectStore(Lm).put({compositeKey:t,value:n});return new Promise((h,m)=>{c.onsuccess=g=>{h()},s.onerror=g=>{var y;m(yr.create("storage-set",{originalErrorMessage:null===(y=g.target.error)||void 0===y?void 0:y.message}))}})})).apply(this,arguments)}const Nm=new Ra.Yd("@firebase/app-check");function Tv(i,e){return(0,bn.hl)()?function xA(i,e){return Og(function Pg(i){return`${i.options.appId}-${i.name}`}(i),e)}(i,e).catch(t=>{Nm.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Iv(){return Ju().enabled}function Cv(){return(hx=hx||(0,Ie.Z)(function*(){const i=Ju();if(i.enabled&&i.token)return i.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const Ix={error:"UNKNOWN_ERROR"};function Cx(i){return bn.US.encodeString(JSON.stringify(i),!1)}function Lg(i){return(vv=vv||(0,Ie.Z)(function*(e,t=!1){const n=e.app;td(n);const r=wi(n);let o,s=r.token;if(s&&!Qc(s)&&(r.token=void 0,s=void 0),!s){const m=yield r.cachedTokenPromise;m&&(Qc(m)?s=m:yield Tv(n,void 0))}if(!t&&s&&Qc(s))return{token:s.token};let h,c=!1;if(Iv()){r.exchangeTokenPromise||(r.exchangeTokenPromise=Pm(Ph(n,yield Cv()),e.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),c=!0);const m=yield r.exchangeTokenPromise;return yield Tv(n,m),r.token=m,{token:m.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),c=!0),s=yield wi(n).exchangeTokenPromise}catch(m){"appCheck/throttled"===m.code?Nm.warn(m.message):Nm.error(m),o=m}return s?o?h=Qc(s)?{token:s.token,internalError:o}:Ax(o):(h={token:s.token},r.token=s,yield Tv(n,s)):h=Ax(o),c&&function Dx(i,e){const t=wi(i).tokenObservers;for(const n of t)try{"EXTERNAL"===n.type&&null!=e.error?n.error(e.error):n.next(e)}catch{}}(n,h),h})).apply(this,arguments)}function Sx(i,e){const t=wi(i),n=t.tokenObservers.filter(r=>r.next!==e);0===n.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=n}function Fm(i){const{app:e}=i,t=wi(e);let n=t.tokenRefresher;n||(n=function AA(i){const{app:e}=i;return new bx((0,Ie.Z)(function*(){let n;if(n=wi(e).token?yield Lg(i,!0):yield Lg(i),n.error)throw n.error;if(n.internalError)throw n.internalError}),()=>!0,()=>{const t=wi(e);if(t.token){let n=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,t.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0},wv.RETRIAL_MIN_WAIT,wv.RETRIAL_MAX_WAIT)}(i),t.tokenRefresher=n),!n.isRunning()&&t.isTokenAutoRefreshEnabled&&n.start()}function Qc(i){return i.expireTimeMillis-Date.now()>0}function Ax(i){return{token:Cx(Ix),error:i}}class ul{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=wi(this.app);for(const t of e)Sx(this.app,t.next);return Promise.resolve()}}const Mv="app-check-internal";!function LA(){(0,Qi._registerComponent)(new Xu.wA("app-check",i=>function Bm(i,e){return new ul(i,e)}(i.getProvider("app").getImmediate(),i.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((i,e,t)=>{i.getProvider(Mv).initialize()})),(0,Qi._registerComponent)(new Xu.wA(Mv,i=>function _s(i){return{getToken:e=>Lg(i,e),getLimitedUseToken:()=>function DA(i){return(fx=fx||(0,Ie.Z)(function*(e){const t=e.app;td(t);const{provider:n}=wi(t);if(Iv()){const r=yield Cv(),{token:s}=yield Pm(Ph(t,r),e.heartbeatServiceProvider);return{token:s}}{const{token:r}=yield n.getToken();return{token:r}}})).apply(this,arguments)}(i),addTokenListener:e=>function Ng(i,e,t,n){const{app:r}=i,s=wi(r);if(s.tokenObservers=[...s.tokenObservers,{next:t,error:n,type:e}],s.token&&Qc(s.token)){const c=s.token;Promise.resolve().then(()=>{t({token:c.token}),Fm(i)}).catch(()=>{})}s.cachedTokenPromise.then(()=>Fm(i))}(i,"INTERNAL",e),removeTokenListener:e=>Sx(i.app,e)}}(i.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,Qi.registerVersion)("@firebase/app-check","0.8.0")}();class ec{constructor(){return(0,In.vb)("app-check")}}typeof window<"u"&&window;var Ox=z(9260);const Uv=new d.OlP("angularfire2.auth.use-emulator"),Vv=new d.OlP("angularfire2.auth.settings"),Lx=new d.OlP("angularfire2.auth.tenant-id"),$v=new d.OlP("angularfire2.auth.langugage-code"),Hv=new d.OlP("angularfire2.auth.use-device-language"),Bg=new d.OlP("angularfire.auth.persistence"),Ug=(i,e,t,n,r,s,o,c)=>(0,Ko.cc)(`${i.name}.auth`,"AngularFireAuth",i.name,()=>{const h=e.runOutsideAngular(()=>i.auth());if(t&&h.useEmulator(...t),n&&(h.tenantId=n),h.languageCode=r,s&&h.useDeviceLanguage(),o)for(const[m,g]of Object.entries(o))h.settings[m]=g;return c&&h.setPersistence(c),h},[t,n,r,s,o,c]);let od=(()=>{class i{constructor(t,n,r,s,o,c,h,m,g,y,E,x){const S=new pn.x,R=St(void 0).pipe((0,Oh.Q)(o.outsideAngular),Si(()=>s.runOutsideAngular(()=>Promise.resolve().then(z.bind(z,9568)))),(0,wt.U)(()=>(0,Ko.on)(t,s,n)),(0,wt.U)(L=>Ug(L,s,c,m,g,y,h,E)),rx({bufferSize:1,refCount:!1}));if(Vf(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=St(null);else{R.pipe(Os()).subscribe();const G=R.pipe(Si(te=>te.getRedirectResult().then(oe=>oe,()=>null)),In.iC,rx({bufferSize:1,refCount:!1})),Y=R.pipe(Si(te=>new Zi.y(oe=>({unsubscribe:s.runOutsideAngular(()=>te.onAuthStateChanged(Ae=>oe.next(Ae),Ae=>oe.error(Ae),()=>oe.complete()))})))),K=R.pipe(Si(te=>new Zi.y(oe=>({unsubscribe:s.runOutsideAngular(()=>te.onIdTokenChanged(Ae=>oe.next(Ae),Ae=>oe.error(Ae),()=>oe.complete()))}))));this.authState=G.pipe(sx(Y),(0,Ag.R)(o.outsideAngular),(0,Oh.Q)(o.insideAngular)),this.user=G.pipe(sx(K),(0,Ag.R)(o.outsideAngular),(0,Oh.Q)(o.insideAngular)),this.idToken=this.user.pipe(Si(te=>te?(0,zn.D)(te.getIdToken()):St(null))),this.idTokenResult=this.user.pipe(Si(te=>te?(0,zn.D)(te.getIdTokenResult()):St(null))),this.credential=(0,Qu.T)(G,S,this.authState.pipe(ti(te=>!te))).pipe((0,wt.U)(te=>te?.user?te:null),(0,Ag.R)(o.outsideAngular),(0,Oh.Q)(o.insideAngular))}return(0,Ko.pX)(this,R,s,{spy:{apply:(L,G,Y)=>{(L.startsWith("signIn")||L.startsWith("createUser"))&&Y.then(K=>S.next(K))}}})}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(Ko.Dh),d.LFG(Ko.xv,8),d.LFG(d.Lbi),d.LFG(d.R0b),d.LFG(In.HU),d.LFG(Uv,8),d.LFG(Vv,8),d.LFG(Lx,8),d.LFG($v,8),d.LFG(Hv,8),d.LFG(Bg,8),d.LFG(ec,8))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"}),i})(),Vm=(()=>{var i;class e{constructor(n){this.afAuth=n,this.isLoading=!1}loginWithGoogle(){const n=new Sg.V;this.afAuth.signInWithPopup(n)}logout(){return this.userDataAuth=null,this.afAuth.signOut()}get loggedIn(){return!!this.afAuth.currentUser}}return(i=e).\u0275fac=function(n){return new(n||i)(d.LFG(od))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),e})(),jv=(()=>{var i;class e{constructor(n){this.auth=n,this.showLoading=!0}ngOnInit(){setTimeout(()=>{this.showLoading=!1},1e3)}}return(i=e).\u0275fac=function(n){return new(n||i)(d.Y36(Vm))},i.\u0275cmp=d.Xpm({type:i,selectors:[["app-root"]],decls:1,vars:0,template:function(n,r){1&n&&d._UZ(0,"router-outlet")},dependencies:[gg]}),e})();function Nx(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var n,r,s,o,c,Gv={exports:{}};n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,Gv.exports=c={buildAbsoluteURL:function(h,m,g){if(g=g||{},h=h.trim(),!(m=m.trim())){if(!g.alwaysNormalize)return h;var y=c.parseURL(h);if(!y)throw new Error("Error trying to parse base URL.");return y.path=c.normalizePath(y.path),c.buildURLFromParts(y)}var E=c.parseURL(m);if(!E)throw new Error("Error trying to parse relative URL.");if(E.scheme)return g.alwaysNormalize?(E.path=c.normalizePath(E.path),c.buildURLFromParts(E)):m;var x=c.parseURL(h);if(!x)throw new Error("Error trying to parse base URL.");if(!x.netLoc&&x.path&&"/"!==x.path[0]){var S=r.exec(x.path);x.netLoc=S[1],x.path=S[2]}x.netLoc&&!x.path&&(x.path="/");var R={scheme:x.scheme,netLoc:E.netLoc,path:null,params:E.params,query:E.query,fragment:E.fragment};if(!E.netLoc&&(R.netLoc=x.netLoc,"/"!==E.path[0]))if(E.path){var L=x.path,G=L.substring(0,L.lastIndexOf("/")+1)+E.path;R.path=c.normalizePath(G)}else R.path=x.path,E.params||(R.params=x.params,E.query||(R.query=x.query));return null===R.path&&(R.path=g.alwaysNormalize?c.normalizePath(E.path):E.path),c.buildURLFromParts(R)},parseURL:function(h){var m=n.exec(h);return m?{scheme:m[1]||"",netLoc:m[2]||"",path:m[3]||"",params:m[4]||"",query:m[5]||"",fragment:m[6]||""}:null},normalizePath:function(h){for(h=h.split("").reverse().join("").replace(s,"");h.length!==(h=h.replace(o,"")).length;);return h.split("").reverse().join("")},buildURLFromParts:function(h){return h.scheme+h.netLoc+h.path+h.params+h.query+h.fragment}};var Vg=Gv.exports;function zv(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function Yr(i){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?zv(Object(t),!0).forEach(function(n){Jc(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):zv(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function Jc(i,e,t){return e=function Wv(i){var e=function $A(i,e){if("object"!=typeof i||null===i)return i;var t=i[Symbol.toPrimitive];if(void 0!==t){var n=t.call(i,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(i)}(i,"string");return"symbol"==typeof e?e:String(e)}(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Sr(){return Sr=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},Sr.apply(this,arguments)}const Wt=Number.isFinite||function(i){return"number"==typeof i&&isFinite(i)};let N=function(i){return i.MEDIA_ATTACHING="hlsMediaAttaching",i.MEDIA_ATTACHED="hlsMediaAttached",i.MEDIA_DETACHING="hlsMediaDetaching",i.MEDIA_DETACHED="hlsMediaDetached",i.BUFFER_RESET="hlsBufferReset",i.BUFFER_CODECS="hlsBufferCodecs",i.BUFFER_CREATED="hlsBufferCreated",i.BUFFER_APPENDING="hlsBufferAppending",i.BUFFER_APPENDED="hlsBufferAppended",i.BUFFER_EOS="hlsBufferEos",i.BUFFER_FLUSHING="hlsBufferFlushing",i.BUFFER_FLUSHED="hlsBufferFlushed",i.MANIFEST_LOADING="hlsManifestLoading",i.MANIFEST_LOADED="hlsManifestLoaded",i.MANIFEST_PARSED="hlsManifestParsed",i.LEVEL_SWITCHING="hlsLevelSwitching",i.LEVEL_SWITCHED="hlsLevelSwitched",i.LEVEL_LOADING="hlsLevelLoading",i.LEVEL_LOADED="hlsLevelLoaded",i.LEVEL_UPDATED="hlsLevelUpdated",i.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",i.LEVELS_UPDATED="hlsLevelsUpdated",i.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",i.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",i.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",i.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",i.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",i.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",i.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",i.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",i.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",i.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",i.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",i.CUES_PARSED="hlsCuesParsed",i.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",i.INIT_PTS_FOUND="hlsInitPtsFound",i.FRAG_LOADING="hlsFragLoading",i.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",i.FRAG_LOADED="hlsFragLoaded",i.FRAG_DECRYPTED="hlsFragDecrypted",i.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",i.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",i.FRAG_PARSING_METADATA="hlsFragParsingMetadata",i.FRAG_PARSED="hlsFragParsed",i.FRAG_BUFFERED="hlsFragBuffered",i.FRAG_CHANGED="hlsFragChanged",i.FPS_DROP="hlsFpsDrop",i.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",i.ERROR="hlsError",i.DESTROYING="hlsDestroying",i.KEY_LOADING="hlsKeyLoading",i.KEY_LOADED="hlsKeyLoaded",i.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",i.BACK_BUFFER_REACHED="hlsBackBufferReached",i}({}),an=function(i){return i.NETWORK_ERROR="networkError",i.MEDIA_ERROR="mediaError",i.KEY_SYSTEM_ERROR="keySystemError",i.MUX_ERROR="muxError",i.OTHER_ERROR="otherError",i}({}),Re=function(i){return i.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",i.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",i.KEY_SYSTEM_NO_SESSION="keySystemNoSession",i.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",i.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",i.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",i.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",i.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",i.MANIFEST_LOAD_ERROR="manifestLoadError",i.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",i.MANIFEST_PARSING_ERROR="manifestParsingError",i.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",i.LEVEL_EMPTY_ERROR="levelEmptyError",i.LEVEL_LOAD_ERROR="levelLoadError",i.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",i.LEVEL_PARSING_ERROR="levelParsingError",i.LEVEL_SWITCH_ERROR="levelSwitchError",i.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",i.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",i.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",i.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",i.FRAG_LOAD_ERROR="fragLoadError",i.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",i.FRAG_DECRYPT_ERROR="fragDecryptError",i.FRAG_PARSING_ERROR="fragParsingError",i.FRAG_GAP="fragGap",i.REMUX_ALLOC_ERROR="remuxAllocError",i.KEY_LOAD_ERROR="keyLoadError",i.KEY_LOAD_TIMEOUT="keyLoadTimeOut",i.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",i.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",i.BUFFER_APPEND_ERROR="bufferAppendError",i.BUFFER_APPENDING_ERROR="bufferAppendingError",i.BUFFER_STALLED_ERROR="bufferStalledError",i.BUFFER_FULL_ERROR="bufferFullError",i.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",i.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",i.INTERNAL_EXCEPTION="internalException",i.INTERNAL_ABORTED="aborted",i.UNKNOWN="unknown",i}({});const $h=function(){},Fx={trace:$h,debug:$h,log:$h,warn:$h,info:$h,error:$h};let $m=Fx;const ae=$m,Ux=/^(\d+)x(\d+)$/,Vx=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Fi{constructor(e){"string"==typeof e&&(e=Fi.parseAttrList(e));for(const t in e)e.hasOwnProperty(t)&&("X-"===t.substring(0,2)&&(this.clientAttrs=this.clientAttrs||[],this.clientAttrs.push(t)),this[t]=e[t])}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;const n=new Uint8Array(t.length/2);for(let r=0;r<t.length/2;r++)n[r]=parseInt(t.slice(2*r,2*r+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}bool(e){return"YES"===this[e]}decimalResolution(e){const t=Ux.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const n={};for(Vx.lastIndex=0;null!==(t=Vx.exec(e));){let s=t[2];0===s.indexOf('"')&&s.lastIndexOf('"')===s.length-1&&(s=s.slice(1,-1)),n[t[1].trim()]=s}return n}}function GA(i){return"SCTE35-OUT"===i||"SCTE35-IN"===i}class Kv{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const n=t.attr;for(const r in n)if(Object.prototype.hasOwnProperty.call(e,r)&&e[r]!==n[r]){ae.warn(`DATERANGE tag attribute: "${r}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=r;break}e=Sr(new Fi({}),n,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const n=new Date(this.attr["END-DATE"]);Wt(n.getTime())&&(this._endDate=n)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return null!==e?new Date(this._startDate.getTime()+1e3*e):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(Wt(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&Wt(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class Hm{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Wn={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class Hx{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[Wn.AUDIO]:null,[Wn.VIDEO]:null,[Wn.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const n=e.split("@",2),r=[];r[0]=1===n.length?t?t.byteRangeEndOffset:0:parseInt(n[1]),r[1]=parseInt(n[0])+r[0],this._byteRange=r}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Vg.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class qv extends Hx{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new Hm,this.urlId=0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const n=Object.keys(this.levelkeys);if(1===n.length)return this._decryptdata=this.levelkeys[n[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime||!Wt(this.programDateTime))return null;const e=Wt(this.duration)?this.duration:0;return this.programDateTime+1e3*e}get encrypted(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),n=t.length;if(n>1||1===n&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()}setElementaryStreamInfo(e,t,n,r,s,o=!1){const{elementaryStreams:c}=this,h=c[e];h?(h.startPTS=Math.min(h.startPTS,t),h.endPTS=Math.max(h.endPTS,n),h.startDTS=Math.min(h.startDTS,r),h.endDTS=Math.max(h.endDTS,s)):c[e]={startPTS:t,endPTS:n,startDTS:r,endDTS:s,partial:o}}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[Wn.AUDIO]=null,e[Wn.VIDEO]=null,e[Wn.AUDIOVIDEO]=null}}class jx extends Hx{constructor(e,t,n,r,s){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new Hm,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=r;const o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,s),s&&(this.fragOffset=s.fragOffset+s.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}class Gx{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e)return this.advanced=!0,void(this.updated=!0);const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||0===t&&n>0,this.misses=this.updated||this.advanced?Math.floor(.6*e.misses):e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return!!this.fragments.length&&Wt(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?1e3*(this.driftEnd-this.driftStart)/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function zx(i){return Uint8Array.from(atob(i),e=>e.charCodeAt(0))}function Wx(i){return Uint8Array.from(unescape(encodeURIComponent(i)),e=>e.charCodeAt(0))}var Bi={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Ui={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function Xo(i){switch(i){case Ui.FAIRPLAY:return Bi.FAIRPLAY;case Ui.PLAYREADY:return Bi.PLAYREADY;case Ui.WIDEVINE:return Bi.WIDEVINE;case Ui.CLEARKEY:return Bi.CLEARKEY}}var Qo_WIDEVINE="edef8ba979d64acea3c827dcd51d21ed";function Xv(i){switch(i){case Bi.FAIRPLAY:return Ui.FAIRPLAY;case Bi.PLAYREADY:return Ui.PLAYREADY;case Bi.WIDEVINE:return Ui.WIDEVINE;case Bi.CLEARKEY:return Ui.CLEARKEY}}function Qv(i){const{drmSystems:e,widevineLicenseUrl:t}=i,n=e?[Bi.FAIRPLAY,Bi.WIDEVINE,Bi.PLAYREADY,Bi.CLEARKEY].filter(r=>!!e[r]):[];return!n[Bi.WIDEVINE]&&t&&n.push(Bi.WIDEVINE),n}const qx=typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;function tc(i,e,t){return Uint8Array.prototype.slice?i.slice(e,t):new Uint8Array(Array.prototype.slice.call(i,e,t))}const ad=(i,e)=>e+10<=i.length&&73===i[e]&&68===i[e+1]&&51===i[e+2]&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128,Yx=(i,e)=>e+10<=i.length&&51===i[e]&&68===i[e+1]&&73===i[e+2]&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128,jm=(i,e)=>{const t=e;let n=0;for(;ad(i,e);)n+=10,n+=$g(i,e+6),Yx(i,e+10)&&(n+=10),e+=n;if(n>0)return i.subarray(t,t+n)},$g=(i,e)=>{let t=0;return t=(127&i[e])<<21,t|=(127&i[e+1])<<14,t|=(127&i[e+2])<<7,t|=127&i[e+3],t},qA=(i,e)=>ad(i,e)&&$g(i,e+6)+10<=i.length-e,Jv=i=>i&&"PRIV"===i.key&&"com.apple.streaming.transportStreamTimestamp"===i.info,Hg=i=>{const e=String.fromCharCode(i[0],i[1],i[2],i[3]),t=$g(i,4);return{type:e,size:t,data:i.subarray(10,10+t)}},Xx=i=>{let e=0;const t=[];for(;ad(i,e);){const n=$g(i,e+6);e+=10;const r=e+n;for(;e+8<r;){const s=Hg(i.subarray(e)),o=Qx(s);o&&t.push(o),e+=s.size+10}Yx(i,e)&&(e+=10)}return t},Qx=i=>"PRIV"===i.type?Jx(i):"W"===i.type[0]?jg(i):e0(i),Jx=i=>{if(i.size<2)return;const e=Oa(i.data,!0),t=new Uint8Array(i.data.subarray(e.length+1));return{key:i.type,info:e,data:t.buffer}},e0=i=>{if(i.size<2)return;if("TXXX"===i.type){let t=1;const n=Oa(i.data.subarray(t),!0);t+=n.length+1;const r=Oa(i.data.subarray(t));return{key:i.type,info:n,data:r}}const e=Oa(i.data.subarray(1));return{key:i.type,data:e}},jg=i=>{if("WXXX"===i.type){if(i.size<2)return;let t=1;const n=Oa(i.data.subarray(t),!0);t+=n.length+1;const r=Oa(i.data.subarray(t));return{key:i.type,info:n,data:r}}const e=Oa(i.data);return{key:i.type,data:e}},t0=i=>{if(8===i.data.byteLength){const e=new Uint8Array(i.data);let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,1&e[3]&&(n+=47721858.84),Math.round(n)}},Oa=(i,e=!1)=>{const t=function eT(){return!Gg&&typeof self.TextDecoder<"u"&&(Gg=new self.TextDecoder("utf-8")),Gg}();if(t){const m=t.decode(i);if(e){const g=m.indexOf("\0");return-1!==g?m.substring(0,g):m}return m.replace(/\0/g,"")}const n=i.length;let r,s,o,c="",h=0;for(;h<n;){if(r=i[h++],0===r&&e)return c;if(0!==r&&3!==r)switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c+=String.fromCharCode(r);break;case 12:case 13:s=i[h++],c+=String.fromCharCode((31&r)<<6|63&s);break;case 14:s=i[h++],o=i[h++],c+=String.fromCharCode((15&r)<<12|(63&s)<<6|(63&o)<<0)}}return c};let Gg;const Pa_hexDump=function(i){let e="";for(let t=0;t<i.length;t++){let n=i[t].toString(16);n.length<2&&(n="0"+n),e+=n}return e},Gm=Math.pow(2,32)-1,tT=[].push,n0={video:1,audio:2,id3:3,text:4};function Zr(i){return String.fromCharCode.apply(null,i)}function nT(i,e){const t=i[e]<<8|i[e+1];return t<0?65536+t:t}function _n(i,e){const t=iT(i,e);return t<0?4294967296+t:t}function iT(i,e){return i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}function r0(i,e,t){i[e]=t>>24,i[e+1]=t>>16&255,i[e+2]=t>>8&255,i[e+3]=255&t}function Kn(i,e){const t=[];if(!e.length)return t;const n=i.byteLength;for(let r=0;r<n;){const s=_n(i,r),c=s>1?r+s:n;if(Zr(i.subarray(r+4,r+8))===e[0])if(1===e.length)t.push(i.subarray(r+8,c));else{const h=Kn(i.subarray(r+8,c),e.slice(1));h.length&&tT.apply(t,h)}r=c}return t}function YA(i){const e=[],t=i[0];let n=8;const r=_n(i,n);n+=4,n+=0===t?8:16,n+=2;let c=i.length+0;const h=nT(i,n);n+=2;for(let m=0;m<h;m++){let g=n;const y=_n(i,g);g+=4;const E=2147483647&y;if((2147483648&y)>>>31==1)return ae.warn("SIDX has hierarchical references (not supported)"),null;const S=_n(i,g);g+=4,e.push({referenceSize:E,subsegmentDuration:S,info:{duration:S/r,start:c,end:c+E-1}}),c+=E,g+=4,n=g}return{earliestPresentationTime:0,timescale:r,version:t,referencesCount:h,references:e}}function rT(i){const e=[],t=Kn(i,["moov","trak"]);for(let r=0;r<t.length;r++){const s=t[r],o=Kn(s,["tkhd"])[0];if(o){let c=o[0],h=0===c?12:20;const m=_n(o,h),g=Kn(s,["mdia","mdhd"])[0];if(g){c=g[0],h=0===c?12:20;const y=_n(g,h),E=Kn(s,["mdia","hdlr"])[0];if(E){const x=Zr(E.subarray(8,12)),S={soun:Wn.AUDIO,vide:Wn.VIDEO}[x];if(S){const R=Kn(s,["mdia","minf","stbl","stsd"])[0];let L;R&&(L=Zr(R.subarray(12,16))),e[m]={timescale:y,type:S},e[S]={timescale:y,id:m,codec:L}}}}}}return Kn(i,["moov","mvex","trex"]).forEach(r=>{const s=_n(r,4),o=e[s];o&&(o.default={duration:_n(r,12),flags:_n(r,20)})}),e}function sT(i){const e=Kn(i,["schm"])[0];if(e){const t=Zr(e.subarray(4,8));if("cbcs"===t||"cenc"===t)return Kn(i,["schi","tenc"])[0]}return ae.error("[eme] missing 'schm' box"),null}function JA(i){const e=_n(i,0);let t=8;1&e&&(t+=4),4&e&&(t+=4);let n=0;const r=_n(i,4);for(let s=0;s<r;s++)256&e&&(n+=_n(i,t),t+=4),512&e&&(t+=4),1024&e&&(t+=4),2048&e&&(t+=4);return n}function ld(i,e){const t=new Uint8Array(i.length+e.length);return t.set(i),t.set(e,i.length),t}function oT(i,e){const t=[],n=e.samples,r=e.timescale,s=e.id;let o=!1;return Kn(n,["moof"]).map(h=>{const m=h.byteOffset-8;Kn(h,["traf"]).map(y=>{const E=Kn(y,["tfdt"]).map(x=>{const S=x[0];let R=_n(x,4);return 1===S&&(R*=Math.pow(2,32),R+=_n(x,8)),R/r})[0];return void 0!==E&&(i=E),Kn(y,["tfhd"]).map(x=>{const S=_n(x,4),R=16777215&_n(x,0);let K=0;const te=0!=(16&R);let oe=0;const Ae=0!=(32&R);let we=8;S===s&&(0!=(1&R)&&(we+=8),0!=(2&R)&&(we+=4),0!=(8&R)&&(K=_n(x,we),we+=4),te&&(oe=_n(x,we),we+=4),Ae&&(we+=4),"video"===e.type&&(o=function nk(i){if(!i)return!1;const e=i.indexOf("."),t=e<0?i:i.substring(0,e);return"hvc1"===t||"hev1"===t||"dvh1"===t||"dvhe"===t}(e.codec)),Kn(y,["trun"]).map(We=>{const ot=We[0],Le=16777215&_n(We,0),Qt=0!=(1&Le);let vt=0;const Bn=0!=(4&Le),Or=0!=(256&Le);let mi=0;const ct=0!=(512&Le);let _t=0;const He=0!=(1024&Le),dt=0!=(2048&Le);let xn=0;const $n=_n(We,4);let Cn=8;Qt&&(vt=_n(We,Cn),Cn+=4),Bn&&(Cn+=4);let _i=vt+m;for(let Hn=0;Hn<$n;Hn++){if(Or?(mi=_n(We,Cn),Cn+=4):mi=K,ct?(_t=_n(We,Cn),Cn+=4):_t=oe,He&&(Cn+=4),dt&&(xn=0===ot?_n(We,Cn):iT(We,Cn),Cn+=4),e.type===Wn.VIDEO){let oa=0;for(;oa<_t;){const aa=_n(n,_i);_i+=4,aT(o,n[_i])&&s0(n.subarray(_i,_i+aa),o?2:1,i+xn/r,t),_i+=aa,oa+=aa+4}}i+=mi/r}}))})})}),t}function aT(i,e){if(i){const t=e>>1&63;return 39===t||40===t}return 6==(31&e)}function s0(i,e,t,n){const r=o0(i);let s=0;s+=e;let o=0,c=0,h=!1,m=0;for(;s<r.length;){o=0;do{if(s>=r.length)break;m=r[s++],o+=m}while(255===m);c=0;do{if(s>=r.length)break;m=r[s++],c+=m}while(255===m);const g=r.length-s;if(!h&&4===o&&s<r.length){if(h=!0,181===r[s++]){const E=nT(r,s);if(s+=2,49===E){const x=_n(r,s);if(s+=4,1195456820===x){const S=r[s++];if(3===S){const R=r[s++],G=64&R,Y=G?2+3*(31&R):0,K=new Uint8Array(Y);if(G){K[0]=R;for(let te=1;te<Y;te++)K[te]=r[s++]}n.push({type:S,payloadType:o,pts:t,bytes:K})}}}}}else if(5===o&&c<g){if(h=!0,c>16){const y=[];for(let S=0;S<16;S++){const R=r[s++].toString(16);y.push(1==R.length?"0"+R:R),(3===S||5===S||7===S||9===S)&&y.push("-")}const E=c-16,x=new Uint8Array(E);for(let S=0;S<E;S++)x[S]=r[s++];n.push({payloadType:o,pts:t,uuid:y.join(""),userData:Oa(x),userDataBytes:x})}}else if(c<g)s+=c;else if(c>g)break}}function o0(i){const e=i.byteLength,t=[];let n=1;for(;n<e-2;)0===i[n]&&0===i[n+1]&&3===i[n+2]?(t.push(n+2),n+=2):n++;if(0===t.length)return i;const r=e-t.length,s=new Uint8Array(r);let o=0;for(n=0;n<r;o++,n++)o===t[0]&&(o++,t.shift()),s[n]=i[o];return s}let zm={};class Hh{static clearKeyUriToKeyIdMap(){zm={}}constructor(e,t,n,r=[1],s=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=r,this.iv=s,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&"AES-128"!==e}isSupported(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case Ui.FAIRPLAY:case Ui.WIDEVINE:case Ui.PLAYREADY:case Ui.CLEARKEY:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!=typeof e&&("AES-128"===this.method&&!this.iv&&ae.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const n=function a0(i){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=i>>8*(15-t)&255;return e}(e);return new Hh(this.method,this.uri,"identity",this.keyFormatVersions,n)}const t=function dl(i){const e=i.split(":");let t=null;if("data"===e[0]&&2===e.length){const n=e[1].split(";"),r=n[n.length-1].split(",");if(2===r.length){const o=r[1];"base64"===r[0]?(n.splice(-1,1),t=zx(o)):t=function Yv(i){const e=Wx(i).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}(o)}}return t}(this.uri);if(t)switch(this.keyFormat){case Ui.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case Ui.PLAYREADY:{const n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=function uT(i,e,t){if(16!==i.byteLength)throw new RangeError("Invalid system id");let n,r,s;if(e){n=1,r=new Uint8Array(16*e.length);for(let c=0;c<e.length;c++){const h=e[c];if(16!==h.byteLength)throw new RangeError("Invalid key");r.set(h,16*c)}}else n=0,r=new Uint8Array;n>0?(s=new Uint8Array(4),e.length>0&&new DataView(s.buffer).setUint32(0,e.length,!1)):s=new Uint8Array;const o=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(o.buffer).setUint32(0,t.byteLength,!1),function cT(i,...e){const t=e.length;let n=8,r=t;for(;r--;)n+=e[r].byteLength;const s=new Uint8Array(n);for(s[0]=n>>24&255,s[1]=n>>16&255,s[2]=n>>8&255,s[3]=255&n,s.set(i,4),r=0,n=8;r<t;r++)s.set(e[r],n),n+=e[r].byteLength;return s}([112,115,115,104],new Uint8Array([n,0,0,0]),i,s,r,o,t||new Uint8Array)}(n,null,t);const r=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),s=String.fromCharCode.apply(null,Array.from(r)),o=s.substring(s.indexOf("<"),s.length),m=(new DOMParser).parseFromString(o,"text/xml").getElementsByTagName("KID")[0];if(m){const g=m.childNodes[0]?m.childNodes[0].nodeValue:m.getAttribute("VALUE");if(g){const y=zx(g).subarray(0,16);(function Zv(i){const e=function(n,r,s){const o=n[r];n[r]=n[s],n[s]=o};e(i,0,3),e(i,1,2),e(i,4,5),e(i,6,7)})(y),this.keyId=y}}break}default:{let n=t.subarray(0,16);if(16!==n.length){const r=new Uint8Array(16);r.set(n,16-n.length),n=r}this.keyId=n;break}}if(!this.keyId||16!==this.keyId.byteLength){let n=zm[this.uri];if(!n){const r=Object.keys(zm).length%Number.MAX_SAFE_INTEGER;n=new Uint8Array(16),new DataView(n.buffer,12,4).setUint32(0,r),zm[this.uri]=n}this.keyId=n}return this}}const zg=/\{\$([a-zA-Z0-9-_]+)\}/g;function eu(i){return zg.test(i)}function eo(i,e,t){if(null!==i.variableList||i.hasVariableRefs)for(let n=t.length;n--;){const r=t[n],s=e[r];s&&(e[r]=l0(i,s))}}function l0(i,e){if(null!==i.variableList||i.hasVariableRefs){const t=i.variableList;return e.replace(zg,n=>{const r=n.substring(2,n.length-1),s=t?.[r];return void 0===s?(i.playlistParsingError||(i.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),n):s})}return e}function cd(i,e,t){let r,s,n=i.variableList;if(n||(i.variableList=n={}),"QUERYPARAM"in e){r=e.QUERYPARAM;try{const o=new self.URL(t).searchParams;if(!o.has(r))throw new Error(`"${r}" does not match any query parameter in URI: "${t}"`);s=o.get(r)}catch(o){i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else r=e.NAME,s=e.VALUE;r in n?i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):n[r]=s||""}function GP(i,e,t){const n=e.IMPORT;if(t&&n in t){let r=i.variableList;r||(i.variableList=r={}),r[n]=t[n]}else i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}function jh(){if(!(typeof self>"u"))return self.MediaSource||self.WebKitMediaSource}const zP={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}},c0=jh();function fT(i,e){var t;return null!=(t=c0?.isTypeSupported(`${e||"video"}/mp4;codecs="${i}"`))&&t}const en=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,mT=/#EXT-X-MEDIA:(.*)/g,ik=/^#EXT(?:INF|-X-TARGETDURATION):/m,pT=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),Gh=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class La{static findGroup(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.id===t)return r}}static convertAVC1ToAVCOTI(e){const t=e.split(".");if(t.length>2){let n=t.shift()+".";return n+=parseInt(t.shift()).toString(16),n+=("000"+parseInt(t.shift()).toString(16)).slice(-4),n}return e}static resolve(e,t){return Vg.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return ik.test(e)}static parseMasterPlaylist(e,t){const r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:eu(e)},s=[];let o;for(en.lastIndex=0;null!=(o=en.exec(e));)if(o[1]){var c;const m=new Fi(o[1]);eo(r,m,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const g=l0(r,o[2]),y={attrs:m,bitrate:m.decimalInteger("AVERAGE-BANDWIDTH")||m.decimalInteger("BANDWIDTH"),name:m.NAME,url:La.resolve(g,t)},E=m.decimalResolution("RESOLUTION");E&&(y.width=E.width,y.height=E.height),Ji((m.CODECS||"").split(/[ ,]+/).filter(x=>x),y),y.videoCodec&&-1!==y.videoCodec.indexOf("avc1")&&(y.videoCodec=La.convertAVC1ToAVCOTI(y.videoCodec)),null!=(c=y.unknownCodecs)&&c.length||s.push(y),r.levels.push(y)}else if(o[3]){const g=o[4];switch(o[3]){case"SESSION-DATA":{const y=new Fi(g);eo(r,y,["DATA-ID","LANGUAGE","VALUE","URI"]);const E=y["DATA-ID"];E&&(null===r.sessionData&&(r.sessionData={}),r.sessionData[E]=y);break}case"SESSION-KEY":{const y=Wm(g,t,r);y.encrypted&&y.isSupported()?(null===r.sessionKeys&&(r.sessionKeys=[]),r.sessionKeys.push(y)):ae.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${g}"`);break}case"DEFINE":{const y=new Fi(g);eo(r,y,["NAME","VALUE","QUERYPARAM"]),cd(r,y,t)}break;case"CONTENT-STEERING":{const y=new Fi(g);eo(r,y,["SERVER-URI","PATHWAY-ID"]),r.contentSteering={uri:La.resolve(y["SERVER-URI"],t),pathwayId:y["PATHWAY-ID"]||"."};break}case"START":r.startTimeOffset=Km(g)}}return r.levels=s.length>0&&s.length<r.levels.length?s:r.levels,0===r.levels.length&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(e,t,n){let r;const s={},o=n.levels,c={AUDIO:o.map(m=>({id:m.attrs.AUDIO,audioCodec:m.audioCodec})),SUBTITLES:o.map(m=>({id:m.attrs.SUBTITLES,textCodec:m.textCodec})),"CLOSED-CAPTIONS":[]};let h=0;for(mT.lastIndex=0;null!==(r=mT.exec(e));){const m=new Fi(r[1]),g=m.TYPE;if(g){const y=c[g],E=s[g]||[];s[g]=E,eo(n,m,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const x={attrs:m,bitrate:0,id:h++,groupId:m["GROUP-ID"]||"",instreamId:m["INSTREAM-ID"],name:m.NAME||m.LANGUAGE||"",type:g,default:m.bool("DEFAULT"),autoselect:m.bool("AUTOSELECT"),forced:m.bool("FORCED"),lang:m.LANGUAGE,url:m.URI?La.resolve(m.URI,t):""};if(null!=y&&y.length){const S=La.findGroup(y,x.groupId)||y[0];rk(x,S,"audioCodec"),rk(x,S,"textCodec")}E.push(x)}}return s}static parseLevelPlaylist(e,t,n,r,s,o){const c=new Gx(t),h=c.fragments;let L,G,Y,m=null,g=0,y=0,E=0,x=0,S=null,R=new qv(r,t),K=-1,te=!1;for(pT.lastIndex=0,c.m3u8=e,c.hasVariableRefs=eu(e);null!==(L=pT.exec(e));){te&&(te=!1,R=new qv(r,t),R.start=E,R.sn=g,R.cc=x,R.level=n,m&&(R.initSegment=m,R.rawProgramDateTime=m.rawProgramDateTime,m.rawProgramDateTime=null));const We=L[1];if(We){R.duration=parseFloat(We);const ot=(" "+L[2]).slice(1);R.title=ot||null,R.tagList.push(ot?["INF",We,ot]:["INF",We])}else if(L[3]){if(Wt(R.duration)){R.start=E,Y&&d0(R,Y,c),R.sn=g,R.level=n,R.cc=x,R.urlId=s,h.push(R);const ot=(" "+L[3]).slice(1);R.relurl=l0(c,ot),u0(R,S),S=R,E+=R.duration,g++,y=0,te=!0}}else if(L[4]){const ot=(" "+L[4]).slice(1);S?R.setByteRange(ot,S):R.setByteRange(ot)}else if(L[5])R.rawProgramDateTime=(" "+L[5]).slice(1),R.tagList.push(["PROGRAM-DATE-TIME",R.rawProgramDateTime]),-1===K&&(K=h.length);else{if(L=L[0].match(Gh),!L){ae.warn("No matches on slow regex match for level playlist!");continue}for(G=1;G<L.length&&!(typeof L[G]<"u");G++);const ot=(" "+L[G]).slice(1),Le=(" "+L[G+1]).slice(1),Qt=L[G+2]?(" "+L[G+2]).slice(1):"";switch(ot){case"PLAYLIST-TYPE":c.type=Le.toUpperCase();break;case"MEDIA-SEQUENCE":g=c.startSN=parseInt(Le);break;case"SKIP":{const vt=new Fi(Le);eo(c,vt,["RECENTLY-REMOVED-DATERANGES"]);const Bn=vt.decimalInteger("SKIPPED-SEGMENTS");if(Wt(Bn)){c.skippedSegments=Bn;for(let mi=Bn;mi--;)h.unshift(null);g+=Bn}const Or=vt.enumeratedString("RECENTLY-REMOVED-DATERANGES");Or&&(c.recentlyRemovedDateranges=Or.split("\t"));break}case"TARGETDURATION":c.targetduration=Math.max(parseInt(Le),1);break;case"VERSION":c.version=parseInt(Le);break;case"EXTM3U":break;case"ENDLIST":c.live=!1;break;case"#":(Le||Qt)&&R.tagList.push(Qt?[Le,Qt]:[Le]);break;case"DISCONTINUITY":x++,R.tagList.push(["DIS"]);break;case"GAP":R.gap=!0,R.tagList.push([ot]);break;case"BITRATE":R.tagList.push([ot,Le]);break;case"DATERANGE":{const vt=new Fi(Le);eo(c,vt,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),eo(c,vt,vt.clientAttrs);const Bn=new Kv(vt,c.dateRanges[vt.ID]);Bn.isValid||c.skippedSegments?c.dateRanges[Bn.id]=Bn:ae.warn(`Ignoring invalid DATERANGE tag: "${Le}"`),R.tagList.push(["EXT-X-DATERANGE",Le]);break}case"DEFINE":{const vt=new Fi(Le);eo(c,vt,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in vt?GP(c,vt,o):cd(c,vt,t)}break;case"DISCONTINUITY-SEQUENCE":x=parseInt(Le);break;case"KEY":{const vt=Wm(Le,t,c);if(vt.isSupported()){if("NONE"===vt.method){Y=void 0;break}Y||(Y={}),Y[vt.keyFormat]&&(Y=Sr({},Y)),Y[vt.keyFormat]=vt}else ae.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${Le}"`);break}case"START":c.startTimeOffset=Km(Le);break;case"MAP":{const vt=new Fi(Le);if(eo(c,vt,["BYTERANGE","URI"]),R.duration){const Bn=new qv(r,t);_T(Bn,vt,n,Y),m=Bn,R.initSegment=m,m.rawProgramDateTime&&!R.rawProgramDateTime&&(R.rawProgramDateTime=m.rawProgramDateTime)}else _T(R,vt,n,Y),m=R,te=!0;break}case"SERVER-CONTROL":{const vt=new Fi(Le);c.canBlockReload=vt.bool("CAN-BLOCK-RELOAD"),c.canSkipUntil=vt.optionalFloat("CAN-SKIP-UNTIL",0),c.canSkipDateRanges=c.canSkipUntil>0&&vt.bool("CAN-SKIP-DATERANGES"),c.partHoldBack=vt.optionalFloat("PART-HOLD-BACK",0),c.holdBack=vt.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const vt=new Fi(Le);c.partTarget=vt.decimalFloatingPoint("PART-TARGET");break}case"PART":{let vt=c.partList;vt||(vt=c.partList=[]);const Bn=y>0?vt[vt.length-1]:void 0,Or=y++,mi=new Fi(Le);eo(c,mi,["BYTERANGE","URI"]);const ct=new jx(mi,R,t,Or,Bn);vt.push(ct),R.duration+=ct.duration;break}case"PRELOAD-HINT":{const vt=new Fi(Le);eo(c,vt,["URI"]),c.preloadHint=vt;break}case"RENDITION-REPORT":{const vt=new Fi(Le);eo(c,vt,["URI"]),c.renditionReports=c.renditionReports||[],c.renditionReports.push(vt);break}default:ae.warn(`line parsed but not handled: ${L}`)}}}S&&!S.relurl?(h.pop(),E-=S.duration,c.partList&&(c.fragmentHint=S)):c.partList&&(u0(R,S),R.cc=x,c.fragmentHint=R,Y&&d0(R,Y,c));const oe=h.length,Ae=h[0],we=h[oe-1];if(E+=c.skippedSegments*c.targetduration,E>0&&oe&&we){c.averagetargetduration=E/oe;const We=we.sn;c.endSN="initSegment"!==We?We:0,c.live||(we.endList=!0),Ae&&(c.startCC=Ae.cc)}else c.endSN=0,c.startCC=0;return c.fragmentHint&&(E+=c.fragmentHint.duration),c.totalduration=E,c.endCC=x,K>0&&function gT(i,e){let t=i[e];for(let n=e;n--;){const r=i[n];if(!r)return;r.programDateTime=t.programDateTime-1e3*r.duration,t=r}}(h,K),c}}function Wm(i,e,t){var n,r;const s=new Fi(i);eo(t,s,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const o=null!=(n=s.METHOD)?n:"",c=s.URI,h=s.hexadecimalInteger("IV"),m=s.KEYFORMATVERSIONS,g=null!=(r=s.KEYFORMAT)?r:"identity";c&&s.IV&&!h&&ae.error(`Invalid IV: ${s.IV}`);const y=c?La.resolve(c,e):"",E=(m||"1").split("/").map(Number).filter(Number.isFinite);return new Hh(o,y,g,E,h)}function Km(i){const t=new Fi(i).decimalFloatingPoint("TIME-OFFSET");return Wt(t)?t:null}function Ji(i,e){["video","audio","text"].forEach(t=>{const n=i.filter(r=>function hT(i,e){const t=zP[e];return!!t&&!0===t[i.slice(0,4)]}(r,t));if(n.length){const r=n.filter(s=>0===s.lastIndexOf("avc1",0)||0===s.lastIndexOf("mp4a",0));e[`${t}Codec`]=r.length>0?r[0]:n[0],i=i.filter(s=>-1===n.indexOf(s))}}),e.unknownCodecs=i}function rk(i,e,t){const n=e[t];n&&(i[t]=n)}function u0(i,e){i.rawProgramDateTime?i.programDateTime=Date.parse(i.rawProgramDateTime):null!=e&&e.programDateTime&&(i.programDateTime=e.endProgramDateTime),Wt(i.programDateTime)||(i.programDateTime=null,i.rawProgramDateTime=null)}function _T(i,e,t,n){i.relurl=e.URI,e.BYTERANGE&&i.setByteRange(e.BYTERANGE),i.level=t,i.sn="initSegment",n&&(i.levelkeys=n),i.initSegment=null}function d0(i,e,t){i.levelkeys=e;const{encryptedFragments:n}=t;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(r=>e[r].isCommonEncryption)&&n.push(i)}var qn={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},ln={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function h0(i){const{type:e}=i;switch(e){case qn.AUDIO_TRACK:return ln.AUDIO;case qn.SUBTITLE_TRACK:return ln.SUBTITLE;default:return ln.MAIN}}function f0(i,e){let t=i.url;return(void 0===t||0===t.indexOf("data:"))&&(t=e.url),t}class sk{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.LEVEL_LOADING,this.onLevelLoading,this),e.on(N.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(N.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.LEVEL_LOADING,this.onLevelLoading,this),e.off(N.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(N.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,o=new(t.pLoader||t.loader)(t);return this.loaders[e.type]=o,o}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:qn.MANIFEST,url:n,deliveryDirectives:null})}onLevelLoading(e,t){const{id:n,level:r,url:s,deliveryDirectives:o}=t;this.load({id:n,level:r,responseType:"text",type:qn.LEVEL,url:s,deliveryDirectives:o})}onAudioTrackLoading(e,t){const{id:n,groupId:r,url:s,deliveryDirectives:o}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:qn.AUDIO_TRACK,url:s,deliveryDirectives:o})}onSubtitleTrackLoading(e,t){const{id:n,groupId:r,url:s,deliveryDirectives:o}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:qn.SUBTITLE_TRACK,url:s,deliveryDirectives:o})}load(e){var t;const n=this.hls.config;let s,r=this.getInternalLoader(e);if(r){const m=r.context;if(m&&m.url===e.url)return void ae.trace("[playlist-loader]: playlist request ongoing");ae.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}if(s=e.type===qn.MANIFEST?n.manifestLoadPolicy.default:Sr({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),null!=(t=e.deliveryDirectives)&&t.part){let m;if(e.type===qn.LEVEL&&null!==e.level?m=this.hls.levels[e.level].details:e.type===qn.AUDIO_TRACK&&null!==e.id?m=this.hls.audioTracks[e.id].details:e.type===qn.SUBTITLE_TRACK&&null!==e.id&&(m=this.hls.subtitleTracks[e.id].details),m){const g=m.partTarget,y=m.targetduration;if(g&&y){const E=1e3*Math.max(3*g,.8*y);s=Sr({},s,{maxTimeToFirstByteMs:Math.min(E,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(E,s.maxTimeToFirstByteMs)})}}}const o=s.errorRetry||s.timeoutRetry||{};r.load(e,{loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},{onSuccess:(m,g,y,E)=>{const x=this.getInternalLoader(y);this.resetInternalLoader(y.type);const S=m.data;0===S.indexOf("#EXTM3U")?(g.parsing.start=performance.now(),La.isMediaPlaylist(S)?this.handleTrackOrLevelPlaylist(m,g,y,E||null,x):this.handleMasterPlaylist(m,g,y,E)):this.handleManifestParsingError(m,y,new Error("no EXTM3U delimiter"),E||null,g)},onError:(m,g,y,E)=>{this.handleNetworkError(g,y,!1,m,E)},onTimeout:(m,g,y)=>{this.handleNetworkError(g,y,!0,void 0,m)}})}handleMasterPlaylist(e,t,n,r){const s=this.hls,o=e.data,c=f0(e,n),h=La.parseMasterPlaylist(o,c);if(h.playlistParsingError)return void this.handleManifestParsingError(e,n,h.playlistParsingError,r,t);const{contentSteering:m,levels:g,sessionData:y,sessionKeys:E,startTimeOffset:x,variableList:S}=h;this.variableList=S;const{AUDIO:R=[],SUBTITLES:L,"CLOSED-CAPTIONS":G}=La.parseMasterPlaylistMedia(o,c,h);R.length&&!R.some(K=>!K.url)&&g[0].audioCodec&&!g[0].attrs.AUDIO&&(ae.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),R.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Fi({}),bitrate:0,url:""})),s.trigger(N.MANIFEST_LOADED,{levels:g,audioTracks:R,subtitles:L,captions:G,contentSteering:m,url:c,stats:t,networkDetails:r,sessionData:y,sessionKeys:E,startTimeOffset:x,variableList:S})}handleTrackOrLevelPlaylist(e,t,n,r,s){const o=this.hls,{id:c,level:h,type:m}=n,g=f0(e,n),y=Wt(c)?c:0,E=Wt(h)?h:y,x=h0(n),S=La.parseLevelPlaylist(e.data,g,E,x,y,this.variableList);if(m===qn.MANIFEST){const R={attrs:new Fi({}),bitrate:0,details:S,name:"",url:g};o.trigger(N.MANIFEST_LOADED,{levels:[R],audioTracks:[],url:g,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=S,this.handlePlaylistLoaded(S,e,t,n,r,s)}handleManifestParsingError(e,t,n,r,s){this.hls.trigger(N.ERROR,{type:an.NETWORK_ERROR,details:Re.MANIFEST_PARSING_ERROR,fatal:t.type===qn.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:r,stats:s})}handleNetworkError(e,t,n=!1,r,s){let o=`A network ${n?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${e.type}`;e.type===qn.LEVEL?o+=`: ${e.level} id: ${e.id}`:(e.type===qn.AUDIO_TRACK||e.type===qn.SUBTITLE_TRACK)&&(o+=` id: ${e.id} group-id: "${e.groupId}"`);const c=new Error(o);ae.warn(`[playlist-loader]: ${o}`);let h=Re.UNKNOWN,m=!1;const g=this.getInternalLoader(e);switch(e.type){case qn.MANIFEST:h=n?Re.MANIFEST_LOAD_TIMEOUT:Re.MANIFEST_LOAD_ERROR,m=!0;break;case qn.LEVEL:h=n?Re.LEVEL_LOAD_TIMEOUT:Re.LEVEL_LOAD_ERROR,m=!1;break;case qn.AUDIO_TRACK:h=n?Re.AUDIO_TRACK_LOAD_TIMEOUT:Re.AUDIO_TRACK_LOAD_ERROR,m=!1;break;case qn.SUBTITLE_TRACK:h=n?Re.SUBTITLE_TRACK_LOAD_TIMEOUT:Re.SUBTITLE_LOAD_ERROR,m=!1}g&&this.resetInternalLoader(e.type);const y={type:an.NETWORK_ERROR,details:h,fatal:m,url:e.url,loader:g,context:e,error:c,networkDetails:t,stats:s};r&&(y.response=Yr({url:t?.url||e.url,data:void 0},r)),this.hls.trigger(N.ERROR,y)}handlePlaylistLoaded(e,t,n,r,s,o){const c=this.hls,{type:h,level:m,id:g,groupId:y,deliveryDirectives:E}=r,x=f0(t,r),S=h0(r),R="number"==typeof r.level&&S===ln.MAIN?m:void 0;if(!e.fragments.length){const G=new Error("No Segments found in Playlist");return void c.trigger(N.ERROR,{type:an.NETWORK_ERROR,details:Re.LEVEL_EMPTY_ERROR,fatal:!1,url:x,error:G,reason:G.message,response:t,context:r,level:R,parent:S,networkDetails:s,stats:n})}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const L=e.playlistParsingError;if(L)c.trigger(N.ERROR,{type:an.NETWORK_ERROR,details:Re.LEVEL_PARSING_ERROR,fatal:!1,url:x,error:L,reason:L.message,response:t,context:r,level:R,parent:S,networkDetails:s,stats:n});else switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),h){case qn.MANIFEST:case qn.LEVEL:c.trigger(N.LEVEL_LOADED,{details:e,level:R||0,id:g||0,stats:n,networkDetails:s,deliveryDirectives:E});break;case qn.AUDIO_TRACK:c.trigger(N.AUDIO_TRACK_LOADED,{details:e,id:g||0,groupId:y||"",stats:n,networkDetails:s,deliveryDirectives:E});break;case qn.SUBTITLE_TRACK:c.trigger(N.SUBTITLE_TRACK_LOADED,{details:e,id:g||0,groupId:y||"",stats:n,networkDetails:s,deliveryDirectives:E})}}}function yT(i,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=i,e.dispatchEvent(t)}function zh(i,e){const t=i.mode;if("disabled"===t&&(i.mode="hidden"),i.cues&&!i.cues.getCueById(e.id))try{if(i.addCue(e),!i.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){ae.debug(`[texttrack-utils]: ${n}`);try{const r=new self.TextTrackCue(e.startTime,e.endTime,e.text);r.id=e.id,i.addCue(r)}catch(r){ae.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${r}`)}}"disabled"===t&&(i.mode=t)}function Wh(i){const e=i.mode;if("disabled"===e&&(i.mode="hidden"),i.cues)for(let t=i.cues.length;t--;)i.removeCue(i.cues[t]);"disabled"===e&&(i.mode=e)}function m0(i,e,t,n){const r=i.mode;if("disabled"===r&&(i.mode="hidden"),i.cues&&i.cues.length>0){const s=function Wg(i,e,t){const n=[],r=function ok(i,e){if(e<i[0].startTime)return 0;const t=i.length-1;if(e>i[t].endTime)return-1;let n=0,r=t;for(;n<=r;){const s=Math.floor((r+n)/2);if(e<i[s].startTime)r=s-1;else{if(!(e>i[s].startTime&&n<t))return s;n=s+1}}return i[n].startTime-e<e-i[r].startTime?n:r}(i,e);if(r>-1)for(let s=r,o=i.length;s<o;s++){const c=i[s];if(c.startTime>=e&&c.endTime<=t)n.push(c);else if(c.startTime>t)return n}return n}(i.cues,e,t);for(let o=0;o<s.length;o++)(!n||n(s[o]))&&i.removeCue(s[o])}"disabled"===r&&(i.mode=r)}var Jo_emsg="https://aomedia.org/emsg/ID3";function Kg(){if(!(typeof self>"u"))return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}const qg=(()=>{const i=Kg();try{new i(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function ud(i,e){return i.getTime()/1e3-e}function qm(i){return Uint8Array.from(i.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class ak{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(N.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(N.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(N.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(N.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(Wh(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if("metadata"===n.kind&&"id3"===n.label)return yT(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:r}}}=this;if(!n&&!r)return;const{samples:s}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=Kg();for(let c=0;c<s.length;c++){const h=s[c].type;if(h===Jo_emsg&&!n||!r)continue;const m=Xx(s[c].data);if(m){const g=s[c].pts;let y=g+s[c].duration;y>qg&&(y=qg),y-g<=0&&(y=g+.25);for(let x=0;x<m.length;x++){const S=m[x];if(!Jv(S)){this.updateId3CueEnds(g,h);const R=new o(g,y,"");R.value=S,h&&(R.type=h),this.id3Track.addCue(R)}}}}}updateId3CueEnds(e,t){var n;const r=null==(n=this.id3Track)?void 0:n.cues;if(r)for(let s=r.length;s--;){const o=r[s];o.type===t&&o.startTime<e&&o.endTime===qg&&(o.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:r}){const{id3Track:s,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:c,enableID3MetadataCues:h}}=o;if(s&&(c||h)){let m;m="audio"===r?g=>"org.id3"===g.type&&h:"video"===r?g=>g.type===Jo_emsg&&c:g=>"org.id3"===g.type&&h||g.type===Jo_emsg&&c,m0(s,t,n,m)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:n,id3Track:r}=this,{dateRanges:s}=t,o=Object.keys(s);if(r){const g=Object.keys(n).filter(y=>!o.includes(y));for(let y=g.length;y--;){const E=g[y];Object.keys(n[E].cues).forEach(x=>{r.removeCue(n[E].cues[x])}),delete n[E]}}const c=t.fragments[t.fragments.length-1];if(0===o.length||!Wt(c?.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const h=c.programDateTime/1e3-c.start,m=Kg();for(let g=0;g<o.length;g++){const y=o[g],E=s[y],x=n[y],S=x?.cues||{};let R=x?.durationKnown||!1;const L=ud(E.startDate,h);let G=qg;const Y=E.endDate;if(Y)G=ud(Y,h),R=!0;else if(E.endOnNext&&!R){const te=o.reduce((oe,Ae)=>{const we=s[Ae];return we.class===E.class&&we.id!==Ae&&we.startDate>E.startDate&&oe.push(we),oe},[]).sort((oe,Ae)=>oe.startDate.getTime()-Ae.startDate.getTime())[0];te&&(G=ud(te.startDate,h),R=!0)}const K=Object.keys(E.attr);for(let te=0;te<K.length;te++){const oe=K[te];if("ID"===(i=oe)||"CLASS"===i||"START-DATE"===i||"DURATION"===i||"END-DATE"===i||"END-ON-NEXT"===i)continue;let Ae=S[oe];if(Ae)R&&!x.durationKnown&&(Ae.endTime=G);else{let we=E.attr[oe];Ae=new m(L,G,""),GA(oe)&&(we=qm(we)),Ae.value={key:oe,data:we},Ae.type="com.apple.quicktime.HLS",Ae.id=y,this.id3Track.addCue(Ae),S[oe]=Ae}}n[y]={cues:S,dateRange:E,durationKnown:R}}var i}}class lk{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(null===e)return null;const{holdBack:t,partHoldBack:n,targetduration:r}=e,{liveSyncDuration:s,liveSyncDurationCount:o,lowLatencyMode:c}=this.config,h=this.hls.userConfig;let m=c&&n||t;return(h.liveSyncDuration||h.liveSyncDurationCount||0===m)&&(m=void 0!==s?s:o*r),m+Math.min(1*this.stallCount,r)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(null===e||null===t||null===n)return null;const r=n.edge,c=r-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(r-n.totalduration,e-t-this.edgeStalled),c)}get drift(){const{levelDetails:e}=this;return null===e?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;return null===e?0:Math.max(e.age-3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration),0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(N.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(N.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(N.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(N.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(N.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(N.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(N.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(N.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(N.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(N.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var n;t.details===Re.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(n=this.levelDetails)&&n.live&&ae.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(null===n)return;this._latency=n;const{lowLatencyMode:r,maxLiveSyncPlaybackRate:s}=this.config;if(!r||1===s)return;const o=this.targetLatency;if(null===o)return;const c=n-o,h=Math.min(this.maxLatency,o+t.targetduration);if(t.live&&c<h&&c>.05&&this.forwardBufferLength>1){const g=Math.min(2,Math.max(1,s)),y=Math.round(2/(1+Math.exp(-.75*c-this.edgeStalled))*20)/20;e.playbackRate=Math.min(g,Math.max(1,y))}else 1!==e.playbackRate&&0!==e.playbackRate&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return null===e?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return null===e?null:e-this.currentTime}}const p0=["NONE","TYPE-0","TYPE-1",null];var Kh_No="",Kh_Yes="YES",Kh_v2="v2";class g0{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Ym{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.unknownCodecs=e.unknownCodecs,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>t).join(",").replace(/\.[^.,]+/g,"")}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get attrs(){return this._attrs[this._urlId]}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get uri(){return this.url[this._urlId]||""}get urlId(){return this._urlId}set urlId(e){const t=e%this.url.length;this._urlId!==t&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=t)}get audioGroupId(){var e;return null==(e=this.audioGroupIds)?void 0:e[this.urlId]}get textGroupId(){var e;return null==(e=this.textGroupIds)?void 0:e[this.urlId]}addFallback(e){this.url.push(e.url),this._attrs.push(e.attrs)}}function Yg(i,e){const t=e.startPTS;if(Wt(t)){let r,n=0;e.sn>i.sn?(n=t-i.start,r=i):(n=i.start-t,r=e),r.duration!==n&&(r.duration=n)}else e.start=e.sn>i.sn?i.cc===e.cc&&i.minEndPTS?i.start+(i.minEndPTS-i.start):i.start+i.duration:Math.max(i.start-e.duration,0)}function wT(i,e,t,n,r,s){n-t<=0&&(ae.warn("Fragment should have a positive duration",e),n=t+e.duration,s=r+e.duration);let c=t,h=n;const m=e.startPTS,g=e.endPTS;if(Wt(m)){const L=Math.abs(m-t);e.deltaPTS=Wt(e.deltaPTS)?Math.max(L,e.deltaPTS):L,c=Math.max(t,m),t=Math.min(t,m),r=Math.min(r,e.startDTS),h=Math.min(n,g),n=Math.max(n,g),s=Math.max(s,e.endDTS)}const y=t-e.start;0!==e.start&&(e.start=t),e.duration=n-e.start,e.startPTS=t,e.maxStartPTS=c,e.startDTS=r,e.endPTS=n,e.minEndPTS=h,e.endDTS=s;const E=e.sn;if(!i||E<i.startSN||E>i.endSN)return 0;let x;const S=E-i.startSN,R=i.fragments;for(R[S]=e,x=S;x>0;x--)Yg(R[x],R[x-1]);for(x=S;x<R.length-1;x++)Yg(R[x],R[x+1]);return i.fragmentHint&&Yg(R[R.length-1],i.fragmentHint),i.PTSKnown=i.alignedSliding=!0,y}function uk(i,e){const t=e.startSN+e.skippedSegments-i.startSN,n=i.fragments;t<0||t>=n.length||Zg(e,n[t].start)}function Zg(i,e){if(e){const t=i.fragments;for(let n=i.skippedSegments;n<t.length;n++)t[n].start+=e;i.fragmentHint&&(i.fragmentHint.start+=e)}}function ET(i,e,t){var n;return null!=i&&i.details?_0(null==(n=i.details)?void 0:n.partList,e,t):null}function _0(i,e,t){if(i)for(let n=i.length;n--;){const r=i[n];if(r.index===t&&r.fragment.sn===e)return r}return null}function tu(i){switch(i.details){case Re.FRAG_LOAD_TIMEOUT:case Re.KEY_LOAD_TIMEOUT:case Re.LEVEL_LOAD_TIMEOUT:case Re.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function xT(i,e){const t=tu(e);return i.default[(t?"timeout":"error")+"Retry"]}function y0(i,e){const t="linear"===i.backoff?1:Math.pow(2,e);return Math.min(t*i.retryDelayMs,i.maxRetryDelayMs)}function TT(i){return Yr(Yr({},i),{errorRetry:null,timeoutRetry:null})}function Qg(i,e,t,n){return!!i&&e<i.maxNumRetry&&(function YP(i){return 0===i&&!1===navigator.onLine||!!i&&(i<400||i>499)}(n)||!!t)}const IT={search:function(i,e){let t=0,n=i.length-1,r=null,s=null;for(;t<=n;){r=(t+n)/2|0,s=i[r];const o=e(s);if(o>0)t=r+1;else{if(!(o<0))return s;n=r-1}}return null}};function Zm(i,e,t=0,n=0){let r=null;if(i?r=e[i.sn-e[0].sn+1]||null:0===t&&0===e[0].start&&(r=e[0]),r&&0===v0(t,n,r))return r;const s=IT.search(e,v0.bind(null,t,n));return!s||s===i&&r?r:s}function v0(i=0,e=0,t){if(t.start<=i&&t.start+t.duration>i)return 0;const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=i?1:t.start-n>i&&t.start?-1:0}function Xm(i,e,t){const n=1e3*Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return(t.endProgramDateTime||0)-n>i}const ST=3e5;function DT(i,e,t){if(performance.now()-i.lastErrorPerfMs>ST)return!0;const n=i.details;if(e.details===Re.FRAG_GAP&&n&&e.frag){const s=Zm(null,n.fragments,e.frag.start);if(s&&!s.gap)return!0}if(t&&i.errors.length<t.errors.length){const r=i.errors[i.errors.length-1];if(n&&r.frag&&e.frag&&Math.abs(r.frag.start-e.frag.start)>3*n.targetduration)return!0}return!1}class b0{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=ae.log.bind(ae,`${t}:`),this.warn=ae.warn.bind(ae,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){clearTimeout(this.timer),this.timer=-1}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t){const n=t?.renditionReports;if(n){let r=-1;for(let s=0;s<n.length;s++){const o=n[s];let c;try{c=new self.URL(o.URI,t.url).href}catch(h){ae.warn(`Could not construct new URL for Rendition Report: ${h}`),c=o.URI||""}if(c===e){r=s;break}c===e.substring(0,c.length)&&(r=s)}if(-1!==r){const s=n[r],o=parseInt(s["LAST-MSN"])||t?.lastPartSn;let c=parseInt(s["LAST-PART"])||t?.lastPartIndex;if(this.hls.config.lowLatencyMode){const h=Math.min(t.age-t.partTarget,t.targetduration);c>=0&&h>t.partTarget&&(c+=1)}return new g0(o,c>=0?c:void 0,Kh_No)}}}loadPlaylist(e){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return-1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,n){const{details:r,stats:s}=t,o=self.performance.now(),c=s.loading.first?Math.max(0,o-s.loading.first):0;if(r.advancedDateTime=Date.now()-c,r.live||null!=n&&n.live){if(r.reloaded(n),n&&this.log(`live playlist ${e} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:r.updated?"UPDATED":"MISSED"}`),n&&r.fragments.length>0&&function ck(i,e){let t=null;const n=i.fragments;for(let h=n.length-1;h>=0;h--){const m=n[h].initSegment;if(m){t=m;break}}i.fragmentHint&&delete i.fragmentHint.endPTS;let s,r=0;if(function qP(i,e,t){const n=e.skippedSegments,r=Math.max(i.startSN,e.startSN)-e.startSN,s=(i.fragmentHint?1:0)+(n?e.endSN:Math.min(i.endSN,e.endSN))-e.startSN,o=e.startSN-i.startSN,c=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,h=i.fragmentHint?i.fragments.concat(i.fragmentHint):i.fragments;for(let m=r;m<=s;m++){const g=h[o+m];let y=c[m];n&&!y&&m<n&&(y=e.fragments[m]=g),g&&y&&t(g,y)}}(i,e,(h,m)=>{h.relurl&&(r=h.cc-m.cc),Wt(h.startPTS)&&Wt(h.endPTS)&&(m.start=m.startPTS=h.startPTS,m.startDTS=h.startDTS,m.maxStartPTS=h.maxStartPTS,m.endPTS=h.endPTS,m.endDTS=h.endDTS,m.minEndPTS=h.minEndPTS,m.duration=h.endPTS-h.startPTS,m.duration&&(s=m),e.PTSKnown=e.alignedSliding=!0),m.elementaryStreams=h.elementaryStreams,m.loader=h.loader,m.stats=h.stats,m.urlId=h.urlId,h.initSegment&&(m.initSegment=h.initSegment,t=h.initSegment)}),t&&(e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments).forEach(m=>{var g;(!m.initSegment||m.initSegment.relurl===(null==(g=t)?void 0:g.relurl))&&(m.initSegment=t)}),e.skippedSegments)if(e.deltaUpdateFailed=e.fragments.some(h=>!h),e.deltaUpdateFailed){ae.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let h=e.skippedSegments;h--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}else e.canSkipDateRanges&&(e.dateRanges=function WP(i,e,t){const n=Sr({},i);return t&&t.forEach(r=>{delete n[r]}),Object.keys(e).forEach(r=>{const s=new Kv(e[r].attr,n[r]);s.isValid?n[r]=s:ae.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[r].attr)}"`)}),n}(i.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));const o=e.fragments;if(r){ae.warn("discontinuity sliding from playlist, take drift into account");for(let h=0;h<o.length;h++)o[h].cc+=r}e.skippedSegments&&(e.startCC=e.fragments[0].cc),function KP(i,e,t){if(i&&e){let n=0;for(let r=0,s=i.length;r<=s;r++){const o=i[r],c=e[r+n];o&&c&&o.index===c.index&&o.fragment.sn===c.fragment.sn?t(o,c):n--}}}(i.partList,e.partList,(h,m)=>{m.elementaryStreams=h.elementaryStreams,m.stats=h.stats}),s?wT(e,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):uk(i,e),o.length&&(e.totalduration=e.edge-o[0].start),e.driftStartTime=i.driftStartTime,e.driftStart=i.driftStart;const c=e.advancedDateTime;if(e.advanced&&c){const h=e.edge;e.driftStart||(e.driftStartTime=c,e.driftStart=h),e.driftEndTime=c,e.driftEnd=h}else e.driftEndTime=i.driftEndTime,e.driftEnd=i.driftEnd,e.advancedDateTime=i.advancedDateTime}(n,r),!this.canLoad||!r.live)return;let h,m,g;if(r.canBlockReload&&r.endSN&&r.advanced){const L=this.hls.config.lowLatencyMode,G=r.lastPartSn,Y=r.endSN,K=r.lastPartIndex,oe=G===Y;-1!==K?(m=oe?Y+1:G,g=oe?L?0:K:K+1):m=Y+1;const we=r.age;let ot=Math.min(we+r.ageHeader-r.partTarget,1.5*r.targetduration);if(ot>0){if(n&&ot>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${ot} with playlist age: ${r.age}`),ot=0;else{const Le=Math.floor(ot/r.targetduration);m+=Le,void 0!==g&&(g+=Math.round(ot%r.targetduration/r.partTarget)),this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${we.toFixed(2)}s goal: ${ot} skip sn ${Le} to part ${g}`)}r.tuneInGoal=ot}if(h=this.getDeliveryDirectives(r,t.deliveryDirectives,m,g),L||!oe)return void this.loadPlaylist(h)}else(r.canBlockReload||r.canSkipUntil)&&(h=this.getDeliveryDirectives(r,t.deliveryDirectives,m,g));const y=this.hls.mainForwardBufferInfo,S=function Xg(i,e=1/0){let t=1e3*i.targetduration;if(i.updated){const n=i.fragments;if(n.length&&4*t>e){const s=1e3*n[n.length-1].duration;s<t&&(t=s)}}else t/=2;return Math.round(t)}(r,1e3*(r.edge-(y?y.end-y.len:0)));r.updated&&o>this.requestScheduled+S&&(this.requestScheduled=s.loading.start),void 0!==m&&r.canBlockReload?this.requestScheduled=s.loading.first+S-(1e3*r.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+S<o?this.requestScheduled=o:this.requestScheduled-o<=0&&(this.requestScheduled+=S);let R=this.requestScheduled-o;R=Math.max(0,R),this.log(`reload live playlist ${e} in ${Math.round(R)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(h),R)}else this.clearTimer()}getDeliveryDirectives(e,t,n,r){let s=function bT(i,e){const{canSkipUntil:t,canSkipDateRanges:n,endSN:r}=i;return t&&(void 0!==e?e-r:0)<t?n?Kh_v2:Kh_Yes:Kh_No}(e,n);return null!=t&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,r=t.part,s=Kh_No),new g0(n,r,s)}checkRetry(e){const t=e.details,n=tu(e),r=e.errorAction,{action:s,retryCount:o=0,retryConfig:c}=r||{},h=!!r&&!!c&&(5===s||!r.resolved&&2===s);if(h){var m;if(this.requestScheduled=-1,o>=c.maxNumRetry)return!1;if(n&&null!=(m=e.context)&&m.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${c.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const g=y0(c,o);this.timer=self.setTimeout(()=>this.loadPlaylist(),g),this.warn(`Retrying playlist loading ${o+1}/${c.maxNumRetry} after "${t}" in ${g}ms`)}e.levelRetry=!0,r.resolved=!0}return h}}let Qm;class mk extends b0{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(N.LEVEL_LOADED,this.onLevelLoaded,this),e.on(N.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(N.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(N.FRAG_LOADED,this.onFragLoaded,this),e.on(N.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(N.LEVEL_LOADED,this.onLevelLoaded,this),e.off(N.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(N.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(N.FRAG_LOADED,this.onFragLoaded,this),e.off(N.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}startLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.startLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[]}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=[],r={};let s;t.levels.forEach(o=>{var c;const h=o.attrs;-1!==(null==(c=o.audioCodec)?void 0:c.indexOf("mp4a.40.34"))&&(Qm||(Qm=/chrome|firefox/i.test(navigator.userAgent)),Qm&&(o.audioCodec=void 0));const{AUDIO:m,CODECS:g,"FRAME-RATE":y,"PATHWAY-ID":E,RESOLUTION:x,SUBTITLES:S}=h,L=`${E||"."}-${o.bitrate}-${x}-${y}-${g}`;s=r[L],s?s.addFallback(o):(s=new Ym(o),r[L]=s,n.push(s)),Jm(s,"audio",m),Jm(s,"text",S)}),this.filterAndSortMediaOptions(n,t)}filterAndSortMediaOptions(e,t){let n=[],r=[],s=!1,o=!1,c=!1,h=e.filter(({audioCodec:x,videoCodec:S,width:R,height:L,unknownCodecs:G})=>(s||(s=!(!R||!L)),o||(o=!!S),c||(c=!!x),!(null!=G&&G.length)&&(!x||fT(x,"audio"))&&(!S||fT(S,"video"))));if((s||o)&&c&&(h=h.filter(({videoCodec:x,width:S,height:R})=>!!x||!(!S||!R))),0===h.length)return void Promise.resolve().then(()=>{if(this.hls){const x=new Error("no level with compatible codecs found in manifest");this.hls.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Re.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:x,reason:x.message})}});t.audioTracks&&(n=t.audioTracks.filter(x=>!x.audioCodec||fT(x.audioCodec,"audio")),w0(n)),t.subtitles&&(r=t.subtitles,w0(r));const m=h.slice(0);h.sort((x,S)=>x.attrs["HDCP-LEVEL"]!==S.attrs["HDCP-LEVEL"]?(x.attrs["HDCP-LEVEL"]||"")>(S.attrs["HDCP-LEVEL"]||"")?1:-1:x.bitrate!==S.bitrate?x.bitrate-S.bitrate:x.attrs["FRAME-RATE"]!==S.attrs["FRAME-RATE"]?x.attrs.decimalFloatingPoint("FRAME-RATE")-S.attrs.decimalFloatingPoint("FRAME-RATE"):x.attrs.SCORE!==S.attrs.SCORE?x.attrs.decimalFloatingPoint("SCORE")-S.attrs.decimalFloatingPoint("SCORE"):s&&x.height!==S.height?x.height-S.height:0);let g=m[0];if(this.steering&&(h=this.steering.filterParsedLevels(h),h.length!==m.length))for(let x=0;x<m.length;x++)if(m[x].pathwayId===h[0].pathwayId){g=m[x];break}this._levels=h;for(let x=0;x<h.length;x++)if(h[x]===g){this._firstLevel=x,this.log(`manifest loaded, ${h.length} level(s) found, first bitrate: ${g.bitrate}`);break}const E={levels:h,audioTracks:n,subtitleTracks:r,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:c,video:o,altAudio:!(c&&!o)&&n.some(x=>!!x.url)};this.hls.trigger(N.MANIFEST_PARSED,E),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return 0===this._levels.length?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(0===t.length)return;if(e<0||e>=t.length){const g=new Error("invalid level idx"),y=e<0;if(this.hls.trigger(N.ERROR,{type:an.OTHER_ERROR,details:Re.LEVEL_SWITCH_ERROR,level:e,fatal:y,error:g,reason:g.message}),y)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,r=this.currentLevel,s=r?r.attrs["PATHWAY-ID"]:void 0,o=t[e],c=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,n===e&&o.details&&r&&s===c)return;this.log(`Switching to level ${e}${c?" with Pathway "+c:""} from level ${n}${s?" with Pathway "+s:""}`);const h=Sr({},o,{level:e,maxBitrate:o.maxBitrate,attrs:o.attrs,uri:o.uri,urlId:o.urlId});delete h._attrs,delete h._urlId,this.hls.trigger(N.LEVEL_SWITCHING,h);const m=o.details;if(!m||m.live){const g=this.switchParams(o.uri,r?.details);this.loadPlaylist(g)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(void 0===this._startLevel){const e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===qn.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragLoaded(e,{frag:t}){if(void 0!==t&&t.type===ln.MAIN){const n=this._levels[t.level];void 0!==n&&(n.loadError=0)}}onLevelLoaded(e,t){var n;const{level:r,details:s}=t,o=this._levels[r];var c;if(!o)return this.warn(`Invalid level index ${r}`),void(null!=(c=t.deliveryDirectives)&&c.skip&&(s.deltaUpdateFailed=!0));r===this.currentLevelIndex?(0===o.fragmentError&&(o.loadError=0),this.playlistLoaded(r,t,o.details)):null!=(n=t.deliveryDirectives)&&n.skip&&(s.deltaUpdateFailed=!0)}onAudioTrackSwitched(e,t){const n=this.currentLevel;if(!n)return;const r=this.hls.audioTracks[t.id].groupId;if(n.audioGroupIds&&n.audioGroupId!==r){let s=-1;for(let o=0;o<n.audioGroupIds.length;o++)if(n.audioGroupIds[o]===r){s=o;break}-1!==s&&s!==n.urlId&&(n.urlId=s,this.canLoad&&this.startLoad())}}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){const r=n.urlId;let s=n.uri;if(e)try{s=e.addDirectives(s)}catch(c){this.warn(`Could not construct new URL with HLS Delivery Directives: ${c}`)}const o=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${void 0!==e?.msn?" at sn "+e.msn+" part "+e.part:""} with${o?" Pathway "+o:""} URI ${r+1}/${n.url.length} ${s}`),this.clearTimer(),this.hls.trigger(N.LEVEL_LOADING,{url:s,level:t,id:r,deliveryDirectives:e||null})}}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}removeLevel(e,t){const n=(s,o)=>o!==t,r=this._levels.filter((s,o)=>o!==e||(s.url.length>1&&void 0!==t?(s.url=s.url.filter(n),s.audioGroupIds&&(s.audioGroupIds=s.audioGroupIds.filter(n)),s.textGroupIds&&(s.textGroupIds=s.textGroupIds.filter(n)),s.urlId=0,!0):(this.steering&&this.steering.removeLevel(s),!1)));this.hls.trigger(N.LEVELS_UPDATED,{levels:r})}onLevelsUpdated(e,{levels:t}){t.forEach((n,r)=>{const{details:s}=n;null!=s&&s.fragments&&s.fragments.forEach(o=>{o.level=r})}),this._levels=t}}function Jm(i,e,t){t&&("audio"===e?(i.audioGroupIds||(i.audioGroupIds=[]),i.audioGroupIds[i.url.length-1]=t):"text"===e&&(i.textGroupIds||(i.textGroupIds=[]),i.textGroupIds[i.url.length-1]=t))}function w0(i){const e={};i.forEach(t=>{const n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}class pk{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(N.BUFFER_APPENDED,this.onBufferAppended,this),e.on(N.FRAG_BUFFERED,this.onFragBuffered,this),e.on(N.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(N.BUFFER_APPENDED,this.onBufferAppended,this),e.off(N.FRAG_BUFFERED,this.onFragBuffered,this),e.off(N.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let r=n.length;r--;){const s=n[r];if(!s)break;const o=s.end;if(s.start<=e&&null!==o&&e<=o)return s}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:n}=this,r=Object.keys(n);for(let s=r.length;s--;){const o=n[r[s]];if(o?.body.type===t&&o.buffered){const c=o.body;if(c.start<=e&&e<=c.end)return c}}return null}detectEvictedFragments(e,t,n,r){this.timeRanges&&(this.timeRanges[e]=t);const s=r?.fragment.sn||-1;Object.keys(this.fragments).forEach(o=>{const c=this.fragments[o];if(!c||s>=c.body.sn)return;if(!c.buffered&&!c.loaded)return void(c.body.type===n&&this.removeFragment(c.body));const h=c.range[e];h&&h.time.some(m=>{const g=!this.isTimeBuffered(m.startPTS,m.endPTS,t);return g&&this.removeFragment(c.body),g})})}detectPartialFragments(e){const t=this.timeRanges,{frag:n,part:r}=e;if(!t||"initSegment"===n.sn)return;const s=nu(n),o=this.fragments[s];if(!o||o.buffered&&n.gap)return;const c=!n.relurl;Object.keys(t).forEach(h=>{const m=n.elementaryStreams[h];m&&(o.range[h]=this.getBufferedTimes(n,r,c||!0===m.partial,t[h]))}),o.loaded=null,Object.keys(o.range).length?(o.buffered=!0,(o.body.endList=n.endList||o.body.endList)&&(this.endListFragments[o.body.type]=o),Jg(o)||this.removeParts(n.sn-1,n.type)):this.removeFragment(o.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=n.filter(r=>r.fragment.sn>=e))}fragBuffered(e,t){const n=nu(e);let r=this.fragments[n];!r&&t&&(r=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,r.buffered=!0)}getBufferedTimes(e,t,n,r){const s={time:[],partial:n},o=e.start,c=e.end,h=e.minEndPTS||c,m=e.maxStartPTS||o;for(let g=0;g<r.length;g++){const y=r.start(g)-this.bufferPadding,E=r.end(g)+this.bufferPadding;if(m>=y&&h<=E){s.time.push({startPTS:Math.max(o,r.start(g)),endPTS:Math.min(c,r.end(g))});break}if(o<E&&c>y)s.partial=!0,s.time.push({startPTS:Math.max(o,r.start(g)),endPTS:Math.min(c,r.end(g))});else if(c<=y)break}return s}getPartialFragment(e){let n,r,s,t=null,o=0;const{bufferPadding:c,fragments:h}=this;return Object.keys(h).forEach(m=>{const g=h[m];g&&Jg(g)&&(r=g.body.start-c,s=g.body.end+c,e>=r&&e<=s&&(n=Math.min(e-r,s-e),o<=n&&(t=g.body,o=n)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return void 0!==t&&(t.buffered||Jg(t))}getState(e){const t=nu(e),n=this.fragments[t];return n?n.buffered?Jg(n)?"PARTIAL":"OK":"APPENDING":"NOT_LOADED"}isTimeBuffered(e,t,n){let r,s;for(let o=0;o<n.length;o++){if(r=n.start(o)-this.bufferPadding,s=n.end(o)+this.bufferPadding,e>=r&&t<=s)return!0;if(t<=r)return!1}return!1}onFragLoaded(e,t){const{frag:n,part:r}=t;if("initSegment"===n.sn||n.bitrateTest)return;const s=r?null:t,o=nu(n);this.fragments[o]={body:n,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:r,timeRanges:s}=t;if("initSegment"===n.sn)return;const o=n.type;if(r){let c=this.activePartLists[o];c||(this.activePartLists[o]=c=[]),c.push(r)}this.timeRanges=s,Object.keys(s).forEach(c=>{this.detectEvictedFragments(c,s[c],o,r)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=nu(e);return!!this.fragments[t]}hasParts(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)}removeFragmentsInRange(e,t,n,r,s){r&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const c=this.fragments[o];if(!c)return;const h=c.body;h.type!==n||r&&!h.gap||h.start<t&&h.end>e&&(c.buffered||s)&&this.removeFragment(h)})}removeFragment(e){const t=nu(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const r=e.sn;this.activePartLists[e.type]=n.filter(s=>s.fragment.sn!==r)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function Jg(i){var e,t,n;return i.buffered&&(i.body.gap||(null==(e=i.range.video)?void 0:e.partial)||(null==(t=i.range.audio)?void 0:t.partial)||(null==(n=i.range.audiovideo)?void 0:n.partial))}function nu(i){return`${i.type}_${i.level}_${i.urlId}_${i.sn}`}const AT=Math.pow(2,17);class kT{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new nc({type:an.NETWORK_ERROR,details:Re.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a "+(n?"part list":"url")),networkDetails:null}));this.abort();const r=this.config,s=r.fLoader,o=r.loader;return new Promise((c,h)=>{if(this.loader&&this.loader.destroy(),e.gap){if(e.tagList.some(x=>"GAP"===x[0]))return void h(MT(e));e.gap=!1}const m=this.loader=e.loader=s?new s(r):new o(r),g=RT(e),y=TT(r.fragLoadPolicy.default),E={loadPolicy:y,timeout:y.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:AT};e.stats=m.stats,m.load(g,E,{onSuccess:(x,S,R,L)=>{this.resetLoader(e,m);let G=x.data;R.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(G.slice(0,16)),G=G.slice(16)),c({frag:e,part:null,payload:G,networkDetails:L})},onError:(x,S,R,L)=>{this.resetLoader(e,m),h(new nc({type:an.NETWORK_ERROR,details:Re.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Yr({url:n,data:void 0},x),error:new Error(`HTTP Error ${x.code} ${x.text}`),networkDetails:R,stats:L}))},onAbort:(x,S,R)=>{this.resetLoader(e,m),h(new nc({type:an.NETWORK_ERROR,details:Re.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:R,stats:x}))},onTimeout:(x,S,R)=>{this.resetLoader(e,m),h(new nc({type:an.NETWORK_ERROR,details:Re.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${E.timeout}ms`),networkDetails:R,stats:x}))},onProgress:(x,S,R,L)=>{t&&t({frag:e,part:null,payload:R,networkDetails:L})}})})}loadPart(e,t,n){this.abort();const r=this.config,s=r.fLoader,o=r.loader;return new Promise((c,h)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap)return void h(MT(e,t));const m=this.loader=e.loader=s?new s(r):new o(r),g=RT(e,t),y=TT(r.fragLoadPolicy.default),E={loadPolicy:y,timeout:y.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:AT};t.stats=m.stats,m.load(g,E,{onSuccess:(x,S,R,L)=>{this.resetLoader(e,m),this.updateStatsFromPart(e,t);const G={frag:e,part:t,payload:x.data,networkDetails:L};n(G),c(G)},onError:(x,S,R,L)=>{this.resetLoader(e,m),h(new nc({type:an.NETWORK_ERROR,details:Re.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Yr({url:g.url,data:void 0},x),error:new Error(`HTTP Error ${x.code} ${x.text}`),networkDetails:R,stats:L}))},onAbort:(x,S,R)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,m),h(new nc({type:an.NETWORK_ERROR,details:Re.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:R,stats:x}))},onTimeout:(x,S,R)=>{this.resetLoader(e,m),h(new nc({type:an.NETWORK_ERROR,details:Re.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${E.timeout}ms`),networkDetails:R,stats:x}))}})})}updateStatsFromPart(e,t){const n=e.stats,r=t.stats,s=r.total;if(n.loaded+=r.loaded,s){const h=Math.round(e.duration/t.duration),m=Math.min(Math.round(n.loaded/s),h),y=(h-m)*Math.round(n.loaded/m);n.total=n.loaded+y}else n.total=Math.max(n.loaded,n.total);const o=n.loading,c=r.loading;o.start?o.first+=c.first-c.start:(o.start=c.start,o.first=c.first),o.end=c.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function RT(i,e=null){const t=e||i,n={frag:i,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},r=t.byteRangeStartOffset,s=t.byteRangeEndOffset;if(Wt(r)&&Wt(s)){var o;let c=r,h=s;if("initSegment"===i.sn&&"AES-128"===(null==(o=i.decryptdata)?void 0:o.method)){const m=s-r;m%16&&(h=s+(16-m%16)),0!==r&&(n.resetIV=!0,c=r-16)}n.rangeStart=c,n.rangeEnd=h}return n}function MT(i,e){const t=new Error(`GAP ${i.gap?"tag":"attribute"} found`),n={type:an.MEDIA_ERROR,details:Re.FRAG_GAP,fatal:!1,frag:i,error:t,networkDetails:null};return e&&(n.part=e),(e||i).stats.aborted=!0,new nc(n)}class nc extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class gk{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const t in this.keyUriToKeyInfo){const n=this.keyUriToKeyInfo[t].loader;if(n){if(e&&e!==n.context.frag.type)return;n.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=Re.KEY_LOAD_ERROR,n,r,s){return new nc({type:an.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:s,error:n,networkDetails:r})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:r}=e;for(let s=0;s<t.length;s++){const o=t[s];if(r<=o.cc&&("initSegment"===n||"initSegment"===o.sn||n<o.sn)){this.emeController.selectKeySystemFormat(o).then(c=>{o.setKeyFormat(c)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,r;t&&e.setKeyFormat(t);const s=e.decryptdata;if(!s){const m=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,Re.KEY_LOAD_ERROR,m))}const o=s.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,Re.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));let c=this.keyUriToKeyInfo[o];if(null!=(n=c)&&n.decryptdata.key)return s.key=c.decryptdata.key,Promise.resolve({frag:e,keyInfo:c});var h;if(null!=(r=c)&&r.keyLoadPromise)switch(null==(h=c.mediaKeySessionContext)?void 0:h.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return c.keyLoadPromise.then(m=>(s.key=m.keyInfo.decryptdata.key,{frag:e,keyInfo:c}))}switch(c=this.keyUriToKeyInfo[o]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===s.keyFormat?this.loadKeyHTTP(c,e):this.loadKeyEME(c,e);case"AES-128":return this.loadKeyHTTP(c,e);default:return Promise.reject(this.createKeyLoadError(e,Re.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const r=this.emeController.loadKey(n);if(r)return(e.keyLoadPromise=r.then(s=>(e.mediaKeySessionContext=s,n))).catch(s=>{throw e.keyLoadPromise=null,s})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,s=new(0,n.loader)(n);return t.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((o,c)=>{const h={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},m=n.keyLoadPolicy.default;s.load(h,{loadPolicy:m,timeout:m.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},{onSuccess:(E,x,S,R)=>{const{frag:L,keyInfo:G,url:Y}=S;if(!L.decryptdata||G!==this.keyUriToKeyInfo[Y])return c(this.createKeyLoadError(L,Re.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),R));G.decryptdata.key=L.decryptdata.key=new Uint8Array(E.data),L.keyLoader=null,G.loader=null,o({frag:L,keyInfo:G})},onError:(E,x,S,R)=>{this.resetLoader(x),c(this.createKeyLoadError(t,Re.KEY_LOAD_ERROR,new Error(`HTTP Error ${E.code} loading key ${E.text}`),S,Yr({url:h.url,data:void 0},E)))},onTimeout:(E,x,S)=>{this.resetLoader(x),c(this.createKeyLoadError(t,Re.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),S))},onAbort:(E,x,S)=>{this.resetLoader(x),c(this.createKeyLoadError(t,Re.INTERNAL_ABORTED,new Error("key loading aborted"),S))}})})}resetLoader(e){const{frag:t,keyInfo:n,url:r}=e,s=n.loader;t.keyLoader===s&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[r],s&&s.destroy()}}class _k{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}const yk={length:0,start:()=>0,end:()=>0};class Ei{static isBuffered(e,t){try{if(e){const n=Ei.getBuffered(e);for(let r=0;r<n.length;r++)if(t>=n.start(r)&&t<=n.end(r))return!0}}catch{}return!1}static bufferInfo(e,t,n){try{if(e){const r=Ei.getBuffered(e),s=[];let o;for(o=0;o<r.length;o++)s.push({start:r.start(o),end:r.end(o)});return this.bufferedInfo(s,t,n)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.sort(function(m,g){return m.start-g.start||g.end-m.end});let r=[];if(n)for(let m=0;m<e.length;m++){const g=r.length;if(g){const y=r[g-1].end;e[m].start-y<n?e[m].end>y&&(r[g-1].end=e[m].end):r.push(e[m])}else r.push(e[m])}else r=e;let o,s=0,c=t,h=t;for(let m=0;m<r.length;m++){const g=r[m].start,y=r[m].end;if(t+n>=g&&t<y)c=g,h=y,s=h-t;else if(t+n<g){o=g;break}}return{len:s,start:c||0,end:h||0,nextStart:o}}static getBuffered(e){try{return e.buffered}catch(t){return ae.log("failed to get media.buffered",t),yk}}}class E0{constructor(e,t,n,r=0,s=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=e,this.sn=t,this.id=n,this.size=r,this.part=s,this.partial=o}}function x0(i,e){let t=null;for(let n=0,r=i.length;n<r;n++){const s=i[n];if(s&&s.cc===e){t=s;break}}return t}function T0(i,e){if(i){const t=i.start+e;i.start=i.startPTS=t,i.endPTS=t+i.duration}}function I0(i,e){const t=e.fragments;for(let n=0,r=t.length;n<r;n++)T0(t[n],i);e.fragmentHint&&T0(e.fragmentHint,i),e.alignedSliding=!0}function e_(i,e){if(!i.hasProgramDateTime||!e.hasProgramDateTime)return;const t=i.fragments,n=e.fragments;if(!t.length||!n.length)return;const s=n[Math.round(n.length/2)-1],o=x0(t,s.cc)||t[Math.round(t.length/2)-1],c=s.programDateTime,h=o.programDateTime;null!==c&&null!==h&&I0((h-c)/1e3-(o.start-s.start),i)}class OT{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class S0{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}class Tk{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let r=0;r<4;r++)n[r]=t.getUint32(4*r);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,r=n[0],s=n[1],o=n[2],c=n[3],h=this.invSubMix,m=h[0],g=h[1],y=h[2],E=h[3],x=new Uint32Array(256);let S=0,R=0,L=0;for(L=0;L<256;L++)x[L]=L<128?L<<1:L<<1^283;for(L=0;L<256;L++){let G=R^R<<1^R<<2^R<<3^R<<4;G=G>>>8^255&G^99,e[S]=G,t[G]=S;const Y=x[S],K=x[Y],te=x[K];let oe=257*x[G]^16843008*G;r[S]=oe<<24|oe>>>8,s[S]=oe<<16|oe>>>16,o[S]=oe<<8|oe>>>24,c[S]=oe,oe=16843009*te^65537*K^257*Y^16843008*S,m[G]=oe<<24|oe>>>8,g[G]=oe<<16|oe>>>16,y[G]=oe<<8|oe>>>24,E[G]=oe,S?(S=Y^x[x[x[te^Y]]],R^=x[x[R]]):S=R=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,r=0;for(;r<t.length&&n;)n=t[r]===this.key[r],r++;if(n)return;this.key=t;const s=this.keySize=t.length;if(4!==s&&6!==s&&8!==s)throw new Error("Invalid aes key size="+s);const o=this.ksRows=4*(s+6+1);let c,h;const m=this.keySchedule=new Uint32Array(o),g=this.invKeySchedule=new Uint32Array(o),y=this.sBox,E=this.rcon,x=this.invSubMix,S=x[0],R=x[1],L=x[2],G=x[3];let Y,K;for(c=0;c<o;c++)c<s?Y=m[c]=t[c]:(K=Y,c%s==0?(K=K<<8|K>>>24,K=y[K>>>24]<<24|y[K>>>16&255]<<16|y[K>>>8&255]<<8|y[255&K],K^=E[c/s|0]<<24):s>6&&c%s==4&&(K=y[K>>>24]<<24|y[K>>>16&255]<<16|y[K>>>8&255]<<8|y[255&K]),m[c]=Y=(m[c-s]^K)>>>0);for(h=0;h<o;h++)c=o-h,K=3&h?m[c]:m[c-4],g[h]=h<4||c<=4?K:S[y[K>>>24]]^R[y[K>>>16&255]]^L[y[K>>>8&255]]^G[y[255&K]],g[h]=g[h]>>>0}networkToHostOrderSwap(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}decrypt(e,t,n){const r=this.keySize+6,s=this.invKeySchedule,o=this.invSBox,c=this.invSubMix,h=c[0],m=c[1],g=c[2],y=c[3],E=this.uint8ArrayToUint32Array_(n);let x=E[0],S=E[1],R=E[2],L=E[3];const G=new Int32Array(e),Y=new Int32Array(G.length);let K,te,oe,Ae,we,We,ot,Le,Qt,vt,Bn,Or,mi,ct;const _t=this.networkToHostOrderSwap;for(;t<G.length;){for(Qt=_t(G[t]),vt=_t(G[t+1]),Bn=_t(G[t+2]),Or=_t(G[t+3]),we=Qt^s[0],We=Or^s[1],ot=Bn^s[2],Le=vt^s[3],mi=4,ct=1;ct<r;ct++)K=h[we>>>24]^m[We>>16&255]^g[ot>>8&255]^y[255&Le]^s[mi],te=h[We>>>24]^m[ot>>16&255]^g[Le>>8&255]^y[255&we]^s[mi+1],oe=h[ot>>>24]^m[Le>>16&255]^g[we>>8&255]^y[255&We]^s[mi+2],Ae=h[Le>>>24]^m[we>>16&255]^g[We>>8&255]^y[255&ot]^s[mi+3],we=K,We=te,ot=oe,Le=Ae,mi+=4;K=o[we>>>24]<<24^o[We>>16&255]<<16^o[ot>>8&255]<<8^o[255&Le]^s[mi],te=o[We>>>24]<<24^o[ot>>16&255]<<16^o[Le>>8&255]<<8^o[255&we]^s[mi+1],oe=o[ot>>>24]<<24^o[Le>>16&255]<<16^o[we>>8&255]<<8^o[255&We]^s[mi+2],Ae=o[Le>>>24]<<24^o[we>>16&255]<<16^o[We>>8&255]<<8^o[255&ot]^s[mi+3],Y[t]=_t(K^x),Y[t+1]=_t(Ae^S),Y[t+2]=_t(oe^R),Y[t+3]=_t(te^L),x=Qt,S=vt,R=Bn,L=Or,t+=4}return Y.buffer}}class A0{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}null===this.subtle&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?function xk(i){const e=i.byteLength,t=e&&new DataView(i.buffer).getUint8(e-1);return t?tc(i,0,e-t):i}(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n){return this.useSoftware?new Promise((r,s)=>{this.softwareDecrypt(new Uint8Array(e),t,n);const o=this.flush();o?r(o.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n)}softwareDecrypt(e,t,n){const{currentIV:r,currentResult:s,remainderData:o}=this;this.logOnce("JS AES decrypt"),o&&(e=ld(o,e),this.remainderData=null);const c=this.getValidChunk(e);if(!c.length)return null;r&&(n=r);let h=this.softwareDecrypter;h||(h=this.softwareDecrypter=new Tk),h.expandKey(t);const m=s;return this.currentResult=h.decrypt(c.buffer,0,n),this.currentIV=tc(c,-16).buffer,m||null}webCryptoDecrypt(e,t,n){const r=this.subtle;return(this.key!==t||!this.fastAesKey)&&(this.key=t,this.fastAesKey=new S0(r,t)),this.fastAesKey.expandKey().then(s=>r?(this.logOnce("WebCrypto AES decrypt"),new OT(r,new Uint8Array(n)).decrypt(e.buffer,s)):Promise.reject(new Error("web crypto not initialized"))).catch(s=>(ae.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${s.name}: ${s.message}`),this.onWebCryptoError(e,t,n)))}onWebCryptoError(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);const r=this.flush();if(r)return r.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%16;return n!==e.length&&(t=tc(e,0,n),this.remainderData=tc(e,n)),t}logOnce(e){this.logEnabled&&(ae.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}class t_ extends _k{constructor(e,t,n,r,s){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state="STOPPED",this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=s,this.logPrefix=r,this.log=ae.log.bind(ae,`${r}:`),this.warn=ae.warn.bind(ae,`${r}:`),this.hls=e,this.fragmentLoader=new kT(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new A0(e.config),e.on(N.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state="STOPPED"}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const n=t.partList;if(null!=n&&n.length){const s=n[n.length-1];return Ei.isBuffered(this.media,s.start+s.duration/2)}return this.fragmentTracker.isEndListAppended(t.fragments[t.fragments.length-1].type)}getLevelDetails(){var e;if(this.levels&&null!==this.levelLastLoaded)return null==(e=this.levels[this.levelLastLoaded])?void 0:e.details}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);const r=this.config;this.levels&&r.autoStartLoad&&"STOPPED"===this.state&&this.startLoad(r.startPosition)}onMediaDetaching(){const e=this.media;null!=e&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:n,mediaBuffer:r,state:s}=this,o=n?n.currentTime:0,c=Ei.bufferInfo(r||n,o,e.maxBufferHole);if(this.log(`media seeking to ${Wt(o)?o.toFixed(3):o}, state: ${s}`),"ENDED"===this.state)this.resetLoadingState();else if(t){const h=e.maxFragLookUpTolerance,m=t.start-h,g=t.start+t.duration+h;if(!c.len||g<c.start||m>c.end){const y=o>g;(o<m||y)&&(y&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(o,1/0,this.playlistType,!0),this.lastCurrentTime=o),!this.loadedmetadata&&!c.len&&(this.nextLoadPosition=this.startPosition=o),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.stopLoad(),super.onHandlerDestroying()}onHandlerDestroyed(){this.state="STOPPED",this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){this._doFragLoad(e,t,n,s=>{if(this.fragContextChanged(e))return this.warn(`Fragment ${e.sn}${s.part?" p: "+s.part.index:""} of level ${e.level} was dropped during download.`),void this.fragmentTracker.removeFragment(e);e.stats.chunkCount++,this._handleFragmentLoadProgress(s)}).then(s=>{if(!s)return;const o=this.state;this.fragContextChanged(e)?("FRAG_LOADING"===o||!this.fragCurrent&&"PARSING"===o)&&(this.fragmentTracker.removeFragment(e),this.state="IDLE"):("payload"in s&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(N.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s))}).catch(s=>{"STOPPED"===this.state||"ERROR"===this.state||(this.warn(s),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if("APPENDING"===n.getState(e)){const o=this.getFwdBufferInfo(this.mediaBuffer,e.type),c=Math.max(e.duration,o?o.len:this.config.maxBufferLength);this.reduceMaxBufferLength(c)&&n.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),"PARTIAL"===n.getState(e)&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,n=null){e-t&&this.hls.trigger(N.BUFFER_FLUSHING,{startOffset:e,endOffset:t,type:n})}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{if(!n||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:r}=this,{payload:s}=n,o=e.decryptdata;if(s&&s.byteLength>0&&o&&o.key&&o.iv&&"AES-128"===o.method){const c=self.performance.now();return this.decrypter.decrypt(new Uint8Array(s),o.key.buffer,o.iv.buffer).catch(h=>{throw r.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Re.FRAG_DECRYPT_ERROR,fatal:!1,error:h,reason:h.message,frag:e}),h}).then(h=>{const m=self.performance.now();return r.trigger(N.FRAG_DECRYPTED,{frag:e,payload:h,stats:{tstart:c,tdecrypt:m}}),n.payload=h,n})}return n}).then(n=>{const{fragCurrent:r,hls:s,levels:o}=this;if(!o)throw new Error("init load aborted, missing levels");const c=e.stats;this.state="IDLE",t.fragmentError=0,e.data=new Uint8Array(n.payload),c.parsing.start=c.buffering.start=self.performance.now(),c.parsing.end=c.buffering.end=self.performance.now(),n.frag===r&&s.trigger(N.FRAG_BUFFERED,{stats:c,frag:r,part:null,id:e.type}),this.tick()}).catch(n=>{"STOPPED"===this.state||"ERROR"===this.state||(this.warn(n),this.resetFragmentLoading(e))})}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.level!==t.level||e.sn!==t.sn||e.urlId!==t.urlId}fragBufferedComplete(e,t){var n,r,s,o;const c=this.mediaBuffer?this.mediaBuffer:this.media;this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===ln.MAIN?"level":"track"} ${e.level} (frag:[${(null!=(n=e.startPTS)?n:NaN).toFixed(3)}-${(null!=(r=e.endPTS)?r:NaN).toFixed(3)}] > buffer:${c?function(i){let e="";const t=i.length;for(let n=0;n<t;n++)e+=`[${i.start(n).toFixed(3)}-${i.end(n).toFixed(3)}]`;return e}(Ei.getBuffered(c)):"(detached)"})`),this.state="IDLE",c&&(!this.loadedmetadata&&e.type==ln.MAIN&&c.buffered.length&&(null==(s=this.fragCurrent)?void 0:s.sn)===(null==(o=this.fragPrevious)?void 0:o.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:r,partsLoaded:s}=e,o=!s||0===s.length||s.some(h=>!h),c=new E0(n.level,n.sn,n.stats.chunkCount+1,0,r?r.index:-1,!o);t.flush(c)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,r){var s;const o=t?.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let c=null;if(!e.encrypted||null!=(s=e.decryptdata)&&s.key?!e.encrypted&&o.encryptedFragments.length&&this.keyLoader.loadClear(e,o.encryptedFragments):(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${"[stream-controller]"===this.logPrefix?"level":"track"} ${e.level}`),this.state="KEY_LOADING",this.fragCurrent=e,c=this.keyLoader.load(e).then(g=>{if(!this.fragContextChanged(g.frag))return this.hls.trigger(N.KEY_LOADED,g),"KEY_LOADING"===this.state&&(this.state="IDLE"),g}),this.hls.trigger(N.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(c=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&"initSegment"!==e.sn){const g=o.partList;if(g&&r){n>e.end&&o.fragmentHint&&(e=o.fragmentHint);const y=this.getNextPart(g,e,n);if(y>-1){const E=g[y];let x;return this.log(`Loading part sn: ${e.sn} p: ${E.index} cc: ${e.cc} of playlist [${o.startSN}-${o.endSN}] parts [0-${y}-${g.length-1}] ${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=E.start+E.duration,this.state="FRAG_LOADING",x=c?c.then(S=>!S||this.fragContextChanged(S.frag)?null:this.doFragPartsLoad(e,E,t,r)).catch(S=>this.handleFragLoadError(S)):this.doFragPartsLoad(e,E,t,r).catch(S=>this.handleFragLoadError(S)),this.hls.trigger(N.FRAG_LOADING,{frag:e,part:E,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):x}if(!e.url||this.loadedEndOfParts(g,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${o?"of ["+o.startSN+"-"+o.endSN+"] ":""}${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),Wt(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state="FRAG_LOADING";const h=this.config.progressive;let m;return m=h&&c?c.then(g=>!g||this.fragContextChanged(g?.frag)?null:this.fragmentLoader.load(e,r)).catch(g=>this.handleFragLoadError(g)):Promise.all([this.fragmentLoader.load(e,h?r:void 0),c]).then(([g])=>(!h&&g&&r&&r(g),g)).catch(g=>this.handleFragLoadError(g)),this.hls.trigger(N.FRAG_LOADING,{frag:e,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):m}doFragPartsLoad(e,t,n,r){return new Promise((s,o)=>{var c;const h=[],m=null==(c=n.details)?void 0:c.partList,g=y=>{this.fragmentLoader.loadPart(e,y,r).then(E=>{h[y.index]=E;const x=E.part;this.hls.trigger(N.FRAG_LOADED,E);const S=ET(n,e.sn,y.index+1)||_0(m,e.sn,y.index+1);if(!S)return s({frag:e,part:x,partsLoaded:h});g(S)}).catch(o)};g(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===Re.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(N.ERROR,t)}else this.hls.trigger(N.ERROR,{type:an.OTHER_ERROR,details:Re.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||"PARSING"!==this.state)return void(!this.fragCurrent&&"STOPPED"!==this.state&&"ERROR"!==this.state&&(this.state="IDLE"));const{frag:n,part:r,level:s}=t,o=self.performance.now();n.stats.parsing.end=o,r&&(r.stats.parsing.end=o),this.updateLevelTiming(n,r,s,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:r,sn:s,part:o}=e;if(null==t||!t[r])return this.warn(`Levels object was unset while buffering fragment ${s} of level ${r}. The current chunk will not be buffered.`),null;const c=t[r],h=o>-1?ET(c,s,o):null,m=h?h.fragment:function dk(i,e,t){if(null==i||!i.details)return null;const n=i.details;let r=n.fragments[e-n.startSN];return r||(r=n.fragmentHint,r&&r.sn===e)?r:e<n.startSN&&t&&t.sn===e?t:null}(c,s,n);return m?(n&&n!==m&&(m.stats=n.stats),{frag:m,part:h,level:c}):null}bufferFragmentData(e,t,n,r,s){var o;if(!e||"PARSING"!==this.state)return;const{data1:c,data2:h}=e;let m=c;if(c&&h&&(m=ld(c,h)),null!=(o=m)&&o.length&&(this.hls.trigger(N.BUFFER_APPENDING,{type:e.type,frag:t,part:n,chunkMeta:r,parent:t.type,data:m}),e.dropped&&e.independent&&!n)){if(s)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Ei.isBuffered(t,t.currentTime))return void this.flushMainBuffer(0,e.start);const n=t.currentTime,r=Ei.bufferInfo(t,n,0),o=Math.min(2*this.config.maxFragLookUpTolerance,.25*e.duration),c=Math.max(Math.min(e.start-o,r.end-o),n+o);e.start-c>o&&this.flushMainBuffer(c,e.start)}getFwdBufferInfo(e,t){const n=this.getLoadPosition();return Wt(n)?this.getFwdBufferInfoAtPos(e,n,t):null}getFwdBufferInfoAtPos(e,t,n){const{config:{maxBufferHole:r}}=this,s=Ei.bufferInfo(e,t,r);if(0===s.len&&void 0!==s.nextStart){const o=this.fragmentTracker.getBufferedFrag(t,n);if(o&&s.nextStart<o.end)return Ei.bufferInfo(e,t,Math.max(s.nextStart,r))}return s}getMaxBufferLength(e){const{config:t}=this;let n;return n=e?Math.max(8*t.maxBufferSize/e,t.maxBufferLength):t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e){const t=this.config;return t.maxMaxBufferLength>=(e||t.maxBufferLength)&&(t.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${t.maxMaxBufferLength}s`),!0)}getAppendedFrag(e,t=ln.MAIN){const n=this.fragmentTracker.getAppendedFrag(e,ln.MAIN);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,r=n.length;if(!r)return null;const{config:s}=this,o=n[0].start;let c;if(t.live){const h=s.initialLiveManifestSize;if(r<h)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${h})`),null;!t.PTSKnown&&!this.startFragRequested&&-1===this.startPosition&&(c=this.getInitialLiveFragment(t,n),this.startPosition=c?this.hls.liveSyncPosition||c.start:e)}else e<=o&&(c=n[0]);return c||(c=this.getFragmentAtPosition(e,s.lowLatencyMode?t.partEnd:t.fragmentEnd,t)),this.mapToInitFragWhenRequired(c)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return("OK"===n||"PARTIAL"===n&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,r,s){const o=e.gap,c=this.getNextFragment(this.nextLoadPosition,t);if(null===c)return c;if(e=c,o&&e&&!e.gap&&n.nextStart){const h=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,r);if(null!==h&&n.len+h.len>=s)return this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment}getNextPart(e,t,n){let r=-1,s=!1,o=!0;for(let c=0,h=e.length;c<h;c++){const m=e[c];if(o=o&&!m.independent,r>-1&&n<m.start)break;const g=m.loaded;g?r=-1:(s||m.independent||o)&&m.fragment===t&&(r=c),s=g}return r}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let r=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),r=function CT(i,e,t){if(null===e||!Array.isArray(i)||!i.length||!Wt(e))return null;if(e<(i[0].programDateTime||0))return null;if(e>=(i[i.length-1].endProgramDateTime||0))return null;t=t||0;for(let s=0;s<i.length;++s){const o=i[s];if(Xm(e,t,o))return o}return null}(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){const s=n.sn+1;if(s>=e.startSN&&s<=e.endSN){const o=t[s-e.startSN];n.cc===o.cc&&(r=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}r||(r=function hk(i,e){return IT.search(i,t=>t.cc<e?1:t.cc>e?-1:0)}(t,n.cc),r&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`))}}else{const s=this.hls.liveSyncPosition;null!==s&&(r=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r}getFragmentAtPosition(e,t,n){const{config:r}=this;let{fragPrevious:s}=this,{fragments:o,endSN:c}=n;const{fragmentHint:h}=n,m=r.maxFragLookUpTolerance,g=n.partList,y=!!(r.lowLatencyMode&&null!=g&&g.length&&h);let E;if(y&&h&&!this.bitrateTest&&(o=o.concat(h),c=h.sn),E=e<t?Zm(s,o,e,e>t-m?0:m):o[o.length-1],E){const x=E.sn-n.startSN,S=this.fragmentTracker.getState(E);if(("OK"===S||"PARTIAL"===S&&E.gap)&&(s=E),s&&E.sn===s.sn&&(!y||g[0].fragment.sn>E.sn)&&s&&E.level===s.level){const L=o[x+1];E=E.sn<c&&"OK"!==this.fragmentTracker.getState(L)?L:null}}return E}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const r=this.hls.liveSyncPosition,s=n.currentTime,c=e.edge,h=s>=e.fragments[0].start-t.maxFragLookUpTolerance&&s<=c;null!==r&&n.duration>r&&(s<r||!h)&&(!h&&n.readyState<4||s<c-(void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration))&&(this.loadedmetadata||(this.nextLoadPosition=r),n.readyState&&(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${c}, reset currentTime to : ${r.toFixed(3)}`),n.currentTime=r))}alignPlaylists(e,t){const{levels:n,levelLastLoaded:r,fragPrevious:s}=this,o=null!==r?n[r]:null,c=e.fragments.length;if(!c)return this.warn("No fragments in live playlist"),0;const h=e.fragments[0].start,m=!t,g=e.alignedSliding&&Wt(h);if(m||!g&&!h){!function wk(i,e,t){e&&(function Ek(i,e,t){if(function vk(i,e,t){return!(!e.details||!(t.endCC>t.startCC||i&&i.cc<t.startCC))}(i,t,e)){const n=function bk(i,e,t=0){const n=i.fragments,r=e.fragments;if(!r.length||!n.length)return void ae.log("No fragments to align");const s=x0(n,r[0].cc);if(s&&(!s||s.startPTS))return s;ae.log("No frag in previous level to align on")}(t.details,e);n&&Wt(n.start)&&(ae.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),I0(n.start,e))}}(i,t,e),!t.alignedSliding&&e.details&&function C0(i,e){if(!e.fragments.length||!i.hasProgramDateTime||!e.hasProgramDateTime)return;const t=e.fragments[0].programDateTime,n=i.fragments[0].programDateTime,r=(n-t)/1e3+e.fragments[0].start;r&&Wt(r)&&(ae.log(`Adjusting PTS using programDateTime delta ${n-t}ms, sliding:${r.toFixed(3)} ${i.url} `),I0(r,i))}(t,e.details),!t.alignedSliding&&e.details&&!t.skippedSegments&&uk(e.details,t))}(s,o,e);const y=e.fragments[0].start;return this.log(`Live playlist sliding: ${y.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${s?s.sn:"na"} fragments: ${c}`),y}return h}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)}setStartPosition(e,t){let n=this.startPosition;if(n<t&&(n=-1),-1===n||-1===this.lastCurrentTime){const r=null!==this.startTimeOffset,s=r?this.startTimeOffset:e.startTimeOffset;null!==s&&Wt(s)?(n=t+s,s<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Start time offset ${s} found in ${r?"multivariant":"media"} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&"initSegment"!==e.sn&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&"FRAG_LOADING_WAITING_RETRY"!==this.state)&&(this.state="IDLE")}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const y=this.getCurrentContext(t.chunkMeta);y&&(t.frag=y.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;var r;if(this.fragContextChanged(n))return void this.warn(`Frag load error must match current frag to retry ${n.url} > ${null==(r=this.fragCurrent)?void 0:r.url}`);const s=t.details===Re.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(n,!0);const o=t.errorAction,{action:c,retryCount:h=0,retryConfig:m}=o||{};if(o&&5===c&&m){var g;this.resetStartWhenNotLoaded(null!=(g=this.levelLastLoaded)?g:n.level);const y=y0(m,h);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${h+1}/${m.maxNumRetry} in ${y}ms`),o.resolved=!0,this.retryDate=self.performance.now()+y,this.state="FRAG_LOADING_WAITING_RETRY"}else m&&o?(this.resetFragmentErrors(e),h<m.maxNumRetry?s||(o.resolved=!0):ae.warn(`${t.details} reached or exceeded max retry (${h})`)):this.state=2===o?.action?"WAITING_LEVEL":"ERROR";this.tickImmediate()}reduceLengthAndFlushBuffer(e){if("PARSING"===this.state||"PARSED"===this.state){const t=e.parent,n=this.getFwdBufferInfo(this.mediaBuffer,t),r=n&&n.len>.5;r&&this.reduceMaxBufferLength(n.len);const s=!r;return s&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${t} buffer`),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),s}return!1}resetFragmentErrors(e){e===ln.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),"STOPPED"!==this.state&&(this.state="IDLE")}afterBufferFlushed(e,t,n){if(!e)return;const r=Ei.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,n),"ENDED"===this.state&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state="IDLE"}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=this.levels?this.levels[e].details:null;null!=t&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){var t;this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(null!=(t=this.levelLastLoaded)?t:e.level),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,r){var s;const o=n.details;if(o){if(Object.keys(e.elementaryStreams).reduce((h,m)=>{const g=e.elementaryStreams[m];if(g){const y=g.endPTS-g.startPTS;if(y<=0)return this.warn(`Could not parse fragment ${e.sn} ${m} duration reliably (${y})`),h||!1;const E=r?0:wT(o,e,g.startPTS,g.endPTS,g.startDTS,g.endDTS);return this.hls.trigger(N.LEVEL_PTS_UPDATED,{details:o,level:n,drift:E,type:m,frag:e,start:g.startPTS,end:g.endPTS}),!0}return h},!1))n.fragmentError=0;else if(null===(null==(s=this.transmuxer)?void 0:s.error)){const h=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(0===n.fragmentError&&(n.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(h.message),this.hls.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Re.FRAG_PARSING_ERROR,fatal:!1,error:h,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state="PARSED",this.hls.trigger(N.FRAG_PARSED,{frag:e,part:t})}else this.warn("level.details undefined")}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){var t,n,r;"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(null!=(t=null!=(n=this.levelLastLoaded)?n:null==(r=this.fragCurrent)?void 0:r.level)?t:0),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function LT(){return self.SourceBuffer||self.WebKitSourceBuffer}function hl(i="",e=9e4){return{type:i,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class M0{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=ld(this.cachedData,e),this.cachedData=null);let s,n=jm(e,0),r=n?n.length:0;const o=this._audioTrack,c=this._id3Track,h=n?(i=>{const e=Xx(i);for(let t=0;t<e.length;t++){const n=e[t];if(Jv(n))return t0(n)}})(n):void 0,m=e.length;for((null===this.basePTS||0===this.frameIndex&&Wt(h))&&(this.basePTS=O0(h,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),n&&n.length>0&&c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:"org.id3",duration:Number.POSITIVE_INFINITY});r<m;){if(this.canParse(e,r)){const g=this.appendFrame(o,e,r);g?(this.frameIndex++,this.lastPTS=g.sample.pts,r+=g.length,s=r):r=m}else qA(e,r)?(n=jm(e,r),c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:"org.id3",duration:Number.POSITIVE_INFINITY}),r+=n.length,s=r):r++;if(r===m&&s!==m){const g=tc(e,s);this.cachedData=this.cachedData?ld(this.cachedData,g):g}}return{audioTrack:o,videoTrack:hl(),id3Track:c,textTrack:hl()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:hl(),id3Track:this._id3Track,textTrack:hl()}}destroy(){}}const O0=(i,e,t)=>Wt(i)?90*i:9e4*e+(t?9e4*t.baseTime/t.timescale:0);function P0(i,e){return 255===i[e]&&240==(246&i[e+1])}function L0(i,e){return 1&i[e+1]?7:9}function n_(i,e){return(3&i[e+3])<<11|i[e+4]<<3|(224&i[e+5])>>>5}function i_(i,e){return e+1<i.length&&P0(i,e)}function Dk(i,e){if(i_(i,e)){const t=L0(i,e);if(e+t>=i.length)return!1;const n=n_(i,e);if(n<=t)return!1;const r=e+n;return r===i.length||i_(i,r)}return!1}function N0(i,e,t,n,r){if(!i.samplerate){const s=function FT(i,e,t,n){let r,s,o,c;const h=navigator.userAgent.toLowerCase(),m=n,g=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];r=1+((192&e[t+2])>>>6);const y=(60&e[t+2])>>>2;if(!(y>g.length-1))return o=(1&e[t+2])<<2,o|=(192&e[t+3])>>>6,ae.log(`manifest codec:${n}, ADTS type:${r}, samplingIndex:${y}`),/firefox/i.test(h)?y>=6?(r=5,c=new Array(4),s=y-3):(r=2,c=new Array(2),s=y):-1!==h.indexOf("android")?(r=2,c=new Array(2),s=y):(r=5,c=new Array(4),n&&(-1!==n.indexOf("mp4a.40.29")||-1!==n.indexOf("mp4a.40.5"))||!n&&y>=6?s=y-3:((n&&-1!==n.indexOf("mp4a.40.2")&&(y>=6&&1===o||/vivaldi/i.test(h))||!n&&1===o)&&(r=2,c=new Array(2)),s=y)),c[0]=r<<3,c[0]|=(14&y)>>1,c[1]|=(1&y)<<7,c[1]|=o<<3,5===r&&(c[1]|=(14&s)>>1,c[2]=(1&s)<<7,c[2]|=8,c[3]=0),{config:c,samplerate:g[y],channelCount:o,codec:"mp4a.40."+r,manifestCodec:m};i.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Re.FRAG_PARSING_ERROR,fatal:!0,reason:`invalid ADTS sampling index:${y}`})}(e,t,n,r);if(!s)return;i.config=s.config,i.samplerate=s.samplerate,i.channelCount=s.channelCount,i.codec=s.codec,i.manifestCodec=s.manifestCodec,ae.log(`parsed codec:${i.codec}, rate:${s.samplerate}, channels:${s.channelCount}`)}}function Ak(i){return 9216e4/i}function UT(i,e,t,n,r){const o=n+r*Ak(i.samplerate),c=function BT(i,e){const t=L0(i,e);if(e+t<=i.length){const n=n_(i,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}(e,t);let h;if(c){const{frameLength:y,headerLength:E}=c,x=E+y,S=Math.max(0,t+x-e.length);S?(h=new Uint8Array(x-E),h.set(e.subarray(t+E,e.length),0)):h=e.subarray(t+E,t+x);const R={unit:h,pts:o};return S||i.samples.push(R),{sample:R,length:x,missing:S}}const m=e.length-t;return h=new Uint8Array(m),h.set(e.subarray(t,e.length),0),{sample:{unit:h,pts:o},length:m,missing:-1}}const XP=/\/emsg[-/]ID3/i;let r_=null;const VT=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Mk=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Ok=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Pk=[0,1,1,4];function $T(i,e,t,n,r){if(t+24>e.length)return;const s=HT(e,t);if(s&&t+s.frameLength<=e.length){const c=n+r*(9e4*s.samplesPerFrame/s.sampleRate),h={unit:e.subarray(t,t+s.frameLength),pts:c,dts:c};return i.config=[],i.channelCount=s.channelCount,i.samplerate=s.sampleRate,i.samples.push(h),{sample:h,length:s.frameLength,missing:0}}}function HT(i,e){const t=i[e+1]>>3&3,n=i[e+1]>>1&3,r=i[e+2]>>4&15,s=i[e+2]>>2&3;if(1!==t&&0!==r&&15!==r&&3!==s){const c=i[e+3]>>6,m=1e3*VT[14*(3===t?3-n:3===n?3:4)+r-1],y=Mk[3*(3===t?0:2===t?1:2)+s],E=3===c?1:2,x=Ok[t][n],S=Pk[n],R=8*x*S,L=Math.floor(x*m/y+(i[e+2]>>1&1))*S;if(null===r_){const K=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);r_=K?parseInt(K[1]):0}return!!r_&&r_<=87&&2===n&&m>=224e3&&0===c&&(i[e+3]=128|i[e+3]),{sampleRate:y,channelCount:E,frameLength:L,samplesPerFrame:R}}}function F0(i,e){return 255===i[e]&&224==(224&i[e+1])&&0!=(6&i[e+1])}function jT(i,e){return e+1<i.length&&F0(i,e)}function Nk(i,e){if(e+1<i.length&&F0(i,e)){const n=HT(i,e);let r=4;null!=n&&n.frameLength&&(r=n.frameLength);const s=e+r;return s===i.length||jT(i,s)}return!1}class qh{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,r=new Uint8Array(4),s=Math.min(4,t);if(0===s)throw new Error("no bytes available");r.set(e.subarray(n,n+s)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=8*s,this.bytesAvailable-=s}skipBits(e){let t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(t=(e-=this.bitsAvailable)>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&ae.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let r,t=8,n=8;for(let s=0;s<e;s++)0!==n&&(r=this.readEG(),n=(t+r+256)%256),t=0===n?t:n}readSPS(){let s,o,c,e=0,t=0,n=0,r=0;const h=this.readUByte.bind(this),m=this.readBits.bind(this),g=this.readUEG.bind(this),y=this.readBoolean.bind(this),E=this.skipBits.bind(this),x=this.skipEG.bind(this),S=this.skipUEG.bind(this),R=this.skipScalingList.bind(this);h();const L=h();if(m(5),E(3),h(),S(),100===L||110===L||122===L||244===L||44===L||83===L||86===L||118===L||128===L){const Ae=g();if(3===Ae&&E(1),S(),S(),E(1),y())for(o=3!==Ae?8:12,c=0;c<o;c++)y()&&R(c<6?16:64)}S();const G=g();if(0===G)g();else if(1===G)for(E(1),x(),x(),s=g(),c=0;c<s;c++)x();S(),E(1);const Y=g(),K=g(),te=m(1);0===te&&E(1),E(1),y()&&(e=g(),t=g(),n=g(),r=g());let oe=[1,1];if(y()&&y())switch(h()){case 1:oe=[1,1];break;case 2:oe=[12,11];break;case 3:oe=[10,11];break;case 4:oe=[16,11];break;case 5:oe=[40,33];break;case 6:oe=[24,11];break;case 7:oe=[20,11];break;case 8:oe=[32,11];break;case 9:oe=[80,33];break;case 10:oe=[18,11];break;case 11:oe=[15,11];break;case 12:oe=[64,33];break;case 13:oe=[160,99];break;case 14:oe=[4,3];break;case 15:oe=[3,2];break;case 16:oe=[2,1];break;case 255:oe=[h()<<8|h(),h()<<8|h()]}return{width:Math.ceil(16*(Y+1)-2*e-2*t),height:(2-te)*(K+1)*16-(te?2:4)*(n+r),pixelRatio:oe}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class GT{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new A0(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,n){const r=e[t].unit;if(r.length<=16)return;const s=r.subarray(16,r.length-r.length%16),o=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(o).then(c=>{const h=new Uint8Array(c);r.set(h,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)})}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length)return void n();if(!(e[t].unit.length<32||(this.decryptAacSample(e,t,n),this.decrypter.isSync())))return}}getAvcEncryptedData(e){const t=16*Math.floor((e.length-48)/160)+16,n=new Int8Array(t);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)n.set(e.subarray(s,s+16),r);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)e.set(n.subarray(r,r+16),s);return e}decryptAvcSample(e,t,n,r,s){const o=o0(s.data),c=this.getAvcEncryptedData(o);this.decryptBuffer(c.buffer).then(h=>{s.data=this.getAvcDecryptedUnit(o,h),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,r)})}decryptAvcSamples(e,t,n,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length)return void r();const s=e[t].units;for(;!(n>=s.length);n++){const o=s[n];if(!(o.data.length<=48||1!==o.type&&5!==o.type||(this.decryptAvcSample(e,t,n,r,o),this.decrypter.isSync())))return}}}}const Xr=188;class ic{constructor(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=e,this.config=t,this.typeSupported=n}static probe(e){const t=ic.syncOffset(e);return t>0&&ae.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),-1!==t}static syncOffset(e){const t=e.length;let n=Math.min(940,e.length-Xr)+1,r=0;for(;r<n;){let s=!1,o=-1,c=0;for(let h=r;h<t;h+=Xr){if(71!==e[h]){if(c)return-1;break}if(c++,-1===o&&(o=h,0!==o&&(n=Math.min(o+18612,e.length-Xr)+1)),s||(s=0===s_(e,h)),s&&c>1&&(0===o&&c>2||h+Xr>n))return o}r++}return-1}static createTrack(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:n0[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}}resetInitSegment(e,t,n,r){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=ic.createTrack("video"),this._audioTrack=ic.createTrack("audio",r),this._id3Track=ic.createTrack("id3"),this._txtTrack=ic.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n,this._duration=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_avcTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null}demux(e,t,n=!1,r=!1){let s;n||(this.sampleAes=null);const o=this._avcTrack,c=this._audioTrack,h=this._id3Track,m=this._txtTrack;let g=o.pid,y=o.pesData,E=c.pid,x=h.pid,S=c.pesData,R=h.pesData,L=null,G=this.pmtParsed,Y=this._pmtId,K=e.length;if(this.remainderData&&(K=(e=ld(this.remainderData,e)).length,this.remainderData=null),K<Xr&&!r)return this.remainderData=e,{audioTrack:c,videoTrack:o,id3Track:h,textTrack:m};const te=Math.max(0,ic.syncOffset(e));K-=(K-te)%Xr,K<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,K,e.buffer.byteLength-K));let oe=0;for(let we=te;we<K;we+=Xr)if(71===e[we]){const We=!!(64&e[we+1]),ot=s_(e,we);let Qt;if((48&e[we+3])>>4>1){if(Qt=we+5+e[we+4],Qt===we+Xr)continue}else Qt=we+4;switch(ot){case g:We&&(y&&(s=np(y))&&this.parseAVCPES(o,m,s,!1),y={data:[],size:0}),y&&(y.data.push(e.subarray(Qt,we+Xr)),y.size+=we+Xr-Qt);break;case E:if(We){if(S&&(s=np(S)))switch(c.segmentCodec){case"aac":this.parseAACPES(c,s);break;case"mp3":this.parseMPEGPES(c,s)}S={data:[],size:0}}S&&(S.data.push(e.subarray(Qt,we+Xr)),S.size+=we+Xr-Qt);break;case x:We&&(R&&(s=np(R))&&this.parseID3PES(h,s),R={data:[],size:0}),R&&(R.data.push(e.subarray(Qt,we+Xr)),R.size+=we+Xr-Qt);break;case 0:We&&(Qt+=e[Qt]+1),Y=this._pmtId=zT(e,Qt);break;case Y:{We&&(Qt+=e[Qt]+1);const vt=Fk(e,Qt,this.typeSupported,n);g=vt.avc,g>0&&(o.pid=g),E=vt.audio,E>0&&(c.pid=E,c.segmentCodec=vt.segmentCodec),x=vt.id3,x>0&&(h.pid=x),null!==L&&!G&&(ae.warn(`MPEG-TS PMT found at ${we} after unknown PID '${L}'. Backtracking to sync byte @${te} to parse all TS packets.`),L=null,we=te-188),G=this.pmtParsed=!0;break}case 17:case 8191:break;default:L=ot}}else oe++;if(oe>0){const we=new Error(`Found ${oe} TS packet/s that do not start with 0x47`);this.observer.emit(N.ERROR,N.ERROR,{type:an.MEDIA_ERROR,details:Re.FRAG_PARSING_ERROR,fatal:!1,error:we,reason:we.message})}o.pesData=y,c.pesData=S,h.pesData=R;const Ae={audioTrack:c,videoTrack:o,id3Track:h,textTrack:m};return r&&this.extractRemainingSamples(Ae),Ae}flush(){const{remainderData:e}=this;let t;return this.remainderData=null,t=e?this.demux(e,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:r,textTrack:s}=e,o=n.pesData,c=t.pesData,h=r.pesData;let m;if(o&&(m=np(o))?(this.parseAVCPES(n,s,m,!0),n.pesData=null):n.pesData=o,c&&(m=np(c))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,m);break;case"mp3":this.parseMPEGPES(t,m)}t.pesData=null}else null!=c&&c.size&&ae.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=c;h&&(m=np(h))?(this.parseID3PES(r,m),r.pesData=null):r.pesData=h}demuxSampleAes(e,t,n){const r=this.demux(e,n,!0,!this.config.progressive),s=this.sampleAes=new GT(this.observer,this.config,t);return this.decrypt(r,s)}decrypt(e,t){return new Promise(n=>{const{audioTrack:r,videoTrack:s}=e;r.samples&&"aac"===r.segmentCodec?t.decryptAacSamples(r.samples,0,()=>{s.samples?t.decryptAvcSamples(s.samples,0,0,()=>{n(e)}):n(e)}):s.samples&&t.decryptAvcSamples(s.samples,0,0,()=>{n(e)})})}destroy(){this._duration=0}parseAVCPES(e,t,n,r){const s=this.parseAVCNALu(e,n.data);let c,o=this.avcSample,h=!1;n.data=null,o&&s.length&&!e.audFound&&(Yh(o,e),o=this.avcSample=tp(!1,n.pts,n.dts,"")),s.forEach(m=>{var g;switch(m.type){case 1:{let E=!1;c=!0;const x=m.data;if(h&&x.length>4){const S=new qh(x).readSliceType();(2===S||4===S||7===S||9===S)&&(E=!0)}var y;E&&null!=(y=o)&&y.frame&&!o.key&&(Yh(o,e),o=this.avcSample=null),o||(o=this.avcSample=tp(!0,n.pts,n.dts,"")),o.frame=!0,o.key=E;break}case 5:c=!0,null!=(g=o)&&g.frame&&!o.key&&(Yh(o,e),o=this.avcSample=null),o||(o=this.avcSample=tp(!0,n.pts,n.dts,"")),o.key=!0,o.frame=!0;break;case 6:c=!0,s0(m.data,1,n.pts,t.samples);break;case 7:if(c=!0,h=!0,!e.sps){const E=m.data,S=new qh(E).readSPS();e.width=S.width,e.height=S.height,e.pixelRatio=S.pixelRatio,e.sps=[E],e.duration=this._duration;const R=E.subarray(1,4);let L="avc1.";for(let G=0;G<3;G++){let Y=R[G].toString(16);Y.length<2&&(Y="0"+Y),L+=Y}e.codec=L}break;case 8:c=!0,e.pps||(e.pps=[m.data]);break;case 9:c=!1,e.audFound=!0,o&&Yh(o,e),o=this.avcSample=tp(!1,n.pts,n.dts,"");break;case 12:c=!0;break;default:c=!1,o&&(o.debug+="unknown NAL "+m.type+" ")}o&&c&&o.units.push(m)}),r&&o&&(Yh(o,e),this.avcSample=null)}getLastNalUnit(e){var t;let r,n=this.avcSample;if((!n||0===n.units.length)&&(n=e[e.length-1]),null!=(t=n)&&t.units){const s=n.units;r=s[s.length-1]}return r}parseAVCNALu(e,t){const n=t.byteLength;let r=e.naluState||0;const s=r,o=[];let h,m,g,c=0,y=-1,E=0;for(-1===r&&(y=0,E=31&t[0],r=0,c=1);c<n;)if(h=t[c++],r)if(1!==r)if(h)if(1===h){if(y>=0){const x={data:t.subarray(y,c-r-1),type:E};o.push(x)}else{const x=this.getLastNalUnit(e.samples);if(x&&(s&&c<=4-s&&x.state&&(x.data=x.data.subarray(0,x.data.byteLength-s)),m=c-r-1,m>0)){const S=new Uint8Array(x.data.byteLength+m);S.set(x.data,0),S.set(t.subarray(0,m),x.data.byteLength),x.data=S,x.state=0}}c<n?(g=31&t[c],y=c,E=g,r=0):r=-1}else r=0;else r=3;else r=h?0:2;else r=h?0:1;if(y>=0&&r>=0){const x={data:t.subarray(y,n),type:E,state:r};o.push(x)}if(0===o.length){const x=this.getLastNalUnit(e.samples);if(x){const S=new Uint8Array(x.data.byteLength+t.byteLength);S.set(x.data,0),S.set(t,x.data.byteLength),x.data=S}}return e.naluState=r,o}parseAACPES(e,t){let n=0;const r=this.aacOverFlow;let o,c,h,s=t.data;if(r){this.aacOverFlow=null;const y=r.missing,E=r.sample.unit.byteLength;if(-1===y){const x=new Uint8Array(E+s.byteLength);x.set(r.sample.unit,0),x.set(s,E),s=x}else{const x=E-y;r.sample.unit.set(s.subarray(0,y),x),e.samples.push(r.sample),n=r.missing}}for(o=n,c=s.length;o<c-1&&!i_(s,o);o++);if(o!==n){let y;const E=o<c-1;y=E?`AAC PES did not start with ADTS header,offset:${o}`:"No ADTS header found in AAC PES";const x=new Error(y);if(ae.warn(`parsing error: ${y}`),this.observer.emit(N.ERROR,N.ERROR,{type:an.MEDIA_ERROR,details:Re.FRAG_PARSING_ERROR,fatal:!1,levelRetry:E,error:x,reason:y}),!E)return}if(N0(e,this.observer,s,o,this.audioCodec),void 0!==t.pts)h=t.pts;else{if(!r)return void ae.warn("[tsdemuxer]: AAC PES unknown PTS");{const y=Ak(e.samplerate);h=r.sample.pts+y}}let g,m=0;for(;o<c;){if(g=UT(e,s,o,h,m),o+=g.length,g.missing){this.aacOverFlow=g;break}for(m++;o<c-1&&!i_(s,o);o++);}}parseMPEGPES(e,t){const n=t.data,r=n.length;let s=0,o=0;const c=t.pts;if(void 0!==c)for(;o<r;)if(jT(n,o)){const h=$T(e,n,o,c,s);if(!h)break;o+=h.length,s++}else o++;else ae.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseID3PES(e,t){if(void 0===t.pts)return void ae.warn("[tsdemuxer]: ID3 PES unknown PTS");const n=Sr({},t,{type:this._avcTrack?Jo_emsg:"org.id3",duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function tp(i,e,t,n){return{key:i,frame:!1,pts:e,dts:t,units:[],debug:n,length:0}}function s_(i,e){return((31&i[e+1])<<8)+i[e+2]}function zT(i,e){return(31&i[e+10])<<8|i[e+11]}function Fk(i,e,t,n){const r={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},o=e+3+((15&i[e+1])<<8|i[e+2])-4;for(e+=12+((15&i[e+10])<<8|i[e+11]);e<o;){const h=s_(i,e);switch(i[e]){case 207:if(!n){ae.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===r.audio&&(r.audio=h);break;case 21:-1===r.id3&&(r.id3=h);break;case 219:if(!n){ae.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===r.avc&&(r.avc=h);break;case 3:case 4:!0!==t.mpeg&&!0!==t.mp3?ae.log("MPEG audio found, not supported in this browser"):-1===r.audio&&(r.audio=h,r.segmentCodec="mp3");break;case 36:ae.warn("Unsupported HEVC stream type found")}e+=5+((15&i[e+3])<<8|i[e+4])}return r}function np(i){let t,n,r,s,o,e=0;const c=i.data;if(!i||0===i.size)return null;for(;c[0].length<19&&c.length>1;){const m=new Uint8Array(c[0].length+c[1].length);m.set(c[0]),m.set(c[1],c[0].length),c[0]=m,c.splice(1,1)}if(t=c[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(n=(t[4]<<8)+t[5],n&&n>i.size-6)return null;const m=t[7];192&m&&(s=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&m?(o=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,s-o>54e5&&(ae.warn(`${Math.round((s-o)/9e4)}s delta between PTS and DTS, align them`),s=o)):o=s),r=t[8];let g=r+9;if(i.size<=g)return null;i.size-=g;const y=new Uint8Array(i.size);for(let E=0,x=c.length;E<x;E++){t=c[E];let S=t.byteLength;if(g){if(g>S){g-=S;continue}t=t.subarray(g),S-=g,g=0}y.set(t,e),e+=S}return n&&(n-=r+3),{data:y,pts:s,dts:o,len:n}}return null}function Yh(i,e){if(i.units.length&&i.frame){if(void 0===i.pts){const t=e.samples,n=t.length;if(!n)return void e.dropped++;{const r=t[n-1];i.pts=r.pts,i.dts=r.dts}}e.samples.push(i)}i.debug.length&&ae.log(i.pts+"/"+i.dts+":"+i.debug)}class KT{static getSilentFrame(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}const iu=Math.pow(2,32)-1;let Zh=(()=>{class i{static init(){let t;for(t in i.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},i.types)i.types.hasOwnProperty(t)&&(i.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);const n=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);i.HDLR_TYPES={video:n,audio:r};const s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);i.STTS=i.STSC=i.STCO=o,i.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),i.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),i.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),i.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const c=new Uint8Array([105,115,111,109]),h=new Uint8Array([97,118,99,49]),m=new Uint8Array([0,0,0,1]);i.FTYP=i.box(i.types.ftyp,c,m,c,h),i.DINF=i.box(i.types.dinf,i.box(i.types.dref,s))}static box(t,...n){let r=8,s=n.length;const o=s;for(;s--;)r+=n[s].byteLength;const c=new Uint8Array(r);for(c[0]=r>>24&255,c[1]=r>>16&255,c[2]=r>>8&255,c[3]=255&r,c.set(t,4),s=0,r=8;s<o;s++)c.set(n[s],r),r+=n[s].byteLength;return c}static hdlr(t){return i.box(i.types.hdlr,i.HDLR_TYPES[t])}static mdat(t){return i.box(i.types.mdat,t)}static mdhd(t,n){n*=t;const r=Math.floor(n/(iu+1)),s=Math.floor(n%(iu+1));return i.box(i.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,s>>24,s>>16&255,s>>8&255,255&s,85,196,0,0]))}static mdia(t){return i.box(i.types.mdia,i.mdhd(t.timescale,t.duration),i.hdlr(t.type),i.minf(t))}static mfhd(t){return i.box(i.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}static minf(t){return i.box(i.types.minf,"audio"===t.type?i.box(i.types.smhd,i.SMHD):i.box(i.types.vmhd,i.VMHD),i.DINF,i.stbl(t))}static moof(t,n,r){return i.box(i.types.moof,i.mfhd(t),i.traf(r,n))}static moov(t){let n=t.length;const r=[];for(;n--;)r[n]=i.trak(t[n]);return i.box.apply(null,[i.types.moov,i.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(i.mvex(t)))}static mvex(t){let n=t.length;const r=[];for(;n--;)r[n]=i.trex(t[n]);return i.box.apply(null,[i.types.mvex,...r])}static mvhd(t,n){n*=t;const r=Math.floor(n/(iu+1)),s=Math.floor(n%(iu+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,s>>24,s>>16&255,s>>8&255,255&s,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return i.box(i.types.mvhd,o)}static sdtp(t){const n=t.samples||[],r=new Uint8Array(4+n.length);let s,o;for(s=0;s<n.length;s++)o=n[s].flags,r[s+4]=o.dependsOn<<4|o.isDependedOn<<2|o.hasRedundancy;return i.box(i.types.sdtp,r)}static stbl(t){return i.box(i.types.stbl,i.stsd(t),i.box(i.types.stts,i.STTS),i.box(i.types.stsc,i.STSC),i.box(i.types.stsz,i.STSZ),i.box(i.types.stco,i.STCO))}static avc1(t){let s,o,c,n=[],r=[];for(s=0;s<t.sps.length;s++)o=t.sps[s],c=o.byteLength,n.push(c>>>8&255),n.push(255&c),n=n.concat(Array.prototype.slice.call(o));for(s=0;s<t.pps.length;s++)o=t.pps[s],c=o.byteLength,r.push(c>>>8&255),r.push(255&c),r=r.concat(Array.prototype.slice.call(o));const h=i.box(i.types.avcC,new Uint8Array([1,n[3],n[4],n[5],255,224|t.sps.length].concat(n).concat([t.pps.length]).concat(r))),m=t.width,g=t.height,y=t.pixelRatio[0],E=t.pixelRatio[1];return i.box(i.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,m>>8&255,255&m,g>>8&255,255&g,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),h,i.box(i.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),i.box(i.types.pasp,new Uint8Array([y>>24,y>>16&255,y>>8&255,255&y,E>>24,E>>16&255,E>>8&255,255&E])))}static esds(t){const n=t.config.length;return new Uint8Array([0,0,0,0,3,23+n,0,1,0,4,15+n,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([n]).concat(t.config).concat([6,1,2]))}static mp4a(t){const n=t.samplerate;return i.box(i.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,255&n,0,0]),i.box(i.types.esds,i.esds(t)))}static mp3(t){const n=t.samplerate;return i.box(i.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,255&n,0,0]))}static stsd(t){return i.box(i.types.stsd,i.STSD,"audio"===t.type?"mp3"===t.segmentCodec&&"mp3"===t.codec?i.mp3(t):i.mp4a(t):i.avc1(t))}static tkhd(t){const n=t.id,r=t.duration*t.timescale,s=t.width,o=t.height,c=Math.floor(r/(iu+1)),h=Math.floor(r%(iu+1));return i.box(i.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,n>>24&255,n>>16&255,n>>8&255,255&n,0,0,0,0,c>>24,c>>16&255,c>>8&255,255&c,h>>24,h>>16&255,h>>8&255,255&h,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,255&s,0,0,o>>8&255,255&o,0,0]))}static traf(t,n){const r=i.sdtp(t),s=t.id,o=Math.floor(n/(iu+1)),c=Math.floor(n%(iu+1));return i.box(i.types.traf,i.box(i.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s])),i.box(i.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,c>>24,c>>16&255,c>>8&255,255&c])),i.trun(t,r.length+16+20+8+16+8+8),r)}static trak(t){return t.duration=t.duration||4294967295,i.box(i.types.trak,i.tkhd(t),i.mdia(t))}static trex(t){const n=t.id;return i.box(i.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(t,n){const r=t.samples||[],s=r.length,o=12+16*s,c=new Uint8Array(o);let h,m,g,y,E,x;for(c.set(["video"===t.type?1:0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,255&s,(n+=8+o)>>>24&255,n>>>16&255,n>>>8&255,255&n],0),h=0;h<s;h++)m=r[h],g=m.duration,y=m.size,E=m.flags,x=m.cts,c.set([g>>>24&255,g>>>16&255,g>>>8&255,255&g,y>>>24&255,y>>>16&255,y>>>8&255,255&y,E.isLeading<<2|E.dependsOn,E.isDependedOn<<6|E.hasRedundancy<<4|E.paddingValue<<1|E.isNonSync,61440&E.degradPrio,15&E.degradPrio,x>>>24&255,x>>>16&255,x>>>8&255,255&x],12+16*h);return i.box(i.types.trun,c)}static initSegment(t){i.types||i.init();const n=i.moov(t),r=new Uint8Array(i.FTYP.byteLength+n.byteLength);return r.set(i.FTYP),r.set(n,i.FTYP.byteLength),r}}return i.types=void 0,i.HDLR_TYPES=void 0,i.STTS=void 0,i.STSC=void 0,i.STCO=void 0,i.STSZ=void 0,i.VMHD=void 0,i.SMHD=void 0,i.STSD=void 0,i.FTYP=void 0,i.DINF=void 0,i})();const Xh=9e4;function B0(i,e,t=1,n=!1){const r=i*e*t;return n?Math.round(r):r}function to(i,e=!1){return B0(i,1e3,1/Xh,e)}let fl,a_=null,V0=null;class Jh{constructor(e,t,n,r=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,null===a_){const o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);a_=o?parseInt(o[1]):0}if(null===V0){const s=navigator.userAgent.match(/Safari\/(\d+)/i);V0=s?parseInt(s[1]):0}}destroy(){}resetTimeStamp(e){ae.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){ae.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){ae.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1}getVideoStartPts(e){let t=!1;const n=e.reduce((r,s)=>{const o=s.pts-r;return o<-4294967296?(t=!0,Fs(r,s.pts)):o>0?r:s.pts},e[0].pts);return t&&ae.debug("PTS rollover detected"),n}remux(e,t,n,r,s,o,c,h){let m,g,y,E,x,S,R=s,L=s;const Y=t.pid>-1,K=t.samples.length,te=e.samples.length>0,oe=c&&K>0||K>1;if((!(e.pid>-1)||te)&&(!Y||oe)||this.ISGenerated||c){this.ISGenerated||(y=this.generateIS(e,t,s,o));const we=this.isVideoContiguous;let ot,We=-1;if(oe&&(We=function Vk(i){for(let e=0;e<i.length;e++)if(i[e].key)return e;return-1}(t.samples),!we&&this.config.forceKeyFrameOnDiscontinuity))if(S=!0,We>0){ae.warn(`[mp4-remuxer]: Dropped ${We} out of ${K} video samples due to a missing keyframe`);const Le=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(We),t.dropped+=We,L+=(t.samples[0].pts-Le)/t.inputTimeScale,ot=L}else-1===We&&(ae.warn(`[mp4-remuxer]: No keyframe found out of ${K} video samples`),S=!1);if(this.ISGenerated){if(te&&oe){const Le=this.getVideoStartPts(t.samples),vt=(Fs(e.samples[0].pts,Le)-Le)/t.inputTimeScale;R+=Math.max(0,vt),L+=Math.max(0,-vt)}if(te){if(e.samplerate||(ae.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),y=this.generateIS(e,t,s,o)),g=this.remuxAudio(e,R,this.isAudioContiguous,o,Y||oe||h===ln.AUDIO?L:void 0),oe){const Le=g?g.endPTS-g.startPTS:0;t.inputTimeScale||(ae.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),y=this.generateIS(e,t,s,o)),m=this.remuxVideo(t,L,we,Le)}}else oe&&(m=this.remuxVideo(t,L,we,0));m&&(m.firstKeyFrame=We,m.independent=-1!==We,m.firstKeyFramePTS=ot)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(x=qT(n,s,this._initPTS,this._initDTS)),r.samples.length&&(E=$0(r,s,this._initPTS))),{audio:g,video:m,initSegment:y,independent:S,text:E,id3:x}}generateIS(e,t,n,r){const s=e.samples,o=t.samples,c=this.typeSupported,h={},m=this._initPTS;let E,x,S,g=!m||r,y="audio/mp4";if(g&&(E=x=1/0),e.config&&s.length&&("mp3"===(e.timescale=e.samplerate,e.segmentCodec)&&(c.mpeg?(y="audio/mpeg",e.codec=""):c.mp3&&(e.codec="mp3")),h.audio={id:"audio",container:y,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&c.mpeg?new Uint8Array(0):Zh.initSegment([e]),metadata:{channelCount:e.channelCount}},g&&(S=e.inputTimeScale,m&&S===m.timescale?g=!1:E=x=s[0].pts-Math.round(S*n))),t.sps&&t.pps&&o.length&&(t.timescale=t.inputTimeScale,h.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Zh.initSegment([t]),metadata:{width:t.width,height:t.height}},g))if(S=t.inputTimeScale,m&&S===m.timescale)g=!1;else{const R=this.getVideoStartPts(o),L=Math.round(S*n);x=Math.min(x,Fs(o[0].dts,R)-L),E=Math.min(E,R-L)}if(Object.keys(h).length)return this.ISGenerated=!0,g?(this._initPTS={baseTime:E,timescale:S},this._initDTS={baseTime:x,timescale:S}):E=S=void 0,{tracks:h,initPTS:E,timescale:S}}remuxVideo(e,t,n,r){const s=e.inputTimeScale,o=e.samples,c=[],h=o.length,m=this._initPTS;let x,S,g=this.nextAvcDts,y=8,E=this.videoSampleDuration,R=Number.POSITIVE_INFINITY,L=Number.NEGATIVE_INFINITY,G=!1;n&&null!==g||(g=t*s-(o[0].pts-Fs(o[0].dts,o[0].pts)));const Y=m.baseTime*s/m.timescale;for(let He=0;He<h;He++){const dt=o[He];dt.pts=Fs(dt.pts-Y,g),dt.dts=Fs(dt.dts-Y,g),dt.dts<o[He>0?He-1:He].dts&&(G=!0)}G&&o.sort(function(He,dt){return He.dts-dt.dts||He.pts-dt.pts}),x=o[0].dts,S=o[o.length-1].dts;const K=S-x,te=K?Math.round(K/(h-1)):E||e.inputTimeScale/30;if(n){const He=x-g,dt=He>te,xn=He<-1;if((dt||xn)&&(ae.warn(dt?`AVC: ${to(He,!0)} ms (${He}dts) hole between fragments detected, filling it`:`AVC: ${to(-He,!0)} ms (${He}dts) overlapping between fragments detected`),!xn||g>=o[0].pts)){x=g;const $n=o[0].pts-He;o[0].dts=x,o[0].pts=$n,ae.log(`Video: First PTS/DTS adjusted: ${to($n,!0)}/${to(x,!0)}, delta: ${to(He,!0)} ms`)}}x=Math.max(0,x);let oe=0,Ae=0;for(let He=0;He<h;He++){const dt=o[He],xn=dt.units,$n=xn.length;let Cn=0;for(let _i=0;_i<$n;_i++)Cn+=xn[_i].data.length;Ae+=Cn,oe+=$n,dt.length=Cn,dt.dts=Math.max(dt.dts,x),R=Math.min(dt.pts,R),L=Math.max(dt.pts,L)}S=o[h-1].dts;const we=Ae+4*oe+8;let We;try{We=new Uint8Array(we)}catch(He){return void this.observer.emit(N.ERROR,N.ERROR,{type:an.MUX_ERROR,details:Re.REMUX_ALLOC_ERROR,fatal:!1,error:He,bytes:we,reason:`fail allocating video mdat ${we}`})}const ot=new DataView(We.buffer);ot.setUint32(0,we),We.set(Zh.types.mdat,4);let Le=!1,Qt=Number.POSITIVE_INFINITY,vt=Number.POSITIVE_INFINITY,Bn=Number.NEGATIVE_INFINITY,Or=Number.NEGATIVE_INFINITY;for(let He=0;He<h;He++){const dt=o[He],xn=dt.units;let Cn,$n=0;for(let Hn=0,oa=xn.length;Hn<oa;Hn++){const aa=xn[Hn],nr=aa.data,hc=aa.data.byteLength;ot.setUint32(y,hc),y+=4,We.set(nr,y),y+=hc,$n+=4+hc}if(He<h-1)E=o[He+1].dts-dt.dts,Cn=o[He+1].pts-dt.pts;else{const Hn=this.config,oa=He>0?dt.dts-o[He-1].dts:te;if(Cn=He>0?dt.pts-o[He-1].pts:te,Hn.stretchShortVideoTrack&&null!==this.nextAudioPts){const aa=Math.floor(Hn.maxBufferHole*s),nr=(r?R+r*s:this.nextAudioPts)-dt.pts;nr>aa?(E=nr-oa,E<0?E=oa:Le=!0,ae.log(`[mp4-remuxer]: It is approximately ${nr/90} ms to the next segment; using duration ${E/90} ms for the last video frame.`)):E=oa}else E=oa}const _i=Math.round(dt.pts-dt.dts);Qt=Math.min(Qt,E),Bn=Math.max(Bn,E),vt=Math.min(vt,Cn),Or=Math.max(Or,Cn),c.push(new H0(dt.key,E,$n,_i))}if(c.length)if(a_){if(a_<70){const He=c[0].flags;He.dependsOn=2,He.isNonSync=0}}else if(V0&&Or-vt<Bn-Qt&&te/Bn<.025&&0===c[0].cts){ae.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let He=x;for(let dt=0,xn=c.length;dt<xn;dt++){const $n=He+c[dt].duration;c[dt].duration=dt<xn-1?$n+c[dt+1].cts-(He+c[dt].cts):dt?c[dt-1].duration:te,c[dt].cts=0,He=$n}}E=Le||!E?te:E,this.nextAvcDts=g=S+E,this.videoSampleDuration=E,this.isVideoContiguous=!0;const _t={data1:Zh.moof(e.sequenceNumber++,x,Sr({},e,{samples:c})),data2:We,startPTS:R/s,endPTS:(L+E)/s,startDTS:x/s,endDTS:g/s,type:"video",hasAudio:!1,hasVideo:!0,nb:c.length,dropped:e.dropped};return e.samples=[],e.dropped=0,_t}remuxAudio(e,t,n,r,s){const o=e.inputTimeScale,h=o/(e.samplerate?e.samplerate:o),m="aac"===e.segmentCodec?1024:1152,g=m*h,y=this._initPTS,E="mp3"===e.segmentCodec&&this.typeSupported.mpeg,x=[],S=void 0!==s;let R=e.samples,L=E?0:8,G=this.nextAudioPts||-1;const Y=t*o,K=y.baseTime*o/y.timescale;if(this.isAudioContiguous=n=n||R.length&&G>0&&(r&&Math.abs(Y-G)<9e3||Math.abs(Fs(R[0].pts-K,Y)-G)<20*g),R.forEach(function(ct){ct.pts=Fs(ct.pts-K,Y)}),!n||G<0){if(R=R.filter(ct=>ct.pts>=0),!R.length)return;G=0===s?0:r&&!S?Math.max(0,Y):R[0].pts}if("aac"===e.segmentCodec){const ct=this.config.maxAudioFramesDrift;for(let _t=0,He=G;_t<R.length;_t++){const dt=R[_t],xn=dt.pts,$n=xn-He,Cn=Math.abs(1e3*$n/o);if($n<=-ct*g&&S)0===_t&&(ae.warn(`Audio frame @ ${(xn/o).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*$n/o)} ms.`),this.nextAudioPts=G=He=xn);else if($n>=ct*g&&Cn<1e4&&S){let _i=Math.round($n/g);He=xn-_i*g,He<0&&(_i--,He+=g),0===_t&&(this.nextAudioPts=G=He),ae.warn(`[mp4-remuxer]: Injecting ${_i} audio frame @ ${(He/o).toFixed(3)}s due to ${Math.round(1e3*$n/o)} ms gap.`);for(let Hn=0;Hn<_i;Hn++){const oa=Math.max(He,0);let aa=KT.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);aa||(ae.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),aa=dt.unit.subarray()),R.splice(_t,0,{unit:aa,pts:oa}),He+=g,_t++}}dt.pts=He,He+=g}}let Ae,te=null,oe=null,we=0,We=R.length;for(;We--;)we+=R[We].unit.byteLength;for(let ct=0,_t=R.length;ct<_t;ct++){const He=R[ct],dt=He.unit;let xn=He.pts;if(null!==oe)x[ct-1].duration=Math.round((xn-oe)/h);else{if(n&&"aac"===e.segmentCodec&&(xn=G),te=xn,!(we>0))return;we+=L;try{Ae=new Uint8Array(we)}catch(Cn){return void this.observer.emit(N.ERROR,N.ERROR,{type:an.MUX_ERROR,details:Re.REMUX_ALLOC_ERROR,fatal:!1,error:Cn,bytes:we,reason:`fail allocating audio mdat ${we}`})}E||(new DataView(Ae.buffer).setUint32(0,we),Ae.set(Zh.types.mdat,4))}Ae.set(dt,L);const $n=dt.byteLength;L+=$n,x.push(new H0(!0,m,$n,0)),oe=xn}const ot=x.length;if(!ot)return;this.nextAudioPts=G=oe+h*x[x.length-1].duration;const Qt=E?new Uint8Array(0):Zh.moof(e.sequenceNumber++,te/h,Sr({},e,{samples:x}));e.samples=[];const vt=te/o,Bn=G/o,mi={data1:Qt,data2:Ae,startPTS:vt,endPTS:Bn,startDTS:vt,endDTS:Bn,type:"audio",hasAudio:!0,hasVideo:!1,nb:ot};return this.isAudioContiguous=!0,mi}remuxEmptyAudio(e,t,n,r){const s=e.inputTimeScale,h=this.nextAudioPts,m=this._initDTS,g=9e4*m.baseTime/m.timescale,y=(null!==h?h:r.startDTS*s)+g,x=s/(e.samplerate?e.samplerate:s)*1024,S=Math.ceil((r.endDTS*s+g-y)/x),R=KT.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(ae.warn("[mp4-remuxer]: remux empty Audio"),!R)return void ae.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");const L=[];for(let G=0;G<S;G++){const Y=y+G*x;L.push({unit:R,pts:Y,dts:Y})}return e.samples=L,this.remuxAudio(e,t,n,!1)}}function Fs(i,e){let t;if(null===e)return i;for(t=e<i?-8589934592:8589934592;Math.abs(i-e)>4294967296;)i+=t;return i}function qT(i,e,t,n){const r=i.samples.length;if(!r)return;const s=i.inputTimeScale;for(let c=0;c<r;c++){const h=i.samples[c];h.pts=Fs(h.pts-t.baseTime*s/t.timescale,e*s)/s,h.dts=Fs(h.dts-n.baseTime*s/n.timescale,e*s)/s}const o=i.samples;return i.samples=[],{samples:o}}function $0(i,e,t){const n=i.samples.length;if(!n)return;const r=i.inputTimeScale;for(let o=0;o<n;o++){const c=i.samples[o];c.pts=Fs(c.pts-t.baseTime*r/t.timescale,e*r)/r}i.samples.sort((o,c)=>o.pts-c.pts);const s=i.samples;return i.samples=[],{samples:s}}class H0{constructor(e,t,n,r){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=r,this.flags=new j0(e)}}class j0{constructor(e){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=e?2:1,this.isNonSync=e?0:1}}function l_(i,e){const t=i?.codec;return t&&t.length>4?t:"hvc1"===t||"hev1"===t?"hvc1.1.6.L120.90":"av01"===t?"av01.0.04M.08":"avc1"===t||e===Wn.VIDEO?"avc1.42e01e":"mp4a.40.5"}try{fl=self.performance.now.bind(self.performance)}catch{ae.debug("Unable to use Performance API on this environment"),fl=typeof self<"u"&&self.Date.now}const ip=[{demux:class Rk{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,r){const s=this.videoTrack=hl("video",1),o=this.audioTrack=hl("audio",1),c=this.txtTrack=hl("text",1);if(this.id3Track=hl("id3",1),this.timeOffset=0,null==e||!e.byteLength)return;const h=rT(e);if(h.video){const{id:m,timescale:g,codec:y}=h.video;s.id=m,s.timescale=c.timescale=g,s.codec=y}if(h.audio){const{id:m,timescale:g,codec:y}=h.audio;o.id=m,o.timescale=g,o.codec=y}c.id=n0.text,s.sampleDuration=0,s.duration=o.duration=r}resetContiguity(){this.remainderData=null}static probe(e){return Kn(e=e.length>16384?e.subarray(0,16384):e,["moof"]).length>0}demux(e,t){this.timeOffset=t;let n=e;const r=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=ld(this.remainderData,e));const c=function tk(i){const e={valid:null,remainder:null},t=Kn(i,["moof"]);if(!t)return e;if(t.length<2)return e.remainder=i,e;const n=t[t.length-1];return e.valid=tc(i,0,n.byteOffset-8),e.remainder=tc(i,n.byteOffset-8),e}(n);this.remainderData=c.remainder,r.samples=c.valid||new Uint8Array}else r.samples=n;const o=this.extractID3Track(r,t);return s.samples=oT(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const r=this.extractID3Track(t,this.timeOffset);return n.samples=oT(e,t),{videoTrack:t,audioTrack:hl(),id3Track:r,textTrack:hl()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const r=Kn(e.samples,["emsg"]);r&&r.forEach(s=>{const o=function lT(i){const e=i[0];let t="",n="",r=0,s=0,o=0,c=0,h=0,m=0;if(0===e){for(;"\0"!==Zr(i.subarray(m,m+1));)t+=Zr(i.subarray(m,m+1)),m+=1;for(t+=Zr(i.subarray(m,m+1)),m+=1;"\0"!==Zr(i.subarray(m,m+1));)n+=Zr(i.subarray(m,m+1)),m+=1;n+=Zr(i.subarray(m,m+1)),m+=1,r=_n(i,12),s=_n(i,16),c=_n(i,20),h=_n(i,24),m=28}else if(1===e){m+=4,r=_n(i,m),m+=4;const y=_n(i,m);m+=4;const E=_n(i,m);for(m+=4,o=2**32*y+E,Number.isSafeInteger(o)||(o=Number.MAX_SAFE_INTEGER,ae.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),c=_n(i,m),m+=4,h=_n(i,m),m+=4;"\0"!==Zr(i.subarray(m,m+1));)t+=Zr(i.subarray(m,m+1)),m+=1;for(t+=Zr(i.subarray(m,m+1)),m+=1;"\0"!==Zr(i.subarray(m,m+1));)n+=Zr(i.subarray(m,m+1)),m+=1;n+=Zr(i.subarray(m,m+1)),m+=1}return{schemeIdUri:t,value:n,timeScale:r,presentationTime:o,presentationTimeDelta:s,eventDuration:c,id:h,payload:i.subarray(m,i.byteLength)}}(s);if(XP.test(o.schemeIdUri)){const c=Wt(o.presentationTime)?o.presentationTime/o.timeScale:t+o.presentationTimeDelta/o.timeScale;let h=4294967295===o.eventDuration?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;h<=.001&&(h=Number.POSITIVE_INFINITY);const m=o.payload;n.samples.push({data:m,len:m.byteLength,dts:c,pts:c,type:Jo_emsg,duration:h})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}},remux:class YT{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,r){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(function ZA(i,e){if(!i||!e)return i;const t=e.keyId;return t&&e.isCommonEncryption&&Kn(i,["moov","trak"]).forEach(r=>{const o=Kn(r,["mdia","minf","stbl","stsd"])[0].subarray(8);let c=Kn(o,["enca"]);const h=c.length>0;h||(c=Kn(o,["encv"])),c.forEach(m=>{Kn(m.subarray(h?28:78),["sinf"]).forEach(E=>{const x=sT(E);if(x){const S=x.subarray(8,24);S.some(R=>0!==R)||(ae.log(`[eme] Patching keyId in 'enc${h?"a":"v"}>sinf>>tenc' box: ${Pa_hexDump(S)} -> ${Pa_hexDump(t)}`),x.set(t,8))}})})}),i}(e,r)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const r=this.initData=rT(e);t||(t=l_(r.audio,Wn.AUDIO)),n||(n=l_(r.video,Wn.VIDEO));const s={};r.audio&&r.video?s.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:r.audio?s.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:r.video?s.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:ae.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=s}remux(e,t,n,r,s,o){var c,h;let{initPTS:m,lastEndTime:g}=this;const y={audio:void 0,video:void 0,text:r,id3:n,initSegment:void 0};Wt(g)||(g=this.lastEndTime=s||0);const E=t.samples;if(null==E||!E.length)return y;const x={initPTS:void 0,timescale:1};let S=this.initData;if(null!=(c=S)&&c.length||(this.generateInitSegment(E),S=this.initData),null==(h=S)||!h.length)return ae.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),y;this.emitInitSegment&&(x.tracks=this.initTracks,this.emitInitSegment=!1);const R=function QA(i,e){let t=0,n=0,r=0;const s=Kn(i,["moof","traf"]);for(let o=0;o<s.length;o++){const c=s[o],h=Kn(c,["tfhd"])[0],g=e[_n(h,4)];if(!g)continue;const y=g.default,E=_n(h,0)|y?.flags;let x=y?.duration;8&E&&(x=_n(h,2&E?12:8));const S=g.timescale||9e4,R=Kn(c,["trun"]);for(let L=0;L<R.length;L++)t=JA(R[L]),!t&&x&&(t=x*_n(R[L],4)),g.type===Wn.VIDEO?n+=t/S:g.type===Wn.AUDIO&&(r+=t/S)}if(0===n&&0===r){let o=0;const c=Kn(i,["sidx"]);for(let h=0;h<c.length;h++){const m=YA(c[h]);null!=m&&m.references&&(o+=m.references.reduce((g,y)=>g+y.info.duration||0,0))}return o}return n||r}(E,S),L=function XA(i,e){return Kn(e,["moof","traf"]).reduce((t,n)=>{const r=Kn(n,["tfdt"])[0],s=r[0],o=Kn(n,["tfhd"]).reduce((c,h)=>{const m=_n(h,4),g=i[m];if(g){let y=_n(r,4);if(1===s){if(y===Gm)return ae.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),c;y*=Gm+1,y+=_n(r,8)}const x=y/(g.timescale||9e4);if(isFinite(x)&&(null===c||x<c))return x}return c},null);return null!==o&&isFinite(o)&&(null===t||o<t)?o:t},null)}(S,E),G=null===L?s:L;(function G0(i,e,t,n){if(null===i)return!0;const r=Math.max(n,1);return Math.abs(e-i.baseTime/i.timescale-t)>r}(m,G,s,R)||x.timescale!==m.timescale&&o)&&(x.initPTS=G-s,m&&1===m.timescale&&ae.warn("Adjusting initPTS by "+(x.initPTS-m.baseTime)),this.initPTS=m={baseTime:x.initPTS,timescale:1});const Y=e?G-m.baseTime/m.timescale:g,K=Y+R;(function ek(i,e,t){Kn(e,["moof","traf"]).forEach(n=>{Kn(n,["tfhd"]).forEach(r=>{const s=_n(r,4),o=i[s];if(!o)return;const c=o.timescale||9e4;Kn(n,["tfdt"]).forEach(h=>{const m=h[0];let g=_n(h,4);if(0===m)g-=t*c,g=Math.max(g,0),r0(h,4,g);else{g*=Math.pow(2,32),g+=_n(h,8),g-=t*c,g=Math.max(g,0);const y=Math.floor(g/(Gm+1)),E=Math.floor(g%(Gm+1));r0(h,4,y),r0(h,8,E)}})})})})(S,E,m.baseTime/m.timescale),R>0?this.lastEndTime=K:(ae.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const te=!!S.audio,oe=!!S.video;let Ae="";te&&(Ae+="audio"),oe&&(Ae+="video");const we={data1:E,startPTS:Y,startDTS:Y,endPTS:K,endDTS:K,type:Ae,hasAudio:te,hasVideo:oe,nb:1,dropped:0};return y.audio="audio"===we.type?we:void 0,y.video="audio"!==we.type?we:void 0,y.initSegment=x,y.id3=qT(n,s,m,m),r.samples.length&&(y.text=$0(r,s,m)),y}}},{demux:ic,remux:Jh},{demux:class kk extends M0{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let n=(jm(e,0)||[]).length;for(let r=e.length;n<r;n++)if(Dk(e,n))return ae.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return function Sk(i,e){return function Ck(i,e){return e+5<i.length}(i,e)&&P0(i,e)&&n_(i,e)<=i.length-e}(e,t)}appendFrame(e,t,n){N0(e,this.observer,t,n,e.manifestCodec);const r=UT(e,t,n,this.basePTS,this.frameIndex);if(r&&0===r.missing)return r}},remux:Jh},{demux:class WT extends M0{resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let n=(jm(e,0)||[]).length;for(let r=e.length;n<r;n++)if(Nk(e,n))return ae.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return function Lk(i,e){return F0(i,e)&&4<=i.length-e}(e,t)}appendFrame(e,t,n){if(null!==this.basePTS)return $T(e,t,n,this.basePTS,this.frameIndex)}},remux:Jh}];class c_{constructor(e,t,n,r,s){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=r,this.id=s}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,r){const s=n.transmuxing;s.executeStart=fl();let o=new Uint8Array(e);const{currentTransmuxState:c,transmuxConfig:h}=this;r&&(this.currentTransmuxState=r);const{contiguous:m,discontinuity:g,trackSwitch:y,accurateTimeOffset:E,timeOffset:x,initSegmentChange:S}=r||c,{audioCodec:R,videoCodec:L,defaultInitPts:G,duration:Y,initSegmentData:K}=h,te=function $k(i,e){let t=null;return i.byteLength>0&&null!=e&&null!=e.key&&null!==e.iv&&null!=e.method&&(t=e),t}(o,t);if(te&&"AES-128"===te.method){const We=this.getDecrypter();if(!We.isSync())return this.decryptionPromise=We.webCryptoDecrypt(o,te.key.buffer,te.iv.buffer).then(ot=>{const Le=this.push(ot,null,n);return this.decryptionPromise=null,Le}),this.decryptionPromise;{let ot=We.softwareDecrypt(o,te.key.buffer,te.iv.buffer);if(n.part>-1&&(ot=We.flush()),!ot)return s.executeEnd=fl(),z0(n);o=new Uint8Array(ot)}}const oe=this.needsProbing(g,y);if(oe){const We=this.configureTransmuxer(o);if(We)return ae.warn(`[transmuxer] ${We.message}`),this.observer.emit(N.ERROR,N.ERROR,{type:an.MEDIA_ERROR,details:Re.FRAG_PARSING_ERROR,fatal:!1,error:We,reason:We.message}),s.executeEnd=fl(),z0(n)}(g||y||S||oe)&&this.resetInitSegment(K,R,L,Y,t),(g||S||oe)&&this.resetInitialTimestamp(G),m||this.resetContiguity();const Ae=this.transmux(o,te,x,E,n),we=this.currentTransmuxState;return we.contiguous=!0,we.discontinuity=!1,we.trackSwitch=!1,s.executeEnd=fl(),Ae}flush(e){const t=e.transmuxing;t.executeStart=fl();const{decrypter:n,currentTransmuxState:r,decryptionPromise:s}=this;if(s)return s.then(()=>this.flush(e));const o=[],{timeOffset:c}=r;if(n){const y=n.flush();y&&o.push(this.push(y,null,e))}const{demuxer:h,remuxer:m}=this;if(!h||!m)return t.executeEnd=fl(),[z0(e)];const g=h.flush(c);return u_(g)?g.then(y=>(this.flushRemux(o,y,e),o)):(this.flushRemux(o,g,e),o)}flushRemux(e,t,n){const{audioTrack:r,videoTrack:s,id3Track:o,textTrack:c}=t,{accurateTimeOffset:h,timeOffset:m}=this.currentTransmuxState;ae.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?" p: "+n.part:""} of level ${n.level}`);const g=this.remuxer.remux(r,s,o,c,m,h,!0,this.id);e.push({remuxResult:g,chunkMeta:n}),n.transmuxing.executeEnd=fl()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,r,s){const{demuxer:o,remuxer:c}=this;!o||!c||(o.resetInitSegment(e,t,n,r),c.resetInitSegment(e,t,n,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,r,s){let o;return o=t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,n,r,s):this.transmuxUnencrypted(e,n,r,s),o}transmuxUnencrypted(e,t,n,r){const{audioTrack:s,videoTrack:o,id3Track:c,textTrack:h}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,o,c,h,t,n,!1,this.id),chunkMeta:r}}transmuxSampleAes(e,t,n,r,s){return this.demuxer.demuxSampleAes(e,t,n).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,n,r,!1,this.id),chunkMeta:s}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:r,vendor:s}=this;let o;for(let y=0,E=ip.length;y<E;y++)if(ip[y].demux.probe(e)){o=ip[y];break}if(!o)return new Error("Failed to find demuxer by probing fragment data");const c=this.demuxer,h=this.remuxer,m=o.remux,g=o.demux;(!h||!(h instanceof m))&&(this.remuxer=new m(n,t,r,s)),(!c||!(c instanceof g))&&(this.demuxer=new g(n,t,r),this.probe=g.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new A0(this.config)),e}}const z0=i=>({remuxResult:{},chunkMeta:i});function u_(i){return"then"in i&&i.then instanceof Function}class Hk{constructor(e,t,n,r,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=r,this.defaultInitPts=s||null}}class ZT{constructor(e,t,n,r,s,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=r,this.timeOffset=s,this.initSegmentChange=o}}var d_={exports:{}};!function(i){var e=Object.prototype.hasOwnProperty,t="~";function n(){}function r(h,m,g){this.fn=h,this.context=m,this.once=g||!1}function s(h,m,g,y,E){if("function"!=typeof g)throw new TypeError("The listener must be a function");var x=new r(g,y||h,E),S=t?t+m:m;return h._events[S]?h._events[S].fn?h._events[S]=[h._events[S],x]:h._events[S].push(x):(h._events[S]=x,h._eventsCount++),h}function o(h,m){0==--h._eventsCount?h._events=new n:delete h._events[m]}function c(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(t=!1)),c.prototype.eventNames=function(){var g,y,m=[];if(0===this._eventsCount)return m;for(y in g=this._events)e.call(g,y)&&m.push(t?y.slice(1):y);return Object.getOwnPropertySymbols?m.concat(Object.getOwnPropertySymbols(g)):m},c.prototype.listeners=function(m){var y=this._events[t?t+m:m];if(!y)return[];if(y.fn)return[y.fn];for(var E=0,x=y.length,S=new Array(x);E<x;E++)S[E]=y[E].fn;return S},c.prototype.listenerCount=function(m){var y=this._events[t?t+m:m];return y?y.fn?1:y.length:0},c.prototype.emit=function(m,g,y,E,x,S){var R=t?t+m:m;if(!this._events[R])return!1;var Y,K,L=this._events[R],G=arguments.length;if(L.fn){switch(L.once&&this.removeListener(m,L.fn,void 0,!0),G){case 1:return L.fn.call(L.context),!0;case 2:return L.fn.call(L.context,g),!0;case 3:return L.fn.call(L.context,g,y),!0;case 4:return L.fn.call(L.context,g,y,E),!0;case 5:return L.fn.call(L.context,g,y,E,x),!0;case 6:return L.fn.call(L.context,g,y,E,x,S),!0}for(K=1,Y=new Array(G-1);K<G;K++)Y[K-1]=arguments[K];L.fn.apply(L.context,Y)}else{var oe,te=L.length;for(K=0;K<te;K++)switch(L[K].once&&this.removeListener(m,L[K].fn,void 0,!0),G){case 1:L[K].fn.call(L[K].context);break;case 2:L[K].fn.call(L[K].context,g);break;case 3:L[K].fn.call(L[K].context,g,y);break;case 4:L[K].fn.call(L[K].context,g,y,E);break;default:if(!Y)for(oe=1,Y=new Array(G-1);oe<G;oe++)Y[oe-1]=arguments[oe];L[K].fn.apply(L[K].context,Y)}}return!0},c.prototype.on=function(m,g,y){return s(this,m,g,y,!1)},c.prototype.once=function(m,g,y){return s(this,m,g,y,!0)},c.prototype.removeListener=function(m,g,y,E){var x=t?t+m:m;if(!this._events[x])return this;if(!g)return o(this,x),this;var S=this._events[x];if(S.fn)S.fn===g&&(!E||S.once)&&(!y||S.context===y)&&o(this,x);else{for(var R=0,L=[],G=S.length;R<G;R++)(S[R].fn!==g||E&&!S[R].once||y&&S[R].context!==y)&&L.push(S[R]);L.length?this._events[x]=1===L.length?L[0]:L:o(this,x)}return this},c.prototype.removeAllListeners=function(m){var g;return m?this._events[g=t?t+m:m]&&o(this,g):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,i.exports=c}(d_);var h_=Nx(d_.exports);const f_=jh()||{isTypeSupported:()=>!1};class W0{constructor(e,t,n,r){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const s=e.config;this.hls=e,this.id=t,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=n,this.onFlush=r;const o=(m,g)=>{(g=g||{}).frag=this.frag,g.id=this.id,m===N.ERROR&&(this.error=g.error),this.hls.trigger(m,g)};this.observer=new h_,this.observer.on(N.FRAG_DECRYPTED,o),this.observer.on(N.ERROR,o);const c={mp4:f_.isTypeSupported("video/mp4"),mpeg:f_.isTypeSupported("audio/mpeg"),mp3:f_.isTypeSupported('audio/mp4; codecs="mp3"')},h=navigator.vendor;if(this.useWorker&&typeof Worker<"u"&&(s.workerPath||function k0(){return"function"==typeof __HLS_WORKER_BUNDLE__}()))try{s.workerPath?(ae.log(`loading Web Worker ${s.workerPath} for "${t}"`),this.workerContext=function R0(i){const e=new self.URL(i,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}(s.workerPath)):(ae.log(`injecting Web Worker for "${t}"`),this.workerContext=function Ik(){const i=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(i);return{worker:new self.Worker(e),objectURL:e}}()),this.onwmsg=y=>this.onWorkerMessage(y);const{worker:g}=this.workerContext;g.addEventListener("message",this.onwmsg),g.onerror=y=>{const E=new Error(`${y.message}  (${y.filename}:${y.lineno})`);s.enableWorker=!1,ae.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(N.ERROR,{type:an.OTHER_ERROR,details:Re.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:E})},g.postMessage({cmd:"init",typeSupported:c,vendor:h,id:t,config:JSON.stringify(s)})}catch(g){ae.warn(`Error setting up "${t}" Web Worker, fallback to inline`,g),this.resetWorker(),this.error=null,this.transmuxer=new c_(this.observer,c,s,h,t)}else this.transmuxer=new c_(this.observer,c,s,h,t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,n,r,s,o,c,h,m,g){var y,E;m.transmuxing.start=self.performance.now();const{transmuxer:x}=this,S=o?o.start:s.start,R=s.decryptdata,L=this.frag,G=!(L&&s.cc===L.cc),Y=!(L&&m.level===L.level),K=L?m.sn-L.sn:-1,te=this.part?m.part-this.part.index:-1,Ae=!Y&&(1===K||0===K&&(1===te||0===K&&m.id>1&&m.id===L?.stats.chunkCount&&te<=0)),we=self.performance.now();(Y||K||0===s.stats.parsing.start)&&(s.stats.parsing.start=we),o&&(te||!Ae)&&(o.stats.parsing.start=we);const We=!(L&&(null==(y=s.initSegment)?void 0:y.url)===(null==(E=L.initSegment)?void 0:E.url)),ot=new ZT(G,Ae,h,Y,S,We);if(!Ae||G||We){ae.log(`[transmuxer-interface, ${s.type}]: Starting new transmux session for sn: ${m.sn} p: ${m.part} level: ${m.level} id: ${m.id}\n        discontinuity: ${G}\n        trackSwitch: ${Y}\n        contiguous: ${Ae}\n        accurateTimeOffset: ${h}\n        timeOffset: ${S}\n        initSegmentChange: ${We}`);const Le=new Hk(n,r,t,c,g);this.configureTransmuxer(Le)}if(this.frag=s,this.part=o,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:R,chunkMeta:m,state:ot},e instanceof ArrayBuffer?[e]:[]);else if(x){const Le=x.push(e,R,m,ot);u_(Le)?(x.async=!0,Le.then(Qt=>{this.handleTransmuxComplete(Qt)}).catch(Qt=>{this.transmuxerError(Qt,m,"transmuxer-interface push error")})):(x.async=!1,this.handleTransmuxComplete(Le))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let n=t.flush(e);u_(n)||t.async?(u_(n)||(n=Promise.resolve(n)),n.then(s=>{this.handleFlushResult(s,e)}).catch(s=>{this.transmuxerError(s,e,"transmuxer-interface flush error")})):this.handleFlushResult(n,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Re.FRAG_PARSING_ERROR,chunkMeta:t,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data,n=this.hls;switch(t.event){case"init":{var r;const s=null==(r=this.workerContext)?void 0:r.objectURL;s&&self.URL.revokeObjectURL(s);break}case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":ae[t.data.logType]&&ae[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data)}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}class JT{constructor(e,t,n,r){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=r}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:n,media:r,stalled:s}=this;if(null===r)return;const{currentTime:o,seeking:c}=r,h=this.seeking&&!c,m=!this.seeking&&c;if(this.seeking=c,o!==e){if(this.moved=!0,null!==s){if(this.stallReported){const G=self.performance.now()-s;ae.warn(`playback not stuck anymore @${o}, after ${Math.round(G)}ms`),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if(m||h)return void(this.stalled=null);if(r.paused&&!c||r.ended||0===r.playbackRate||!Ei.getBuffered(r).length)return;const g=Ei.bufferInfo(r,o,0),E=g.nextStart||0;if(!(g.len>0||E))return;if(c){const G=g.len>2,Y=!E||t&&t.start<=o||E-o>2&&!this.fragmentTracker.getPartialFragment(o);if(G||Y)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var x;const G=Math.max(E,g.start||0)-o,Y=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,te=(null==Y||null==(x=Y.details)?void 0:x.live)?2*Y.details.targetduration:2,oe=this.fragmentTracker.getPartialFragment(o);if(G>0&&(G<=te||oe))return void this._trySkipBufferHole(oe)}const S=self.performance.now();if(null===s)return void(this.stalled=S);const R=S-s;if(!c&&R>=250&&(this._reportStall(g),!this.media))return;const L=Ei.bufferInfo(r,o,n.maxBufferHole);this._tryFixBufferStall(L,R)}_tryFixBufferStall(e,t){const{config:n,fragmentTracker:r,media:s}=this;if(null===s)return;const o=s.currentTime,c=r.getPartialFragment(o);c&&(this._trySkipBufferHole(c)||!this.media)||(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-o<n.maxBufferHole)&&t>1e3*n.highBufferWatchdogPeriod&&(ae.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:n,stallReported:r}=this;if(!r&&n){this.stallReported=!0;const s=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);ae.warn(s.message),t.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Re.BUFFER_STALLED_ERROR,fatal:!1,error:s,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:n,media:r}=this;if(null===r)return 0;const s=r.currentTime,o=Ei.bufferInfo(r,s,0),c=s<o.start?o.start:o.nextStart;if(c){const g=c-s;if(g>0&&(o.len<=t.maxBufferHole||o.len>0&&o.len<1&&r.readyState<3)){if(g>t.maxBufferHole){const{fragmentTracker:E}=this;let x=!1;if(0===s){const S=E.getAppendedFrag(0,ln.MAIN);S&&c<S.end&&(x=!0)}if(!x){const S=e||E.getAppendedFrag(s,ln.MAIN);if(S){let R=!1,L=S.end;for(;L<c;){const G=E.getPartialFragment(L);if(!G){R=!0;break}L+=G.duration}if(R)return 0}}}const y=Math.max(c+.05,s+.1);if(ae.warn(`skipping hole, adjusting currentTime from ${s} to ${y}`),this.moved=!0,this.stalled=null,r.currentTime=y,e&&!e.gap){const E=new Error(`fragment loaded with buffer holes, seeking from ${s} to ${y}`);n.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Re.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:E,reason:E.message,frag:e})}return y}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:n,nudgeRetry:r}=this;if(null===n)return;const s=n.currentTime;if(this.nudgeRetry++,r<e.nudgeMaxRetry){const o=s+(r+1)*e.nudgeOffset,c=new Error(`Nudging 'currentTime' from ${s} to ${o}`);ae.warn(c.message),n.currentTime=o,t.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Re.BUFFER_NUDGE_ON_STALL,error:c,fatal:!1})}else{const o=new Error(`Playhead still not moving while enough data buffered @${s} after ${e.nudgeMaxRetry} nudges`);ae.error(o.message),t.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Re.BUFFER_STALLED_ERROR,error:o,fatal:!0})}}}class Bs extends t_{constructor(e,t,n){super(e,t,n,"[stream-controller]",ln.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.MANIFEST_PARSED,this.onManifestParsed,this),e.on(N.LEVEL_LOADING,this.onLevelLoading,this),e.on(N.LEVEL_LOADED,this.onLevelLoaded,this),e.on(N.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(N.ERROR,this.onError,this),e.on(N.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(N.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(N.BUFFER_CREATED,this.onBufferCreated,this),e.on(N.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(N.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(N.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.MANIFEST_PARSED,this.onManifestParsed,this),e.off(N.LEVEL_LOADED,this.onLevelLoaded,this),e.off(N.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(N.ERROR,this.onError,this),e.off(N.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(N.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(N.BUFFER_CREATED,this.onBufferCreated,this),e.off(N.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(N.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(N.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:n}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let r=n.startLevel;-1===r&&(n.config.testBandwidth&&this.levels.length>1?(r=0,this.bitrateTest=!0):r=n.nextAutoLevel),this.level=n.nextLoadLevel=r,this.loadedmetadata=!1}t>0&&-1===e&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state="IDLE",this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state="STOPPED"}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case"WAITING_LEVEL":{var e;const{levels:n,level:r}=this,s=null==n||null==(e=n[r])?void 0:e.details;if(s&&(!s.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(s))break;this.state="IDLE";break}if(this.hls.nextLoadLevel!==this.level){this.state="IDLE";break}break}case"FRAG_LOADING_WAITING_RETRY":{var t;const n=self.performance.now(),r=this.retryDate;(!r||n>=r||null!=(t=this.media)&&t.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state="IDLE")}}"IDLE"===this.state&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:r}=this,{config:s,nextLoadLevel:o}=e;if(null===t||!r&&(this.startFragRequested||!s.startFragPrefetch)||this.altAudio&&this.audioOnly||null==n||!n[o])return;const c=n[o],h=this.getMainFwdBufferInfo();if(null===h)return;const m=this.getLevelDetails();if(m&&this._streamEnded(h,m)){const L={};return this.altAudio&&(L.type="video"),this.hls.trigger(N.BUFFER_EOS,L),void(this.state="ENDED")}e.loadLevel!==o&&-1===e.manualLevel&&this.log(`Adapting to level ${o} from level ${this.level}`),this.level=e.nextLoadLevel=o;const g=c.details;if(!g||"WAITING_LEVEL"===this.state||g.live&&this.levelLastLoaded!==o)return this.level=o,void(this.state="WAITING_LEVEL");const y=h.len,E=this.getMaxBufferLength(c.maxBitrate);if(y>=E)return;this.backtrackFragment&&this.backtrackFragment.start>h.end&&(this.backtrackFragment=null);const x=this.backtrackFragment?this.backtrackFragment.start:h.end;let S=this.getNextFragment(x,g);if(this.couldBacktrack&&!this.fragPrevious&&S&&"initSegment"!==S.sn&&"OK"!==this.fragmentTracker.getState(S)){var R;const G=(null!=(R=this.backtrackFragment)?R:S).sn-g.startSN,Y=g.fragments[G-1];Y&&S.cc===Y.cc&&(S=Y,this.fragmentTracker.removeFragment(Y))}else this.backtrackFragment&&h.len&&(this.backtrackFragment=null);if(S&&this.isLoopLoading(S,x)){if(!S.gap){const G=this.audioOnly&&!this.altAudio?Wn.AUDIO:Wn.VIDEO,Y=(G===Wn.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;Y&&this.afterBufferFlushed(Y,G,ln.MAIN)}S=this.getNextFragmentLoopLoading(S,g,h,ln.MAIN,E)}S&&(S.initSegment&&!S.initSegment.data&&!this.bitrateTest&&(S=S.initSegment),this.loadFragment(S,c,x))}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);this.fragCurrent=e,"NOT_LOADED"===r||"PARTIAL"===r?"initSegment"===e.sn?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,ln.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(null!=t&&t.readyState){let n;const r=this.getAppendedFrag(t.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);const s=this.getLevelDetails();if(null!=s&&s.live){const c=this.getMainFwdBufferInfo();if(!c||c.len<2*s.targetduration)return}if(!t.paused&&e){const m=this.fragLastKbps;n=m&&this.fragCurrent?this.fragCurrent.duration*e[this.hls.nextLoadLevel].maxBitrate/(1e3*m)+1:0}else n=0;const o=this.getBufferedFrag(t.currentTime+n);if(o){const c=this.followingBufferedFrag(o);if(c){this.abortCurrentFrag();const m=c.duration,g=Math.max(o.end,(c.maxStartPTS?c.maxStartPTS:c.start)+Math.min(Math.max(m-this.config.maxFragLookUpTolerance,.5*m),.75*m));this.flushMainBuffer(g,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case"KEY_LOADING":case"FRAG_LOADING":case"FRAG_LOADING_WAITING_RETRY":case"PARSING":case"PARSED":this.state="IDLE"}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new JT(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;Wt(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const n=this.getMainFwdBufferInfo();null!==n&&0!==n.len?this.tick():this.warn(`Main forward buffer length on "seeked" event ${n?n.len:"empty"})`)}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(N.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.levels=this.fragPlaying=this.backtrackFragment=null,this.altAudio=this.audioOnly=!1}onManifestParsed(e,t){let s,n=!1,r=!1;t.levels.forEach(o=>{s=o.audioCodec,s&&(-1!==s.indexOf("mp4a.40.2")&&(n=!0),-1!==s.indexOf("mp4a.40.5")&&(r=!0))}),this.audioCodecSwitch=n&&r&&!function NT(){var i;const e=LT();return"function"==typeof(null==e||null==(i=e.prototype)?void 0:i.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||"IDLE"!==this.state)return;const r=n[t.level];(!r.details||r.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(r.details))&&(this.state="WAITING_LEVEL")}onLevelLoaded(e,t){var n;const{levels:r}=this,s=t.level,o=t.details,c=o.totalduration;if(!r)return void this.warn(`Levels were reset while loading level ${s}`);this.log(`Level ${s} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${c}`);const h=r[s],m=this.fragCurrent;m&&("FRAG_LOADING"===this.state||"FRAG_LOADING_WAITING_RETRY"===this.state)&&(m.level!==t.level||m.urlId!==h.urlId)&&m.loader&&this.abortCurrentFrag();let g=0;if(o.live||null!=(n=h.details)&&n.live){if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;g=this.alignPlaylists(o,h.details)}if(h.details=o,this.levelLastLoaded=s,this.hls.trigger(N.LEVEL_UPDATED,{details:o,level:s}),"WAITING_LEVEL"===this.state){if(this.waitForCdnTuneIn(o))return;this.state="IDLE"}this.startFragRequested?o.live&&this.synchronizeToLiveEdge(o):this.setStartPosition(o,g),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:r,payload:s}=e,{levels:o}=this;if(!o)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const c=o[n.level],h=c.details;if(!h)return this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),void this.fragmentTracker.removeFragment(n);const m=c.videoCodec,g=h.PTSKnown||!h.live,y=null==(t=n.initSegment)?void 0:t.data,E=this._getAudioCodec(c),x=this.transmuxer=this.transmuxer||new W0(this.hls,ln.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),S=r?r.index:-1,L=new E0(n.level,n.sn,n.stats.chunkCount,s.byteLength,S,-1!==S);x.push(s,y,E,m,n,r,h.totalduration,g,L,this.initPTS[n.cc])}onAudioTrackSwitching(e,t){const n=this.altAudio;if(!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const s=this.hls;n&&(s.trigger(N.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),s.trigger(N.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const r=!!this.hls.audioTracks[t.id].url;if(r){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=r,this.tick()}onBufferCreated(e,t){const n=t.tracks;let r,s,o=!1;for(const c in n){const h=n[c];if("main"===h.id){if(s=c,r=h,"video"===c){const m=n[c];m&&(this.videoBuffer=m.buffer)}}else o=!0}o&&r?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:r}=t;if(n&&n.type!==ln.MAIN)return;if(this.fragContextChanged(n))return this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),void("PARSED"===this.state&&(this.state="IDLE"));const s=r?r.stats:n.stats;this.fragLastKbps=Math.round(8*s.total/(s.buffering.end-s.loading.first)),"initSegment"!==n.sn&&(this.fragPrevious=n),this.fragBufferedComplete(n,r)}onError(e,t){var n;if(t.fatal)this.state="ERROR";else switch(t.details){case Re.FRAG_GAP:case Re.FRAG_PARSING_ERROR:case Re.FRAG_DECRYPT_ERROR:case Re.FRAG_LOAD_ERROR:case Re.FRAG_LOAD_TIMEOUT:case Re.KEY_LOAD_ERROR:case Re.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ln.MAIN,t);break;case Re.LEVEL_LOAD_ERROR:case Re.LEVEL_LOAD_TIMEOUT:case Re.LEVEL_PARSING_ERROR:!t.levelRetry&&"WAITING_LEVEL"===this.state&&(null==(n=t.context)?void 0:n.type)===qn.LEVEL&&(this.state="IDLE");break;case Re.BUFFER_FULL_ERROR:if(!t.parent||"main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case Re.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}checkBuffer(){const{media:e,gapController:t}=this;e&&t&&e.readyState&&(!this.loadedmetadata&&Ei.getBuffered(e).length||t.poll(this.lastCurrentTime,"IDLE"!==this.state?this.fragCurrent:null),this.lastCurrentTime=e.currentTime)}onFragLoadEmergencyAborted(){this.state="IDLE",this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){(t!==Wn.AUDIO||this.audioOnly&&!this.altAudio)&&this.afterBufferFlushed((t===Wn.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media,t,ln.MAIN)}onLevelsUpdated(e,t){this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking)return void this.log(`could not seek to ${n}, already seeking at ${t}`);const r=Ei.getBuffered(e),o=(r.length?r.start(0):0)-n;o>0&&(o<this.config.maxBufferHole||o<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${o} to match buffer start`),n+=o,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${t}`),e.currentTime=n}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:r}=this;if(!n||this.fragContextChanged(e))return;t.fragmentError=0,this.state="IDLE",this.startFragRequested=!1,this.bitrateTest=!1;const s=e.stats;s.parsing.start=s.parsing.end=s.buffering.start=s.buffering.end=self.performance.now(),r.trigger(N.FRAG_LOADED,n),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const n="main",{hls:r}=this,{remuxResult:s,chunkMeta:o}=e,c=this.getCurrentContext(o);if(!c)return void this.resetWhenMissingContext(o);const{frag:h,part:m,level:g}=c,{video:y,text:E,id3:x,initSegment:S}=s,{details:R}=g,L=this.altAudio?void 0:s.audio;if(this.fragContextChanged(h))this.fragmentTracker.removeFragment(h);else{if(this.state="PARSING",S){if(null!=S&&S.tracks){const K=h.initSegment||h;this._bufferInitSegment(g,S.tracks,K,o),r.trigger(N.FRAG_PARSING_INIT_SEGMENT,{frag:K,id:n,tracks:S.tracks})}const G=S.initPTS,Y=S.timescale;Wt(G)&&(this.initPTS[h.cc]={baseTime:G,timescale:Y},r.trigger(N.INIT_PTS_FOUND,{frag:h,id:n,initPTS:G,timescale:Y}))}if(y&&R&&"initSegment"!==h.sn){const G=R.fragments[h.sn-1-R.startSN],Y=h.sn===R.startSN,K=!G||h.cc>G.cc;if(!1!==s.independent){const{startPTS:te,endPTS:oe,startDTS:Ae,endDTS:we}=y;if(m)m.elementaryStreams[y.type]={startPTS:te,endPTS:oe,startDTS:Ae,endDTS:we};else if(y.firstKeyFrame&&y.independent&&1===o.id&&!K&&(this.couldBacktrack=!0),y.dropped&&y.independent){const We=this.getMainFwdBufferInfo(),ot=(We?We.end:this.getLoadPosition())+this.config.maxBufferHole;if(!Y&&ot<(y.firstKeyFramePTS?y.firstKeyFramePTS:te)-this.config.maxBufferHole&&!K)return void this.backtrack(h);K&&(h.gap=!0),h.setElementaryStreamInfo(y.type,h.start,oe,h.start,we,!0)}h.setElementaryStreamInfo(y.type,te,oe,Ae,we),this.backtrackFragment&&(this.backtrackFragment=h),this.bufferFragmentData(y,h,m,o,Y||K)}else{if(!Y&&!K)return void this.backtrack(h);h.gap=!0}}if(L){const{startPTS:G,endPTS:Y,startDTS:K,endDTS:te}=L;m&&(m.elementaryStreams[Wn.AUDIO]={startPTS:G,endPTS:Y,startDTS:K,endDTS:te}),h.setElementaryStreamInfo(Wn.AUDIO,G,Y,K,te),this.bufferFragmentData(L,h,m,o)}R&&null!=x&&null!=(t=x.samples)&&t.length&&r.trigger(N.FRAG_PARSING_METADATA,{id:n,frag:h,details:R,samples:x.samples}),R&&E&&r.trigger(N.FRAG_PARSING_USERDATA,{id:n,frag:h,details:R,samples:E.samples})}}_bufferInitSegment(e,t,n,r){if("PARSING"!==this.state)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:s,video:o,audiovideo:c}=t;if(s){let h=e.audioCodec;const m=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(h&&(h=-1!==h.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==s.metadata.channelCount&&-1===m.indexOf("firefox")&&(h="mp4a.40.5")),-1!==m.indexOf("android")&&"audio/mpeg"!==s.container&&(h="mp4a.40.2",this.log(`Android: force audio codec to ${h}`)),e.audioCodec&&e.audioCodec!==h&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${h}"`),s.levelCodec=h,s.id="main",this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${h||""}/${e.audioCodec||""}/${s.codec}]`)}o&&(o.levelCodec=e.videoCodec,o.id="main",this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${o.codec}]`)),c&&this.log(`Init audiovideo buffer, container:${c.container}, codecs[level/parsed]=[${e.attrs.CODECS||""}/${c.codec}]`),this.hls.trigger(N.BUFFER_CODECS,t),Object.keys(t).forEach(h=>{const g=t[h].initSegment;null!=g&&g.byteLength&&this.hls.trigger(N.BUFFER_APPENDING,{type:h,data:g,frag:n,part:null,chunkMeta:r,parent:n.type})}),this.tick()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,ln.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state="IDLE"}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&!1===e.seeking){const n=e.currentTime;if(Ei.isBuffered(e,n)?t=this.getAppendedFrag(n):Ei.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const r=this.fragPlaying,s=t.level;(!r||t.sn!==r.sn||r.level!==s||t.urlId!==r.urlId)&&(this.fragPlaying=t,this.hls.trigger(N.FRAG_CHANGED,{frag:t}),(!r||r.level!==s)&&this.hls.trigger(N.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,n=this.currentFrag;if(n&&Wt(t)&&Wt(n.programDateTime))return new Date(n.programDateTime+1e3*(t-n.start))}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class Na{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class zk{constructor(e,t,n,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Na(e),this.fast_=new Na(t),this.defaultTTFB_=r,this.ttfb_=new Na(e)}update(e,t){const{slow_:n,fast_:r,ttfb_:s}=this;n.halfLife!==e&&(this.slow_=new Na(e,n.getEstimate(),n.getTotalWeight())),r.halfLife!==t&&(this.fast_=new Na(t,r.getEstimate(),r.getTotalWeight())),s.halfLife!==e&&(this.ttfb_=new Na(e,s.getEstimate(),s.getTotalWeight()))}sample(e,t){const r=(e=Math.max(e,this.minDelayMs_))/1e3,s=8*t/r;this.fast_.sample(r,s),this.slow_.sample(r,s)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}class Kk{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;return e.length?(n=1===e.length?e[0]:function QP(i,e){const t=new Uint8Array(e);let n=0;for(let r=0;r<i.length;r++){const s=i[r];t.set(s,n),n+=s.length}return t}(e,t),this.reset(),n):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}function tI(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!Y0(i[t].attrs,e[t].attrs))return!1;return!0}function Y0(i,e){const t=i["STABLE-RENDITION-ID"];return t?t===e["STABLE-RENDITION-ID"]:!["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED"].some(n=>i[n]!==e[n])}class qk{constructor(e){this.buffered=void 0;const t=(n,r,s)=>{if((r>>>=0)>s-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${s})`);return e[r][n]};this.buffered={get length(){return e.length},end:n=>t("end",n,e.length),start:n=>t("start",n,e.length)}}}function Z0(i){const e=[];for(let t=0;t<i.length;t++){const n=i[t];("subtitles"===n.kind||"captions"===n.kind)&&n.label&&e.push(i[t])}return e}class X0{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t){const n=this.queues[t];n.push(e),1===n.length&&this.buffers[t]&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const n=new Promise(s=>{t=s});return this.append({execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}},e),n}executeNext(e){const{buffers:t,queues:n}=this,r=t[e],s=n[e];if(s.length){const o=s[0];try{o.execute()}catch(c){ae.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),o.onError(c),null!=r&&r.updating||(s.shift(),this.executeNext(e))}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const Q0=jh(),J0=/([ha]vc.)(?:\.[^.,]+)+/,g_={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Zk=function(e){let t=e;return g_.hasOwnProperty(e)&&(t=g_[e]),String.fromCharCode(t)},rc=100,rI={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},ef={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Xk={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},sI={25:2,26:4,29:6,30:8,31:10,27:13,28:15},eb=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class JP{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n="function"==typeof t?t():t;ae.log(`${this.time} [${e}] ${n}`)}}}const dd=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class Qk{constructor(e,t,n,r,s){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=r||"black",this.flash=s||!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class Jk{constructor(e,t,n,r,s,o){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new Qk(t,n,r,s,o)}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class eR{constructor(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(let t=0;t<rc;t++)this.chars.push(new Jk);this.logger=e,this.pos=0,this.currPenState=new Qk}equals(e){let t=!0;for(let n=0;n<rc;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t}copy(e){for(let t=0;t<rc;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<rc;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>rc&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=rc)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=Zk(e);this.pos>=rc?this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))}clearFromPos(e){let t;for(t=e;t<rc;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<rc;n++){const r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class tb{constructor(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(let t=0;t<15;t++)this.rows.push(new eR(e));this.logger=e,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}reset(){for(let e=0;e<15;e++)this.rows[e].clear();this.currRow=14}equals(e){let t=!0;for(let n=0;n<15;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<15;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let c=0;c<15;c++)this.rows[c].clear();const s=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){const c=o.rows[s].cueStartTime,h=this.logger.time;if(c&&null!==h&&c<h)for(let m=0;m<this.nrRollUpRows;m++)this.rows[t-this.nrRollUpRows+m+1].copy(o.rows[s+m])}}this.currRow=t;const n=this.rows[this.currRow];if(null!==e.indent){const o=Math.max(e.indent-1,0);n.setCursor(e.indent),e.color=n.chars[o].penState.foreground}this.setPen({foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1})}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,()=>this.getDisplayText());const t=this.rows.splice(this.currRow+1-this.nrRollUpRows,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",r=-1;for(let s=0;s<15;s++){const o=this.rows[s].getTextString();o&&(r=s+1,t.push(e?"Row "+r+": '"+o+"'":o.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n}getTextAndFormat(){return this.rows}}class nb{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new tb(n),this.nonDisplayedMemory=new tb(n),this.lastOutputScreen=new tb(n),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),("MODE_PAINT-ON"===this.mode||"MODE_ROLL-UP"===this.mode)&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][n]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class ib{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;const r=new JP;this.channels=[null,new nb(e,t,r),new nb(e+1,n,r)],this.cmdHistory={a:null,b:null},this.logger=r}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){let n,r,s,o=!1;this.logger.time=e;for(let c=0;c<t.length;c+=2)if(r=127&t[c],s=127&t[c+1],0!==r||0!==s){if(this.logger.log(3,"["+dd([t[c],t[c+1]])+"] -> ("+dd([r,s])+")"),n=this.parseCmd(r,s),n||(n=this.parseMidrow(r,s)),n||(n=this.parsePAC(r,s)),n||(n=this.parseBackgroundAttributes(r,s)),!n&&(o=this.parseChars(r,s),o)){const h=this.currentChannel;h&&h>0?this.channels[h].insertChars(o):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!n&&!o&&this.logger.log(2,"Couldn't parse cleaned data "+dd([r,s])+" orig: "+dd([t[c],t[c+1]]))}}parseCmd(e,t){const{cmdHistory:n}=this;if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=33&&t<=35))return!1;if(rb(e,t,n))return tf(null,null,n),this.logger.log(3,"Repeated command ("+dd([e,t])+") is dropped"),!0;const o=20===e||21===e||23===e?1:2,c=this.channels[o];return 20===e||21===e||28===e||29===e?32===t?c.ccRCL():33===t?c.ccBS():34===t?c.ccAOF():35===t?c.ccAON():36===t?c.ccDER():37===t?c.ccRU(2):38===t?c.ccRU(3):39===t?c.ccRU(4):40===t?c.ccFON():41===t?c.ccRDC():42===t?c.ccTR():43===t?c.ccRTD():44===t?c.ccEDM():45===t?c.ccCR():46===t?c.ccENM():47===t&&c.ccEOC():c.ccTO(t-32),tf(e,t,n),this.currentChannel=o,!0}parseMidrow(e,t){let n=0;if((17===e||25===e)&&t>=32&&t<=47){if(n=17===e?1:2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const r=this.channels[n];return!!r&&(r.ccMIDROW(t),this.logger.log(3,"MIDROW ("+dd([e,t])+")"),!0)}return!1}parsePAC(e,t){let n;const r=this.cmdHistory;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127||(16===e||24===e)&&t>=64&&t<=95))return!1;if(rb(e,t,r))return tf(null,null,r),!0;const c=e<=23?1:2;n=t>=64&&t<=95?1===c?rI[e]:Xk[e]:1===c?ef[e]:sI[e];const h=this.channels[c];return!!h&&(h.setPAC(this.interpretPAC(n,t)),tf(e,t,r),this.currentChannel=c,!0)}interpretPAC(e,t){let n;const r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,r.underline=1==(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r}parseChars(e,t){let n,r=null,s=null;if(e>=25?(n=2,s=e-8):(n=1,s=e),s>=17&&s<=19){let o;o=17===s?t+80:18===s?t+112:t+144,this.logger.log(2,"Special char '"+Zk(o)+"' in channel "+n),r=[o]}else e>=32&&e<=127&&(r=0===t?[e]:[e,t]);if(r){const o=dd(r);this.logger.log(3,"Char codes =  "+o.join(",")),tf(e,t,this.cmdHistory)}return r}parseBackgroundAttributes(e,t){if(!((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47))return!1;let s;const o={};return 16===e||24===e?(s=Math.floor((t-32)/2),o.background=eb[s],t%2==1&&(o.background=o.background+"_semi")):45===t?o.background="transparent":(o.foreground="black",47===t&&(o.underline=!0)),this.channels[e<=23?1:2].setBkgData(o),tf(e,t,this.cmdHistory),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}this.cmdHistory={a:null,b:null}}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function tf(i,e,t){t.a=i,t.b=e}function rb(i,e,t){return t.a===i&&t.b===e}class __{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var ob=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;const i=["","lr","rl"],e=["start","middle","end","left","right"];function t(c,h){if("string"!=typeof h||!Array.isArray(c))return!1;const m=h.toLowerCase();return!!~c.indexOf(m)&&m}function r(c){return t(e,c)}function s(c,...h){let m=1;for(;m<arguments.length;m++){const g=arguments[m];for(const y in g)c[y]=g[y]}return c}function o(c,h,m){const g=this,y={enumerable:!0};g.hasBeenReset=!1;let E="",x=!1,S=c,R=h,L=m,G=null,Y="",K=!0,te="auto",oe="start",Ae=50,we="middle",We=50,ot="middle";Object.defineProperty(g,"id",s({},y,{get:function(){return E},set:function(Le){E=""+Le}})),Object.defineProperty(g,"pauseOnExit",s({},y,{get:function(){return x},set:function(Le){x=!!Le}})),Object.defineProperty(g,"startTime",s({},y,{get:function(){return S},set:function(Le){if("number"!=typeof Le)throw new TypeError("Start time must be set to a number.");S=Le,this.hasBeenReset=!0}})),Object.defineProperty(g,"endTime",s({},y,{get:function(){return R},set:function(Le){if("number"!=typeof Le)throw new TypeError("End time must be set to a number.");R=Le,this.hasBeenReset=!0}})),Object.defineProperty(g,"text",s({},y,{get:function(){return L},set:function(Le){L=""+Le,this.hasBeenReset=!0}})),Object.defineProperty(g,"region",s({},y,{get:function(){return G},set:function(Le){G=Le,this.hasBeenReset=!0}})),Object.defineProperty(g,"vertical",s({},y,{get:function(){return Y},set:function(Le){const Qt=function n(c){return t(i,c)}(Le);if(!1===Qt)throw new SyntaxError("An invalid or illegal string was specified.");Y=Qt,this.hasBeenReset=!0}})),Object.defineProperty(g,"snapToLines",s({},y,{get:function(){return K},set:function(Le){K=!!Le,this.hasBeenReset=!0}})),Object.defineProperty(g,"line",s({},y,{get:function(){return te},set:function(Le){if("number"!=typeof Le&&"auto"!==Le)throw new SyntaxError("An invalid number or illegal string was specified.");te=Le,this.hasBeenReset=!0}})),Object.defineProperty(g,"lineAlign",s({},y,{get:function(){return oe},set:function(Le){const Qt=r(Le);if(!Qt)throw new SyntaxError("An invalid or illegal string was specified.");oe=Qt,this.hasBeenReset=!0}})),Object.defineProperty(g,"position",s({},y,{get:function(){return Ae},set:function(Le){if(Le<0||Le>100)throw new Error("Position must be between 0 and 100.");Ae=Le,this.hasBeenReset=!0}})),Object.defineProperty(g,"positionAlign",s({},y,{get:function(){return we},set:function(Le){const Qt=r(Le);if(!Qt)throw new SyntaxError("An invalid or illegal string was specified.");we=Qt,this.hasBeenReset=!0}})),Object.defineProperty(g,"size",s({},y,{get:function(){return We},set:function(Le){if(Le<0||Le>100)throw new Error("Size must be between 0 and 100.");We=Le,this.hasBeenReset=!0}})),Object.defineProperty(g,"align",s({},y,{get:function(){return ot},set:function(Le){const Qt=r(Le);if(!Qt)throw new SyntaxError("An invalid or illegal string was specified.");ot=Qt,this.hasBeenReset=!0}})),g.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o}();class oI{decode(e,t){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function aI(i){function e(n,r,s,o){return 3600*(0|n)+60*(0|r)+(0|s)+parseFloat(o||0)}const t=i.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class lI{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&""!==t&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function ab(i,e,t,n){const r=n?i.split(n):[i];for(const s in r){if("string"!=typeof r[s])continue;const o=r[s].split(t);2===o.length&&e(o[0],o[1])}}const y_=new ob(0,0,""),sp="middle"===y_.align?"middle":"center";function tR(i,e,t){const n=i;function r(){const c=aI(i);if(null===c)throw new Error("Malformed timestamp: "+n);return i=i.replace(/^[^\sa-zA-Z-]+/,""),c}function o(){i=i.replace(/^\s+/,"")}if(o(),e.startTime=r(),o(),"--\x3e"!==i.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);i=i.slice(3),o(),e.endTime=r(),o(),function s(c,h){const m=new lI;ab(c,function(E,x){let S;switch(E){case"region":for(let R=t.length-1;R>=0;R--)if(t[R].id===x){m.set(E,t[R].region);break}break;case"vertical":m.alt(E,x,["rl","lr"]);break;case"line":S=x.split(","),m.integer(E,S[0]),m.percent(E,S[0])&&m.set("snapToLines",!1),m.alt(E,S[0],["auto"]),2===S.length&&m.alt("lineAlign",S[1],["start",sp,"end"]);break;case"position":S=x.split(","),m.percent(E,S[0]),2===S.length&&m.alt("positionAlign",S[1],["start",sp,"end","line-left","line-right","auto"]);break;case"size":m.percent(E,x);break;case"align":m.alt(E,x,["start",sp,"end","left","right"])}},/:/,/\s/),h.region=m.get("region",null),h.vertical=m.get("vertical","");let g=m.get("line","auto");"auto"===g&&-1===y_.line&&(g=-1),h.line=g,h.lineAlign=m.get("lineAlign","start"),h.snapToLines=m.get("snapToLines",!0),h.size=m.get("size",100),h.align=m.get("align",sp);let y=m.get("position","auto");"auto"===y&&50===y_.position&&(y="start"===h.align||"left"===h.align?0:"end"===h.align||"right"===h.align?100:50),h.position=y}(i,e)}function cI(i){return i.replace(/<br(?: \/)?>/gi,"\n")}class eL{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new oI,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;function n(){let s=t.buffer,o=0;for(s=cI(s);o<s.length&&"\r"!==s[o]&&"\n"!==s[o];)++o;const c=s.slice(0,o);return"\r"===s[o]&&++o,"\n"===s[o]&&++o,t.buffer=s.slice(o),c}function r(s){ab(s,function(o,c){},/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{let s="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;s=n();const c=s.match(/^(\xef\xbb\xbf)?WEBVTT([ \t].*)?$/);if(null==c||!c[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let o=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:s=n(),t.state){case"HEADER":/:/.test(s)?r(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new ob(0,0,""),t.state="CUE",-1===s.indexOf("--\x3e")){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{tR(s,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const c=-1!==s.indexOf("--\x3e");if(!s||c&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch{"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const uI=/\r\n|\n\r|\n|\r/g,dI=function(e,t,n=0){return e.slice(n,n+t.length)===t},tL=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!(Wt(t)&&Wt(n)&&Wt(r)&&Wt(s)))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=6e4*r,t+=36e5*s,t},hI=function(e){let t=5381,n=e.length;for(;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()};function fI(i,e,t){return hI(i.toString())+hI(e.toString())+hI(t)}const nL=function(e,t,n){let r=e[t],s=e[r.prevCC];if(!s||!s.new&&r.new)return e.ccOffset=e.presentationOffset=r.start,void(r.new=!1);for(;null!=(o=s)&&o.new;){var o;e.ccOffset+=r.start-s.start,r.new=!1,r=s,s=e[r.prevCC]}e.presentationOffset=n};const mI="stpp.ttml.im1t",nR=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,op=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,rL={left:"start",center:"center",right:"end",start:"start",end:"end"};function lb(i,e,t,n){const r=Kn(new Uint8Array(i),["mdat"]);if(0===r.length)return void n(new Error("Could not parse IMSC1 mdat"));const s=r.map(c=>Oa(c)),o=function U0(i,e,t=1,n=!1){return B0(i,e,1/t,n)}(e.baseTime,1,e.timescale);try{s.forEach(c=>t(function v_(i,e){const r=(new DOMParser).parseFromString(i,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(s).reduce((y,E)=>(y[E]=r.getAttribute(`ttp:${E}`)||s[E],y),{}),c="preserve"!==r.getAttribute("xml:space"),h=cb(b_(r,"styling","style")),m=cb(b_(r,"layout","region")),g=b_(r,"body","[begin]");return[].map.call(g,y=>{const E=iR(y,c);if(!E||!y.hasAttribute("begin"))return null;const x=gI(y.getAttribute("begin"),o),S=gI(y.getAttribute("dur"),o);let R=gI(y.getAttribute("end"),o);if(null===x)throw pI(y);if(null===R){if(null===S)throw pI(y);R=x+S}const L=new ob(x-e,R-e,E);L.id=fI(L.startTime,L.endTime,L.text);const K=function ub(i,e,t){const n="http://www.w3.org/ns/ttml#styling";let r=null;const o=null!=i&&i.hasAttribute("style")?i.getAttribute("style"):null;return o&&t.hasOwnProperty(o)&&(r=t[o]),["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce((c,h)=>{const m=w_(e,n,h)||w_(i,n,h)||w_(r,n,h);return m&&(c[h]=m),c},{})}(m[y.getAttribute("region")],h[y.getAttribute("style")],h),{textAlign:te}=K;if(te){const oe=rL[te];oe&&(L.lineAlign=oe),L.align=te}return Sr(L,K),L}).filter(y=>null!==y)}(c,o)))}catch(c){n(c)}}function b_(i,e,t){const n=i.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function cb(i){return i.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function iR(i,e){return[].slice.call(i.childNodes).reduce((t,n,r)=>{var s;return"br"===n.nodeName&&r?t+"\n":null!=(s=n.childNodes)&&s.length?iR(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function w_(i,e,t){return i&&i.hasAttributeNS(e,t)?i.getAttributeNS(e,t):null}function pI(i){return new Error(`Could not parse ttml timestamp ${i}`)}function gI(i,e){if(!i)return null;let t=aI(i);return null===t&&(nR.test(i)?t=function rR(i,e){const t=nR.exec(i);return 3600*(0|t[1])+60*(0|t[2])+(0|t[3])+((0|t[4])+(0|t[5])/e.subFrameRate)/e.frameRate}(i,e):op.test(i)&&(t=function sR(i,e){const t=op.exec(i),n=Number(t[1]);switch(t[2]){case"h":return 3600*n;case"m":return 60*n;case"ms":return 1e3*n;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}(i,e))),t}function E_(i,e){return!!i&&i.label===e.name&&!(i.textTrack1||i.textTrack2)}function aR(i,e,t,n){return Math.min(e,n)-Math.max(i,t)}class _I{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(N.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(N.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(N.MANIFEST_PARSED,this.onManifestParsed,this),e.on(N.BUFFER_CODECS,this.onBufferCodecs,this),e.on(N.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(N.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(N.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(N.MANIFEST_PARSED,this.onManifestParsed,this),e.off(N.BUFFER_CODECS,this.onBufferCodecs,this),e.off(N.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){const e=this.hls.levels;if(e.length){const t=this.hls;t.autoLevelCapping=this.getMaxLevel(e.length-1),t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((r,s)=>this.isLevelAllowed(r)&&s<=e);return this.clientRect=null,_I.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return e}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(null==e||!e.length)return-1;const r=(o,c)=>!c||o.width!==c.width||o.height!==c.height;let s=e.length-1;for(let o=0;o<e.length;o+=1){const c=e[o];if((c.width>=t||c.height>=n)&&r(c,e[o+1])){s=o;break}}return s}}const x_="[eme]";let cR=(()=>{class i{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=i.CDMCleanupPromise?[i.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=ae.debug.bind(ae,x_),this.log=ae.log.bind(ae,x_),this.warn=ae.warn.bind(ae,x_),this.error=ae.error.bind(ae,x_),this.hls=t,this.config=t.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const t=this.config;t.requestMediaKeySystemAccessFunc=null,t.licenseXhrSetup=t.licenseResponseCallback=void 0,t.drmSystems=t.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(N.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(N.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(N.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(N.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(N.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(N.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(N.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(N.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(t){const{drmSystems:n,widevineLicenseUrl:r}=this.config,s=n[t];if(s)return s.licenseUrl;if(t===Bi.WIDEVINE&&r)return r;throw new Error(`no license server URL configured for key-system "${t}"`)}getServerCertificateUrl(t){const{drmSystems:n}=this.config,r=n[t];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${t}"]`)}attemptKeySystemAccess(t){const n=this.hls.levels,r=(c,h,m)=>!!c&&m.indexOf(c)===h,s=n.map(c=>c.audioCodec).filter(r),o=n.map(c=>c.videoCodec).filter(r);return s.length+o.length===0&&o.push("avc1.42e01e"),new Promise((c,h)=>{const m=g=>{const y=g.shift();this.getMediaKeysPromise(y,s,o).then(E=>c({keySystem:y,mediaKeys:E})).catch(E=>{g.length?m(g):h(E instanceof ta?E:new ta({type:an.KEY_SYSTEM_ERROR,details:Re.KEY_SYSTEM_NO_ACCESS,error:E,fatal:!0},E.message))})};m(t)})}requestMediaKeySystemAccess(t,n){const{requestMediaKeySystemAccessFunc:r}=this.config;if("function"!=typeof r){let s=`Configured requestMediaKeySystemAccess is not a function ${r}`;return null===qx&&"http:"===self.location.protocol&&(s=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(s))}return r(t,n)}getMediaKeysPromise(t,n,r){const s=function WA(i,e,t,n){let r;switch(i){case Bi.FAIRPLAY:r=["cenc","sinf"];break;case Bi.WIDEVINE:case Bi.PLAYREADY:r=["cenc"];break;case Bi.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${i}`)}return function KA(i,e,t,n){return[{initDataTypes:i,persistentState:n.persistentState||"not-allowed",distinctiveIdentifier:n.distinctiveIdentifier||"not-allowed",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(s=>({contentType:`audio/mp4; codecs="${s}"`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:t.map(s=>({contentType:`video/mp4; codecs="${s}"`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}(r,e,t,n)}(t,n,r,this.config.drmSystemOptions),o=this.keySystemAccessPromises[t];let c=o?.keySystemAccess;if(!c){this.log(`Requesting encrypted media "${t}" key-system access with config: ${JSON.stringify(s)}`),c=this.requestMediaKeySystemAccess(t,s);const h=this.keySystemAccessPromises[t]={keySystemAccess:c};return c.catch(m=>{this.log(`Failed to obtain access to key-system "${t}": ${m}`)}),c.then(m=>{this.log(`Access for key-system "${m.keySystem}" obtained`);const g=this.fetchServerCertificate(t);return this.log(`Create media-keys for "${t}"`),h.mediaKeys=m.createMediaKeys().then(y=>(this.log(`Media-keys created for "${t}"`),g.then(E=>E?this.setMediaKeysServerCertificate(y,t,E):y))),h.mediaKeys.catch(y=>{this.error(`Failed to create media-keys for "${t}"}: ${y}`)}),h.mediaKeys})}return c.then(()=>o.mediaKeys)}createMediaKeySessionContext({decryptdata:t,keySystem:n,mediaKeys:r}){this.log(`Creating key-system session "${n}" keyId: ${Pa_hexDump(t.keyId||[])}`);const s=r.createSession(),o={decryptdata:t,keySystem:n,mediaKeys:r,mediaKeysSession:s,keyStatus:"status-pending"};return this.mediaKeySessions.push(o),o}renewKeySession(t){const n=t.decryptdata;if(n.pssh){const r=this.createMediaKeySessionContext(t),s=this.getKeyIdString(n);this.keyIdToKeySessionPromise[s]=this.generateRequestWithPreferredKeySession(r,"cenc",n.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(t)}getKeyIdString(t){if(!t)throw new Error("Could not read keyId of undefined decryptdata");if(null===t.keyId)throw new Error("keyId is null");return Pa_hexDump(t.keyId)}updateKeySession(t,n){var r;const s=t.mediaKeysSession;return this.log(`Updating key-session "${s.sessionId}" for keyID ${Pa_hexDump((null==(r=t.decryptdata)?void 0:r.keyId)||[])}\n      } (data length: ${n&&n.byteLength})`),s.update(n)}selectKeySystemFormat(t){const n=Object.keys(t.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${t.sn} ${t.type}: ${t.level}) key formats ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)),this.keyFormatPromise}getKeyFormatPromise(t){return new Promise((n,r)=>{const s=Qv(this.config),o=t.map(Xo).filter(c=>!!c&&-1!==s.indexOf(c));return this.getKeySystemSelectionPromise(o).then(({keySystem:c})=>{const h=Xv(c);h?n(h):r(new Error(`Unable to find format for key-system "${c}"`))}).catch(r)})}loadKey(t){const n=t.keyInfo.decryptdata,r=this.getKeyIdString(n),s=`(keyId: ${r} format: "${n.keyFormat}" method: ${n.method} uri: ${n.uri})`;this.log(`Starting session for key ${s}`);let o=this.keyIdToKeySessionPromise[r];return o||(o=this.keyIdToKeySessionPromise[r]=this.getKeySystemForKeyPromise(n).then(({keySystem:c,mediaKeys:h})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${t.frag.sn} ${t.frag.type}: ${t.frag.level} using key ${s}`),this.attemptSetMediaKeys(c,h).then(()=>{this.throwIfDestroyed();const m=this.createMediaKeySessionContext({keySystem:c,mediaKeys:h,decryptdata:n});return this.generateRequestWithPreferredKeySession(m,"cenc",n.pssh,"playlist-key")}))),o.catch(c=>this.handleError(c))),o}throwIfDestroyed(t="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(t){this.hls&&(this.error(t.message),this.hls.trigger(N.ERROR,t instanceof ta?t.data:{type:an.KEY_SYSTEM_ERROR,details:Re.KEY_SYSTEM_NO_KEYS,error:t,fatal:!0}))}getKeySystemForKeyPromise(t){const n=this.getKeyIdString(t),r=this.keyIdToKeySessionPromise[n];if(!r){const s=Xo(t.keyFormat),o=s?[s]:Qv(this.config);return this.attemptKeySystemAccess(o)}return r}getKeySystemSelectionPromise(t){if(t.length||(t=Qv(this.config)),0===t.length)throw new ta({type:an.KEY_SYSTEM_ERROR,details:Re.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(t)}_onMediaEncrypted(t){const{initDataType:n,initData:r}=t;if(this.debug(`"${t.type}" event: init data type: "${n}"`),null===r)return;let s,o;if("sinf"===n&&this.config.drmSystems[Bi.FAIRPLAY]){const y=Zr(new Uint8Array(r));try{const E=zx(JSON.parse(y).sinf),x=sT(new Uint8Array(E));if(!x)return;s=x.subarray(8,24),o=Bi.FAIRPLAY}catch{return void this.warn('Failed to parse sinf "encrypted" event message initData')}}else{const y=function dT(i){if(!(i instanceof ArrayBuffer)||i.byteLength<32)return null;const e={version:0,systemId:"",kids:null,data:null},t=new DataView(i),n=t.getUint32(0);if(i.byteLength!==n&&n>44||1886614376!==t.getUint32(4)||(e.version=t.getUint32(8)>>>24,e.version>1))return null;e.systemId=Pa_hexDump(new Uint8Array(i,12,16));const s=t.getUint32(28);if(0===e.version){if(n-32<s)return null;e.data=new Uint8Array(i,32,s)}else if(1===e.version){e.kids=[];for(let o=0;o<s;o++)e.kids.push(new Uint8Array(i,32+16*o,16))}return e}(r);if(null===y)return;0===y.version&&y.systemId===Qo_WIDEVINE&&y.data&&(s=y.data.subarray(8,24)),o=function Kx(i){if(i===Qo_WIDEVINE)return Bi.WIDEVINE}(y.systemId)}if(!o||!s)return;const c=Pa_hexDump(s),{keyIdToKeySessionPromise:h,mediaKeySessions:m}=this;let g=h[c];for(let y=0;y<m.length;y++){const E=m[y],x=E.decryptdata;if(x.pssh||!x.keyId)continue;const S=Pa_hexDump(x.keyId);if(c===S||-1!==x.uri.replace(/-/g,"").indexOf(c)){g=h[S],delete h[S],x.pssh=new Uint8Array(r),x.keyId=s,g=h[c]=g.then(()=>this.generateRequestWithPreferredKeySession(E,n,r,"encrypted-event-key-match"));break}}g||(g=h[c]=this.getKeySystemSelectionPromise([o]).then(({keySystem:y,mediaKeys:E})=>{var x;this.throwIfDestroyed();const S=new Hh("ISO-23001-7",c,null!=(x=Xv(y))?x:"");return S.pssh=new Uint8Array(r),S.keyId=s,this.attemptSetMediaKeys(y,E).then(()=>{this.throwIfDestroyed();const R=this.createMediaKeySessionContext({decryptdata:S,keySystem:y,mediaKeys:E});return this.generateRequestWithPreferredKeySession(R,n,r,"encrypted-event-no-match")})})),g.catch(y=>this.handleError(y))}_onWaitingForKey(t){this.log(`"${t.type}" event`)}attemptSetMediaKeys(t,n){const r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${t}"`);const s=Promise.all(r).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(n)});return this.setMediaKeysQueue.push(s),s.then(()=>{this.log(`Media-keys set for "${t}"`),r.push(s),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(o=>-1===r.indexOf(o))})}generateRequestWithPreferredKeySession(t,n,r,s){var o,c;const h=null==(o=this.config.drmSystems)||null==(c=o[t.keySystem])?void 0:c.generateRequest;if(h)try{const x=h.call(this.hls,n,r,t);if(!x)throw new Error("Invalid response from configured generateRequest filter");n=x.initDataType,r=t.decryptdata.pssh=x.initData?new Uint8Array(x.initData):null}catch(x){var m;if(this.warn(x.message),null!=(m=this.hls)&&m.config.debug)throw x}if(null===r)return this.log(`Skipping key-session request for "${s}" (no initData)`),Promise.resolve(t);const g=this.getKeyIdString(t.decryptdata);this.log(`Generating key-session request for "${s}": ${g} (init data type: ${n} length: ${r?r.byteLength:null})`);const y=new h_;t.mediaKeysSession.onmessage=x=>{const S=t.mediaKeysSession;if(!S)return void y.emit("error",new Error("invalid state"));const{messageType:R,message:L}=x;this.log(`"${R}" message event for session "${S.sessionId}" message size: ${L.byteLength}`),"license-request"===R||"license-renewal"===R?this.renewLicense(t,L).catch(G=>{this.handleError(G),y.emit("error",G)}):"license-release"===R?t.keySystem===Bi.FAIRPLAY&&(this.updateKeySession(t,Wx("acknowledged")),this.removeSession(t)):this.warn(`unhandled media key message type "${R}"`)},t.mediaKeysSession.onkeystatuseschange=x=>{if(!t.mediaKeysSession)return void y.emit("error",new Error("invalid state"));this.onKeyStatusChange(t);const R=t.keyStatus;y.emit("keyStatus",R),"expired"===R&&(this.warn(`${t.keySystem} expired for key ${g}`),this.renewKeySession(t))};const E=new Promise((x,S)=>{y.on("error",S),y.on("keyStatus",R=>{R.startsWith("usable")?x():"output-restricted"===R?S(new ta({type:an.KEY_SYSTEM_ERROR,details:Re.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===R?S(new ta({type:an.KEY_SYSTEM_ERROR,details:Re.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${R}"`)):"expired"===R?S(new Error("key expired while generating request")):this.warn(`unhandled key status change "${R}"`)})});return t.mediaKeysSession.generateRequest(n,r).then(()=>{var x;this.log(`Request generated for key-session "${null==(x=t.mediaKeysSession)?void 0:x.sessionId}" keyId: ${g}`)}).catch(x=>{throw new ta({type:an.KEY_SYSTEM_ERROR,details:Re.KEY_SYSTEM_NO_SESSION,error:x,fatal:!1},`Error generating key-session request: ${x}`)}).then(()=>E).catch(x=>{throw y.removeAllListeners(),this.removeSession(t),x}).then(()=>(y.removeAllListeners(),t))}onKeyStatusChange(t){t.mediaKeysSession.keyStatuses.forEach((n,r)=>{this.log(`key status change "${n}" for keyStatuses keyId: ${Pa_hexDump("buffer"in r?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r))} session keyId: ${Pa_hexDump(new Uint8Array(t.decryptdata.keyId||[]))} uri: ${t.decryptdata.uri}`),t.keyStatus=n})}fetchServerCertificate(t){const n=this.config,s=new(0,n.loader)(n),o=this.getServerCertificateUrl(t);return o?(this.log(`Fetching serverCertificate for "${t}"`),new Promise((c,h)=>{const m={responseType:"arraybuffer",url:o},g=n.certLoadPolicy.default;s.load(m,{loadPolicy:g,timeout:g.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},{onSuccess:(x,S,R,L)=>{c(x.data)},onError:(x,S,R,L)=>{h(new ta({type:an.KEY_SYSTEM_ERROR,details:Re.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:R,response:Yr({url:m.url,data:void 0},x)},`"${t}" certificate request failed (${o}). Status: ${x.code} (${x.text})`))},onTimeout:(x,S,R)=>{h(new ta({type:an.KEY_SYSTEM_ERROR,details:Re.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:R,response:{url:m.url,data:void 0}},`"${t}" certificate request timed out (${o})`))},onAbort:(x,S,R)=>{h(new Error("aborted"))}})})):Promise.resolve()}setMediaKeysServerCertificate(t,n,r){return new Promise((s,o)=>{t.setServerCertificate(r).then(c=>{this.log(`setServerCertificate ${c?"success":"not supported by CDM"} (${r?.byteLength}) on "${n}"`),s(t)}).catch(c=>{o(new ta({type:an.KEY_SYSTEM_ERROR,details:Re.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:c,fatal:!0},c.message))})})}renewLicense(t,n){return this.requestLicense(t,new Uint8Array(n)).then(r=>this.updateKeySession(t,new Uint8Array(r)).catch(s=>{throw new ta({type:an.KEY_SYSTEM_ERROR,details:Re.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:s,fatal:!0},s.message)}))}setupLicenseXHR(t,n,r,s){const o=this.config.licenseXhrSetup;return o?Promise.resolve().then(()=>{if(!r.decryptdata)throw new Error("Key removed");return o.call(this.hls,t,n,r,s)}).catch(c=>{if(!r.decryptdata)throw c;return t.open("POST",n,!0),o.call(this.hls,t,n,r,s)}).then(c=>(t.readyState||t.open("POST",n,!0),{xhr:t,licenseChallenge:c||s})):(t.open("POST",n,!0),Promise.resolve({xhr:t,licenseChallenge:s}))}requestLicense(t,n){const r=this.config.keyLoadPolicy.default;return new Promise((s,o)=>{const c=this.getLicenseServerUrl(t.keySystem);this.log(`Sending license request to URL: ${c}`);const h=new XMLHttpRequest;h.responseType="arraybuffer",h.onreadystatechange=()=>{if(!this.hls||!t.mediaKeysSession)return o(new Error("invalid state"));if(4===h.readyState)if(200===h.status){this._requestLicenseFailureCount=0;let m=h.response;this.log(`License received ${m instanceof ArrayBuffer?m.byteLength:m}`);const g=this.config.licenseResponseCallback;if(g)try{m=g.call(this.hls,h,c,t)}catch(y){this.error(y)}s(m)}else{const m=r.errorRetry,g=m?m.maxNumRetry:0;this._requestLicenseFailureCount++,this._requestLicenseFailureCount>g||h.status>=400&&h.status<500?o(new ta({type:an.KEY_SYSTEM_ERROR,details:Re.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:h,response:{url:c,data:void 0,code:h.status,text:h.statusText}},`License Request XHR failed (${c}). Status: ${h.status} (${h.statusText})`)):(this.warn(`Retrying license request, ${g-this._requestLicenseFailureCount+1} attempts left`),this.requestLicense(t,n).then(s,o))}},t.licenseXhr&&t.licenseXhr.readyState!==XMLHttpRequest.DONE&&t.licenseXhr.abort(),t.licenseXhr=h,this.setupLicenseXHR(h,c,t,n).then(({xhr:m,licenseChallenge:g})=>{m.send(g)})})}onMediaAttached(t,n){if(!this.config.emeEnabled)return;const r=n.media;this.media=r,r.addEventListener("encrypted",this.onMediaEncrypted),r.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const t=this.media,n=this.mediaKeySessions;t&&(t.removeEventListener("encrypted",this.onMediaEncrypted),t.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},Hh.clearKeyUriToKeyIdMap();const r=n.length;i.CDMCleanupPromise=Promise.all(n.map(s=>this.removeSession(s)).concat(t?.setMediaKeys(null).catch(s=>{this.log(`Could not clear media keys: ${s}. media.src: ${t?.src}`)}))).then(()=>{r&&(this.log("finished closing key sessions and clearing media keys"),n.length=0)}).catch(s=>{this.log(`Could not close sessions and clear media keys: ${s}. media.src: ${t?.src}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(t,{sessionKeys:n}){if(n&&this.config.emeEnabled&&!this.keyFormatPromise){const r=n.reduce((s,o)=>(-1===s.indexOf(o.keyFormat)&&s.push(o.keyFormat),s),[]);this.log(`Selecting key-system from session-keys ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)}}removeSession(t){const{mediaKeysSession:n,licenseXhr:r}=t;if(n){this.log(`Remove licenses and keys and close session ${n.sessionId}`),n.onmessage=null,n.onkeystatuseschange=null,r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),t.mediaKeysSession=t.decryptdata=t.licenseXhr=void 0;const s=this.mediaKeySessions.indexOf(t);return s>-1&&this.mediaKeySessions.splice(s,1),n.remove().catch(o=>{this.log(`Could not remove session: ${o}`)}).then(()=>n.close()).catch(o=>{this.log(`Could not close session: ${o}`)})}}}return i.CDMCleanupPromise=void 0,i})();class ta extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}class sc{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=r=>{try{this.apply(r,{ot:"m",su:!this.initialized})}catch(s){ae.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=r=>{try{const s=r.frag,o=this.hls.levels[s.level],c=this.getObjectType(s),h={d:1e3*s.duration,ot:c};("v"===c||"a"===c||"av"==c)&&(h.br=o.bitrate/1e3,h.tb=this.getTopBandwidth(c)/1e3,h.bl=this.getBufferLength(c)),this.apply(r,h)}catch(s){ae.warn("Could not generate segment CMCD data.",s)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;null!=n&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||sc.uuid(),this.cid=n.contentId,this.useHeaders=!0===n.useHeaders,this.registerListeners())}registerListeners(){const e=this.hls;e.on(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(N.MEDIA_DETACHED,this.onMediaDetached,this),e.on(N.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(N.MEDIA_DETACHED,this.onMediaDetached,this),e.off(N.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,r;this.audioBuffer=null==(n=t.tracks.audio)?void 0:n.buffer,this.videoBuffer=null==(r=t.tracks.video)?void 0:r.buffer}createData(){var e;return{v:1,sf:"h",sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){if(Sr(t,this.createData()),this.starved&&("i"===t.ot||"v"===t.ot||"av"===t.ot)&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering),this.useHeaders){const r=sc.toHeaders(t);if(!Object.keys(r).length)return;e.headers||(e.headers={}),Sr(e.headers,r)}else{const r=sc.toQuery(t);if(!r)return;e.url=sc.appendQueryToUri(e.url,r)}}getObjectType(e){const{type:t}=e;return"subtitle"===t?"tt":"initSegment"===e.sn?"i":"audio"===t?"a":"main"===t?this.hls.audioTracks.length?"v":"av":void 0}getTopBandwidth(e){let n,t=0;const r=this.hls;if("a"===e)n=r.audioTracks;else{const s=r.maxAutoLevel;n=r.levels.slice(0,s>-1?s+1:r.levels.length)}for(const s of n)s.bitrate>t&&(t=s.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.hls.media,n="a"===e?this.audioBuffer:this.videoBuffer;return n&&t?1e3*Ei.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len:NaN}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,c){t(s),this.loader.load(s,o,c)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,c){t(s),this.loader.load(s,o,c)}}}static uuid(){const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}static serialize(e){const t=[],n=m=>!Number.isNaN(m)&&null!=m&&""!==m&&!1!==m,r=m=>Math.round(m),s=m=>100*r(m/100),c={br:r,d:r,bl:s,dl:s,mtp:s,nor:m=>encodeURIComponent(m),rtp:s,tb:r},h=Object.keys(e||{}).sort();for(const m of h){let g=e[m];if(!n(g)||"v"===m&&1===g||"pr"==m&&1===g)continue;const y=c[m];y&&(g=y(g));const E=typeof g;let x;x="ot"===m||"sf"===m||"st"===m?`${m}=${g}`:"boolean"===E?m:"number"===E?`${m}=${g}`:`${m}=${JSON.stringify(g)}`,t.push(x)}return t.join(",")}static toHeaders(e){const t=Object.keys(e),n={},r=["Object","Request","Session","Status"],s=[{},{},{},{}],o={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};for(const c of t)s[null!=o[c]?o[c]:1][c]=e[c];for(let c=0;c<s.length;c++){const h=sc.serialize(s[c]);h&&(n[`CMCD-${r[c]}`]=h)}return n}static toQuery(e){return`CMCD=${encodeURIComponent(sc.serialize(e))}`}static appendQueryToUri(e,t){if(!t)return e;const n=e.includes("?")?"&":"?";return`${e}${n}${t}`}}function vI(i,e,t,n){i&&Object.keys(e).forEach(r=>{const s=i.filter(o=>o.groupId===r).map(o=>{const c=Sr({},o);return c.details=void 0,c.attrs=new Fi(c.attrs),c.url=c.attrs.URI=T_(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),c.groupId=c.attrs["GROUP-ID"]=e[r],c.attrs["PATHWAY-ID"]=n,c});i.push(...s)})}function T_(i,e,t,n){const{HOST:r,PARAMS:s,[t]:o}=n;let c;e&&(c=o?.[e],c&&(i=c));const h=new self.URL(i);return r&&!c&&(h.host=r),s&&Object.keys(s).sort().forEach(m=>{m&&h.searchParams.set(m,s[m])}),h.href}const uR=/^age:\s*[\d.]+\s*$/im;class dR{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new Hm,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e)return;const n=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;const s=this.xhrSetup;s?Promise.resolve().then(()=>{if(!this.stats.aborted)return s(n,t.url)}).catch(o=>(n.open("GET",t.url,!0),s(n,t.url))).then(()=>{this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(o=>{this.callbacks.onError({code:n.status,text:o.message},t,n,r)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const r=this.context.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:o}=n.loadPolicy;if(r)for(const c in r)e.setRequestHeader(c,r[c]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=s&&Wt(s)?s:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const r=t.readyState,s=this.config;if(!n.aborted&&r>=2&&(0===n.loading.first&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),4===r)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const o=t.status,c="text"!==t.responseType;if(o>=200&&o<300&&(c&&t.response||null!==t.responseText)){n.loading.end=Math.max(self.performance.now(),n.loading.first);const h=c?t.response:t.responseText;if(n.loaded=n.total="arraybuffer"===t.responseType?h.byteLength:h.length,n.bwEstimate=8e3*n.total/(n.loading.end-n.loading.first),!this.callbacks)return;const g=this.callbacks.onProgress;if(g&&g(n,e,h,t),!this.callbacks)return;this.callbacks.onSuccess({url:t.responseURL,data:h,code:o},n,e,t)}else{const h=s.loadPolicy.errorRetry;Qg(h,n.retry,!1,o)?this.retry(h):(ae.error(`${o} while loading ${e.url}`),this.callbacks.onError({code:o,text:t.statusText},e,t,n))}}}loadtimeout(){var e;const t=null==(e=this.config)?void 0:e.loadPolicy.timeoutRetry;if(Qg(t,this.stats.retry,!0))this.retry(t);else{ae.warn(`timeout while loading ${this.context.url}`);const r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=y0(e,n.retry),n.retry++,ae.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&uR.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const hR=/(\d+)-(\d+)\/(\d+)/;class I_{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||bI,this.controller=new self.AbortController,this.stats=new Hm}destroy(){this.loader=this.callbacks=null,this.abortInternal()}abortInternal(){const e=this.response;null!=e&&e.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const s=function fR(i,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Sr({},i.headers))};return i.rangeEnd&&t.headers.set("Range","bytes="+i.rangeStart+"-"+String(i.rangeEnd-1)),t}(e,this.controller.signal),o=n.onProgress,c="arraybuffer"===e.responseType,h=c?"byteLength":"length",{maxTimeToFirstByteMs:m,maxLoadTimeMs:g}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=m&&Wt(m)?m:g,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(r,e,this.response)},t.timeout),self.fetch(this.request).then(y=>{this.response=this.loader=y;const E=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=g,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(r,e,this.response)},g-(E-r.loading.start)),!y.ok){const{status:x,statusText:S}=y;throw new wI(S||"fetch, bad network response",x,y)}return r.loading.first=E,r.total=function db(i){const e=i.get("Content-Range");if(e){const n=function mR(i){const e=hR.exec(i);if(e)return parseInt(e[2])-parseInt(e[1])+1}(e);if(Wt(n))return n}const t=i.get("Content-Length");if(t)return parseInt(t)}(y.headers)||r.total,o&&Wt(t.highWaterMark)?this.loadProgressively(y,r,e,t.highWaterMark,o):c?y.arrayBuffer():"json"===e.responseType?y.json():y.text()}).then(y=>{const{response:E}=this;self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const x=y[h];x&&(r.loaded=r.total=x);const S={url:E.url,data:y,code:E.status};o&&!Wt(t.highWaterMark)&&o(r,e,y,E),n.onSuccess(S,r,e,E)}).catch(y=>{self.clearTimeout(this.requestTimeout),r.aborted||n.onError({code:y&&y.code||0,text:y?y.message:null},e,y?y.details:null,r)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,r=0,s){const o=new Kk,c=e.body.getReader(),h=()=>c.read().then(m=>{if(m.done)return o.dataLength&&s(t,n,o.flush(),e),Promise.resolve(new ArrayBuffer(0));const g=m.value,y=g.length;return t.loaded+=y,y<r||o.dataLength?(o.push(g),o.dataLength>=r&&s(t,n,o.flush(),e)):s(t,n,g,e),h()}).catch(()=>Promise.reject());return h()}}function bI(i,e){return new self.Request(i.url,e)}class wI extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const pR=/\s/,EI={newCue(i,e,t,n){const r=[];let s,o,c,h,m;const g=self.VTTCue||self.TextTrackCue;for(let E=0;E<n.rows.length;E++)if(s=n.rows[E],c=!0,h=0,m="",!s.isEmpty()){var y;for(let R=0;R<s.chars.length;R++)pR.test(s.chars[R].uchar)&&c?h++:(m+=s.chars[R].uchar,c=!1);s.cueStartTime=e,e===t&&(t+=1e-4),h>=16?h--:h++;const x=cI(m.trim()),S=fI(e,t,x);null!=i&&null!=(y=i.cues)&&y.getCueById(S)||(o=new g(e,t,x),o.id=S,o.line=E+1,o.align="left",o.position=10+Math.min(80,10*Math.floor(8*h/32)),r.push(o))}return i&&r.length&&(r.sort((E,x)=>"auto"===E.line||"auto"===x.line?0:E.line>8&&x.line>8?x.line-E.line:E.line-x.line),r.forEach(E=>zh(i,E))),r}},gR=Yr(Yr({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:dR,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class Wk{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=e;const t=e.config;this.bwEstimator=new zk(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(N.FRAG_LOADING,this.onFragLoading,this),e.on(N.FRAG_LOADED,this.onFragLoaded,this),e.on(N.FRAG_BUFFERED,this.onFragBuffered,this),e.on(N.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(N.LEVEL_LOADED,this.onLevelLoaded,this)}unregisterListeners(){const{hls:e}=this;e.off(N.FRAG_LOADING,this.onFragLoading,this),e.off(N.FRAG_LOADED,this.onFragLoaded,this),e.off(N.FRAG_BUFFERED,this.onFragBuffered,this),e.off(N.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(N.LEVEL_LOADED,this.onLevelLoaded,this)}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null}onFragLoading(e,t){var n;const r=t.frag;this.ignoreFragment(r)||(this.fragCurrent=r,this.partCurrent=null!=(n=t.part)?n:null,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))}onLevelSwitching(e,t){this.clearTimer()}getTimeToLoadFrag(e,t,n,r){return e+n/t+(r?this.lastLevelLoadSec:0)}onLevelLoaded(e,t){const n=this.hls.config,{total:r,bwEstimate:s}=t.stats;Wt(r)&&Wt(s)&&(this.lastLevelLoadSec=8*r/s),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}_abandonRulesCheck(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{autoLevelEnabled:r,media:s}=n;if(!e||!s)return;const o=performance.now(),c=t?t.stats:e.stats,h=t?t.duration:e.duration,m=o-c.loading.start;if(c.aborted||c.loaded&&c.loaded===c.total||0===e.level)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!r||s.paused||!s.playbackRate||!s.readyState)return;const g=n.mainForwardBufferInfo;if(null===g)return;const y=this.bwEstimator.getEstimateTTFB(),E=Math.abs(s.playbackRate);if(m<=Math.max(y,h/(2*E)*1e3))return;const x=g.len/E;if(x>=2*h/E)return;const S=c.loading.first?c.loading.first-c.loading.start:-1,R=c.loaded&&S>-1,L=this.bwEstimator.getEstimate(),{levels:G,minAutoLevel:Y}=n,te=c.total||Math.max(c.loaded,Math.round(h*G[e.level].maxBitrate/8));let oe=m-S;oe<1&&R&&(oe=Math.min(m,8*c.loaded/L));const Ae=R?1e3*c.loaded/oe:0,we=Ae?(te-c.loaded)/Ae:8*te/L+y/1e3;if(we<=x)return;const We=Ae?8*Ae:L;let Le,ot=Number.POSITIVE_INFINITY;for(Le=e.level-1;Le>Y&&(ot=this.getTimeToLoadFrag(y/1e3,We,h*G[Le].maxBitrate,!G[Le].details),!(ot<x));Le--);ot>=we||ot>10*h||(n.nextLoadLevel=Le,R?this.bwEstimator.sample(m-Math.min(y,S),c.loaded):this.bwEstimator.sampleTTFB(m),this.clearTimer(),ae.warn(`[abr] Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} is loading too slowly;\n      Time to underbuffer: ${x.toFixed(3)} s\n      Estimated load time for current fragment: ${we.toFixed(3)} s\n      Estimated load time for down switch fragment: ${ot.toFixed(3)} s\n      TTFB estimate: ${S}\n      Current BW estimate: ${Wt(L)?(L/1024).toFixed(3):"Unknown"} Kb/s\n      New BW estimate: ${(this.bwEstimator.getEstimate()/1024).toFixed(3)} Kb/s\n      Aborting and switching to level ${Le}`),e.loader&&(this.fragCurrent=this.partCurrent=null,e.abortRequests()),n.trigger(N.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:c}))}onFragLoaded(e,{frag:t,part:n}){const r=n?n.stats:t.stats;if(t.type===ln.MAIN&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){const o=this.hls.levels[t.level],c=(o.loaded?o.loaded.bytes:0)+r.loaded,h=(o.loaded?o.loaded.duration:0)+(n?n.duration:t.duration);o.loaded={bytes:c,duration:h},o.realBitrate=Math.round(8*c/h)}t.bitrateTest&&(this.onFragBuffered(N.FRAG_BUFFERED,{stats:r,frag:t,part:n,id:t.type}),t.bitrateTest=!1)}}onFragBuffered(e,t){const{frag:n,part:r}=t,s=null!=r&&r.stats.loaded?r.stats:n.stats;if(s.aborted||this.ignoreFragment(n))return;const o=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,s.loaded),s.bwEstimate=this.bwEstimator.getEstimate(),this.bitrateTestDelay=n.bitrateTest?o/1e3:0}ignoreFragment(e){return e.type!==ln.MAIN||"initSegment"===e.sn}clearTimer(){self.clearInterval(this.timer)}get nextAutoLevel(){const e=this._nextAutoLevel;if(-1!==e&&!this.bwEstimator.canEstimate())return e;let n=this.getNextABRAutoLevel();if(-1!==e){const r=this.hls.levels;if(r.length>Math.max(e,n)&&r[e].loadError<=r[n].loadError)return e}return-1!==e&&(n=Math.min(e,n)),n}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{maxAutoLevel:r,config:s,minAutoLevel:o,media:c}=n,h=t?t.duration:e?e.duration:0,m=c&&0!==c.playbackRate?Math.abs(c.playbackRate):1,g=this.bwEstimator?this.bwEstimator.getEstimate():s.abrEwmaDefaultEstimate,y=n.mainForwardBufferInfo,E=(y?y.len:0)/m;let x=this.findBestLevel(g,o,r,E,s.abrBandWidthFactor,s.abrBandWidthUpFactor);if(x>=0)return x;ae.trace(`[abr] ${E?"rebuffering expected":"buffer is empty"}, finding optimal quality level`);let S=h?Math.min(h,s.maxStarvationDelay):s.maxStarvationDelay,R=s.abrBandWidthFactor,L=s.abrBandWidthUpFactor;if(!E){const G=this.bitrateTestDelay;G&&(S=(h?Math.min(h,s.maxLoadingDelay):s.maxLoadingDelay)-G,ae.trace(`[abr] bitrate test took ${Math.round(1e3*G)}ms, set first fragment max fetchDuration to ${Math.round(1e3*S)} ms`),R=L=1)}return x=this.findBestLevel(g,o,r,E+S,R,L),Math.max(x,0)}findBestLevel(e,t,n,r,s,o){var c;const{fragCurrent:h,partCurrent:m,lastLoadedFragLevel:g}=this,{levels:y}=this.hls,E=y[g],x=!(null==E||null==(c=E.details)||!c.live),S=E?.codecSet,R=m?m.duration:h?h.duration:0,L=this.bwEstimator.getEstimateTTFB()/1e3;let G=t,Y=-1;for(let K=n;K>=t;K--){const te=y[K];if(!te||S&&te.codecSet!==S){te&&(G=Math.min(K,G),Y=Math.max(K,Y));continue}-1!==Y&&ae.trace(`[abr] Skipped level(s) ${G}-${Y} with CODECS:"${y[Y].attrs.CODECS}"; not compatible with "${E.attrs.CODECS}"`);const oe=te.details,Ae=(m?oe?.partTarget:oe?.averagetargetduration)||R;let we;we=K<=g?s*e:o*e;const We=y[K].maxBitrate,ot=this.getTimeToLoadFrag(L,we,We*Ae,void 0===oe);if(ae.trace(`[abr] level:${K} adjustedbw-bitrate:${Math.round(we-We)} avgDuration:${Ae.toFixed(1)} maxFetchDuration:${r.toFixed(1)} fetchDuration:${ot.toFixed(1)}`),we>We&&(0===ot||!Wt(ot)||x&&!this.bitrateTestDelay||ot<r))return K}return-1}set nextAutoLevel(e){this._nextAutoLevel=e}},bufferController:class p_{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=()=>{const{media:t,mediaSource:n}=this;ae.log("[buffer-controller]: Media source opened"),t&&(t.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(N.MEDIA_ATTACHED,{media:t})),n&&n.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{ae.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=()=>{ae.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=()=>{const{media:t,_objectUrl:n}=this;t&&t.src!==n&&ae.error(`Media element src was set while attaching MediaSource (${n} > ${t.src})`)},this.hls=e,this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null}registerListeners(){const{hls:e}=this;e.on(N.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.MANIFEST_PARSED,this.onManifestParsed,this),e.on(N.BUFFER_RESET,this.onBufferReset,this),e.on(N.BUFFER_APPENDING,this.onBufferAppending,this),e.on(N.BUFFER_CODECS,this.onBufferCodecs,this),e.on(N.BUFFER_EOS,this.onBufferEos,this),e.on(N.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(N.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(N.FRAG_PARSED,this.onFragParsed,this),e.on(N.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(N.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.MANIFEST_PARSED,this.onManifestParsed,this),e.off(N.BUFFER_RESET,this.onBufferReset,this),e.off(N.BUFFER_APPENDING,this.onBufferAppending,this),e.off(N.BUFFER_CODECS,this.onBufferCodecs,this),e.off(N.BUFFER_EOS,this.onBufferEos,this),e.off(N.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(N.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(N.FRAG_PARSED,this.onFragParsed,this),e.off(N.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new X0(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,ae.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const n=this.media=t.media;if(n&&Q0){const r=this.mediaSource=new Q0;r.addEventListener("sourceopen",this._onMediaSourceOpen),r.addEventListener("sourceended",this._onMediaSourceEnded),r.addEventListener("sourceclose",this._onMediaSourceClose),n.src=self.URL.createObjectURL(r),this._objectUrl=n.src,n.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:n}=this;if(t){if(ae.log("[buffer-controller]: media source detaching"),"open"===t.readyState)try{t.endOfStream()}catch(r){ae.warn(`[buffer-controller]: onMediaDetaching: ${r.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),e.src===n?(e.removeAttribute("src"),e.load()):ae.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(N.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{const t=this.sourceBuffer[e];try{t&&(this.removeBufferListeners(e),this.mediaSource&&this.mediaSource.removeSourceBuffer(t),this.sourceBuffer[e]=void 0)}catch(n){ae.warn(`[buffer-controller]: Failed to reset the ${e} buffer`,n)}}),this._initSourceBuffer()}onBufferCodecs(e,t){const n=this.getSourceBufferTypes().length;Object.keys(t).forEach(r=>{if(n){const s=this.tracks[r];if(s&&"function"==typeof s.buffer.changeType){const{id:o,codec:c,levelCodec:h,container:m,metadata:g}=t[r],y=(s.levelCodec||s.codec).replace(J0,"$1"),E=(h||c).replace(J0,"$1");y!==E&&(this.appendChangeType(r,`${m};codecs=${h||c}`),ae.log(`[buffer-controller]: switching codec ${y} to ${E}`),this.tracks[r]={buffer:s.buffer,codec:c,container:m,levelCodec:h,metadata:g,id:o})}}else this.pendingTracks[r]=t[r]}),!n&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())}appendChangeType(e,t){const{operationQueue:n}=this,r={execute:()=>{const s=this.sourceBuffer[e];s&&(ae.log(`[buffer-controller]: changing ${e} sourceBuffer type to ${t}`),s.changeType(t)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:s=>{ae.warn(`[buffer-controller]: Failed to change ${e} SourceBuffer type`,s)}};n.append(r,e)}onBufferAppending(e,t){const{hls:n,operationQueue:r,tracks:s}=this,{data:o,type:c,frag:h,part:m,chunkMeta:g}=t,y=g.buffering[c],E=self.performance.now();y.start=E;const x=h.stats.buffering,S=m?m.stats.buffering:null;0===x.start&&(x.start=E),S&&0===S.start&&(S.start=E);let L=!1;"audio"===c&&"audio/mpeg"===s.audio?.container&&(L=!this.lastMpegAudioChunk||1===g.id||this.lastMpegAudioChunk.sn!==g.sn,this.lastMpegAudioChunk=g);const G=h.start;r.append({execute:()=>{if(y.executeStart=self.performance.now(),L){const K=this.sourceBuffer[c];if(K){const te=G-K.timestampOffset;Math.abs(te)>=.1&&(ae.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${G} (delta: ${te}) sn: ${h.sn})`),K.timestampOffset=G)}}this.appendExecutor(o,c)},onStart:()=>{},onComplete:()=>{const K=self.performance.now();y.executeEnd=y.end=K,0===x.first&&(x.first=K),S&&0===S.first&&(S.first=K);const{sourceBuffer:te}=this,oe={};for(const Ae in te)oe[Ae]=Ei.getBuffered(te[Ae]);this.appendError=0,this.hls.trigger(N.BUFFER_APPENDED,{type:c,frag:h,part:m,chunkMeta:g,parent:h.type,timeRanges:oe})},onError:K=>{ae.error(`[buffer-controller]: Error encountered while trying to append to the ${c} SourceBuffer`,K);const te={type:an.MEDIA_ERROR,parent:h.type,details:Re.BUFFER_APPEND_ERROR,frag:h,part:m,chunkMeta:g,error:K,err:K,fatal:!1};K.code===DOMException.QUOTA_EXCEEDED_ERR?te.details=Re.BUFFER_FULL_ERROR:(this.appendError++,te.details=Re.BUFFER_APPEND_ERROR,this.appendError>n.config.appendErrorMaxRetry&&(ae.error(`[buffer-controller]: Failed ${n.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),te.fatal=!0)),n.trigger(N.ERROR,te)}},c)}onBufferFlushing(e,t){const{operationQueue:n}=this,r=s=>({execute:this.removeExecutor.bind(this,s,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(N.BUFFER_FLUSHED,{type:s})},onError:o=>{ae.warn(`[buffer-controller]: Failed to remove from ${s} SourceBuffer`,o)}});t.type?n.append(r(t.type),t.type):this.getSourceBufferTypes().forEach(s=>{n.append(r(s),s)})}onFragParsed(e,t){const{frag:n,part:r}=t,s=[],o=r?r.elementaryStreams:n.elementaryStreams;o[Wn.AUDIOVIDEO]?s.push("audiovideo"):(o[Wn.AUDIO]&&s.push("audio"),o[Wn.VIDEO]&&s.push("video")),0===s.length&&ae.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(()=>{const h=self.performance.now();n.stats.buffering.end=h,r&&(r.stats.buffering.end=h),this.hls.trigger(N.FRAG_BUFFERED,{frag:n,part:r,stats:r?r.stats:n.stats,id:n.type})},s)}onFragChanged(e,t){this.flushBackBuffer()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((r,s)=>{const o=this.sourceBuffer[s];return o&&(!t.type||t.type===s)&&(o.ending=!0,o.ended||(o.ended=!0,ae.log(`[buffer-controller]: ${s} sourceBuffer now EOS`))),r&&!(o&&!o.ended)},!0)&&(ae.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(s=>{const o=this.sourceBuffer[s];o&&(o.ending=!1)});const{mediaSource:r}=this;r&&"open"===r.readyState?(ae.log("[buffer-controller]: Calling mediaSource.endOfStream()"),r.endOfStream()):r&&ae.info(`[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: ${r.readyState}`)}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}flushBackBuffer(){const{hls:e,details:t,media:n,sourceBuffer:r}=this;if(!n||null===t)return;const s=this.getSourceBufferTypes();if(!s.length)return;const o=t.live&&null!==e.config.liveBackBufferLength?e.config.liveBackBufferLength:e.config.backBufferLength;if(!Wt(o)||o<0)return;const c=n.currentTime,h=t.levelTargetDuration,m=Math.max(o,h),g=Math.floor(c/h)*h-m;s.forEach(y=>{const E=r[y];if(E){const x=Ei.getBuffered(E);if(x.length>0&&g>x.start(0)){if(e.trigger(N.BACK_BUFFER_REACHED,{bufferEnd:g}),t.live)e.trigger(N.LIVE_BACK_BUFFER_REACHED,{bufferEnd:g});else if(E.ended&&x.end(x.length-1)-c<2*h)return void ae.info(`[buffer-controller]: Cannot flush ${y} back buffer while SourceBuffer is in ended state`);e.trigger(N.BUFFER_FLUSHING,{startOffset:0,endOffset:g,type:y})}}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||"open"!==this.mediaSource.readyState)return;const{details:e,hls:t,media:n,mediaSource:r}=this,s=e.fragments[0].start+e.totalduration,o=n.duration,c=Wt(r.duration)?r.duration:0;e.live&&t.config.liveDurationInfinity?(ae.log("[buffer-controller]: Media Source duration is set to Infinity"),r.duration=1/0,this.updateSeekableRange(e)):(s>c&&s>o||!Wt(o))&&(ae.log(`[buffer-controller]: Updating Media Source duration to ${s.toFixed(3)}`),r.duration=s)}updateSeekableRange(e){const t=this.mediaSource,n=e.fragments;if(n.length&&e.live&&null!=t&&t.setLiveSeekableRange){const s=Math.max(0,n[0].start),o=Math.max(s,s+e.totalduration);t.setLiveSeekableRange(s,o)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:n}=this,r=Object.keys(n).length;if(r&&!e||2===r){this.createSourceBuffers(n),this.pendingTracks={};const s=this.getSourceBufferTypes();if(s.length)this.hls.trigger(N.BUFFER_CREATED,{tracks:this.tracks}),s.forEach(o=>{t.executeNext(o)});else{const o=new Error("could not create source buffer for media codec(s)");this.hls.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Re.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:o,reason:o.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:n}=this;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(const r in e)if(!t[r]){const s=e[r];if(!s)throw Error(`source buffer exists for track ${r}, however track does not`);const o=s.levelCodec||s.codec,c=`${s.container};codecs=${o}`;ae.log(`[buffer-controller]: creating sourceBuffer(${c})`);try{const h=t[r]=n.addSourceBuffer(c),m=r;this.addBufferListener(m,"updatestart",this._onSBUpdateStart),this.addBufferListener(m,"updateend",this._onSBUpdateEnd),this.addBufferListener(m,"error",this._onSBUpdateError),this.tracks[r]={buffer:h,codec:o,container:s.container,levelCodec:s.levelCodec,metadata:s.metadata,id:s.id}}catch(h){ae.error(`[buffer-controller]: error while trying to add sourceBuffer: ${h.message}`),this.hls.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Re.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:h,mimeType:c})}}}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){const{operationQueue:t}=this;t.current(e).onComplete(),t.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){const n=new Error(`${e} SourceBuffer error`);ae.error(`[buffer-controller]: ${n}`,t),this.hls.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Re.BUFFER_APPENDING_ERROR,error:n,fatal:!1});const r=this.operationQueue.current(e);r&&r.onError(t)}removeExecutor(e,t,n){const{media:r,mediaSource:s,operationQueue:o,sourceBuffer:c}=this,h=c[e];if(!r||!s||!h)return ae.warn(`[buffer-controller]: Attempting to remove from the ${e} SourceBuffer, but it does not exist`),void o.shiftAndExecuteNext(e);const m=Wt(r.duration)?r.duration:1/0,g=Wt(s.duration)?s.duration:1/0,y=Math.max(0,t),E=Math.min(n,m,g);E>y&&!h.ending?(h.ended=!1,ae.log(`[buffer-controller]: Removing [${y},${E}] from the ${e} SourceBuffer`),h.remove(y,E)):o.shiftAndExecuteNext(e)}appendExecutor(e,t){const{operationQueue:n,sourceBuffer:r}=this,s=r[t];if(!s)return ae.warn(`[buffer-controller]: Attempting to append to the ${t} SourceBuffer, but it does not exist`),void n.shiftAndExecuteNext(t);s.ended=!1,s.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length)return ae.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(e);const{operationQueue:n}=this,r=t.map(s=>n.appendBlocker(s));Promise.all(r).then(()=>{e(),t.forEach(s=>{const o=this.sourceBuffer[s];null!=o&&o.updating||n.shiftAndExecuteNext(s)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,n){const r=this.sourceBuffer[e];if(!r)return;const s=n.bind(this,e);this.listeners[e].push({event:t,listener:s}),r.addEventListener(t,s)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach(n=>{t.removeEventListener(n.event,n.listener)})}},capLevelController:_I,errorController:class fk{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=ae.log.bind(ae,"[info]:"),this.warn=ae.warn.bind(ae,"[warning]:"),this.error=ae.error.bind(ae,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(N.ERROR,this.onError,this),e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(N.ERROR,this.onError,this),e.off(N.ERROR,this.onErrorOut,this),e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){this.playlistError=0}stopLoad(){}getVariantLevelIndex(e){return e?.type===ln.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n,r;if(t.fatal)return;const s=this.hls,o=t.context;switch(t.details){case Re.FRAG_LOAD_ERROR:case Re.FRAG_LOAD_TIMEOUT:case Re.KEY_LOAD_ERROR:case Re.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case Re.FRAG_PARSING_ERROR:if(null!=(n=t.frag)&&n.gap)return void(t.errorAction={action:0,flags:0});case Re.FRAG_GAP:case Re.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=2);case Re.LEVEL_EMPTY_ERROR:case Re.LEVEL_PARSING_ERROR:{var c,h;const m=t.parent===ln.MAIN?t.level:s.loadLevel;t.details===Re.LEVEL_EMPTY_ERROR&&null!=(c=t.context)&&null!=(h=c.levelDetails)&&h.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,m):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,m))}return;case Re.LEVEL_LOAD_ERROR:case Re.LEVEL_LOAD_TIMEOUT:return void("number"==typeof o?.level&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o.level)));case Re.AUDIO_TRACK_LOAD_ERROR:case Re.AUDIO_TRACK_LOAD_TIMEOUT:case Re.SUBTITLE_LOAD_ERROR:case Re.SUBTITLE_TRACK_LOAD_TIMEOUT:if(o){const m=s.levels[s.loadLevel];if(m&&(o.type===qn.AUDIO_TRACK&&o.groupId===m.audioGroupId||o.type===qn.SUBTITLE_TRACK&&o.groupId===m.textGroupId))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.loadLevel),t.errorAction.action=2,void(t.errorAction.flags=1)}return;case Re.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const g=s.levels[s.loadLevel]?.attrs["HDCP-LEVEL"];g&&(t.errorAction={action:2,flags:2,hdcpLevel:g})}return;case Re.BUFFER_ADD_CODEC_ERROR:case Re.REMUX_ALLOC_ERROR:return void(t.errorAction=this.getLevelSwitchAction(t,null!=(r=t.level)?r:s.loadLevel));case Re.INTERNAL_EXCEPTION:case Re.BUFFER_APPENDING_ERROR:case Re.BUFFER_APPEND_ERROR:case Re.BUFFER_FULL_ERROR:case Re.LEVEL_SWITCH_ERROR:case Re.BUFFER_STALLED_ERROR:case Re.BUFFER_SEEK_OVER_HOLE:case Re.BUFFER_NUDGE_ON_STALL:return void(t.errorAction={action:0,flags:0})}if(t.type===an.KEY_SYSTEM_ERROR){const m=this.getVariantLevelIndex(t.frag);return t.levelRetry=!1,void(t.errorAction=this.getLevelSwitchAction(t,m))}}getPlaylistRetryOrSwitchAction(e,t){var n;const s=xT(this.hls.config.playlistLoadPolicy,e),o=this.playlistError++,c=null==(n=e.response)?void 0:n.code;if(Qg(s,o,tu(e),c))return{action:5,flags:0,retryConfig:s,retryCount:o};const m=this.getLevelSwitchAction(e,t);return s&&(m.retryConfig=s,m.retryCount=o),m}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),r=t.levels[n],{fragLoadPolicy:s,keyLoadPolicy:o}=t.config,c=xT(e.details.startsWith("key")?o:s,e),h=t.levels.reduce((y,E)=>y+E.fragmentError,0);if(r){var m;e.details!==Re.FRAG_GAP&&r.fragmentError++;const y=null==(m=e.response)?void 0:m.code;if(Qg(c,h,tu(e),y))return{action:5,flags:0,retryConfig:c,retryCount:h}}const g=this.getLevelSwitchAction(e,n);return c&&(g.retryConfig=c,g.retryCount=h),g}getLevelSwitchAction(e,t){const n=this.hls;null==t&&(t=n.loadLevel);const r=this.hls.levels[t];if(r&&(r.loadError++,n.autoLevelEnabled)){var s,o;let c=-1;const{levels:h,loadLevel:m,minAutoLevel:g,maxAutoLevel:y}=n,E=null==(s=e.frag)?void 0:s.type,{type:x,groupId:S}=null!=(o=e.context)?o:{};for(let R=h.length;R--;){const L=(R+m)%h.length;if(L!==m&&L>=g&&L<=y&&0===h[L].loadError){const G=h[L];if(e.details===Re.FRAG_GAP&&e.frag){const Y=h[L].details;if(Y){const K=Zm(e.frag,Y.fragments,e.frag.start);if(null!=K&&K.gap)continue}}else{if(x===qn.AUDIO_TRACK&&S===G.audioGroupId||x===qn.SUBTITLE_TRACK&&S===G.textGroupId)continue;if(E===ln.AUDIO&&r.audioGroupId===G.audioGroupId||E===ln.SUBTITLE&&r.textGroupId===G.textGroupId)continue}c=L;break}}if(c>-1&&n.loadLevel!==c)return e.levelRetry=!0,this.playlistError=0,{action:2,flags:0,nextAutoLevel:c}}return{action:2,flags:1}}onErrorOut(e,t){var n;switch(null==(n=t.errorAction)?void 0:n.action){case 0:break;case 2:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==Re.FRAG_GAP&&(t.fatal=!0)}t.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:r,hdcpLevel:s,nextAutoLevel:o}=n;switch(r){case 0:this.switchLevel(e,o);break;case 1:n.resolved||(n.resolved=this.redundantFailover(e));break;case 2:s&&(t.maxHdcpLevel=p0[p0.indexOf(s)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`)}n.resolved||this.switchLevel(e,o)}switchLevel(e,t){void 0!==t&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}redundantFailover(e){const{hls:t,penalizedRenditions:n}=this,r=e.parent===ln.MAIN?e.level:t.loadLevel,s=t.levels[r],o=s.url.length,c=e.frag?e.frag.urlId:s.urlId;s.urlId===c&&(!e.frag||s.details)&&this.penalizeRendition(s,e);for(let h=1;h<o;h++){const m=(c+h)%o,g=n[m];if(!g||DT(g,e,n[c]))return this.warn(`Switching to Redundant Stream ${m+1}/${o}: "${s.url[m]}" after ${e.details}`),this.playlistError=0,t.levels.forEach(y=>{y.urlId=m}),t.nextLoadLevel=r,!0}return!1}penalizeRendition(e,t){const{penalizedRenditions:n}=this,r=n[e.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};r.lastErrorPerfMs=performance.now(),r.errors.push(t),r.details=e.details,n[e.urlId]=r}},fpsController:class sL{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(N.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(N.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const r=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=r,r&&"function"==typeof r.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,n){const r=performance.now();if(t){if(this.lastTime){const o=n-this.lastDroppedFrames,c=t-this.lastDecodedFrames,h=1e3*o/(r-this.lastTime),m=this.hls;if(m.trigger(N.FPS_DROP,{currentDropped:o,currentDecoded:c,totalDroppedFrames:n}),h>0&&o>m.config.fpsDroppedMonitoringThreshold*c){let g=m.currentLevel;ae.warn("drop FPS ratio greater than max allowed value for currentLevel: "+g),g>0&&(-1===m.autoLevelCapping||m.autoLevelCapping>=g)&&(g-=1,m.trigger(N.FPS_DROP_LEVEL_CAPPING,{level:g,droppedLevel:m.currentLevel}),m.autoLevelCapping=g,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:qx,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},function TI(){return{cueHandler:EI,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}()),{},{subtitleStreamController:class iI extends t_{constructor(e,t,n){super(e,t,n,"[subtitle-stream-controller]",ln.SUBTITLE),this.levels=[],this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.LEVEL_LOADED,this.onLevelLoaded,this),e.on(N.ERROR,this.onError,this),e.on(N.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(N.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(N.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(N.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(N.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(N.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.LEVEL_LOADED,this.onLevelLoaded,this),e.off(N.ERROR,this.onError,this),e.off(N.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(N.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(N.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(N.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(N.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(N.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state="IDLE",this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:r}=t;if(this.fragPrevious=n,this.state="IDLE",!r)return;const s=this.tracksBuffered[this.currentTrackId];if(!s)return;let o;const c=n.start;for(let m=0;m<s.length;m++)if(c>=s[m].start&&c<=s[m].end){o=s[m];break}const h=n.start+n.duration;o?o.end=h:(o={start:c,end:h},s.push(o)),this.fragmentTracker.fragBuffered(n)}onBufferFlushing(e,t){const{startOffset:n,endOffset:r}=t;if(0===n&&r!==Number.POSITIVE_INFINITY){const s=r-1;if(s<=0)return;t.endOffsetSubtitles=Math.max(0,s),this.tracksBuffered.forEach(o=>{for(let c=0;c<o.length;)if(o[c].end<=s)o.shift();else{if(!(o[c].start<s))break;o[c].start=s,c++}}),this.fragmentTracker.removeFragmentsInRange(n,s,ln.SUBTITLE)}}onFragBuffered(e,t){var n;this.loadedmetadata||t.frag.type!==ln.MAIN||null!=(n=this.media)&&n.buffered.length&&(this.loadedmetadata=!0)}onError(e,t){t.frag?.type===ln.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),"STOPPED"!==this.state&&(this.state="IDLE"))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){tI(this.levels,t)?this.levels=t.map(n=>new Ym(n)):(this.tracksBuffered=[],this.levels=t.map(n=>{const r=new Ym(n);return this.tracksBuffered[r.id]=[],r}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,ln.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(e,t){if(this.currentTrackId=t.id,!this.levels.length||-1===this.currentTrackId)return void this.clearInterval();const n=this.levels[this.currentTrackId];this.mediaBuffer=null!=n&&n.details?this.mediaBufferTimeRanges:null,n&&this.setInterval(500)}onSubtitleTrackLoaded(e,t){var n;const{details:r,id:s}=t,{currentTrackId:o,levels:c}=this;if(!c.length)return;const h=c[o];if(s>=c.length||s!==o||!h)return;this.mediaBuffer=this.mediaBufferTimeRanges;let m=0;if(r.live||null!=(n=h.details)&&n.live){const g=this.mainDetails;if(r.deltaUpdateFailed||!g)return;const y=g.fragments[0];h.details?(m=this.alignPlaylists(r,h.details),0===m&&y&&(m=y.start,Zg(r,m))):r.hasProgramDateTime&&g.hasProgramDateTime?(e_(r,g),m=r.fragments[0].start):y&&(m=y.start,Zg(r,m))}h.details=r,this.levelLastLoaded=s,!this.startFragRequested&&(this.mainDetails||!r.live)&&this.setStartPosition(h.details,m),this.tick(),r.live&&!this.fragCurrent&&this.media&&"IDLE"===this.state&&(Zm(null,r.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),h.details=void 0))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,r=t.decryptdata,s=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&r&&r.key&&r.iv&&"AES-128"===r.method){const o=performance.now();this.decrypter.decrypt(new Uint8Array(n),r.key.buffer,r.iv.buffer).catch(c=>{throw s.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Re.FRAG_DECRYPT_ERROR,fatal:!1,error:c,reason:c.message,frag:t}),c}).then(c=>{const h=performance.now();s.trigger(N.FRAG_DECRYPTED,{frag:t,payload:c,stats:{tstart:o,tdecrypt:h}})}).catch(c=>{this.warn(`${c.name}: ${c.message}`),this.state="IDLE"})}}doTick(){if(this.media){if("IDLE"===this.state){const{currentTrackId:e,levels:t}=this,n=t[e];if(!t.length||!n||!n.details)return;const{config:r}=this,s=this.getLoadPosition(),o=Ei.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],s,r.maxBufferHole),{end:c,len:h}=o,m=this.getFwdBufferInfo(this.media,ln.MAIN),g=n.details;if(h>this.getMaxBufferLength(m?.len)+g.levelTargetDuration)return;const E=g.fragments,x=E.length,S=g.edge;let R=null;const L=this.fragPrevious;if(c<S){const G=r.maxFragLookUpTolerance,Y=c>S-G?0:G;R=Zm(L,E,Math.max(E[0].start,c),Y),!R&&L&&L.start<E[0].start&&(R=E[0])}else R=E[x-1];if(!R)return;if(R=this.mapToInitFragWhenRequired(R),"initSegment"!==R.sn){const Y=E[R.sn-g.startSN-1];Y&&Y.cc===R.cc&&"NOT_LOADED"===this.fragmentTracker.getState(Y)&&(R=Y)}"NOT_LOADED"===this.fragmentTracker.getState(R)&&this.loadFragment(R,n,c)}}else this.state="IDLE"}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,n){this.fragCurrent=e,"initSegment"===e.sn?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,n))}get mediaBufferTimeRanges(){return new qk(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class Yk extends b0{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.trackChangeListener=()=>this.onTextTracksChanged(),this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes(this.trackId)}registerListeners(){const{hls:e}=this;e.on(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.MANIFEST_PARSED,this.onManifestParsed,this),e.on(N.LEVEL_LOADING,this.onLevelLoading,this),e.on(N.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(N.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(N.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.MANIFEST_PARSED,this.onManifestParsed,this),e.off(N.LEVEL_LOADING,this.onLevelLoading,this),e.off(N.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(N.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(N.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,e)}onMediaDetaching(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),Z0(this.media.textTracks).forEach(t=>{Wh(t)}),this.subtitleTrack=-1,this.media=null)}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,details:r}=t,{trackId:s}=this,o=this.tracksInGroup[s];if(!o)return void this.warn(`Invalid subtitle track id ${n}`);const c=o.details;o.details=t.details,this.log(`subtitle track ${n} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,c)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(null==t||!t.textGroupIds)return;const n=t.textGroupIds[t.urlId],r=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;if(this.groupId!==n){const s=this.tracks.filter(h=>!n||h.groupId===n);this.tracksInGroup=s;const o=this.findTrackId(r?.name)||this.findTrackId();this.groupId=n||null;const c={subtitleTracks:s};this.log(`Updating subtitle tracks, ${s.length} track(s) found in "${n}" group-id`),this.hls.trigger(N.SUBTITLE_TRACKS_UPDATED,c),-1!==o&&this.setSubtitleTrack(o,r)}else this.shouldReloadPlaylist(r)&&this.setSubtitleTrack(this.trackId,r)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if((!this.selectDefaultTrack||r.default)&&(!e||e===r.name))return r.id}return-1}onError(e,t){t.fatal||!t.context||t.context.type===qn.SUBTITLE_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.checkRetry(t)}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e,this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0)}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const n=t.id,r=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`Loading subtitle playlist for id ${n}`),this.hls.trigger(N.SUBTITLE_TRACK_LOADING,{url:s,id:n,groupId:r,deliveryDirectives:e||null})}}toggleTrackModes(e){const{media:t,trackId:n}=this;if(!t)return;const r=Z0(t.textTracks),s=r.filter(c=>c.groupId===this.groupId);if(-1===e)[].slice.call(r).forEach(c=>{c.mode="disabled"});else{const c=s[n];c&&(c.mode="disabled")}const o=s[e];o&&(o.mode=this.subtitleDisplay?"showing":"hidden")}setSubtitleTrack(e,t){var n;const r=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=e);if(this.trackId!==e&&this.toggleTrackModes(e),this.trackId===e&&(-1===e||null!=(n=r[e])&&n.details)||e<-1||e>=r.length)return;this.clearTimer();const s=r[e];if(this.log(`Switching to subtitle-track ${e}`+(s?` "${s.name}" lang:${s.lang} group:${s.groupId}`:"")),this.trackId=e,s){const{id:o,groupId:c="",name:h,type:m,url:g}=s;this.hls.trigger(N.SUBTITLE_TRACK_SWITCH,{id:o,groupId:c,name:h,type:m,url:g});const y=this.switchParams(s.url,t?.details);this.loadPlaylist(y)}else this.hls.trigger(N.SUBTITLE_TRACK_SWITCH,{id:e})}onTextTracksChanged(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=-1;const t=Z0(this.media.textTracks);for(let n=0;n<t.length;n++)if("hidden"===t[n].mode)e=n;else if("showing"===t[n].mode){e=n;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}},timelineController:class oR{constructor(e){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){const t=new __(this,"textTrack1"),n=new __(this,"textTrack2"),r=new __(this,"textTrack3"),s=new __(this,"textTrack4");this.cea608Parser1=new ib(1,t,n),this.cea608Parser2=new ib(3,r,s)}e.on(N.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(N.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(N.FRAG_LOADING,this.onFragLoading,this),e.on(N.FRAG_LOADED,this.onFragLoaded,this),e.on(N.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(N.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(N.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(N.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(N.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(N.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(N.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(N.FRAG_LOADING,this.onFragLoading,this),e.off(N.FRAG_LOADED,this.onFragLoaded,this),e.off(N.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(N.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(N.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(N.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(N.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null}addCues(e,t,n,r,s){let o=!1;for(let c=s.length;c--;){const h=s[c],m=aR(h[0],h[1],t,n);if(m>=0&&(h[0]=Math.min(h[0],t),h[1]=Math.max(h[1],n),o=!0,m/(n-t)>.5))return}if(o||s.push([t,n]),this.config.renderTextTracksNatively)this.Cues.newCue(this.captionsTracks[e],t,n,r);else{const c=this.Cues.newCue(null,t,n,r);this.hls.trigger(N.CUES_PARSED,{type:"captions",cues:c,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:s}){const{unparsedVttFrags:o}=this;"main"===n&&(this.initPTS[t.cc]={baseTime:r,timescale:s}),o.length&&(this.unparsedVttFrags=[],o.forEach(c=>{this.onFragLoaded(N.FRAG_LOADED,c)}))}getExistingTrack(e){const{media:t}=this;if(t)for(let n=0;n<t.textTracks.length;n++){const r=t.textTracks[n];if(r[e])return r}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:r}=this,{label:s,languageCode:o}=t[e],c=this.getExistingTrack(e);if(c)n[e]=c,Wh(n[e]),yT(n[e],r);else{const h=this.createTextTrack("captions",s,o);h&&(h[e]=!0,n[e]=h)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const r={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(N.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,t,n){const r=this.media;if(r)return r.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{Wh(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)Wh(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],r=n.some(s=>s.textCodec===mI);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){if(tI(this.tracks,n))return void(this.tracks=n);if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const o=this.media?this.media.textTracks:null;this.tracks.forEach((c,h)=>{let m;if(o&&h<o.length){let g=null;for(let y=0;y<o.length;y++)if(E_(o[y],c)){g=o[y];break}g&&(m=g)}if(m)Wh(m);else{const g=this._captionsOrSubtitlesFromCharacteristics(c);m=this.createTextTrack(g,c.name,c.lang),m&&(m.mode="disabled")}m&&(m.groupId=c.groupId,this.textTracks.push(m))})}else if(this.tracks.length){const o=this.tracks.map(c=>({label:c.name,kind:c.type.toLowerCase(),default:c.default,subtitleTrack:c}));this.hls.trigger(N.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}_captionsOrSubtitlesFromCharacteristics(e){if(e.attrs.CHARACTERISTICS){const t=/transcribes-spoken-dialog/gi.test(e.attrs.CHARACTERISTICS),n=/describes-music-and-sound/gi.test(e.attrs.CHARACTERISTICS);if(t&&n)return"captions"}return"subtitles"}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{const r=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!r)return;const o=this.captionsProperties[`textTrack${r[1]}`];o&&(o.label=n.name,n.lang&&(o.languageCode=n.lang),o.media=n)})}closedCaptionsForLevel(e){return this.hls.levels[e.level]?.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){const{cea608Parser1:n,cea608Parser2:r,lastSn:s,lastPartIndex:o}=this;if(this.enabled&&n&&r&&t.frag.type===ln.MAIN){var c,h;const m=t.frag.sn,g=null!=(c=null==t||null==(h=t.part)?void 0:h.index)?c:-1;m===s+1||m===s&&g===o+1||(n.reset(),r.reset()),this.lastSn=m,this.lastPartIndex=g}}onFragLoaded(e,t){const{frag:n,payload:r}=t;if(n.type===ln.SUBTITLE)if(r.byteLength){const s=n.decryptdata;if(null==s||!s.encrypted||"stats"in t){const c=this.tracks[n.level],h=this.vttCCs;h[n.cc]||(h[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),c&&c.textCodec===mI?this._parseIMSC1(n,r):this._parseVTTs(t)}}else this.hls.trigger(N.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;lb(t,this.initPTS[e.cc],r=>{this._appendCues(r,e.level),n.trigger(N.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},r=>{ae.log(`Failed to parse IMSC1: ${r}`),n.trigger(N.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:r})})}_parseVTTs(e){var t;const{frag:n,payload:r}=e,{initPTS:s,unparsedVttFrags:o}=this,c=s.length-1;if(!s[n.cc]&&-1===c)return void o.push(e);const h=this.hls;!function iL(i,e,t,n,r,s,o){const c=new eL,h=Oa(new Uint8Array(i)).trim().replace(uI,"\n").split("\n"),m=[],g=e?function Bk(i,e=1){return B0(i,Xh,1/e)}(e.baseTime,e.timescale):0;let S,y="00:00.000",E=0,x=0,R=!0;c.oncue=function(L){const G=t[n];let Y=t.ccOffset;const K=(E-g)/9e4;if(null!=G&&G.new&&(void 0!==x?Y=t.ccOffset=G.start:nL(t,n,K)),K){if(!e)return void(S=new Error("Missing initPTS for VTT MPEGTS"));Y=K-t.presentationOffset}const te=L.endTime-L.startTime,oe=Fs(9e4*(L.startTime+Y-x),9e4*r)/9e4;L.startTime=Math.max(oe,0),L.endTime=Math.max(oe+te,0);const Ae=L.text.trim();L.text=decodeURIComponent(encodeURIComponent(Ae)),L.id||(L.id=fI(L.startTime,L.endTime,Ae)),L.endTime>0&&m.push(L)},c.onparsingerror=function(L){S=L},c.onflush=function(){S?o(S):s(m)},h.forEach(L=>{if(R){if(dI(L,"X-TIMESTAMP-MAP=")){R=!1,L.slice(16).split(",").forEach(G=>{dI(G,"LOCAL:")?y=G.slice(6):dI(G,"MPEGTS:")&&(E=parseInt(G.slice(7)))});try{x=tL(y)/1e3}catch(G){S=G}return}""===L&&(R=!1)}c.parse(L+"\n")}),c.flush()}(null!=(t=n.initSegment)&&t.data?ld(n.initSegment.data,new Uint8Array(r)):r,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,g=>{this._appendCues(g,n.level),h.trigger(N.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},g=>{const y="Missing initPTS for VTT MPEGTS"===g.message;y?o.push(e):this._fallbackToIMSC1(n,r),ae.log(`Failed to parse VTT cue: ${g}`),!(y&&c>n.cc)&&h.trigger(N.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:g})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||lb(t,this.initPTS[e.cc],()=>{n.textCodec=mI,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const r=this.textTracks[t];if(!r||"disabled"===r.mode)return;e.forEach(s=>zh(r,s))}else{const r=this.tracks[t];if(!r)return;n.trigger(N.CUES_PARSED,{type:"subtitles",cues:e,track:r.default?"default":"subtitles"+t})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===ln.SUBTITLE&&this.onFragLoaded(N.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){const{cea608Parser1:n,cea608Parser2:r}=this;if(!this.enabled||!n||!r)return;const{frag:s,samples:o}=t;if(s.type!==ln.MAIN||"NONE"!==this.closedCaptionsForLevel(s))for(let c=0;c<o.length;c++){const h=o[c].bytes;if(h){const m=this.extractCea608Data(h);n.addData(o[c].pts,m[0]),r.addData(o[c].pts,m[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:r,type:s}){const{media:o}=this;if(o&&!(o.currentTime<n)){if(!s||"video"===s){const{captionsTracks:c}=this;Object.keys(c).forEach(h=>m0(c[h],t,n))}if(this.config.renderTextTracksNatively&&0===t&&void 0!==r){const{textTracks:c}=this;Object.keys(c).forEach(h=>m0(c[h],t,r))}}}extractCea608Data(e){const t=[[],[]],n=31&e[0];let r=2;for(let s=0;s<n;s++){const o=e[r++],c=127&e[r++],h=127&e[r++];if((0!==c||0!==h)&&0!=(4&o)){const g=3&o;(0===g||1===g)&&(t[g].push(c),t[g].push(h))}}return t}},audioStreamController:class q0 extends t_{constructor(e,t,n){super(e,t,n,"[audio-stream-controller]",ln.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.LEVEL_LOADED,this.onLevelLoaded,this),e.on(N.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(N.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(N.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(N.ERROR,this.onError,this),e.on(N.BUFFER_RESET,this.onBufferReset,this),e.on(N.BUFFER_CREATED,this.onBufferCreated,this),e.on(N.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(N.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(N.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(N.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(N.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.LEVEL_LOADED,this.onLevelLoaded,this),e.off(N.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(N.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(N.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(N.ERROR,this.onError,this),e.off(N.BUFFER_RESET,this.onBufferReset,this),e.off(N.BUFFER_CREATED,this.onBufferCreated,this),e.off(N.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(N.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(N.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:s}){if("main"===n){const o=t.cc;this.initPTS[t.cc]={baseTime:r,timescale:s},this.log(`InitPTS for cc: ${o} found from main: ${r}`),this.videoTrackCC=o,"WAITING_INIT_PTS"===this.state&&this.tick()}}startLoad(e){if(!this.levels)return this.startPosition=e,void(this.state="STOPPED");const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),t>0&&-1===e?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state="IDLE"):(this.loadedmetadata=!1,this.state="WAITING_TRACK"),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case"IDLE":this.doTickIdle();break;case"WAITING_TRACK":{var e;const{levels:n,trackId:r}=this,s=null==n||null==(e=n[r])?void 0:e.details;if(s){if(this.waitForCdnTuneIn(s))break;this.state="WAITING_INIT_PTS"}break}case"FRAG_LOADING_WAITING_RETRY":{var t;const n=performance.now(),r=this.retryDate;(!r||n>=r||null!=(t=this.media)&&t.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state="IDLE");break}case"WAITING_INIT_PTS":{const n=this.waitingData;if(n){const{frag:r,part:s,cache:o,complete:c}=n;if(void 0!==this.initPTS[r.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state="FRAG_LOADING";const m={frag:r,part:s,payload:o.flush(),networkDetails:null};this._handleFragmentLoadProgress(m),c&&super._handleFragmentLoadComplete(m)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${r.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const h=this.getLoadPosition(),m=Ei.bufferInfo(this.mediaBuffer,h,this.config.maxBufferHole);v0(m.end,this.config.maxFragLookUpTolerance,r)<0&&(this.log(`Waiting fragment cc (${r.cc}) @ ${r.start} cancelled because another fragment at ${m.end} is needed`),this.clearWaitingFragment())}}else this.state="IDLE"}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state="IDLE")}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:n,trackId:r}=this;if(null==t||!t[r]||!n&&(this.startFragRequested||!e.config.startFragPrefetch))return;const o=t[r],c=o.details;if(!c||c.live&&this.levelLastLoaded!==r||this.waitForCdnTuneIn(c))return void(this.state="WAITING_TRACK");const h=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&h&&(this.bufferFlushed=!1,this.afterBufferFlushed(h,Wn.AUDIO,ln.AUDIO));const m=this.getFwdBufferInfo(h,ln.AUDIO);if(null===m)return;const{bufferedTrack:g,switchingTrack:y}=this;if(!y&&this._streamEnded(m,c))return e.trigger(N.BUFFER_EOS,{type:"audio"}),void(this.state="ENDED");const E=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,ln.MAIN),x=m.len,S=this.getMaxBufferLength(E?.len);if(x>=S&&!y)return;const L=c.fragments[0].start;let G=m.end;if(y&&n){const oe=this.getLoadPosition();g&&y.attrs!==g.attrs&&(G=oe),c.PTSKnown&&oe<L&&(m.end>L||m.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=L+.05)}let Y=this.getNextFragment(G,c),K=!1;if(Y&&this.isLoopLoading(Y,G)&&(K=!!Y.gap,Y=this.getNextFragmentLoopLoading(Y,c,m,ln.MAIN,S)),!Y)return void(this.bufferFlushed=!0);const te=E&&Y.start>E.end+c.targetduration;if(te||(null==E||!E.len)&&m.len){const oe=this.getAppendedFrag(Y.start,ln.MAIN);if(null===oe||(K||(K=!!oe.gap||!!te&&0===E.len),te&&!K||K&&m.nextStart&&m.nextStart<oe.end))return}this.loadFragment(Y,o,G)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new Ym(n))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),n?this.setInterval(100):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state="IDLE"):(this.switchingTrack=null,this.bufferedTrack=t,this.state="STOPPED"),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(N.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var n;if(null==this.mainDetails)return void(this.cachedTrackLoadedData=t);const{levels:r}=this,{details:s,id:o}=t;if(!r)return void this.warn(`Audio tracks were reset while loading level ${o}`);this.log(`Track ${o} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`);const c=r[o];let h=0;if(s.live||null!=(n=c.details)&&n.live){this.checkLiveUpdate(s);const m=this.mainDetails;if(s.deltaUpdateFailed||!m)return;!c.details&&s.hasProgramDateTime&&m.hasProgramDateTime?(e_(s,m),h=s.fragments[0].start):h=this.alignPlaylists(s,c.details)}c.details=s,this.levelLastLoaded=o,!this.startFragRequested&&(this.mainDetails||!s.live)&&this.setStartPosition(c.details,h),"WAITING_TRACK"===this.state&&!this.waitForCdnTuneIn(s)&&(this.state="IDLE"),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:r,payload:s}=e,{config:o,trackId:c,levels:h}=this;if(!h)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const m=h[c];if(!m)return void this.warn("Audio track is undefined on fragment load progress");const g=m.details;if(!g)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(n.start);const y=o.defaultAudioCodec||m.audioCodec||"mp4a.40.2";let E=this.transmuxer;E||(E=this.transmuxer=new W0(this.hls,ln.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const x=this.initPTS[n.cc],S=null==(t=n.initSegment)?void 0:t.data;if(void 0!==x){const L=r?r.index:-1,Y=new E0(n.level,n.sn,n.stats.chunkCount,s.byteLength,L,-1!==L);E.push(s,S,y,"",n,r,g.totalduration,!1,Y,x)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${g.startSN} ,${g.endSN}],track ${c}`);const{cache:R}=this.waitingData=this.waitingData||{frag:n,part:r,cache:new Kk,complete:!1};R.push(new Uint8Array(s)),this.waitingVideoCC=this.videoTrackCC,this.state="WAITING_INIT_PTS"}}_handleFragmentLoadComplete(e){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:n,part:r}=t;if(n.type===ln.AUDIO)if(this.fragContextChanged(n))this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if("initSegment"!==n.sn){this.fragPrevious=n;const s=this.switchingTrack;s&&(this.bufferedTrack=s,this.switchingTrack=null,this.hls.trigger(N.AUDIO_TRACK_SWITCHED,Yr({},s)))}this.fragBufferedComplete(n,r)}else if(!this.loadedmetadata&&n.type===ln.MAIN){const s=this.videoBuffer||this.media;s&&Ei.getBuffered(s).length&&(this.loadedmetadata=!0)}}onError(e,t){var n;if(t.fatal)this.state="ERROR";else switch(t.details){case Re.FRAG_GAP:case Re.FRAG_PARSING_ERROR:case Re.FRAG_DECRYPT_ERROR:case Re.FRAG_LOAD_ERROR:case Re.FRAG_LOAD_TIMEOUT:case Re.KEY_LOAD_ERROR:case Re.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ln.AUDIO,t);break;case Re.AUDIO_TRACK_LOAD_ERROR:case Re.AUDIO_TRACK_LOAD_TIMEOUT:case Re.LEVEL_PARSING_ERROR:!t.levelRetry&&"WAITING_TRACK"===this.state&&(null==(n=t.context)?void 0:n.type)===qn.AUDIO_TRACK&&(this.state="IDLE");break;case Re.BUFFER_FULL_ERROR:if(!t.parent||"audio"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case Re.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}onBufferFlushed(e,{type:t}){t===Wn.AUDIO&&(this.bufferFlushed=!0,"ENDED"===this.state&&(this.state="IDLE"))}_handleTransmuxComplete(e){var t;const n="audio",{hls:r}=this,{remuxResult:s,chunkMeta:o}=e,c=this.getCurrentContext(o);if(!c)return void this.resetWhenMissingContext(o);const{frag:h,part:m,level:g}=c,{details:y}=g,{audio:E,text:x,id3:S,initSegment:R}=s;if(!this.fragContextChanged(h)&&y){if(this.state="PARSING",this.switchingTrack&&E&&this.completeAudioSwitch(this.switchingTrack),null!=R&&R.tracks){const L=h.initSegment||h;this._bufferInitSegment(R.tracks,L,o),r.trigger(N.FRAG_PARSING_INIT_SEGMENT,{frag:L,id:n,tracks:R.tracks})}if(E){const{startPTS:L,endPTS:G,startDTS:Y,endDTS:K}=E;m&&(m.elementaryStreams[Wn.AUDIO]={startPTS:L,endPTS:G,startDTS:Y,endDTS:K}),h.setElementaryStreamInfo(Wn.AUDIO,L,G,Y,K),this.bufferFragmentData(E,h,m,o)}if(null!=S&&null!=(t=S.samples)&&t.length){const L=Sr({id:n,frag:h,details:y},S);r.trigger(N.FRAG_PARSING_METADATA,L)}if(x){const L=Sr({id:n,frag:h,details:y},x);r.trigger(N.FRAG_PARSING_USERDATA,L)}}else this.fragmentTracker.removeFragment(h)}_bufferInitSegment(e,t,n){if("PARSING"!==this.state)return;e.video&&delete e.video;const r=e.audio;if(!r)return;r.levelCodec=r.codec,r.id="audio",this.log(`Init audio buffer, container:${r.container}, codecs[parsed]=[${r.codec}]`),this.hls.trigger(N.BUFFER_CODECS,e);const s=r.initSegment;null!=s&&s.byteLength&&this.hls.trigger(N.BUFFER_APPENDING,{type:"audio",frag:t,part:null,chunkMeta:n,parent:t.type,data:s}),this.tick()}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);var s;this.fragCurrent=e,this.switchingTrack||"NOT_LOADED"===r||"PARTIAL"===r?"initSegment"===e.sn?this._loadInitSegment(e,t):null!=(s=t.details)&&s.live&&!this.initPTS[e.cc]?(this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state="WAITING_INIT_PTS"):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}completeAudioSwitch(e){const{hls:t,media:n,bufferedTrack:r}=this,s=r?.attrs,o=e.attrs;n&&s&&(s.CHANNELS!==o.CHANNELS||s.NAME!==o.NAME||s.LANGUAGE!==o.LANGUAGE)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio")),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(N.AUDIO_TRACK_SWITCHED,Yr({},e))}},audioTrackController:class rp extends b0{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.MANIFEST_PARSED,this.onManifestParsed,this),e.on(N.LEVEL_LOADING,this.onLevelLoading,this),e.on(N.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(N.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(N.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.MANIFEST_PARSED,this.onManifestParsed,this),e.off(N.LEVEL_LOADING,this.onLevelLoading,this),e.off(N.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(N.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(N.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:r,details:s}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==r)return void this.warn(`Track with id:${n} and group:${r} not found in active group ${o.groupId}`);const c=o.details;o.details=t.details,this.log(`audio-track ${n} "${o.name}" lang:${o.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,c)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(null==t||!t.audioGroupIds)return;const n=t.audioGroupIds[t.urlId];if(this.groupId!==n){this.groupId=n||null;const r=this.tracks.filter(o=>!n||o.groupId===n);this.selectDefaultTrack&&!r.some(o=>o.default)&&(this.selectDefaultTrack=!1),this.tracksInGroup=r;const s={audioTracks:r};this.log(`Updating audio tracks, ${r.length} track(s) found in group:${n}`),this.hls.trigger(N.AUDIO_TRACKS_UPDATED,s),this.selectInitialTrack()}else this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===qn.AUDIO_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(t))}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length)return void this.warn("Invalid id passed to audio-track controller");this.clearTimer();const n=this.currentTrack,r=t[e],{groupId:s,name:o}=r;if(this.log(`Switching to audio-track ${e} "${o}" lang:${r.lang} group:${s}`),this.trackId=e,this.currentTrack=r,this.selectDefaultTrack=!1,this.hls.trigger(N.AUDIO_TRACK_SWITCHING,Yr({},r)),r.details&&!r.details.live)return;const c=this.switchParams(r.url,n?.details);this.loadPlaylist(c)}selectInitialTrack(){const e=this.tracksInGroup,t=this.findTrackId(this.currentTrack)|this.findTrackId(null);if(-1!==t)this.setAudioTrack(t);else{const n=new Error(`No track found for running audio group-ID: ${this.groupId} track count: ${e.length}`);this.warn(n.message),this.hls.trigger(N.ERROR,{type:an.MEDIA_ERROR,details:Re.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:n})}}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if((!this.selectDefaultTrack||r.default)&&(!e||void 0!==e.attrs["STABLE-RENDITION-ID"]&&e.attrs["STABLE-RENDITION-ID"]===r.attrs["STABLE-RENDITION-ID"]||e.name===r.name&&e.lang===r.lang))return r.id}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const n=t.id,r=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`loading audio-track playlist ${n} "${t.name}" lang:${t.lang} group:${r}`),this.clearTimer(),this.hls.trigger(N.AUDIO_TRACK_LOADING,{url:s,id:n,groupId:r,deliveryDirectives:e||null})}}},emeController:cR,cmcdController:sc,contentSteeringController:class Fa{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=ae.log.bind(ae,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(N.MANIFEST_LOADING,this.onManifestLoading,this),e.on(N.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(N.MANIFEST_PARSED,this.onManifestParsed,this),e.on(N.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(N.MANIFEST_LOADING,this.onManifestLoading,this),e.off(N.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(N.MANIFEST_PARSED,this.onManifestParsed,this),e.off(N.ERROR,this.onError,this))}startLoad(){if(this.started=!0,self.clearTimeout(this.reloadTimer),this.enabled&&this.uri)if(this.updated){const e=Math.max(1e3*this.timeToLoad-(performance.now()-this.updated),0);this.scheduleRefresh(this.uri,e)}else this.loadSteeringManifest(this.uri)}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),self.clearTimeout(this.reloadTimer)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;null!==n&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if(2===n?.action&&1===n.flags){let r=this.pathwayPriority;const s=this.pathwayId;this.penalizedPathways[s]||(this.penalizedPathways[s]=performance.now()),!r&&this.levels&&(r=this.levels.reduce((o,c)=>(-1===o.indexOf(c.pathwayId)&&o.push(c.pathwayId),o),[])),r&&r.length>1&&(this.updatePathwayPriority(r),n.resolved=this.pathwayId!==s)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length?(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t):e}getLevelsForPathway(e){return null===this.levels?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){let t;this.pathwayPriority=e;const n=this.penalizedPathways,r=performance.now();Object.keys(n).forEach(s=>{r-n[s]>3e5&&delete n[s]});for(let s=0;s<e.length;s++){const o=e[s];if(n[o])continue;if(o===this.pathwayId)return;const c=this.hls.nextLoadLevel,h=this.hls.levels[c];if(t=this.getLevelsForPathway(o),t.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,this.hls.trigger(N.LEVELS_UPDATED,{levels:t});const m=this.hls.levels[c];h&&m&&this.levels&&(m.attrs["STABLE-VARIANT-ID"]!==h.attrs["STABLE-VARIANT-ID"]&&m.bitrate!==h.bitrate&&this.log(`Unstable Pathways change from bitrate ${h.bitrate} to ${m.bitrate}`),this.hls.nextLoadLevel=c);break}}}clonePathways(e){const t=this.levels;if(!t)return;const n={},r={};e.forEach(s=>{const{ID:o,"BASE-ID":c,"URI-REPLACEMENT":h}=s;if(t.some(g=>g.pathwayId===o))return;const m=this.getLevelsForPathway(c).map(g=>{const y=Sr({},g);y.details=void 0,y.url=T_(g.uri,g.attrs["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",h);const E=new Fi(g.attrs);E["PATHWAY-ID"]=o;const x=E.AUDIO&&`${E.AUDIO}_clone_${o}`,S=E.SUBTITLES&&`${E.SUBTITLES}_clone_${o}`;x&&(n[E.AUDIO]=x,E.AUDIO=x),S&&(r[E.SUBTITLES]=S,E.SUBTITLES=S),y.attrs=E;const R=new Ym(y);return Jm(R,"audio",x),Jm(R,"text",S),R});t.push(...m),vI(this.audioTracks,n,h,o),vI(this.subtitleTracks,r,h,o)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;let r;this.loader&&this.loader.destroy(),this.loader=new n(t);try{r=new self.URL(e)}catch{return this.enabled=!1,void this.log(`Failed to parse Steering Manifest URI: ${e}`)}if("data:"!==r.protocol){const g=0|(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate);r.searchParams.set("_HLS_pathway",this.pathwayId),r.searchParams.set("_HLS_throughput",""+g)}const s={responseType:"json",url:r.href},o=t.steeringManifestLoadPolicy.default,c=o.errorRetry||o.timeoutRetry||{},h={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:c.maxNumRetry||0,retryDelay:c.retryDelayMs||0,maxRetryDelay:c.maxRetryDelayMs||0},m={onSuccess:(g,y,E,x)=>{this.log(`Loaded steering manifest: "${r}"`);const S=g.data;if(1!==S.VERSION)return void this.log(`Steering VERSION ${S.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=S.TTL;const{"RELOAD-URI":R,"PATHWAY-CLONES":L,"PATHWAY-PRIORITY":G}=S;if(R)try{this.uri=new self.URL(R,r).href}catch{return this.enabled=!1,void this.log(`Failed to parse Steering Manifest RELOAD-URI: ${R}`)}this.scheduleRefresh(this.uri||E.url),L&&this.clonePathways(L),G&&this.updatePathwayPriority(G)},onError:(g,y,E,x)=>{if(this.log(`Error loading steering manifest: ${g.code} ${g.text} (${y.url})`),this.stopLoad(),410===g.code)return this.enabled=!1,void this.log(`Steering manifest ${y.url} no longer available`);let S=1e3*this.timeToLoad;if(429!==g.code)this.scheduleRefresh(this.uri||y.url,S);else{const R=this.loader;if("function"==typeof R?.getResponseHeader){const L=R.getResponseHeader("Retry-After");L&&(S=1e3*parseFloat(L))}this.log(`Steering manifest ${y.url} rate limited`)}},onTimeout:(g,y,E)=>{this.log(`Timeout loading steering manifest (${y.url})`),this.scheduleRefresh(this.uri||y.url)}};this.log(`Requesting steering manifest: ${r}`),this.loader.load(s,h,m)}scheduleRefresh(e,t=1e3*this.timeToLoad){self.clearTimeout(this.reloadTimer),this.reloadTimer=self.setTimeout(()=>{this.loadSteeringManifest(e)},t)}}});function ap(i){return i&&"object"==typeof i?Array.isArray(i)?i.map(ap):Object.keys(i).reduce((e,t)=>(e[t]=ap(i[t]),e),{}):i}let ml=(()=>{class i{static get version(){return"1.4.12"}static isSupported(){return function ZP(){const i=jh();if(!i)return!1;const e=LT();return!(!i||"function"!=typeof i.isTypeSupported||!i.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')||e&&(!e.prototype||"function"!=typeof e.prototype.appendBuffer||"function"!=typeof e.prototype.remove))}()}static get Events(){return N}static get ErrorTypes(){return an}static get ErrorDetails(){return Re}static get DefaultConfig(){return i.defaultConfig?i.defaultConfig:gR}static set DefaultConfig(t){i.defaultConfig=t}constructor(t={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new h_,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,function jA(i,e){if(self.console&&!0===i||"object"==typeof i){!function Bx(i,...e){e.forEach(function(t){$m[t]=i[t]?i[t].bind(i):function HA(i){const e=self.console[i];return e?e.bind(self.console,`[${i}] >`):$h}(t)})}(i,"debug","log","info","warn","error");try{$m.log(`Debug logs enabled for "${e}" in hls.js version 1.4.12`)}catch{$m=Fx}}else $m=Fx}(t.debug||!1,"Hls instance");const n=this.config=function _R(i,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==e.liveMaxLatencyDurationCount&&(void 0===e.liveSyncDurationCount||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==e.liveMaxLatencyDuration&&(void 0===e.liveSyncDuration||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const t=ap(i),r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach(s=>{const o=`${"level"===s?"playlist":s}LoadPolicy`,c=void 0===e[o],h=[];r.forEach(m=>{const g=`${s}Loading${m}`,y=e[g];if(void 0!==y&&c){h.push(g);const E=t[o].default;switch(e[o]={default:E},m){case"TimeOut":E.maxLoadTimeMs=y,E.maxTimeToFirstByteMs=y;break;case"MaxRetry":E.errorRetry.maxNumRetry=y,E.timeoutRetry.maxNumRetry=y;break;case"RetryDelay":E.errorRetry.retryDelayMs=y,E.timeoutRetry.retryDelayMs=y;break;case"MaxRetryTimeout":E.errorRetry.maxRetryDelayMs=y,E.timeoutRetry.maxRetryDelayMs=y}}}),h.length&&ae.warn(`hls.js config: "${h.join('", "')}" setting(s) are deprecated, use "${o}": ${JSON.stringify(e[o])}`)}),Yr(Yr({},t),e)}(i.DefaultConfig,t);this.userConfig=t,this._autoLevelCapping=-1,n.progressive&&function oc(i){const e=i.loader;e!==I_&&e!==dR?(ae.log("[config]: Custom loader detected, cannot enable progressive streaming"),i.progressive=!1):function na(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}()&&(i.loader=I_,i.progressive=!0,i.enableSoftwareAES=!0,ae.log("[config]: Progressive streaming enabled, using FetchLoader"))}(n);const{abrController:r,bufferController:s,capLevelController:o,errorController:c,fpsController:h}=n,m=new c(this),g=this.abrController=new r(this),y=this.bufferController=new s(this),E=this.capLevelController=new o(this),x=new h(this),S=new sk(this),R=new ak(this),L=n.contentSteeringController,G=L?new L(this):null,Y=this.levelController=new mk(this,G),K=new pk(this),te=new gk(this.config),oe=this.streamController=new Bs(this,K,te);E.setStreamController(oe),x.setStreamController(oe);const Ae=[S,Y,oe];G&&Ae.splice(1,0,G),this.networkControllers=Ae;const we=[g,y,E,x,R,K];this.audioTrackController=this.createController(n.audioTrackController,Ae);const We=n.audioStreamController;We&&Ae.push(new We(this,K,te)),this.subtitleTrackController=this.createController(n.subtitleTrackController,Ae);const ot=n.subtitleStreamController;ot&&Ae.push(new ot(this,K,te)),this.createController(n.timelineController,we),te.emeController=this.emeController=this.createController(n.emeController,we),this.cmcdController=this.createController(n.cmcdController,we),this.latencyController=this.createController(lk,we),this.coreComponents=we,Ae.push(m);const Le=m.onErrorOut;"function"==typeof Le&&this.on(N.ERROR,Le,m)}createController(t,n){if(t){const r=new t(this);return n&&n.push(r),r}return null}on(t,n,r=this){this._emitter.on(t,n,r)}once(t,n,r=this){this._emitter.once(t,n,r)}removeAllListeners(t){this._emitter.removeAllListeners(t)}off(t,n,r=this,s){this._emitter.off(t,n,r,s)}listeners(t){return this._emitter.listeners(t)}emit(t,n,r){return this._emitter.emit(t,n,r)}trigger(t,n){if(this.config.debug)return this.emit(t,t,n);try{return this.emit(t,t,n)}catch(r){ae.error("An internal error happened while handling event "+t+'. Error message: "'+r.message+'". Here is a stacktrace:',r),this.trigger(N.ERROR,{type:an.OTHER_ERROR,details:Re.INTERNAL_EXCEPTION,fatal:!1,event:t,error:r})}return!1}listenerCount(t){return this._emitter.listenerCount(t)}destroy(){ae.log("destroy"),this.trigger(N.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(n=>n.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(n=>n.destroy()),this.coreComponents.length=0;const t=this.config;t.xhrSetup=t.fetchSetup=void 0,this.userConfig=null}attachMedia(t){ae.log("attachMedia"),this._media=t,this.trigger(N.MEDIA_ATTACHING,{media:t})}detachMedia(){ae.log("detachMedia"),this.trigger(N.MEDIA_DETACHING,void 0),this._media=null}loadSource(t){this.stopLoad();const n=this.media,r=this.url,s=this.url=Vg.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0});ae.log(`loadSource:${s}`),n&&r&&(r!==s||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(n)),this.trigger(N.MANIFEST_LOADING,{url:t})}startLoad(t=-1){ae.log(`startLoad(${t})`),this.networkControllers.forEach(n=>{n.startLoad(t)})}stopLoad(){ae.log("stopLoad"),this.networkControllers.forEach(t=>{t.stopLoad()})}swapAudioCodec(){ae.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){ae.log("recoverMediaError");const t=this._media;this.detachMedia(),t&&this.attachMedia(t)}removeLevel(t,n=0){this.levelController.removeLevel(t,n)}get levels(){return this.levelController.levels||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(t){ae.log(`set currentLevel:${t}`),this.loadLevel=t,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(t){ae.log(`set nextLevel:${t}`),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(t){ae.log(`set loadLevel:${t}`),this.levelController.manualLevel=t}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(t){this.levelController.nextLoadLevel=t}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(t){ae.log(`set firstLevel:${t}`),this.levelController.firstLevel=t}get startLevel(){return this.levelController.startLevel}set startLevel(t){ae.log(`set startLevel:${t}`),-1!==t&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(t){const n=!!t;n!==this.config.capLevelToPlayerSize&&(n?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=n)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimate():NaN}get ttfbEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimateTTFB():NaN}set autoLevelCapping(t){this._autoLevelCapping!==t&&(ae.log(`set autoLevelCapping:${t}`),this._autoLevelCapping=t)}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(t){p0.indexOf(t)>-1&&(this._maxHdcpLevel=t)}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:t,config:{minAutoBitrate:n}}=this;if(!t)return 0;const r=t.length;for(let s=0;s<r;s++)if(t[s].maxBitrate>=n)return s;return 0}get maxAutoLevel(){const{levels:t,autoLevelCapping:n,maxHdcpLevel:r}=this;let s;if(s=-1===n&&t&&t.length?t.length-1:n,r)for(let o=s;o--;){const c=t[o].attrs["HDCP-LEVEL"];if(c&&c<=r)return o}return s}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(t){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,t)}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get audioTracks(){const t=this.audioTrackController;return t?t.audioTracks:[]}get audioTrack(){const t=this.audioTrackController;return t?t.audioTrack:-1}set audioTrack(t){const n=this.audioTrackController;n&&(n.audioTrack=t)}get subtitleTracks(){const t=this.subtitleTrackController;return t?t.subtitleTracks:[]}get subtitleTrack(){const t=this.subtitleTrackController;return t?t.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(t){const n=this.subtitleTrackController;n&&(n.subtitleTrack=t)}get subtitleDisplay(){const t=this.subtitleTrackController;return!!t&&t.subtitleDisplay}set subtitleDisplay(t){const n=this.subtitleTrackController;n&&(n.subtitleDisplay=t)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(t){this.config.lowLatencyMode=t}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}return i.defaultConfig=void 0,i})();var gt,II=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Do={},hb=hb||{},wn=II||self;function C_(i){var e=typeof i;return"array"==(e="object"!=e?e:i?Array.isArray(i)?"array":e:"null")||"object"==e&&"number"==typeof i.length}function lp(i){var e=typeof i;return"object"==e&&null!=i||"function"==e}var fb="closure_uid_"+(1e9*Math.random()>>>0),CI=0;function lL(i,e,t){return i.call.apply(i.bind,arguments)}function SI(i,e,t){if(!i)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),i.apply(e,r)}}return function(){return i.apply(e,arguments)}}function vs(i,e,t){return(vs=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?lL:SI).apply(null,arguments)}function cp(i,e){var t=Array.prototype.slice.call(arguments,1);return function(){var n=t.slice();return n.push.apply(n,arguments),i.apply(this,n)}}function Qr(i,e){function t(){}t.prototype=e.prototype,i.$=e.prototype,i.prototype=new t,i.prototype.constructor=i,i.ac=function(n,r,s){for(var o=Array(arguments.length-2),c=2;c<arguments.length;c++)o[c-2]=arguments[c];return e.prototype[r].apply(n,o)}}function pl(){this.s=this.s,this.o=this.o}pl.prototype.s=!1,pl.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function yR(i){Object.prototype.hasOwnProperty.call(i,fb)&&i[fb]||(i[fb]=++CI)}(this)},pl.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const mb=Array.prototype.indexOf?function(i,e){return Array.prototype.indexOf.call(i,e,void 0)}:function(i,e){if("string"==typeof i)return"string"!=typeof e||1!=e.length?-1:i.indexOf(e,0);for(let t=0;t<i.length;t++)if(t in i&&i[t]===e)return t;return-1};function S_(i){const e=i.length;if(0<e){const t=Array(e);for(let n=0;n<e;n++)t[n]=i[n];return t}return[]}function pb(i,e){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(C_(n)){const r=i.length||0,s=n.length||0;i.length=r+s;for(let o=0;o<s;o++)i[r+o]=n[o]}else i.push(n)}}function Jr(i,e){this.type=i,this.g=this.target=e,this.defaultPrevented=!1}Jr.prototype.h=function(){this.defaultPrevented=!0};var D_=function(){if(!wn.addEventListener||!Object.defineProperty)return!1;var i=!1,e=Object.defineProperty({},"passive",{get:function(){i=!0}});try{wn.addEventListener("test",()=>{},e),wn.removeEventListener("test",()=>{},e)}catch{}return i}();function ru(i){return/^[\s\xa0]*$/.test(i)}function up(){var i=wn.navigator;return i&&(i=i.userAgent)?i:""}function gl(i){return-1!=up().indexOf(i)}function gb(i){return gb[" "](i),i}gb[" "]=function(){};var kI,i,uL=gl("Opera"),dp=gl("Trident")||gl("MSIE"),_b=gl("Edge"),yb=_b||dp,AI=gl("Gecko")&&!(-1!=up().toLowerCase().indexOf("webkit")&&!gl("Edge"))&&!(gl("Trident")||gl("MSIE"))&&!gl("Edge"),vR=-1!=up().toLowerCase().indexOf("webkit")&&!gl("Edge");function bR(){var i=wn.document;return i?i.documentMode:void 0}e:{var RI="",MI=(i=up(),AI?/rv:([^\);]+)(\)|;)/.exec(i):_b?/Edge\/([\d\.]+)/.exec(i):dp?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(i):vR?/WebKit\/(\S+)/.exec(i):uL?/(?:Version)[ \/]?(\S+)/.exec(i):void 0);if(MI&&(RI=MI?MI[1]:""),dp){var OI=bR();if(null!=OI&&OI>parseFloat(RI)){kI=String(OI);break e}}kI=RI}var wR=wn.document&&dp&&(bR()||parseInt(kI,10))||void 0;function fp(i,e){if(Jr.call(this,i?i.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,i){var t=this.type=i.type,n=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:null;if(this.target=i.target||i.srcElement,this.g=e,e=i.relatedTarget){if(AI){e:{try{gb(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else"mouseover"==t?e=i.fromElement:"mouseout"==t&&(e=i.toElement);this.relatedTarget=e,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=i.button,this.key=i.key||"",this.ctrlKey=i.ctrlKey,this.altKey=i.altKey,this.shiftKey=i.shiftKey,this.metaKey=i.metaKey,this.pointerId=i.pointerId||0,this.pointerType="string"==typeof i.pointerType?i.pointerType:PI[i.pointerType]||"",this.state=i.state,this.i=i,i.defaultPrevented&&fp.$.h.call(this)}}Qr(fp,Jr);var PI={2:"touch",3:"pen",4:"mouse"};fp.prototype.h=function(){fp.$.h.call(this);var i=this.i;i.preventDefault?i.preventDefault():i.returnValue=!1};var Ba="closure_listenable_"+(1e6*Math.random()|0),LI=0;function bb(i,e,t,n,r){this.listener=i,this.proxy=null,this.src=e,this.type=t,this.capture=!!n,this.la=r,this.key=++LI,this.fa=this.ia=!1}function nf(i){i.fa=!0,i.listener=null,i.proxy=null,i.src=null,i.la=null}function wb(i,e,t){for(const n in i)e.call(t,i[n],n,i)}function A_(i){const e={};for(const t in i)e[t]=i[t];return e}const mp="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ER(i,e){let t,n;for(let r=1;r<arguments.length;r++){for(t in n=arguments[r],n)i[t]=n[t];for(let s=0;s<mp.length;s++)t=mp[s],Object.prototype.hasOwnProperty.call(n,t)&&(i[t]=n[t])}}function xb(i){this.src=i,this.g={},this.h=0}function NI(i,e){var t=e.type;if(t in i.g){var s,n=i.g[t],r=mb(n,e);(s=0<=r)&&Array.prototype.splice.call(n,r,1),s&&(nf(e),0==i.g[t].length&&(delete i.g[t],i.h--))}}function FI(i,e,t,n){for(var r=0;r<i.length;++r){var s=i[r];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==n)return r}return-1}xb.prototype.add=function(i,e,t,n,r){var s=i.toString();(i=this.g[s])||(i=this.g[s]=[],this.h++);var o=FI(i,e,n,r);return-1<o?(e=i[o],t||(e.ia=!1)):((e=new bb(e,this.src,s,!!n,r)).ia=t,i.push(e)),e};var k_="closure_lm_"+(1e6*Math.random()|0),Tb={};function BI(i,e,t,n,r){if(n&&n.once)return Ib(i,e,t,n,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)BI(i,e[s],t,n,r);return null}return t=$I(t),i&&i[Ba]?i.O(e,t,lp(n)?!!n.capture:!!n,r):UI(i,e,t,!1,n,r)}function UI(i,e,t,n,r,s){if(!e)throw Error("Invalid event type");var o=lp(r)?!!r.capture:!!r,c=M_(i);if(c||(i[k_]=c=new xb(i)),(t=c.add(e,t,n,o,s)).proxy)return t;if(n=function xR(){const e=TR;return function i(t){return e.call(i.src,i.listener,t)}}(),t.proxy=n,n.src=i,n.listener=t,i.addEventListener)D_||(r=o),void 0===r&&(r=!1),i.addEventListener(e.toString(),n,r);else if(i.attachEvent)i.attachEvent(VI(e.toString()),n);else{if(!i.addListener||!i.removeListener)throw Error("addEventListener and attachEvent are unavailable.");i.addListener(n)}return t}function Ib(i,e,t,n,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)Ib(i,e[s],t,n,r);return null}return t=$I(t),i&&i[Ba]?i.P(e,t,lp(n)?!!n.capture:!!n,r):UI(i,e,t,!0,n,r)}function Cb(i,e,t,n,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)Cb(i,e[s],t,n,r);else n=lp(n)?!!n.capture:!!n,t=$I(t),i&&i[Ba]?(i=i.i,(e=String(e).toString())in i.g&&-1<(t=FI(s=i.g[e],t,n,r))&&(nf(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete i.g[e],i.h--))):i&&(i=M_(i))&&(e=i.g[e.toString()],i=-1,e&&(i=FI(e,t,n,r)),(t=-1<i?e[i]:null)&&R_(t))}function R_(i){if("number"!=typeof i&&i&&!i.fa){var e=i.src;if(e&&e[Ba])NI(e.i,i);else{var t=i.type,n=i.proxy;e.removeEventListener?e.removeEventListener(t,n,i.capture):e.detachEvent?e.detachEvent(VI(t),n):e.addListener&&e.removeListener&&e.removeListener(n),(t=M_(e))?(NI(t,i),0==t.h&&(t.src=null,e[k_]=null)):nf(i)}}}function VI(i){return i in Tb?Tb[i]:Tb[i]="on"+i}function TR(i,e){if(i.fa)i=!0;else{e=new fp(e,this);var t=i.listener,n=i.la||i.src;i.ia&&R_(i),i=t.call(n,e)}return i}function M_(i){return(i=i[k_])instanceof xb?i:null}var pp="__closure_events_fn_"+(1e9*Math.random()>>>0);function $I(i){return"function"==typeof i?i:(i[pp]||(i[pp]=function(e){return i.handleEvent(e)}),i[pp])}function Dr(){pl.call(this),this.i=new xb(this),this.S=this,this.J=null}function Ar(i,e){var t,n=i.J;if(n)for(t=[];n;n=n.J)t.push(n);if(i=i.S,n=e.type||e,"string"==typeof e)e=new Jr(e,i);else if(e instanceof Jr)e.target=e.target||i;else{var r=e;ER(e=new Jr(n,i),r)}if(r=!0,t)for(var s=t.length-1;0<=s;s--){var o=e.g=t[s];r=O_(o,n,!0,e)&&r}if(r=O_(o=e.g=i,n,!0,e)&&r,r=O_(o,n,!1,e)&&r,t)for(s=0;s<t.length;s++)r=O_(o=e.g=t[s],n,!1,e)&&r}function O_(i,e,t,n){if(!(e=i.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==t){var c=o.listener,h=o.la||o.src;o.ia&&NI(i.i,o),r=!1!==c.call(h,n)&&r}}return r&&!n.defaultPrevented}Qr(Dr,pl),Dr.prototype[Ba]=!0,Dr.prototype.removeEventListener=function(i,e,t,n){Cb(this,i,e,t,n)},Dr.prototype.N=function(){if(Dr.$.N.call(this),this.i){var e,i=this.i;for(e in i.g){for(var t=i.g[e],n=0;n<t.length;n++)nf(t[n]);delete i.g[e],i.h--}}this.J=null},Dr.prototype.O=function(i,e,t,n){return this.i.add(String(i),e,!1,t,n)},Dr.prototype.P=function(i,e,t,n){return this.i.add(String(i),e,!0,t,n)};var Sb=wn.JSON.stringify;function hL(){var i=Db;let e=null;return i.g&&(e=i.g,i.g=i.g.next,i.g||(i.h=null),e.next=null),e}var HI=new class dL{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new CR,i=>i.reset());class CR{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function fL(i){var e=1;i=i.split(":");const t=[];for(;0<e&&i.length;)t.push(i.shift()),e--;return i.length&&t.push(i.join(":")),t}function mL(i){wn.setTimeout(()=>{throw i},0)}let P_,L_=!1,Db=new class IR{constructor(){this.h=this.g=null}add(e,t){const n=HI.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},SR=()=>{const i=wn.Promise.resolve(void 0);P_=()=>{i.then(pL)}};var pL=()=>{for(var i;i=hL();){try{i.h.call(i.g)}catch(t){mL(t)}var e=HI;e.j(i),100>e.h&&(e.h++,i.next=e.g,e.g=i)}L_=!1};function Ab(i,e){Dr.call(this),this.h=i||1,this.g=e||wn,this.j=vs(this.qb,this),this.l=Date.now()}function jI(i){i.ga=!1,i.T&&(i.g.clearTimeout(i.T),i.T=null)}function GI(i,e,t){if("function"==typeof i)t&&(i=vs(i,t));else{if(!i||"function"!=typeof i.handleEvent)throw Error("Invalid listener argument");i=vs(i.handleEvent,i)}return 2147483647<Number(e)?-1:wn.setTimeout(i,e||0)}function DR(i){i.g=GI(()=>{i.g=null,i.i&&(i.i=!1,DR(i))},i.j);const e=i.h;i.h=null,i.m.apply(null,e)}Qr(Ab,Dr),(gt=Ab.prototype).ga=!1,gt.T=null,gt.qb=function(){if(this.ga){var i=Date.now()-this.l;0<i&&i<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-i):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Ar(this,"tick"),this.ga&&(jI(this),this.start()))}},gt.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},gt.N=function(){Ab.$.N.call(this),jI(this),delete this.g};class a extends pl{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:DR(this)}N(){super.N(),this.g&&(wn.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function l(i){pl.call(this),this.h=i,this.g={}}Qr(l,pl);var u=[];function f(i,e,t,n){Array.isArray(t)||(t&&(u[0]=t.toString()),t=u);for(var r=0;r<t.length;r++){var s=BI(e,t[r],n||i.handleEvent,!1,i.h||i);if(!s)break;i.g[s.key]=s}}function p(i){wb(i.g,function(e,t){this.g.hasOwnProperty(t)&&R_(e)},i),i.g={}}function _(){this.g=!0}function C(i,e,t,n){i.info(function(){return"XMLHTTP TEXT ("+e+"): "+function B(i,e){if(!i.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(i=0;i<t.length;i++)if(Array.isArray(t[i])){var n=t[i];if(!(2>n.length)){var r=n[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return Sb(t)}catch{return e}}(i,t)+(n?" "+n:"")})}l.prototype.N=function(){l.$.N.call(this),p(this)},l.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},_.prototype.Ea=function(){this.g=!1},_.prototype.info=function(){};var W={},se=null;function de(){return se=se||new Dr}function Pe(i){Jr.call(this,W.Ta,i)}function st(i){const e=de();Ar(e,new Pe(e))}function mt(i,e){Jr.call(this,W.STAT_EVENT,i),this.stat=e}function ht(i){const e=de();Ar(e,new mt(e,i))}function rn(i,e){Jr.call(this,W.Ua,i),this.size=e}function ze(i,e){if("function"!=typeof i)throw Error("Fn must not be null and must be a function");return wn.setTimeout(function(){i()},e)}W.Ta="serverreachability",Qr(Pe,Jr),W.STAT_EVENT="statevent",Qr(mt,Jr),W.Ua="timingevent",Qr(rn,Jr);var dn={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},xi={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Vi(){}function gL(){}Vi.prototype.h=null;var MR,kb={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function kR(){Jr.call(this,"d")}function RR(){Jr.call(this,"c")}function zI(){}function Rb(i,e,t,n){this.l=i,this.j=e,this.m=t,this.W=n||1,this.U=new l(this),this.P=qH,this.V=new Ab(i=yb?125:void 0),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new _L}function _L(){this.i=null,this.g="",this.h=!1}Qr(kR,Jr),Qr(RR,Jr),Qr(zI,Vi),zI.prototype.g=function(){return new XMLHttpRequest},zI.prototype.i=function(){return{}},MR=new zI;var qH=45e3,OR={},WI={};function PR(i,e,t){i.L=1,i.v=ZI(hd(e)),i.s=t,i.S=!0,yL(i,null)}function yL(i,e){i.G=Date.now(),Mb(i),i.A=hd(i.v);var t=i.A,n=i.W;Array.isArray(n)||(n=[String(n)]),DL(t.i,"t",n),i.C=0,t=i.l.J,i.h=new _L,i.g=QL(i.l,t?e:null,!i.s),0<i.O&&(i.M=new a(vs(i.Pa,i,i.g),i.O)),f(i.U,i.g,"readystatechange",i.nb),e=i.I?A_(i.I):{},i.s?(i.u||(i.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",i.g.ha(i.A,i.u,i.s,e)):(i.u="GET",i.g.ha(i.A,i.u,null,e)),st(),function w(i,e,t,n,r,s){i.info(function(){if(i.g)if(s)for(var o="",c=s.split("&"),h=0;h<c.length;h++){var m=c[h].split("=");if(1<m.length){var g=m[0];m=m[1];var y=g.split("_");o=2<=y.length&&"type"==y[1]?o+(g+"=")+m+"&":o+(g+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+n+") [attempt "+r+"]: "+e+"\n"+t+"\n"+o})}(i.j,i.u,i.A,i.m,i.W,i.s)}function vL(i){return!!i.g&&"GET"==i.u&&2!=i.L&&i.l.Ha}function bL(i,e,t){let r,n=!0;for(;!i.J&&i.C<t.length;){if(r=YH(i,t),r==WI){4==e&&(i.o=4,ht(14),n=!1),C(i.j,i.m,null,"[Incomplete Response]");break}if(r==OR){i.o=4,ht(15),C(i.j,i.m,t,"[Invalid Chunk]"),n=!1;break}C(i.j,i.m,r,null),LR(i,r)}vL(i)&&r!=WI&&r!=OR&&(i.h.g="",i.C=0),4!=e||0!=t.length||i.h.h||(i.o=1,ht(16),n=!1),i.i=i.i&&n,n?0<t.length&&!i.ba&&(i.ba=!0,(e=i.l).g==i&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),HR(e),e.M=!0,ht(11))):(C(i.j,i.m,t,"[Invalid Chunked Response]"),gp(i),Ob(i))}function YH(i,e){var t=i.C,n=e.indexOf("\n",t);return-1==n?WI:(t=Number(e.substring(t,n)),isNaN(t)?OR:(n+=1)+t>e.length?WI:(e=e.slice(n,n+t),i.C=n+t,e))}function Mb(i){i.Y=Date.now()+i.P,wL(i,i.P)}function wL(i,e){if(null!=i.B)throw Error("WatchDog timer not null");i.B=ze(vs(i.lb,i),e)}function KI(i){i.B&&(wn.clearTimeout(i.B),i.B=null)}function Ob(i){0==i.l.H||i.J||qL(i.l,i)}function gp(i){KI(i);var e=i.M;e&&"function"==typeof e.sa&&e.sa(),i.M=null,jI(i.V),p(i.U),i.g&&(e=i.g,i.g=null,e.abort(),e.sa())}function LR(i,e){try{var t=i.l;if(0!=t.H&&(t.g==i||NR(t.i,i)))if(!i.K&&NR(t.i,i)&&3==t.H){try{var n=t.Ja.g.parse(e)}catch{n=null}if(Array.isArray(n)&&3==n.length){var r=n;if(0==r[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<i.G))break e;nC(t),eC(t)}$R(t),ht(18)}}else t.Fa=r[1],0<t.Fa-t.V&&37500>r[2]&&t.G&&0==t.A&&!t.v&&(t.v=ze(vs(t.ib,t),6e3));if(1>=RL(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else yp(t,11)}else if((i.K||t.g==i)&&nC(t),!ru(e))for(r=t.Ja.g.parse(e),e=0;e<r.length;e++){let m=r[e];if(t.V=m[0],m=m[1],2==t.H)if("c"==m[0]){t.K=m[1],t.pa=m[2];const g=m[3];null!=g&&(t.ra=g,t.l.info("VER="+t.ra));const y=m[4];null!=y&&(t.Ga=y,t.l.info("SVER="+t.Ga));const E=m[5];null!=E&&"number"==typeof E&&0<E&&(t.L=n=1.5*E,t.l.info("backChannelRequestTimeoutMs_="+n)),n=t;const x=i.g;if(x){const S=x.g?x.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(S){var s=n.i;s.g||-1==S.indexOf("spdy")&&-1==S.indexOf("quic")&&-1==S.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(FR(s,s.h),s.h=null))}if(n.F){const R=x.g?x.g.getResponseHeader("X-HTTP-Session-Id"):null;R&&(n.Da=R,$i(n.I,n.F,R))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-i.G,t.l.info("Handshake RTT: "+t.S+"ms"));var o=i;if((n=t).wa=XL(n,n.J?n.pa:null,n.Y),o.K){ML(n.i,o);var c=o,h=n.L;h&&c.setTimeout(h),c.B&&(KI(c),Mb(c)),n.g=o}else WL(n);0<t.j.length&&tC(t)}else"stop"!=m[0]&&"close"!=m[0]||yp(t,7);else 3==t.H&&("stop"==m[0]||"close"==m[0]?"stop"==m[0]?yp(t,7):VR(t):"noop"!=m[0]&&t.h&&t.h.Aa(m),t.A=0)}st()}catch{}}function EL(i,e){if(i.forEach&&"function"==typeof i.forEach)i.forEach(e,void 0);else if(C_(i)||"string"==typeof i)Array.prototype.forEach.call(i,e,void 0);else for(var t=function XH(i){if(i.ta&&"function"==typeof i.ta)return i.ta();if(!i.Z||"function"!=typeof i.Z){if(typeof Map<"u"&&i instanceof Map)return Array.from(i.keys());if(!(typeof Set<"u"&&i instanceof Set)){if(C_(i)||"string"==typeof i){var e=[];i=i.length;for(var t=0;t<i;t++)e.push(t);return e}e=[],t=0;for(const n in i)e[t++]=n;return e}}}(i),n=function ZH(i){if(i.Z&&"function"==typeof i.Z)return i.Z();if(typeof Map<"u"&&i instanceof Map||typeof Set<"u"&&i instanceof Set)return Array.from(i.values());if("string"==typeof i)return i.split("");if(C_(i)){for(var e=[],t=i.length,n=0;n<t;n++)e.push(i[n]);return e}for(n in e=[],t=0,i)e[t++]=i[n];return e}(i),r=n.length,s=0;s<r;s++)e.call(void 0,n[s],t&&t[s],i)}(gt=Rb.prototype).setTimeout=function(i){this.P=i},gt.nb=function(i){i=i.target;const e=this.M;e&&3==su(i)?e.l():this.Pa(i)},gt.Pa=function(i){try{if(i==this.g)e:{const g=su(this.g);var e=this.g.Ia();if(this.g.da(),!(3>g)&&(3!=g||yb||this.g&&(this.h.h||this.g.ja()||VL(this.g)))){this.J||4!=g||7==e||st(),KI(this);var t=this.g.da();this.ca=t;t:if(vL(this)){var n=VL(this.g);i="";var r=n.length,s=4==su(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){gp(this),Ob(this);var o="";break t}this.h.i=new wn.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,i+=this.h.i.decode(n[e],{stream:s&&e==r-1});n.splice(0,r),this.h.g+=i,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==t,function I(i,e,t,n,r,s,o){i.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+r+"]: "+e+"\n"+t+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.W,g,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var c,h=this.g;if((c=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ru(c)){var m=c;break t}}m=null}if(!(t=m)){this.i=!1,this.o=3,ht(12),gp(this),Ob(this);break e}C(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,LR(this,t)}this.S?(bL(this,g,o),yb&&this.i&&3==g&&(f(this.U,this.V,"tick",this.mb),this.V.start())):(C(this.j,this.m,o,null),LR(this,o)),4==g&&gp(this),this.i&&!this.J&&(4==g?qL(this.l,this):(this.i=!1,Mb(this)))}else(function p4(i){const e={};i=(i.g&&2<=su(i)&&i.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<i.length;n++){if(ru(i[n]))continue;var t=fL(i[n]);const r=t[0];if("string"!=typeof(t=t[1]))continue;t=t.trim();const s=e[r]||[];e[r]=s,s.push(t)}!function Eb(i,e){for(const t in i)e.call(void 0,i[t],t,i)}(e,function(n){return n.join(", ")})})(this.g),400==t&&0<o.indexOf("Unknown SID")?(this.o=3,ht(12)):(this.o=0,ht(13)),gp(this),Ob(this)}}}catch{}},gt.mb=function(){if(this.g){var i=su(this.g),e=this.g.ja();this.C<e.length&&(KI(this),bL(this,i,e),this.i&&4!=i&&Mb(this))}},gt.cancel=function(){this.J=!0,gp(this)},gt.lb=function(){this.B=null;const i=Date.now();0<=i-this.Y?(function M(i,e){i.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.L&&(st(),ht(17)),gp(this),this.o=2,Ob(this)):wL(this,this.Y-i)};var xL=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _p(i){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,i instanceof _p){this.h=i.h,qI(this,i.j),this.s=i.s,this.g=i.g,YI(this,i.m),this.l=i.l;var e=i.i,t=new Nb;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),TL(this,t),this.o=i.o}else i&&(e=String(i).match(xL))?(this.h=!1,qI(this,e[1]||"",!0),this.s=Pb(e[2]||""),this.g=Pb(e[3]||"",!0),YI(this,e[4]),this.l=Pb(e[5]||"",!0),TL(this,e[6]||"",!0),this.o=Pb(e[7]||"")):(this.h=!1,this.i=new Nb(null,this.h))}function hd(i){return new _p(i)}function qI(i,e,t){i.j=t?Pb(e,!0):e,i.j&&(i.j=i.j.replace(/:$/,""))}function YI(i,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);i.m=e}else i.m=null}function TL(i,e,t){e instanceof Nb?(i.i=e,function r4(i,e){e&&!i.j&&(rf(i),i.i=null,i.g.forEach(function(t,n){var r=n.toLowerCase();n!=r&&(CL(this,n),DL(this,r,t))},i)),i.j=e}(i.i,i.h)):(t||(e=Lb(e,n4)),i.i=new Nb(e,i.h))}function $i(i,e,t){i.i.set(e,t)}function ZI(i){return $i(i,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),i}function Pb(i,e){return i?e?decodeURI(i.replace(/%25/g,"%2525")):decodeURIComponent(i):""}function Lb(i,e,t){return"string"==typeof i?(i=encodeURI(i).replace(e,JH),t&&(i=i.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i):null}function JH(i){return"%"+((i=i.charCodeAt(0))>>4&15).toString(16)+(15&i).toString(16)}_p.prototype.toString=function(){var i=[],e=this.j;e&&i.push(Lb(e,IL,!0),":");var t=this.g;return(t||"file"==e)&&(i.push("//"),(e=this.s)&&i.push(Lb(e,IL,!0),"@"),i.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&i.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&i.push("/"),i.push(Lb(t,"/"==t.charAt(0)?t4:e4,!0))),(t=this.i.toString())&&i.push("?",t),(t=this.o)&&i.push("#",Lb(t,i4)),i.join("")};var IL=/[#\/\?@]/g,e4=/[#\?:]/g,t4=/[#\?]/g,n4=/[#\?@]/g,i4=/#/g;function Nb(i,e){this.h=this.g=null,this.i=i||null,this.j=!!e}function rf(i){i.g||(i.g=new Map,i.h=0,i.i&&function QH(i,e){if(i){i=i.split("&");for(var t=0;t<i.length;t++){var n=i[t].indexOf("="),r=null;if(0<=n){var s=i[t].substring(0,n);r=i[t].substring(n+1)}else s=i[t];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(i.i,function(e,t){i.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function CL(i,e){rf(i),e=N_(i,e),i.g.has(e)&&(i.i=null,i.h-=i.g.get(e).length,i.g.delete(e))}function SL(i,e){return rf(i),e=N_(i,e),i.g.has(e)}function DL(i,e,t){CL(i,e),0<t.length&&(i.i=null,i.g.set(N_(i,e),S_(t)),i.h+=t.length)}function N_(i,e){return e=String(e),i.j&&(e=e.toLowerCase()),e}function AL(i){this.l=i||o4,i=wn.PerformanceNavigationTiming?0<(i=wn.performance.getEntriesByType("navigation")).length&&("hq"==i[0].nextHopProtocol||"h2"==i[0].nextHopProtocol):!!(wn.g&&wn.g.Ka&&wn.g.Ka()&&wn.g.Ka().ec),this.j=i?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(gt=Nb.prototype).add=function(i,e){rf(this),this.i=null,i=N_(this,i);var t=this.g.get(i);return t||this.g.set(i,t=[]),t.push(e),this.h+=1,this},gt.forEach=function(i,e){rf(this),this.g.forEach(function(t,n){t.forEach(function(r){i.call(e,r,n,this)},this)},this)},gt.ta=function(){rf(this);const i=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let n=0;n<e.length;n++){const r=i[n];for(let s=0;s<r.length;s++)t.push(e[n])}return t},gt.Z=function(i){rf(this);let e=[];if("string"==typeof i)SL(this,i)&&(e=e.concat(this.g.get(N_(this,i))));else{i=Array.from(this.g.values());for(let t=0;t<i.length;t++)e=e.concat(i[t])}return e},gt.set=function(i,e){return rf(this),this.i=null,SL(this,i=N_(this,i))&&(this.h-=this.g.get(i).length),this.g.set(i,[e]),this.h+=1,this},gt.get=function(i,e){return i&&0<(i=this.Z(i)).length?String(i[0]):e},gt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const i=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var n=e[t];const s=encodeURIComponent(String(n)),o=this.Z(n);for(n=0;n<o.length;n++){var r=s;""!==o[n]&&(r+="="+encodeURIComponent(String(o[n]))),i.push(r)}}return this.i=i.join("&")};var o4=10;function kL(i){return!!i.h||!!i.g&&i.g.size>=i.j}function RL(i){return i.h?1:i.g?i.g.size:0}function NR(i,e){return i.h?i.h==e:!!i.g&&i.g.has(e)}function FR(i,e){i.g?i.g.add(e):i.h=e}function ML(i,e){i.h&&i.h==e?i.h=null:i.g&&i.g.has(e)&&i.g.delete(e)}function OL(i){if(null!=i.h)return i.i.concat(i.h.F);if(null!=i.g&&0!==i.g.size){let e=i.i;for(const t of i.g.values())e=e.concat(t.F);return e}return S_(i.i)}AL.prototype.cancel=function(){if(this.i=OL(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const i of this.g.values())i.cancel();this.g.clear()}};var a4=class{stringify(i){return wn.JSON.stringify(i,void 0)}parse(i){return wn.JSON.parse(i,void 0)}};function l4(){this.g=new a4}function c4(i,e,t){const n=t||"";try{EL(i,function(r,s){let o=r;lp(r)&&(o=Sb(r)),e.push(n+s+"="+encodeURIComponent(o))})}catch(r){throw e.push(n+"type="+encodeURIComponent("_badmap")),r}}function XI(i,e,t,n,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(n)}catch{}}function Fb(i){this.l=i.fc||null,this.j=i.ob||!1}function QI(i,e){Dr.call(this),this.F=i,this.u=e,this.m=void 0,this.readyState=BR,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Qr(Fb,Vi),Fb.prototype.g=function(){return new QI(this.l,this.j)},Fb.prototype.i=function(i){return function(){return i}}({}),Qr(QI,Dr);var BR=0;function PL(i){i.j.read().then(i.Xa.bind(i)).catch(i.ka.bind(i))}function Bb(i){i.readyState=4,i.l=null,i.j=null,i.A=null,Ub(i)}function Ub(i){i.onreadystatechange&&i.onreadystatechange.call(i)}(gt=QI.prototype).open=function(i,e){if(this.readyState!=BR)throw this.abort(),Error("Error reopening a connection");this.C=i,this.B=e,this.readyState=1,Ub(this)},gt.send=function(i){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};i&&(e.body=i),(this.F||wn).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},gt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Bb(this)),this.readyState=BR},gt.$a=function(i){if(this.g&&(this.l=i,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=i.headers,this.readyState=2,Ub(this)),this.g&&(this.readyState=3,Ub(this),this.g)))if("arraybuffer"===this.responseType)i.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof wn.ReadableStream<"u"&&"body"in i){if(this.j=i.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;PL(this)}else i.text().then(this.Za.bind(this),this.ka.bind(this))},gt.Xa=function(i){if(this.g){if(this.u&&i.value)this.response.push(i.value);else if(!this.u){var e=i.value?i.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!i.done}))&&(this.response=this.responseText+=e)}i.done?Bb(this):Ub(this),3==this.readyState&&PL(this)}},gt.Za=function(i){this.g&&(this.response=this.responseText=i,Bb(this))},gt.Ya=function(i){this.g&&(this.response=i,Bb(this))},gt.ka=function(){this.g&&Bb(this)},gt.setRequestHeader=function(i,e){this.v.append(i,e)},gt.getResponseHeader=function(i){return this.h&&this.h.get(i.toLowerCase())||""},gt.getAllResponseHeaders=function(){if(!this.h)return"";const i=[],e=this.h.entries();for(var t=e.next();!t.done;)i.push((t=t.value)[0]+": "+t[1]),t=e.next();return i.join("\r\n")},Object.defineProperty(QI.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(i){this.m=i?"include":"same-origin"}});var d4=wn.JSON.parse;function vr(i){Dr.call(this),this.headers=new Map,this.u=i||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=LL,this.L=this.M=!1}Qr(vr,Dr);var LL="",h4=/^https?$/i,f4=["POST","PUT"];function NL(i,e){i.h=!1,i.g&&(i.l=!0,i.g.abort(),i.l=!1),i.j=e,i.m=5,FL(i),JI(i)}function FL(i){i.F||(i.F=!0,Ar(i,"complete"),Ar(i,"error"))}function BL(i){if(i.h&&typeof hb<"u"&&(!i.C[1]||4!=su(i)||2!=i.da()))if(i.v&&4==su(i))GI(i.La,0,i);else if(Ar(i,"readystatechange"),4==su(i)){i.h=!1;try{const o=i.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var n;if(n=0===o){var r=String(i.I).match(xL)[1]||null;!r&&wn.self&&wn.self.location&&(r=wn.self.location.protocol.slice(0,-1)),n=!h4.test(r?r.toLowerCase():"")}t=n}if(t)Ar(i,"complete"),Ar(i,"success");else{i.m=6;try{var s=2<su(i)?i.g.statusText:""}catch{s=""}i.j=s+" ["+i.da()+"]",FL(i)}}finally{JI(i)}}}function JI(i,e){if(i.g){UL(i);const t=i.g,n=i.C[0]?()=>{}:null;i.g=null,i.C=null,e||Ar(i,"ready");try{t.onreadystatechange=n}catch{}}}function UL(i){i.g&&i.L&&(i.g.ontimeout=null),i.A&&(wn.clearTimeout(i.A),i.A=null)}function su(i){return i.g?i.g.readyState:0}function VL(i){try{if(!i.g)return null;if("response"in i.g)return i.g.response;switch(i.K){case LL:case"text":return i.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in i.g)return i.g.mozResponseArrayBuffer}return null}catch{return null}}function $L(i){let e="";return wb(i,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function UR(i,e,t){e:{for(n in t){var n=!1;break e}n=!0}n||(t=$L(t),"string"==typeof i?null!=t&&encodeURIComponent(String(t)):$i(i,e,t))}function Vb(i,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[i]||e}function HL(i){this.Ga=0,this.j=[],this.l=new _,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Vb("failFast",!1,i),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Vb("baseRetryDelayMs",5e3,i),this.hb=Vb("retryDelaySeedMs",1e4,i),this.eb=Vb("forwardChannelMaxRetries",2,i),this.xa=Vb("forwardChannelRequestTimeoutMs",2e4,i),this.va=i&&i.xmlHttpFactory||void 0,this.Ha=i&&i.dc||!1,this.L=void 0,this.J=i&&i.supportsCrossDomainXhr||!1,this.K="",this.i=new AL(i&&i.concurrentRequestLimit),this.Ja=new l4,this.P=i&&i.fastHandshake||!1,this.O=i&&i.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=i&&i.bc||!1,i&&i.Ea&&this.l.Ea(),i&&i.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&i&&i.detectBufferingProxy||!1,this.qa=void 0,i&&i.longPollingTimeout&&0<i.longPollingTimeout&&(this.qa=i.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function VR(i){if(jL(i),3==i.H){var e=i.W++,t=hd(i.I);if($i(t,"SID",i.K),$i(t,"RID",e),$i(t,"TYPE","terminate"),$b(i,t),(e=new Rb(i,i.l,e)).L=2,e.v=ZI(hd(t)),t=!1,wn.navigator&&wn.navigator.sendBeacon)try{t=wn.navigator.sendBeacon(e.v.toString(),"")}catch{}!t&&wn.Image&&((new Image).src=e.v,t=!0),t||(e.g=QL(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Mb(e)}ZL(i)}function eC(i){i.g&&(HR(i),i.g.cancel(),i.g=null)}function jL(i){eC(i),i.u&&(wn.clearTimeout(i.u),i.u=null),nC(i),i.i.cancel(),i.m&&("number"==typeof i.m&&wn.clearTimeout(i.m),i.m=null)}function tC(i){if(!kL(i.i)&&!i.m){i.m=!0;var e=i.Na;P_||SR(),L_||(P_(),L_=!0),Db.add(e,i),i.C=0}}function GL(i,e){var t;t=e?e.m:i.W++;const n=hd(i.I);$i(n,"SID",i.K),$i(n,"RID",t),$i(n,"AID",i.V),$b(i,n),i.o&&i.s&&UR(n,i.o,i.s),t=new Rb(i,i.l,t,i.C+1),null===i.o&&(t.I=i.s),e&&(i.j=e.F.concat(i.j)),e=zL(i,t,1e3),t.setTimeout(Math.round(.5*i.xa)+Math.round(.5*i.xa*Math.random())),FR(i.i,t),PR(t,n,e)}function $b(i,e){i.na&&wb(i.na,function(t,n){$i(e,n,t)}),i.h&&EL({},function(t,n){$i(e,n,t)})}function zL(i,e,t){t=Math.min(i.j.length,t);var n=i.h?vs(i.h.Va,i.h,i):null;e:{var r=i.j;let s=-1;for(;;){const o=["count="+t];-1==s?0<t?(s=r[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let c=!0;for(let h=0;h<t;h++){let m=r[h].g;const g=r[h].map;if(m-=s,0>m)s=Math.max(0,r[h].g-100),c=!1;else try{c4(g,o,"req"+m+"_")}catch{n&&n(g)}}if(c){n=o.join("&");break e}}}return i=i.j.splice(0,t),e.F=i,n}function WL(i){if(!i.g&&!i.u){i.ba=1;var e=i.Ma;P_||SR(),L_||(P_(),L_=!0),Db.add(e,i),i.A=0}}function $R(i){return!(i.g||i.u||3<=i.A||(i.ba++,i.u=ze(vs(i.Ma,i),YL(i,i.A)),i.A++,0))}function HR(i){null!=i.B&&(wn.clearTimeout(i.B),i.B=null)}function KL(i){i.g=new Rb(i,i.l,"rpc",i.ba),null===i.o&&(i.g.I=i.s),i.g.O=0;var e=hd(i.wa);$i(e,"RID","rpc"),$i(e,"SID",i.K),$i(e,"AID",i.V),$i(e,"CI",i.G?"0":"1"),!i.G&&i.qa&&$i(e,"TO",i.qa),$i(e,"TYPE","xmlhttp"),$b(i,e),i.o&&i.s&&UR(e,i.o,i.s),i.L&&i.g.setTimeout(i.L);var t=i.g;i=i.pa,t.L=1,t.v=ZI(hd(e)),t.s=null,t.S=!0,yL(t,i)}function nC(i){null!=i.v&&(wn.clearTimeout(i.v),i.v=null)}function qL(i,e){var t=null;if(i.g==e){nC(i),HR(i),i.g=null;var n=2}else{if(!NR(i.i,e))return;t=e.F,ML(i.i,e),n=1}if(0!=i.H)if(e.i)if(1==n){t=e.s?e.s.length:0,e=Date.now()-e.G;var r=i.C;Ar(n=de(),new rn(n,t)),tC(i)}else WL(i);else if(3==(r=e.o)||0==r&&0<e.ca||!(1==n&&function g4(i,e){return!(RL(i.i)>=i.i.j-(i.m?1:0)||(i.m?(i.j=e.F.concat(i.j),0):1==i.H||2==i.H||i.C>=(i.cb?0:i.eb)||(i.m=ze(vs(i.Na,i,e),YL(i,i.C)),i.C++,0)))}(i,e)||2==n&&$R(i)))switch(t&&0<t.length&&(e=i.i,e.i=e.i.concat(t)),r){case 1:yp(i,5);break;case 4:yp(i,10);break;case 3:yp(i,6);break;default:yp(i,2)}}function YL(i,e){let t=i.ab+Math.floor(Math.random()*i.hb);return i.isActive()||(t*=2),t*e}function yp(i,e){if(i.l.info("Error code "+e),2==e){var t=null;i.h&&(t=null);var n=vs(i.pb,i);t||(t=new _p("//www.google.com/images/cleardot.gif"),wn.location&&"http"==wn.location.protocol||qI(t,"https"),ZI(t)),function u4(i,e){const t=new _;if(wn.Image){const n=new Image;n.onload=cp(XI,t,n,"TestLoadImage: loaded",!0,e),n.onerror=cp(XI,t,n,"TestLoadImage: error",!1,e),n.onabort=cp(XI,t,n,"TestLoadImage: abort",!1,e),n.ontimeout=cp(XI,t,n,"TestLoadImage: timeout",!1,e),wn.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=i}else e(!1)}(t.toString(),n)}else ht(2);i.H=0,i.h&&i.h.za(e),ZL(i),jL(i)}function ZL(i){if(i.H=0,i.ma=[],i.h){const e=OL(i.i);(0!=e.length||0!=i.j.length)&&(pb(i.ma,e),pb(i.ma,i.j),i.i.i.length=0,S_(i.j),i.j.length=0),i.h.ya()}}function XL(i,e,t){var n=t instanceof _p?hd(t):new _p(t);if(""!=n.g)e&&(n.g=e+"."+n.g),YI(n,n.m);else{var r=wn.location;n=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new _p(null);n&&qI(s,n),e&&(s.g=e),r&&YI(s,r),t&&(s.l=t),n=s}return e=i.Da,(t=i.F)&&e&&$i(n,t,e),$i(n,"VER",i.ra),$b(i,n),n}function QL(i,e,t){if(e&&!i.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new vr(t&&i.Ha&&!i.va?new Fb({ob:!0}):i.va)).Oa(i.J),e}function JL(){}function iC(){if(dp&&!(10<=Number(wR)))throw Error("Environmental error: no available transport.")}function Ua(i,e){Dr.call(this),this.g=new HL(e),this.l=i,this.h=e&&e.messageUrlParams||null,i=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(i?i["X-Client-Protocol"]="webchannel":i={"X-Client-Protocol":"webchannel"}),this.g.s=i,i=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(i?i["X-WebChannel-Content-Type"]=e.messageContentType:i={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(i?i["X-WebChannel-Client-Profile"]=e.Ca:i={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=i,(i=e&&e.cc)&&!ru(i)&&(this.g.o=i),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ru(e)&&(this.g.F=e,null!==(i=this.h)&&e in i&&e in(i=this.h)&&delete i[e]),this.j=new F_(this)}function eN(i){kR.call(this),i.__headers__&&(this.headers=i.__headers__,this.statusCode=i.__status__,delete i.__headers__,delete i.__status__);var e=i.__sm__;if(e){e:{for(const t in e){i=t;break e}i=void 0}(this.i=i)&&(i=this.i,e=null!==e&&i in e?e[i]:void 0),this.data=e}else this.data=i}function tN(){RR.call(this),this.status=1}function F_(i){this.g=i}function ac(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function jR(i,e,t){t||(t=0);var n=Array(16);if("string"==typeof e)for(var r=0;16>r;++r)n[r]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(r=0;16>r;++r)n[r]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var s=i.g[3],o=(e=i.g[0])+(s^(t=i.g[1])&((r=i.g[2])^s))+n[0]+3614090360&4294967295;o=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=t+(o<<7&4294967295|o>>>25))+((o=s+(r^e&(t^r))+n[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(t^s&(e^t))+n[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^r&(s^e))+n[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(r^s))+n[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(t^r))+n[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(t^s&(e^t))+n[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^r&(s^e))+n[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(r^s))+n[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(t^r))+n[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(t^s&(e^t))+n[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^r&(s^e))+n[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(r^s))+n[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(t^r))+n[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(t^s&(e^t))+n[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^r&(s^e))+n[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^s&(t^r))+n[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^r&(e^t))+n[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^t&(s^e))+n[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(r^s))+n[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(t^r))+n[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^r&(e^t))+n[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^t&(s^e))+n[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(r^s))+n[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(t^r))+n[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^r&(e^t))+n[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^t&(s^e))+n[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(r^s))+n[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(t^r))+n[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^r&(e^t))+n[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^t&(s^e))+n[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(r^s))+n[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(t^r^s)+n[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^r)+n[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^t)+n[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=t+(r^s^e)+n[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^r^s)+n[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^r)+n[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^t)+n[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=t+(r^s^e)+n[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^r^s)+n[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^r)+n[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^t)+n[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=t+(r^s^e)+n[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^r^s)+n[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^r)+n[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^t)+n[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=t+(r^s^e)+n[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(r^(t|~s))+n[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~r))+n[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~t))+n[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(r|~e))+n[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(t|~s))+n[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~r))+n[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~t))+n[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(r|~e))+n[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(t|~s))+n[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~r))+n[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~t))+n[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(r|~e))+n[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=t+((o=e+(r^(t|~s))+n[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~r))+n[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(e^(s|~t))+n[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+n[9]+3951481745&4294967295,i.g[0]=i.g[0]+e&4294967295,i.g[1]=i.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,i.g[2]=i.g[2]+r&4294967295,i.g[3]=i.g[3]+s&4294967295}function hi(i,e){this.h=e;for(var t=[],n=!0,r=i.length-1;0<=r;r--){var s=0|i[r];n&&s==e||(t[r]=s,n=!1)}this.g=t}(gt=vr.prototype).Oa=function(i){this.M=i},gt.ha=function(i,e,t,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+i);e=e?e.toUpperCase():"GET",this.I=i,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():MR.g(),this.C=function AR(i){return i.h||(i.h=i.i())}(this.u?this.u:MR),this.g.onreadystatechange=vs(this.La,this);try{this.G=!0,this.g.open(e,String(i),!0),this.G=!1}catch(s){return void NL(this,s)}if(i=t||"",t=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var r in n)t.set(r,n[r]);else{if("function"!=typeof n.keys||"function"!=typeof n.get)throw Error("Unknown input type for opt_headers: "+String(n));for(const s of n.keys())t.set(s,n.get(s))}n=Array.from(t.keys()).find(s=>"content-type"==s.toLowerCase()),r=wn.FormData&&i instanceof wn.FormData,!(0<=mb(f4,e))||n||r||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of t)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{UL(this),0<this.B&&((this.L=function m4(i){return dp&&"number"==typeof i.timeout&&void 0!==i.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=vs(this.ua,this)):this.A=GI(this.ua,this.B,this)),this.v=!0,this.g.send(i),this.v=!1}catch(s){NL(this,s)}},gt.ua=function(){typeof hb<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ar(this,"timeout"),this.abort(8))},gt.abort=function(i){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=i||7,Ar(this,"complete"),Ar(this,"abort"),JI(this))},gt.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),JI(this,!0)),vr.$.N.call(this)},gt.La=function(){this.s||(this.G||this.v||this.l?BL(this):this.kb())},gt.kb=function(){BL(this)},gt.isActive=function(){return!!this.g},gt.da=function(){try{return 2<su(this)?this.g.status:-1}catch{return-1}},gt.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},gt.Wa=function(i){if(this.g){var e=this.g.responseText;return i&&0==e.indexOf(i)&&(e=e.substring(i.length)),d4(e)}},gt.Ia=function(){return this.m},gt.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(gt=HL.prototype).ra=8,gt.H=1,gt.Na=function(i){if(this.m)if(this.m=null,1==this.H){if(!i){this.W=Math.floor(1e5*Math.random()),i=this.W++;const r=new Rb(this,this.l,i);let s=this.s;if(this.U&&(s?(s=A_(s),ER(s,this.U)):s=this.U),null!==this.o||this.O||(r.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){var n=this.j[t];if(void 0===(n="__data__"in n.map&&"string"==typeof(n=n.map.__data__)?n.length:void 0))break;if(4096<(e+=n)){e=t;break e}if(4096===e||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=zL(this,r,e),$i(t=hd(this.I),"RID",i),$i(t,"CVER",22),this.F&&$i(t,"X-HTTP-Session-Id",this.F),$b(this,t),s&&(this.O?e="headers="+encodeURIComponent(String($L(s)))+"&"+e:this.o&&UR(t,this.o,s)),FR(this.i,r),this.bb&&$i(t,"TYPE","init"),this.P?($i(t,"$req",e),$i(t,"SID","null"),r.aa=!0,PR(r,t,null)):PR(r,t,e),this.H=2}}else 3==this.H&&(i?GL(this,i):0==this.j.length||kL(this.i)||GL(this))},gt.Ma=function(){if(this.u=null,KL(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var i=2*this.S;this.l.info("BP detection timer enabled: "+i),this.B=ze(vs(this.jb,this),i)}},gt.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,ht(10),eC(this),KL(this))},gt.ib=function(){null!=this.v&&(this.v=null,eC(this),$R(this),ht(19))},gt.pb=function(i){i?(this.l.info("Successfully pinged google.com"),ht(2)):(this.l.info("Failed to ping google.com"),ht(1))},gt.isActive=function(){return!!this.h&&this.h.isActive(this)},(gt=JL.prototype).Ba=function(){},gt.Aa=function(){},gt.za=function(){},gt.ya=function(){},gt.isActive=function(){return!0},gt.Va=function(){},iC.prototype.g=function(i,e){return new Ua(i,e)},Qr(Ua,Dr),Ua.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var i=this.g,e=this.l,t=this.h||void 0;ht(0),i.Y=e,i.na=t||{},i.G=i.aa,i.I=XL(i,null,i.Y),tC(i)},Ua.prototype.close=function(){VR(this.g)},Ua.prototype.u=function(i){var e=this.g;if("string"==typeof i){var t={};t.__data__=i,i=t}else this.v&&((t={}).__data__=Sb(i),i=t);e.j.push(new class{constructor(i,e){this.g=i,this.map=e}}(e.fb++,i)),3==e.H&&tC(e)},Ua.prototype.N=function(){this.g.h=null,delete this.j,VR(this.g),delete this.g,Ua.$.N.call(this)},Qr(eN,kR),Qr(tN,RR),Qr(F_,JL),F_.prototype.Ba=function(){Ar(this.g,"a")},F_.prototype.Aa=function(i){Ar(this.g,new eN(i))},F_.prototype.za=function(i){Ar(this.g,new tN)},F_.prototype.ya=function(){Ar(this.g,"b")},Qr(ac,function _4(){this.blockSize=-1}),ac.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},ac.prototype.j=function(i,e){void 0===e&&(e=i.length);for(var t=e-this.blockSize,n=this.m,r=this.h,s=0;s<e;){if(0==r)for(;s<=t;)jR(this,i,s),s+=this.blockSize;if("string"==typeof i){for(;s<e;)if(n[r++]=i.charCodeAt(s++),r==this.blockSize){jR(this,n),r=0;break}}else for(;s<e;)if(n[r++]=i[s++],r==this.blockSize){jR(this,n),r=0;break}}this.h=r,this.i+=e},ac.prototype.l=function(){var i=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);i[0]=128;for(var e=1;e<i.length-8;++e)i[e]=0;var t=8*this.i;for(e=i.length-8;e<i.length;++e)i[e]=255&t,t/=256;for(this.j(i),i=Array(16),e=t=0;4>e;++e)for(var n=0;32>n;n+=8)i[t++]=this.g[e]>>>n&255;return i};var y4={};function GR(i){return-128<=i&&128>i?function cL(i,e){var t=y4;return Object.prototype.hasOwnProperty.call(t,i)?t[i]:t[i]=e(i)}(i,function(e){return new hi([0|e],0>e?-1:0)}):new hi([0|i],0>i?-1:0)}function ou(i){if(isNaN(i)||!isFinite(i))return B_;if(0>i)return Us(ou(-i));for(var e=[],t=1,n=0;i>=t;n++)e[n]=i/t|0,t*=zR;return new hi(e,0)}var zR=4294967296,B_=GR(0),WR=GR(1),iN=GR(16777216);function fd(i){if(0!=i.h)return!1;for(var e=0;e<i.g.length;e++)if(0!=i.g[e])return!1;return!0}function _l(i){return-1==i.h}function Us(i){for(var e=i.g.length,t=[],n=0;n<e;n++)t[n]=~i.g[n];return new hi(t,~i.h).add(WR)}function rC(i,e){return i.add(Us(e))}function sC(i,e){for(;(65535&i[e])!=i[e];)i[e+1]+=i[e]>>>16,i[e]&=65535,e++}function Hb(i,e){this.g=i,this.h=e}function oC(i,e){if(fd(e))throw Error("division by zero");if(fd(i))return new Hb(B_,B_);if(_l(i))return e=oC(Us(i),e),new Hb(Us(e.g),Us(e.h));if(_l(e))return e=oC(i,Us(e)),new Hb(Us(e.g),e.h);if(30<i.g.length){if(_l(i)||_l(e))throw Error("slowDivide_ only works with positive integers.");for(var t=WR,n=e;0>=n.X(i);)t=rN(t),n=rN(n);var r=U_(t,1),s=U_(n,1);for(n=U_(n,2),t=U_(t,2);!fd(n);){var o=s.add(n);0>=o.X(i)&&(r=r.add(t),s=o),n=U_(n,1),t=U_(t,1)}return e=rC(i,r.R(e)),new Hb(r,e)}for(r=B_;0<=i.X(e);){for(t=Math.max(1,Math.floor(i.ea()/e.ea())),n=48>=(n=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,n-48),o=(s=ou(t)).R(e);_l(o)||0<o.X(i);)o=(s=ou(t-=n)).R(e);fd(s)&&(s=WR),r=r.add(s),i=rC(i,o)}return new Hb(r,i)}function rN(i){for(var e=i.g.length+1,t=[],n=0;n<e;n++)t[n]=i.D(n)<<1|i.D(n-1)>>>31;return new hi(t,i.h)}function U_(i,e){var t=e>>5;e%=32;for(var n=i.g.length-t,r=[],s=0;s<n;s++)r[s]=0<e?i.D(s+t)>>>e|i.D(s+t+1)<<32-e:i.D(s+t);return new hi(r,i.h)}(gt=hi.prototype).ea=function(){if(_l(this))return-Us(this).ea();for(var i=0,e=1,t=0;t<this.g.length;t++){var n=this.D(t);i+=(0<=n?n:zR+n)*e,e*=zR}return i},gt.toString=function(i){if(2>(i=i||10)||36<i)throw Error("radix out of range: "+i);if(fd(this))return"0";if(_l(this))return"-"+Us(this).toString(i);for(var e=ou(Math.pow(i,6)),t=this,n="";;){var r=oC(t,e).g,s=((0<(t=rC(t,r.R(e))).g.length?t.g[0]:t.h)>>>0).toString(i);if(fd(t=r))return s+n;for(;6>s.length;)s="0"+s;n=s+n}},gt.D=function(i){return 0>i?0:i<this.g.length?this.g[i]:this.h},gt.X=function(i){return _l(i=rC(this,i))?-1:fd(i)?0:1},gt.abs=function(){return _l(this)?Us(this):this},gt.add=function(i){for(var e=Math.max(this.g.length,i.g.length),t=[],n=0,r=0;r<=e;r++){var s=n+(65535&this.D(r))+(65535&i.D(r)),o=(s>>>16)+(this.D(r)>>>16)+(i.D(r)>>>16);n=o>>>16,t[r]=(o&=65535)<<16|(s&=65535)}return new hi(t,-2147483648&t[t.length-1]?-1:0)},gt.R=function(i){if(fd(this)||fd(i))return B_;if(_l(this))return _l(i)?Us(this).R(Us(i)):Us(Us(this).R(i));if(_l(i))return Us(this.R(Us(i)));if(0>this.X(iN)&&0>i.X(iN))return ou(this.ea()*i.ea());for(var e=this.g.length+i.g.length,t=[],n=0;n<2*e;n++)t[n]=0;for(n=0;n<this.g.length;n++)for(var r=0;r<i.g.length;r++){var s=this.D(n)>>>16,o=65535&this.D(n),c=i.D(r)>>>16,h=65535&i.D(r);t[2*n+2*r]+=o*h,sC(t,2*n+2*r),t[2*n+2*r+1]+=s*h,sC(t,2*n+2*r+1),t[2*n+2*r+1]+=o*c,sC(t,2*n+2*r+1),t[2*n+2*r+2]+=s*c,sC(t,2*n+2*r+2)}for(n=0;n<e;n++)t[n]=t[2*n+1]<<16|t[2*n];for(n=e;n<2*e;n++)t[n]=0;return new hi(t,0)},gt.gb=function(i){return oC(this,i).h},gt.and=function(i){for(var e=Math.max(this.g.length,i.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)&i.D(n);return new hi(t,this.h&i.h)},gt.or=function(i){for(var e=Math.max(this.g.length,i.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)|i.D(n);return new hi(t,this.h|i.h)},gt.xor=function(i){for(var e=Math.max(this.g.length,i.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)^i.D(n);return new hi(t,this.h^i.h)},iC.prototype.createWebChannel=iC.prototype.g,Ua.prototype.send=Ua.prototype.u,Ua.prototype.open=Ua.prototype.m,Ua.prototype.close=Ua.prototype.close,dn.NO_ERROR=0,dn.TIMEOUT=8,dn.HTTP_ERROR=6,xi.COMPLETE="complete",gL.EventType=kb,kb.OPEN="a",kb.CLOSE="b",kb.ERROR="c",kb.MESSAGE="d",Dr.prototype.listen=Dr.prototype.O,vr.prototype.listenOnce=vr.prototype.P,vr.prototype.getLastError=vr.prototype.Sa,vr.prototype.getLastErrorCode=vr.prototype.Ia,vr.prototype.getStatus=vr.prototype.da,vr.prototype.getResponseJson=vr.prototype.Wa,vr.prototype.getResponseText=vr.prototype.ja,vr.prototype.send=vr.prototype.ha,vr.prototype.setWithCredentials=vr.prototype.Oa,ac.prototype.digest=ac.prototype.l,ac.prototype.reset=ac.prototype.reset,ac.prototype.update=ac.prototype.j,hi.prototype.add=hi.prototype.add,hi.prototype.multiply=hi.prototype.R,hi.prototype.modulo=hi.prototype.gb,hi.prototype.compare=hi.prototype.X,hi.prototype.toNumber=hi.prototype.ea,hi.prototype.toString=hi.prototype.toString,hi.prototype.getBits=hi.prototype.D,hi.fromNumber=ou,hi.fromString=function nN(i,e){if(0==i.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==i.charAt(0))return Us(nN(i.substring(1),e));if(0<=i.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=ou(Math.pow(e,8)),n=B_,r=0;r<i.length;r+=8){var s=Math.min(8,i.length-r),o=parseInt(i.substring(r,r+s),e);8>s?(s=ou(Math.pow(e,s)),n=n.R(s).add(ou(o))):n=(n=n.R(t)).add(ou(o))}return n};var oN,aN,lN,cN,uN,hN,fN,mN,pN,gN,_N,yN,vN,bN,wN,EN,xN,TN,IN,CN,SN,DN,AN,kN,RN,MN,ON,PN,LN,NN,FN,BN,UN,VN,$N,HN,jN,GN,zN,WN,KN,qN,YN,v4=Do.createWebChannelTransport=function(){return new iC},b4=Do.getStatEventTarget=function(){return de()},KR=Do.ErrorCode=dn,w4=Do.EventType=xi,E4=Do.Event=W,sN=Do.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},x4=Do.FetchXmlHttpFactory=Fb,aC=Do.WebChannel=gL,T4=Do.XhrIo=vr,I4=Do.Md5=ac,V_=Do.Integer=hi;const ZN="@firebase/firestore";class bs{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}bs.UNAUTHENTICATED=new bs(null),bs.GOOGLE_CREDENTIALS=new bs("google-credentials-uid"),bs.FIRST_PARTY=new bs("first-party-uid"),bs.MOCK_USER=new bs("mock-user");let $_="9.23.0";const sf=new Ra.Yd("@firebase/firestore");function qR(){return sf.logLevel}function nt(i,...e){if(sf.logLevel<=Ra.in.DEBUG){const t=e.map(YR);sf.debug(`Firestore (${$_}): ${i}`,...t)}}function kr(i,...e){if(sf.logLevel<=Ra.in.ERROR){const t=e.map(YR);sf.error(`Firestore (${$_}): ${i}`,...t)}}function yl(i,...e){if(sf.logLevel<=Ra.in.WARN){const t=e.map(YR);sf.warn(`Firestore (${$_}): ${i}`,...t)}}function YR(i){if("string"==typeof i)return i;try{return JSON.stringify(i)}catch{return i}}function Ot(i="Unexpected state"){const e=`FIRESTORE (${$_}) INTERNAL ASSERTION FAILED: `+i;throw kr(e),new Error(e)}function qt(i,e){i||Ot()}function yt(i,e){return i}const be={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $e extends bn.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class es{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class XN{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class D4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(bs.UNAUTHENTICATED))}shutdown(){}}class A4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class k4{constructor(e){this.t=e,this.currentUser=bs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var n=this;let r=this.i;const s=m=>this.i!==r?(r=this.i,t(m)):Promise.resolve();let o=new es;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new es,e.enqueueRetryable(()=>s(this.currentUser))};const c=()=>{const m=o;e.enqueueRetryable((0,Ie.Z)(function*(){yield m.promise,yield s(n.currentUser)}))},h=m=>{nt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.auth.addAuthTokenListener(this.o),c()};this.t.onInit(m=>h(m)),setTimeout(()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?h(m):(nt("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new es)}},0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(nt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(qt("string"==typeof n.accessToken),new XN(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return qt(null===e||"string"==typeof e),new bs(e)}}class R4{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=bs.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class M4{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new R4(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(bs.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class QN{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class O4{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const n=s=>{null!=s.error&&nt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.T;return this.T=s.token,nt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const r=s=>{nt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.I.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.I.getImmediate({optional:!0});s?r(s):nt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(qt("string"==typeof t.token),this.T=t.token,new QN(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function P4(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let n=0;n<i;n++)t[n]=Math.floor(256*Math.random());return t}class JN{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const r=P4(40);for(let s=0;s<r.length;++s)n.length<20&&r[s]<t&&(n+=e.charAt(r[s]%e.length))}return n}}function En(i,e){return i<e?-1:i>e?1:0}function H_(i,e,t){return i.length===e.length&&i.every((n,r)=>t(n,e[r]))}function eF(i){return i+"\0"}class er{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new $e(be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new $e(be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new $e(be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $e(be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return er.fromMillis(Date.now())}static fromDate(e){return er.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new er(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?En(this.nanoseconds,e.nanoseconds):En(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Yt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Yt(e)}static min(){return new Yt(new er(0,0))}static max(){return new Yt(new er(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class jb{constructor(e,t,n){void 0===t?t=0:t>e.length&&Ot(),void 0===n?n=e.length-t:n>e.length-t&&Ot(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===jb.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof jb?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const s=e.get(r),o=t.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Xn extends jb{construct(e,t,n){return new Xn(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new $e(be.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(r=>r.length>0))}return new Xn(t)}static emptyPath(){return new Xn([])}}const L4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class br extends jb{construct(e,t,n){return new br(e,t,n)}static isValidIdentifier(e){return L4.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),br.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new br(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const s=()=>{if(0===n.length)throw new $e(be.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;r<e.length;){const c=e[r];if("\\"===c){if(r+1===e.length)throw new $e(be.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[r+1];if("\\"!==h&&"."!==h&&"`"!==h)throw new $e(be.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=h,r+=2}else"`"===c?(o=!o,r++):"."!==c||o?(n+=c,r++):(s(),r++)}if(s(),o)throw new $e(be.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new br(t)}static emptyPath(){return new br([])}}class pt{constructor(e){this.path=e}static fromPath(e){return new pt(Xn.fromString(e))}static fromName(e){return new pt(Xn.fromString(e).popFirst(5))}static empty(){return new pt(Xn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Xn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Xn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new pt(new Xn(e.slice()))}}class lC{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function ZR(i){return i.fields.find(e=>2===e.kind)}function vp(i){return i.fields.filter(e=>2!==e.kind)}lC.UNKNOWN_ID=-1;class cC{constructor(e,t){this.fieldPath=e,this.kind=t}}class Gb{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Gb(0,Va.min())}}function tF(i,e){const t=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,r=Yt.fromTimestamp(1e9===n?new er(t+1,0):new er(t,n));return new Va(r,pt.empty(),e)}function nF(i){return new Va(i.readTime,i.key,-1)}class Va{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Va(Yt.min(),pt.empty(),-1)}static max(){return new Va(Yt.max(),pt.empty(),-1)}}function XR(i,e){let t=i.readTime.compareTo(e.readTime);return 0!==t?t:(t=pt.comparator(i.documentKey,e.documentKey),0!==t?t:En(i.largestBatchId,e.largestBatchId))}const iF="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class rF{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function af(i){return(oN=oN||(0,Ie.Z)(function*(e){if(e.code!==be.FAILED_PRECONDITION||e.message!==iF)throw e;nt("LocalStore","Unexpectedly lost primary lease")})).apply(this,arguments)}class ge{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ot(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ge((n,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ge?t:ge.resolve(t)}catch(t){return ge.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ge.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ge.reject(t)}static resolve(e){return new ge((t,n)=>{t(e)})}static reject(e){return new ge((t,n)=>{n(e)})}static waitFor(e){return new ge((t,n)=>{let r=0,s=0,o=!1;e.forEach(c=>{++r,c.next(()=>{++s,o&&s===r&&t()},h=>n(h))}),o=!0,s===r&&t()})}static or(e){let t=ge.resolve(!1);for(const n of e)t=t.next(r=>r?ge.resolve(r):n());return t}static forEach(e,t){const n=[];return e.forEach((r,s)=>{n.push(t.call(this,r,s))}),this.waitFor(n)}static mapArray(e,t){return new ge((n,r)=>{const s=e.length,o=new Array(s);let c=0;for(let h=0;h<s;h++){const m=h;t(e[m]).next(g=>{o[m]=g,++c,c===s&&n(o)},g=>r(g))}})}static doWhile(e,t){return new ge((n,r)=>{const s=()=>{!0===e()?t().next(()=>{s()},r):n()};s()})}}class uC{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.v=new es,this.transaction.oncomplete=()=>{this.v.resolve()},this.transaction.onabort=()=>{t.error?this.v.reject(new zb(e,t.error)):this.v.resolve()},this.transaction.onerror=n=>{const r=QR(n.target.error);this.v.reject(new zb(e,r))}}static open(e,t,n,r){try{return new uC(t,e.transaction(r,n))}catch(s){throw new zb(t,s)}}get R(){return this.v.promise}abort(e){e&&this.v.reject(e),this.aborted||(nt("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}P(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new U4(t)}}class lc{constructor(e,t,n){this.name=e,this.version=t,this.V=n,12.2===lc.S((0,bn.z$)())&&kr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return nt("SimpleDb","Removing database:",e),bp(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,bn.hl)())return!1;if(lc.C())return!0;const e=(0,bn.z$)(),t=lc.S(e),n=0<t&&t<10,r=lc.N(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.k)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static N(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}$(e){var t=this;return(0,Ie.Z)(function*(){return t.db||(nt("SimpleDb","Opening database:",t.name),t.db=yield new Promise((n,r)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=o=>{n(o.target.result)},s.onblocked=()=>{r(new zb(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const c=o.target.error;r("VersionError"===c.name?new $e(be.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===c.name?new $e(be.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+c):new zb(e,c))},s.onupgradeneeded=o=>{nt("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',o.oldVersion),t.V.O(o.target.result,s.transaction,o.oldVersion,t.version).next(()=>{nt("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.F&&(t.db.onversionchange=n=>t.F(n)),t.db})()}B(e){this.F=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,n,r){var s=this;return(0,Ie.Z)(function*(){const o="readonly"===t;let c=0;for(;;){++c;try{s.db=yield s.$(e);const h=uC.open(s.db,e,o?"readonly":"readwrite",n),m=r(h).next(g=>(h.P(),g)).catch(g=>(h.abort(g),ge.reject(g))).toPromise();return m.catch(()=>{}),yield h.R,m}catch(h){const m=h,g="FirebaseError"!==m.name&&c<3;if(nt("SimpleDb","Transaction failed with error:",m.message,"Retrying:",g),s.close(),!g)return Promise.reject(m)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class B4{constructor(e){this.L=e,this.q=!1,this.U=null}get isDone(){return this.q}get K(){return this.U}set cursor(e){this.L=e}done(){this.q=!0}G(e){this.U=e}delete(){return bp(this.L.delete())}}class zb extends $e{constructor(e,t){super(be.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function lf(i){return"IndexedDbTransactionError"===i.name}class U4{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(nt("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(nt("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),bp(n)}add(e){return nt("SimpleDb","ADD",this.store.name,e,e),bp(this.store.add(e))}get(e){return bp(this.store.get(e)).next(t=>(void 0===t&&(t=null),nt("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return nt("SimpleDb","DELETE",this.store.name,e),bp(this.store.delete(e))}count(){return nt("SimpleDb","COUNT",this.store.name),bp(this.store.count())}j(e,t){const n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){const r=this.cursor(n),s=[];return this.W(r,(o,c)=>{s.push(c)}).next(()=>s)}{const r=this.store.getAll(n.range);return new ge((s,o)=>{r.onerror=c=>{o(c.target.error)},r.onsuccess=c=>{s(c.target.result)}})}}H(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new ge((r,s)=>{n.onerror=o=>{s(o.target.error)},n.onsuccess=o=>{r(o.target.result)}})}J(e,t){nt("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.Y=!1;const r=this.cursor(n);return this.W(r,(s,o,c)=>c.delete())}X(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.W(r,t)}Z(e){const t=this.cursor({});return new ge((n,r)=>{t.onerror=s=>{const o=QR(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(c=>{c?o.continue():n()}):n()}})}W(e,t){const n=[];return new ge((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const c=o.target.result;if(!c)return void r();const h=new B4(c),m=t(c.primaryKey,c.value,h);if(m instanceof ge){const g=m.catch(y=>(h.done(),ge.reject(y)));n.push(g)}h.isDone?r():null===h.K?c.continue():c.continue(h.K)}}).next(()=>ge.waitFor(n))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function bp(i){return new ge((e,t)=>{i.onsuccess=n=>{e(n.target.result)},i.onerror=n=>{const r=QR(n.target.error);t(r)}})}let sF=!1;function QR(i){const e=lc.S((0,bn.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(i.message.indexOf(t)>=0){const n=new $e("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return sF||(sF=!0,setTimeout(()=>{throw n},0)),n}}return i}class V4{constructor(e,t){this.asyncQueue=e,this.tt=t,this.task=null}start(){this.et(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}et(e){var t=this;nt("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,Ie.Z)(function*(){t.task=null;try{nt("IndexBackiller",`Documents written: ${yield t.tt.nt()}`)}catch(n){lf(n)?nt("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):yield af(n)}yield t.et(6e4)}))}}class $4{constructor(e,t){this.localStore=e,this.persistence=t}nt(e=50){var t=this;return(0,Ie.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>t.st(n,e))})()}st(e,t){const n=new Set;let r=t,s=!0;return ge.doWhile(()=>!0===s&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(null!==o&&!n.has(o))return nt("IndexBackiller",`Processing collection: ${o}`),this.it(e,o,r).next(c=>{r-=c,n.add(o)});s=!1})).next(()=>t-r)}it(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.rt(r,s)).next(c=>(nt("IndexBackiller",`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c))).next(()=>o.size)}))}rt(e,t){let n=e;return t.changes.forEach((r,s)=>{const o=nF(s);XR(o,n)>0&&(n=o)}),new Va(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}let $a=(()=>{class i{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=r=>this.ot(r),this.ut=r=>n.writeSequenceNumber(r))}ot(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ut&&this.ut(t),t}}return i.ct=-1,i})();function Wb(i){return null==i}function Kb(i){return 0===i&&1/i==-1/0}function oF(i){return"number"==typeof i&&Number.isInteger(i)&&!Kb(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}function io(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=aF(e)),e=H4(i.get(t),e);return aF(e)}function H4(i,e){let t=e;const n=i.length;for(let r=0;r<n;r++){const s=i.charAt(r);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function aF(i){return i+"\x01\x01"}function au(i){const e=i.length;if(qt(e>=2),2===e)return qt("\x01"===i.charAt(0)&&"\x01"===i.charAt(1)),Xn.emptyPath();const t=e-2,n=[];let r="";for(let s=0;s<e;){const o=i.indexOf("\x01",s);switch((o<0||o>t)&&Ot(),i.charAt(o+1)){case"\x01":const c=i.substring(s,o);let h;0===r.length?h=c:(r+=c,h=r,r=""),n.push(h);break;case"\x10":r+=i.substring(s,o),r+="\0";break;case"\x11":r+=i.substring(s,o+1);break;default:Ot()}s=o+2}return new Xn(n)}const lF=["userId","batchId"];function dC(i,e){return[i,io(e)]}function cF(i,e,t){return[i,io(e),t]}const j4={},G4=["prefixPath","collectionGroup","readTime","documentId"],z4=["prefixPath","collectionGroup","documentId"],W4=["collectionGroup","readTime","prefixPath","documentId"],K4=["canonicalId","targetId"],q4=["targetId","path"],Y4=["path","targetId"],Z4=["collectionId","parent"],X4=["indexId","uid"],Q4=["uid","sequenceNumber"],J4=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ej=["indexId","uid","orderedDocumentKey"],tj=["userId","collectionPath","documentId"],nj=["userId","collectionPath","largestBatchId"],ij=["userId","collectionGroup","largestBatchId"],uF=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],rj=[...uF,"documentOverlays"],dF=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],hF=dF,sj=[...hF,"indexConfiguration","indexState","indexEntries"];class JR extends rF{constructor(e,t){super(),this.ht=e,this.currentSequenceNumber=t}}function ws(i,e){const t=yt(i);return lc.M(t.ht,e)}function fF(i){let e=0;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function cf(i,e){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function mF(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}class Di{constructor(e,t){this.comparator=e,this.root=t||Vs.EMPTY}insert(e,t){return new Di(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Vs.BLACK,null,null))}remove(e){return new Di(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new hC(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new hC(this.root,e,this.comparator,!1)}getReverseIterator(){return new hC(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new hC(this.root,e,this.comparator,!0)}}class hC{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Vs{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=n??Vs.RED,this.left=r??Vs.EMPTY,this.right=s??Vs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new Vs(e??this.key,t??this.value,n??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Vs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Vs.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Vs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Vs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ot();const e=this.left.check();if(e!==this.right.check())throw Ot();return e+(this.isRed()?0:1)}}Vs.EMPTY=null,Vs.RED=!0,Vs.BLACK=!1,Vs.EMPTY=new class{constructor(){this.size=0}get key(){throw Ot()}get value(){throw Ot()}get color(){throw Ot()}get left(){throw Ot()}get right(){throw Ot()}copy(i,e,t,n,r){return this}insert(i,e,t){return new Vs(i,e)}remove(i,e){return this}isEmpty(){return!0}inorderTraversal(i){return!1}reverseTraversal(i){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Hi{constructor(e){this.comparator=e,this.data=new Di(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new pF(this.data.getIterator())}getIteratorFrom(e){return new pF(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof Hi)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=n.getNext().key;if(0!==this.comparator(r,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Hi(this.comparator);return t.data=e,t}}class pF{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function j_(i){return i.hasNext()?i.getNext():void 0}class ia{constructor(e){this.fields=e,e.sort(br.comparator)}static empty(){return new ia([])}unionWith(e){let t=new Hi(br.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new ia(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return H_(this.fields,e.fields,(t,n)=>t.isEqual(n))}}class gF extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ts{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(n){try{return atob(n)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new gF("Invalid base64 string: "+r):r}}(e);return new ts(t)}static fromUint8Array(e){const t=function(n){let r="";for(let s=0;s<n.length;++s)r+=String.fromCharCode(n[s]);return r}(e);return new ts(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return En(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ts.EMPTY_BYTE_STRING=new ts("");const aj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function uf(i){if(qt(!!i),"string"==typeof i){let e=0;const t=aj.exec(i);if(qt(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:wr(i.seconds),nanos:wr(i.nanos)}}function wr(i){return"number"==typeof i?i:"string"==typeof i?Number(i):0}function md(i){return"string"==typeof i?ts.fromBase64String(i):ts.fromUint8Array(i)}function fC(i){var e,t;return"server_timestamp"===(null===(t=((null===(e=i?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function mC(i){const e=i.mapValue.fields.__previous_value__;return fC(e)?mC(e):e}function qb(i){const e=uf(i.mapValue.fields.__local_write_time__.timestampValue);return new er(e.seconds,e.nanos)}class lj{constructor(e,t,n,r,s,o,c,h,m){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=h,this.useFetchStreams=m}}class df{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new df("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof df&&e.projectId===this.projectId&&e.database===this.database}}const hf={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},pC={nullValue:"NULL_VALUE"};function ff(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?fC(i)?4:bF(i)?9007199254740991:10:Ot()}function lu(i,e){if(i===e)return!0;const t=ff(i);if(t!==ff(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return qb(i).isEqual(qb(e));case 3:return function(n,r){if("string"==typeof n.timestampValue&&"string"==typeof r.timestampValue&&n.timestampValue.length===r.timestampValue.length)return n.timestampValue===r.timestampValue;const s=uf(n.timestampValue),o=uf(r.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(i,e);case 5:return i.stringValue===e.stringValue;case 6:return function(n,r){return md(n.bytesValue).isEqual(md(r.bytesValue))}(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return function(n,r){return wr(n.geoPointValue.latitude)===wr(r.geoPointValue.latitude)&&wr(n.geoPointValue.longitude)===wr(r.geoPointValue.longitude)}(i,e);case 2:return function(n,r){if("integerValue"in n&&"integerValue"in r)return wr(n.integerValue)===wr(r.integerValue);if("doubleValue"in n&&"doubleValue"in r){const s=wr(n.doubleValue),o=wr(r.doubleValue);return s===o?Kb(s)===Kb(o):isNaN(s)&&isNaN(o)}return!1}(i,e);case 9:return H_(i.arrayValue.values||[],e.arrayValue.values||[],lu);case 10:return function(n,r){const s=n.mapValue.fields||{},o=r.mapValue.fields||{};if(fF(s)!==fF(o))return!1;for(const c in s)if(s.hasOwnProperty(c)&&(void 0===o[c]||!lu(s[c],o[c])))return!1;return!0}(i,e);default:return Ot()}}function Yb(i,e){return void 0!==(i.values||[]).find(t=>lu(t,e))}function mf(i,e){if(i===e)return 0;const t=ff(i),n=ff(e);if(t!==n)return En(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return En(i.booleanValue,e.booleanValue);case 2:return function(r,s){const o=wr(r.integerValue||r.doubleValue),c=wr(s.integerValue||s.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(i,e);case 3:return _F(i.timestampValue,e.timestampValue);case 4:return _F(qb(i),qb(e));case 5:return En(i.stringValue,e.stringValue);case 6:return function(r,s){const o=md(r),c=md(s);return o.compareTo(c)}(i.bytesValue,e.bytesValue);case 7:return function(r,s){const o=r.split("/"),c=s.split("/");for(let h=0;h<o.length&&h<c.length;h++){const m=En(o[h],c[h]);if(0!==m)return m}return En(o.length,c.length)}(i.referenceValue,e.referenceValue);case 8:return function(r,s){const o=En(wr(r.latitude),wr(s.latitude));return 0!==o?o:En(wr(r.longitude),wr(s.longitude))}(i.geoPointValue,e.geoPointValue);case 9:return function(r,s){const o=r.values||[],c=s.values||[];for(let h=0;h<o.length&&h<c.length;++h){const m=mf(o[h],c[h]);if(m)return m}return En(o.length,c.length)}(i.arrayValue,e.arrayValue);case 10:return function(r,s){if(r===hf.mapValue&&s===hf.mapValue)return 0;if(r===hf.mapValue)return 1;if(s===hf.mapValue)return-1;const o=r.fields||{},c=Object.keys(o),h=s.fields||{},m=Object.keys(h);c.sort(),m.sort();for(let g=0;g<c.length&&g<m.length;++g){const y=En(c[g],m[g]);if(0!==y)return y;const E=mf(o[c[g]],h[m[g]]);if(0!==E)return E}return En(c.length,m.length)}(i.mapValue,e.mapValue);default:throw Ot()}}function _F(i,e){if("string"==typeof i&&"string"==typeof e&&i.length===e.length)return En(i,e);const t=uf(i),n=uf(e),r=En(t.seconds,n.seconds);return 0!==r?r:En(t.nanos,n.nanos)}function G_(i){return eM(i)}function eM(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?function(n){const r=uf(n);return`time(${r.seconds},${r.nanos})`}(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?md(i.bytesValue).toBase64():"referenceValue"in i?pt.fromName(i.referenceValue).toString():"geoPointValue"in i?`geo(${(e=i.geoPointValue).latitude},${e.longitude})`:"arrayValue"in i?function(n){let r="[",s=!0;for(const o of n.values||[])s?s=!1:r+=",",r+=eM(o);return r+"]"}(i.arrayValue):"mapValue"in i?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",o=!0;for(const c of r)o?o=!1:s+=",",s+=`${c}:${eM(n.fields[c])}`;return s+"}"}(i.mapValue):Ot();var e}function wp(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function tM(i){return!!i&&"integerValue"in i}function Zb(i){return!!i&&"arrayValue"in i}function yF(i){return!!i&&"nullValue"in i}function vF(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function _C(i){return!!i&&"mapValue"in i}function Xb(i){if(i.geoPointValue)return{geoPointValue:Object.assign({},i.geoPointValue)};if(i.timestampValue&&"object"==typeof i.timestampValue)return{timestampValue:Object.assign({},i.timestampValue)};if(i.mapValue){const e={mapValue:{fields:{}}};return cf(i.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Xb(n)),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Xb(i.arrayValue.values[t]);return e}return Object.assign({},i)}function bF(i){return"__max__"===(((i.mapValue||{}).fields||{}).__type__||{}).stringValue}function cj(i){return"nullValue"in i?pC:"booleanValue"in i?{booleanValue:!1}:"integerValue"in i||"doubleValue"in i?{doubleValue:NaN}:"timestampValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in i?{stringValue:""}:"bytesValue"in i?{bytesValue:""}:"referenceValue"in i?wp(df.empty(),pt.empty()):"geoPointValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in i?{arrayValue:{}}:"mapValue"in i?{mapValue:{}}:Ot()}function uj(i){return"nullValue"in i?{booleanValue:!1}:"booleanValue"in i?{doubleValue:NaN}:"integerValue"in i||"doubleValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in i?{stringValue:""}:"stringValue"in i?{bytesValue:""}:"bytesValue"in i?wp(df.empty(),pt.empty()):"referenceValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in i?{arrayValue:{}}:"arrayValue"in i?{mapValue:{}}:"mapValue"in i?hf:Ot()}function wF(i,e){const t=mf(i.value,e.value);return 0!==t?t:i.inclusive&&!e.inclusive?-1:!i.inclusive&&e.inclusive?1:0}function EF(i,e){const t=mf(i.value,e.value);return 0!==t?t:i.inclusive&&!e.inclusive?1:!i.inclusive&&e.inclusive?-1:0}class $s{constructor(e){this.value=e}static empty(){return new $s({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!_C(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Xb(t)}setAll(e){let t=br.emptyPath(),n={},r=[];e.forEach((o,c)=>{if(!t.isImmediateParentOf(c)){const h=this.getFieldsMap(t);this.applyChanges(h,n,r),n={},r=[],t=c.popLast()}o?n[c.lastSegment()]=Xb(o):r.push(c.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){const t=this.field(e.popLast());_C(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return lu(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];_C(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){cf(t,(r,s)=>e[r]=s);for(const r of n)delete e[r]}clone(){return new $s(Xb(this.value))}}function xF(i){const e=[];return cf(i.fields,(t,n)=>{const r=new br([t]);if(_C(n)){const s=xF(n.mapValue).fields;if(0===s.length)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)}),new ia(e)}class ji{constructor(e,t,n,r,s,o,c){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=s,this.data=o,this.documentState=c}static newInvalidDocument(e){return new ji(e,0,Yt.min(),Yt.min(),Yt.min(),$s.empty(),0)}static newFoundDocument(e,t,n,r){return new ji(e,1,t,Yt.min(),n,r,0)}static newNoDocument(e,t){return new ji(e,2,t,Yt.min(),Yt.min(),$s.empty(),0)}static newUnknownDocument(e,t){return new ji(e,3,t,Yt.min(),Yt.min(),$s.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Yt.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=$s.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=$s.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Yt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ji&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ji(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class pf{constructor(e,t){this.position=e,this.inclusive=t}}function TF(i,e,t){let n=0;for(let r=0;r<i.position.length;r++){const s=e[r],o=i.position[r];if(n=s.field.isKeyField()?pt.comparator(pt.fromName(o.referenceValue),t.key):mf(o,t.data.field(s.field)),"desc"===s.dir&&(n*=-1),0!==n)break}return n}function IF(i,e){if(null===i)return null===e;if(null===e||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!lu(i.position[t],e.position[t]))return!1;return!0}class z_{constructor(e,t="asc"){this.field=e,this.dir=t}}function dj(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}class CF{}class Un extends CF{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new hj(e,t,n):"array-contains"===t?new pj(e,n):"in"===t?new MF(e,n):"not-in"===t?new gj(e,n):"array-contains-any"===t?new _j(e,n):new Un(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new fj(e,n):new mj(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(mf(t,this.value)):null!==t&&ff(this.value)===ff(t)&&this.matchesComparison(mf(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Ot()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class fi extends CF{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new fi(e,t)}matches(e){return W_(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(t=>t.isInequality());return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function W_(i){return"and"===i.op}function nM(i){return"or"===i.op}function iM(i){return SF(i)&&W_(i)}function SF(i){for(const e of i.filters)if(e instanceof fi)return!1;return!0}function rM(i){if(i instanceof Un)return i.field.canonicalString()+i.op.toString()+G_(i.value);if(iM(i))return i.filters.map(e=>rM(e)).join(",");{const e=i.filters.map(t=>rM(t)).join(",");return`${i.op}(${e})`}}function DF(i,e){return i instanceof Un?function(t,n){return n instanceof Un&&t.op===n.op&&t.field.isEqual(n.field)&&lu(t.value,n.value)}(i,e):i instanceof fi?function(t,n){return n instanceof fi&&t.op===n.op&&t.filters.length===n.filters.length&&t.filters.reduce((r,s,o)=>r&&DF(s,n.filters[o]),!0)}(i,e):void Ot()}function AF(i,e){const t=i.filters.concat(e);return fi.create(t,i.op)}function kF(i){return i instanceof Un?`${(e=i).field.canonicalString()} ${e.op} ${G_(e.value)}`:i instanceof fi?function(e){return e.op.toString()+" {"+e.getFilters().map(kF).join(" ,")+"}"}(i):"Filter";var e}class hj extends Un{constructor(e,t,n){super(e,t,n),this.key=pt.fromName(n.referenceValue)}matches(e){const t=pt.comparator(e.key,this.key);return this.matchesComparison(t)}}class fj extends Un{constructor(e,t){super(e,"in",t),this.keys=RF(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class mj extends Un{constructor(e,t){super(e,"not-in",t),this.keys=RF(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function RF(i,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(n=>pt.fromName(n.referenceValue))}class pj extends Un{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Zb(t)&&Yb(t.arrayValue,this.value)}}class MF extends Un{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Yb(this.value.arrayValue,t)}}class gj extends Un{constructor(e,t){super(e,"not-in",t)}matches(e){if(Yb(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Yb(this.value.arrayValue,t)}}class _j extends Un{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Zb(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Yb(this.value.arrayValue,n))}}class yj{constructor(e,t=null,n=[],r=[],s=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=o,this.endAt=c,this.dt=null}}function sM(i,e=null,t=[],n=[],r=null,s=null,o=null){return new yj(i,e,t,n,r,s,o)}function Ep(i){const e=yt(i);if(null===e.dt){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>rM(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(r){return r.field.canonicalString()+r.dir}(n)).join(","),Wb(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>G_(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>G_(n)).join(",")),e.dt=t}return e.dt}function Qb(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<i.orderBy.length;t++)if(!dj(i.orderBy[t],e.orderBy[t]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let t=0;t<i.filters.length;t++)if(!DF(i.filters[t],e.filters[t]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!IF(i.startAt,e.startAt)&&IF(i.endAt,e.endAt)}function yC(i){return pt.isDocumentKey(i.path)&&null===i.collectionGroup&&0===i.filters.length}function vC(i,e){return i.filters.filter(t=>t instanceof Un&&t.field.isEqual(e))}function OF(i,e,t){let n=pC,r=!0;for(const s of vC(i,e)){let o=pC,c=!0;switch(s.op){case"<":case"<=":o=cj(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,c=!1;break;case"!=":case"not-in":o=pC}wF({value:n,inclusive:r},{value:o,inclusive:c})<0&&(n=o,r=c)}if(null!==t)for(let s=0;s<i.orderBy.length;++s)if(i.orderBy[s].field.isEqual(e)){const o=t.position[s];wF({value:n,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(n=o,r=t.inclusive);break}return{value:n,inclusive:r}}function PF(i,e,t){let n=hf,r=!0;for(const s of vC(i,e)){let o=hf,c=!0;switch(s.op){case">=":case">":o=uj(s.value),c=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,c=!1;break;case"!=":case"not-in":o=hf}EF({value:n,inclusive:r},{value:o,inclusive:c})>0&&(n=o,r=c)}if(null!==t)for(let s=0;s<i.orderBy.length;++s)if(i.orderBy[s].field.isEqual(e)){const o=t.position[s];EF({value:n,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(n=o,r=t.inclusive);break}return{value:n,inclusive:r}}class pd{constructor(e,t=null,n=[],r=[],s=null,o="F",c=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=o,this.startAt=c,this.endAt=h,this.wt=null,this._t=null}}function LF(i,e,t,n,r,s,o,c){return new pd(i,e,t,n,r,s,o,c)}function K_(i){return new pd(i)}function NF(i){return 0===i.filters.length&&null===i.limit&&null==i.startAt&&null==i.endAt&&(0===i.explicitOrderBy.length||1===i.explicitOrderBy.length&&i.explicitOrderBy[0].field.isKeyField())}function oM(i){return i.explicitOrderBy.length>0?i.explicitOrderBy[0].field:null}function bC(i){for(const e of i.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function aM(i){return null!==i.collectionGroup}function xp(i){const e=yt(i);if(null===e.wt){e.wt=[];const t=bC(e),n=oM(e);if(null!==t&&null===n)t.isKeyField()||e.wt.push(new z_(t)),e.wt.push(new z_(br.keyField(),"asc"));else{let r=!1;for(const s of e.explicitOrderBy)e.wt.push(s),s.field.isKeyField()&&(r=!0);if(!r){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new z_(br.keyField(),s))}}}return e.wt}function Ao(i){const e=yt(i);if(!e._t)if("F"===e.limitType)e._t=sM(e.path,e.collectionGroup,xp(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const s of xp(e))t.push(new z_(s.field,"desc"===s.dir?"asc":"desc"));const n=e.endAt?new pf(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new pf(e.startAt.position,e.startAt.inclusive):null;e._t=sM(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}return e._t}function lM(i,e){e.getFirstInequalityField(),bC(i);const t=i.filters.concat([e]);return new pd(i.path,i.collectionGroup,i.explicitOrderBy.slice(),t,i.limit,i.limitType,i.startAt,i.endAt)}function wC(i,e,t){return new pd(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function Jb(i,e){return Qb(Ao(i),Ao(e))&&i.limitType===e.limitType}function FF(i){return`${Ep(Ao(i))}|lt:${i.limitType}`}function cM(i){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(n=>kF(n)).join(", ")}]`),Wb(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(n=>function(r){return`${r.field.canonicalString()} (${r.dir})`}(n)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>G_(n)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>G_(n)).join(",")),`Target(${t})`}(Ao(i))}; limitType=${i.limitType})`}function ew(i,e){return e.isFoundDocument()&&function(t,n){const r=n.key.path;return null!==t.collectionGroup?n.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(r):pt.isDocumentKey(t.path)?t.path.isEqual(r):t.path.isImmediateParentOf(r)}(i,e)&&function(t,n){for(const r of xp(t))if(!r.field.isKeyField()&&null===n.data.field(r.field))return!1;return!0}(i,e)&&function(t,n){for(const r of t.filters)if(!r.matches(n))return!1;return!0}(i,e)&&function(t,n){return!(t.startAt&&!function(r,s,o){const c=TF(r,s,o);return r.inclusive?c<=0:c<0}(t.startAt,xp(t),n)||t.endAt&&!function(r,s,o){const c=TF(r,s,o);return r.inclusive?c>=0:c>0}(t.endAt,xp(t),n))}(i,e)}function BF(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function UF(i){return(e,t)=>{let n=!1;for(const r of xp(i)){const s=vj(r,e,t);if(0!==s)return s;n=n||r.field.isKeyField()}return 0}}function vj(i,e,t){const n=i.field.isKeyField()?pt.comparator(e.key,t.key):function(r,s,o){const c=s.data.field(r),h=o.data.field(r);return null!==c&&null!==h?mf(c,h):Ot()}(i.field,e,t);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return Ot()}}class gd{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,s]of n)if(this.equalsFn(r,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){cf(this.inner,(t,n)=>{for(const[r,s]of n)e(r,s)})}isEmpty(){return mF(this.inner)}size(){return this.innerSize}}const bj=new Di(pt.comparator);function ra(){return bj}const VF=new Di(pt.comparator);function tw(...i){let e=VF;for(const t of i)e=e.insert(t.key,t);return e}function $F(i){let e=VF;return i.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function cu(){return nw()}function HF(){return nw()}function nw(){return new gd(i=>i.toString(),(i,e)=>i.isEqual(e))}const wj=new Di(pt.comparator),Ej=new Hi(pt.comparator);function An(...i){let e=Ej;for(const t of i)e=e.add(t);return e}const xj=new Hi(En);function uM(){return xj}function jF(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Kb(e)?"-0":e}}function GF(i){return{integerValue:""+i}}function zF(i,e){return oF(e)?GF(e):jF(i,e)}class EC{constructor(){this._=void 0}}function Tj(i,e,t){return i instanceof q_?function(n,r){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return r&&fC(r)&&(r=mC(r)),r&&(s.fields.__previous_value__=r),{mapValue:s}}(t,e):i instanceof Tp?KF(i,e):i instanceof Ip?qF(i,e):function(n,r){const s=WF(n,r),o=YF(s)+YF(n.gt);return tM(s)&&tM(n.gt)?GF(o):jF(n.serializer,o)}(i,e)}function Ij(i,e,t){return i instanceof Tp?KF(i,e):i instanceof Ip?qF(i,e):t}function WF(i,e){return i instanceof Y_?tM(t=e)||function(n){return!!n&&"doubleValue"in n}(t)?e:{integerValue:0}:null;var t}class q_ extends EC{}class Tp extends EC{constructor(e){super(),this.elements=e}}function KF(i,e){const t=ZF(e);for(const n of i.elements)t.some(r=>lu(r,n))||t.push(n);return{arrayValue:{values:t}}}class Ip extends EC{constructor(e){super(),this.elements=e}}function qF(i,e){let t=ZF(e);for(const n of i.elements)t=t.filter(r=>!lu(r,n));return{arrayValue:{values:t}}}class Y_ extends EC{constructor(e,t){super(),this.serializer=e,this.gt=t}}function YF(i){return wr(i.integerValue||i.doubleValue)}function ZF(i){return Zb(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}class iw{constructor(e,t){this.field=e,this.transform=t}}class Sj{constructor(e,t){this.version=e,this.transformResults=t}}class tr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new tr}static exists(e){return new tr(void 0,e)}static updateTime(e){return new tr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xC(i,e){return void 0!==i.updateTime?e.isFoundDocument()&&e.version.isEqual(i.updateTime):void 0===i.exists||i.exists===e.isFoundDocument()}class TC{}function XF(i,e){if(!i.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return i.isNoDocument()?new X_(i.key,tr.none()):new Z_(i.key,i.data,tr.none());{const t=i.data,n=$s.empty();let r=new Hi(br.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);null===o&&s.length>1&&(s=s.popLast(),o=t.field(s)),null===o?n.delete(s):n.set(s,o),r=r.add(s)}return new _d(i.key,n,new ia(r.toArray()),tr.none())}}function Dj(i,e,t){i instanceof Z_?function(n,r,s){const o=n.value.clone(),c=e2(n.fieldTransforms,r,s.transformResults);o.setAll(c),r.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(i,e,t):i instanceof _d?function(n,r,s){if(!xC(n.precondition,r))return void r.convertToUnknownDocument(s.version);const o=e2(n.fieldTransforms,r,s.transformResults),c=r.data;c.setAll(JF(n)),c.setAll(o),r.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(i,e,t):function(n,r,s){r.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function rw(i,e,t,n){return i instanceof Z_?function(r,s,o,c){if(!xC(r.precondition,s))return o;const h=r.value.clone(),m=t2(r.fieldTransforms,c,s);return h.setAll(m),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),null}(i,e,t,n):i instanceof _d?function(r,s,o,c){if(!xC(r.precondition,s))return o;const h=t2(r.fieldTransforms,c,s),m=s.data;return m.setAll(JF(r)),m.setAll(h),s.convertToFoundDocument(s.version,m).setHasLocalMutations(),null===o?null:o.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(g=>g.field))}(i,e,t,n):function(r,s,o){return xC(r.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o}(i,e,t)}function Aj(i,e){let t=null;for(const n of i.fieldTransforms){const r=e.data.field(n.field),s=WF(n.transform,r||null);null!=s&&(null===t&&(t=$s.empty()),t.set(n.field,s))}return t||null}function QF(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!function(t,n){return void 0===t&&void 0===n||!(!t||!n)&&H_(t,n,(r,s)=>function Cj(i,e){return i.field.isEqual(e.field)&&function(t,n){return t instanceof Tp&&n instanceof Tp||t instanceof Ip&&n instanceof Ip?H_(t.elements,n.elements,lu):t instanceof Y_&&n instanceof Y_?lu(t.gt,n.gt):t instanceof q_&&n instanceof q_}(i.transform,e.transform)}(r,s))}(i.fieldTransforms,e.fieldTransforms)&&(0===i.type?i.value.isEqual(e.value):1!==i.type||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class Z_ extends TC{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class _d extends TC{constructor(e,t,n,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function JF(i){const e=new Map;return i.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=i.data.field(t);e.set(t,n)}}),e}function e2(i,e,t){const n=new Map;qt(i.length===t.length);for(let r=0;r<t.length;r++){const s=i[r],o=s.transform,c=e.data.field(s.field);n.set(s.field,Ij(o,c,t[r]))}return n}function t2(i,e,t){const n=new Map;for(const r of i){const s=r.transform,o=t.data.field(r.field);n.set(r.field,Tj(s,o,e))}return n}class X_ extends TC{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class dM extends TC{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class hM{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&Dj(s,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=rw(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=rw(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=HF();return this.mutations.forEach(r=>{const s=e.get(r.key),o=s.overlayedDocument;let c=this.applyToLocalView(o,s.mutatedFields);c=t.has(r.key)?null:c;const h=XF(o,c);null!==h&&n.set(r.key,h),o.isValidDocument()||o.convertToNoDocument(Yt.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),An())}isEqual(e){return this.batchId===e.batchId&&H_(this.mutations,e.mutations,(t,n)=>QF(t,n))&&H_(this.baseMutations,e.baseMutations,(t,n)=>QF(t,n))}}class fM{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){qt(e.mutations.length===n.length);let r=wj;const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,n[o].version);return new fM(e,t,n,r)}}class mM{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Rj{constructor(e,t){this.count=e,this.unchangedNames=t}}var Vr,Qn;function n2(i){switch(i){default:return Ot();case be.CANCELLED:case be.UNKNOWN:case be.DEADLINE_EXCEEDED:case be.RESOURCE_EXHAUSTED:case be.INTERNAL:case be.UNAVAILABLE:case be.UNAUTHENTICATED:return!1;case be.INVALID_ARGUMENT:case be.NOT_FOUND:case be.ALREADY_EXISTS:case be.PERMISSION_DENIED:case be.FAILED_PRECONDITION:case be.ABORTED:case be.OUT_OF_RANGE:case be.UNIMPLEMENTED:case be.DATA_LOSS:return!0}}function r2(i){if(void 0===i)return kr("GRPC error has no .code"),be.UNKNOWN;switch(i){case Vr.OK:return be.OK;case Vr.CANCELLED:return be.CANCELLED;case Vr.UNKNOWN:return be.UNKNOWN;case Vr.DEADLINE_EXCEEDED:return be.DEADLINE_EXCEEDED;case Vr.RESOURCE_EXHAUSTED:return be.RESOURCE_EXHAUSTED;case Vr.INTERNAL:return be.INTERNAL;case Vr.UNAVAILABLE:return be.UNAVAILABLE;case Vr.UNAUTHENTICATED:return be.UNAUTHENTICATED;case Vr.INVALID_ARGUMENT:return be.INVALID_ARGUMENT;case Vr.NOT_FOUND:return be.NOT_FOUND;case Vr.ALREADY_EXISTS:return be.ALREADY_EXISTS;case Vr.PERMISSION_DENIED:return be.PERMISSION_DENIED;case Vr.FAILED_PRECONDITION:return be.FAILED_PRECONDITION;case Vr.ABORTED:return be.ABORTED;case Vr.OUT_OF_RANGE:return be.OUT_OF_RANGE;case Vr.UNIMPLEMENTED:return be.UNIMPLEMENTED;case Vr.DATA_LOSS:return be.DATA_LOSS;default:return Ot()}}(Qn=Vr||(Vr={}))[Qn.OK=0]="OK",Qn[Qn.CANCELLED=1]="CANCELLED",Qn[Qn.UNKNOWN=2]="UNKNOWN",Qn[Qn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qn[Qn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qn[Qn.NOT_FOUND=5]="NOT_FOUND",Qn[Qn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qn[Qn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qn[Qn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qn[Qn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qn[Qn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qn[Qn.ABORTED=10]="ABORTED",Qn[Qn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qn[Qn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qn[Qn.INTERNAL=13]="INTERNAL",Qn[Qn.UNAVAILABLE=14]="UNAVAILABLE",Qn[Qn.DATA_LOSS=15]="DATA_LOSS";class pM{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return IC}static getOrCreateInstance(){return null===IC&&(IC=new pM),IC}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let IC=null;function s2(){return new TextEncoder}const Mj=new V_([4294967295,4294967295],0);function o2(i){const e=s2().encode(i),t=new I4;return t.update(e),new Uint8Array(t.digest())}function a2(i){const e=new DataView(i.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new V_([t,n],0),new V_([r,s],0)]}class gM{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new sw(`Invalid padding: ${t}`);if(n<0)throw new sw(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new sw(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new sw(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=V_.fromNumber(this.It)}Et(e,t,n){let r=e.add(t.multiply(V_.fromNumber(n)));return 1===r.compare(Mj)&&(r=new V_([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Tt).toNumber()}At(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=o2(e),[n,r]=a2(t);for(let s=0;s<this.hashCount;s++){const o=this.Et(n,r,s);if(!this.At(o))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new gM(s,r,t);return n.forEach(c=>o.insert(c)),o}insert(e){if(0===this.It)return;const t=o2(e),[n,r]=a2(t);for(let s=0;s<this.hashCount;s++){const o=this.Et(n,r,s);this.Rt(o)}}Rt(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class sw extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class ow{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,aw.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new ow(Yt.min(),r,new Di(En),ra(),An())}}class aw{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new aw(n,t,An(),An(),An())}}class CC{constructor(e,t,n,r){this.Pt=e,this.removedTargetIds=t,this.key=n,this.bt=r}}class l2{constructor(e,t){this.targetId=e,this.Vt=t}}class c2{constructor(e,t,n=ts.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class u2{constructor(){this.St=0,this.Dt=h2(),this.Ct=ts.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=An(),t=An(),n=An();return this.Dt.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Ot()}}),new aw(this.Ct,this.xt,e,t,n)}Ft(){this.Nt=!1,this.Dt=h2()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class Oj{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=ra(),this.zt=d2(),this.Wt=new Di(En)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{const n=this.Zt(t);switch(e.state){case 0:this.te(t)&&n.$t(e.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(e.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(t);break;case 3:this.te(t)&&(n.Kt(),n.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),n.$t(e.resumeToken));break;default:Ot()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((n,r)=>{this.te(r)&&t(r)})}ne(e){var t;const n=e.targetId,r=e.Vt.count,s=this.se(n);if(s){const o=s.target;if(yC(o))if(0===r){const c=new pt(o.path);this.Yt(n,c,ji.newNoDocument(c,Yt.min()))}else qt(1===r);else{const c=this.ie(n);if(c!==r){const h=this.re(e,c);0!==h&&(this.ee(n),this.Wt=this.Wt.insert(n,2===h?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),null===(t=pM.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(m,g,y){var E,x,S,R,L,G;const Y={localCacheCount:g,existenceFilterCount:y.count},K=y.unchangedNames;return K&&(Y.bloomFilter={applied:0===m,hashCount:null!==(E=K?.hashCount)&&void 0!==E?E:0,bitmapLength:null!==(R=null===(S=null===(x=K?.bits)||void 0===x?void 0:x.bitmap)||void 0===S?void 0:S.length)&&void 0!==R?R:0,padding:null!==(G=null===(L=K?.bits)||void 0===L?void 0:L.padding)&&void 0!==G?G:0}),Y}(h,c,e.Vt))}}}}re(e,t){const{unchangedNames:n,count:r}=e.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:s="",padding:o=0},hashCount:c=0}=n;let h,m;try{h=md(s).toUint8Array()}catch(g){if(g instanceof gF)return yl("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw g}try{m=new gM(h,o,c)}catch(g){return yl(g instanceof sw?"BloomFilter error: ":"Applying bloom filter failed: ",g),1}return 0===m.It?1:r!==t-this.oe(e.targetId,m)?2:0}oe(e,t){const n=this.Gt.getRemoteKeysForTarget(e);let r=0;return n.forEach(s=>{const o=this.Gt.ue(),c=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.vt(c)||(this.Yt(e,s,null),r++)}),r}ce(e){const t=new Map;this.Qt.forEach((s,o)=>{const c=this.se(o);if(c){if(s.current&&yC(c.target)){const h=new pt(c.target.path);null!==this.jt.get(h)||this.ae(o,h)||this.Yt(o,h,ji.newNoDocument(h,e))}s.Mt&&(t.set(o,s.Ot()),s.Ft())}});let n=An();this.zt.forEach((s,o)=>{let c=!0;o.forEachWhile(h=>{const m=this.se(h);return!m||"TargetPurposeLimboResolution"===m.purpose||(c=!1,!1)}),c&&(n=n.add(s))}),this.jt.forEach((s,o)=>o.setReadTime(e));const r=new ow(e,t,this.Wt,this.jt,n);return this.jt=ra(),this.zt=d2(),this.Wt=new Di(En),r}Jt(e,t){if(!this.te(e))return;const n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,n){if(!this.te(e))return;const r=this.Zt(e);this.ae(e,t)?r.Bt(t,1):r.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new u2,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new Hi(En),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||nt("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new u2),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function d2(){return new Di(pt.comparator)}function h2(){return new Di(pt.comparator)}const Pj={asc:"ASCENDING",desc:"DESCENDING"},Lj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Nj={and:"AND",or:"OR"};class Fj{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function _M(i,e){return i.useProto3Json||Wb(e)?e:{value:e}}function Q_(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function f2(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function Bj(i,e){return Q_(i,e.toTimestamp())}function Rr(i){return qt(!!i),Yt.fromTimestamp(function(e){const t=uf(e);return new er(t.seconds,t.nanos)}(i))}function yM(i,e){return(t=i,new Xn(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function m2(i){const e=Xn.fromString(i);return qt(x2(e)),e}function lw(i,e){return yM(i.databaseId,e.path)}function uu(i,e){const t=m2(e);if(t.get(1)!==i.databaseId.projectId)throw new $e(be.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new $e(be.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new pt(g2(t))}function vM(i,e){return yM(i.databaseId,e)}function p2(i){const e=m2(i);return 4===e.length?Xn.emptyPath():g2(e)}function cw(i){return new Xn(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function g2(i){return qt(i.length>4&&"documents"===i.get(4)),i.popFirst(5)}function _2(i,e,t){return{name:lw(i,e),fields:t.value.mapValue.fields}}function y2(i,e,t){const n=uu(i,e.name),r=Rr(e.updateTime),s=e.createTime?Rr(e.createTime):Yt.min(),o=new $s({mapValue:{fields:e.fields}}),c=ji.newFoundDocument(n,r,s,o);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function uw(i,e){let t;if(e instanceof Z_)t={update:_2(i,e.key,e.value)};else if(e instanceof X_)t={delete:lw(i,e.key)};else if(e instanceof _d)t={update:_2(i,e.key,e.data),updateMask:Wj(e.fieldMask)};else{if(!(e instanceof dM))return Ot();t={verify:lw(i,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(r,s){const o=s.transform;if(o instanceof q_)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Tp)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Ip)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Y_)return{fieldPath:s.field.canonicalString(),increment:o.gt};throw Ot()}(0,n))),e.precondition.isNone||(t.currentDocument=function(n,r){return void 0!==r.updateTime?{updateTime:Bj(n,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:Ot()}(i,e.precondition)),t}function bM(i,e){const t=e.currentDocument?function(r){return void 0!==r.updateTime?tr.updateTime(Rr(r.updateTime)):void 0!==r.exists?tr.exists(r.exists):tr.none()}(e.currentDocument):tr.none(),n=e.updateTransforms?e.updateTransforms.map(r=>function(s,o){let c=null;"setToServerValue"in o?(qt("REQUEST_TIME"===o.setToServerValue),c=new q_):"appendMissingElements"in o?c=new Tp(o.appendMissingElements.values||[]):"removeAllFromArray"in o?c=new Ip(o.removeAllFromArray.values||[]):"increment"in o?c=new Y_(s,o.increment):Ot();const h=br.fromServerFormat(o.fieldPath);return new iw(h,c)}(i,r)):[];if(e.update){const r=uu(i,e.update.name),s=new $s({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){return new ia((c.fieldPaths||[]).map(m=>br.fromServerFormat(m)))}(e.updateMask);return new _d(r,s,o,t,n)}return new Z_(r,s,t,n)}if(e.delete){const r=uu(i,e.delete);return new X_(r,t)}if(e.verify){const r=uu(i,e.verify);return new dM(r,t)}return Ot()}function v2(i,e){return{documents:[vM(i,e.path)]}}function wM(i,e){const t={structuredQuery:{}},n=e.path;null!==e.collectionGroup?(t.parent=vM(i,n),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=vM(i,n.popLast()),t.structuredQuery.from=[{collectionId:n.lastSegment()}]);const r=function(h){if(0!==h.length)return E2(fi.create(h,"and"))}(e.filters);r&&(t.structuredQuery.where=r);const s=function(h){if(0!==h.length)return h.map(m=>{return{field:gf((g=m).field),direction:jj(g.dir)};var g})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const o=_M(i,e.limit);var c,h;return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt={before:(c=e.startAt).inclusive,values:c.position}),e.endAt&&(t.structuredQuery.endAt={before:!(h=e.endAt).inclusive,values:h.position}),t}function b2(i){let e=p2(i.parent);const t=i.structuredQuery,n=t.from?t.from.length:0;let r=null;if(n>0){qt(1===n);const g=t.from[0];g.allDescendants?r=g.collectionId:e=e.child(g.collectionId)}let s=[];t.where&&(s=function(g){const y=w2(g);return y instanceof fi&&iM(y)?y.getFilters():[y]}(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(g=>{return new z_(J_((y=g).field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction));var y}));let c=null;t.limit&&(c=function(g){let y;return y="object"==typeof g?g.value:g,Wb(y)?null:y}(t.limit));let h=null;var g;t.startAt&&(h=new pf((g=t.startAt).values||[],!!g.before));let m=null;return t.endAt&&(m=function(g){return new pf(g.values||[],!g.before)}(t.endAt)),LF(e,r,o,s,c,"F",h,m)}function w2(i){return void 0!==i.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=J_(e.unaryFilter.field);return Un.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=J_(e.unaryFilter.field);return Un.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=J_(e.unaryFilter.field);return Un.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=J_(e.unaryFilter.field);return Un.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Ot()}}(i):void 0!==i.fieldFilter?Un.create(J_((e=i).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ot()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==i.compositeFilter?function(e){return fi.create(e.compositeFilter.filters.map(t=>w2(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return Ot()}}(e.compositeFilter.op))}(i):Ot();var e}function jj(i){return Pj[i]}function Gj(i){return Lj[i]}function zj(i){return Nj[i]}function gf(i){return{fieldPath:i.canonicalString()}}function J_(i){return br.fromServerFormat(i.fieldPath)}function E2(i){return i instanceof Un?function(e){if("=="===e.op){if(vF(e.value))return{unaryFilter:{field:gf(e.field),op:"IS_NAN"}};if(yF(e.value))return{unaryFilter:{field:gf(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(vF(e.value))return{unaryFilter:{field:gf(e.field),op:"IS_NOT_NAN"}};if(yF(e.value))return{unaryFilter:{field:gf(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:gf(e.field),op:Gj(e.op),value:e.value}}}(i):i instanceof fi?function(e){const t=e.getFilters().map(n=>E2(n));return 1===t.length?t[0]:{compositeFilter:{op:zj(e.op),filters:t}}}(i):Ot()}function Wj(i){const e=[];return i.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function x2(i){return i.length>=4&&"projects"===i.get(0)&&"databases"===i.get(2)}class yd{constructor(e,t,n,r,s=Yt.min(),o=Yt.min(),c=ts.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=h}withSequenceNumber(e){return new yd(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new yd(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new yd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new yd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class T2{constructor(e){this.fe=e}}function I2(i,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:SC(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(r,s){return{name:lw(r,s.key),fields:s.data.value.mapValue.fields,updateTime:Q_(r,s.version.toTimestamp()),createTime:Q_(r,s.createTime.toTimestamp())}}(i.fe,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:Cp(e.version)};else{if(!e.isUnknownDocument())return Ot();n.unknownDocument={path:t.path.toArray(),version:Cp(e.version)}}return n}function SC(i){const e=i.toTimestamp();return[e.seconds,e.nanoseconds]}function Cp(i){const e=i.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Sp(i){const e=new er(i.seconds,i.nanoseconds);return Yt.fromTimestamp(e)}function Dp(i,e){const t=(e.baseMutations||[]).map(s=>bM(i.fe,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const n=e.mutations.map(s=>bM(i.fe,s)),r=er.fromMillis(e.localWriteTimeMs);return new hM(e.batchId,r,t,n)}function dw(i){const e=Sp(i.readTime),t=void 0!==i.lastLimboFreeSnapshotVersion?Sp(i.lastLimboFreeSnapshotVersion):Yt.min();let n;var r;return void 0!==i.query.documents?(qt(1===(r=i.query).documents.length),n=Ao(K_(p2(r.documents[0])))):n=function(s){return Ao(b2(s))}(i.query),new yd(n,i.targetId,"TargetPurposeListen",i.lastListenSequenceNumber,e,t,ts.fromBase64String(i.resumeToken))}function C2(i,e){const t=Cp(e.snapshotVersion),n=Cp(e.lastLimboFreeSnapshotVersion);let r;r=yC(e.target)?v2(i.fe,e.target):wM(i.fe,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ep(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:r}}function EM(i){const e=b2({parent:i.parent,structuredQuery:i.structuredQuery});return"LAST"===i.limitType?wC(e,e.limit,"L"):e}function xM(i,e){return new mM(e.largestBatchId,bM(i.fe,e.overlayMutation))}function S2(i,e){const t=e.path.lastSegment();return[i,io(e.path.popLast()),t]}function D2(i,e,t,n){return{indexId:i,uid:e.uid||"",sequenceNumber:t,readTime:Cp(n.readTime),documentKey:io(n.documentKey.path),largestBatchId:n.largestBatchId}}class qj{getBundleMetadata(e,t){return A2(e).get(t).next(n=>{if(n)return{id:(r=n).bundleId,createTime:Sp(r.createTime),version:r.version};var r})}saveBundleMetadata(e,t){return A2(e).put({bundleId:(n=t).id,createTime:Cp(Rr(n.createTime)),version:n.version});var n}getNamedQuery(e,t){return k2(e).get(t).next(n=>{if(n)return{name:(r=n).name,query:EM(r.bundledQuery),readTime:Sp(r.readTime)};var r})}saveNamedQuery(e,t){return k2(e).put(function(n){return{name:n.name,readTime:Cp(Rr(n.readTime)),bundledQuery:n.bundledQuery}}(t))}}function A2(i){return ws(i,"bundles")}function k2(i){return ws(i,"namedQueries")}class DC{constructor(e,t){this.serializer=e,this.userId=t}static de(e,t){return new DC(e,t.uid||"")}getOverlay(e,t){return hw(e).get(S2(this.userId,t)).next(n=>n?xM(this.serializer,n):null)}getOverlays(e,t){const n=cu();return ge.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&n.set(r,s)})).next(()=>n)}saveOverlays(e,t,n){const r=[];return n.forEach((s,o)=>{const c=new mM(t,o);r.push(this.we(e,c))}),ge.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach(o=>r.add(io(o.getCollectionPath())));const s=[];return r.forEach(o=>{const c=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);s.push(hw(e).J("collectionPathOverlayIndex",c))}),ge.waitFor(s)}getOverlaysForCollection(e,t,n){const r=cu(),s=io(t),o=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return hw(e).j("collectionPathOverlayIndex",o).next(c=>{for(const h of c){const m=xM(this.serializer,h);r.set(m.getKey(),m)}return r})}getOverlaysForCollectionGroup(e,t,n,r){const s=cu();let o;const c=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return hw(e).X({index:"collectionGroupOverlayIndex",range:c},(h,m,g)=>{const y=xM(this.serializer,m);s.size()<r||y.largestBatchId===o?(s.set(y.getKey(),y),o=y.largestBatchId):g.done()}).next(()=>s)}we(e,t){return hw(e).put(function(n,r,s){const[o,c,h]=S2(r,s.mutation.key);return{userId:r,collectionPath:c,documentId:h,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:uw(n.fe,s.mutation)}}(this.serializer,this.userId,t))}}function hw(i){return ws(i,"documentOverlays")}class Ap{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(wr(e.integerValue));else if("doubleValue"in e){const n=wr(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),Kb(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ye(t,20),"string"==typeof n?t.Ie(n):(t.Ie(`${n.seconds||""}`),t.pe(n.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(md(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ye(t,45),t.pe(n.latitude||0),t.pe(n.longitude||0)}else"mapValue"in e?bF(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):Ot()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const n=e.fields||{};this.ye(t,55);for(const r of Object.keys(n))this.Te(r,t),this.me(n[r],t)}Pe(e,t){const n=e.values||[];this.ye(t,50);for(const r of n)this.me(r,t)}ve(e,t){this.ye(t,37),pt.fromName(e).path.forEach(n=>{this.ye(t,60),this.be(n,t)})}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}function Yj(i){if(0===i)return 8;let e=0;return!(i>>4)&&(e+=4,i<<=4),!(i>>6)&&(e+=2,i<<=2),!(i>>7)&&(e+=1),e}function R2(i){const e=64-function(t){let n=0;for(let r=0;r<8;++r){const s=Yj(255&t[r]);if(n+=s,8!==s)break}return n}(i);return Math.ceil(e/8)}Ap.Ve=new Ap;class Zj{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Se(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.De(n.value),n=t.next();this.Ce()}xe(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ne(n.value),n=t.next();this.ke()}Me(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.De(n);else if(n<2048)this.De(960|n>>>6),this.De(128|63&n);else if(t<"\ud800"||"\udbff"<t)this.De(480|n>>>12),this.De(128|63&n>>>6),this.De(128|63&n);else{const r=t.codePointAt(0);this.De(240|r>>>18),this.De(128|63&r>>>12),this.De(128|63&r>>>6),this.De(128|63&r)}}this.Ce()}$e(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Ne(n);else if(n<2048)this.Ne(960|n>>>6),this.Ne(128|63&n);else if(t<"\ud800"||"\udbff"<t)this.Ne(480|n>>>12),this.Ne(128|63&n>>>6),this.Ne(128|63&n);else{const r=t.codePointAt(0);this.Ne(240|r>>>18),this.Ne(128|63&r>>>12),this.Ne(128|63&r>>>6),this.Ne(128|63&r)}}this.ke()}Oe(e){const t=this.Fe(e),n=R2(t);this.Be(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Le(e){const t=this.Fe(e),n=R2(t);this.Be(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}qe(){this.Ue(255),this.Ue(255)}Ke(){this.Ge(255),this.Ge(255)}reset(){this.position=0}seed(e){this.Be(e.length),this.buffer.set(e,this.position),this.position+=e.length}Qe(){return this.buffer.slice(0,this.position)}Fe(e){const t=function(r){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,r,!1),new Uint8Array(s.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}De(e){const t=255&e;0===t?(this.Ue(0),this.Ue(255)):255===t?(this.Ue(255),this.Ue(0)):this.Ue(t)}Ne(e){const t=255&e;0===t?(this.Ge(0),this.Ge(255)):255===t?(this.Ge(255),this.Ge(0)):this.Ge(e)}Ce(){this.Ue(0),this.Ue(1)}ke(){this.Ge(0),this.Ge(1)}Ue(e){this.Be(1),this.buffer[this.position++]=e}Ge(e){this.Be(1),this.buffer[this.position++]=~e}Be(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class Xj{constructor(e){this.je=e}Ae(e){this.je.Se(e)}Ie(e){this.je.Me(e)}pe(e){this.je.Oe(e)}ge(){this.je.qe()}}class Qj{constructor(e){this.je=e}Ae(e){this.je.xe(e)}Ie(e){this.je.$e(e)}pe(e){this.je.Le(e)}ge(){this.je.Ke()}}class fw{constructor(){this.je=new Zj,this.ze=new Xj(this.je),this.We=new Qj(this.je)}seed(e){this.je.seed(e)}He(e){return 0===e?this.ze:this.We}Qe(){return this.je.Qe()}reset(){this.je.reset()}}class kp{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}Je(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new kp(this.indexId,this.documentKey,this.arrayValue,n)}}function _f(i,e){let t=i.indexId-e.indexId;return 0!==t?t:(t=M2(i.arrayValue,e.arrayValue),0!==t?t:(t=M2(i.directionalValue,e.directionalValue),0!==t?t:pt.comparator(i.documentKey,e.documentKey)))}function M2(i,e){for(let t=0;t<i.length&&t<e.length;++t){const n=i[t]-e[t];if(0!==n)return n}return i.length-e.length}class Jj{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ye=e.orderBy,this.Xe=[];for(const t of e.filters){const n=t;n.isInequality()?this.Ze=n:this.Xe.push(n)}}tn(e){qt(e.collectionGroup===this.collectionId);const t=ZR(e);if(void 0!==t&&!this.en(t))return!1;const n=vp(e);let r=new Set,s=0,o=0;for(;s<n.length&&this.en(n[s]);++s)r=r.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(void 0!==this.Ze){if(!r.has(this.Ze.field.canonicalString())){const c=n[s];if(!this.nn(this.Ze,c)||!this.sn(this.Ye[o++],c))return!1}++s}for(;s<n.length;++s)if(o>=this.Ye.length||!this.sn(this.Ye[o++],n[s]))return!1;return!0}en(e){for(const t of this.Xe)if(this.nn(t,e))return!0;return!1}nn(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function O2(i){var e,t;if(qt(i instanceof Un||i instanceof fi),i instanceof Un){if(i instanceof MF){const r=(null===(t=null===(e=i.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(s=>Un.create(i.field,"==",s)))||[];return fi.create(r,"or")}return i}const n=i.filters.map(r=>O2(r));return fi.create(n,i.op)}function eG(i){if(0===i.getFilters().length)return[];const e=CM(O2(i));return qt(P2(e)),TM(e)||IM(e)?[e]:e.getFilters()}function TM(i){return i instanceof Un}function IM(i){return i instanceof fi&&iM(i)}function P2(i){return TM(i)||IM(i)||function(e){if(e instanceof fi&&nM(e)){for(const t of e.getFilters())if(!TM(t)&&!IM(t))return!1;return!0}return!1}(i)}function CM(i){if(qt(i instanceof Un||i instanceof fi),i instanceof Un)return i;if(1===i.filters.length)return CM(i.filters[0]);const e=i.filters.map(n=>CM(n));let t=fi.create(e,i.op);return t=AC(t),P2(t)?t:(qt(t instanceof fi),qt(W_(t)),qt(t.filters.length>1),t.filters.reduce((n,r)=>SM(n,r)))}function SM(i,e){let t;return qt(i instanceof Un||i instanceof fi),qt(e instanceof Un||e instanceof fi),t=i instanceof Un?e instanceof Un?function(n,r){return fi.create([n,r],"and")}(i,e):L2(i,e):e instanceof Un?L2(e,i):function(n,r){if(qt(n.filters.length>0&&r.filters.length>0),W_(n)&&W_(r))return AF(n,r.getFilters());const s=nM(n)?n:r,o=nM(n)?r:n,c=s.filters.map(h=>SM(h,o));return fi.create(c,"or")}(i,e),AC(t)}function L2(i,e){if(W_(e))return AF(e,i.getFilters());{const t=e.filters.map(n=>SM(i,n));return fi.create(t,"or")}}function AC(i){if(qt(i instanceof Un||i instanceof fi),i instanceof Un)return i;const e=i.getFilters();if(1===e.length)return AC(e[0]);if(SF(i))return i;const t=e.map(r=>AC(r)),n=[];return t.forEach(r=>{r instanceof Un?n.push(r):r instanceof fi&&(r.op===i.op?n.push(...r.filters):n.push(r))}),1===n.length?n[0]:fi.create(n,i.op)}class tG{constructor(){this.rn=new DM}addToCollectionParentIndex(e,t){return this.rn.add(t),ge.resolve()}getCollectionParents(e,t){return ge.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return ge.resolve()}deleteFieldIndex(e,t){return ge.resolve()}getDocumentsMatchingTarget(e,t){return ge.resolve(null)}getIndexType(e,t){return ge.resolve(0)}getFieldIndexes(e,t){return ge.resolve([])}getNextCollectionGroupToUpdate(e){return ge.resolve(null)}getMinOffset(e,t){return ge.resolve(Va.min())}getMinOffsetFromCollectionGroup(e,t){return ge.resolve(Va.min())}updateCollectionGroup(e,t,n){return ge.resolve()}updateIndexEntries(e,t){return ge.resolve()}}class DM{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Hi(Xn.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Hi(Xn.comparator)).toArray()}}const kC=new Uint8Array(0);class nG{constructor(e,t){this.user=e,this.databaseId=t,this.on=new DM,this.un=new gd(n=>Ep(n),(n,r)=>Qb(n,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.on.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.on.add(t)});const s={collectionId:n,parent:io(r)};return N2(e).put(s)}return ge.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[eF(t),""],!1,!0);return N2(e).j(r).next(s=>{for(const o of s){if(o.collectionId!==t)break;n.push(au(o.parent))}return n})}addFieldIndex(e,t){const n=RC(e),r=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete r.indexId;const s=n.add(r);if(t.indexState){const o=pw(e);return s.next(c=>{o.put(D2(c,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const n=RC(e),r=pw(e),s=mw(e);return n.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const n=mw(e);let r=!0;const s=new Map;return ge.forEach(this.cn(t),o=>this.an(e,o).next(c=>{r&&(r=!!c),s.set(o,c)})).next(()=>{if(r){let o=An();const c=[];return ge.forEach(s,(h,m)=>{var g;nt("IndexedDbIndexManager",`Using index ${g=h,`id=${g.indexId}|cg=${g.collectionGroup}|f=${g.fields.map(K=>`${K.fieldPath}:${K.kind}`).join(",")}`} to execute ${Ep(t)}`);const y=function(K,te){const oe=ZR(te);if(void 0===oe)return null;for(const Ae of vC(K,oe.fieldPath))switch(Ae.op){case"array-contains-any":return Ae.value.arrayValue.values||[];case"array-contains":return[Ae.value]}return null}(m,h),E=function(K,te){const oe=new Map;for(const Ae of vp(te))for(const we of vC(K,Ae.fieldPath))switch(we.op){case"==":case"in":oe.set(Ae.fieldPath.canonicalString(),we.value);break;case"not-in":case"!=":return oe.set(Ae.fieldPath.canonicalString(),we.value),Array.from(oe.values())}return null}(m,h),x=function(K,te){const oe=[];let Ae=!0;for(const we of vp(te)){const We=0===we.kind?OF(K,we.fieldPath,K.startAt):PF(K,we.fieldPath,K.startAt);oe.push(We.value),Ae&&(Ae=We.inclusive)}return new pf(oe,Ae)}(m,h),S=function(K,te){const oe=[];let Ae=!0;for(const we of vp(te)){const We=0===we.kind?PF(K,we.fieldPath,K.endAt):OF(K,we.fieldPath,K.endAt);oe.push(We.value),Ae&&(Ae=We.inclusive)}return new pf(oe,Ae)}(m,h),R=this.hn(h,m,x),L=this.hn(h,m,S),G=this.ln(h,m,E),Y=this.fn(h.indexId,y,R,x.inclusive,L,S.inclusive,G);return ge.forEach(Y,K=>n.H(K,t.limit).next(te=>{te.forEach(oe=>{const Ae=pt.fromSegments(oe.documentKey);o.has(Ae)||(o=o.add(Ae),c.push(Ae))})}))}).next(()=>c)}return ge.resolve(null)})}cn(e){let t=this.un.get(e);return t||(t=0===e.filters.length?[e]:eG(fi.create(e.filters,"and")).map(n=>sM(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}fn(e,t,n,r,s,o,c){const h=(null!=t?t.length:1)*Math.max(n.length,s.length),m=h/(null!=t?t.length:1),g=[];for(let y=0;y<h;++y){const E=t?this.dn(t[y/m]):kC,x=this.wn(e,E,n[y%m],r),S=this._n(e,E,s[y%m],o),R=c.map(L=>this.wn(e,E,L,!0));g.push(...this.createRange(x,S,R))}return g}wn(e,t,n,r){const s=new kp(e,pt.empty(),t,n);return r?s:s.Je()}_n(e,t,n,r){const s=new kp(e,pt.empty(),t,n);return r?s.Je():s}an(e,t){const n=new Jj(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(s=>{let o=null;for(const c of s)n.tn(c)&&(!o||c.fields.length>o.fields.length)&&(o=c);return o})}getIndexType(e,t){let n=2;const r=this.cn(t);return ge.forEach(r,s=>this.an(e,s).next(o=>{o?0!==n&&o.fields.length<function(c){let h=new Hi(br.comparator),m=!1;for(const g of c.filters)for(const y of g.getFlattenedFilters())y.field.isKeyField()||("array-contains"===y.op||"array-contains-any"===y.op?m=!0:h=h.add(y.field));for(const g of c.orderBy)g.field.isKeyField()||(h=h.add(g.field));return h.size+(m?1:0)}(s)&&(n=1):n=0})).next(()=>function(s){return null!==s.limit}(t)&&r.length>1&&2===n?1:n)}mn(e,t){const n=new fw;for(const r of vp(e)){const s=t.data.field(r.fieldPath);if(null==s)return null;const o=n.He(r.kind);Ap.Ve._e(s,o)}return n.Qe()}dn(e){const t=new fw;return Ap.Ve._e(e,t.He(0)),t.Qe()}gn(e,t){const n=new fw;return Ap.Ve._e(wp(this.databaseId,t),n.He(function(r){const s=vp(r);return 0===s.length?0:s[s.length-1].kind}(e))),n.Qe()}ln(e,t,n){if(null===n)return[];let r=[];r.push(new fw);let s=0;for(const o of vp(e)){const c=n[s++];for(const h of r)if(this.yn(t,o.fieldPath)&&Zb(c))r=this.pn(r,o,c);else{const m=h.He(o.kind);Ap.Ve._e(c,m)}}return this.In(r)}hn(e,t,n){return this.ln(e,t,n.position)}In(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Qe();return t}pn(e,t,n){const r=[...e],s=[];for(const o of n.arrayValue.values||[])for(const c of r){const h=new fw;h.seed(c.Qe()),Ap.Ve._e(o,h.He(t.kind)),s.push(h)}return s}yn(e,t){return!!e.filters.find(n=>n instanceof Un&&n.field.isEqual(t)&&("in"===n.op||"not-in"===n.op))}getFieldIndexes(e,t){const n=RC(e),r=pw(e);return(t?n.j("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.j()).next(s=>{const o=[];return ge.forEach(s,c=>r.get([c.indexId,this.uid]).next(h=>{o.push(function(m,g){const y=g?new Gb(g.sequenceNumber,new Va(Sp(g.readTime),new pt(au(g.documentKey)),g.largestBatchId)):Gb.empty(),E=m.fields.map(([x,S])=>new cC(br.fromServerFormat(x),S));return new lC(m.indexId,m.collectionGroup,E,y)}(c,h))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((n,r)=>{const s=n.indexState.sequenceNumber-r.indexState.sequenceNumber;return 0!==s?s:En(n.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){const r=RC(e),s=pw(e);return this.Tn(e).next(o=>r.j("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(c=>ge.forEach(c,h=>s.put(D2(h.indexId,this.user,o,n)))))}updateIndexEntries(e,t){const n=new Map;return ge.forEach(t,(r,s)=>{const o=n.get(r.collectionGroup);return(o?ge.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(c=>(n.set(r.collectionGroup,c),ge.forEach(c,h=>this.En(e,r,h).next(m=>{const g=this.An(s,h);return m.isEqual(g)?ge.resolve():this.vn(e,s,h,m,g)}))))})}Rn(e,t,n,r){return mw(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.gn(n,t.key),documentKey:t.key.path.toArray()})}Pn(e,t,n,r){return mw(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.gn(n,t.key),t.key.path.toArray()])}En(e,t,n){const r=mw(e);let s=new Hi(_f);return r.X({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.gn(n,t)])},(o,c)=>{s=s.add(new kp(n.indexId,t,c.arrayValue,c.directionalValue))}).next(()=>s)}An(e,t){let n=new Hi(_f);const r=this.mn(t,e);if(null==r)return n;const s=ZR(t);if(null!=s){const o=e.data.field(s.fieldPath);if(Zb(o))for(const c of o.arrayValue.values||[])n=n.add(new kp(t.indexId,e.key,this.dn(c),r))}else n=n.add(new kp(t.indexId,e.key,kC,r));return n}vn(e,t,n,r,s){nt("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(c,h,m,g,y){const E=c.getIterator(),x=h.getIterator();let S=j_(E),R=j_(x);for(;S||R;){let L=!1,G=!1;if(S&&R){const Y=m(S,R);Y<0?G=!0:Y>0&&(L=!0)}else null!=S?G=!0:L=!0;L?(g(R),R=j_(x)):G?(y(S),S=j_(E)):(S=j_(E),R=j_(x))}}(r,s,_f,c=>{o.push(this.Rn(e,t,n,c))},c=>{o.push(this.Pn(e,t,n,c))}),ge.waitFor(o)}Tn(e){let t=1;return pw(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,r,s)=>{s.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((o,c)=>_f(o,c)).filter((o,c,h)=>!c||0!==_f(o,h[c-1]));const r=[];r.push(e);for(const o of n){const c=_f(o,e),h=_f(o,t);if(0===c)r[0]=e.Je();else if(c>0&&h<0)r.push(o),r.push(o.Je());else if(h>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.bn(r[o],r[o+1]))return[];s.push(IDBKeyRange.bound([r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,kC,[]],[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,kC,[]]))}return s}bn(e,t){return _f(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(F2)}getMinOffset(e,t){return ge.mapArray(this.cn(t),n=>this.an(e,n).next(r=>r||Ot())).next(F2)}}function N2(i){return ws(i,"collectionParents")}function mw(i){return ws(i,"indexEntries")}function RC(i){return ws(i,"indexConfiguration")}function pw(i){return ws(i,"indexState")}function F2(i){qt(0!==i.length);let e=i[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<i.length;n++){const r=i[n].indexState.offset;XR(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Va(e.readTime,e.documentKey,t)}const B2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class ro{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new ro(e,ro.DEFAULT_COLLECTION_PERCENTILE,ro.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function U2(i,e,t){const n=i.store("mutations"),r=i.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId);let c=0;const h=n.X({range:o},(g,y,E)=>(c++,E.delete()));s.push(h.next(()=>{qt(1===c)}));const m=[];for(const g of t.mutations){const y=cF(e,g.key.path,t.batchId);s.push(r.delete(y)),m.push(g.key)}return ge.waitFor(s).next(()=>m)}function MC(i){if(!i)return 0;let e;if(i.document)e=i.document;else if(i.unknownDocument)e=i.unknownDocument;else{if(!i.noDocument)throw Ot();e=i.noDocument}return JSON.stringify(e).length}ro.DEFAULT_COLLECTION_PERCENTILE=10,ro.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ro.DEFAULT=new ro(41943040,ro.DEFAULT_COLLECTION_PERCENTILE,ro.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ro.DISABLED=new ro(-1,0,0);class OC{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Vn={}}static de(e,t,n,r){qt(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new OC(s,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return yf(e).X({index:"userMutationsIndex",range:n},(r,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,n,r){const s=ey(e),o=yf(e);return o.add({}).next(c=>{qt("number"==typeof c);const h=new hM(c,t,n,r),m=function(E,x,S){const R=S.baseMutations.map(G=>uw(E.fe,G)),L=S.mutations.map(G=>uw(E.fe,G));return{userId:x,batchId:S.batchId,localWriteTimeMs:S.localWriteTime.toMillis(),baseMutations:R,mutations:L}}(this.serializer,this.userId,h),g=[];let y=new Hi((E,x)=>En(E.canonicalString(),x.canonicalString()));for(const E of r){const x=cF(this.userId,E.key.path,c);y=y.add(E.key.path.popLast()),g.push(o.put(m)),g.push(s.put(x,j4))}return y.forEach(E=>{g.push(this.indexManager.addToCollectionParentIndex(e,E))}),e.addOnCommittedListener(()=>{this.Vn[c]=h.keys()}),ge.waitFor(g).next(()=>h)})}lookupMutationBatch(e,t){return yf(e).get(t).next(n=>n?(qt(n.userId===this.userId),Dp(this.serializer,n)):null)}Sn(e,t){return this.Vn[t]?ge.resolve(this.Vn[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){const r=n.keys();return this.Vn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return yf(e).X({index:"userMutationsIndex",range:r},(o,c,h)=>{c.userId===this.userId&&(qt(c.batchId>=n),s=Dp(this.serializer,c)),h.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return yf(e).X({index:"userMutationsIndex",range:t,reverse:!0},(r,s,o)=>{n=s.batchId,o.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return yf(e).j("userMutationsIndex",t).next(n=>n.map(r=>Dp(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=dC(this.userId,t.path),r=IDBKeyRange.lowerBound(n),s=[];return ey(e).X({range:r},(o,c,h)=>{const[m,g,y]=o,E=au(g);if(m===this.userId&&t.path.isEqual(E))return yf(e).get(y).next(x=>{if(!x)throw Ot();qt(x.userId===this.userId),s.push(Dp(this.serializer,x))});h.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Hi(En);const r=[];return t.forEach(s=>{const o=dC(this.userId,s.path),c=IDBKeyRange.lowerBound(o),h=ey(e).X({range:c},(m,g,y)=>{const[E,x,S]=m,R=au(x);E===this.userId&&s.path.isEqual(R)?n=n.add(S):y.done()});r.push(h)}),ge.waitFor(r).next(()=>this.Dn(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,s=dC(this.userId,n),o=IDBKeyRange.lowerBound(s);let c=new Hi(En);return ey(e).X({range:o},(h,m,g)=>{const[y,E,x]=h,S=au(E);y===this.userId&&n.isPrefixOf(S)?S.length===r&&(c=c.add(x)):g.done()}).next(()=>this.Dn(e,c))}Dn(e,t){const n=[],r=[];return t.forEach(s=>{r.push(yf(e).get(s).next(o=>{if(null===o)throw Ot();qt(o.userId===this.userId),n.push(Dp(this.serializer,o))}))}),ge.waitFor(r).next(()=>n)}removeMutationBatch(e,t){return U2(e.ht,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.Cn(t.batchId)}),ge.forEach(n,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}Cn(e){delete this.Vn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return ge.resolve();const n=IDBKeyRange.lowerBound([this.userId]),r=[];return ey(e).X({range:n},(s,o,c)=>{if(s[0]===this.userId){const h=au(s[1]);r.push(h)}else c.done()}).next(()=>{qt(0===r.length)})})}containsKey(e,t){return V2(e,this.userId,t)}xn(e){return $2(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function V2(i,e,t){const n=dC(e,t.path),r=n[1],s=IDBKeyRange.lowerBound(n);let o=!1;return ey(i).X({range:s,Y:!0},(c,h,m)=>{const[g,y,E]=c;g===e&&y===r&&(o=!0),m.done()}).next(()=>o)}function yf(i){return ws(i,"mutations")}function ey(i){return ws(i,"documentMutations")}function $2(i){return ws(i,"mutationQueues")}class Rp{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new Rp(0)}static Mn(){return new Rp(-1)}}class iG{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.$n(e).next(t=>{const n=new Rp(t.highestTargetId);return t.highestTargetId=n.next(),this.On(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.$n(e).next(t=>Yt.fromTimestamp(new er(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.$n(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.$n(e).next(r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.On(e,r)))}addTargetData(e,t){return this.Fn(e,t).next(()=>this.$n(e).next(n=>(n.targetCount+=1,this.Bn(t,n),this.On(e,n))))}updateTargetData(e,t){return this.Fn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ty(e).delete(t.targetId)).next(()=>this.$n(e)).next(n=>(qt(n.targetCount>0),n.targetCount-=1,this.On(e,n)))}removeTargets(e,t,n){let r=0;const s=[];return ty(e).X((o,c)=>{const h=dw(c);h.sequenceNumber<=t&&null===n.get(h.targetId)&&(r++,s.push(this.removeTargetData(e,h)))}).next(()=>ge.waitFor(s)).next(()=>r)}forEachTarget(e,t){return ty(e).X((n,r)=>{const s=dw(r);t(s)})}$n(e){return H2(e).get("targetGlobalKey").next(t=>(qt(null!==t),t))}On(e,t){return H2(e).put("targetGlobalKey",t)}Fn(e,t){return ty(e).put(C2(this.serializer,t))}Bn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.$n(e).next(t=>t.targetCount)}getTargetData(e,t){const n=Ep(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return ty(e).X({range:r,index:"queryTargetsIndex"},(o,c,h)=>{const m=dw(c);Qb(t,m.target)&&(s=m,h.done())}).next(()=>s)}addMatchingKeys(e,t,n){const r=[],s=vf(e);return t.forEach(o=>{const c=io(o.path);r.push(s.put({targetId:n,path:c})),r.push(this.referenceDelegate.addReference(e,n,o))}),ge.waitFor(r)}removeMatchingKeys(e,t,n){const r=vf(e);return ge.forEach(t,s=>{const o=io(s.path);return ge.waitFor([r.delete([n,o]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,t){const n=vf(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=vf(e);let s=An();return r.X({range:n,Y:!0},(o,c,h)=>{const m=au(o[1]),g=new pt(m);s=s.add(g)}).next(()=>s)}containsKey(e,t){const n=io(t.path),r=IDBKeyRange.bound([n],[eF(n)],!1,!0);let s=0;return vf(e).X({index:"documentTargetsIndex",Y:!0,range:r},([o,c],h,m)=>{0!==o&&(s++,m.done())}).next(()=>s>0)}le(e,t){return ty(e).get(t).next(n=>n?dw(n):null)}}function ty(i){return ws(i,"targets")}function H2(i){return ws(i,"targetGlobal")}function vf(i){return ws(i,"targetDocuments")}function j2([i,e],[t,n]){const r=En(i,t);return 0===r?En(e,n):r}class rG{constructor(e){this.Ln=e,this.buffer=new Hi(j2),this.qn=0}Un(){return++this.qn}Kn(e){const t=[e,this.Un()];if(this.buffer.size<this.Ln)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();j2(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class G2{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Gn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Qn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return null!==this.Gn}Qn(e){var t=this;nt("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,Ie.Z)(function*(){t.Gn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(n){lf(n)?nt("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield af(n)}yield t.Qn(3e5)}))}}class sG{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.zn(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(0===t)return ge.resolve($a.ct);const n=new rG(t);return this.jn.forEachTarget(e,r=>n.Kn(r.sequenceNumber)).next(()=>this.jn.Wn(e,r=>n.Kn(r))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(nt("LruGarbageCollector","Garbage collection skipped; disabled"),ge.resolve(B2)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(nt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),B2):this.Hn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Hn(e,t){let n,r,s,o,c,h,m;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(nt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),r=this.params.maximumSequenceNumbersToCollect):r=y,o=Date.now(),this.nthSequenceNumber(e,r))).next(y=>(n=y,c=Date.now(),this.removeTargets(e,n,t))).next(y=>(s=y,h=Date.now(),this.removeOrphanedDocuments(e,n))).next(y=>(m=Date.now(),qR()<=Ra.in.DEBUG&&nt("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-g}ms\n\tDetermined least recently used ${r} in `+(c-o)+`ms\n\tRemoved ${s} targets in `+(h-c)+`ms\n\tRemoved ${y} documents in `+(m-h)+`ms\nTotal Duration: ${m-g}ms`),ge.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:y})))}}class oG{constructor(e,t){this.db=e,this.garbageCollector=function z2(i,e){return new sG(i,e)}(this,t)}zn(e){const t=this.Jn(e);return this.db.getTargetCache().getTargetCount(e).next(n=>t.next(r=>n+r))}Jn(e){let t=0;return this.Wn(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Wn(e,t){return this.Yn(e,(n,r)=>t(r))}addReference(e,t,n){return PC(e,n)}removeReference(e,t,n){return PC(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return PC(e,t)}Xn(e,t){return function(n,r){let s=!1;return $2(n).Z(o=>V2(n,o,r).next(c=>(c&&(s=!0),ge.resolve(!c)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Yn(e,(o,c)=>{if(c<=t){const h=this.Xn(e,o).next(m=>{if(!m)return s++,n.getEntry(e,o).next(()=>(n.removeEntry(o,Yt.min()),vf(e).delete([0,io(o.path)])))});r.push(h)}}).next(()=>ge.waitFor(r)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return PC(e,t)}Yn(e,t){const n=vf(e);let r,s=$a.ct;return n.X({index:"documentTargetsIndex"},([o,c],{path:h,sequenceNumber:m})=>{0===o?(s!==$a.ct&&t(new pt(au(r)),s),s=m,r=h):s=$a.ct}).next(()=>{s!==$a.ct&&t(new pt(au(r)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function PC(i,e){return vf(i).put(function(t,n){return{targetId:0,path:io(t.path),sequenceNumber:n}}(e,i.currentSequenceNumber))}class W2{constructor(){this.changes=new gd(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ji.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?ge.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class aG{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Mp(e).put(n)}removeEntry(e,t,n){return Mp(e).delete(function(r,s){const o=r.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],SC(s),o[o.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.Zn(e,n)))}getEntry(e,t){let n=ji.newInvalidDocument(t);return Mp(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(gw(t))},(r,s)=>{n=this.ts(t,s)}).next(()=>n)}es(e,t){let n={size:0,document:ji.newInvalidDocument(t)};return Mp(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(gw(t))},(r,s)=>{n={document:this.ts(t,s),size:MC(s)}}).next(()=>n)}getEntries(e,t){let n=ra();return this.ns(e,t,(r,s)=>{const o=this.ts(r,s);n=n.insert(r,o)}).next(()=>n)}ss(e,t){let n=ra(),r=new Di(pt.comparator);return this.ns(e,t,(s,o)=>{const c=this.ts(s,o);n=n.insert(s,c),r=r.insert(s,MC(o))}).next(()=>({documents:n,rs:r}))}ns(e,t,n){if(t.isEmpty())return ge.resolve();let r=new Hi(Z2);t.forEach(h=>r=r.add(h));const s=IDBKeyRange.bound(gw(r.first()),gw(r.last())),o=r.getIterator();let c=o.getNext();return Mp(e).X({index:"documentKeyIndex",range:s},(h,m,g)=>{const y=pt.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;c&&Z2(c,y)<0;)n(c,null),c=o.getNext();c&&c.isEqual(y)&&(n(c,m),c=o.hasNext()?o.getNext():null),c?g.G(gw(c)):g.done()}).next(()=>{for(;c;)n(c,null),c=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,n,r){const s=t.path,o=[s.popLast().toArray(),s.lastSegment(),SC(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Mp(e).j(IDBKeyRange.bound(o,c,!0)).next(h=>{let m=ra();for(const g of h){const y=this.ts(pt.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);y.isFoundDocument()&&(ew(t,y)||r.has(y.key))&&(m=m.insert(y.key,y))}return m})}getAllFromCollectionGroup(e,t,n,r){let s=ra();const o=Y2(t,n),c=Y2(t,Va.max());return Mp(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,c,!0)},(h,m,g)=>{const y=this.ts(pt.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);s=s.insert(y.key,y),s.size===r&&g.done()}).next(()=>s)}newChangeBuffer(e){return new lG(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return q2(e).get("remoteDocumentGlobalKey").next(t=>(qt(!!t),t))}Zn(e,t){return q2(e).put("remoteDocumentGlobalKey",t)}ts(e,t){if(t){const n=function Kj(i,e){let t;if(e.document)t=y2(i.fe,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=pt.fromSegments(e.noDocument.path),r=Sp(e.noDocument.readTime);t=ji.newNoDocument(n,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ot();{const n=pt.fromSegments(e.unknownDocument.path),r=Sp(e.unknownDocument.version);t=ji.newUnknownDocument(n,r)}}return e.readTime&&t.setReadTime(function(n){const r=new er(n[0],n[1]);return Yt.fromTimestamp(r)}(e.readTime)),t}(this.serializer,t);if(!n.isNoDocument()||!n.version.isEqual(Yt.min()))return n}return ji.newInvalidDocument(e)}}function K2(i){return new aG(i)}class lG extends W2{constructor(e,t){super(),this.os=e,this.trackRemovals=t,this.us=new gd(n=>n.toString(),(n,r)=>n.isEqual(r))}applyChanges(e){const t=[];let n=0,r=new Hi((s,o)=>En(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const c=this.us.get(s);if(t.push(this.os.removeEntry(e,s,c.readTime)),o.isValidDocument()){const h=I2(this.os.serializer,o);r=r.add(s.path.popLast());const m=MC(h);n+=m-c.size,t.push(this.os.addEntry(e,s,h))}else if(n-=c.size,this.trackRemovals){const h=I2(this.os.serializer,o.convertToNoDocument(Yt.min()));t.push(this.os.addEntry(e,s,h))}}),r.forEach(s=>{t.push(this.os.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.os.updateMetadata(e,n)),ge.waitFor(t)}getFromCache(e,t){return this.os.es(e,t).next(n=>(this.us.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.os.ss(e,t).next(({documents:n,rs:r})=>(r.forEach((s,o)=>{this.us.set(s,{size:o,readTime:n.get(s).readTime})}),n))}}function q2(i){return ws(i,"remoteDocumentGlobal")}function Mp(i){return ws(i,"remoteDocumentsV14")}function gw(i){const e=i.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Y2(i,e){const t=e.documentKey.path.toArray();return[i,SC(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Z2(i,e){const t=i.path.toArray(),n=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<n.length-2;++s)if(r=En(t[s],n[s]),r)return r;return r=En(t.length,n.length),r||(r=En(t[t.length-2],n[n.length-2]),r||En(t[t.length-1],n[n.length-1]))}class cG{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class X2{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(null!==n&&rw(n.mutation,r,ia.empty(),er.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,An()).next(()=>n))}getLocalViewOfDocuments(e,t,n=An()){const r=cu();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(s=>{let o=tw();return s.forEach((c,h)=>{o=o.insert(c,h.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=cu();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,An()))}populateOverlays(e,t,n){const r=[];return n.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,c)=>{t.set(o,c)})})}computeViews(e,t,n,r){let s=ra();const o=nw(),c=nw();return t.forEach((h,m)=>{const g=n.get(m.key);r.has(m.key)&&(void 0===g||g.mutation instanceof _d)?s=s.insert(m.key,m):void 0!==g?(o.set(m.key,g.mutation.getFieldMask()),rw(g.mutation,m,g.mutation.getFieldMask(),er.now())):o.set(m.key,ia.empty())}),this.recalculateAndSaveOverlays(e,s).next(h=>(h.forEach((m,g)=>o.set(m,g)),t.forEach((m,g)=>{var y;return c.set(m,new cG(g,null!==(y=o.get(m))&&void 0!==y?y:null))}),c))}recalculateAndSaveOverlays(e,t){const n=nw();let r=new Di((o,c)=>o-c),s=An();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const c of o)c.keys().forEach(h=>{const m=t.get(h);if(null===m)return;let g=n.get(h)||ia.empty();g=c.applyToLocalView(m,g),n.set(h,g);const y=(r.get(c.batchId)||An()).add(h);r=r.insert(c.batchId,y)})}).next(()=>{const o=[],c=r.getReverseIterator();for(;c.hasNext();){const h=c.getNext(),m=h.key,g=h.value,y=HF();g.forEach(E=>{if(!s.has(E)){const x=XF(t.get(E),n.get(E));null!==x&&y.set(E,x),s=s.add(E)}}),o.push(this.documentOverlayCache.saveOverlays(e,m,y))}return ge.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n){return function(r){return pt.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):aM(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):ge.resolve(cu());let c=-1,h=s;return o.next(m=>ge.forEach(m,(g,y)=>(c<y.largestBatchId&&(c=y.largestBatchId),s.get(g)?ge.resolve():this.remoteDocumentCache.getEntry(e,g).next(E=>{h=h.insert(g,E)}))).next(()=>this.populateOverlays(e,m,s)).next(()=>this.computeViews(e,h,m,An())).next(g=>({batchId:c,changes:$F(g)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new pt(t)).next(n=>{let r=tw();return n.isFoundDocument()&&(r=r.insert(n.key,n)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,n){const r=t.collectionGroup;let s=tw();return this.indexManager.getCollectionParents(e,r).next(o=>ge.forEach(o,c=>{const h=(m=t,g=c.child(r),new pd(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt));var m,g;return this.getDocumentsMatchingCollectionQuery(e,h,n).next(m=>{m.forEach((g,y)=>{s=s.insert(g,y)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(r=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r))).next(s=>{r.forEach((c,h)=>{const m=h.getKey();null===s.get(m)&&(s=s.insert(m,ji.newInvalidDocument(m)))});let o=tw();return s.forEach((c,h)=>{const m=r.get(c);void 0!==m&&rw(m.mutation,h,ia.empty(),er.now()),ew(t,h)&&(o=o.insert(c,h))}),o})}}class uG{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return ge.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:Rr(n.createTime)}),ge.resolve()}getNamedQuery(e,t){return ge.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,function(n){return{name:n.name,query:EM(n.bundledQuery),readTime:Rr(n.readTime)}}(t)),ge.resolve()}}class dG{constructor(){this.overlays=new Di(pt.comparator),this.ls=new Map}getOverlay(e,t){return ge.resolve(this.overlays.get(t))}getOverlays(e,t){const n=cu();return ge.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&n.set(r,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((r,s)=>{this.we(e,t,s)}),ge.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.ls.get(n);return void 0!==r&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.ls.delete(n)),ge.resolve()}getOverlaysForCollection(e,t,n){const r=cu(),s=t.length+1,o=new pt(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const h=c.getNext().value,m=h.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===s&&h.largestBatchId>n&&r.set(h.getKey(),h)}return ge.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new Di((m,g)=>m-g);const o=this.overlays.getIterator();for(;o.hasNext();){const m=o.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>n){let g=s.get(m.largestBatchId);null===g&&(g=cu(),s=s.insert(m.largestBatchId,g)),g.set(m.getKey(),m)}}const c=cu(),h=s.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((m,g)=>c.set(m,g)),!(c.size()>=r)););return ge.resolve(c)}we(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const o=this.ls.get(r.largestBatchId).delete(n.key);this.ls.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new mM(t,n));let s=this.ls.get(t);void 0===s&&(s=An(),this.ls.set(t,s)),this.ls.set(t,s.add(n.key))}}class AM{constructor(){this.fs=new Hi(Es.ds),this.ws=new Hi(Es._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const n=new Es(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.ys(new Es(e,t))}ps(e,t){e.forEach(n=>this.removeReference(n,t))}Is(e){const t=new pt(new Xn([])),n=new Es(t,e),r=new Es(t,e+1),s=[];return this.ws.forEachInRange([n,r],o=>{this.ys(o),s.push(o.key)}),s}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new pt(new Xn([])),n=new Es(t,e),r=new Es(t,e+1);let s=An();return this.ws.forEachInRange([n,r],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new Es(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Es{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return pt.comparator(e.key,t.key)||En(e.As,t.As)}static _s(e,t){return En(e.As,t.As)||pt.comparator(e.key,t.key)}}class hG{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new Hi(Es.ds)}checkEmpty(e){return ge.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const s=this.vs;this.vs++;const o=new hM(s,t,n,r);this.mutationQueue.push(o);for(const c of r)this.Rs=this.Rs.add(new Es(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return ge.resolve(o)}lookupMutationBatch(e,t){return ge.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const r=this.bs(t+1),s=r<0?0:r;return ge.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ge.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return ge.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Es(t,0),r=new Es(t,Number.POSITIVE_INFINITY),s=[];return this.Rs.forEachInRange([n,r],o=>{const c=this.Ps(o.As);s.push(c)}),ge.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Hi(En);return t.forEach(r=>{const s=new Es(r,0),o=new Es(r,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([s,o],c=>{n=n.add(c.As)})}),ge.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let s=n;pt.isDocumentKey(s)||(s=s.child(""));const o=new Es(new pt(s),0);let c=new Hi(En);return this.Rs.forEachWhile(h=>{const m=h.key.path;return!!n.isPrefixOf(m)&&(m.length===r&&(c=c.add(h.As)),!0)},o),ge.resolve(this.Vs(c))}Vs(e){const t=[];return e.forEach(n=>{const r=this.Ps(n);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){qt(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return ge.forEach(t.mutations,r=>{const s=new Es(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Rs=n})}Cn(e){}containsKey(e,t){const n=new Es(t,0),r=this.Rs.firstAfterOrEqual(n);return ge.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return ge.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class fG{constructor(e){this.Ds=e,this.docs=new Di(pt.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),s=r?r.size:0,o=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ge.resolve(n?n.document.mutableCopy():ji.newInvalidDocument(t))}getEntries(e,t){let n=ra();return t.forEach(r=>{const s=this.docs.get(r);n=n.insert(r,s?s.document.mutableCopy():ji.newInvalidDocument(r))}),ge.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let s=ra();const o=t.path,c=new pt(o.child("")),h=this.docs.getIteratorFrom(c);for(;h.hasNext();){const{key:m,value:{document:g}}=h.getNext();if(!o.isPrefixOf(m.path))break;m.path.length>o.length+1||XR(nF(g),n)<=0||(r.has(g.key)||ew(t,g))&&(s=s.insert(g.key,g.mutableCopy()))}return ge.resolve(s)}getAllFromCollectionGroup(e,t,n,r){Ot()}Cs(e,t){return ge.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new mG(this)}getSize(e){return ge.resolve(this.size)}}class mG extends W2{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.os.addEntry(e,r)):this.os.removeEntry(n)}),ge.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}class pG{constructor(e){this.persistence=e,this.xs=new gd(t=>Ep(t),Qb),this.lastRemoteSnapshotVersion=Yt.min(),this.highestTargetId=0,this.Ns=0,this.ks=new AM,this.targetCount=0,this.Ms=Rp.kn()}forEachTarget(e,t){return this.xs.forEach((n,r)=>t(r)),ge.resolve()}getLastRemoteSnapshotVersion(e){return ge.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ge.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),ge.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),ge.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new Rp(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,ge.resolve()}updateTargetData(e,t){return this.Fn(t),ge.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,ge.resolve()}removeTargets(e,t,n){let r=0;const s=[];return this.xs.forEach((o,c)=>{c.sequenceNumber<=t&&null===n.get(c.targetId)&&(this.xs.delete(o),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),r++)}),ge.waitFor(s).next(()=>r)}getTargetCount(e){return ge.resolve(this.targetCount)}getTargetData(e,t){const n=this.xs.get(t)||null;return ge.resolve(n)}addMatchingKeys(e,t,n){return this.ks.gs(t,n),ge.resolve()}removeMatchingKeys(e,t,n){this.ks.ps(t,n);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),ge.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),ge.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ks.Es(t);return ge.resolve(n)}containsKey(e,t){return ge.resolve(this.ks.containsKey(t))}}class kM{constructor(e,t){this.$s={},this.overlays={},this.Os=new $a(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new pG(this),this.indexManager=new tG,this.remoteDocumentCache=function(n){return new fG(n)}(n=>this.referenceDelegate.Ls(n)),this.serializer=new T2(t),this.qs=new uG(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new dG,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.$s[e.toKey()];return n||(n=new hG(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,n){nt("MemoryPersistence","Starting transaction:",e);const r=new gG(this.Os.next());return this.referenceDelegate.Us(),n(r).next(s=>this.referenceDelegate.Ks(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Gs(e,t){return ge.or(Object.values(this.$s).map(n=>()=>n.containsKey(e,t)))}}class gG extends rF{constructor(e){super(),this.currentSequenceNumber=e}}class LC{constructor(e){this.persistence=e,this.Qs=new AM,this.js=null}static zs(e){return new LC(e)}get Ws(){if(this.js)return this.js;throw Ot()}addReference(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),ge.resolve()}removeReference(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),ge.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),ge.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(r=>this.Ws.add(r.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.Ws.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ge.forEach(this.Ws,n=>{const r=pt.fromPath(n);return this.Hs(e,r).next(s=>{s||t.removeEntry(r,Yt.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(n=>{n?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return ge.or([()=>ge.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}class _G{constructor(e){this.serializer=e}O(e,t,n,r){const s=new uC("createOrUpgrade",t);n<1&&r>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",lF,{unique:!0}),c.createObjectStore("documentMutations")}(e),Q2(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=ge.resolve();return n<3&&r>=3&&(0!==n&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),Q2(e)),o=o.next(()=>function(c){const h=c.store("targetGlobal"),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Yt.min().toTimestamp(),targetCount:0};return h.put("targetGlobalKey",m)}(s))),n<4&&r>=4&&(0!==n&&(o=o.next(()=>function(c,h){return h.store("mutations").j().next(m=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",lF,{unique:!0});const g=h.store("mutations"),y=m.map(E=>g.put(E));return ge.waitFor(y)})}(e,s))),o=o.next(()=>{!function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),n<5&&r>=5&&(o=o.next(()=>this.Ys(s))),n<6&&r>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.Xs(s)))),n<7&&r>=7&&(o=o.next(()=>this.Zs(s))),n<8&&r>=8&&(o=o.next(()=>this.ti(e,s))),n<9&&r>=9&&(o=o.next(()=>{!function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")}(e)})),n<10&&r>=10&&(o=o.next(()=>this.ei(s))),n<11&&r>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&r>=12&&(o=o.next(()=>{!function(c){const h=c.createObjectStore("documentOverlays",{keyPath:tj});h.createIndex("collectionPathOverlayIndex",nj,{unique:!1}),h.createIndex("collectionGroupOverlayIndex",ij,{unique:!1})}(e)})),n<13&&r>=13&&(o=o.next(()=>function(c){const h=c.createObjectStore("remoteDocumentsV14",{keyPath:G4});h.createIndex("documentKeyIndex",z4),h.createIndex("collectionGroupIndex",W4)}(e)).next(()=>this.ni(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&r>=14&&(o=o.next(()=>this.si(e,s))),n<15&&r>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:X4}).createIndex("sequenceNumberIndex",Q4,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:J4}).createIndex("documentKeyIndex",ej,{unique:!1})}(e))),o}Xs(e){let t=0;return e.store("remoteDocuments").X((n,r)=>{t+=MC(r)}).next(()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}Ys(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.j().next(r=>ge.forEach(r,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return n.j("userMutationsIndex",o).next(c=>ge.forEach(c,h=>{qt(h.userId===s.userId);const m=Dp(this.serializer,h);return U2(e,s.userId,m).next(()=>{})}))}))}Zs(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const s=[];return n.X((o,c)=>{const h=new Xn(o),m=[0,io(h)];s.push(t.get(m).next(g=>g?ge.resolve():t.put({targetId:0,path:io(h),sequenceNumber:r.highestListenSequenceNumber})))}).next(()=>ge.waitFor(s))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:Z4});const n=t.store("collectionParents"),r=new DM,s=o=>{if(r.add(o)){const c=o.lastSegment(),h=o.popLast();return n.put({collectionId:c,parent:io(h)})}};return t.store("remoteDocuments").X({Y:!0},(o,c)=>{const h=new Xn(o);return s(h.popLast())}).next(()=>t.store("documentMutations").X({Y:!0},([o,c,h],m)=>{const g=au(c);return s(g.popLast())}))}ei(e){const t=e.store("targets");return t.X((n,r)=>{const s=dw(r),o=C2(this.serializer,s);return t.put(o)})}ni(e,t){const n=t.store("remoteDocuments"),r=[];return n.X((s,o)=>{const c=t.store("remoteDocumentsV14"),h=(m=o,m.document?new pt(Xn.fromString(m.document.name).popFirst(5)):m.noDocument?pt.fromSegments(m.noDocument.path):m.unknownDocument?pt.fromSegments(m.unknownDocument.path):Ot()).path.toArray();var m;const g={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(c.put(g))}).next(()=>ge.waitFor(r))}si(e,t){const n=t.store("mutations"),r=K2(this.serializer),s=new kM(LC.zs,this.serializer.fe);return n.j().next(o=>{const c=new Map;return o.forEach(h=>{var m;let g=null!==(m=c.get(h.userId))&&void 0!==m?m:An();Dp(this.serializer,h).keys().forEach(y=>g=g.add(y)),c.set(h.userId,g)}),ge.forEach(c,(h,m)=>{const g=new bs(m),y=DC.de(this.serializer,g),E=s.getIndexManager(g),x=OC.de(g,this.serializer,E,s.referenceDelegate);return new X2(r,x,y,E).recalculateAndSaveOverlaysForDocumentKeys(new JR(t,$a.ct),h).next()})})}}function Q2(i){i.createObjectStore("targetDocuments",{keyPath:q4}).createIndex("documentTargetsIndex",Y4,{unique:!0}),i.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",K4,{unique:!0}),i.createObjectStore("targetGlobal")}const RM="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class MM{constructor(e,t,n,r,s,o,c,h,m,g,y=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.ii=s,this.window=o,this.document=c,this.ri=m,this.oi=g,this.ui=y,this.Os=null,this.Fs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.ai=null,this.hi=null,this.li=Number.NEGATIVE_INFINITY,this.fi=E=>Promise.resolve(),!MM.D())throw new $e(be.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new oG(this,r),this.di=t+"main",this.serializer=new T2(h),this.wi=new lc(this.di,this.ui,new _G(this.serializer)),this.Bs=new iG(this.referenceDelegate,this.serializer),this.remoteDocumentCache=K2(this.serializer),this.qs=new qj,this.window&&this.window.localStorage?this._i=this.window.localStorage:(this._i=null,!1===g&&kr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new $e(be.FAILED_PRECONDITION,RM);return this.gi(),this.yi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Bs.getHighestSequenceNumber(e))}).then(e=>{this.Os=new $a(e,this.ri)}).then(()=>{this.Fs=!0}).catch(e=>(this.wi&&this.wi.close(),Promise.reject(e)))}Ii(e){var n,t=this;return this.fi=function(r){return(n=n||(0,Ie.Z)(function*(s){if(t.started)return e(s)})).apply(this,arguments)},e(this.isPrimary)}setDatabaseDeletedListener(e){var t;this.wi.B(function(n){return(t=t||(0,Ie.Z)(function*(r){null===r.newVersion&&(yield e())})).apply(this,arguments)})}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.ii.enqueueAndForget((0,Ie.Z)(function*(){t.started&&(yield t.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>FC(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ti(e).next(t=>{t||(this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)))})}).next(()=>this.Ei(e)).next(t=>this.isPrimary&&!t?this.Ai(e).next(()=>!1):!!t&&this.vi(e).next(()=>!0))).catch(e=>{if(lf(e))return nt("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return nt("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ii.enqueueRetryable(()=>this.fi(e)),this.isPrimary=e})}Ti(e){return _w(e).get("owner").next(t=>ge.resolve(this.Ri(t)))}Pi(e){return FC(e).delete(this.clientId)}bi(){var e=this;return(0,Ie.Z)(function*(){if(e.isPrimary&&!e.Vi(e.li,18e5)){e.li=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=ws(n,"clientMetadata");return r.j().next(s=>{const o=e.Si(s,18e5),c=s.filter(h=>-1===o.indexOf(h));return ge.forEach(c,h=>r.delete(h.clientId)).next(()=>c)})}).catch(()=>[]);if(e._i)for(const n of t)e._i.removeItem(e.Di(n.clientId))}})()}pi(){this.hi=this.ii.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.bi()).then(()=>this.pi()))}Ri(e){return!!e&&e.ownerId===this.clientId}Ei(e){return this.oi?ge.resolve(!0):_w(e).get("owner").next(t=>{if(null!==t&&this.Vi(t.leaseTimestampMs,5e3)&&!this.Ci(t.ownerId)){if(this.Ri(t)&&this.networkEnabled)return!0;if(!this.Ri(t)){if(!t.allowTabSynchronization)throw new $e(be.FAILED_PRECONDITION,RM);return!1}}return!(!this.networkEnabled||!this.inForeground)||FC(e).j().next(n=>void 0===this.Si(n,5e3).find(r=>!(this.clientId===r.clientId||!(!this.networkEnabled&&r.networkEnabled||!this.inForeground&&r.inForeground&&this.networkEnabled===r.networkEnabled))))}).next(t=>(this.isPrimary!==t&&nt("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,Ie.Z)(function*(){e.Fs=!1,e.xi(),e.hi&&(e.hi.cancel(),e.hi=null),e.Ni(),e.ki(),yield e.wi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const n=new JR(t,$a.ct);return e.Ai(n).next(()=>e.Pi(n))}),e.wi.close(),e.Mi()})()}Si(e,t){return e.filter(n=>this.Vi(n.updateTimeMs,t)&&!this.Ci(n.clientId))}$i(){return this.runTransaction("getActiveClients","readonly",e=>FC(e).j().next(t=>this.Si(t,18e5).map(n=>n.clientId)))}get started(){return this.Fs}getMutationQueue(e,t){return OC.de(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new nG(e,this.serializer.fe.databaseId)}getDocumentOverlayCache(e){return DC.de(this.serializer,e)}getBundleCache(){return this.qs}runTransaction(e,t,n){nt("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",s=15===(o=this.ui)?sj:14===o?hF:13===o?dF:12===o?rj:11===o?uF:void Ot();var o;let c;return this.wi.runTransaction(e,r,s,h=>(c=new JR(h,this.Os?this.Os.next():$a.ct),"readwrite-primary"===t?this.Ti(c).next(m=>!!m||this.Ei(c)).next(m=>{if(!m)throw kr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)),new $e(be.FAILED_PRECONDITION,iF);return n(c)}).next(m=>this.vi(c).next(()=>m)):this.Oi(c).next(()=>n(c)))).then(h=>(c.raiseOnCommittedEvent(),h))}Oi(e){return _w(e).get("owner").next(t=>{if(null!==t&&this.Vi(t.leaseTimestampMs,5e3)&&!this.Ci(t.ownerId)&&!this.Ri(t)&&!(this.oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new $e(be.FAILED_PRECONDITION,RM)})}vi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return _w(e).put("owner",t)}static D(){return lc.D()}Ai(e){const t=_w(e);return t.get("owner").next(n=>this.Ri(n)?(nt("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):ge.resolve())}Vi(e,t){const n=Date.now();return!(e<n-t||e>n&&(kr(`Detected an update time that is in the future: ${e} > ${n}`),1))}gi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ai=()=>{this.ii.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.mi()))},this.document.addEventListener("visibilitychange",this.ai),this.inForeground="visible"===this.document.visibilityState)}Ni(){this.ai&&(this.document.removeEventListener("visibilitychange",this.ai),this.ai=null)}yi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ci=()=>{this.xi();const t=/(?:Version|Mobile)\/1[456]/;(0,bn.G6)()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ii.enterRestrictedMode(!0),this.ii.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}ki(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Ci(e){var t;try{const n=null!==(null===(t=this._i)||void 0===t?void 0:t.getItem(this.Di(e)));return nt("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return kr("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}xi(){if(this._i)try{this._i.setItem(this.Di(this.clientId),String(Date.now()))}catch(e){kr("Failed to set zombie client id.",e)}}Mi(){if(this._i)try{this._i.removeItem(this.Di(this.clientId))}catch{}}Di(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function _w(i){return ws(i,"owner")}function FC(i){return ws(i,"clientMetadata")}function OM(i,e){let t=i.projectId;return i.isDefaultDatabase||(t+="."+i.database),"firestore/"+e+"/"+t+"/"}class PM{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Fi=n,this.Bi=r}static Li(e,t){let n=An(),r=An();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new PM(e,t.fromCache,n,r)}}class J2{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,n,r){return this.Ki(e,t).next(s=>s||this.Gi(e,t,r,n)).next(s=>s||this.Qi(e,t))}Ki(e,t){if(NF(t))return ge.resolve(null);let n=Ao(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=wC(t,null,"F"),n=Ao(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=An(...s);return this.Ui.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,n).next(h=>{const m=this.ji(t,c);return this.zi(t,m,o,h.readTime)?this.Ki(e,wC(t,null,"F")):this.Wi(e,m,t,h)}))})))}Gi(e,t,n,r){return NF(t)||r.isEqual(Yt.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next(s=>{const o=this.ji(t,s);return this.zi(t,o,n,r)?this.Qi(e,t):(qR()<=Ra.in.DEBUG&&nt("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),cM(t)),this.Wi(e,o,t,tF(r,-1)))})}ji(e,t){let n=new Hi(UF(e));return t.forEach((r,s)=>{ew(e,s)&&(n=n.add(s))}),n}zi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Qi(e,t){return qR()<=Ra.in.DEBUG&&nt("QueryEngine","Using full collection scan to execute query:",cM(t)),this.Ui.getDocumentsMatchingQuery(e,t,Va.min())}Wi(e,t,n,r){return this.Ui.getDocumentsMatchingQuery(e,n,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}class yG{constructor(e,t,n,r){this.persistence=e,this.Hi=t,this.serializer=r,this.Ji=new Di(En),this.Yi=new gd(s=>Ep(s),Qb),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new X2(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}}function eB(i,e,t,n){return new yG(i,e,t,n)}function tB(i,e){return(aN=aN||(0,Ie.Z)(function*(t,n){const r=yt(t);return yield r.persistence.runTransaction("Handle user change","readonly",s=>{let o;return r.mutationQueue.getAllMutationBatches(s).next(c=>(o=c,r.tr(n),r.mutationQueue.getAllMutationBatches(s))).next(c=>{const h=[],m=[];let g=An();for(const y of o){h.push(y.batchId);for(const E of y.mutations)g=g.add(E.key)}for(const y of c){m.push(y.batchId);for(const E of y.mutations)g=g.add(E.key)}return r.localDocuments.getDocuments(s,g).next(y=>({er:y,removedBatchIds:h,addedBatchIds:m}))})})})).apply(this,arguments)}function nB(i){const e=yt(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Bs.getLastRemoteSnapshotVersion(t))}function iB(i,e,t){let n=An(),r=An();return t.forEach(s=>n=n.add(s)),e.getEntries(i,n).next(s=>{let o=ra();return t.forEach((c,h)=>{const m=s.get(c);h.isFoundDocument()!==m.isFoundDocument()&&(r=r.add(c)),h.isNoDocument()&&h.version.isEqual(Yt.min())?(e.removeEntry(c,h.readTime),o=o.insert(c,h)):!m.isValidDocument()||h.version.compareTo(m.version)>0||0===h.version.compareTo(m.version)&&m.hasPendingWrites?(e.addEntry(h),o=o.insert(c,h)):nt("LocalStore","Ignoring outdated watch update for ",c,". Current version:",m.version," Watch version:",h.version)}),{nr:o,sr:r}})}function wG(i,e){const t=yt(i);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function ny(i,e){const t=yt(i);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let r;return t.Bs.getTargetData(n,e).next(s=>s?(r=s,ge.resolve(r)):t.Bs.allocateTargetId(n).next(o=>(r=new yd(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Bs.addTargetData(n,r).next(()=>r))))}).then(n=>{const r=t.Ji.get(n.targetId);return(null===r||n.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ji=t.Ji.insert(n.targetId,n),t.Yi.set(e,n.targetId)),n})}function iy(i,e,t){return(lN=lN||(0,Ie.Z)(function*(n,r,s){const o=yt(n),c=o.Ji.get(r),h=s?"readwrite":"readwrite-primary";try{s||(yield o.persistence.runTransaction("Release target",h,m=>o.persistence.referenceDelegate.removeTarget(m,c)))}catch(m){if(!lf(m))throw m;nt("LocalStore",`Failed to update sequence numbers for target ${r}: ${m}`)}o.Ji=o.Ji.remove(r),o.Yi.delete(c.target)})).apply(this,arguments)}function BC(i,e,t){const n=yt(i);let r=Yt.min(),s=An();return n.persistence.runTransaction("Execute query","readonly",o=>function(c,h,m){const g=yt(c),y=g.Yi.get(m);return void 0!==y?ge.resolve(g.Ji.get(y)):g.Bs.getTargetData(h,m)}(n,o,Ao(e)).next(c=>{if(c)return r=c.lastLimboFreeSnapshotVersion,n.Bs.getMatchingKeysForTargetId(o,c.targetId).next(h=>{s=h})}).next(()=>n.Hi.getDocumentsMatchingQuery(o,e,t?r:Yt.min(),t?s:An())).next(c=>(oB(n,BF(e),c),{documents:c,ir:s})))}function rB(i,e){const t=yt(i),n=yt(t.Bs),r=t.Ji.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",s=>n.le(s,e).next(o=>o?o.target:null))}function sB(i,e){const t=yt(i),n=t.Xi.get(e)||Yt.min();return t.persistence.runTransaction("Get new document changes","readonly",r=>t.Zi.getAllFromCollectionGroup(r,e,tF(n,-1),Number.MAX_SAFE_INTEGER)).then(r=>(oB(t,e,r),r))}function oB(i,e,t){let n=i.Xi.get(e)||Yt.min();t.forEach((r,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),i.Xi.set(e,n)}function xG(i,e){return(uN=uN||(0,Ie.Z)(function*(t,n,r=An()){const s=yield ny(t,Ao(EM(n.bundledQuery))),o=yt(t);return o.persistence.runTransaction("Save named query","readwrite",c=>{const h=Rr(n.readTime);if(s.snapshotVersion.compareTo(h)>=0)return o.qs.saveNamedQuery(c,n);const m=s.withResumeToken(ts.EMPTY_BYTE_STRING,h);return o.Ji=o.Ji.insert(m.targetId,m),o.Bs.updateTargetData(c,m).next(()=>o.Bs.removeMatchingKeysForTargetId(c,s.targetId)).next(()=>o.Bs.addMatchingKeys(c,r,s.targetId)).next(()=>o.qs.saveNamedQuery(c,n))})})).apply(this,arguments)}function aB(i,e){return`firestore_clients_${i}_${e}`}function lB(i,e,t){let n=`firestore_mutations_${i}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}function LM(i,e){return`firestore_targets_${i}_${e}`}class UC{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static ar(e,t,n){const r=JSON.parse(n);let s,o="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return o&&r.error&&(o="string"==typeof r.error.message&&"string"==typeof r.error.code,o&&(s=new $e(r.error.code,r.error.message))),o?new UC(e,t,r.state,s):(kr("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class yw{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static ar(e,t){const n=JSON.parse(t);let r,s="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return s&&n.error&&(s="string"==typeof n.error.message&&"string"==typeof n.error.code,s&&(r=new $e(n.error.code,n.error.message))),s?new yw(e,n.state,r):(kr("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class VC{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static ar(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,s=uM();for(let o=0;r&&o<n.activeTargetIds.length;++o)r=oF(n.activeTargetIds[o]),s=s.add(n.activeTargetIds[o]);return r?new VC(e,s):(kr("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class NM{constructor(e,t){this.clientId=e,this.onlineState=t}static ar(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new NM(t.clientId,t.onlineState):(kr("SharedClientState",`Failed to parse online state: ${e}`),null)}}class FM{constructor(){this.activeTargetIds=uM()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class BM{constructor(e,t,n,r,s){this.window=e,this.ii=t,this.persistenceKey=n,this.wr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this._r=this.mr.bind(this),this.gr=new Di(En),this.started=!1,this.yr=[];const o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.pr=aB(this.persistenceKey,this.wr),this.Ir=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.gr=this.gr.insert(this.wr,new FM),this.Tr=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Er=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ar=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vr=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Rr=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this._r)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,Ie.Z)(function*(){const t=yield e.syncEngine.$i();for(const r of t){if(r===e.wr)continue;const s=e.getItem(aB(e.persistenceKey,r));if(s){const o=VC.ar(r,s);o&&(e.gr=e.gr.insert(o.clientId,o))}}e.Pr();const n=e.storage.getItem(e.vr);if(n){const r=e.br(n);r&&e.Vr(r)}for(const r of e.yr)e.mr(r);e.yr=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.Ir,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Sr(this.gr)}isActiveQueryTarget(e){let t=!1;return this.gr.forEach((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Dr(e,"pending")}updateMutationState(e,t,n){this.Dr(e,t,n),this.Cr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(LM(this.persistenceKey,e));if(n){const r=yw.ar(e,n);r&&(t=r.state)}}return this.Nr.lr(e),this.Pr(),t}removeLocalQueryTarget(e){this.Nr.dr(e),this.Pr()}isLocalQueryTarget(e){return this.Nr.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(LM(this.persistenceKey,e))}updateQueryState(e,t,n){this.kr(e,t,n)}handleUserChange(e,t,n){t.forEach(r=>{this.Cr(r)}),this.currentUser=e,n.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.Mr(e)}notifyBundleLoaded(e){this.$r(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this._r),this.removeItem(this.pr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return nt("SharedClientState","READ",e,t),t}setItem(e,t){nt("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){nt("SharedClientState","REMOVE",e),this.storage.removeItem(e)}mr(e){var t=this;const n=e;if(n.storageArea===this.storage){if(nt("SharedClientState","EVENT",n.key,n.newValue),n.key===this.pr)return void kr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ii.enqueueRetryable((0,Ie.Z)(function*(){if(t.started){if(null!==n.key)if(t.Tr.test(n.key)){if(null==n.newValue){const r=t.Or(n.key);return t.Fr(r,null)}{const r=t.Br(n.key,n.newValue);if(r)return t.Fr(r.clientId,r)}}else if(t.Er.test(n.key)){if(null!==n.newValue){const r=t.Lr(n.key,n.newValue);if(r)return t.qr(r)}}else if(t.Ar.test(n.key)){if(null!==n.newValue){const r=t.Ur(n.key,n.newValue);if(r)return t.Kr(r)}}else if(n.key===t.vr){if(null!==n.newValue){const r=t.br(n.newValue);if(r)return t.Vr(r)}}else if(n.key===t.Ir){const r=function(s){let o=$a.ct;if(null!=s)try{const c=JSON.parse(s);qt("number"==typeof c),o=c}catch(c){kr("SharedClientState","Failed to read sequence number from WebStorage",c)}return o}(n.newValue);r!==$a.ct&&t.sequenceNumberHandler(r)}else if(n.key===t.Rr){const r=t.Gr(n.newValue);yield Promise.all(r.map(s=>t.syncEngine.Qr(s)))}}else t.yr.push(n)}))}}get Nr(){return this.gr.get(this.wr)}Pr(){this.setItem(this.pr,this.Nr.hr())}Dr(e,t,n){const r=new UC(this.currentUser,e,t,n),s=lB(this.persistenceKey,this.currentUser,e);this.setItem(s,r.hr())}Cr(e){const t=lB(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Mr(e){this.storage.setItem(this.vr,JSON.stringify({clientId:this.wr,onlineState:e}))}kr(e,t,n){const r=LM(this.persistenceKey,e),s=new yw(e,t,n);this.setItem(r,s.hr())}$r(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Rr,t)}Or(e){const t=this.Tr.exec(e);return t?t[1]:null}Br(e,t){const n=this.Or(e);return VC.ar(n,t)}Lr(e,t){const n=this.Er.exec(e),r=Number(n[1]);return UC.ar(new bs(void 0!==n[2]?n[2]:null),r,t)}Ur(e,t){const n=this.Ar.exec(e),r=Number(n[1]);return yw.ar(r,t)}br(e){return NM.ar(e)}Gr(e){return JSON.parse(e)}qr(e){var t=this;return(0,Ie.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.jr(e.batchId,e.state,e.error);nt("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Kr(e){return this.syncEngine.zr(e.targetId,e.state,e.error)}Fr(e,t){const n=t?this.gr.insert(e,t):this.gr.remove(e),r=this.Sr(this.gr),s=this.Sr(n),o=[],c=[];return s.forEach(h=>{r.has(h)||o.push(h)}),r.forEach(h=>{s.has(h)||c.push(h)}),this.syncEngine.Wr(o,c).then(()=>{this.gr=n})}Vr(e){this.gr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Sr(e){let t=uM();return e.forEach((n,r)=>{t=t.unionWith(r.activeTargetIds)}),t}}class cB{constructor(){this.Hr=new FM,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,n){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new FM,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class TG{Yr(e){}shutdown(){}}class uB{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){nt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){nt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let $C=null;function UM(){return null===$C?$C=268435456+Math.round(2147483648*Math.random()):$C++,"0x"+$C.toString(16)}const IG={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class CG{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}const so="WebChannelConnection";class SG extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.mo=(e.ssl?"https":"http")+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,n,r,s){const o=UM(),c=this.To(e,t);nt("RestConnection",`Sending RPC '${e}' ${o}:`,c,n);const h={};return this.Eo(h,r,s),this.Ao(e,c,h,n).then(m=>(nt("RestConnection",`Received RPC '${e}' ${o}: `,m),m),m=>{throw yl("RestConnection",`RPC '${e}' ${o} failed with error: `,m,"url: ",c,"request:",n),m})}vo(e,t,n,r,s,o){return this.Io(e,t,n,r,s)}Eo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+$_,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,s)=>e[s]=r),n&&n.headers.forEach((r,s)=>e[s]=r)}To(e,t){return`${this.mo}/v1/${t}:${IG[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,n,r){const s=UM();return new Promise((o,c)=>{const h=new T4;h.setWithCredentials(!0),h.listenOnce(w4.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case KR.NO_ERROR:const g=h.getResponseJson();nt(so,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(g)),o(g);break;case KR.TIMEOUT:nt(so,`RPC '${e}' ${s} timed out`),c(new $e(be.DEADLINE_EXCEEDED,"Request time out"));break;case KR.HTTP_ERROR:const y=h.getStatus();if(nt(so,`RPC '${e}' ${s} failed with status:`,y,"response text:",h.getResponseText()),y>0){let E=h.getResponseJson();Array.isArray(E)&&(E=E[0]);const x=E?.error;if(x&&x.status&&x.message){const S=function(R){const L=R.toLowerCase().replace(/_/g,"-");return Object.values(be).indexOf(L)>=0?L:be.UNKNOWN}(x.status);c(new $e(S,x.message))}else c(new $e(be.UNKNOWN,"Server responded with status "+h.getStatus()))}else c(new $e(be.UNAVAILABLE,"Connection failed."));break;default:Ot()}}finally{nt(so,`RPC '${e}' ${s} completed.`)}});const m=JSON.stringify(r);nt(so,`RPC '${e}' ${s} sending request:`,r),h.send(t,"POST",m,n,15)})}Ro(e,t,n){const r=UM(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=v4(),c=b4(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;void 0!==m&&(h.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(h.xmlHttpFactory=new x4({})),this.Eo(h.initMessageHeaders,t,n),h.encodeInitMessageHeaders=!0;const g=s.join("");nt(so,`Creating RPC '${e}' stream ${r}: ${g}`,h);const y=o.createWebChannel(g,h);let E=!1,x=!1;const S=new CG({ro:L=>{x?nt(so,`Not sending because RPC '${e}' stream ${r} is closed:`,L):(E||(nt(so,`Opening RPC '${e}' stream ${r} transport.`),y.open(),E=!0),nt(so,`RPC '${e}' stream ${r} sending:`,L),y.send(L))},oo:()=>y.close()}),R=(L,G,Y)=>{L.listen(G,K=>{try{Y(K)}catch(te){setTimeout(()=>{throw te},0)}})};return R(y,aC.EventType.OPEN,()=>{x||nt(so,`RPC '${e}' stream ${r} transport opened.`)}),R(y,aC.EventType.CLOSE,()=>{x||(x=!0,nt(so,`RPC '${e}' stream ${r} transport closed`),S.wo())}),R(y,aC.EventType.ERROR,L=>{x||(x=!0,yl(so,`RPC '${e}' stream ${r} transport errored:`,L),S.wo(new $e(be.UNAVAILABLE,"The operation could not be completed")))}),R(y,aC.EventType.MESSAGE,L=>{var G;if(!x){const Y=L.data[0];qt(!!Y);const te=Y.error||(null===(G=Y[0])||void 0===G?void 0:G.error);if(te){nt(so,`RPC '${e}' stream ${r} received error:`,te);const oe=te.status;let Ae=function(We){const ot=Vr[We];if(void 0!==ot)return r2(ot)}(oe),we=te.message;void 0===Ae&&(Ae=be.INTERNAL,we="Unknown error status: "+oe+" with message "+te.message),x=!0,S.wo(new $e(Ae,we)),y.close()}else nt(so,`RPC '${e}' stream ${r} received:`,Y),S._o(Y)}}),R(c,E4.STAT_EVENT,L=>{L.stat===sN.PROXY?nt(so,`RPC '${e}' stream ${r} detected buffering proxy`):L.stat===sN.NOPROXY&&nt(so,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{S.fo()},0),S}}function dB(){return typeof window<"u"?window:null}function HC(){return typeof document<"u"?document:null}function vw(i){return new Fj(i,!0)}class VM{constructor(e,t,n=1e3,r=1.5,s=6e4){this.ii=e,this.timerId=t,this.Po=n,this.bo=r,this.Vo=s,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),r=Math.max(0,t-n);r>0&&nt("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,r,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class hB{constructor(e,t,n,r,s,o,c,h){this.ii=e,this.$o=n,this.Oo=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=h,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new VM(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}stop(){var e=this;return(0,Ie.Z)(function*(){e.Uo()&&(yield e.close(0))})()}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}zo(){var e=this;return(0,Ie.Z)(function*(){if(e.Ko())return e.close(0)})()}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}close(e,t){var n=this;return(0,Ie.Z)(function*(){n.Ho(),n.Jo(),n.qo.cancel(),n.Fo++,4!==e?n.qo.reset():t&&t.code===be.RESOURCE_EXHAUSTED?(kr(t.toString()),kr("Using maximum backoff delay to prevent overloading the backend."),n.qo.xo()):t&&t.code===be.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Yo(),n.stream.close(),n.stream=null),n.state=e,yield n.listener.ao(t)})()}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,r])=>{this.Fo===t&&this.Zo(n,r)},n=>{e(()=>{const r=new $e(be.UNKNOWN,"Fetching auth token failed: "+n.message);return this.tu(r)})})}Zo(e,t){const n=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{n(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(r=>{n(()=>this.tu(r))}),this.stream.onMessage(r=>{n(()=>this.onMessage(r))})}Go(){var e=this;this.state=5,this.qo.No((0,Ie.Z)(function*(){e.state=0,e.start()}))}tu(e){return nt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(nt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class DG extends hB{constructor(e,t,n,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,o),this.serializer=s}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function Vj(i,e){let t;if("targetChange"in e){const n="NO_CHANGE"===(h=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===h?1:"REMOVE"===h?2:"CURRENT"===h?3:"RESET"===h?4:Ot(),r=e.targetChange.targetIds||[],s=function(h,m){return h.useProto3Json?(qt(void 0===m||"string"==typeof m),ts.fromBase64String(m||"")):(qt(void 0===m||m instanceof Uint8Array),ts.fromUint8Array(m||new Uint8Array))}(i,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(h){const m=void 0===h.code?be.UNKNOWN:r2(h.code);return new $e(m,h.message||"")}(o);t=new c2(n,r,s,c||null)}else if("documentChange"in e){const n=e.documentChange,r=uu(i,n.document.name),s=Rr(n.document.updateTime),o=n.document.createTime?Rr(n.document.createTime):Yt.min(),c=new $s({mapValue:{fields:n.document.fields}}),h=ji.newFoundDocument(r,s,o,c);t=new CC(n.targetIds||[],n.removedTargetIds||[],h.key,h)}else if("documentDelete"in e){const n=e.documentDelete,r=uu(i,n.document),s=n.readTime?Rr(n.readTime):Yt.min(),o=ji.newNoDocument(r,s);t=new CC([],n.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const n=e.documentRemove,r=uu(i,n.document);t=new CC([],n.removedTargetIds||[],r,null)}else{if(!("filter"in e))return Ot();{const n=e.filter,{count:r=0,unchangedNames:s}=n,o=new Rj(r,s);t=new l2(n.targetId,o)}}var h;return t}(this.serializer,e),n=function(r){if(!("targetChange"in r))return Yt.min();const s=r.targetChange;return s.targetIds&&s.targetIds.length?Yt.min():s.readTime?Rr(s.readTime):Yt.min()}(e);return this.listener.nu(t,n)}su(e){const t={};t.database=cw(this.serializer),t.addTarget=function(r,s){let o;const c=s.target;if(o=yC(c)?{documents:v2(r,c)}:{query:wM(r,c)},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){o.resumeToken=f2(r,s.resumeToken);const h=_M(r,s.expectedCount);null!==h&&(o.expectedCount=h)}else if(s.snapshotVersion.compareTo(Yt.min())>0){o.readTime=Q_(r,s.snapshotVersion.toTimestamp());const h=_M(r,s.expectedCount);null!==h&&(o.expectedCount=h)}return o}(this.serializer,e);const n=function Hj(i,e){const t=function(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ot()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);n&&(t.labels=n),this.Wo(t)}iu(e){const t={};t.database=cw(this.serializer),t.removeTarget=e,this.Wo(t)}}class AG extends hB{constructor(e,t,n,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,o),this.serializer=s,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(qt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function $j(i,e){return i&&i.length>0?(qt(void 0!==e),i.map(t=>function(n,r){let s=Rr(n.updateTime?n.updateTime:r);return s.isEqual(Yt.min())&&(s=Rr(r)),new Sj(s,n.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),n=Rr(e.commitTime);return this.listener.cu(n,t)}return qt(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=cw(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>uw(this.serializer,n))};this.Wo(t)}}class kG extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.lu=!1}fu(){if(this.lu)throw new $e(be.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.connection.Io(e,t,n,r,s)).catch(r=>{throw"FirebaseError"===r.name?(r.code===be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new $e(be.UNKNOWN,r.toString())})}vo(e,t,n,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.vo(e,t,n,s,o,r)).catch(s=>{throw"FirebaseError"===s.name?(s.code===be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new $e(be.UNKNOWN,s.toString())})}terminate(){this.lu=!0}}class MG{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(kr(t),this.mu=!1):nt("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class OG{constructor(e,t,n,r,s){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=s,this.Pu.Yr(c=>{n.enqueueAndForget((0,Ie.Z)(function*(){var h;bf(o)&&(nt("RemoteStore","Restarting streams for network reachability change."),yield function(m){return(h=h||(0,Ie.Z)(function*(g){const y=yt(g);y.vu.add(4),yield ry(y),y.bu.set("Unknown"),y.vu.delete(4),yield bw(y)})).apply(this,arguments)}(o))}))}),this.bu=new MG(n,r)}}function bw(i){return(hN=hN||(0,Ie.Z)(function*(e){if(bf(e))for(const t of e.Ru)yield t(!0)})).apply(this,arguments)}function ry(i){return(fN=fN||(0,Ie.Z)(function*(e){for(const t of e.Ru)yield t(!1)})).apply(this,arguments)}function jC(i,e){const t=yt(i);t.Au.has(e.targetId)||(t.Au.set(e.targetId,e),jM(t)?HM(t):oy(t).Ko()&&$M(t,e))}function ww(i,e){const t=yt(i),n=oy(t);t.Au.delete(e),n.Ko()&&fB(t,e),0===t.Au.size&&(n.Ko()?n.jo():bf(t)&&t.bu.set("Unknown"))}function $M(i,e){if(i.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Yt.min())>0){const t=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}oy(i).su(e)}function fB(i,e){i.Vu.qt(e),oy(i).iu(e)}function HM(i){i.Vu=new Oj({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),le:e=>i.Au.get(e)||null,ue:()=>i.datastore.serializer.databaseId}),oy(i).start(),i.bu.gu()}function jM(i){return bf(i)&&!oy(i).Uo()&&i.Au.size>0}function bf(i){return 0===yt(i).vu.size}function mB(i){i.Vu=void 0}function PG(i){return(mN=mN||(0,Ie.Z)(function*(e){e.Au.forEach((t,n)=>{$M(e,t)})})).apply(this,arguments)}function LG(i,e){return(pN=pN||(0,Ie.Z)(function*(t,n){mB(t),jM(t)?(t.bu.Iu(n),HM(t)):t.bu.set("Unknown")})).apply(this,arguments)}function NG(i,e,t){return(gN=gN||(0,Ie.Z)(function*(n,r,s){if(n.bu.set("Online"),r instanceof c2&&2===r.state&&r.cause)try{var o;yield function(c,h){return(o=o||(0,Ie.Z)(function*(m,g){const y=g.cause;for(const E of g.targetIds)m.Au.has(E)&&(yield m.remoteSyncer.rejectListen(E,y),m.Au.delete(E),m.Vu.removeTarget(E))})).apply(this,arguments)}(n,r)}catch(c){nt("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),c),yield GC(n,c)}else if(r instanceof CC?n.Vu.Ht(r):r instanceof l2?n.Vu.ne(r):n.Vu.Xt(r),!s.isEqual(Yt.min()))try{const c=yield nB(n.localStore);s.compareTo(c)>=0&&(yield function(h,m){const g=h.Vu.ce(m);return g.targetChanges.forEach((y,E)=>{if(y.resumeToken.approximateByteSize()>0){const x=h.Au.get(E);x&&h.Au.set(E,x.withResumeToken(y.resumeToken,m))}}),g.targetMismatches.forEach((y,E)=>{const x=h.Au.get(y);if(!x)return;h.Au.set(y,x.withResumeToken(ts.EMPTY_BYTE_STRING,x.snapshotVersion)),fB(h,y);const S=new yd(x.target,y,E,x.sequenceNumber);$M(h,S)}),h.remoteSyncer.applyRemoteEvent(g)}(n,s))}catch(c){nt("RemoteStore","Failed to raise snapshot:",c),yield GC(n,c)}})).apply(this,arguments)}function GC(i,e,t){return(_N=_N||(0,Ie.Z)(function*(n,r,s){if(!lf(r))throw r;n.vu.add(1),yield ry(n),n.bu.set("Offline"),s||(s=()=>nB(n.localStore)),n.asyncQueue.enqueueRetryable((0,Ie.Z)(function*(){nt("RemoteStore","Retrying IndexedDB access"),yield s(),n.vu.delete(1),yield bw(n)}))})).apply(this,arguments)}function pB(i,e){return e().catch(t=>GC(i,t,e))}function sy(i){return(yN=yN||(0,Ie.Z)(function*(e){const t=yt(e),n=wf(t);let r=t.Eu.length>0?t.Eu[t.Eu.length-1].batchId:-1;for(;FG(t);)try{const s=yield wG(t.localStore,r);if(null===s){0===t.Eu.length&&n.jo();break}r=s.batchId,BG(t,s)}catch(s){yield GC(t,s)}gB(t)&&_B(t)})).apply(this,arguments)}function FG(i){return bf(i)&&i.Eu.length<10}function BG(i,e){i.Eu.push(e);const t=wf(i);t.Ko()&&t.ou&&t.uu(e.mutations)}function gB(i){return bf(i)&&!wf(i).Uo()&&i.Eu.length>0}function _B(i){wf(i).start()}function UG(i){return(vN=vN||(0,Ie.Z)(function*(e){wf(e).hu()})).apply(this,arguments)}function VG(i){return(bN=bN||(0,Ie.Z)(function*(e){const t=wf(e);for(const n of e.Eu)t.uu(n.mutations)})).apply(this,arguments)}function $G(i,e,t){return(wN=wN||(0,Ie.Z)(function*(n,r,s){const o=n.Eu.shift(),c=fM.from(o,r,s);yield pB(n,()=>n.remoteSyncer.applySuccessfulWrite(c)),yield sy(n)})).apply(this,arguments)}function HG(i,e){return(EN=EN||(0,Ie.Z)(function*(t,n){var r;n&&wf(t).ou&&(yield function(s,o){return(r=r||(0,Ie.Z)(function*(c,h){if(n2(m=h.code)&&m!==be.ABORTED){const g=c.Eu.shift();wf(c).Qo(),yield pB(c,()=>c.remoteSyncer.rejectFailedWrite(g.batchId,h)),yield sy(c)}var m})).apply(this,arguments)}(t,n)),gB(t)&&_B(t)})).apply(this,arguments)}function yB(i,e){return(xN=xN||(0,Ie.Z)(function*(t,n){const r=yt(t);r.asyncQueue.verifyOperationInProgress(),nt("RemoteStore","RemoteStore received new credentials");const s=bf(r);r.vu.add(3),yield ry(r),s&&r.bu.set("Unknown"),yield r.remoteSyncer.handleCredentialChange(n),r.vu.delete(3),yield bw(r)})).apply(this,arguments)}function GM(i,e){return(TN=TN||(0,Ie.Z)(function*(t,n){const r=yt(t);n?(r.vu.delete(2),yield bw(r)):n||(r.vu.add(2),yield ry(r),r.bu.set("Unknown"))})).apply(this,arguments)}function oy(i){var e;return i.Su||(i.Su=function(t,n,r){const s=yt(t);return s.fu(),new DG(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(i.datastore,i.asyncQueue,{uo:PG.bind(null,i),ao:LG.bind(null,i),nu:NG.bind(null,i)}),i.Ru.push(function(t){return(e=e||(0,Ie.Z)(function*(n){n?(i.Su.Qo(),jM(i)?HM(i):i.bu.set("Unknown")):(yield i.Su.stop(),mB(i))})).apply(this,arguments)})),i.Su}function wf(i){var e;return i.Du||(i.Du=function(t,n,r){const s=yt(t);return s.fu(),new AG(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(i.datastore,i.asyncQueue,{uo:UG.bind(null,i),ao:HG.bind(null,i),au:VG.bind(null,i),cu:$G.bind(null,i)}),i.Ru.push(function(t){return(e=e||(0,Ie.Z)(function*(n){n?(i.Du.Qo(),yield sy(i)):(yield i.Du.stop(),i.Eu.length>0&&(nt("RemoteStore",`Stopping write stream with ${i.Eu.length} pending writes`),i.Eu=[]))})).apply(this,arguments)})),i.Du}class zM{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new es,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,t,n,r,s){const o=Date.now()+n,c=new zM(e,t,o,r,s);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new $e(be.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ay(i,e){if(kr("AsyncQueue",`${e}: ${i}`),lf(i))return new $e(be.UNAVAILABLE,`${e}: ${i}`);throw i}class ly{constructor(e){this.comparator=e?(t,n)=>e(t,n)||pt.comparator(t.key,n.key):(t,n)=>pt.comparator(t.key,n.key),this.keyedMap=tw(),this.sortedSet=new Di(this.comparator)}static emptySet(e){return new ly(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ly)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=n.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new ly;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class vB{constructor(){this.Cu=new Di(pt.comparator)}track(e){const t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):Ot():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal((t,n)=>{e.push(n)}),e}}class cy{constructor(e,t,n,r,s,o,c,h,m){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=h,this.hasCachedResults=m}static fromInitialDocuments(e,t,n,r,s){const o=[];return t.forEach(c=>{o.push({type:0,doc:c})}),new cy(e,t,ly.emptySet(t),o,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Jb(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class jG{constructor(){this.Nu=void 0,this.listeners=[]}}class GG{constructor(){this.queries=new gd(e=>FF(e),Jb),this.onlineState="Unknown",this.ku=new Set}}function WM(i,e){return(IN=IN||(0,Ie.Z)(function*(t,n){const r=yt(t),s=n.query;let o=!1,c=r.queries.get(s);if(c||(o=!0,c=new jG),o)try{c.Nu=yield r.onListen(s)}catch(h){const m=ay(h,`Initialization of query '${cM(n.query)}' failed`);return void n.onError(m)}r.queries.set(s,c),c.listeners.push(n),n.Mu(r.onlineState),c.Nu&&n.$u(c.Nu)&&qM(r)})).apply(this,arguments)}function KM(i,e){return(CN=CN||(0,Ie.Z)(function*(t,n){const r=yt(t),s=n.query;let o=!1;const c=r.queries.get(s);if(c){const h=c.listeners.indexOf(n);h>=0&&(c.listeners.splice(h,1),o=0===c.listeners.length)}if(o)return r.queries.delete(s),r.onUnlisten(s)})).apply(this,arguments)}function zG(i,e){const t=yt(i);let n=!1;for(const r of e){const o=t.queries.get(r.query);if(o){for(const c of o.listeners)c.$u(r)&&(n=!0);o.Nu=r}}n&&qM(t)}function WG(i,e,t){const n=yt(i),r=n.queries.get(e);if(r)for(const s of r.listeners)s.onError(t);n.queries.delete(e)}function qM(i){i.ku.forEach(e=>{e.next()})}class YM{constructor(e,t,n){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(e){if(!this.options.includeMetadataChanges){const n=[];for(const r of e.docChanges)3!==r.type&&n.push(r);e=new cy(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){return!e.fromCache||(!this.options.Ku||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Uu(e){e=cy.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}class KG{constructor(e,t){this.Gu=e,this.byteLength=t}Qu(){return"metadata"in this.Gu}}class bB{constructor(e){this.serializer=e}rr(e){return uu(this.serializer,e)}ur(e){return e.metadata.exists?y2(this.serializer,e.document,!1):ji.newNoDocument(this.rr(e.metadata.name),this.cr(e.metadata.readTime))}cr(e){return Rr(e)}}class qG{constructor(e,t,n){this.ju=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=wB(e)}zu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Gu.namedQuery)this.queries.push(e.Gu.namedQuery);else if(e.Gu.documentMetadata){this.documents.push({metadata:e.Gu.documentMetadata}),e.Gu.documentMetadata.exists||++t;const n=Xn.fromString(e.Gu.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.Gu.document&&(this.documents[this.documents.length-1].document=e.Gu.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Wu(e){const t=new Map,n=new bB(this.serializer);for(const r of e)if(r.metadata.queries){const s=n.rr(r.metadata.name);for(const o of r.metadata.queries){const c=(t.get(o)||An()).add(s);t.set(o,c)}}return t}complete(){var e=this;return(0,Ie.Z)(function*(){const t=yield function EG(i,e,t,n){return(cN=cN||(0,Ie.Z)(function*(r,s,o,c){const h=yt(r);let m=An(),g=ra();for(const x of o){const S=s.rr(x.metadata.name);x.document&&(m=m.add(S));const R=s.ur(x);R.setReadTime(s.cr(x.metadata.readTime)),g=g.insert(S,R)}const y=h.Zi.newChangeBuffer({trackRemovals:!0}),E=yield ny(h,(x=c,Ao(K_(Xn.fromString(`__bundle__/docs/${x}`)))));var x;return h.persistence.runTransaction("Apply bundle documents","readwrite",x=>iB(x,y,g).next(S=>(y.apply(x),S)).next(S=>h.Bs.removeMatchingKeysForTargetId(x,E.targetId).next(()=>h.Bs.addMatchingKeys(x,m,E.targetId)).next(()=>h.localDocuments.getLocalViewOfDocuments(x,S.nr,S.sr)).next(()=>S.nr)))})).apply(this,arguments)}(e.localStore,new bB(e.serializer),e.documents,e.ju.id),n=e.Wu(e.documents);for(const r of e.queries)yield xG(e.localStore,r,n.get(r.name));return e.progress.taskState="Success",{progress:e.progress,Hu:e.collectionGroups,Ju:t}})()}}function wB(i){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:i.totalDocuments,totalBytes:i.totalBytes}}class EB{constructor(e){this.key=e}}class xB{constructor(e){this.key=e}}class TB{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=An(),this.mutatedKeys=An(),this.tc=UF(e),this.ec=new ly(this.tc)}get nc(){return this.Yu}sc(e,t){const n=t?t.ic:new vB,r=t?t.ec:this.ec;let s=t?t.mutatedKeys:this.mutatedKeys,o=r,c=!1;const h="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,m="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((g,y)=>{const E=r.get(g),x=ew(this.query,y)?y:null,S=!!E&&this.mutatedKeys.has(E.key),R=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let L=!1;E&&x?E.data.isEqual(x.data)?S!==R&&(n.track({type:3,doc:x}),L=!0):this.rc(E,x)||(n.track({type:2,doc:x}),L=!0,(h&&this.tc(x,h)>0||m&&this.tc(x,m)<0)&&(c=!0)):!E&&x?(n.track({type:0,doc:x}),L=!0):E&&!x&&(n.track({type:1,doc:E}),L=!0,(h||m)&&(c=!0)),L&&(x?(o=o.add(x),s=R?s.add(g):s.delete(g)):(o=o.delete(g),s=s.delete(g)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const g="F"===this.query.limitType?o.last():o.first();o=o.delete(g.key),s=s.delete(g.key),n.track({type:1,doc:g})}return{ec:o,ic:n,zi:c,mutatedKeys:s}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const s=e.ic.xu();s.sort((m,g)=>function(y,E){const x=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ot()}};return x(y)-x(E)}(m.type,g.type)||this.tc(m.doc,g.doc)),this.oc(n);const o=t?this.uc():[],c=0===this.Zu.size&&this.current?1:0,h=c!==this.Xu;return this.Xu=c,0!==s.length||h?{snapshot:new cy(this.query,e.ec,r,s,e.mutatedKeys,0===c,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new vB,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(t=>this.Yu=this.Yu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Yu=this.Yu.delete(t)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=An(),this.ec.forEach(n=>{this.ac(n.key)&&(this.Zu=this.Zu.add(n.key))});const t=[];return e.forEach(n=>{this.Zu.has(n)||t.push(new xB(n))}),this.Zu.forEach(n=>{e.has(n)||t.push(new EB(n))}),t}hc(e){this.Yu=e.ir,this.Zu=An();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return cy.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class YG{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class ZG{constructor(e){this.key=e,this.fc=!1}}class XG{constructor(e,t,n,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new gd(c=>FF(c),Jb),this._c=new Map,this.mc=new Set,this.gc=new Di(pt.comparator),this.yc=new Map,this.Ic=new AM,this.Tc={},this.Ec=new Map,this.Ac=Rp.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}function QG(i,e){return(SN=SN||(0,Ie.Z)(function*(t,n){const r=t1(t);let s,o;const c=r.wc.get(n);if(c)s=c.targetId,r.sharedClientState.addLocalQueryTarget(s),o=c.view.lc();else{const h=yield ny(r.localStore,Ao(n)),m=r.sharedClientState.addLocalQueryTarget(h.targetId);s=h.targetId,o=yield ZM(r,n,s,"current"===m,h.resumeToken),r.isPrimaryClient&&jC(r.remoteStore,h)}return o})).apply(this,arguments)}function ZM(i,e,t,n,r){return(DN=DN||(0,Ie.Z)(function*(s,o,c,h,m){s.Rc=(L,G,Y)=>{var K;return function(te,oe,Ae,we){return(K=K||(0,Ie.Z)(function*(We,ot,Le,Qt){let vt=ot.view.sc(Le);vt.zi&&(vt=yield BC(We.localStore,ot.query,!1).then(({documents:mi})=>ot.view.sc(mi,vt)));const Bn=Qt&&Qt.targetChanges.get(ot.targetId),Or=ot.view.applyChanges(vt,We.isPrimaryClient,Bn);return JM(We,ot.targetId,Or.cc),Or.snapshot})).apply(this,arguments)}(s,L,G,Y)};const g=yield BC(s.localStore,o,!0),y=new TB(o,g.ir),E=y.sc(g.documents),x=aw.createSynthesizedTargetChangeForCurrentChange(c,h&&"Offline"!==s.onlineState,m),S=y.applyChanges(E,s.isPrimaryClient,x);JM(s,c,S.cc);const R=new YG(o,c,y);return s.wc.set(o,R),s._c.has(c)?s._c.get(c).push(o):s._c.set(c,[o]),S.snapshot})).apply(this,arguments)}function JG(i,e){return(AN=AN||(0,Ie.Z)(function*(t,n){const r=yt(t),s=r.wc.get(n),o=r._c.get(s.targetId);if(o.length>1)return r._c.set(s.targetId,o.filter(c=>!Jb(c,n))),void r.wc.delete(n);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||(yield iy(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),ww(r.remoteStore,s.targetId),uy(r,s.targetId)}).catch(af))):(uy(r,s.targetId),yield iy(r.localStore,s.targetId,!0))})).apply(this,arguments)}function IB(i,e){return(RN=RN||(0,Ie.Z)(function*(t,n){const r=yt(t);try{const s=yield function bG(i,e){const t=yt(i),n=e.snapshotVersion;let r=t.Ji;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.Zi.newChangeBuffer({trackRemovals:!0});r=t.Ji;const c=[];e.targetChanges.forEach((g,y)=>{const E=r.get(y);if(!E)return;c.push(t.Bs.removeMatchingKeys(s,g.removedDocuments,y).next(()=>t.Bs.addMatchingKeys(s,g.addedDocuments,y)));let x=E.withSequenceNumber(s.currentSequenceNumber);var S,R,L;null!==e.targetMismatches.get(y)?x=x.withResumeToken(ts.EMPTY_BYTE_STRING,Yt.min()).withLastLimboFreeSnapshotVersion(Yt.min()):g.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(g.resumeToken,n)),r=r.insert(y,x),R=x,L=g,(0===(S=E).resumeToken.approximateByteSize()||R.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=3e8||L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0)&&c.push(t.Bs.updateTargetData(s,x))});let h=ra(),m=An();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,g))}),c.push(iB(s,o,e.documentUpdates).next(g=>{h=g.nr,m=g.sr})),!n.isEqual(Yt.min())){const g=t.Bs.getLastRemoteSnapshotVersion(s).next(y=>t.Bs.setTargetsMetadata(s,s.currentSequenceNumber,n));c.push(g)}return ge.waitFor(c).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,h,m)).next(()=>h)}).then(s=>(t.Ji=r,s))}(r.localStore,n);n.targetChanges.forEach((o,c)=>{const h=r.yc.get(c);h&&(qt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1),o.addedDocuments.size>0?h.fc=!0:o.modifiedDocuments.size>0?qt(h.fc):o.removedDocuments.size>0&&(qt(h.fc),h.fc=!1))}),yield vd(r,s,n)}catch(s){yield af(s)}})).apply(this,arguments)}function CB(i,e,t){const n=yt(i);if(n.isPrimaryClient&&0===t||!n.isPrimaryClient&&1===t){const r=[];n.wc.forEach((s,o)=>{const c=o.view.Mu(e);c.snapshot&&r.push(c.snapshot)}),function(s,o){const c=yt(s);c.onlineState=o;let h=!1;c.queries.forEach((m,g)=>{for(const y of g.listeners)y.Mu(o)&&(h=!0)}),h&&qM(c)}(n.eventManager,e),r.length&&n.dc.nu(r),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function tz(i,e,t){return(MN=MN||(0,Ie.Z)(function*(n,r,s){const o=yt(n);o.sharedClientState.updateQueryState(r,"rejected",s);const c=o.yc.get(r),h=c&&c.key;if(h){let m=new Di(pt.comparator);m=m.insert(h,ji.newNoDocument(h,Yt.min()));const g=An().add(h),y=new ow(Yt.min(),new Map,new Di(En),m,g);yield IB(o,y),o.gc=o.gc.remove(h),o.yc.delete(r),e1(o)}else yield iy(o.localStore,r,!1).then(()=>uy(o,r,s)).catch(af)})).apply(this,arguments)}function nz(i,e){return(ON=ON||(0,Ie.Z)(function*(t,n){const r=yt(t),s=n.batch.batchId;try{const o=yield function vG(i,e){const t=yt(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const r=e.batch.keys(),s=t.Zi.newChangeBuffer({trackRemovals:!0});return function(o,c,h,m){const g=h.batch,y=g.keys();let E=ge.resolve();return y.forEach(x=>{E=E.next(()=>m.getEntry(c,x)).next(S=>{const R=h.docVersions.get(x);qt(null!==R),S.version.compareTo(R)<0&&(g.applyToRemoteDocument(S,h),S.isValidDocument()&&(S.setReadTime(h.commitVersion),m.addEntry(S)))})}),E.next(()=>o.mutationQueue.removeMutationBatch(c,g))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let c=An();for(let h=0;h<o.mutationResults.length;++h)o.mutationResults[h].transformResults.length>0&&(c=c.add(o.batch.mutations[h].key));return c}(e))).next(()=>t.localDocuments.getDocuments(n,r))})}(r.localStore,n);QM(r,s,null),XM(r,s),r.sharedClientState.updateMutationState(s,"acknowledged"),yield vd(r,o)}catch(o){yield af(o)}})).apply(this,arguments)}function iz(i,e,t){return(PN=PN||(0,Ie.Z)(function*(n,r,s){const o=yt(n);try{const c=yield function(h,m){const g=yt(h);return g.persistence.runTransaction("Reject batch","readwrite-primary",y=>{let E;return g.mutationQueue.lookupMutationBatch(y,m).next(x=>(qt(null!==x),E=x.keys(),g.mutationQueue.removeMutationBatch(y,x))).next(()=>g.mutationQueue.performConsistencyCheck(y)).next(()=>g.documentOverlayCache.removeOverlaysForBatchId(y,E,m)).next(()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,E)).next(()=>g.localDocuments.getDocuments(y,E))})}(o.localStore,r);QM(o,r,s),XM(o,r),o.sharedClientState.updateMutationState(r,"rejected",s),yield vd(o,c)}catch(c){yield af(c)}})).apply(this,arguments)}function XM(i,e){(i.Ec.get(e)||[]).forEach(t=>{t.resolve()}),i.Ec.delete(e)}function QM(i,e,t){const n=yt(i);let r=n.Tc[n.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),n.Tc[n.currentUser.toKey()]=r}}function uy(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(const n of i._c.get(e))i.wc.delete(n),t&&i.dc.Pc(n,t);i._c.delete(e),i.isPrimaryClient&&i.Ic.Is(e).forEach(n=>{i.Ic.containsKey(n)||SB(i,n)})}function SB(i,e){i.mc.delete(e.path.canonicalString());const t=i.gc.get(e);null!==t&&(ww(i.remoteStore,t),i.gc=i.gc.remove(e),i.yc.delete(t),e1(i))}function JM(i,e,t){for(const n of t)n instanceof EB?(i.Ic.addReference(n.key,e),sz(i,n)):n instanceof xB?(nt("SyncEngine","Document no longer in limbo: "+n.key),i.Ic.removeReference(n.key,e),i.Ic.containsKey(n.key)||SB(i,n.key)):Ot()}function sz(i,e){const t=e.key,n=t.path.canonicalString();i.gc.get(t)||i.mc.has(n)||(nt("SyncEngine","New document in limbo: "+t),i.mc.add(n),e1(i))}function e1(i){for(;i.mc.size>0&&i.gc.size<i.maxConcurrentLimboResolutions;){const e=i.mc.values().next().value;i.mc.delete(e);const t=new pt(Xn.fromString(e)),n=i.Ac.next();i.yc.set(n,new ZG(t)),i.gc=i.gc.insert(t,n),jC(i.remoteStore,new yd(Ao(K_(t.path)),n,"TargetPurposeLimboResolution",$a.ct))}}function vd(i,e,t){return(NN=NN||(0,Ie.Z)(function*(n,r,s){var o;const c=yt(n),h=[],m=[],g=[];c.wc.isEmpty()||(c.wc.forEach((y,E)=>{g.push(c.Rc(E,r,s).then(x=>{if((x||s)&&c.isPrimaryClient&&c.sharedClientState.updateQueryState(E.targetId,x?.fromCache?"not-current":"current"),x){h.push(x);const S=PM.Li(E.targetId,x);m.push(S)}}))}),yield Promise.all(g),c.dc.nu(h),yield function(y,E){return(o=o||(0,Ie.Z)(function*(x,S){const R=yt(x);try{yield R.persistence.runTransaction("notifyLocalViewChanges","readwrite",L=>ge.forEach(S,G=>ge.forEach(G.Fi,Y=>R.persistence.referenceDelegate.addReference(L,G.targetId,Y)).next(()=>ge.forEach(G.Bi,Y=>R.persistence.referenceDelegate.removeReference(L,G.targetId,Y)))))}catch(L){if(!lf(L))throw L;nt("LocalStore","Failed to update sequence numbers: "+L)}for(const L of S){const G=L.targetId;if(!L.fromCache){const Y=R.Ji.get(G),te=Y.withLastLimboFreeSnapshotVersion(Y.snapshotVersion);R.Ji=R.Ji.insert(G,te)}}})).apply(this,arguments)}(c.localStore,m))})).apply(this,arguments)}function oz(i,e){return(FN=FN||(0,Ie.Z)(function*(t,n){const r=yt(t);if(!r.currentUser.isEqual(n)){nt("SyncEngine","User change. New user:",n.toKey());const s=yield tB(r.localStore,n);r.currentUser=n,function(o,c){o.Ec.forEach(h=>{h.forEach(m=>{m.reject(new $e(be.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),o.Ec.clear()}(r),r.sharedClientState.handleUserChange(n,s.removedBatchIds,s.addedBatchIds),yield vd(r,s.er)}})).apply(this,arguments)}function az(i,e){const t=yt(i),n=t.yc.get(e);if(n&&n.fc)return An().add(n.key);{let r=An();const s=t._c.get(e);if(!s)return r;for(const o of s){const c=t.wc.get(o);r=r.unionWith(c.view.nc)}return r}}function lz(i,e){return(BN=BN||(0,Ie.Z)(function*(t,n){const r=yt(t),s=yield BC(r.localStore,n.query,!0),o=n.view.hc(s);return r.isPrimaryClient&&JM(r,n.targetId,o.cc),o})).apply(this,arguments)}function cz(i,e){return(UN=UN||(0,Ie.Z)(function*(t,n){const r=yt(t);return sB(r.localStore,n).then(s=>vd(r,s))})).apply(this,arguments)}function uz(i,e,t,n){return(VN=VN||(0,Ie.Z)(function*(r,s,o,c){const h=yt(r),m=yield function(g,y){const E=yt(g),x=yt(E.mutationQueue);return E.persistence.runTransaction("Lookup mutation documents","readonly",S=>x.Sn(S,y).next(R=>R?E.localDocuments.getDocuments(S,R):ge.resolve(null)))}(h.localStore,s);var y;null!==m?("pending"===o?yield sy(h.remoteStore):"acknowledged"===o||"rejected"===o?(QM(h,s,c||null),XM(h,s),y=s,yt(yt(h.localStore).mutationQueue).Cn(y)):Ot(),yield vd(h,m)):nt("SyncEngine","Cannot apply mutation batch with id: "+s)})).apply(this,arguments)}function DB(i,e,t){return(HN=HN||(0,Ie.Z)(function*(n,r,s){const o=yt(n),c=[],h=[];for(const m of r){let g;const y=o._c.get(m);if(y&&0!==y.length){g=yield ny(o.localStore,Ao(y[0]));for(const E of y){const x=o.wc.get(E),S=yield lz(o,x);S.snapshot&&h.push(S.snapshot)}}else{const E=yield rB(o.localStore,m);g=yield ny(o.localStore,E),yield ZM(o,AB(E),m,!1,g.resumeToken)}c.push(g)}return o.dc.nu(h),c})).apply(this,arguments)}function AB(i){return LF(i.path,i.collectionGroup,i.orderBy,i.filters,i.limit,"F",i.startAt,i.endAt)}function hz(i){const e=yt(i);return yt(yt(e.localStore).persistence).$i()}function fz(i,e,t,n){return(jN=jN||(0,Ie.Z)(function*(r,s,o,c){const h=yt(r);if(h.vc)return void nt("SyncEngine","Ignoring unexpected query state notification.");const m=h._c.get(s);if(m&&m.length>0)switch(o){case"current":case"not-current":{const g=yield sB(h.localStore,BF(m[0])),y=ow.createSynthesizedRemoteEventForCurrentChange(s,"current"===o,ts.EMPTY_BYTE_STRING);yield vd(h,g,y);break}case"rejected":yield iy(h.localStore,s,!0),uy(h,s,c);break;default:Ot()}})).apply(this,arguments)}function mz(i,e,t){return(GN=GN||(0,Ie.Z)(function*(n,r,s){const o=t1(n);if(o.vc){for(const c of r){if(o._c.has(c)){nt("SyncEngine","Adding an already active target "+c);continue}const h=yield rB(o.localStore,c),m=yield ny(o.localStore,h);yield ZM(o,AB(h),m.targetId,!1,m.resumeToken),jC(o.remoteStore,m)}for(const c of s)o._c.has(c)&&(yield iy(o.localStore,c,!1).then(()=>{ww(o.remoteStore,c),uy(o,c)}).catch(af))}})).apply(this,arguments)}function t1(i){const e=yt(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=IB.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=az.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=tz.bind(null,e),e.dc.nu=zG.bind(null,e.eventManager),e.dc.Pc=WG.bind(null,e.eventManager),e}function n1(i){const e=yt(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=nz.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=iz.bind(null,e),e}class Ew{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,Ie.Z)(function*(){t.serializer=vw(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return eB(this.persistence,new J2,e.initialUser,this.serializer)}createPersistence(e){return new kM(LC.zs,this.serializer)}createSharedClientState(e){return new cB}terminate(){var e=this;return(0,Ie.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class r1 extends Ew{constructor(e,t,n){super(),this.Vc=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,n=this;return(0,Ie.Z)(function*(){yield t().call(n,e),yield n.Vc.initialize(n,e),yield n1(n.Vc.syncEngine),yield sy(n.Vc.remoteStore),yield n.persistence.Ii(()=>(n.gcScheduler&&!n.gcScheduler.started&&n.gcScheduler.start(),n.indexBackfillerScheduler&&!n.indexBackfillerScheduler.started&&n.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return eB(this.persistence,new J2,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){return new G2(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const n=new $4(t,this.persistence);return new V4(e.asyncQueue,n)}createPersistence(e){const t=OM(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?ro.withCacheSize(this.cacheSizeBytes):ro.DEFAULT;return new MM(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,dB(),HC(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new cB}}class kB extends r1{constructor(e,t){super(e,t,!1),this.Vc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,n=this;return(0,Ie.Z)(function*(){var r;yield t().call(n,e);const s=n.Vc.syncEngine;n.sharedClientState instanceof BM&&(n.sharedClientState.syncEngine={jr:uz.bind(null,s),zr:fz.bind(null,s),Wr:mz.bind(null,s),$i:hz.bind(null,s),Qr:cz.bind(null,s)},yield n.sharedClientState.start()),yield n.persistence.Ii(function(o){return(r=r||(0,Ie.Z)(function*(c){yield function dz(i,e){return($N=$N||(0,Ie.Z)(function*(t,n){const r=yt(t);if(t1(r),n1(r),!0===n&&!0!==r.vc){const s=r.sharedClientState.getAllActiveQueryTargets(),o=yield DB(r,s.toArray());r.vc=!0,yield GM(r.remoteStore,!0);for(const c of o)jC(r.remoteStore,c)}else if(!1===n&&!1!==r.vc){const s=[];let o=Promise.resolve();r._c.forEach((c,h)=>{r.sharedClientState.isLocalQueryTarget(h)?s.push(h):o=o.then(()=>(uy(r,h),iy(r.localStore,h,!0))),ww(r.remoteStore,h)}),yield o,yield DB(r,s),function(c){const h=yt(c);h.yc.forEach((m,g)=>{ww(h.remoteStore,g)}),h.Ic.Ts(),h.yc=new Map,h.gc=new Di(pt.comparator)}(r),r.vc=!1,yield GM(r.remoteStore,!1)}})).apply(this,arguments)}(n.Vc.syncEngine,c),n.gcScheduler&&(c&&!n.gcScheduler.started?n.gcScheduler.start():c||n.gcScheduler.stop()),n.indexBackfillerScheduler&&(c&&!n.indexBackfillerScheduler.started?n.indexBackfillerScheduler.start():c||n.indexBackfillerScheduler.stop())})).apply(this,arguments)})})()}createSharedClientState(e){const t=dB();if(!BM.D(t))throw new $e(be.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=OM(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new BM(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class dy{initialize(e,t){var n=this;return(0,Ie.Z)(function*(){n.localStore||(n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=r=>CB(n.syncEngine,r,1),n.remoteStore.remoteSyncer.handleCredentialChange=oz.bind(null,n.syncEngine),yield GM(n.remoteStore,n.syncEngine.isPrimaryClient))})()}createEventManager(e){return new GG}createDatastore(e){const t=vw(e.databaseInfo.databaseId),n=new SG(e.databaseInfo);return function(s,o,c,h){return new kG(s,o,c,h)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,s=c=>CB(this.syncEngine,c,0),o=uB.D()?new uB:new TG,new OG(t,n,r,s,o);var t,n,r,s,o}createSyncEngine(e,t){return function(n,r,s,o,c,h,m){const g=new XG(n,r,s,o,c,h);return m&&(g.vc=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){var e;return function(t){return(e=e||(0,Ie.Z)(function*(n){const r=yt(n);nt("RemoteStore","RemoteStore shutting down."),r.vu.add(5),yield ry(r),r.Pu.shutdown(),r.bu.set("Unknown")})).apply(this,arguments)}(this.remoteStore)}}function RB(i,e=10240){let t=0;return{read:()=>(0,Ie.Z)(function*(){if(t<i.byteLength){const n={value:i.slice(t,t+e),done:!1};return t+=e,n}return{done:!0}})(),cancel:()=>(0,Ie.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class zC{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):kr("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class _z{constructor(e,t){this.Cc=e,this.serializer=t,this.metadata=new es,this.buffer=new Uint8Array,this.xc=new TextDecoder("utf-8"),this.Nc().then(n=>{n&&n.Qu()?this.metadata.resolve(n.Gu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(n?.Gu)}`))},n=>this.metadata.reject(n))}close(){return this.Cc.cancel()}getMetadata(){var e=this;return(0,Ie.Z)(function*(){return e.metadata.promise})()}bc(){var e=this;return(0,Ie.Z)(function*(){return yield e.getMetadata(),e.Nc()})()}Nc(){var e=this;return(0,Ie.Z)(function*(){const t=yield e.kc();if(null===t)return null;const n=e.xc.decode(t),r=Number(n);isNaN(r)&&e.Mc(`length string (${n}) is not valid number`);const s=yield e.$c(r);return new KG(JSON.parse(s),t.length+r)})()}Oc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}kc(){var e=this;return(0,Ie.Z)(function*(){for(;e.Oc()<0&&!(yield e.Fc()););if(0===e.buffer.length)return null;const t=e.Oc();t<0&&e.Mc("Reached the end of bundle when a length string is expected.");const n=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),n})()}$c(e){var t=this;return(0,Ie.Z)(function*(){for(;t.buffer.length<e;)(yield t.Fc())&&t.Mc("Reached the end of bundle when more is expected.");const n=t.xc.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),n})()}Mc(e){throw this.Cc.cancel(),new Error(`Invalid bundle format: ${e}`)}Fc(){var e=this;return(0,Ie.Z)(function*(){const t=yield e.Cc.read();if(!t.done){const n=new Uint8Array(e.buffer.length+t.value.length);n.set(e.buffer),n.set(t.value,e.buffer.length),e.buffer=n}return t.done})()}}class yz{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,Ie.Z)(function*(){var n;if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new $e(be.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield function(s,o){return(n=n||(0,Ie.Z)(function*(c,h){const m=yt(c),g=cw(m.serializer)+"/documents",y={documents:h.map(R=>lw(m.serializer,R))},E=yield m.vo("BatchGetDocuments",g,y,h.length),x=new Map;E.forEach(R=>{const L=function Uj(i,e){return"found"in e?function(t,n){qt(!!n.found);const r=uu(t,n.found.name),s=Rr(n.found.updateTime),o=n.found.createTime?Rr(n.found.createTime):Yt.min(),c=new $s({mapValue:{fields:n.found.fields}});return ji.newFoundDocument(r,s,o,c)}(i,e):"missing"in e?function(t,n){qt(!!n.missing),qt(!!n.readTime);const r=uu(t,n.missing),s=Rr(n.readTime);return ji.newNoDocument(r,s)}(i,e):Ot()}(m.serializer,R);x.set(L.key.toString(),L)});const S=[];return h.forEach(R=>{const L=x.get(R.toString());qt(!!L),S.push(L)}),S})).apply(this,arguments)}(t.datastore,e);return r.forEach(s=>t.recordVersion(s)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastWriteError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new X_(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,Ie.Z)(function*(){var t;if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const n=e.readVersions;e.mutations.forEach(r=>{n.delete(r.key.toString())}),n.forEach((r,s)=>{const o=pt.fromPath(s);e.mutations.push(new dM(o,e.precondition(o)))}),yield function(r,s){return(t=t||(0,Ie.Z)(function*(o,c){const h=yt(o),m=cw(h.serializer)+"/documents",g={writes:c.map(y=>uw(h.serializer,y))};yield h.Io("Commit",m,g)})).apply(this,arguments)}(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ot();t=Yt.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new $e(be.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Yt.min())?tr.exists(!1):tr.updateTime(t):tr.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Yt.min()))throw new $e(be.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return tr.updateTime(t)}return tr.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class vz{constructor(e,t,n,r,s){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=s,this.Bc=n.maxAttempts,this.qo=new VM(this.asyncQueue,"transaction_retry")}run(){this.Bc-=1,this.Lc()}Lc(){var e=this;this.qo.No((0,Ie.Z)(function*(){const t=new yz(e.datastore),n=e.qc(t);n&&n.then(r=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(r)}).catch(s=>{e.Uc(s)}))}).catch(r=>{e.Uc(r)})}))}qc(e){try{const t=this.updateFunction(e);return!Wb(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Uc(e){this.Bc>0&&this.Kc(e)?(this.Bc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Lc(),Promise.resolve()))):this.deferred.reject(e)}Kc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!n2(t)}return!1}}class bz{constructor(e,t,n,r){var o,s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=bs.UNAUTHENTICATED,this.clientId=JN.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,function(c){return(o=o||(0,Ie.Z)(function*(h){nt("FirestoreClient","Received user=",h.uid),yield s.authCredentialListener(h),s.user=h})).apply(this,arguments)}),this.appCheckCredentials.start(n,c=>(nt("FirestoreClient","Received new app check token=",c),this.appCheckCredentialListener(c,this.user)))}getConfiguration(){var e=this;return(0,Ie.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new $e(be.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new es;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,Ie.Z)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(n){const r=ay(n,"Failed to shutdown persistence");t.reject(r)}})),t.promise}}function WC(i,e){return(zN=zN||(0,Ie.Z)(function*(t,n){var r;t.asyncQueue.verifyOperationInProgress(),nt("FirestoreClient","Initializing OfflineComponentProvider");const s=yield t.getConfiguration();yield n.initialize(s);let o=s.initialUser;t.setCredentialChangeListener(function(c){return(r=r||(0,Ie.Z)(function*(h){o.isEqual(h)||(yield tB(n.localStore,h),o=h)})).apply(this,arguments)}),n.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=n})).apply(this,arguments)}function s1(i,e){return(WN=WN||(0,Ie.Z)(function*(t,n){t.asyncQueue.verifyOperationInProgress();const r=yield o1(t);nt("FirestoreClient","Initializing OnlineComponentProvider");const s=yield t.getConfiguration();yield n.initialize(r,s),t.setCredentialChangeListener(o=>yB(n.remoteStore,o)),t.setAppCheckTokenChangeListener((o,c)=>yB(n.remoteStore,c)),t._onlineComponents=n})).apply(this,arguments)}function MB(i){return"FirebaseError"===i.name?i.code===be.FAILED_PRECONDITION||i.code===be.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||22===i.code||20===i.code||11===i.code}function o1(i){return(KN=KN||(0,Ie.Z)(function*(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){nt("FirestoreClient","Using user provided OfflineComponentProvider");try{yield WC(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!MB(n))throw n;yl("Error using user provided cache. Falling back to memory cache: "+n),yield WC(e,new Ew)}}else nt("FirestoreClient","Using default OfflineComponentProvider"),yield WC(e,new Ew);return e._offlineComponents})).apply(this,arguments)}function KC(i){return(qN=qN||(0,Ie.Z)(function*(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(nt("FirestoreClient","Using user provided OnlineComponentProvider"),yield s1(e,e._uninitializedComponentsProvider._online)):(nt("FirestoreClient","Using default OnlineComponentProvider"),yield s1(e,new dy))),e._onlineComponents})).apply(this,arguments)}function OB(i){return o1(i).then(e=>e.persistence)}function qC(i){return o1(i).then(e=>e.localStore)}function PB(i){return KC(i).then(e=>e.remoteStore)}function a1(i){return KC(i).then(e=>e.syncEngine)}function hy(i){return(YN=YN||(0,Ie.Z)(function*(e){const t=yield KC(e),n=t.eventManager;return n.onListen=QG.bind(null,t.syncEngine),n.onUnlisten=JG.bind(null,t.syncEngine),n})).apply(this,arguments)}function NB(i,e,t={}){const n=new es;return i.asyncQueue.enqueueAndForget((0,Ie.Z)(function*(){return function(r,s,o,c,h){const m=new zC({next:y=>{s.enqueueAndForget(()=>KM(r,g));const E=y.docs.has(o);!E&&y.fromCache?h.reject(new $e(be.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&y.fromCache&&c&&"server"===c.source?h.reject(new $e(be.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(y)},error:y=>h.reject(y)}),g=new YM(K_(o.path),m,{includeMetadataChanges:!0,Ku:!0});return WM(r,g)}(yield hy(i),i.asyncQueue,e,t,n)})),n.promise}function FB(i,e,t={}){const n=new es;return i.asyncQueue.enqueueAndForget((0,Ie.Z)(function*(){return function(r,s,o,c,h){const m=new zC({next:y=>{s.enqueueAndForget(()=>KM(r,g)),y.fromCache&&"server"===c.source?h.reject(new $e(be.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(y)},error:y=>h.reject(y)}),g=new YM(o,m,{includeMetadataChanges:!0,Ku:!0});return WM(r,g)}(yield hy(i),i.asyncQueue,e,t,n)})),n.promise}function BB(i){const e={};return void 0!==i.timeoutSeconds&&(e.timeoutSeconds=i.timeoutSeconds),e}const UB=new Map;function l1(i,e,t){if(!t)throw new $e(be.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function VB(i,e,t,n){if(!0===e&&!0===n)throw new $e(be.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function $B(i){if(!pt.isDocumentKey(i))throw new $e(be.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function HB(i){if(pt.isDocumentKey(i))throw new $e(be.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function YC(i){if(void 0===i)return"undefined";if(null===i)return"null";if("string"==typeof i)return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if("number"==typeof i||"boolean"==typeof i)return""+i;if("object"==typeof i){if(i instanceof Array)return"an array";{const e=(t=i).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof i?"a function":Ot()}function Vn(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new $e(be.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=YC(i);throw new $e(be.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}function jB(i,e){if(e<=0)throw new $e(be.INVALID_ARGUMENT,`Function ${i}() requires a positive number, but it was: ${e}.`)}class GB{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new $e(be.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new $e(be.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}VB("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=BB(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(r){if(void 0!==r.timeoutSeconds){if(isNaN(r.timeoutSeconds))throw new $e(be.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new $e(be.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new $e(be.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class xw{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new GB({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new $e(be.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new $e(be.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new GB(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new D4;switch(t.type){case"firstParty":return new M4(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new $e(be.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=UB.get(e);t&&(nt("ComponentProvider","Removing Datastore"),UB.delete(e),t.terminate())}(this),Promise.resolve()}}function zB(i,e,t,n={}){var r;const s=(i=Vn(i,xw))._getSettings(),o=`${e}:${t}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&yl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),i._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),n.mockUserToken){let c,h;if("string"==typeof n.mockUserToken)c=n.mockUserToken,h=bs.MOCK_USER;else{c=(0,bn.Sg)(n.mockUserToken,null===(r=i._app)||void 0===r?void 0:r.options.projectId);const m=n.mockUserToken.sub||n.mockUserToken.user_id;if(!m)throw new $e(be.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new bs(m)}i._authCredentials=new A4(new XN(c,h))}}class Gi{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new du(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Gi(this.firestore,e,this._key)}}class Hs{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Hs(this.firestore,e,this._query)}}class du extends Hs{constructor(e,t,n){super(e,t,K_(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Gi(this.firestore,null,new pt(e))}withConverter(e){return new du(this.firestore,e,this._path)}}function WB(i,e,...t){if(i=(0,bn.m9)(i),l1("collection","path",e),i instanceof xw){const n=Xn.fromString(e,...t);return HB(n),new du(i,null,n)}{if(!(i instanceof Gi||i instanceof du))throw new $e(be.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(Xn.fromString(e,...t));return HB(n),new du(i.firestore,null,n)}}function Tw(i,e,...t){if(i=(0,bn.m9)(i),1===arguments.length&&(e=JN.A()),l1("doc","path",e),i instanceof xw){const n=Xn.fromString(e,...t);return $B(n),new Gi(i,null,new pt(n))}{if(!(i instanceof Gi||i instanceof du))throw new $e(be.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(Xn.fromString(e,...t));return $B(n),new Gi(i.firestore,i instanceof du?i.converter:null,new pt(n))}}function KB(i,e){return i=(0,bn.m9)(i),e=(0,bn.m9)(e),(i instanceof Gi||i instanceof du)&&(e instanceof Gi||e instanceof du)&&i.firestore===e.firestore&&i.path===e.path&&i.converter===e.converter}function c1(i,e){return i=(0,bn.m9)(i),e=(0,bn.m9)(e),i instanceof Hs&&e instanceof Hs&&i.firestore===e.firestore&&Jb(i._query,e._query)&&i.converter===e.converter}class kz{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new VM(this,"async_queue_retry"),this.Xc=()=>{const t=HC();t&&nt("AsyncQueue","Visibility state changed to "+t.visibilityState),this.qo.Mo()};const e=HC();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=HC();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const t=new es;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}ea(){var e=this;return(0,Ie.Z)(function*(){if(0!==e.Qc.length){try{yield e.Qc[0](),e.Qc.shift(),e.qo.reset()}catch(t){if(!lf(t))throw t;nt("AsyncQueue","Operation failed with retryable error: "+t)}e.Qc.length>0&&e.qo.No(()=>e.ea())}})()}ta(e){const t=this.Gc.then(()=>(this.Hc=!0,e().catch(n=>{this.Wc=n,this.Hc=!1;const r=function(s){let o=s.message||"";return s.stack&&(o=s.stack.includes(s.message)?s.stack:s.message+"\n"+s.stack),o}(n);throw kr("INTERNAL UNHANDLED ERROR: ",r),n}).then(n=>(this.Hc=!1,n))));return this.Gc=t,t}enqueueAfterDelay(e,t,n){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const r=zM.createAndSchedule(this,e,t,n,s=>this.na(s));return this.zc.push(r),r}Zc(){this.Wc&&Ot()}verifyOperationInProgress(){}sa(){var e=this;return(0,Ie.Z)(function*(){let t;do{t=e.Gc,yield t}while(t!==e.Gc)})()}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function u1(i){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of["next","error","complete"])if(r in n&&"function"==typeof n[r])return!0;return!1}(i)}class Rz{constructor(){this._progressObserver={},this._taskCompletionResolver=new es,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class zi extends xw{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new kz,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||YB(this),this._firestoreClient.terminate()}}function qB(i,e){const t="object"==typeof i?i:(0,Qi.getApp)(),n="string"==typeof i?i:e||"(default)",r=(0,Qi._getProvider)(t,"firestore").getImmediate({identifier:n});if(!r._initialized){const s=(0,bn.P0)("firestore");s&&zB(r,...s)}return r}function Mr(i){return i._firestoreClient||YB(i),i._firestoreClient.verifyNotTerminated(),i._firestoreClient}function YB(i){var e,t,n;const r=i._freezeSettings(),s=function(o,c,h,m){return new lj(o,c,h,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,BB(m.experimentalLongPollingOptions),m.useFetchStreams)}(i._databaseId,(null===(e=i._app)||void 0===e?void 0:e.options.appId)||"",i._persistenceKey,r);i._firestoreClient=new bz(i._authCredentials,i._appCheckCredentials,i._queue,s),null!==(t=r.cache)&&void 0!==t&&t._offlineComponentProvider&&null!==(n=r.cache)&&void 0!==n&&n._onlineComponentProvider&&(i._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.cache.kind,_offline:r.cache._offlineComponentProvider,_online:r.cache._onlineComponentProvider})}function ZB(i,e,t){const n=new es;return i.asyncQueue.enqueue((0,Ie.Z)(function*(){try{yield WC(i,t),yield s1(i,e),n.resolve()}catch(r){const s=r;if(!MB(s))throw s;yl("Error enabling indexeddb cache. Falling back to memory cache: "+s),n.reject(s)}})).then(()=>n.promise)}function XB(i){if(i._initialized||i._terminated)throw new $e(be.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class hu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new hu(ts.fromBase64String(e))}catch(t){throw new $e(be.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new hu(ts.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class bd{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new $e(be.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new br(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Op{constructor(e){this._methodName=e}}class ZC{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new $e(be.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new $e(be.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return En(this._lat,e._lat)||En(this._long,e._long)}}const Hz=/^__.*__$/;class jz{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new _d(e,this.data,this.fieldMask,t,this.fieldTransforms):new Z_(e,this.data,t,this.fieldTransforms)}}class QB{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new _d(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function JB(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ot()}}class XC{constructor(e,t,n,r,s,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===s&&this.ua(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new XC(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.fa(e),r}da(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.ua(),r}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return eS(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(JB(this.ca)&&Hz.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class Gz{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||vw(e)}ya(e,t,n,r=!1){return new XC({ca:e,methodName:t,ga:n,path:br.emptyPath(),la:!1,ma:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Pp(i){const e=i._freezeSettings(),t=vw(i._databaseId);return new Gz(i._databaseId,!!e.ignoreUndefinedProperties,t)}function QC(i,e,t,n,r,s={}){const o=i.ya(s.merge||s.mergeFields?2:0,e,t,r);m1("Data must be an object, but it was:",o,n);const c=nU(n,o);let h,m;if(s.merge)h=new ia(o.fieldMask),m=o.fieldTransforms;else if(s.mergeFields){const g=[];for(const y of s.mergeFields){const E=Sw(e,y,t);if(!o.contains(E))throw new $e(be.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);rU(g,E)||g.push(E)}h=new ia(g),m=o.fieldTransforms.filter(y=>h.covers(y.field))}else h=null,m=o.fieldTransforms;return new jz(new $s(c),h,m)}class Cw extends Op{_toFieldTransform(e){if(2!==e.ca)throw e._a(1===e.ca?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Cw}}function eU(i,e,t){return new XC({ca:3,ga:e.settings.ga,methodName:i._methodName,la:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class d1 extends Op{_toFieldTransform(e){return new iw(e.path,new q_)}isEqual(e){return e instanceof d1}}class zz extends Op{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){const t=eU(this,e,!0),n=this.pa.map(s=>Lp(s,t)),r=new Tp(n);return new iw(e.path,r)}isEqual(e){return this===e}}class Wz extends Op{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){const t=eU(this,e,!0),n=this.pa.map(s=>Lp(s,t)),r=new Ip(n);return new iw(e.path,r)}isEqual(e){return this===e}}class Kz extends Op{constructor(e,t){super(e),this.Ia=t}_toFieldTransform(e){const t=new Y_(e.serializer,zF(e.serializer,this.Ia));return new iw(e.path,t)}isEqual(e){return this===e}}function h1(i,e,t,n){const r=i.ya(1,e,t);m1("Data must be an object, but it was:",r,n);const s=[],o=$s.empty();cf(n,(h,m)=>{const g=JC(e,h,t);m=(0,bn.m9)(m);const y=r.da(g);if(m instanceof Cw)s.push(g);else{const E=Lp(m,y);null!=E&&(s.push(g),o.set(g,E))}});const c=new ia(s);return new QB(o,c,r.fieldTransforms)}function f1(i,e,t,n,r,s){const o=i.ya(1,e,t),c=[Sw(e,n,t)],h=[r];if(s.length%2!=0)throw new $e(be.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<s.length;E+=2)c.push(Sw(e,s[E])),h.push(s[E+1]);const m=[],g=$s.empty();for(let E=c.length-1;E>=0;--E)if(!rU(m,c[E])){const x=c[E];let S=h[E];S=(0,bn.m9)(S);const R=o.da(x);if(S instanceof Cw)m.push(x);else{const L=Lp(S,R);null!=L&&(m.push(x),g.set(x,L))}}const y=new ia(m);return new QB(g,y,o.fieldTransforms)}function tU(i,e,t,n=!1){return Lp(t,i.ya(n?4:3,e))}function Lp(i,e){if(iU(i=(0,bn.m9)(i)))return m1("Unsupported field value:",e,i),nU(i,e);if(i instanceof Op)return function(t,n){if(!JB(n.ca))throw n._a(`${t._methodName}() can only be used with update() and set()`);if(!n.path)throw n._a(`${t._methodName}() is not currently supported inside arrays`);const r=t._toFieldTransform(n);r&&n.fieldTransforms.push(r)}(i,e),null;if(void 0===i&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.la&&4!==e.ca)throw e._a("Nested arrays are not supported");return function(t,n){const r=[];let s=0;for(const o of t){let c=Lp(o,n.wa(s));null==c&&(c={nullValue:"NULL_VALUE"}),r.push(c),s++}return{arrayValue:{values:r}}}(i,e)}return function(t,n){if(null===(t=(0,bn.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return zF(n.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const r=er.fromDate(t);return{timestampValue:Q_(n.serializer,r)}}if(t instanceof er){const r=new er(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Q_(n.serializer,r)}}if(t instanceof ZC)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof hu)return{bytesValue:f2(n.serializer,t._byteString)};if(t instanceof Gi){const r=n.databaseId,s=t.firestore._databaseId;if(!s.isEqual(r))throw n._a(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:yM(t.firestore._databaseId||n.databaseId,t._key.path)}}throw n._a(`Unsupported field value: ${YC(t)}`)}(i,e)}function nU(i,e){const t={};return mF(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):cf(i,(n,r)=>{const s=Lp(r,e.ha(n));null!=s&&(t[n]=s)}),{mapValue:{fields:t}}}function iU(i){return!("object"!=typeof i||null===i||i instanceof Array||i instanceof Date||i instanceof er||i instanceof ZC||i instanceof hu||i instanceof Gi||i instanceof Op)}function m1(i,e,t){if(!iU(t)||!function(n){return"object"==typeof n&&null!==n&&(Object.getPrototypeOf(n)===Object.prototype||null===Object.getPrototypeOf(n))}(t)){const n=YC(t);throw e._a("an object"===n?i+" a custom object":i+" "+n)}}function Sw(i,e,t){if((e=(0,bn.m9)(e))instanceof bd)return e._internalPath;if("string"==typeof e)return JC(i,e);throw eS("Field path arguments must be of type string or ",i,!1,void 0,t)}const qz=new RegExp("[~\\*/\\[\\]]");function JC(i,e,t){if(e.search(qz)>=0)throw eS(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new bd(...e.split("."))._internalPath}catch{throw eS(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function eS(i,e,t,n,r){const s=n&&!n.isEmpty(),o=void 0!==r;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let h="";return(s||o)&&(h+=" (found",s&&(h+=` in field ${n}`),o&&(h+=` in document ${r}`),h+=")"),new $e(be.INVALID_ARGUMENT,c+i+h)}function rU(i,e){return i.some(t=>t.isEqual(e))}class Dw{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Gi(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Yz(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(tS("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Yz extends Dw{data(){return super.data()}}function tS(i,e){return"string"==typeof e?JC(i,e):e instanceof bd?e._internalPath:e._delegate._internalPath}function sU(i){if("L"===i.limitType&&0===i.explicitOrderBy.length)throw new $e(be.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class p1{}class Aw extends p1{}function Ef(i,e,...t){let n=[];e instanceof p1&&n.push(e),n=n.concat(t),function(r){const s=r.filter(c=>c instanceof fy).length,o=r.filter(c=>c instanceof kw).length;if(s>1||s>0&&o>0)throw new $e(be.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const r of n)i=r._apply(i);return i}class kw extends Aw{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new kw(e,t,n)}_apply(e){const t=this._parse(e);return cU(e._query,t),new Hs(e.firestore,e.converter,lM(e._query,t))}_parse(e){const t=Pp(e.firestore);return function(r,s,o,c,h,m,g){let y;if(h.isKeyField()){if("array-contains"===m||"array-contains-any"===m)throw new $e(be.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if("in"===m||"not-in"===m){lU(g,m);const E=[];for(const x of g)E.push(aU(c,r,x));y={arrayValue:{values:E}}}else y=aU(c,r,g)}else"in"!==m&&"not-in"!==m&&"array-contains-any"!==m||lU(g,m),y=tU(o,"where",g,"in"===m||"not-in"===m);return Un.create(h,m,y)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class fy extends p1{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new fy(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return 1===t.length?t[0]:fi.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(n,r){let s=n;const o=r.getFlattenedFilters();for(const c of o)cU(s,c),s=lM(s,c)}(e._query,t),new Hs(e.firestore,e.converter,lM(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class g1 extends Aw{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new g1(e,t)}_apply(e){const t=function(n,r,s){if(null!==n.startAt)throw new $e(be.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==n.endAt)throw new $e(be.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new z_(r,s);return function(c,h){if(null===oM(c)){const m=bC(c);null!==m&&uU(0,m,h.field)}}(n,o),o}(e._query,this._field,this._direction);return new Hs(e.firestore,e.converter,function(n,r){const s=n.explicitOrderBy.concat([r]);return new pd(n.path,n.collectionGroup,s,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}(e._query,t))}}class nS extends Aw{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new nS(e,t,n)}_apply(e){return new Hs(e.firestore,e.converter,wC(e._query,this._limit,this._limitType))}}class iS extends Aw{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new iS(e,t,n)}_apply(e){const t=oU(e,this.type,this._docOrFields,this._inclusive);return new Hs(e.firestore,e.converter,function(n,r){return new pd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,r,n.endAt)}(e._query,t))}}class rS extends Aw{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new rS(e,t,n)}_apply(e){const t=oU(e,this.type,this._docOrFields,this._inclusive);return new Hs(e.firestore,e.converter,function(n,r){return new pd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,r)}(e._query,t))}}function oU(i,e,t,n){if(t[0]=(0,bn.m9)(t[0]),t[0]instanceof Dw)return function(r,s,o,c,h){if(!c)throw new $e(be.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const m=[];for(const g of xp(r))if(g.field.isKeyField())m.push(wp(s,c.key));else{const y=c.data.field(g.field);if(fC(y))throw new $e(be.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+g.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===y){const E=g.field.canonicalString();throw new $e(be.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${E}' (used as the orderBy) does not exist.`)}m.push(y)}return new pf(m,h)}(i._query,i.firestore._databaseId,e,t[0]._document,n);{const r=Pp(i.firestore);return function(s,o,c,h,m,g){const y=s.explicitOrderBy;if(m.length>y.length)throw new $e(be.INVALID_ARGUMENT,`Too many arguments provided to ${h}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const E=[];for(let x=0;x<m.length;x++){const S=m[x];if(y[x].field.isKeyField()){if("string"!=typeof S)throw new $e(be.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${h}(), but got a ${typeof S}`);if(!aM(s)&&-1!==S.indexOf("/"))throw new $e(be.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${h}() must be a plain document ID, but '${S}' contains a slash.`);const R=s.path.child(Xn.fromString(S));if(!pt.isDocumentKey(R))throw new $e(be.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${h}() must result in a valid document path, but '${R}' is not because it contains an odd number of segments.`);const L=new pt(R);E.push(wp(o,L))}else{const R=tU(c,h,S);E.push(R)}}return new pf(E,g)}(i._query,i.firestore._databaseId,r,e,t,n)}}function aU(i,e,t){if("string"==typeof(t=(0,bn.m9)(t))){if(""===t)throw new $e(be.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!aM(e)&&-1!==t.indexOf("/"))throw new $e(be.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Xn.fromString(t));if(!pt.isDocumentKey(n))throw new $e(be.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return wp(i,new pt(n))}if(t instanceof Gi)return wp(i,t._key);throw new $e(be.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${YC(t)}.`)}function lU(i,e){if(!Array.isArray(i)||0===i.length)throw new $e(be.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function cU(i,e){if(e.isInequality()){const n=bC(i),r=e.field;if(null!==n&&!n.isEqual(r))throw new $e(be.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${r.toString()}'`);const s=oM(i);null!==s&&uU(0,r,s)}const t=function(n,r){for(const s of n)for(const o of s.getFlattenedFilters())if(r.indexOf(o.op)>=0)return o.op;return null}(i.filters,function(n){switch(n){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new $e(be.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function uU(i,e,t){if(!t.isEqual(e))throw new $e(be.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class _1{convertValue(e,t="none"){switch(ff(e)){case 0:return null;case 1:return e.booleanValue;case 2:return wr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(md(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Ot()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return cf(e,(r,s)=>{n[r]=this.convertValue(s,t)}),n}convertGeoPoint(e){return new ZC(wr(e.latitude),wr(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=mC(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(qb(e));default:return null}}convertTimestamp(e){const t=uf(e);return new er(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Xn.fromString(e);qt(x2(n));const r=new df(n.get(1),n.get(3)),s=new pt(n.popFirst(5));return r.isEqual(t)||kr(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function sS(i,e,t){let n;return n=i?t&&(t.merge||t.mergeFields)?i.toFirestore(e,t):i.toFirestore(e):e,n}class r6 extends _1{constructor(e){super(),this.firestore=e}convertBytes(e){return new hu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Gi(this.firestore,null,t)}}class Np{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class wd extends Dw{constructor(e,t,n,r,s,o){super(e,t,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Rw(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(tS("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Rw extends wd{data(e={}){return super.data(e)}}class xf{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Np(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Rw(this._firestore,this._userDataWriter,n.key,n,new Np(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new $e(be.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(n,r){if(n._snapshot.oldDocs.isEmpty()){let s=0;return n._snapshot.docChanges.map(o=>({type:"added",doc:new Rw(n._firestore,n._userDataWriter,o.doc.key,o.doc,new Np(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter),oldIndex:-1,newIndex:s++}))}{let s=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(o=>r||3!==o.type).map(o=>{const c=new Rw(n._firestore,n._userDataWriter,o.doc.key,o.doc,new Np(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter);let h=-1,m=-1;return 0!==o.type&&(h=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),1!==o.type&&(s=s.add(o.doc),m=s.indexOf(o.doc.key)),{type:o6(o.type),doc:c,oldIndex:h,newIndex:m}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function o6(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ot()}}function hU(i,e){return i instanceof wd&&e instanceof wd?i._firestore===e._firestore&&i._key.isEqual(e._key)&&(null===i._document?null===e._document:i._document.isEqual(e._document))&&i._converter===e._converter:i instanceof xf&&e instanceof xf&&i._firestore===e._firestore&&c1(i.query,e.query)&&i.metadata.isEqual(e.metadata)&&i._snapshot.isEqual(e._snapshot)}class Tf extends _1{constructor(e){super(),this.firestore=e}convertBytes(e){return new hu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Gi(this.firestore,null,t)}}function fU(i,e,t){i=Vn(i,Gi);const n=Vn(i.firestore,zi),r=sS(i.converter,e,t);return my(n,[QC(Pp(n),"setDoc",i._key,r,null!==i.converter,t).toMutation(i._key,tr.none())])}function oS(i,e,t,...n){i=Vn(i,Gi);const r=Vn(i.firestore,zi),s=Pp(r);let o;return o="string"==typeof(e=(0,bn.m9)(e))||e instanceof bd?f1(s,"updateDoc",i._key,e,t,n):h1(s,"updateDoc",i._key,e),my(r,[o.toMutation(i._key,tr.exists(!0))])}function y1(i,...e){var t,n,r;i=(0,bn.m9)(i);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||u1(e[o])||(s=e[o],o++);const c={includeMetadataChanges:s.includeMetadataChanges};if(u1(e[o])){const y=e[o];e[o]=null===(t=y.next)||void 0===t?void 0:t.bind(y),e[o+1]=null===(n=y.error)||void 0===n?void 0:n.bind(y),e[o+2]=null===(r=y.complete)||void 0===r?void 0:r.bind(y)}let h,m,g;if(i instanceof Gi)m=Vn(i.firestore,zi),g=K_(i._key.path),h={next:y=>{e[o]&&e[o](v1(m,i,y))},error:e[o+1],complete:e[o+2]};else{const y=Vn(i,Hs);m=Vn(y.firestore,zi),g=y._query;const E=new Tf(m);h={next:x=>{e[o]&&e[o](new xf(m,E,y,x))},error:e[o+1],complete:e[o+2]},sU(i._query)}return function(y,E,x,S){const R=new zC(S),L=new YM(E,R,x);return y.asyncQueue.enqueueAndForget((0,Ie.Z)(function*(){return WM(yield hy(y),L)})),()=>{R.Dc(),y.asyncQueue.enqueueAndForget((0,Ie.Z)(function*(){return KM(yield hy(y),L)}))}}(Mr(m),g,c,h)}function my(i,e){return function(t,n){const r=new es;return t.asyncQueue.enqueueAndForget((0,Ie.Z)(function*(){return function ez(i,e,t){return(kN=kN||(0,Ie.Z)(function*(n,r,s){const o=n1(n);try{const c=yield function(h,m){const g=yt(h),y=er.now(),E=m.reduce((R,L)=>R.add(L.key),An());let x,S;return g.persistence.runTransaction("Locally write mutations","readwrite",R=>{let L=ra(),G=An();return g.Zi.getEntries(R,E).next(Y=>{L=Y,L.forEach((K,te)=>{te.isValidDocument()||(G=G.add(K))})}).next(()=>g.localDocuments.getOverlayedDocuments(R,L)).next(Y=>{x=Y;const K=[];for(const te of m){const oe=Aj(te,x.get(te.key).overlayedDocument);null!=oe&&K.push(new _d(te.key,oe,xF(oe.value.mapValue),tr.exists(!0)))}return g.mutationQueue.addMutationBatch(R,y,K,m)}).next(Y=>{S=Y;const K=Y.applyToLocalDocumentSet(x,G);return g.documentOverlayCache.saveOverlays(R,Y.batchId,K)})}).then(()=>({batchId:S.batchId,changes:$F(x)}))}(o.localStore,r);o.sharedClientState.addPendingMutation(c.batchId),function(h,m,g){let y=h.Tc[h.currentUser.toKey()];y||(y=new Di(En)),y=y.insert(m,g),h.Tc[h.currentUser.toKey()]=y}(o,c.batchId,s),yield vd(o,c.changes),yield sy(o.remoteStore)}catch(c){const h=ay(c,"Failed to persist write");s.reject(h)}})).apply(this,arguments)}(yield a1(t),n,r)})),r.promise}(Mr(i),e)}function v1(i,e,t){const n=t.docs.get(e._key),r=new Tf(i);return new wd(i,r,e._key,n,new Np(t.hasPendingWrites,t.fromCache),e.converter)}const T6={maxAttempts:5};class mU{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Pp(e)}set(e,t,n){this._verifyNotCommitted();const r=If(e,this._firestore),s=sS(r.converter,t,n),o=QC(this._dataReader,"WriteBatch.set",r._key,s,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,tr.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const s=If(e,this._firestore);let o;return o="string"==typeof(t=(0,bn.m9)(t))||t instanceof bd?f1(this._dataReader,"WriteBatch.update",s._key,t,n,r):h1(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,tr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=If(e,this._firestore);return this._mutations=this._mutations.concat(new X_(t._key,tr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new $e(be.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function If(i,e){if((i=(0,bn.m9)(i)).firestore!==e)throw new $e(be.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return i}class I6 extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Pp(e)}get(e){const t=If(e,this._firestore),n=new r6(this._firestore);return this._transaction.lookup([t._key]).then(r=>{if(!r||1!==r.length)return Ot();const s=r[0];if(s.isFoundDocument())return new Dw(this._firestore,n,s.key,s,t.converter);if(s.isNoDocument())return new Dw(this._firestore,n,t._key,null,t.converter);throw Ot()})}set(e,t,n){const r=If(e,this._firestore),s=sS(r.converter,t,n),o=QC(this._dataReader,"Transaction.set",r._key,s,null!==r.converter,n);return this._transaction.set(r._key,o),this}update(e,t,n,...r){const s=If(e,this._firestore);let o;return o="string"==typeof(t=(0,bn.m9)(t))||t instanceof bd?f1(this._dataReader,"Transaction.update",s._key,t,n,r):h1(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}delete(e){const t=If(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=If(e,this._firestore),n=new Tf(this._firestore);return super.get(e).then(r=>new wd(this._firestore,n,t._key,r._document,new Np(!1,!1),t.converter))}}function xs(i){return null!=i&&"false"!=`${i}`}function py(i,e=0){return function M6(i){return!isNaN(parseFloat(i))&&!isNaN(Number(i))}(i)?Number(i):e}function aS(i){return Array.isArray(i)?i:[i]}function $r(i){return null==i?"":"string"==typeof i?i:`${i}px`}function Fp(i){return i instanceof d.SBq?i.nativeElement:i}!function(i,e=!0){$_=Qi.SDK_VERSION,(0,Qi._registerComponent)(new Xu.wA("firestore",(t,{instanceIdentifier:n,options:r})=>{const s=t.getProvider("app").getImmediate(),o=new zi(new k4(t.getProvider("auth-internal")),new O4(t.getProvider("app-check-internal")),function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new $e(be.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new df(c.options.projectId,h)}(s,n),s);return r=Object.assign({useFetchStreams:e},r),o._setSettings(r),o},"PUBLIC").setMultipleInstances(!0)),(0,Qi.registerVersion)(ZN,"3.13.0",i),(0,Qi.registerVersion)(ZN,"3.13.0","esm2017")}();var O6=z(1144);const P6=["addListener","removeListener"],L6=["addEventListener","removeEventListener"],N6=["on","off"];function Mw(i,e,t,n){if((0,Qs.m)(t)&&(n=t,t=void 0),n)return Mw(i,e,t).pipe(Wr(n));const[r,s]=function U6(i){return(0,Qs.m)(i.addEventListener)&&(0,Qs.m)(i.removeEventListener)}(i)?L6.map(o=>c=>i[o](e,c,t)):function F6(i){return(0,Qs.m)(i.addListener)&&(0,Qs.m)(i.removeListener)}(i)?P6.map(gU(i,e)):function B6(i){return(0,Qs.m)(i.on)&&(0,Qs.m)(i.off)}(i)?N6.map(gU(i,e)):[];if(!r&&(0,O6.z)(i))return(0,Xi.z)(o=>Mw(o,e,t))((0,Xs.Xf)(i));if(!r)throw new TypeError("Invalid event target");return new Zi.y(o=>{const c=(...h)=>o.next(1<h.length?h:h[0]);return r(c),()=>s(c)})}function gU(i,e){return t=>n=>i[t](e,n)}var _U=z(4408);const Ow={schedule(i){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:n}=Ow;n&&(e=n.requestAnimationFrame,t=n.cancelAnimationFrame);const r=e(s=>{t=void 0,i(s)});return new wo.w0(()=>t?.(r))},requestAnimationFrame(...i){const{delegate:e}=Ow;return(e?.requestAnimationFrame||requestAnimationFrame)(...i)},cancelAnimationFrame(...i){const{delegate:e}=Ow;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...i)},delegate:void 0};var yU=z(7565);const H6=new class $6 extends yU.v{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;e=e||n.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=n[0])&&e.id===t&&n.shift());if(this._active=!1,r){for(;(e=n[0])&&e.id===t&&n.shift();)e.unsubscribe();throw r}}}(class V6 extends _U.o{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return null!==n&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e._scheduled||(e._scheduled=Ow.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,n=0){var r;if(null!=n?n>0:this.delay>0)return super.recycleAsyncId(e,t,n);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(Ow.cancelAnimationFrame(t),e._scheduled=void 0)}});let b1,j6=1;const lS={};function vU(i){return i in lS&&(delete lS[i],!0)}const G6={setImmediate(i){const e=j6++;return lS[e]=!0,b1||(b1=Promise.resolve()),b1.then(()=>vU(e)&&i()),e},clearImmediate(i){vU(i)}},{setImmediate:z6,clearImmediate:W6}=G6,cS={setImmediate(...i){const{delegate:e}=cS;return(e?.setImmediate||z6)(...i)},clearImmediate(i){const{delegate:e}=cS;return(e?.clearImmediate||W6)(i)},delegate:void 0},Y6=new class q6 extends yU.v{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;e=e||n.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=n[0])&&e.id===t&&n.shift());if(this._active=!1,r){for(;(e=n[0])&&e.id===t&&n.shift();)e.unsubscribe();throw r}}}(class K6 extends _U.o{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return null!==n&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e._scheduled||(e._scheduled=cS.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,n=0){var r;if(null!=n?n>0:this.delay>0)return super.recycleAsyncId(e,t,n);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(cS.clearImmediate(t),e._scheduled===t&&(e._scheduled=void 0))}});var uS=z(4986),X6=z(3532);function w1(i,e=uS.z){return function Z6(i){return(0,Pi.e)((e,t)=>{let n=!1,r=null,s=null,o=!1;const c=()=>{if(s?.unsubscribe(),s=null,n){n=!1;const m=r;r=null,t.next(m)}o&&t.complete()},h=()=>{s=null,o&&t.complete()};e.subscribe((0,Ci.x)(t,m=>{n=!0,r=m,s||(0,Xs.Xf)(i(m)).subscribe(s=(0,Ci.x)(t,c,h))},()=>{o=!0,(!n||!s||s.closed)&&t.complete()}))})}(()=>function J6(i=0,e,t=uS.P){let n=-1;return null!=e&&((0,X6.K)(e)?t=e:n=e),new Zi.y(r=>{let s=function Q6(i){return i instanceof Date&&!isNaN(i)}(i)?+i-t.now():i;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=n?this.schedule(void 0,n):r.complete())},s)})}(i,e))}var e8=z(5032);function oo(i){return(0,Pi.e)((e,t)=>{(0,Xs.Xf)(i).subscribe((0,Ci.x)(t,()=>t.complete(),e8.Z)),!t.closed&&e.subscribe(t)})}let E1;try{E1=typeof Intl<"u"&&Intl.v8BreakIterator}catch{E1=!1}let Pw,hS,Bp,x1,ao=(()=>{class i{constructor(t){this._platformId=t,this.isBrowser=this._platformId?function Uf(i){return i===gc}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!E1)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(d.Lbi))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function dS(i){return function t8(){if(null==Pw&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Pw=!0}))}finally{Pw=Pw||!1}return Pw}()?i:!!i.capture}function wU(){if(null==Bp){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Bp=!1,Bp;if("scrollBehavior"in document.documentElement.style)Bp=!0;else{const i=Element.prototype.scrollTo;Bp=!!i&&!/\{\s*\[native code\]\s*\}/.test(i.toString())}}return Bp}function Lw(){if("object"!=typeof document||!document)return 0;if(null==hS){const i=document.createElement("div"),e=i.style;i.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const t=document.createElement("div"),n=t.style;n.width="2px",n.height="1px",i.appendChild(t),document.body.appendChild(i),hS=0,0===i.scrollLeft&&(i.scrollLeft=1,hS=0===i.scrollLeft?1:2),i.remove()}return hS}function fS(){let i=typeof document<"u"&&document?document.activeElement:null;for(;i&&i.shadowRoot;){const e=i.shadowRoot.activeElement;if(e===i)break;i=e}return i}function Cf(i){return i.composedPath?i.composedPath()[0]:i.target}function T1(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}const r8=new d.OlP("cdk-dir-doc",{providedIn:"root",factory:function s8(){return(0,d.f3M)(ue)}}),o8=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Up=(()=>{class i{constructor(t){this.value="ltr",this.change=new d.vpe,t&&(this.value=function a8(i){const e=i?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?o8.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(r8,8))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Nw=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({}),i})();const l8=["contentWrapper"],c8=["*"],u8=new d.OlP("VIRTUAL_SCROLL_STRATEGY");let _y=(()=>{class i{constructor(t,n,r){this._ngZone=t,this._platform=n,this._scrolled=new pn.x,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const n=this.scrollContainers.get(t);n&&(n.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new Zi.y(n=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(w1(t)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):St()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(t,n){const r=this.getAncestorScrollContainers(t);return this.scrolled(n).pipe(ti(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const n=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&n.push(s)}),n}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,n){let r=Fp(n),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Mw(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(d.R0b),d.LFG(ao),d.LFG(ue,8))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Vp=(()=>{class i{constructor(t,n,r,s){this.elementRef=t,this.scrollDispatcher=n,this.ngZone=r,this.dir=s,this._destroyed=new pn.x,this._elementScrolled=new Zi.y(o=>this.ngZone.runOutsideAngular(()=>Mw(this.elementRef.nativeElement,"scroll").pipe(oo(this._destroyed)).subscribe(o)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const n=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=r?t.end:t.start),null==t.right&&(t.right=r?t.start:t.end),null!=t.bottom&&(t.top=n.scrollHeight-n.clientHeight-t.bottom),r&&0!=Lw()?(null!=t.left&&(t.right=n.scrollWidth-n.clientWidth-t.left),2==Lw()?t.left=t.right:1==Lw()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=n.scrollWidth-n.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const n=this.elementRef.nativeElement;wU()?n.scrollTo(t):(null!=t.top&&(n.scrollTop=t.top),null!=t.left&&(n.scrollLeft=t.left))}measureScrollOffset(t){const n="left",r="right",s=this.elementRef.nativeElement;if("top"==t)return s.scrollTop;if("bottom"==t)return s.scrollHeight-s.clientHeight-s.scrollTop;const o=this.dir&&"rtl"==this.dir.value;return"start"==t?t=o?r:n:"end"==t&&(t=o?n:r),o&&2==Lw()?t==n?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:o&&1==Lw()?t==n?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:t==n?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(d.SBq),d.Y36(_y),d.Y36(d.R0b),d.Y36(Up,8))},i.\u0275dir=d.lG2({type:i,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0}),i})(),mS=(()=>{class i{constructor(t,n,r){this._platform=t,this._change=new pn.x,this._changeListener=s=>{this._change.next(s)},this._document=r,n.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:n,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+n,height:r,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,n=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||n.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||n.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(w1(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(ao),d.LFG(d.R0b),d.LFG(ue,8))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const EU=new d.OlP("VIRTUAL_SCROLLABLE");let f8=(()=>{class i extends Vp{constructor(t,n,r,s){super(t,n,r,s)}measureViewportSize(t){const n=this.elementRef.nativeElement;return"horizontal"===t?n.clientWidth:n.clientHeight}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(d.SBq),d.Y36(_y),d.Y36(d.R0b),d.Y36(Up,8))},i.\u0275dir=d.lG2({type:i,features:[d.qOj]}),i})();const p8=typeof requestAnimationFrame<"u"?H6:Y6;let g8=(()=>{class i extends f8{get orientation(){return this._orientation}set orientation(t){this._orientation!==t&&(this._orientation=t,this._calculateSpacerSize())}get appendOnly(){return this._appendOnly}set appendOnly(t){this._appendOnly=xs(t)}constructor(t,n,r,s,o,c,h,m){super(t,c,r,o),this.elementRef=t,this._changeDetectorRef=n,this._scrollStrategy=s,this.scrollable=m,this._platform=(0,d.f3M)(ao),this._detachedSubject=new pn.x,this._renderedRangeSubject=new pn.x,this._orientation="vertical",this._appendOnly=!1,this.scrolledIndexChange=new Zi.y(g=>this._scrollStrategy.scrolledIndexChange.subscribe(y=>Promise.resolve().then(()=>this.ngZone.run(()=>g.next(y))))),this.renderedRangeStream=this._renderedRangeSubject,this._totalContentSize=0,this._totalContentWidth="",this._totalContentHeight="",this._renderedRange={start:0,end:0},this._dataLength=0,this._viewportSize=0,this._renderedContentOffset=0,this._renderedContentOffsetNeedsRewrite=!1,this._isChangeDetectionPending=!1,this._runAfterChangeDetection=[],this._viewportChanges=wo.w0.EMPTY,this._viewportChanges=h.change().subscribe(()=>{this.checkViewportSize()}),this.scrollable||(this.elementRef.nativeElement.classList.add("cdk-virtual-scrollable"),this.scrollable=this)}ngOnInit(){this._platform.isBrowser&&(this.scrollable===this&&super.ngOnInit(),this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._measureViewportSize(),this._scrollStrategy.attach(this),this.scrollable.elementScrolled().pipe(Ms(null),w1(0,p8)).subscribe(()=>this._scrollStrategy.onContentScrolled()),this._markChangeDetectionNeeded()})))}ngOnDestroy(){this.detach(),this._scrollStrategy.detach(),this._renderedRangeSubject.complete(),this._detachedSubject.complete(),this._viewportChanges.unsubscribe(),super.ngOnDestroy()}attach(t){this.ngZone.runOutsideAngular(()=>{this._forOf=t,this._forOf.dataStream.pipe(oo(this._detachedSubject)).subscribe(n=>{const r=n.length;r!==this._dataLength&&(this._dataLength=r,this._scrollStrategy.onDataLengthChanged()),this._doChangeDetection()})})}detach(){this._forOf=null,this._detachedSubject.next()}getDataLength(){return this._dataLength}getViewportSize(){return this._viewportSize}getRenderedRange(){return this._renderedRange}measureBoundingClientRectWithScrollOffset(t){return this.getElementRef().nativeElement.getBoundingClientRect()[t]}setTotalContentSize(t){this._totalContentSize!==t&&(this._totalContentSize=t,this._calculateSpacerSize(),this._markChangeDetectionNeeded())}setRenderedRange(t){(function m8(i,e){return i.start==e.start&&i.end==e.end})(this._renderedRange,t)||(this.appendOnly&&(t={start:0,end:Math.max(this._renderedRange.end,t.end)}),this._renderedRangeSubject.next(this._renderedRange=t),this._markChangeDetectionNeeded(()=>this._scrollStrategy.onContentRendered()))}getOffsetToRenderedContentStart(){return this._renderedContentOffsetNeedsRewrite?null:this._renderedContentOffset}setRenderedContentOffset(t,n="to-start"){t=this.appendOnly&&"to-start"===n?0:t;const s="horizontal"==this.orientation,o=s?"X":"Y";let h=`translate${o}(${Number((s&&this.dir&&"rtl"==this.dir.value?-1:1)*t)}px)`;this._renderedContentOffset=t,"to-end"===n&&(h+=` translate${o}(-100%)`,this._renderedContentOffsetNeedsRewrite=!0),this._renderedContentTransform!=h&&(this._renderedContentTransform=h,this._markChangeDetectionNeeded(()=>{this._renderedContentOffsetNeedsRewrite?(this._renderedContentOffset-=this.measureRenderedContentSize(),this._renderedContentOffsetNeedsRewrite=!1,this.setRenderedContentOffset(this._renderedContentOffset)):this._scrollStrategy.onRenderedOffsetChanged()}))}scrollToOffset(t,n="auto"){const r={behavior:n};"horizontal"===this.orientation?r.start=t:r.top=t,this.scrollable.scrollTo(r)}scrollToIndex(t,n="auto"){this._scrollStrategy.scrollToIndex(t,n)}measureScrollOffset(t){let n;return n=this.scrollable==this?r=>super.measureScrollOffset(r):r=>this.scrollable.measureScrollOffset(r),Math.max(0,n(t??("horizontal"===this.orientation?"start":"top"))-this.measureViewportOffset())}measureViewportOffset(t){let n;const r="left",s="right",o="rtl"==this.dir?.value;n="start"==t?o?s:r:"end"==t?o?r:s:t||("horizontal"===this.orientation?"left":"top");const c=this.scrollable.measureBoundingClientRectWithScrollOffset(n);return this.elementRef.nativeElement.getBoundingClientRect()[n]-c}measureRenderedContentSize(){const t=this._contentWrapper.nativeElement;return"horizontal"===this.orientation?t.offsetWidth:t.offsetHeight}measureRangeSize(t){return this._forOf?this._forOf.measureRangeSize(t,this.orientation):0}checkViewportSize(){this._measureViewportSize(),this._scrollStrategy.onDataLengthChanged()}_measureViewportSize(){this._viewportSize=this.scrollable.measureViewportSize(this.orientation)}_markChangeDetectionNeeded(t){t&&this._runAfterChangeDetection.push(t),this._isChangeDetectionPending||(this._isChangeDetectionPending=!0,this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._doChangeDetection()})))}_doChangeDetection(){this._isChangeDetectionPending=!1,this._contentWrapper.nativeElement.style.transform=this._renderedContentTransform,this.ngZone.run(()=>this._changeDetectorRef.markForCheck());const t=this._runAfterChangeDetection;this._runAfterChangeDetection=[];for(const n of t)n()}_calculateSpacerSize(){this._totalContentHeight="horizontal"===this.orientation?"":`${this._totalContentSize}px`,this._totalContentWidth="horizontal"===this.orientation?`${this._totalContentSize}px`:""}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(d.SBq),d.Y36(d.sBO),d.Y36(d.R0b),d.Y36(u8,8),d.Y36(Up,8),d.Y36(_y),d.Y36(mS),d.Y36(EU,8))},i.\u0275cmp=d.Xpm({type:i,selectors:[["cdk-virtual-scroll-viewport"]],viewQuery:function(t,n){if(1&t&&d.Gf(l8,7),2&t){let r;d.iGM(r=d.CRH())&&(n._contentWrapper=r.first)}},hostAttrs:[1,"cdk-virtual-scroll-viewport"],hostVars:4,hostBindings:function(t,n){2&t&&d.ekj("cdk-virtual-scroll-orientation-horizontal","horizontal"===n.orientation)("cdk-virtual-scroll-orientation-vertical","horizontal"!==n.orientation)},inputs:{orientation:"orientation",appendOnly:"appendOnly"},outputs:{scrolledIndexChange:"scrolledIndexChange"},standalone:!0,features:[d._Bn([{provide:Vp,useFactory:(e,t)=>e||t,deps:[[new d.FiY,new d.tBr(EU)],i]}]),d.qOj,d.jDz],ngContentSelectors:c8,decls:4,vars:4,consts:[[1,"cdk-virtual-scroll-content-wrapper"],["contentWrapper",""],[1,"cdk-virtual-scroll-spacer"]],template:function(t,n){1&t&&(d.F$t(),d.TgZ(0,"div",0,1),d.Hsn(2),d.qZA(),d._UZ(3,"div",2)),2&t&&(d.xp6(3),d.Udp("width",n._totalContentWidth)("height",n._totalContentHeight))},styles:["cdk-virtual-scroll-viewport{display:block;position:relative;transform:translateZ(0)}.cdk-virtual-scrollable{overflow:auto;will-change:scroll-position;contain:strict;-webkit-overflow-scrolling:touch}.cdk-virtual-scroll-content-wrapper{position:absolute;top:0;left:0;contain:content}[dir=rtl] .cdk-virtual-scroll-content-wrapper{right:0;left:auto}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper{min-height:100%}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-left:0;padding-right:0;margin-left:0;margin-right:0;border-left-width:0;border-right-width:0;outline:none}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper{min-width:100%}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;border-top-width:0;border-bottom-width:0;outline:none}.cdk-virtual-scroll-spacer{height:1px;transform-origin:0 0;flex:0 0 auto}[dir=rtl] .cdk-virtual-scroll-spacer{transform-origin:100% 0}"],encapsulation:2,changeDetection:0}),i})(),pS=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({}),i})(),xU=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({imports:[Nw,pS,g8,Nw,pS]}),i})();class I1{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class C1 extends I1{constructor(e,t,n,r,s){super(),this.component=e,this.viewContainerRef=t,this.injector=n,this.componentFactoryResolver=r,this.projectableNodes=s}}class TU extends I1{constructor(e,t,n,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=n,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class _8 extends I1{constructor(e){super(),this.element=e instanceof d.SBq?e.nativeElement:e}}class S1{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof C1?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof TU?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof _8?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class y8 extends S1{constructor(e,t,n,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=n,this._defaultInjector=r,this.attachDomPortal=o=>{const c=o.element,h=this._document.createComment("dom-portal");c.parentNode.insertBefore(h,c),this.outletElement.appendChild(c),this._attachedPortal=o,super.setDisposeFn(()=>{h.parentNode&&h.parentNode.replaceChild(c,h)})},this._document=s}attachComponentPortal(e){const n=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(n,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=n.create(e.injector||this._defaultInjector||d.zs3.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,n=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return n.rootNodes.forEach(r=>this.outletElement.appendChild(r)),n.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(n);-1!==r&&t.remove(r)}),this._attachedPortal=e,n}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let D1=(()=>{class i extends S1{constructor(t,n,r){super(),this._componentFactoryResolver=t,this._viewContainerRef=n,this._isInitialized=!1,this.attached=new d.vpe,this.attachDomPortal=s=>{const o=s.element,c=this._document.createComment("dom-portal");s.setAttachedHost(this),o.parentNode.insertBefore(c,o),this._getRootNode().appendChild(o),this._attachedPortal=s,super.setDisposeFn(()=>{c.parentNode&&c.parentNode.replaceChild(o,c)})},this._document=r}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(t){t.setAttachedHost(this);const n=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,s=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),o=n.createComponent(s,n.length,t.injector||n.injector,t.projectableNodes||void 0);return n!==this._viewContainerRef&&this._getRootNode().appendChild(o.hostView.rootNodes[0]),super.setDisposeFn(()=>o.destroy()),this._attachedPortal=t,this._attachedRef=o,this.attached.emit(o),o}attachTemplatePortal(t){t.setAttachedHost(this);const n=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=n,this.attached.emit(n),n}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(d._Vd),d.Y36(d.s_b),d.Y36(ue))},i.\u0275dir=d.lG2({type:i,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[d.qOj]}),i})(),gS=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({}),i})();const IU=wU();class v8{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=$r(-this._previousScrollPosition.left),e.style.top=$r(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,n=e.style,r=this._document.body.style,s=n.scrollBehavior||"",o=r.scrollBehavior||"";this._isEnabled=!1,n.left=this._previousHTMLStyles.left,n.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),IU&&(n.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),IU&&(n.scrollBehavior=s,r.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,n=this._viewportRuler.getViewportSize();return t.scrollHeight>n.height||t.scrollWidth>n.width}}class b8{constructor(e,t,n,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=n,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0).pipe(ti(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class CU{enable(){}disable(){}attach(){}}function A1(i,e){return e.some(t=>i.bottom<t.top||i.top>t.bottom||i.right<t.left||i.left>t.right)}function SU(i,e){return e.some(t=>i.top<t.top||i.bottom>t.bottom||i.left<t.left||i.right>t.right)}class w8{constructor(e,t,n,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=n,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:n,height:r}=this._viewportRuler.getViewportSize();A1(t,[{width:n,height:r,bottom:r,right:n,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let E8=(()=>{class i{constructor(t,n,r,s){this._scrollDispatcher=t,this._viewportRuler=n,this._ngZone=r,this.noop=()=>new CU,this.close=o=>new b8(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new v8(this._viewportRuler,this._document),this.reposition=o=>new w8(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(_y),d.LFG(mS),d.LFG(d.R0b),d.LFG(ue))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class DU{constructor(e){if(this.scrollStrategy=new CU,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const n of t)void 0!==e[n]&&(this[n]=e[n])}}}class x8{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let AU=(()=>{class i{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const n=this._attachedOverlays.indexOf(t);n>-1&&this._attachedOverlays.splice(n,1),0===this._attachedOverlays.length&&this.detach()}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(ue))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),T8=(()=>{class i extends AU{constructor(t,n){super(t),this._ngZone=n,this._keydownListener=r=>{const s=this._attachedOverlays;for(let o=s.length-1;o>-1;o--)if(s[o]._keydownEvents.observers.length>0){const c=s[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>c.next(r)):c.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(ue),d.LFG(d.R0b,8))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),I8=(()=>{class i extends AU{constructor(t,n,r){super(t),this._platform=n,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=Cf(s)},this._clickListener=s=>{const o=Cf(s),c="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;const h=this._attachedOverlays.slice();for(let m=h.length-1;m>-1;m--){const g=h[m];if(g._outsidePointerEvents.observers.length<1||!g.hasAttached())continue;if(g.overlayElement.contains(o)||g.overlayElement.contains(c))break;const y=g._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>y.next(s)):y.next(s)}}}add(t){if(super.add(t),!this._isAttached){const n=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(n)):this._addEventListeners(n),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=n.style.cursor,n.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(ue),d.LFG(ao),d.LFG(d.R0b,8))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),_S=(()=>{class i{constructor(t,n){this._platform=n,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||T1()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const n=this._document.createElement("div");n.classList.add(t),T1()?n.setAttribute("platform","test"):this._platform.isBrowser||n.setAttribute("platform","server"),this._document.body.appendChild(n),this._containerElement=n}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(ue),d.LFG(ao))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class Fw{constructor(e,t,n,r,s,o,c,h,m,g=!1){this._portalOutlet=e,this._host=t,this._pane=n,this._config=r,this._ngZone=s,this._keyboardDispatcher=o,this._document=c,this._location=h,this._outsideClickDispatcher=m,this._animationsDisabled=g,this._backdropElement=null,this._backdropClick=new pn.x,this._attachments=new pn.x,this._detachments=new pn.x,this._locationChanges=wo.w0.EMPTY,this._backdropClickHandler=y=>this._backdropClick.next(y),this._backdropTransitionendHandler=y=>{this._disposeBackdrop(y.target)},this._keydownEvents=new pn.x,this._outsidePointerEvents=new pn.x,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(qr(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config={...this._config,...e},this._updateElementSize()}setDirection(e){this._config={...this._config,direction:e},this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=$r(this._config.width),e.height=$r(this._config.height),e.minWidth=$r(this._config.minWidth),e.minHeight=$r(this._config.minHeight),e.maxWidth=$r(this._config.maxWidth),e.maxHeight=$r(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const e=this._backdropElement;if(e){if(this._animationsDisabled)return void this._disposeBackdrop(e);e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,n){const r=aS(t||[]).filter(s=>!!s);r.length&&(n?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.pipe(oo((0,Qu.T)(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const kU="cdk-overlay-connected-position-bounding-box",C8=/([A-Za-z%]+)$/;class S8{get positions(){return this._preferredPositions}constructor(e,t,n,r,s){this._viewportRuler=t,this._document=n,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new pn.x,this._resizeSubscription=wo.w0.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._validatePositions(),e.hostElement.classList.add(kU),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,t=this._overlayRect,n=this._viewportRect,r=this._containerRect,s=[];let o;for(let c of this._preferredPositions){let h=this._getOriginPoint(e,r,c),m=this._getOverlayPoint(h,t,c),g=this._getOverlayFit(m,t,n,c);if(g.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(c,h);this._canFitWithFlexibleDimensions(g,m,n)?s.push({position:c,origin:h,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(h,c)}):(!o||o.overlayFit.visibleArea<g.visibleArea)&&(o={overlayFit:g,overlayPoint:m,originPoint:h,position:c,overlayRect:t})}if(s.length){let c=null,h=-1;for(const m of s){const g=m.boundingBoxRect.width*m.boundingBoxRect.height*(m.position.weight||1);g>h&&(h=g,c=m)}return this._isPushed=!1,void this._applyPosition(c.position,c.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(o.position,o.originPoint);this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&$p(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(kU),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,n){let r,s;if("center"==n.originX)r=e.left+e.width/2;else{const o=this._isRtl()?e.right:e.left,c=this._isRtl()?e.left:e.right;r="start"==n.originX?o:c}return t.left<0&&(r-=t.left),s="center"==n.originY?e.top+e.height/2:"top"==n.originY?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,n){let r,s;return r="center"==n.overlayX?-t.width/2:"start"===n.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==n.overlayY?-t.height/2:"top"==n.overlayY?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,n,r){const s=MU(t);let{x:o,y:c}=e,h=this._getOffset(r,"x"),m=this._getOffset(r,"y");h&&(o+=h),m&&(c+=m);let E=0-c,x=c+s.height-n.height,S=this._subtractOverflows(s.width,0-o,o+s.width-n.width),R=this._subtractOverflows(s.height,E,x),L=S*R;return{visibleArea:L,isCompletelyWithinViewport:s.width*s.height===L,fitsInViewportVertically:R===s.height,fitsInViewportHorizontally:S==s.width}}_canFitWithFlexibleDimensions(e,t,n){if(this._hasFlexibleDimensions){const r=n.bottom-t.y,s=n.right-t.x,o=RU(this._overlayRef.getConfig().minHeight),c=RU(this._overlayRef.getConfig().minWidth);return(e.fitsInViewportVertically||null!=o&&o<=r)&&(e.fitsInViewportHorizontally||null!=c&&c<=s)}return!1}_pushOverlayOnScreen(e,t,n){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=MU(t),s=this._viewportRect,o=Math.max(e.x+r.width-s.width,0),c=Math.max(e.y+r.height-s.height,0),h=Math.max(s.top-n.top-e.y,0),m=Math.max(s.left-n.left-e.x,0);let g=0,y=0;return g=r.width<=s.width?m||-o:e.x<this._viewportMargin?s.left-n.left-e.x:0,y=r.height<=s.height?h||-c:e.y<this._viewportMargin?s.top-n.top-e.y:0,this._previousPushAmount={x:g,y},{x:e.x+g,y:e.y+y}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){const n=this._getScrollVisibility(),r=new x8(e,n);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let n,r=e.overlayY;n="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${n} ${r}`}_calculateBoundingBoxRect(e,t){const n=this._viewportRect,r=this._isRtl();let s,o,c,g,y,E;if("top"===t.overlayY)o=e.y,s=n.height-o+this._viewportMargin;else if("bottom"===t.overlayY)c=n.height-e.y+2*this._viewportMargin,s=n.height-c+this._viewportMargin;else{const x=Math.min(n.bottom-e.y+n.top,e.y),S=this._lastBoundingBoxSize.height;s=2*x,o=e.y-x,s>S&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-S/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)E=n.width-e.x+this._viewportMargin,g=e.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)y=e.x,g=n.right-e.x;else{const x=Math.min(n.right-e.x+n.left,e.x),S=this._lastBoundingBoxSize.width;g=2*x,y=e.x-x,g>S&&!this._isInitialRender&&!this._growAfterOpen&&(y=e.x-S/2)}return{top:o,left:y,bottom:c,right:E,width:g,height:s}}_setBoundingBoxStyles(e,t){const n=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=$r(n.height),r.top=$r(n.top),r.bottom=$r(n.bottom),r.width=$r(n.width),r.left=$r(n.left),r.right=$r(n.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=$r(s)),o&&(r.maxWidth=$r(o))}this._lastBoundingBoxSize=n,$p(this._boundingBox.style,r)}_resetBoundingBoxStyles(){$p(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){$p(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const n={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){const g=this._viewportRuler.getViewportScrollPosition();$p(n,this._getExactOverlayY(t,e,g)),$p(n,this._getExactOverlayX(t,e,g))}else n.position="static";let c="",h=this._getOffset(t,"x"),m=this._getOffset(t,"y");h&&(c+=`translateX(${h}px) `),m&&(c+=`translateY(${m}px)`),n.transform=c.trim(),o.maxHeight&&(r?n.maxHeight=$r(o.maxHeight):s&&(n.maxHeight="")),o.maxWidth&&(r?n.maxWidth=$r(o.maxWidth):s&&(n.maxWidth="")),$p(this._pane.style,n)}_getExactOverlayY(e,t,n){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,n)),"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=$r(s.y),r}_getExactOverlayX(e,t,n){let o,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,n)),o=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===o?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=$r(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),n=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:SU(e,n),isOriginOutsideView:A1(e,n),isOverlayClipped:SU(t,n),isOverlayOutsideView:A1(t,n)}}_subtractOverflows(e,...t){return t.reduce((n,r)=>n-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+e-this._viewportMargin,bottom:n.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&aS(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof d.SBq)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,n=e.height||0;return{top:e.y,bottom:e.y+n,left:e.x,right:e.x+t,height:n,width:t}}}function $p(i,e){for(let t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i}function RU(i){if("number"!=typeof i&&null!=i){const[e,t]=i.split(C8);return t&&"px"!==t?null:parseFloat(e)}return i||null}function MU(i){return{top:Math.floor(i.top),right:Math.floor(i.right),bottom:Math.floor(i.bottom),left:Math.floor(i.left),width:Math.floor(i.width),height:Math.floor(i.height)}}const OU="cdk-global-overlay-wrapper";class D8{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(OU),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:o,maxHeight:c}=n,h=!("100%"!==r&&"100vw"!==r||o&&"100%"!==o&&"100vw"!==o),m=!("100%"!==s&&"100vh"!==s||c&&"100%"!==c&&"100vh"!==c),g=this._xPosition,y=this._xOffset,E="rtl"===this._overlayRef.getConfig().direction;let x="",S="",R="";h?R="flex-start":"center"===g?(R="center",E?S=y:x=y):E?"left"===g||"end"===g?(R="flex-end",x=y):("right"===g||"start"===g)&&(R="flex-start",S=y):"left"===g||"start"===g?(R="flex-start",x=y):("right"===g||"end"===g)&&(R="flex-end",S=y),e.position=this._cssPosition,e.marginLeft=h?"0":x,e.marginTop=m?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=h?"0":S,t.justifyContent=R,t.alignItems=m?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,n=t.style;t.classList.remove(OU),n.justifyContent=n.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let A8=(()=>{class i{constructor(t,n,r,s){this._viewportRuler=t,this._document=n,this._platform=r,this._overlayContainer=s}global(){return new D8}flexibleConnectedTo(t){return new S8(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(mS),d.LFG(ue),d.LFG(ao),d.LFG(_S))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),k8=0,yy=(()=>{class i{constructor(t,n,r,s,o,c,h,m,g,y,E,x){this.scrollStrategies=t,this._overlayContainer=n,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=c,this._ngZone=h,this._document=m,this._directionality=g,this._location=y,this._outsideClickDispatcher=E,this._animationsModuleType=x}create(t){const n=this._createHostElement(),r=this._createPaneElement(n),s=this._createPortalOutlet(r),o=new DU(t);return o.direction=o.direction||this._directionality.value,new Fw(s,n,r,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const n=this._document.createElement("div");return n.id="cdk-overlay-"+k8++,n.classList.add("cdk-overlay-pane"),t.appendChild(n),n}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(d.z2F)),new y8(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(E8),d.LFG(_S),d.LFG(d._Vd),d.LFG(A8),d.LFG(T8),d.LFG(d.zs3),d.LFG(d.R0b),d.LFG(ue),d.LFG(Up),d.LFG(it),d.LFG(I8),d.LFG(d.QbO,8))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const O8={provide:new d.OlP("cdk-connected-overlay-scroll-strategy"),deps:[yy],useFactory:function M8(i){return()=>i.scrollStrategies.reposition()}};let PU=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({providers:[yy,O8],imports:[Nw,gS,xU,xU]}),i})();function Bw(i,...e){return e.length?e.some(t=>i[t]):i.altKey||i.shiftKey||i.ctrlKey||i.metaKey}function yS(i,e=uS.z){return(0,Pi.e)((t,n)=>{let r=null,s=null,o=null;const c=()=>{if(r){r.unsubscribe(),r=null;const m=s;s=null,n.next(m)}};function h(){const m=o+i,g=e.now();if(g<m)return r=this.schedule(void 0,m-g),void n.add(r);c()}t.subscribe((0,Ci.x)(n,m=>{s=m,o=e.now(),r||(r=e.schedule(h,i),n.add(r))},()=>{c(),n.complete()},void 0,()=>{s=r=null}))})}function NU(i){return ti((e,t)=>i<=t)}function R1(i,e=jl.y){return i=i??J8,(0,Pi.e)((t,n)=>{let r,s=!0;t.subscribe((0,Ci.x)(n,o=>{const c=e(o);(s||!i(r,c))&&(s=!1,r=c,n.next(o))}))})}function J8(i,e){return i===e}let FU=(()=>{class i{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),BU=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({providers:[FU]}),i})();const UU=new Set;let vy,VU=(()=>{class i{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):r5}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function n5(i){if(!UU.has(i))try{vy||(vy=document.createElement("style"),vy.setAttribute("type","text/css"),document.head.appendChild(vy)),vy.sheet&&(vy.sheet.insertRule(`@media ${i} {body{ }}`,0),UU.add(i))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(ao))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function r5(i){return{matches:"all"===i||""===i,media:i,addListener:()=>{},removeListener:()=>{}}}let M1=(()=>{class i{constructor(t,n){this._mediaMatcher=t,this._zone=n,this._queries=new Map,this._destroySubject=new pn.x}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return $U(aS(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){const r=$U(aS(t)).map(o=>this._registerQuery(o).observable);let s=lh(r);return s=Bc(s.pipe(qr(1)),s.pipe(NU(1),yS(0))),s.pipe((0,wt.U)(o=>{const c={matches:!1,breakpoints:{}};return o.forEach(({matches:h,query:m})=>{c.matches=c.matches||h,c.breakpoints[m]=h}),c}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const n=this._mediaMatcher.matchMedia(t),s={observable:new Zi.y(o=>{const c=h=>this._zone.run(()=>o.next(h));return n.addListener(c),()=>{n.removeListener(c)}}).pipe(Ms(n),(0,wt.U)(({matches:o})=>({query:t,matches:o})),oo(this._destroySubject)),mql:n};return this._queries.set(t,s),s}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(VU),d.LFG(d.R0b))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function $U(i){return i.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}const vS_Small="(min-width: 600px) and (max-width: 959.98px)",vS_Handset="(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)";let Uw=(()=>{class i{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function u5(i){return!!(i.offsetWidth||i.offsetHeight||"function"==typeof i.getClientRects&&i.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const n=function c5(i){try{return i.frameElement}catch{return null}}(function y5(i){return i.ownerDocument&&i.ownerDocument.defaultView||window}(t));if(n&&(-1===zU(n)||!this.isVisible(n)))return!1;let r=t.nodeName.toLowerCase(),s=zU(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function g5(i){let e=i.nodeName.toLowerCase(),t="input"===e&&i.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,n){return function _5(i){return!function h5(i){return function m5(i){return"input"==i.nodeName.toLowerCase()}(i)&&"hidden"==i.type}(i)&&(function d5(i){let e=i.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(i)||function f5(i){return function p5(i){return"a"==i.nodeName.toLowerCase()}(i)&&i.hasAttribute("href")}(i)||i.hasAttribute("contenteditable")||GU(i))}(t)&&!this.isDisabled(t)&&(n?.ignoreVisibility||this.isVisible(t))}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(ao))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function GU(i){if(!i.hasAttribute("tabindex")||void 0===i.tabIndex)return!1;let e=i.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function zU(i){if(!GU(i))return null;const e=parseInt(i.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class v5{get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}constructor(e,t,n,r,s=!1){this._element=e,this._checker=t,this._ngZone=n,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){const t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const n=this._getFirstTabbableElement(t);return n?.focus(e),!!n}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let n=0;n<t.length;n++){const r=t[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[n]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let n=t.length-1;n>=0;n--){const r=t[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[n]):null;if(r)return r}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(qr(1)).subscribe(e)}}let bS=(()=>{class i{constructor(t,n,r){this._checker=t,this._ngZone=n,this._document=r}create(t,n=!1){return new v5(t,this._checker,this._ngZone,this._document,n)}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(Uw),d.LFG(d.R0b),d.LFG(ue))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function WU(i){return 0===i.buttons||0===i.offsetX&&0===i.offsetY}function KU(i){const e=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const b5=new d.OlP("cdk-input-modality-detector-options"),w5={ignoreKeys:[18,17,224,91,16]},by=dS({passive:!0,capture:!0});let E5=(()=>{class i{get mostRecentModality(){return this._modality.value}constructor(t,n,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new ps(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(c=>c===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Cf(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(WU(o)?"keyboard":"mouse"),this._mostRecentTarget=Cf(o))},this._onTouchstart=o=>{KU(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Cf(o))},this._options={...w5,...s},this.modalityDetected=this._modality.pipe(NU(1)),this.modalityChanged=this.modalityDetected.pipe(R1()),t.isBrowser&&n.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,by),r.addEventListener("mousedown",this._onMousedown,by),r.addEventListener("touchstart",this._onTouchstart,by)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,by),document.removeEventListener("mousedown",this._onMousedown,by),document.removeEventListener("touchstart",this._onTouchstart,by))}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(ao),d.LFG(d.R0b),d.LFG(ue),d.LFG(b5,8))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const T5=new d.OlP("cdk-focus-monitor-default-options"),wS=dS({passive:!0,capture:!0});let Vw=(()=>{class i{constructor(t,n,r,s,o){this._ngZone=t,this._platform=n,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new pn.x,this._rootNodeFocusAndBlurListener=c=>{for(let m=Cf(c);m;m=m.parentElement)"focus"===c.type?this._onFocus(c,m):this._onBlur(c,m)},this._document=s,this._detectionMode=o?.detectionMode||0}monitor(t,n=!1){const r=Fp(t);if(!this._platform.isBrowser||1!==r.nodeType)return St(null);const s=function i8(i){if(function n8(){if(null==x1){const i=typeof document<"u"?document.head:null;x1=!(!i||!i.createShadowRoot&&!i.attachShadow)}return x1}()){const e=i.getRootNode?i.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return n&&(o.checkChildren=!0),o.subject;const c={checkChildren:n,subject:new pn.x,rootNode:s};return this._elementInfo.set(r,c),this._registerGlobalListeners(c),c.subject}stopMonitoring(t){const n=Fp(t),r=this._elementInfo.get(n);r&&(r.subject.complete(),this._setClasses(n),this._elementInfo.delete(n),this._removeGlobalListeners(r))}focusVia(t,n,r){const s=Fp(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([c,h])=>this._originChanged(c,n,h)):(this._setOrigin(n),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,n)=>this.stopMonitoring(n))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,n){t.classList.toggle("cdk-focused",!!n),t.classList.toggle("cdk-touch-focused","touch"===n),t.classList.toggle("cdk-keyboard-focused","keyboard"===n),t.classList.toggle("cdk-mouse-focused","mouse"===n),t.classList.toggle("cdk-program-focused","program"===n)}_setOrigin(t,n=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&n,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,n){const r=this._elementInfo.get(n),s=Cf(t);!r||!r.checkChildren&&n!==s||this._originChanged(n,this._getFocusOrigin(s),r)}_onBlur(t,n){const r=this._elementInfo.get(n);!r||r.checkChildren&&t.relatedTarget instanceof Node&&n.contains(t.relatedTarget)||(this._setClasses(n),this._emitOrigin(r,null))}_emitOrigin(t,n){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(n))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const n=t.rootNode,r=this._rootNodeFocusListenerCount.get(n)||0;r||this._ngZone.runOutsideAngular(()=>{n.addEventListener("focus",this._rootNodeFocusAndBlurListener,wS),n.addEventListener("blur",this._rootNodeFocusAndBlurListener,wS)}),this._rootNodeFocusListenerCount.set(n,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(oo(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const n=t.rootNode;if(this._rootNodeFocusListenerCount.has(n)){const r=this._rootNodeFocusListenerCount.get(n);r>1?this._rootNodeFocusListenerCount.set(n,r-1):(n.removeEventListener("focus",this._rootNodeFocusAndBlurListener,wS),n.removeEventListener("blur",this._rootNodeFocusAndBlurListener,wS),this._rootNodeFocusListenerCount.delete(n))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,n,r){this._setClasses(t,n),this._emitOrigin(r,n),this._lastFocusOrigin=n}_getClosestElementsInfo(t){const n=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&n.push([s,r])}),n}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:n,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!n||n===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const s=t.labels;if(s)for(let o=0;o<s.length;o++)if(s[o].contains(n))return!0;return!1}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(d.R0b),d.LFG(ao),d.LFG(E5),d.LFG(ue,8),d.LFG(T5,8))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const YU="cdk-high-contrast-black-on-white",ZU="cdk-high-contrast-white-on-black",O1="cdk-high-contrast-active";let XU=(()=>{class i{constructor(t,n){this._platform=t,this._document=n,this._breakpointSubscription=(0,d.f3M)(M1).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const n=this._document.defaultView||window,r=n&&n.getComputedStyle?n.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(O1,YU,ZU),this._hasCheckedHighContrastMode=!0;const n=this.getHighContrastMode();1===n?t.add(O1,YU):2===n&&t.add(O1,ZU)}}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(ao),d.LFG(ue))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),I5=(()=>{class i{constructor(t){t._applyBodyHighContrastModeCssClasses()}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(XU))},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({imports:[BU]}),i})();function C5(i,e){}class ES{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0,this.closeOnOverlayDetachments=!0}}let QU=(()=>{class i extends S1{constructor(t,n,r,s,o,c,h,m){super(),this._elementRef=t,this._focusTrapFactory=n,this._config=s,this._interactivityChecker=o,this._ngZone=c,this._overlayRef=h,this._focusMonitor=m,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this.attachDomPortal=g=>{this._portalOutlet.hasAttached();const y=this._portalOutlet.attachDomPortal(g);return this._contentAttached(),y},this._ariaLabelledBy=this._config.ariaLabelledBy||null,this._document=r}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._restoreFocus()}attachComponentPortal(t){this._portalOutlet.hasAttached();const n=this._portalOutlet.attachComponentPortal(t);return this._contentAttached(),n}attachTemplatePortal(t){this._portalOutlet.hasAttached();const n=this._portalOutlet.attachTemplatePortal(t);return this._contentAttached(),n}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(t,n){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{t.removeEventListener("blur",r),t.removeEventListener("mousedown",r),t.removeAttribute("tabindex")};t.addEventListener("blur",r),t.addEventListener("mousedown",r)})),t.focus(n)}_focusByCssSelector(t,n){let r=this._elementRef.nativeElement.querySelector(t);r&&this._forceFocus(r,n)}_trapFocus(){const t=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||t.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(n=>{n||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const t=this._config.restoreFocus;let n=null;if("string"==typeof t?n=this._document.querySelector(t):"boolean"==typeof t?n=t?this._elementFocusedBeforeDialogWasOpened:null:t&&(n=t),this._config.restoreFocus&&n&&"function"==typeof n.focus){const r=fS(),s=this._elementRef.nativeElement;(!r||r===this._document.body||r===s||s.contains(r))&&(this._focusMonitor?(this._focusMonitor.focusVia(n,this._closeInteractionType),this._closeInteractionType=null):n.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const t=this._elementRef.nativeElement,n=fS();return t===n||t.contains(n)}_initializeFocusTrap(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=fS())}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(d.SBq),d.Y36(bS),d.Y36(ue,8),d.Y36(ES),d.Y36(Uw),d.Y36(d.R0b),d.Y36(Fw),d.Y36(Vw))},i.\u0275cmp=d.Xpm({type:i,selectors:[["cdk-dialog-container"]],viewQuery:function(t,n){if(1&t&&d.Gf(D1,7),2&t){let r;d.iGM(r=d.CRH())&&(n._portalOutlet=r.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(t,n){2&t&&d.uIk("id",n._config.id||null)("role",n._config.role)("aria-modal",n._config.ariaModal)("aria-labelledby",n._config.ariaLabel?null:n._ariaLabelledBy)("aria-label",n._config.ariaLabel)("aria-describedby",n._config.ariaDescribedBy||null)},features:[d.qOj],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(t,n){1&t&&d.YNc(0,C5,0,0,"ng-template",0)},dependencies:[D1],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2}),i})();class P1{constructor(e,t){this.overlayRef=e,this.config=t,this.closed=new pn.x,this.disableClose=t.disableClose,this.backdropClick=e.backdropClick(),this.keydownEvents=e.keydownEvents(),this.outsidePointerEvents=e.outsidePointerEvents(),this.id=t.id,this.keydownEvents.subscribe(n=>{27===n.keyCode&&!this.disableClose&&!Bw(n)&&(n.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=e.detachments().subscribe(()=>{!1!==t.closeOnOverlayDetachments&&this.close()})}close(e,t){if(this.containerInstance){const n=this.closed;this.containerInstance._closeInteractionType=t?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),n.next(e),n.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(e="",t=""){return this.overlayRef.updateSize({width:e,height:t}),this}addPanelClass(e){return this.overlayRef.addPanelClass(e),this}removePanelClass(e){return this.overlayRef.removePanelClass(e),this}}const JU=new d.OlP("DialogScrollStrategy"),S5=new d.OlP("DialogData"),D5=new d.OlP("DefaultDialogConfig"),k5={provide:JU,deps:[yy],useFactory:function A5(i){return()=>i.scrollStrategies.block()}};let R5=0,eV=(()=>{class i{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}constructor(t,n,r,s,o,c){this._overlay=t,this._injector=n,this._defaultOptions=r,this._parentDialog=s,this._overlayContainer=o,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new pn.x,this._afterOpenedAtThisLevel=new pn.x,this._ariaHiddenElements=new Map,this.afterAllClosed=Uc(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Ms(void 0))),this._scrollStrategy=c}open(t,n){(n={...this._defaultOptions||new ES,...n}).id=n.id||"cdk-dialog-"+R5++,n.id&&this.getDialogById(n.id);const s=this._getOverlayConfig(n),o=this._overlay.create(s),c=new P1(o,n),h=this._attachContainer(o,c,n);return c.containerInstance=h,this._attachDialogContent(t,c,h,n),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(c),c.closed.subscribe(()=>this._removeOpenDialog(c,!0)),this.afterOpened.next(c),c}closeAll(){L1(this.openDialogs,t=>t.close())}getDialogById(t){return this.openDialogs.find(n=>n.id===t)}ngOnDestroy(){L1(this._openDialogsAtThisLevel,t=>{!1===t.config.closeOnDestroy&&this._removeOpenDialog(t,!1)}),L1(this._openDialogsAtThisLevel,t=>t.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(t){const n=new DU({positionStrategy:t.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:t.scrollStrategy||this._scrollStrategy(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,direction:t.direction,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,width:t.width,height:t.height,disposeOnNavigation:t.closeOnNavigation});return t.backdropClass&&(n.backdropClass=t.backdropClass),n}_attachContainer(t,n,r){const s=r.injector||r.viewContainerRef?.injector,o=[{provide:ES,useValue:r},{provide:P1,useValue:n},{provide:Fw,useValue:t}];let c;r.container?"function"==typeof r.container?c=r.container:(c=r.container.type,o.push(...r.container.providers(r))):c=QU;const h=new C1(c,r.viewContainerRef,d.zs3.create({parent:s||this._injector,providers:o}),r.componentFactoryResolver);return t.attach(h).instance}_attachDialogContent(t,n,r,s){if(t instanceof d.Rgc){const o=this._createInjector(s,n,r,void 0);let c={$implicit:s.data,dialogRef:n};s.templateContext&&(c={...c,..."function"==typeof s.templateContext?s.templateContext():s.templateContext}),r.attachTemplatePortal(new TU(t,null,c,o))}else{const o=this._createInjector(s,n,r,this._injector),c=r.attachComponentPortal(new C1(t,s.viewContainerRef,o,s.componentFactoryResolver));n.componentInstance=c.instance}}_createInjector(t,n,r,s){const o=t.injector||t.viewContainerRef?.injector,c=[{provide:S5,useValue:t.data},{provide:P1,useValue:n}];return t.providers&&("function"==typeof t.providers?c.push(...t.providers(n,t,r)):c.push(...t.providers)),t.direction&&(!o||!o.get(Up,null,{optional:!0}))&&c.push({provide:Up,useValue:{value:t.direction,change:St()}}),d.zs3.create({parent:o||s,providers:c})}_removeOpenDialog(t,n){const r=this.openDialogs.indexOf(t);r>-1&&(this.openDialogs.splice(r,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((s,o)=>{s?o.setAttribute("aria-hidden",s):o.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),n&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const t=this._overlayContainer.getContainerElement();if(t.parentElement){const n=t.parentElement.children;for(let r=n.length-1;r>-1;r--){const s=n[r];s!==t&&"SCRIPT"!==s.nodeName&&"STYLE"!==s.nodeName&&!s.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(yy),d.LFG(d.zs3),d.LFG(D5,8),d.LFG(i,12),d.LFG(_S),d.LFG(JU))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac}),i})();function L1(i,e){let t=i.length;for(;t--;)e(i[t])}let M5=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({providers:[eV,k5],imports:[PU,gS,I5,gS]}),i})();const P5=new d.OlP("mat-sanity-checks",{providedIn:"root",factory:function O5(){return!0}});let js=(()=>{class i{constructor(t,n,r){this._sanityChecks=n,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!T1()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(XU),d.LFG(P5,8),d.LFG(ue))},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({imports:[Nw,Nw]}),i})();function L5(i){return class extends i{get disabled(){return this._disabled}set disabled(e){this._disabled=xs(e)}constructor(...e){super(...e),this._disabled=!1}}}function N5(i,e){return class extends i{get color(){return this._color}set color(t){const n=t||this.defaultColor;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),n&&this._elementRef.nativeElement.classList.add(`mat-${n}`),this._color=n)}constructor(...t){super(...t),this.defaultColor=e,this.color=e}}}function F5(i){return class extends i{get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=xs(e)}constructor(...e){super(...e),this._disableRipple=!1}}}class U5{constructor(e,t,n,r=!1){this._renderer=e,this.element=t,this.config=n,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const iV=dS({passive:!0,capture:!0});class V5{constructor(){this._events=new Map,this._delegateEventHandler=e=>{const t=Cf(e);t&&this._events.get(e.type)?.forEach((n,r)=>{(r===t||r.contains(t))&&n.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,n,r){const s=this._events.get(t);if(s){const o=s.get(n);o?o.add(r):s.set(n,new Set([r]))}else this._events.set(t,new Map([[n,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,iV)})}removeHandler(e,t,n){const r=this._events.get(e);if(!r)return;const s=r.get(t);s&&(s.delete(n),0===s.size&&r.delete(t),0===r.size&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,iV)))}}const rV={enterDuration:225,exitDuration:150},sV=dS({passive:!0,capture:!0}),oV=["mousedown","touchstart"],aV=["mouseup","mouseleave","touchend","touchcancel"];class wy{constructor(e,t,n,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Fp(n))}fadeInRipple(e,t,n={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...rV,...n.animation};n.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=n.radius||function H5(i,e,t){const n=Math.max(Math.abs(i-t.left),Math.abs(i-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(n*n+r*r)}(e,t,r),c=e-r.left,h=t-r.top,m=s.enterDuration,g=document.createElement("div");g.classList.add("mat-ripple-element"),g.style.left=c-o+"px",g.style.top=h-o+"px",g.style.height=2*o+"px",g.style.width=2*o+"px",null!=n.color&&(g.style.backgroundColor=n.color),g.style.transitionDuration=`${m}ms`,this._containerElement.appendChild(g);const y=window.getComputedStyle(g),x=y.transitionDuration,S="none"===y.transitionProperty||"0s"===x||"0s, 0s"===x||0===r.width&&0===r.height,R=new U5(this,g,n,S);g.style.transform="scale3d(1, 1, 1)",R.state=0,n.persistent||(this._mostRecentTransientRipple=R);let L=null;return!S&&(m||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const G=()=>this._finishRippleTransition(R),Y=()=>this._destroyRipple(R);g.addEventListener("transitionend",G),g.addEventListener("transitioncancel",Y),L={onTransitionEnd:G,onTransitionCancel:Y}}),this._activeRipples.set(R,L),(S||!m)&&this._finishRippleTransition(R),R}fadeOutRipple(e){if(2===e.state||3===e.state)return;const t=e.element,n={...rV,...e.config.animation};t.style.transitionDuration=`${n.exitDuration}ms`,t.style.opacity="0",e.state=2,(e._animationForciblyDisabledThroughCss||!n.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=Fp(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,oV.forEach(n=>{wy._eventManager.addHandler(this._ngZone,n,t,this)}))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{aV.forEach(t=>{this._triggerElement.addEventListener(t,this,sV)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){0===e.state?this._startFadeOutTransition(e):2===e.state&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:n}=e.config;e.state=1,!n&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=3,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){const t=WU(e),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!n&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!KU(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let n=0;n<t.length;n++)this.fadeInRipple(t[n].clientX,t[n].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const e=this._triggerElement;e&&(oV.forEach(t=>wy._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&aV.forEach(t=>e.removeEventListener(t,this,sV)))}}wy._eventManager=new V5;const N1=new d.OlP("mat-ripple-global-options");let xS=(()=>{class i{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,n,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new wy(this,n,t,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,n=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,n,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(d.SBq),d.Y36(d.R0b),d.Y36(ao),d.Y36(N1,8),d.Y36(d.QbO,8))},i.\u0275dir=d.lG2({type:i,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,n){2&t&&d.ekj("mat-ripple-unbounded",n.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),i})(),F1=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({imports:[js,js]}),i})(),j5=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({imports:[js]}),i})();class lV{}class G5{}const Ed="*";function cV(i,e){return{type:7,name:i,definitions:e,options:{}}}function TS(i,e=null){return{type:4,styles:e,timings:i}}function dV(i,e=null){return{type:2,steps:i,options:e}}function Sf(i){return{type:6,styles:i,offset:null}}function IS(i,e,t){return{type:0,name:i,styles:e,options:t}}function CS(i,e,t=null){return{type:1,expr:i,animation:e,options:t}}function mV(i){Promise.resolve().then(i)}class Hw{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){mV(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class pV{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,r=0;const s=this.players.length;0==s?mV(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++n==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,c)=>Math.max(o,c.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(n=>{const r=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(r)})}getPosition(){const e=this.players.reduce((t,n)=>null===t||n.totalTime>t.totalTime?n:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}const B1="!";function z5(i,e){}class SS{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}}const U1="mdc-dialog--open",gV="mdc-dialog--opening",_V="mdc-dialog--closing";let q5=(()=>{class i extends QU{constructor(t,n,r,s,o,c,h,m){super(t,n,r,s,o,c,h,m),this._animationStateChanged=new d.vpe}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(t){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:t})}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(d.SBq),d.Y36(bS),d.Y36(ue,8),d.Y36(SS),d.Y36(Uw),d.Y36(d.R0b),d.Y36(Fw),d.Y36(Vw))},i.\u0275cmp=d.Xpm({type:i,selectors:[["ng-component"]],features:[d.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2}),i})();const yV="--mat-dialog-transition-duration";function vV(i){return null==i?null:"number"==typeof i?i:i.endsWith("ms")?py(i.substring(0,i.length-2)):i.endsWith("s")?1e3*py(i.substring(0,i.length-1)):"0"===i?0:null}let Y5=(()=>{class i extends q5{constructor(t,n,r,s,o,c,h,m,g){super(t,n,r,s,o,c,h,g),this._animationMode=m,this._animationsEnabled="NoopAnimations"!==this._animationMode,this._hostElement=this._elementRef.nativeElement,this._openAnimationDuration=this._animationsEnabled?vV(this._config.enterAnimationDuration)??150:0,this._closeAnimationDuration=this._animationsEnabled?vV(this._config.exitAnimationDuration)??75:0,this._animationTimer=null,this._finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._openAnimationDuration)},this._finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._closeAnimationDuration})}}_contentAttached(){super._contentAttached(),this._startOpenAnimation()}ngOnDestroy(){super.ngOnDestroy(),null!==this._animationTimer&&clearTimeout(this._animationTimer)}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._openAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(yV,`${this._openAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(gV,U1)),this._waitForAnimationToComplete(this._openAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(U1),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._closeAnimationDuration}),this._hostElement.classList.remove(U1),this._animationsEnabled?(this._hostElement.style.setProperty(yV,`${this._openAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(_V)),this._waitForAnimationToComplete(this._closeAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_clearAnimationClasses(){this._hostElement.classList.remove(gV,_V)}_waitForAnimationToComplete(t,n){null!==this._animationTimer&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(n,t)}_requestAnimationFrame(t){this._ngZone.runOutsideAngular(()=>{"function"==typeof requestAnimationFrame?requestAnimationFrame(t):t()})}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(d.SBq),d.Y36(bS),d.Y36(ue,8),d.Y36(SS),d.Y36(Uw),d.Y36(d.R0b),d.Y36(Fw),d.Y36(d.QbO,8),d.Y36(Vw))},i.\u0275cmp=d.Xpm({type:i,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:8,hostBindings:function(t,n){2&t&&(d.Ikx("id",n._config.id),d.uIk("aria-modal",n._config.ariaModal)("role",n._config.role)("aria-labelledby",n._config.ariaLabel?null:n._ariaLabelledBy)("aria-label",n._config.ariaLabel)("aria-describedby",n._config.ariaDescribedBy||null),d.ekj("_mat-animation-noopable",!n._animationsEnabled))},features:[d.qOj],decls:3,vars:0,consts:[[1,"mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(t,n){1&t&&(d.TgZ(0,"div",0)(1,"div",1),d.YNc(2,z5,0,0,"ng-template",2),d.qZA()())},dependencies:[D1],styles:['.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-dialog,.mdc-dialog__scrim{position:fixed;top:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;width:100%;height:100%}.mdc-dialog{display:none;z-index:var(--mdc-dialog-z-index, 7)}.mdc-dialog .mdc-dialog__content{padding:20px 24px 20px 24px}.mdc-dialog .mdc-dialog__surface{min-width:280px}@media(max-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:calc(100vw - 32px)}}@media(min-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:560px}}.mdc-dialog .mdc-dialog__surface{max-height:calc(100% - 32px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-width:none}@media(max-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px;width:560px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 112px)}}@media(max-width: 720px)and (min-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:560px}}@media(max-width: 720px)and (max-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:calc(100vh - 160px)}}@media(max-width: 720px)and (min-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px}}@media(max-width: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-height: 400px),(max-width: 600px),(min-width: 720px)and (max-height: 400px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{height:100%;max-height:100vh;max-width:100vw;width:100vw;border-radius:0}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{order:-1;left:-12px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__header{padding:0 16px 9px;justify-content:flex-start}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__title{margin-left:calc(16px - 2 * 12px)}}@media(min-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 400px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}.mdc-dialog.mdc-dialog__scrim--hidden .mdc-dialog__scrim{opacity:0}.mdc-dialog__scrim{opacity:0;z-index:-1}.mdc-dialog__container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;transform:scale(0.8);opacity:0;pointer-events:none}.mdc-dialog__surface{position:relative;display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;max-width:100%;max-height:100%;pointer-events:auto;overflow-y:auto}.mdc-dialog__surface .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}[dir=rtl] .mdc-dialog__surface,.mdc-dialog__surface[dir=rtl]{text-align:right}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-dialog__surface{outline:2px solid windowText}}.mdc-dialog__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-dialog__surface::before{border-color:CanvasText}}@media screen and (-ms-high-contrast: active),screen and (-ms-high-contrast: none){.mdc-dialog__surface::before{content:none}}.mdc-dialog__title{display:block;margin-top:0;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:0 24px 9px}.mdc-dialog__title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mdc-dialog__title,.mdc-dialog__title[dir=rtl]{text-align:right}.mdc-dialog--scrollable .mdc-dialog__title{margin-bottom:1px;padding-bottom:15px}.mdc-dialog--fullscreen .mdc-dialog__header{align-items:baseline;border-bottom:1px solid rgba(0,0,0,0);display:inline-flex;justify-content:space-between;padding:0 24px 9px;z-index:1}@media screen and (forced-colors: active){.mdc-dialog--fullscreen .mdc-dialog__header{border-bottom-color:CanvasText}}.mdc-dialog--fullscreen .mdc-dialog__header .mdc-dialog__close{right:-12px}.mdc-dialog--fullscreen .mdc-dialog__title{margin-bottom:0;padding:0;border-bottom:0}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__title{border-bottom:0;margin-bottom:0}.mdc-dialog--fullscreen .mdc-dialog__close{top:5px}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--fullscreen--titleless .mdc-dialog__close{margin-top:4px}.mdc-dialog--fullscreen--titleless.mdc-dialog--scrollable .mdc-dialog__close{margin-top:0}.mdc-dialog__content{flex-grow:1;box-sizing:border-box;margin:0;overflow:auto}.mdc-dialog__content>:first-child{margin-top:0}.mdc-dialog__content>:last-child{margin-bottom:0}.mdc-dialog__title+.mdc-dialog__content,.mdc-dialog__header+.mdc-dialog__content{padding-top:0}.mdc-dialog--scrollable .mdc-dialog__title+.mdc-dialog__content{padding-top:8px;padding-bottom:8px}.mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:6px 0 0}.mdc-dialog--scrollable .mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:0}.mdc-dialog__actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--stacked .mdc-dialog__actions{flex-direction:column;align-items:flex-end}.mdc-dialog__button{margin-left:8px;margin-right:0;max-width:100%;text-align:right}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{margin-left:0;margin-right:8px}.mdc-dialog__button:first-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button:first-child,.mdc-dialog__button:first-child[dir=rtl]{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{text-align:left}.mdc-dialog--stacked .mdc-dialog__button:not(:first-child){margin-top:12px}.mdc-dialog--open,.mdc-dialog--opening,.mdc-dialog--closing{display:flex}.mdc-dialog--opening .mdc-dialog__scrim{transition:opacity 150ms linear}.mdc-dialog--opening .mdc-dialog__container{transition:opacity 75ms linear,transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-dialog--closing .mdc-dialog__scrim,.mdc-dialog--closing .mdc-dialog__container{transition:opacity 75ms linear}.mdc-dialog--closing .mdc-dialog__container{transform:none}.mdc-dialog--open .mdc-dialog__scrim{opacity:1}.mdc-dialog--open .mdc-dialog__container{transform:none;opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim{opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{transition:opacity 75ms linear}.mdc-dialog--open.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim{transition:opacity 150ms linear}.mdc-dialog__surface-scrim{display:none;opacity:0;position:absolute;width:100%;height:100%;z-index:1}.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{display:block}.mdc-dialog-scroll-lock{overflow:hidden}.mdc-dialog--no-content-padding .mdc-dialog__content{padding:0}.mdc-dialog--sheet .mdc-dialog__close{right:12px;top:9px;position:absolute;z-index:1}.mdc-dialog__scrim--removed{pointer-events:none}.mdc-dialog__scrim--removed .mdc-dialog__scrim,.mdc-dialog__scrim--removed .mdc-dialog__surface-scrim{display:none}.mat-mdc-dialog-content{max-height:65vh}.mat-mdc-dialog-container{position:static;display:block}.mat-mdc-dialog-container,.mat-mdc-dialog-container .mdc-dialog__container,.mat-mdc-dialog-container .mdc-dialog__surface{max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mat-mdc-dialog-container .mdc-dialog__surface{display:block;width:100%;height:100%}.mat-mdc-dialog-container{outline:0}.mat-mdc-dialog-container .mdc-dialog__surface{background-color:var(--mdc-dialog-container-color, white)}.mat-mdc-dialog-container .mdc-dialog__surface{box-shadow:var(--mdc-dialog-container-elevation, 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12))}.mat-mdc-dialog-container .mdc-dialog__surface{border-radius:var(--mdc-dialog-container-shape, var(--mdc-shape-medium, 4px))}.mat-mdc-dialog-container.mdc-dialog--scrollable .mdc-dialog__title,.mat-mdc-dialog-container.mdc-dialog--scrollable .mdc-dialog__actions,.mat-mdc-dialog-container.mdc-dialog--scrollable.mdc-dialog-scroll-divider-footer .mdc-dialog__actions{border-color:var(--mdc-dialog-with-divider-divider-color, black)}.mat-mdc-dialog-container.mdc-dialog--scrollable .mdc-dialog__title{border-bottom-color:var(--mdc-dialog-with-divider-divider-color, black)}.mat-mdc-dialog-container .mdc-dialog__title{font-family:var(--mdc-dialog-subhead-font, "Arial");line-height:var(--mdc-dialog-subhead-line-height, 14px);font-size:var(--mdc-dialog-subhead-size, 14px);font-weight:var(--mdc-dialog-subhead-weight, 500);letter-spacing:var(--mdc-dialog-subhead-tracking, 1px)}.mat-mdc-dialog-container .mdc-dialog__title{color:var(--mdc-dialog-subhead-color, black)}.mat-mdc-dialog-container .mdc-dialog__content{font-family:var(--mdc-dialog-supporting-text-font, "Arial");line-height:var(--mdc-dialog-supporting-text-line-height, 14px);font-size:var(--mdc-dialog-supporting-text-size, 14px);font-weight:var(--mdc-dialog-supporting-text-weight, 500);letter-spacing:var(--mdc-dialog-supporting-text-tracking, 1px)}.mat-mdc-dialog-container .mdc-dialog__content{color:var(--mdc-dialog-supporting-text-color, black)}.mat-mdc-dialog-container .mdc-dialog__container{transition-duration:var(--mat-dialog-transition-duration, 0ms)}.mat-mdc-dialog-container._mat-animation-noopable .mdc-dialog__container{transition:none}.mat-mdc-dialog-content{display:block}.mat-mdc-dialog-actions{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2}),i})();class bV{constructor(e,t,n){this._ref=e,this._containerInstance=n,this._afterOpened=new pn.x,this._beforeClosed=new pn.x,this._state=0,this.disableClose=t.disableClose,this.id=e.id,n._animationStateChanged.pipe(ti(r=>"opened"===r.state),qr(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),n._animationStateChanged.pipe(ti(r=>"closed"===r.state),qr(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),e.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),(0,Qu.T)(this.backdropClick(),this.keydownEvents().pipe(ti(r=>27===r.keyCode&&!this.disableClose&&!Bw(r)))).subscribe(r=>{this.disableClose||(r.preventDefault(),function Z5(i,e,t){i._closeInteractionType=e,i.close(t)}(this,"keydown"===r.type?"keyboard":"mouse"))})}close(e){this._result=e,this._containerInstance._animationStateChanged.pipe(ti(t=>"closing"===t.state),qr(1)).subscribe(t=>{this._beforeClosed.next(e),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),t.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(e){let t=this._ref.config.positionStrategy;return e&&(e.left||e.right)?e.left?t.left(e.left):t.right(e.right):t.centerHorizontally(),e&&(e.top||e.bottom)?e.top?t.top(e.top):t.bottom(e.bottom):t.centerVertically(),this._ref.updatePosition(),this}updateSize(e="",t=""){return this._ref.updateSize(e,t),this}addPanelClass(e){return this._ref.addPanelClass(e),this}removePanelClass(e){return this._ref.removePanelClass(e),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}const wV=new d.OlP("MatMdcDialogData"),X5=new d.OlP("mat-mdc-dialog-default-options"),EV=new d.OlP("mat-mdc-dialog-scroll-strategy"),J5={provide:EV,deps:[yy],useFactory:function Q5(i){return()=>i.scrollStrategies.block()}};let eW=0,tW=(()=>{class i{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}constructor(t,n,r,s,o,c,h,m,g,y){this._overlay=t,this._defaultOptions=r,this._parentDialog=s,this._dialogRefConstructor=h,this._dialogContainerType=m,this._dialogDataToken=g,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new pn.x,this._afterOpenedAtThisLevel=new pn.x,this._idPrefix="mat-dialog-",this.dialogConfigClass=SS,this.afterAllClosed=Uc(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Ms(void 0))),this._scrollStrategy=c,this._dialog=n.get(eV)}open(t,n){let r;(n={...this._defaultOptions||new SS,...n}).id=n.id||`${this._idPrefix}${eW++}`,n.scrollStrategy=n.scrollStrategy||this._scrollStrategy();const s=this._dialog.open(t,{...n,positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:n},{provide:ES,useValue:n}]},templateContext:()=>({dialogRef:r}),providers:(o,c,h)=>(r=new this._dialogRefConstructor(o,n,h),r.updatePosition(n?.position),[{provide:this._dialogContainerType,useValue:h},{provide:this._dialogDataToken,useValue:c.data},{provide:this._dialogRefConstructor,useValue:r}])});return r.componentInstance=s.componentInstance,this.openDialogs.push(r),this.afterOpened.next(r),r.afterClosed().subscribe(()=>{const o=this.openDialogs.indexOf(r);o>-1&&(this.openDialogs.splice(o,1),this.openDialogs.length||this._getAfterAllClosed().next())}),r}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(t){return this.openDialogs.find(n=>n.id===t)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(t){let n=t.length;for(;n--;)t[n].close()}}return i.\u0275fac=function(t){d.$Z()},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac}),i})(),xV=(()=>{class i extends tW{constructor(t,n,r,s,o,c,h,m){super(t,n,s,c,h,o,bV,Y5,wV,m),this._idPrefix="mat-mdc-dialog-"}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(yy),d.LFG(d.zs3),d.LFG(it,8),d.LFG(X5,8),d.LFG(EV),d.LFG(i,12),d.LFG(_S),d.LFG(d.QbO,8))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac}),i})(),nW=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({providers:[xV,J5],imports:[M5,PU,gS,js,js]}),i})();let CV=(()=>{class i{constructor(t,n){this._renderer=t,this._elementRef=n,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,n){this._renderer.setProperty(this._elementRef.nativeElement,t,n)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(d.Qsj),d.Y36(d.SBq))},i.\u0275dir=d.lG2({type:i}),i})(),Hp=(()=>{class i extends CV{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=d.n5z(i)))(n||i)}}(),i.\u0275dir=d.lG2({type:i,features:[d.qOj]}),i})();const cc=new d.OlP("NgValueAccessor"),iW={provide:cc,useExisting:(0,d.Gpc)(()=>V1),multi:!0};let V1=(()=>{class i extends Hp{writeValue(t){this.setProperty("checked",t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=d.n5z(i)))(n||i)}}(),i.\u0275dir=d.lG2({type:i,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,n){1&t&&d.NdJ("change",function(s){return n.onChange(s.target.checked)})("blur",function(){return n.onTouched()})},features:[d._Bn([iW]),d.qOj]}),i})();const rW={provide:cc,useExisting:(0,d.Gpc)(()=>$1),multi:!0},oW=new d.OlP("CompositionEventMode");let $1=(()=>{class i extends CV{constructor(t,n,r){super(t,n),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function sW(){const i=V()?V().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(d.Qsj),d.Y36(d.SBq),d.Y36(oW,8))},i.\u0275dir=d.lG2({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,n){1&t&&d.NdJ("input",function(s){return n._handleInput(s.target.value)})("blur",function(){return n.onTouched()})("compositionstart",function(){return n._compositionStart()})("compositionend",function(s){return n._compositionEnd(s.target.value)})},features:[d._Bn([rW]),d.qOj]}),i})();const aW=!1,lo=new d.OlP("NgValidators"),Af=new d.OlP("NgAsyncValidators");function NV(i){return null!=i}function FV(i){const e=(0,d.QGY)(i)?(0,zn.D)(i):i;if(aW&&!(0,d.CqO)(e)){let t="Expected async validator to return Promise or Observable.";throw"object"==typeof i&&(t+=" Are you using a synchronous validator where an async validator is expected?"),new d.vHH(-1101,t)}return e}function BV(i){let e={};return i.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function UV(i,e){return e.map(t=>t(i))}function VV(i){return i.map(e=>function cW(i){return!i.validate}(e)?e:t=>e.validate(t))}function H1(i){return null!=i?function $V(i){if(!i)return null;const e=i.filter(NV);return 0==e.length?null:function(t){return BV(UV(t,e))}}(VV(i)):null}function HV(i){if(!i)return null;const e=i.filter(NV);return 0==e.length?null:function(t){return function IV(...i){const e=(0,Fr.jO)(i),{args:t,keys:n}=Br(i),r=new Zi.y(s=>{const{length:o}=t;if(!o)return void s.complete();const c=new Array(o);let h=o,m=o;for(let g=0;g<o;g++){let y=!1;(0,Xs.Xf)(t[g]).subscribe((0,Ci.x)(s,E=>{y||(y=!0,m--),c[g]=E},()=>h--,void 0,()=>{(!h||!y)&&(m||s.next(n?Ia(n,c):c),s.complete())}))}});return e?r.pipe(Wr(e)):r}(UV(t,e).map(FV)).pipe((0,wt.U)(BV))}}function j1(i){return null!=i?HV(VV(i)):null}function jV(i,e){return null===i?[e]:Array.isArray(i)?[...i,e]:[i,e]}function G1(i){return i?Array.isArray(i)?i:[i]:[]}function AS(i,e){return Array.isArray(i)?i.includes(e):i===e}function WV(i,e){const t=G1(e);return G1(i).forEach(r=>{AS(t,r)||t.push(r)}),t}function KV(i,e){return G1(e).filter(t=>!AS(i,t))}class qV{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=H1(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=j1(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class ko extends qV{get formDirective(){return null}get path(){return null}}class kf extends qV{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class YV{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let ZV=(()=>{class i extends YV{constructor(t){super(t)}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(kf,2))},i.\u0275dir=d.lG2({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,n){2&t&&d.ekj("ng-untouched",n.isUntouched)("ng-touched",n.isTouched)("ng-pristine",n.isPristine)("ng-dirty",n.isDirty)("ng-valid",n.isValid)("ng-invalid",n.isInvalid)("ng-pending",n.isPending)},features:[d.qOj]}),i})();const jw="VALID",RS="INVALID",Ey="PENDING",Gw="DISABLED";function MS(i){return null!=i&&!Array.isArray(i)&&"object"==typeof i}class e${constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===jw}get invalid(){return this.status===RS}get pending(){return this.status==Ey}get disabled(){return this.status===Gw}get enabled(){return this.status!==Gw}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(WV(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(WV(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(KV(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(KV(e,this._rawAsyncValidators))}hasValidator(e){return AS(this._rawValidators,e)}hasAsyncValidator(e){return AS(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Ey,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Gw,this.errors=null,this._forEachChild(n=>{n.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=jw,this._forEachChild(n=>{n.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===jw||this.status===Ey)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Gw:jw}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Ey,this._hasOwnPendingAsyncValidator=!0;const t=FV(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((n,r)=>n&&n._find(r),this)}getError(e,t){const n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new d.vpe,this.statusChanges=new d.vpe}_calculateStatus(){return this._allControlsDisabled()?Gw:this.errors?RS:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ey)?Ey:this._anyControlsHaveStatus(RS)?RS:jw}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){MS(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function _W(i){return Array.isArray(i)?H1(i):i||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function yW(i){return Array.isArray(i)?j1(i):i||null}(this._rawAsyncValidators)}}const xy=new d.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>OS}),OS="always";function zw(i,e,t=OS){(function X1(i,e){const t=function GV(i){return i._rawValidators}(i);null!==e.validator?i.setValidators(jV(t,e.validator)):"function"==typeof t&&i.setValidators([t]);const n=function zV(i){return i._rawAsyncValidators}(i);null!==e.asyncValidator?i.setAsyncValidators(jV(n,e.asyncValidator)):"function"==typeof n&&i.setAsyncValidators([n]);const r=()=>i.updateValueAndValidity();NS(e._rawValidators,r),NS(e._rawAsyncValidators,r)})(i,e),e.valueAccessor.writeValue(i.value),(i.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(i.disabled),function wW(i,e){e.valueAccessor.registerOnChange(t=>{i._pendingValue=t,i._pendingChange=!0,i._pendingDirty=!0,"change"===i.updateOn&&t$(i,e)})}(i,e),function xW(i,e){const t=(n,r)=>{e.valueAccessor.writeValue(n),r&&e.viewToModelUpdate(n)};i.registerOnChange(t),e._registerOnDestroy(()=>{i._unregisterOnChange(t)})}(i,e),function EW(i,e){e.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,"blur"===i.updateOn&&i._pendingChange&&t$(i,e),"submit"!==i.updateOn&&i.markAsTouched()})}(i,e),function bW(i,e){if(e.valueAccessor.setDisabledState){const t=n=>{e.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(t),e._registerOnDestroy(()=>{i._unregisterOnDisabledChange(t)})}}(i,e)}function NS(i,e){i.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function t$(i,e){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function r$(i,e){const t=i.indexOf(e);t>-1&&i.splice(t,1)}function s$(i){return"object"==typeof i&&null!==i&&2===Object.keys(i).length&&"value"in i&&"disabled"in i}const o$=class extends e${constructor(e=null,t,n){super(function q1(i){return(MS(i)?i.validators:i)||null}(t),function Y1(i,e){return(MS(e)?e.asyncValidators:i)||null}(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),MS(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=s$(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){r$(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){r$(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){s$(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},RW={provide:kf,useExisting:(0,d.Gpc)(()=>nO)},c$=(()=>Promise.resolve())();let nO=(()=>{class i extends kf{constructor(t,n,r,s,o,c){super(),this._changeDetectorRef=o,this.callSetDisabledState=c,this.control=new o$,this._registered=!1,this.update=new d.vpe,this._parent=t,this._setValidators(n),this._setAsyncValidators(r),this.valueAccessor=function eO(i,e){if(!e)return null;let t,n,r;return Array.isArray(e),e.forEach(s=>{s.constructor===$1?t=s:function CW(i){return Object.getPrototypeOf(i.constructor)===Hp}(s)?n=s:r=s}),r||n||t||null}(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const n=t.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function J1(i,e){if(!i.hasOwnProperty("model"))return!1;const t=i.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){zw(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){c$.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const n=t.isDisabled.currentValue,r=0!==n&&(0,d.D6c)(n);c$.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function PS(i,e){return[...e.path,i]}(t,this._parent):[t]}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(ko,9),d.Y36(lo,10),d.Y36(Af,10),d.Y36(cc,10),d.Y36(d.sBO,8),d.Y36(xy,8))},i.\u0275dir=d.lG2({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[d._Bn([RW]),d.qOj,d.TTD]}),i})(),d$=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({}),i})(),n7=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({imports:[d$]}),i})(),r7=(()=>{class i{static withConfig(t){return{ngModule:i,providers:[{provide:xy,useValue:t.callSetDisabledState??OS}]}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({imports:[n7]}),i})(),s7=(()=>{var i;class e{constructor(n,r){this.dialogRef=n,this.data=r,this.policyAccepted=!1}onNoClick(){this.dialogRef.close()}accept(){this.policyAccepted&&this.dialogRef.close()}decline(){}}return(i=e).\u0275fac=function(n){return new(n||i)(d.Y36(bV),d.Y36(wV))},i.\u0275cmp=d.Xpm({type:i,selectors:[["app-dialog-alert"]],decls:26,vars:2,consts:[[1,"img-arrow"],["src","https://clipart-library.com/img1/1670503.png","alt",""],["src","  assets/mobile.png\n    ","alt",""],[2,"color","#1a73e8"],[1,"dis-flex","wtf2"],["for","policyCheckbox",1,"policy-statement"],["placeholder","","type","checkbox","id","policyCheckbox",3,"ngModel","ngModelChange"],[1,"dis-flex","wtf1"],[3,"click"],[3,"disabled","click"]],template:function(n,r){1&n&&(d.TgZ(0,"div",0)(1,"p"),d._uU(2,"Control the channel using the arrow keys"),d.qZA(),d._UZ(3,"img",1)(4,"br"),d.TgZ(5,"p"),d._uU(6,"Or Remote throught your device"),d.qZA(),d._UZ(7,"img",2),d.TgZ(8,"p")(9,"span",3),d._uU(10,"Policy Statement:"),d.qZA(),d._UZ(11,"br"),d._uU(12," Content Availability: Availability of content may be limited due to licensing agreements and provider restrictions. "),d._UZ(13,"br"),d._uU(14," Internet Connectivity: A good internet connection is essential for the best user experience. "),d._UZ(15,"br"),d._uU(16," Device Compatibility: Some devices may not support all features. Internet "),d.qZA(),d.TgZ(17,"div",4)(18,"label",5),d._uU(19,"I have read and agree to the policy statements"),d.qZA(),d.TgZ(20,"input",6),d.NdJ("ngModelChange",function(o){return r.policyAccepted=o}),d.qZA()(),d.TgZ(21,"div",7)(22,"button",8),d.NdJ("click",function(){return r.decline()}),d._uU(23,"Decline"),d.qZA(),d.TgZ(24,"button",9),d.NdJ("click",function(){return r.accept()}),d._uU(25,"Accept"),d.qZA()()()),2&n&&(d.xp6(20),d.Q6J("ngModel",r.policyAccepted),d.xp6(4),d.Q6J("disabled",!r.policyAccepted))},dependencies:[V1,ZV,nO],styles:[".img-arrow[_ngcontent-%COMP%]{padding:29px;align-items:center;justify-content:center;display:flex;height:500px;flex-direction:column;background-color:#fff}.img-arrow[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100px;margin:auto}.img-arrow[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:last-child{width:60px;margin:auto}.img-arrow[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:10px}.img-arrow[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin-right:5px}.img-arrow[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:4px;color:#fff;background-color:#1a73e8;cursor:pointer;margin-top:10px}.img-arrow[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.dis-flex[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.wtf1[_ngcontent-%COMP%]{gap:20px}.wtf2[_ngcontent-%COMP%]{margin-top:7px}"]}),e})(),o7=(()=>{var i;class e{constructor(){this.localChannels=[{name:"TVK1",url:"https://live.kh.malimarcdn.com/live/tvk.stream/playlist.m3u8"},{name:"TVK2",url:"https://live.kh.malimarcdn.com/live/tvk2.stream/playlist.m3u8"},{name:"SeaTV",url:"https://seatv.netlinkbroadcaster.com/hls/test.m3u8"},{name:"SeaTV Radio",url:"https://fmseatv.netlinkbroadcaster.com/hls/test.m3u8"},{name:"TeaTv",url:"https://livefta.malimarcdn.com/ftaedge00/teatv2.sdp/playlist.m3u8"},{name:"KHMERTV",url:"https://livefta.malimarcdn.com/ftaedge00/khmertv2020.stream/chunklist.m3u8"},{name:"Kanali 7",url:"https://fe.tring.al/delta/105/out/u/1200_1.m3u8"},{name:"Alpo TV",url:"https://5d00db0e0fcd5.streamlock.net/7236/7236/playlist.m3u8"},{name:"CNA",url:"https://live1.mediadesk.al/cnatvlive.m3u8"},{name:"News 24 \u24c8",url:"https://tv.balkanweb.com/news24/livestream/playlist.m3u8"},{name:"Ora News",url:"https://live1.mediadesk.al/oranews.m3u8"},{name:"Report TV",url:"https://deb10stream.duckdns.org/hls/stream.m3u8"},{name:"Syri",url:"https://stream.syritv.al/SyriTV/index.m3u8"},{name:"Tropoja",url:"https://live.prostream.al/al/smil:tropojatv.smil/playlist.m3u8"},{name:"TV 7 Albania",url:"https://5d00db0e0fcd5.streamlock.net/7064/7064/playlist.m3u8"},{name:"TV Apollon \u24c8",url:"https://live.apollon.tv/Apollon-WEB/video.m3u8?token=tnt3u76re30d2"},{name:"Vizion Plus",url:"https://fe.tring.al/delta/105/out/u/rdghfhsfhfshs.m3u8"},{name:"CCTV1",url:"https://node1.olelive.com:6443/live/CCTV1HD/hls.m3u8"},{name:"CCTV2",url:"https://node1.olelive.com:6443/live/CCTV2HD/hls.m3u8"},{name:"CCTV7",url:"https://node1.olelive.com:6443/live/CCTV7HD/hls.m3u8"},{name:"CCTV8",url:"https://node1.olelive.com:6443/live/CCTV8HD/hls.m3u8"},{name:"CCTV9",url:"https://node1.olelive.com:6443/live/CCTV9HD/hls.m3u8"},{name:"CCTV10",url:"https://node1.olelive.com:6443/live/CCTV10HD/hls.m3u8"},{name:"CCTV17",url:"https://node1.olelive.com:6443/live/CCTV17HD/hls.m3u8"},{name:"TV BRICS Chinese",url:"https://brics.bonus-tv.ru/cdn/brics/chinese/playlist.m3u8"},{name:"ABC News",url:"https://content.uplynk.com/channel/3324f2467c414329b3b0cc5cd987b6be.m3u8"},{name:"CBS News",url:"https://cbsnews.akamaized.net/hls/live/2020607/cbsnlineup_8/master.m3u8"},{name:"Reuters TV",url:"https://reuters-reutersnow-1-eu.rakuten.wurl.tv/playlist.m3u8"},{name:"Spacetoon",url:"https://streams.spacetoon.com/live/stchannel/smil:livesmil.smil/playlist.m3u8"},{name:"Cartoon Network",url:"https://playout.cdn.cartoonnetwork.com.br/playout_02/playlist-720p.m3u8"},{name:"4Fun TV",url:"https://stream.4fun.tv:8888/hls/4f_high/index.m3u8"},{name:"Desi",url:"https://live.wmncdn.net/desichannel/7e2dd0aed46b70a5c77f4affdb702e4b.sdp/mono.m3u8"},{name:"Dove",url:"https://dai.google.com/linear/hls/event/dfbBGQhPQQqypdEAjpUGlA/master.m3u8"},{name:"zindagitv",url:"https://5ad386ff92705.streamlock.net/live_transcoder/ngrp:zindagitv.stream_all/chunklist.m3u8"},{name:"Pocket watch",url:"https://dai2.xumo.com/amagi_hls_data_xumo1212A-xumo-pocket-watch/CDN/master.m3u8"},{name:" Cartoon Nitro",url:"https://playout.cdn.cartoonnetwork.com.br/playout_04/playlist.m3u8"},{name:"ANTD",url:"https://liveh34.vtvcab.vn/hls/ONANTV_CL/04.m3u8"},{name:"2",url:"https://wzorigin.teroradio.com/Tofu/Tofu-Webcam1/playlist.m3u8"}],this.globalChannels=[{name:"LOKAL",url:"http://andriant.my.id"},{name:"CH2 STARMAX",url:"http://stream.rs.co.th/ch2-hi/index.m3u8"},{name:"CH3 HD",url:"http://27.254.130.64/feed/ch3hd/playlist.m3u8"},{name:"CH5",url:"http://27.254.130.64/feed/ch5hd/playlist.m3u8"},{name:"CH7 HD",url:"http://27.254.130.64/feed/ch7hd/playlist.m3u8"},{name:"CH8",url:"http://stream.rs.co.th/ch8-hi/index.m3u8"},{name:"MCOT HD",url:"http://27.254.130.64/feed/chmcothd/playlist.m3u8"},{name:"CH11 NBT",url:"http://27.254.130.64/live01/ch14.m3u8?p=m3u8"},{name:"CH11 NBT",url:"http://122.155.92.8:1935/live/ch1_L.sdp/chunklist.m3u8"},{name:"Workpoint",url:"https://gcorigin.wisdomcloud.net/live/master/playlist.m3u8_500.m3u8"}]}}return(i=e).\u0275fac=function(n){return new(n||i)},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),e})();function cO(){return(0,Pi.e)((i,e)=>{let t,n=!1;i.subscribe((0,Ci.x)(e,r=>{const s=t;t=r,n&&e.next([s,r]),n=!0}))})}z(9568);var a7=z(3942);function uO(i,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new $e("invalid-argument",`Invalid options passed to function ${i}(): You cannot specify both "merge" and "mergeFields".`);return e}function A$(){if(typeof Uint8Array>"u")throw new $e("unimplemented","Uint8Arrays are not available in this environment.")}function k$(){if(!function oj(){return typeof atob<"u"}())throw new $e("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Kw{constructor(e){this._delegate=e}static fromBase64String(e){return k$(),new Kw(hu.fromBase64String(e))}static fromUint8Array(e){return A$(),new Kw(hu.fromUint8Array(e))}toBase64(){return k$(),this._delegate.toBase64()}toUint8Array(){return A$(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function dO(i){return function u7(i,e){if("object"!=typeof i||null===i)return!1;const t=i;for(const n of e)if(n in t&&"function"==typeof t[n])return!0;return!1}(i,["next","error","complete"])}class d7{enableIndexedDbPersistence(e,t){return function Oz(i,e){XB(i=Vn(i,zi));const t=Mr(i);if(t._uninitializedComponentsProvider)throw new $e(be.FAILED_PRECONDITION,"SDK cache is already specified.");yl("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=i._freezeSettings(),r=new dy;return ZB(t,r,new r1(r,n.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function Pz(i){XB(i=Vn(i,zi));const e=Mr(i);if(e._uninitializedComponentsProvider)throw new $e(be.FAILED_PRECONDITION,"SDK cache is already specified.");yl("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=i._freezeSettings(),n=new dy;return ZB(e,n,new kB(n,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function Lz(i){if(i._initialized&&!i._terminated)throw new $e(be.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new es;return i._queue.enqueueAndForgetEvenWhileRestricted((0,Ie.Z)(function*(){try{var t;yield function(n){return(t=t||(0,Ie.Z)(function*(r){if(!lc.D())return Promise.resolve();const s=r+"main";yield lc.delete(s)})).apply(this,arguments)}(OM(i._databaseId,i._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}(e._delegate)}}class R${constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof df||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&yl("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,n={}){zB(this._delegate,e,t,n)}enableNetwork(){return function Fz(i){return function wz(i){return i.asyncQueue.enqueue((0,Ie.Z)(function*(){const e=yield OB(i),t=yield PB(i);return e.setNetworkEnabled(!0),function(n){const r=yt(n);return r.vu.delete(0),bw(r)}(t)}))}(Mr(i=Vn(i,zi)))}(this._delegate)}disableNetwork(){return function Bz(i){return function Ez(i){return i.asyncQueue.enqueue((0,Ie.Z)(function*(){var e;const t=yield OB(i),n=yield PB(i);return t.setNetworkEnabled(!1),function(r){return(e=e||(0,Ie.Z)(function*(s){const o=yt(s);o.vu.add(0),yield ry(o),o.bu.set("Offline")})).apply(this,arguments)}(n)}))}(Mr(i=Vn(i,zi)))}(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,VB("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function Nz(i){return function(e){const t=new es;return e.asyncQueue.enqueueAndForget((0,Ie.Z)(function*(){return function rz(i,e){return(LN=LN||(0,Ie.Z)(function*(t,n){const r=yt(t);bf(r.remoteStore)||nt("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const s=yield function(c){const h=yt(c);return h.persistence.runTransaction("Get highest unacknowledged batch id","readonly",m=>h.mutationQueue.getHighestUnacknowledgedBatchId(m))}(r.localStore);if(-1===s)return void n.resolve();const o=r.Ec.get(s)||[];o.push(n),r.Ec.set(s,o)}catch(s){const o=ay(s,"Initialization of waitForPendingWrites() operation failed");n.reject(o)}})).apply(this,arguments)}(yield a1(e),t)})),t.promise}(Mr(i=Vn(i,zi)))}(this._delegate)}onSnapshotsInSync(e){return function p6(i,e){return function Iz(i,e){const t=new zC(e);return i.asyncQueue.enqueueAndForget((0,Ie.Z)(function*(){return function(n,r){yt(n).ku.add(r),r.next()}(yield hy(i),t)})),()=>{t.Dc(),i.asyncQueue.enqueueAndForget((0,Ie.Z)(function*(){return function(n,r){yt(n).ku.delete(r)}(yield hy(i),t)}))}}(Mr(i=Vn(i,zi)),u1(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new $e("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Ty(this,WB(this._delegate,e))}catch(t){throw Ro(t,"collection()","Firestore.collection()")}}doc(e){try{return new vl(this,Tw(this._delegate,e))}catch(t){throw Ro(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Mo(this,function Az(i,e){if(i=Vn(i,xw),l1("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new $e(be.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Hs(i,null,(t=e,new pd(Xn.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw Ro(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function C6(i,e,t){i=Vn(i,zi);const n=Object.assign(Object.assign({},T6),t);return function(r){if(r.maxAttempts<1)throw new $e(be.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(r,s,o){const c=new es;return r.asyncQueue.enqueueAndForget((0,Ie.Z)(function*(){const h=yield function LB(i){return KC(i).then(e=>e.datastore)}(r);new vz(r.asyncQueue,h,o,s,c).run()})),c.promise}(Mr(i),r=>e(new I6(i,r)),n)}(this._delegate,t=>e(new M$(this,t)))}batch(){return Mr(this._delegate),new O$(new mU(this._delegate,e=>my(this._delegate,e)))}loadBundle(e){return function Uz(i,e){const t=Mr(i=Vn(i,zi)),n=new Rz;return function Cz(i,e,t,n){const r=function(s,o){let c;return c="string"==typeof s?s2().encode(s):s,h=function(h,m){if(h instanceof Uint8Array)return RB(h,m);if(h instanceof ArrayBuffer)return RB(new Uint8Array(h),m);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),new _z(h,o);var h}(t,vw(e));i.asyncQueue.enqueueAndForget((0,Ie.Z)(function*(){!function pz(i,e,t){var n;const r=yt(i);(function(s,o,c){return(n=n||(0,Ie.Z)(function*(h,m,g){try{const y=yield m.getMetadata();if(yield function(R,L){const G=yt(R),Y=Rr(L.createTime);return G.persistence.runTransaction("hasNewerBundle","readonly",K=>G.qs.getBundleMetadata(K,L.id)).then(K=>!!K&&K.createTime.compareTo(Y)>=0)}(h.localStore,y))return yield m.close(),g._completeWith({taskState:"Success",documentsLoaded:(R=y).totalDocuments,bytesLoaded:R.totalBytes,totalDocuments:R.totalDocuments,totalBytes:R.totalBytes}),Promise.resolve(new Set);g._updateProgress(wB(y));const E=new qG(y,h.localStore,m.serializer);let x=yield m.bc();for(;x;){const R=yield E.zu(x);R&&g._updateProgress(R),x=yield m.bc()}const S=yield E.complete();return yield vd(h,S.Ju,void 0),yield function(R,L){const G=yt(R);return G.persistence.runTransaction("Save bundle","readwrite",Y=>G.qs.saveBundleMetadata(Y,L))}(h.localStore,y),g._completeWith(S.progress),Promise.resolve(S.Hu)}catch(y){return yl("SyncEngine",`Loading bundle failed with ${y}`),g._failWith(y),Promise.resolve(new Set)}var R})).apply(this,arguments)})(r,e,t).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}(yield a1(i),r,n)}))}(t,i._databaseId,e,n),n}(this._delegate,e)}namedQuery(e){return function Vz(i,e){return function Sz(i,e){return i.asyncQueue.enqueue((0,Ie.Z)(function*(){return function(t,n){const r=yt(t);return r.persistence.runTransaction("Get named query","readonly",s=>r.qs.getNamedQuery(s,n))}(yield qC(i),e)}))}(Mr(i=Vn(i,zi)),e).then(t=>t?new Hs(i,null,t.query):null)}(this._delegate,e).then(t=>t?new Mo(this,t):null)}}class BS extends _1{constructor(e){super(),this.firestore=e}convertBytes(e){return new Kw(new hu(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return vl.forKey(t,this.firestore,null)}}class M${constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new BS(e)}get(e){const t=zp(e);return this._delegate.get(t).then(n=>new qw(this._firestore,new wd(this._firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,t.converter)))}set(e,t,n){const r=zp(e);return n?(uO("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const s=zp(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,n,...r),this}delete(e){const t=zp(e);return this._delegate.delete(t),this}}class O${constructor(e){this._delegate=e}set(e,t,n){const r=zp(e);return n?(uO("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const s=zp(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,n,...r),this}delete(e){const t=zp(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Gp{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){const n=new Rw(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Yw(this._firestore,n),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const n=Gp.INSTANCES;let r=n.get(e);r||(r=new WeakMap,n.set(e,r));let s=r.get(t);return s||(s=new Gp(e,new BS(e),t),r.set(t,s)),s}}Gp.INSTANCES=new WeakMap;class vl{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new BS(e)}static forPath(e,t,n){if(e.length%2!=0)throw new $e("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new vl(t,new Gi(t._delegate,n,new pt(e)))}static forKey(e,t,n){return new vl(t,new Gi(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new Ty(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Ty(this.firestore,WB(this._delegate,e))}catch(t){throw Ro(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,bn.m9)(e))instanceof Gi&&KB(this._delegate,e)}set(e,t){t=uO("DocumentReference.set",t);try{return t?fU(this._delegate,e,t):fU(this._delegate,e)}catch(n){throw Ro(n,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return 1===arguments.length?oS(this._delegate,e):oS(this._delegate,e,t,...n)}catch(r){throw Ro(r,"updateDoc()","DocumentReference.update()")}}delete(){return function f6(i){return my(Vn(i.firestore,zi),[new X_(i._key,tr.none())])}(this._delegate)}onSnapshot(...e){const t=P$(e),n=L$(e,r=>new qw(this.firestore,new wd(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return y1(this._delegate,t,n)}get(e){let t;return t="cache"===e?.source?function l6(i){i=Vn(i,Gi);const e=Vn(i.firestore,zi),t=Mr(e),n=new Tf(e);return function xz(i,e){const t=new es;return i.asyncQueue.enqueueAndForget((0,Ie.Z)(function*(){var n;return function(r,s,o){return(n=n||(0,Ie.Z)(function*(c,h,m){try{const g=yield function(y,E){const x=yt(y);return x.persistence.runTransaction("read document","readonly",S=>x.localDocuments.getDocument(S,E))}(c,h);g.isFoundDocument()?m.resolve(g):g.isNoDocument()?m.resolve(null):m.reject(new $e(be.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(g){const y=ay(g,`Failed to get document '${h} from cache`);m.reject(y)}})).apply(this,arguments)}(yield qC(i),e,t)})),t.promise}(t,i._key).then(r=>new wd(e,n,i._key,r,new Np(null!==r&&r.hasLocalMutations,!0),i.converter))}(this._delegate):"server"===e?.source?function c6(i){i=Vn(i,Gi);const e=Vn(i.firestore,zi);return NB(Mr(e),i._key,{source:"server"}).then(t=>v1(e,i,t))}(this._delegate):function a6(i){i=Vn(i,Gi);const e=Vn(i.firestore,zi);return NB(Mr(e),i._key).then(t=>v1(e,i,t))}(this._delegate),t.then(n=>new qw(this.firestore,new wd(this.firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,this._delegate.converter)))}withConverter(e){return new vl(this.firestore,this._delegate.withConverter(e?Gp.getInstance(this.firestore,e):null))}}function Ro(i,e,t){return i.message=i.message.replace(e,t),i}function P$(i){for(const e of i)if("object"==typeof e&&!dO(e))return e;return{}}function L$(i,e){var t,n;let r;return r=dO(i[0])?i[0]:dO(i[1])?i[1]:"function"==typeof i[0]?{next:i[0],error:i[1],complete:i[2]}:{next:i[1],error:i[2],complete:i[3]},{next:s=>{r.next&&r.next(e(s))},error:null===(t=r.error)||void 0===t?void 0:t.bind(r),complete:null===(n=r.complete)||void 0===n?void 0:n.bind(r)}}class qw{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new vl(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return hU(this._delegate,e._delegate)}}class Yw extends qw{data(e){const t=this._delegate.data(e);return function S4(i,e){i||Ot()}(void 0!==t),t}}class Mo{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new BS(e)}where(e,t,n){try{return new Mo(this.firestore,Ef(this._delegate,function Zz(i,e,t){const n=e,r=tS("where",i);return kw._create(r,n,t)}(e,t,n)))}catch(r){throw Ro(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Mo(this.firestore,Ef(this._delegate,function Xz(i,e="asc"){const t=e,n=tS("orderBy",i);return g1._create(n,t)}(e,t)))}catch(n){throw Ro(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Mo(this.firestore,Ef(this._delegate,function Qz(i){return jB("limit",i),nS._create("limit",i,"F")}(e)))}catch(t){throw Ro(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Mo(this.firestore,Ef(this._delegate,function Jz(i){return jB("limitToLast",i),nS._create("limitToLast",i,"L")}(e)))}catch(t){throw Ro(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Mo(this.firestore,Ef(this._delegate,function e6(...i){return iS._create("startAt",i,!0)}(...e)))}catch(t){throw Ro(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Mo(this.firestore,Ef(this._delegate,function t6(...i){return iS._create("startAfter",i,!1)}(...e)))}catch(t){throw Ro(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Mo(this.firestore,Ef(this._delegate,function n6(...i){return rS._create("endBefore",i,!1)}(...e)))}catch(t){throw Ro(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Mo(this.firestore,Ef(this._delegate,function i6(...i){return rS._create("endAt",i,!0)}(...e)))}catch(t){throw Ro(t,"endAt()","Query.endAt()")}}isEqual(e){return c1(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function d6(i){i=Vn(i,Hs);const e=Vn(i.firestore,zi),t=Mr(e),n=new Tf(e);return function Tz(i,e){const t=new es;return i.asyncQueue.enqueueAndForget((0,Ie.Z)(function*(){var n;return function(r,s,o){return(n=n||(0,Ie.Z)(function*(c,h,m){try{const g=yield BC(c,h,!0),y=new TB(h,g.ir),E=y.sc(g.documents),x=y.applyChanges(E,!1);m.resolve(x.snapshot)}catch(g){const y=ay(g,`Failed to execute query '${h} against cache`);m.reject(y)}})).apply(this,arguments)}(yield qC(i),e,t)})),t.promise}(t,i._query).then(r=>new xf(e,n,i,r))}(this._delegate):"server"===e?.source?function h6(i){i=Vn(i,Hs);const e=Vn(i.firestore,zi),t=Mr(e),n=new Tf(e);return FB(t,i._query,{source:"server"}).then(r=>new xf(e,n,i,r))}(this._delegate):function u6(i){i=Vn(i,Hs);const e=Vn(i.firestore,zi),t=Mr(e),n=new Tf(e);return sU(i._query),FB(t,i._query).then(r=>new xf(e,n,i,r))}(this._delegate),t.then(n=>new hO(this.firestore,new xf(this.firestore._delegate,this._userDataWriter,this._delegate,n._snapshot)))}onSnapshot(...e){const t=P$(e),n=L$(e,r=>new hO(this.firestore,new xf(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return y1(this._delegate,t,n)}withConverter(e){return new Mo(this.firestore,this._delegate.withConverter(e?Gp.getInstance(this.firestore,e):null))}}class f7{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Yw(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class hO{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Mo(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Yw(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new f7(this._firestore,t))}forEach(e,t){this._delegate.forEach(n=>{e.call(t,new Yw(this._firestore,n))})}isEqual(e){return hU(this._delegate,e._delegate)}}class Ty extends Mo{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new vl(this.firestore,e):null}doc(e){try{return new vl(this.firestore,void 0===e?Tw(this._delegate):Tw(this._delegate,e))}catch(t){throw Ro(t,"doc()","CollectionReference.doc()")}}add(e){return function m6(i,e){const t=Vn(i.firestore,zi),n=Tw(i),r=sS(i.converter,e);return my(t,[QC(Pp(i.firestore),"addDoc",n._key,r,null!==i.converter,{}).toMutation(n._key,tr.exists(!1))]).then(()=>n)}(this._delegate,e).then(t=>new vl(this.firestore,t))}isEqual(e){return KB(this._delegate,e._delegate)}withConverter(e){return new Ty(this.firestore,this._delegate.withConverter(e?Gp.getInstance(this.firestore,e):null))}}function zp(i){return Vn(i,Gi)}class fO{constructor(...e){this._delegate=new bd(...e)}static documentId(){return new fO(br.keyField().canonicalString())}isEqual(e){return(e=(0,bn.m9)(e))instanceof bd&&this._delegate._internalPath.isEqual(e._internalPath)}}class Wp{constructor(e){this._delegate=e}static serverTimestamp(){const e=function D6(){return new d1("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Wp(e)}static delete(){const e=function S6(){return new Cw("deleteField")}();return e._methodName="FieldValue.delete",new Wp(e)}static arrayUnion(...e){const t=function A6(...i){return new zz("arrayUnion",i)}(...e);return t._methodName="FieldValue.arrayUnion",new Wp(t)}static arrayRemove(...e){const t=function k6(...i){return new Wz("arrayRemove",i)}(...e);return t._methodName="FieldValue.arrayRemove",new Wp(t)}static increment(e){const t=function R6(i){return new Kz("increment",i)}(e);return t._methodName="FieldValue.increment",new Wp(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const m7={Firestore:R$,GeoPoint:ZC,Timestamp:er,Blob:Kw,Transaction:M$,WriteBatch:O$,DocumentReference:vl,DocumentSnapshot:qw,Query:Mo,QueryDocumentSnapshot:Yw,QuerySnapshot:hO,CollectionReference:Ty,FieldPath:fO,FieldValue:Wp,setLogLevel:function h7(i){!function C4(i){sf.setLogLevel(i)}(i)},CACHE_SIZE_UNLIMITED:-1};function N$(i,e){return function _7(i,e=uS.z){return new Zi.y(t=>{let n;return null!=e?e.schedule(()=>{n=i.onSnapshot({includeMetadataChanges:!0},t)}):n=i.onSnapshot({includeMetadataChanges:!0},t),()=>{n?.()}})}(i,e)}function mO(i,e){return N$(i,e).pipe((0,wt.U)(t=>({payload:t,type:"query"})))}function US(i,e){return mO(i,e).pipe(Ms(void 0),cO(),(0,wt.U)(([t,n])=>{const r=n.payload.docChanges(),s=r.map(o=>({type:o.type,payload:o}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(n.payload.metadata)&&n.payload.docs.forEach((o,c)=>{const h=r.find(g=>g.doc.ref.isEqual(o.ref)),m=t?.payload.docs.find(g=>g.ref.isEqual(o.ref));h&&JSON.stringify(h.doc.metadata)===JSON.stringify(o.metadata)||!h&&m&&JSON.stringify(m.metadata)===JSON.stringify(o.metadata)||s.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:o}})}),s}))}function F$(i,e,t){return US(i,t).pipe($c((n,r)=>function v7(i,e,t){return e.forEach(n=>{t.indexOf(n.type)>-1&&(i=function b7(i,e){switch(e.type){case"added":if(!i[e.newIndex]||!i[e.newIndex].doc.ref.isEqual(e.doc.ref))return pO(i,e.newIndex,0,e);break;case"modified":if(null==i[e.oldIndex]||i[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=i.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return pO(i,e.newIndex,1,e)}break;case"removed":if(i[e.oldIndex]&&i[e.oldIndex].doc.ref.isEqual(e.doc.ref))return pO(i,e.oldIndex,1)}return i}(i,n))}),i}(n,r.map(s=>s.payload),e),[]),R1(),(0,wt.U)(n=>n.map(r=>({type:r.type,payload:r}))))}function pO(i,e,t,...n){const r=i.slice();return r.splice(e,t,...n),r}function B$(i){return(!i||0===i.length)&&(i=["added","removed","modified"]),i}!function g7(i){(function p7(i,e){i.INTERNAL.registerComponent(new Xu.wA("firestore-compat",t=>{const n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(n,r)},"PUBLIC").setServiceProps(Object.assign({},m7)))})(i,(e,t)=>new R$(e,t,new d7)),i.registerVersion("@firebase/firestore-compat","0.3.12")}(a7.Z);class U${constructor(e,t,n){this.ref=e,this.query=t,this.afs=n}stateChanges(e){let t=US(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,wt.U)(n=>n.filter(r=>e.indexOf(r.type)>-1)))),t.pipe(Ms(void 0),cO(),ti(([n,r])=>r.length>0||!n),(0,wt.U)(([n,r])=>r),In.iC)}auditTrail(e){return this.stateChanges(e).pipe($c((t,n)=>[...t,...n],[]))}snapshotChanges(e){const t=B$(e);return F$(this.query,t,this.afs.schedulers.outsideAngular).pipe(In.iC)}valueChanges(e={}){return mO(this.query,this.afs.schedulers.outsideAngular).pipe((0,wt.U)(t=>t.payload.docs.map(n=>e.idField?Object.assign(Object.assign({},n.data()),{[e.idField]:n.id}):n.data())),In.iC)}get(e){return(0,zn.D)(this.query.get(e)).pipe(In.iC)}add(e){return this.ref.add(e)}doc(e){return new V$(this.ref.doc(e),this.afs)}}class V${constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const n=this.ref.collection(e),{ref:r,query:s}=j$(n,t);return new U$(r,s,this.afs)}snapshotChanges(){return function y7(i,e){return N$(i,e).pipe(Ms(void 0),cO(),(0,wt.U)(([t,n])=>n.exists?t?.exists?{payload:n,type:"modified"}:{payload:n,type:"added"}:{payload:n,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(In.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,wt.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,zn.D)(this.ref.get(e)).pipe(In.iC)}}class w7{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?US(this.query,this.afs.schedulers.outsideAngular).pipe((0,wt.U)(t=>t.filter(n=>e.indexOf(n.type)>-1)),ti(t=>t.length>0),In.iC):US(this.query,this.afs.schedulers.outsideAngular).pipe(In.iC)}auditTrail(e){return this.stateChanges(e).pipe($c((t,n)=>[...t,...n],[]))}snapshotChanges(e){const t=B$(e);return F$(this.query,t,this.afs.schedulers.outsideAngular).pipe(In.iC)}valueChanges(e={}){return mO(this.query,this.afs.schedulers.outsideAngular).pipe((0,wt.U)(n=>n.payload.docs.map(r=>e.idField?Object.assign({[e.idField]:r.id},r.data()):r.data())),In.iC)}get(e){return(0,zn.D)(this.query.get(e)).pipe(In.iC)}}const $$=new d.OlP("angularfire2.enableFirestorePersistence"),H$=new d.OlP("angularfire2.firestore.persistenceSettings"),E7=new d.OlP("angularfire2.firestore.settings"),x7=new d.OlP("angularfire2.firestore.use-emulator");function j$(i,e=(t=>t)){return{query:e(i),ref:i}}let gO=(()=>{class i{constructor(t,n,r,s,o,c,h,m,g,y,E,x,S,R,L,G,Y){this.schedulers=h;const K=(0,Ko.on)(t,c,n),te=g;y&&Ug(K,c,E,S,R,L,x,G),[this.firestore,this.persistenceEnabled$]=(0,Ko.cc)(`${K.name}.firestore`,"AngularFirestore",K.name,()=>{const oe=c.runOutsideAngular(()=>K.firestore());if(s&&oe.settings(s),te&&oe.useEmulator(...te),r&&!Vf(o)){const Ae=()=>{try{return(0,zn.D)(oe.enablePersistence(m||void 0).then(()=>!0,()=>!1))}catch(we){return typeof console<"u"&&console.warn(we),St(!1)}};return[oe,c.runOutsideAngular(Ae)]}return[oe,St(!1)]},[s,te,r])}collection(t,n){let r;r="string"==typeof t?this.firestore.collection(t):t;const{ref:s,query:o}=j$(r,n),c=this.schedulers.ngZone.run(()=>s);return new U$(c,o,this)}collectionGroup(t,n){const r=n||(o=>o),s=this.firestore.collectionGroup(t);return new w7(r(s),this)}doc(t){let n;n="string"==typeof t?this.firestore.doc(t):t;const r=this.schedulers.ngZone.run(()=>n);return new V$(r,this)}createId(){return this.firestore.collection("_").doc().id}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(Ko.Dh),d.LFG(Ko.xv,8),d.LFG($$,8),d.LFG(E7,8),d.LFG(d.Lbi),d.LFG(d.R0b),d.LFG(In.HU),d.LFG(H$,8),d.LFG(x7,8),d.LFG(od,8),d.LFG(Uv,8),d.LFG(Vv,8),d.LFG(Lx,8),d.LFG($v,8),d.LFG(Hv,8),d.LFG(Bg,8),d.LFG(ec,8))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"}),i})(),T7=(()=>{class i{constructor(){Ox.Z.registerVersion("angularfire",In.q4.full,"fst-compat")}static enablePersistence(t){return{ngModule:i,providers:[{provide:$$,useValue:!0},{provide:H$,useValue:t}]}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({providers:[gO]}),i})();const I7=["mat-button",""],C7=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],S7=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],D7=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],A7=N5(L5(F5(class{constructor(i){this._elementRef=i}})));let k7=(()=>{class i extends A7{constructor(t,n,r,s){super(t),this._platform=n,this._ngZone=r,this._animationMode=s,this._focusMonitor=(0,d.f3M)(Vw),this._isFab=!1;const o=t.nativeElement.classList;for(const c of D7)this._hasHostAttributes(c.selector)&&c.mdcClasses.forEach(h=>{o.add(h)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t="program",n){t?this._focusMonitor.focusVia(this._elementRef.nativeElement,t,n):this._elementRef.nativeElement.focus(n)}_hasHostAttributes(...t){return t.some(n=>this._elementRef.nativeElement.hasAttribute(n))}_isRippleDisabled(){return this.disableRipple||this.disabled}}return i.\u0275fac=function(t){d.$Z()},i.\u0275dir=d.lG2({type:i,viewQuery:function(t,n){if(1&t&&d.Gf(xS,5),2&t){let r;d.iGM(r=d.CRH())&&(n.ripple=r.first)}},features:[d.qOj]}),i})(),G$=(()=>{class i extends k7{constructor(t,n,r,s){super(t,n,r,s)}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(d.SBq),d.Y36(ao),d.Y36(d.R0b),d.Y36(d.QbO,8))},i.\u0275cmp=d.Xpm({type:i,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:7,hostBindings:function(t,n){2&t&&(d.uIk("disabled",n.disabled||null),d.ekj("_mat-animation-noopable","NoopAnimations"===n._animationMode)("mat-unthemed",!n.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[d.qOj],attrs:I7,ngContentSelectors:S7,decls:8,vars:6,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],["matRipple","",1,"mat-mdc-button-ripple",3,"matRippleDisabled","matRippleTrigger"],[1,"mat-mdc-button-touch-target"]],template:function(t,n){1&t&&(d.F$t(C7),d._UZ(0,"span",0),d.Hsn(1),d.TgZ(2,"span",1),d.Hsn(3,1),d.qZA(),d.Hsn(4,2),d._UZ(5,"span",2)(6,"span",3)(7,"span",4)),2&t&&(d.ekj("mdc-button__ripple",!n._isFab)("mdc-fab__ripple",n._isFab),d.xp6(6),d.Q6J("matRippleDisabled",n._isRippleDisabled())("matRippleTrigger",n._elementRef.nativeElement))},dependencies:[xS],styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(\n      100% + 4px\n    );width:calc(\n      100% + 4px\n    );display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{height:var(--mdc-text-button-container-height, 36px);border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, inherit)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button{height:var(--mdc-filled-button-container-height, 36px);border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color, transparent)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, inherit)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button{height:var(--mdc-protected-button-container-height, 36px);border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px));box-shadow:var(--mdc-protected-button-container-elevation, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color, transparent)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, inherit)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button.mdc-ripple-upgraded--background-focused,.mat-mdc-raised-button:not(.mdc-ripple-upgraded):focus{box-shadow:var(--mdc-protected-button-focus-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled):active{box-shadow:var(--mdc-protected-button-pressed-container-elevation, 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button{height:var(--mdc-outlined-button-container-height, 36px);border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px));padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, inherit)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width, 1px));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width, 1px))}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-button .mat-ripple-element,.mat-mdc-unelevated-button .mat-ripple-element,.mat-mdc-raised-button .mat-ripple-element,.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button[disabled],.mat-mdc-unelevated-button[disabled],.mat-mdc-raised-button[disabled],.mat-mdc-outlined-button[disabled]{cursor:default;pointer-events:none}.mat-mdc-button .mat-mdc-button-touch-target,.mat-mdc-unelevated-button .mat-mdc-button-touch-target,.mat-mdc-raised-button .mat-mdc-button-touch-target,.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}[dir=rtl] .mat-mdc-button>.mat-icon,.mat-mdc-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}.mat-mdc-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon,.mat-mdc-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem;margin-left:-4px;margin-right:8px}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:-4px}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon,.mat-mdc-raised-button .mdc-button__label+.mat-icon,.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:-4px}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon,.mat-mdc-unelevated-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-raised-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-outlined-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:-4px;margin-right:8px}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px) * -1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),i})(),O7=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({imports:[js,F1,js]}),i})();const P7=["videoPlayer"];function L7(i,e){if(1&i){const t=d.EpF();d.TgZ(0,"div",28)(1,"a",29),d.NdJ("click",function(){const r=d.CHM(t),s=r.index,o=r.$implicit,c=d.oxw();return c.createCollection(s,o.name),d.KtG(c.changeChannel(s,!0))}),d._uU(2),d.qZA()()}if(2&i){const t=e.$implicit,n=e.index,r=d.oxw();d.xp6(1),d.ekj("active",r.activeLocalChannel===n),d.xp6(1),d.AsE(" ",n,". ",t.name," ")}}function N7(i,e){if(1&i){const t=d.EpF();d.TgZ(0,"button",30),d.NdJ("click",function(){d.CHM(t);const r=d.oxw();return d.KtG(r.auth.loginWithGoogle())}),d._uU(1," Sign In "),d.qZA()}}function F7(i,e){if(1&i){const t=d.EpF();d.TgZ(0,"button",31),d.NdJ("click",function(){d.CHM(t);const r=d.oxw();return d.KtG(r.auth.logout())}),d._uU(1," Sign Out "),d.qZA()}}function B7(i,e){if(1&i){const t=d.EpF();d.TgZ(0,"button",32),d.NdJ("click",function(){const s=d.CHM(t).$implicit,o=d.oxw();return d.KtG(o.updateChannelIndex(s))}),d._uU(1),d.qZA()}if(2&i){const t=e.$implicit;d.xp6(1),d.hij(" ",t," ")}}const U7=function(){return[1,2,3,4,5,6,7,8,9]};let V7=(()=>{var i;class e{constructor(n,r,s,o,c,h,m,g,y){this.route=n,this.router=r,this.store=s,this.auth=o,this.afAuth=c,this.firestore=h,this.ngZone=m,this.dialog=g,this.mediaMatcher=y,this.documentRef=null,this.volumeLevel=0,this.activeLocalChannel=-1,this.activeGlobalChannel=-1,this.channelIndex=0,this.hls=new ml,this.currentTime=new Date;const E=y.matchMedia("(max-width: 500px)");E.addEventListener("change",()=>{this.ngZone.run(()=>{this.isMobileScreen=E.matches,this.isMobileScreen&&this.dialog.closeAll()})}),this.isMobileScreen=E.matches}handleKeyboardEvent(n){"ArrowLeft"===n.key?this.changeChannel(this.activeLocalChannel-1,!0):"ArrowRight"===n.key&&this.changeChannel(this.activeLocalChannel+1,!0)}createCollection(n,r){var s=this;return(0,Ie.Z)(function*(){const o=yield s.afAuth.currentUser,c=s.firestore.collection("users"),h=o?.uid;if(o){const m=o.displayName;console.log("username",o);const g={SelectedIndex:n,ChannelName:r,IncreaseVolume:30,DecreaseVolume:30,key:"",username:m};s.data=g;const y=c.doc(h);return s.documentRef=y.ref,g.key=y.ref.id,y.set(g).then(()=>{s.documentRef&&oS(s.documentRef,{SelectedIndex:n})}).catch(E=>{}),s.unsubscribe=y1(s.documentRef,E=>{const x=E.data();x&&s.router.navigate(["/display",x.ChannelName,x.SelectedIndex])}),y}throw new Error("User is not authenticated.")})()}ngOnInit(){this.auth.isLoading=!0,this.afAuth.authState.subscribe(n=>{n&&this.ngZone.run(()=>{this.auth.isLoading=!1,this.userData=n,this.auth.userDataAuth=this.userData,this.firestore.collection("users").doc(this.userData?.uid).valueChanges().subscribe(r=>{if(r&&r.ChannelName){const s=r.ChannelName;this.selectedIndex=r.SelectedIndex||0,this.router.navigate(["/display",s,this.selectedIndex])}}),console.log("User is authenticated",this.userData??"UID not available")})}),window.innerWidth>500&&this.dialog.open(s7,{width:"550px",data:{title:"Dialog Title",message:"Hello, this is the dialog content!"}}),setInterval(()=>{this.currentTime=new Date},1e3),this.fetchData()}fetchData(){this.afAuth.authState.subscribe(n=>{n?(this.userData=n,this.firestore.doc(`users/${n.uid}`).valueChanges().subscribe(s=>{const{SelectedIndex:o=0,ChannelName:c="",IncreaseVolume:h=0,DecreaseVolume:m=0,key:g="",username:y=null}=s||{};this.data={SelectedIndex:o,ChannelName:c,IncreaseVolume:h,DecreaseVolume:m,key:g,username:y}})):this.data={SelectedIndex:0,ChannelName:"",IncreaseVolume:0,DecreaseVolume:0,key:"",username:null}})}ngAfterViewInit(){var r,n=this;ml.isSupported()&&this.route.paramMap.subscribe(function(s){return(r=r||(0,Ie.Z)(function*(o){const c=(o.get("channelName")||"").replace(/-/g," "),h=o.get("index");if(null!==h){const g=+h;n.changeChannel(g,g<n.store.localChannels.length);const E=n.createCollection(g,c);var m;E&&(yield E).valueChanges().subscribe(function(x){return(m=m||(0,Ie.Z)(function*(S){if(S){void 0!==S.IncreaseVolume&&(n.videoplayer.nativeElement.volume=S.IncreaseVolume/100),void 0!==S.DecreaseVolume&&(n.videoplayer.nativeElement.volume=S.DecreaseVolume/100),void 0!==S.ChannelUrl&&n.activeLocalChannel===g&&(n.playChannel(S.ChannelUrl),n.isMobileDevice()&&n.enableAutoplayOnMobile());const L=(yield n.afAuth.currentUser)?.displayName;if(n.documentRef&&L){const Y=Tw(qB(),"users",n.documentRef.id);yield oS(Y,{username:L})}}})).apply(this,arguments)})}})).apply(this,arguments)})}isMobileDevice(){return this.mediaMatcher.matchMedia("(max-width: 600px)").matches}enableAutoplayOnMobile(){const n=this.videoplayer.nativeElement.play();void 0!==n&&n.catch(r=>{console.error("Autoplay prevented:",r)})}ngOnDestroy(){}playChannel(n){this.videoplayer&&this.videoplayer.nativeElement&&(n.startsWith("blob:")?fetch(n).then(r=>r.blob()).then(r=>{const s=URL.createObjectURL(r);this.videoplayer.nativeElement.src=s,this.videoplayer.nativeElement.play()}):(this.hls.loadSource(n),this.hls.attachMedia(this.videoplayer.nativeElement),this.hls.on(ml.Events.MANIFEST_PARSED,()=>{this.videoplayer.nativeElement.play()})))}changeChannel(n,r){const s=r?this.store.localChannels:this.store.globalChannels;n<0?n=0:n>=s.length&&(n%=s.length),r?(this.activeLocalChannel=n,this.activeGlobalChannel=-1):(this.activeGlobalChannel=n,this.activeLocalChannel=-1),this.playChannel(s[n].url);const c=s[n].name;this.createCollection(n,c),this.router.navigate(["/display",c,n])}updateChannelIndex(n){this.channelIndex=10*this.channelIndex+n,this.changeChannelTimeout&&clearTimeout(this.changeChannelTimeout),this.changeChannelTimeout=setTimeout(()=>{this.changeChannel(this.channelIndex,!0),this.channelIndex=0},2e3),this.createCollection(this.channelIndex,this.store.localChannels[this.channelIndex].name)}increaseVolume(){this.updateVolume(.1)}decreaseVolume(){this.updateVolume(-.1)}updateVolume(n){let r=this.videoplayer.nativeElement.volume;const s=Math.max(Math.min(r+n,1),0);r!==s&&(this.videoplayer.nativeElement.volume=s,this.volumeLevel=Math.round(100*s),this.createCollection(this.activeLocalChannel,this.store.localChannels[this.activeLocalChannel].name))}onChannelIndexChange(n){this.channelIndex=+n.target.value}}return(i=e).\u0275fac=function(n){return new(n||i)(d.Y36(Ku),d.Y36(gs),d.Y36(o7),d.Y36(Vm),d.Y36(od),d.Y36(gO),d.Y36(d.R0b),d.Y36(xV),d.Y36(VU))},i.\u0275cmp=d.Xpm({type:i,selectors:[["app-main-display"]],viewQuery:function(n,r){if(1&n&&d.Gf(P7,5),2&n){let s;d.iGM(s=d.CRH())&&(r.videoplayer=s.first)}},hostBindings:function(n,r){1&n&&d.NdJ("keydown",function(o){return r.handleKeyboardEvent(o)},!1,d.Jf7)},decls:53,vars:16,consts:[[1,"container"],[1,"ticker"],[1,"ticker-logo"],[1,"ticker-logo-channel"],["id","clock"],[1,"ticker-news"],[1,"row"],[1,"centre"],[1,"tv-frame"],["controls","","autoplay","",1,"w-100","video"],["videoPlayer",""],[1,"channel"],[1,"btn-channel"],["class","button",4,"ngFor","ngForOf"],[1,"remote-control"],["mat-flat-button","","color","accent","color","accent",3,"click",4,"ngIf"],["mat-flat-button","","color","accent","color","primary",3,"click",4,"ngIf"],[1,"title-remote"],[1,"volume-display"],[1,"number-display"],[1,"remote-row","col"],[1,"remote-updown","up",3,"click"],[1,"remote-updown","center"],[1,"remote-updown","down",3,"click"],[1,"channel-input"],[1,"number-buttons"],["class","num",3,"click",4,"ngFor","ngForOf"],[1,"num","zero",3,"click"],[1,"button"],["matRipple","",3,"click"],["mat-flat-button","","color","accent","color","accent",3,"click"],["mat-flat-button","","color","accent","color","primary",3,"click"],[1,"num",3,"click"]],template:function(n,r){1&n&&(d.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"p",4),d._uU(5),d.ALo(6,"date"),d.qZA()()(),d.TgZ(7,"div",5)(8,"p"),d._uU(9," \u17a2\u17d2\u1793\u1780\u17a2\u17b6\u1785\u1798\u17be\u179b\u1791\u17bc\u179a\u1791\u179f\u17d2\u179f\u1793\u17cd\u1781\u17d2\u1798\u17c2\u179a\u178a\u17c2\u179b\u1798\u17b6\u1793\u1794\u17d2\u179a\u1797\u17c1\u1791\u1785\u17d2\u179a\u17be\u1793\u1794\u17d2\u179a\u179f\u17b7\u1793\u1794\u17be\u17a2\u17d2\u1793\u1780\u1785\u1784\u17cb\u17d4 \u1780\u17b6\u179a\u1785\u17bc\u179b\u1791\u17c5\u1780\u17b6\u1793\u17cb\u1791\u17b8\u1795\u17d2\u179f\u17b6\u179a\u1791\u17bc\u179a\u1791\u179f\u17d2\u179f\u1793\u17cd\u1781\u17d2\u1798\u17c2\u179a\u178a\u17c2\u179b\u1798\u17b6\u1793\u1794\u17d2\u179a\u1797\u17c1\u1791\u1785\u17d2\u179a\u17be\u1793\u1782\u17ba\u17a2\u17b6\u1785\u1787\u17b6\u1787\u1798\u17d2\u179a\u17be\u179f\u178a\u17c2\u179b\u1794\u17d2\u179a\u17be\u1794\u17d2\u179a\u17b6\u179f\u17cb\u1794\u17b6\u1793\u17d4 \u17a7\u1791\u17b6\u17a0\u179a\u178e\u17cd\u1782\u17ba\u1798\u17b6\u1793\u1780\u1798\u17d2\u1798\u179c\u17b7\u1792\u17b8 RITHY TV \u178a\u17c2\u179b\u17a2\u17b6\u1785\u1795\u17d2\u178f\u179b\u17cb\u1793\u17bc\u179c\u1791\u17bc\u179a\u1791\u179f\u17d2\u179f\u1793\u17cd\u1781\u17d2\u1798\u17c2\u179a\u1785\u17d2\u179a\u17be\u1793\u1794\u17d2\u179a\u1797\u17c1\u1791\u178a\u17bc\u1785\u1787\u17b6 Rasmey Hang Meas HDTV, MYTV, CTN, CNC, TV3, TV5, CTV9, Apsara TV, BTV News, Bayon TV, SeaTV, ETV, PNN \u1793\u17b7\u1784\u1785\u17d2\u179a\u17be\u1793\u1791\u17c0\u178f\u17d4 \u17a2\u17d2\u1793\u1780\u17a2\u17b6\u1785\u1798\u17be\u179b\u1791\u17bc\u179a\u1791\u179f\u17d2\u179f\u1793\u17cd\u1793\u17c1\u17c7\u1794\u17b6\u1793\u179b\u17be\u1782\u17d2\u179a\u17bf\u1784\u1794\u1793\u17d2\u1791\u17b6\u1793\u17cb\u179f\u1798\u17d0\u1799\u178a\u17c2\u179b\u1798\u17b6\u1793\u1794\u17d2\u179a\u1796\u17d0\u1793\u17d2\u1792\u1794\u17d2\u179a\u17be\u1794\u17d2\u179a\u17b6\u179f\u17cb\u1794\u17b6\u1793\u1787\u17b6\u1785\u17d2\u179a\u17be\u1793\u1794\u17d2\u179a\u1797\u17c1\u1791\u1793\u17c5\u1796\u17c1\u179b\u178e\u17b6\u1798\u17bd\u1799\u178a\u17c2\u179b\u17a2\u17d2\u1793\u1780\u1785\u1784\u17cb\u17d4 \u179f\u17bc\u1798\u17a2\u179a\u1782\u17bb\u178e\u17d4 "),d.qZA()()(),d.TgZ(10,"div",6)(11,"div",7)(12,"div",8),d._UZ(13,"video",9,10),d.qZA()(),d.TgZ(15,"div",11)(16,"h2"),d._uU(17,"Channels"),d.qZA(),d.TgZ(18,"div",12),d.YNc(19,L7,3,4,"div",13),d.qZA()()()(),d.TgZ(20,"div",14),d.YNc(21,N7,2,0,"button",15),d.ALo(22,"async"),d.YNc(23,F7,2,0,"button",16),d.ALo(24,"async"),d.TgZ(25,"p",17),d._uU(26,"THY SMART Remote"),d.qZA(),d.TgZ(27,"p",17),d._uU(28),d.qZA(),d.TgZ(29,"div",18),d._uU(30),d.qZA(),d.TgZ(31,"div",19),d._uU(32),d.qZA(),d.TgZ(33,"div",6)(34,"div",20)(35,"button",21),d.NdJ("click",function(){return r.increaseVolume()}),d._uU(36,"+"),d.qZA(),d.TgZ(37,"button",22),d._uU(38,"VOL"),d.qZA(),d.TgZ(39,"button",23),d.NdJ("click",function(){return r.decreaseVolume()}),d._uU(40,"-"),d.qZA()(),d.TgZ(41,"div",20)(42,"button",21),d.NdJ("click",function(){return r.changeChannel(r.selectedIndex+1,!0)}),d._uU(43," + "),d.qZA(),d.TgZ(44,"button",22),d._uU(45,"CN"),d.qZA(),d.TgZ(46,"button",23),d.NdJ("click",function(){return r.changeChannel(r.selectedIndex-1,!0)}),d._uU(47," - "),d.qZA()()(),d.TgZ(48,"div",24)(49,"div",25),d.YNc(50,B7,2,1,"button",26),d.TgZ(51,"button",27),d.NdJ("click",function(){return r.updateChannelIndex(0)}),d._uU(52,"0"),d.qZA()()()()),2&n&&(d.xp6(5),d.Oqu(d.xi3(6,8,r.currentTime,"h:mm:ssa")),d.xp6(14),d.Q6J("ngForOf",r.store.localChannels),d.xp6(2),d.Q6J("ngIf",null===d.lcZ(22,11,r.afAuth.authState)),d.xp6(2),d.Q6J("ngIf",d.lcZ(24,13,r.afAuth.authState)),d.xp6(5),d.hij(" Welcome Back ",null==r.auth.userDataAuth?null:r.auth.userDataAuth.displayName," "),d.xp6(2),d.hij("Volume: ",r.volumeLevel,""),d.xp6(2),d.hij(" Channel: ",r.channelIndex||r.data.SelectedIndex," "),d.xp6(18),d.Q6J("ngForOf",d.DdM(15,U7)))},dependencies:[ua,as,G$,xS,cs,ds],styles:['.container[_ngcontent-%COMP%]{font-family:Arial,sans-serif;min-width:100%;color:#fff;margin-top:50px;position:relative}.channel[_ngcontent-%COMP%]{padding-top:14px;background-color:#fff;margin-left:auto;z-index:99;display:flex;flex-direction:column;text-align:center}.channel[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#000}.channel[_ngcontent-%COMP%]   .btn-channel[_ngcontent-%COMP%]{padding:0 10px 10px;overflow:hidden auto;max-height:calc(100vh - 122px)}.button[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:13px;border-radius:10px;width:100%;padding-left:3px}.button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:3px;text-align:start;align-items:flex-start;flex-shrink:0;padding:11px 10px;background-color:#bbd9e9;opacity:.8;transition:opacity .3s;border-radius:10px;width:90%;cursor:pointer;font-weight:500;color:#000;margin:4px 0}.button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:1}.button[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.tv-frame[_ngcontent-%COMP%]{width:704px;height:536px;background-image:url(/assets/PngItem_1681287.png);background-size:cover;background-position:center;position:relative}@media (max-width: 1000px){.tv-frame[_ngcontent-%COMP%]{width:281.6px;height:214.4px}}.video[_ngcontent-%COMP%]{border-radius:7px;position:absolute;top:7px;left:7px;object-fit:fill;width:98.2%;height:79.4%}@media (max-width: 1000px){.video[_ngcontent-%COMP%]{border-radius:4px;top:3px;left:2.9px}}.remote-control[_ngcontent-%COMP%]{display:none}.remote-row[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:10px}.row[_ngcontent-%COMP%]{overflow:hidden;display:flex}.col[_ngcontent-%COMP%]{flex-direction:column;border-radius:50%;padding:0 10px;width:70px}.remote-button[_ngcontent-%COMP%]{margin:5px;padding:5px 10px;font-size:14px;background-color:#f0f0f0;border:none;border-radius:5px;color:#333;transition:background-color .3s ease-in-out,transform .3s ease-in-out}.remote-button[_ngcontent-%COMP%]:hover{background-color:#007bff;color:#fff}.remote-button[_ngcontent-%COMP%]:active{animation:_ngcontent-%COMP%_button-click .2s linear}.remote-updown[_ngcontent-%COMP%]{padding:20px;border:none}.up[_ngcontent-%COMP%]{border-radius:50% 50% 0 0;font-size:20px}.center[_ngcontent-%COMP%]{font-weight:500}.down[_ngcontent-%COMP%]{font-size:20px;border-radius:0 0 50% 50%}.remote-updown.up[_ngcontent-%COMP%]:hover, .remote-updown.down[_ngcontent-%COMP%]:hover{background-color:#f2f2f2}.remote-updown.up[_ngcontent-%COMP%]:active, .remote-updown.down[_ngcontent-%COMP%]:active{animation:_ngcontent-%COMP%_button-click .2s linear;background-color:#f0f0f096}@keyframes _ngcontent-%COMP%_button-click{0%{transform:scale(1)}50%{transform:scale(.9)}to{transform:scale(1)}}.number-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;justify-items:center;align-items:center}.centre[_ngcontent-%COMP%]{display:block;margin:50px auto}@media (max-width: 1000px){.centre[_ngcontent-%COMP%]{margin:0 auto}}.num[_ngcontent-%COMP%]{width:100px;height:50px;font-size:16px;background-color:#f0f0f0;border:none;border-radius:5px;color:#333;transition:background-color .3s ease-in-out,transform .3s ease-in-out;display:flex;align-items:center;justify-content:center}.num.zero[_ngcontent-%COMP%]{grid-column:span 3}.num[_ngcontent-%COMP%]:active{color:#fff;background-color:#007bff;animation:_ngcontent-%COMP%_button-click .2s linear}.volume-display[_ngcontent-%COMP%], .number-display[_ngcontent-%COMP%]{background-color:#f0f0f0;color:#000;padding:10px;margin-bottom:20px;border-radius:6px;font-size:16px}@media screen and (max-width: 600px){.container[_ngcontent-%COMP%]{display:none}.title-remote[_ngcontent-%COMP%]{color:#000!important;font-size:12px}.remote-control[_ngcontent-%COMP%]{display:block;position:fixed;height:100vh;width:100vw;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;justify-content:center;align-items:center}.remote-control[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background-color:#fff;padding:20px;border-radius:15px}.title-remote[_ngcontent-%COMP%]{font-size:16px!important}}#clock[_ngcontent-%COMP%]{color:#fff;display:inline;font-size:14px;padding:10px;left:0;font-family:Montserrat,sans-serif;font-weight:400}.ticker[_ngcontent-%COMP%]{overflow:hidden;width:100%;position:absolute;bottom:0;left:0;font-family:KhmerOS Siemreap,sans-serif}.ticker-logo-channel[_ngcontent-%COMP%]{position:absolute;top:-48px;left:-19px;color:#2793e8;font-size:160px;font-weight:700;font-style:italic}.ticker-logo[_ngcontent-%COMP%]{position:absolute;top:8px;left:20px;z-index:10}.ticker-logo[_ngcontent-%COMP%]:before{display:table;content:"";width:100px;height:37px;border-right:5px solid #ffffff;position:absolute;top:-8px;left:-28px;background:linear-gradient(to right,#333 0%,#333 84%,#333 91%,#333 100%,#ffffff 100%)}  .mat-typography p{margin:0!important}.ticker-tip[_ngcontent-%COMP%]{width:100%;padding:6px 0;margin-left:200px;box-shadow:inset 0 -3px 3px #ffffff80;background-color:#fff;color:#111;transform:skew(-45deg)}.ticker-tip-info[_ngcontent-%COMP%]{margin-left:50px;position:relative;transform:skew(45deg)}.ticker-title[_ngcontent-%COMP%]{width:2500px;margin-top:5px;padding-bottom:5px;color:#fff;font-size:20px;text-transform:uppercase;text-shadow:0 0 2px #065b70;background:linear-gradient(135deg,#333 0%,#333 11%,#333 24%,#333 30%,#333 68%);border-bottom:5px solid #b8860b}.ticker-title[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:inline-block;margin-right:50px;animation:_ngcontent-%COMP%_title 10s infinite linear}@keyframes _ngcontent-%COMP%_title{0%{transform:translate(0)}to{transform:translate(-233px)}}.ticker-news[_ngcontent-%COMP%]{width:7000px;padding:8px 0;color:#fff;font-size:14px;text-transform:uppercase;text-shadow:0 0 5px black;background:linear-gradient(-45deg,rgba(114,39,16,.6),rgba(79,7,34,.6),rgba(18,113,147,.6),rgba(11,113,89,.6));background-size:400% 400%;animation:_ngcontent-%COMP%_gradient 15s ease infinite}.ticker-news[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:Khmer,sans-serif}@keyframes _ngcontent-%COMP%_gradient{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}.ticker-news[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:inline-block;animation:_ngcontent-%COMP%_news 50s infinite linear}@keyframes _ngcontent-%COMP%_news{0%{transform:translate(0)}to{transform:translate(-4135px)}}']}),e})(),$7=(()=>{var i;class e{constructor(n,r,s,o){this.router=n,this.firestore=r,this.auth=s,this.afAuth=o}ngOnInit(){this.afAuth.authState.subscribe(n=>{n&&this.firestore.collection("users").doc(n?.uid).valueChanges().subscribe(r=>{r&&r.ChannelName&&this.router.navigate(["/display",r.ChannelName,r.SelectedIndex])})})}}return(i=e).\u0275fac=function(n){return new(n||i)(d.Y36(gs),d.Y36(gO),d.Y36(Vm),d.Y36(od))},i.\u0275cmp=d.Xpm({type:i,selectors:[["ng-component"]],decls:0,vars:0,template:function(n,r){},encapsulation:2}),e})();const VS=["*"],H7=["content"];function j7(i,e){if(1&i){const t=d.EpF();d.TgZ(0,"div",2),d.NdJ("click",function(){d.CHM(t);const r=d.oxw();return d.KtG(r._onBackdropClicked())}),d.qZA()}if(2&i){const t=d.oxw();d.ekj("mat-drawer-shown",t._isShowingBackdrop())}}function G7(i,e){1&i&&(d.TgZ(0,"mat-drawer-content"),d.Hsn(1,2),d.qZA())}const z7=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],W7=["mat-drawer","mat-drawer-content","*"];function K7(i,e){if(1&i){const t=d.EpF();d.TgZ(0,"div",2),d.NdJ("click",function(){d.CHM(t);const r=d.oxw();return d.KtG(r._onBackdropClicked())}),d.qZA()}if(2&i){const t=d.oxw();d.ekj("mat-drawer-shown",t._isShowingBackdrop())}}function q7(i,e){1&i&&(d.TgZ(0,"mat-sidenav-content"),d.Hsn(1,2),d.qZA())}const Y7=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],Z7=["mat-sidenav","mat-sidenav-content","*"],z$={transformDrawer:cV("transform",[IS("open, open-instant",Sf({transform:"none",visibility:"visible"})),IS("void",Sf({"box-shadow":"none",visibility:"hidden"})),CS("void => open-instant",TS("0ms")),CS("void <=> open, open-instant => void",TS("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},Q7=new d.OlP("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function J7(){return!1}}),_O=new d.OlP("MAT_DRAWER_CONTAINER");let $S=(()=>{class i extends Vp{constructor(t,n,r,s,o){super(r,s,o),this._changeDetectorRef=t,this._container=n}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(d.sBO),d.Y36((0,d.Gpc)(()=>K$)),d.Y36(d.SBq),d.Y36(_y),d.Y36(d.R0b))},i.\u0275cmp=d.Xpm({type:i,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(t,n){2&t&&d.Udp("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},features:[d._Bn([{provide:Vp,useExisting:i}]),d.qOj],ngContentSelectors:VS,decls:1,vars:0,template:function(t,n){1&t&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),i})(),W$=(()=>{class i{get position(){return this._position}set position(t){(t="end"===t?"end":"start")!==this._position&&(this._isAttached&&this._updatePositionInParent(t),this._position=t,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(t){this._mode=t,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(t){this._disableClose=xs(t)}get autoFocus(){return this._autoFocus??("side"===this.mode?"dialog":"first-tabbable")}set autoFocus(t){("true"===t||"false"===t||null==t)&&(t=xs(t)),this._autoFocus=t}get opened(){return this._opened}set opened(t){this.toggle(xs(t))}constructor(t,n,r,s,o,c,h,m){this._elementRef=t,this._focusTrapFactory=n,this._focusMonitor=r,this._platform=s,this._ngZone=o,this._interactivityChecker=c,this._doc=h,this._container=m,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new pn.x,this._animationEnd=new pn.x,this._animationState="void",this.openedChange=new d.vpe(!0),this._openedStream=this.openedChange.pipe(ti(g=>g),(0,wt.U)(()=>{})),this.openedStart=this._animationStarted.pipe(ti(g=>g.fromState!==g.toState&&0===g.toState.indexOf("open")),xo(void 0)),this._closedStream=this.openedChange.pipe(ti(g=>!g),(0,wt.U)(()=>{})),this.closedStart=this._animationStarted.pipe(ti(g=>g.fromState!==g.toState&&"void"===g.toState),xo(void 0)),this._destroyed=new pn.x,this.onPositionChanged=new d.vpe,this._modeChanged=new pn.x,this.openedChange.subscribe(g=>{g?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{Mw(this._elementRef.nativeElement,"keydown").pipe(ti(g=>27===g.keyCode&&!this.disableClose&&!Bw(g)),oo(this._destroyed)).subscribe(g=>this._ngZone.run(()=>{this.close(),g.stopPropagation(),g.preventDefault()}))}),this._animationEnd.pipe(R1((g,y)=>g.fromState===y.fromState&&g.toState===y.toState)).subscribe(g=>{const{fromState:y,toState:E}=g;(0===E.indexOf("open")&&"void"===y||"void"===E&&0===y.indexOf("open"))&&this.openedChange.emit(this._opened)})}_forceFocus(t,n){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{t.removeEventListener("blur",r),t.removeEventListener("mousedown",r),t.removeAttribute("tabindex")};t.addEventListener("blur",r),t.addEventListener("mousedown",r)})),t.focus(n)}_focusByCssSelector(t,n){let r=this._elementRef.nativeElement.querySelector(t);r&&this._forceFocus(r,n)}_takeFocus(){if(!this._focusTrap)return;const t=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(n=>{!n&&"function"==typeof this._elementRef.nativeElement.focus&&t.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(t){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,t):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const t=this._doc.activeElement;return!!t&&this._elementRef.nativeElement.contains(t)}ngAfterViewInit(){this._isAttached=!0,this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState(),"end"===this._position&&this._updatePositionInParent("end")}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(t){return this.toggle(!0,t)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(t=!this.opened,n){t&&n&&(this._openedVia=n);const r=this._setOpen(t,!t&&this._isFocusWithinDrawer(),this._openedVia||"program");return t||(this._openedVia=null),r}_setOpen(t,n,r){return this._opened=t,t?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",n&&this._restoreFocus(r)),this._updateFocusTrapState(),new Promise(s=>{this.openedChange.pipe(qr(1)).subscribe(o=>s(o?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_updatePositionInParent(t){const n=this._elementRef.nativeElement,r=n.parentNode;"end"===t?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),r.insertBefore(this._anchor,n)),r.appendChild(n)):this._anchor&&this._anchor.parentNode.insertBefore(n,this._anchor)}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(d.SBq),d.Y36(bS),d.Y36(Vw),d.Y36(ao),d.Y36(d.R0b),d.Y36(Uw),d.Y36(ue,8),d.Y36(_O,8))},i.\u0275cmp=d.Xpm({type:i,selectors:[["mat-drawer"]],viewQuery:function(t,n){if(1&t&&d.Gf(H7,5),2&t){let r;d.iGM(r=d.CRH())&&(n._content=r.first)}},hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(t,n){1&t&&d.WFA("@transform.start",function(s){return n._animationStarted.next(s)})("@transform.done",function(s){return n._animationEnd.next(s)}),2&t&&(d.uIk("align",null),d.d8E("@transform",n._animationState),d.ekj("mat-drawer-end","end"===n.position)("mat-drawer-over","over"===n.mode)("mat-drawer-push","push"===n.mode)("mat-drawer-side","side"===n.mode)("mat-drawer-opened",n.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:VS,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(t,n){1&t&&(d.F$t(),d.TgZ(0,"div",0,1),d.Hsn(2),d.qZA())},dependencies:[Vp],encapsulation:2,data:{animation:[z$.transformDrawer]},changeDetection:0}),i})(),K$=(()=>{class i{get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(t){this._autosize=xs(t)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(t){this._backdropOverride=null==t?null:xs(t)}get scrollable(){return this._userContent||this._content}constructor(t,n,r,s,o,c=!1,h){this._dir=t,this._element=n,this._ngZone=r,this._changeDetectorRef=s,this._animationMode=h,this._drawers=new d.n_E,this.backdropClick=new d.vpe,this._destroyed=new pn.x,this._doCheckSubject=new pn.x,this._contentMargins={left:null,right:null},this._contentMarginChanges=new pn.x,t&&t.change.pipe(oo(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),o.change().pipe(oo(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=c}ngAfterContentInit(){this._allDrawers.changes.pipe(Ms(this._allDrawers),oo(this._destroyed)).subscribe(t=>{this._drawers.reset(t.filter(n=>!n._container||n._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(Ms(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(t=>{this._watchDrawerToggle(t),this._watchDrawerPosition(t),this._watchDrawerMode(t)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(yS(10),oo(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(t=>t.open())}close(){this._drawers.forEach(t=>t.close())}updateContentMargins(){let t=0,n=0;if(this._left&&this._left.opened)if("side"==this._left.mode)t+=this._left._getWidth();else if("push"==this._left.mode){const r=this._left._getWidth();t+=r,n-=r}if(this._right&&this._right.opened)if("side"==this._right.mode)n+=this._right._getWidth();else if("push"==this._right.mode){const r=this._right._getWidth();n+=r,t-=r}t=t||null,n=n||null,(t!==this._contentMargins.left||n!==this._contentMargins.right)&&(this._contentMargins={left:t,right:n},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(t){t._animationStarted.pipe(ti(n=>n.fromState!==n.toState),oo(this._drawers.changes)).subscribe(n=>{"open-instant"!==n.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==t.mode&&t.openedChange.pipe(oo(this._drawers.changes)).subscribe(()=>this._setContainerClass(t.opened))}_watchDrawerPosition(t){t&&t.onPositionChanged.pipe(oo(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(qr(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(t){t&&t._modeChanged.pipe(oo((0,Qu.T)(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(t){const n=this._element.nativeElement.classList,r="mat-drawer-container-has-open";t?n.add(r):n.remove(r)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(t=>{"end"==t.position?this._end=t:this._start=t}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(t=>t&&!t.disableClose&&this._canHaveBackdrop(t)).forEach(t=>t._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(t){return"side"!==t.mode||!!this._backdropOverride}_isDrawerOpen(t){return null!=t&&t.opened}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(Up,8),d.Y36(d.SBq),d.Y36(d.R0b),d.Y36(d.sBO),d.Y36(mS),d.Y36(Q7),d.Y36(d.QbO,8))},i.\u0275cmp=d.Xpm({type:i,selectors:[["mat-drawer-container"]],contentQueries:function(t,n,r){if(1&t&&(d.Suo(r,$S,5),d.Suo(r,W$,5)),2&t){let s;d.iGM(s=d.CRH())&&(n._content=s.first),d.iGM(s=d.CRH())&&(n._allDrawers=s)}},viewQuery:function(t,n){if(1&t&&d.Gf($S,5),2&t){let r;d.iGM(r=d.CRH())&&(n._userContent=r.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(t,n){2&t&&d.ekj("mat-drawer-container-explicit-backdrop",n._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[d._Bn([{provide:_O,useExisting:i}])],ngContentSelectors:W7,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,n){1&t&&(d.F$t(z7),d.YNc(0,j7,1,2,"div",0),d.Hsn(1),d.Hsn(2,1),d.YNc(3,G7,2,0,"mat-drawer-content",1)),2&t&&(d.Q6J("ngIf",n.hasBackdrop),d.xp6(3),d.Q6J("ngIf",!n._content))},dependencies:[as,$S],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),i})(),yO=(()=>{class i extends $S{constructor(t,n,r,s,o){super(t,n,r,s,o)}}return i.\u0275fac=function(t){return new(t||i)(d.Y36(d.sBO),d.Y36((0,d.Gpc)(()=>Y$)),d.Y36(d.SBq),d.Y36(_y),d.Y36(d.R0b))},i.\u0275cmp=d.Xpm({type:i,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(t,n){2&t&&d.Udp("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},features:[d._Bn([{provide:Vp,useExisting:i}]),d.qOj],ngContentSelectors:VS,decls:1,vars:0,template:function(t,n){1&t&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),i})(),q$=(()=>{class i extends W${constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(t){this._fixedInViewport=xs(t)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(t){this._fixedTopGap=py(t)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(t){this._fixedBottomGap=py(t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=d.n5z(i)))(n||i)}}(),i.\u0275cmp=d.Xpm({type:i,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(t,n){2&t&&(d.uIk("align",null),d.Udp("top",n.fixedInViewport?n.fixedTopGap:null,"px")("bottom",n.fixedInViewport?n.fixedBottomGap:null,"px"),d.ekj("mat-drawer-end","end"===n.position)("mat-drawer-over","over"===n.mode)("mat-drawer-push","push"===n.mode)("mat-drawer-side","side"===n.mode)("mat-drawer-opened",n.opened)("mat-sidenav-fixed",n.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[d.qOj],ngContentSelectors:VS,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(t,n){1&t&&(d.F$t(),d.TgZ(0,"div",0,1),d.Hsn(2),d.qZA())},dependencies:[Vp],encapsulation:2,data:{animation:[z$.transformDrawer]},changeDetection:0}),i})(),Y$=(()=>{class i extends K${}return i.\u0275fac=function(){let e;return function(n){return(e||(e=d.n5z(i)))(n||i)}}(),i.\u0275cmp=d.Xpm({type:i,selectors:[["mat-sidenav-container"]],contentQueries:function(t,n,r){if(1&t&&(d.Suo(r,yO,5),d.Suo(r,q$,5)),2&t){let s;d.iGM(s=d.CRH())&&(n._content=s.first),d.iGM(s=d.CRH())&&(n._allDrawers=s)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(t,n){2&t&&d.ekj("mat-drawer-container-explicit-backdrop",n._backdropOverride)},exportAs:["matSidenavContainer"],features:[d._Bn([{provide:_O,useExisting:i}]),d.qOj],ngContentSelectors:Z7,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,n){1&t&&(d.F$t(Y7),d.YNc(0,K7,1,2,"div",0),d.Hsn(1),d.Hsn(2,1),d.YNc(3,q7,2,0,"mat-sidenav-content",1)),2&t&&(d.Q6J("ngIf",n.hasBackdrop),d.xp6(3),d.Q6J("ngIf",!n._content))},dependencies:[as,yO],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),i})(),e9=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({imports:[Ad,js,pS,pS,js]}),i})(),t9=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({imports:[js,js]}),i})();const X$=["*"],T9=new d.OlP("MAT_LIST_CONFIG");let Zw=(()=>{class i{constructor(){this._isNonInteractive=!0,this._disableRipple=!1,this._disabled=!1,this._defaultOptions=(0,d.f3M)(T9,{optional:!0})}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=xs(t)}get disabled(){return this._disabled}set disabled(t){this._disabled=xs(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=d.lG2({type:i,hostVars:1,hostBindings:function(t,n){2&t&&d.uIk("aria-disabled",n.disabled)},inputs:{disableRipple:"disableRipple",disabled:"disabled"}}),i})(),C9=(()=>{class i extends Zw{constructor(){super(...arguments),this._isNonInteractive=!1}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=d.n5z(i)))(n||i)}}(),i.\u0275cmp=d.Xpm({type:i,selectors:[["mat-nav-list"]],hostAttrs:["role","navigation",1,"mat-mdc-nav-list","mat-mdc-list-base","mdc-list"],exportAs:["matNavList"],features:[d._Bn([{provide:Zw,useExisting:i}]),d.qOj],ngContentSelectors:X$,decls:1,vars:0,template:function(t,n){1&t&&(d.F$t(),d.Hsn(0))},styles:['@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-list-divider::after{content:"";display:block;border-bottom-width:1px;border-bottom-style:solid}}.mdc-list{margin:0;padding:8px 0;list-style-type:none}.mdc-list:focus{outline:none}.mdc-list-item__wrapper{display:block}.mdc-list-item{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;align-items:stretch;cursor:pointer}.mdc-list-item:focus{outline:none}.mdc-list-item.mdc-list-item--with-one-line{height:48px}.mdc-list-item.mdc-list-item--with-two-lines{height:64px}.mdc-list-item.mdc-list-item--with-three-lines{height:88px}.mdc-list-item.mdc-list-item--with-one-line .mdc-list-item__start{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--with-three-lines .mdc-list-item__start{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--with-one-line .mdc-list-item__end{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-two-lines .mdc-list-item__end{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--disabled,.mdc-list-item.mdc-list-item--non-interactive{cursor:auto}.mdc-list-item:not(.mdc-list-item--selected):focus::before,.mdc-list-item.mdc-ripple-upgraded--background-focused::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-list-item:not(.mdc-list-item--selected):focus::before,.mdc-list-item.mdc-ripple-upgraded--background-focused::before{border-color:CanvasText}}.mdc-list-item.mdc-list-item--selected::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:3px double rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-list-item.mdc-list-item--selected::before{border-color:CanvasText}}.mdc-list-item.mdc-list-item--selected:focus::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:3px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-list-item.mdc-list-item--selected:focus::before{border-color:CanvasText}}a.mdc-list-item{color:inherit;text-decoration:none}.mdc-list-item__start{fill:currentColor;flex-shrink:0;pointer-events:none}.mdc-list-item__end{flex-shrink:0;pointer-events:none}.mdc-list-item__content{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;align-self:center;flex:1;pointer-events:none}.mdc-list-item--with-two-lines .mdc-list-item__content,.mdc-list-item--with-three-lines .mdc-list-item__content{align-self:stretch}.mdc-list-item__content[for]{pointer-events:none}.mdc-list-item__primary-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.mdc-list-item--with-two-lines .mdc-list-item__primary-text,.mdc-list-item--with-three-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before,.mdc-list-item--with-three-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after,.mdc-list-item--with-three-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item__secondary-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;margin-top:0;line-height:normal}.mdc-list-item__secondary-text::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-list-item--with-three-lines .mdc-list-item__secondary-text{white-space:normal;line-height:20px}.mdc-list-item--with-overline .mdc-list-item__secondary-text{white-space:nowrap;line-height:auto}.mdc-list-item__overline-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:24px;content:"";vertical-align:0}.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-three-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-three-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-three-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-avatar.mdc-list-item,.mdc-list-item--with-leading-avatar.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-avatar .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-avatar .mdc-list-item__start,.mdc-list-item--with-leading-avatar .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-avatar.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-avatar .mdc-list-item__start{border-radius:50%}.mdc-list-item--with-leading-icon.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-icon.mdc-list-item,.mdc-list-item--with-leading-icon.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-icon .mdc-list-item__start{margin-left:16px;margin-right:32px}[dir=rtl] .mdc-list-item--with-leading-icon .mdc-list-item__start,.mdc-list-item--with-leading-icon .mdc-list-item__start[dir=rtl]{margin-left:32px;margin-right:16px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-icon.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-thumbnail.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-thumbnail.mdc-list-item,.mdc-list-item--with-leading-thumbnail.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-thumbnail .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-thumbnail .mdc-list-item__start,.mdc-list-item--with-leading-thumbnail .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-image.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-image.mdc-list-item,.mdc-list-item--with-leading-image.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-image .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-image .mdc-list-item__start,.mdc-list-item--with-leading-image .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-image.mdc-list-item--with-one-line{height:72px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:8px}.mdc-list-item--with-leading-video.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-video.mdc-list-item,.mdc-list-item--with-leading-video.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-video .mdc-list-item__start{margin-left:0;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-video .mdc-list-item__start,.mdc-list-item--with-leading-video .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:0}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-video.mdc-list-item--with-one-line{height:72px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-checkbox.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-checkbox.mdc-list-item,.mdc-list-item--with-leading-checkbox.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-checkbox .mdc-list-item__start{margin-left:8px;margin-right:24px}[dir=rtl] .mdc-list-item--with-leading-checkbox .mdc-list-item__start,.mdc-list-item--with-leading-checkbox .mdc-list-item__start[dir=rtl]{margin-left:24px;margin-right:8px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:8px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-radio.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-radio.mdc-list-item,.mdc-list-item--with-leading-radio.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-radio .mdc-list-item__start{margin-left:8px;margin-right:24px}[dir=rtl] .mdc-list-item--with-leading-radio .mdc-list-item__start,.mdc-list-item--with-leading-radio .mdc-list-item__start[dir=rtl]{margin-left:24px;margin-right:8px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:8px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-radio.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-switch.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-switch.mdc-list-item,.mdc-list-item--with-leading-switch.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-switch .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-switch .mdc-list-item__start,.mdc-list-item--with-leading-switch .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:16px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-switch.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-trailing-icon.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-icon.mdc-list-item,.mdc-list-item--with-trailing-icon.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-icon .mdc-list-item__end{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-trailing-icon .mdc-list-item__end,.mdc-list-item--with-trailing-icon .mdc-list-item__end[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-trailing-meta.mdc-list-item--with-two-lines .mdc-list-item__end{align-self:flex-start;margin-top:0}.mdc-list-item--with-trailing-meta.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:0}.mdc-list-item--with-trailing-meta.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-meta.mdc-list-item,.mdc-list-item--with-trailing-meta.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-meta .mdc-list-item__end{margin-left:28px;margin-right:16px}[dir=rtl] .mdc-list-item--with-trailing-meta .mdc-list-item__end,.mdc-list-item--with-trailing-meta .mdc-list-item__end[dir=rtl]{margin-left:16px;margin-right:28px}.mdc-list-item--with-trailing-meta.mdc-list-item--with-two-lines .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-trailing-meta.mdc-list-item--with-two-lines .mdc-list-item__end::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-trailing-meta.mdc-list-item--with-three-lines .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-trailing-meta.mdc-list-item--with-three-lines .mdc-list-item__end::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-trailing-meta .mdc-list-item__end{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mdc-typography-caption-font-family);font-size:var(--mdc-typography-caption-font-size);line-height:var(--mdc-typography-caption-line-height);font-weight:var(--mdc-typography-caption-font-weight);letter-spacing:var(--mdc-typography-caption-letter-spacing);text-decoration:var(--mdc-typography-caption-text-decoration);text-transform:var(--mdc-typography-caption-text-transform)}.mdc-list-item--with-trailing-checkbox.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-checkbox.mdc-list-item,.mdc-list-item--with-trailing-checkbox.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-checkbox .mdc-list-item__end{margin-left:24px;margin-right:8px}[dir=rtl] .mdc-list-item--with-trailing-checkbox .mdc-list-item__end,.mdc-list-item--with-trailing-checkbox .mdc-list-item__end[dir=rtl]{margin-left:8px;margin-right:24px}.mdc-list-item--with-trailing-checkbox.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:8px}.mdc-list-item--with-trailing-radio.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-radio.mdc-list-item,.mdc-list-item--with-trailing-radio.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-radio .mdc-list-item__end{margin-left:24px;margin-right:8px}[dir=rtl] .mdc-list-item--with-trailing-radio .mdc-list-item__end,.mdc-list-item--with-trailing-radio .mdc-list-item__end[dir=rtl]{margin-left:8px;margin-right:24px}.mdc-list-item--with-trailing-radio.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:8px}.mdc-list-item--with-trailing-switch.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-switch.mdc-list-item,.mdc-list-item--with-trailing-switch.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-switch .mdc-list-item__end{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-trailing-switch .mdc-list-item__end,.mdc-list-item--with-trailing-switch .mdc-list-item__end[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-trailing-switch.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:16px}.mdc-list-item--with-overline.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-overline.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-list-item--with-overline.mdc-list-item--with-three-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-overline.mdc-list-item--with-three-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-list-item{padding-left:16px;padding-right:16px}[dir=rtl] .mdc-list-item,.mdc-list-item[dir=rtl]{padding-left:16px;padding-right:16px}.mdc-list-group .mdc-deprecated-list{padding:0}.mdc-list-group__subheader{margin:calc((3rem - 1.5rem)/2) 16px}.mdc-list-divider{padding:0;background-clip:content-box}.mdc-list-divider.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-text.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-icon.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-image.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-switch.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-radio.mdc-list-divider--with-leading-inset{padding-left:16px;padding-right:auto}[dir=rtl] .mdc-list-divider.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-text.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-icon.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-image.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-avatar.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-switch.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-radio.mdc-list-divider--with-leading-inset,.mdc-list-divider.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-text.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-icon.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-image.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-switch.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-radio.mdc-list-divider--with-leading-inset[dir=rtl]{padding-left:auto;padding-right:16px}.mdc-list-divider.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-text.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-icon.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-image.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-switch.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-radio.mdc-list-divider--with-trailing-inset{padding-left:auto;padding-right:16px}[dir=rtl] .mdc-list-divider.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-text.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-icon.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-image.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-avatar.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-switch.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-radio.mdc-list-divider--with-trailing-inset,.mdc-list-divider.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-text.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-icon.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-image.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-switch.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-radio.mdc-list-divider--with-trailing-inset[dir=rtl]{padding-left:16px;padding-right:auto}.mdc-list-divider--with-leading-video.mdc-list-divider--with-leading-inset{padding-left:0px;padding-right:auto}[dir=rtl] .mdc-list-divider--with-leading-video.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-video.mdc-list-divider--with-leading-inset[dir=rtl]{padding-left:auto;padding-right:0px}[dir=rtl] .mdc-list-divider,.mdc-list-divider[dir=rtl]{padding:0}.mdc-list-item{background-color:var(--mdc-list-list-item-container-color)}.mdc-list-item.mdc-list-item--selected{background-color:var(--mdc-list-list-item-selected-container-color)}.mdc-list-item--with-one-line{border-radius:var(--mdc-list-list-item-container-shape)}.mdc-list-item--with-one-line.mdc-list-item--with-leading-avatar,.mdc-list-item--with-one-line.mdc-list-item--with-leading-icon,.mdc-list-item--with-one-line.mdc-list-item--with-leading-thumbnail,.mdc-list-item--with-one-line.mdc-list-item--with-leading-checkbox,.mdc-list-item--with-one-line.mdc-list-item--with-leading-radio,.mdc-list-item--with-one-line.mdc-list-item--with-leading-switch{border-radius:var(--mdc-list-list-item-container-shape)}.mdc-list-item--with-one-line.mdc-list-item--with-leading-image,.mdc-list-item--with-one-line.mdc-list-item--with-leading-video{border-radius:var(--mdc-list-list-item-container-shape)}.mdc-list-item--with-two-lines{border-radius:var(--mdc-list-list-item-container-shape)}.mdc-list-item--with-two-lines.mdc-list-item--with-leading-avatar,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-icon,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-thumbnail,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-checkbox,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-radio,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-switch,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-image,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-video{border-radius:var(--mdc-list-list-item-container-shape)}.mdc-list-item--with-three-lines{border-radius:var(--mdc-list-list-item-container-shape)}.mdc-list-item.mdc-list-item--with-one-line{height:var(--mdc-list-list-item-one-line-container-height)}.mdc-list-item.mdc-list-item--with-two-lines{height:var(--mdc-list-list-item-two-line-container-height)}.mdc-list-item.mdc-list-item--with-three-lines{height:var(--mdc-list-list-item-three-line-container-height)}.mdc-list-item__primary-text{color:var(--mdc-list-list-item-label-text-color)}.mdc-list-item__primary-text{font-family:var(--mdc-list-list-item-label-text-font);line-height:var(--mdc-list-list-item-label-text-line-height);font-size:var(--mdc-list-list-item-label-text-size);font-weight:var(--mdc-list-list-item-label-text-weight);letter-spacing:var(--mdc-list-list-item-label-text-tracking)}.mdc-list-item__secondary-text{color:var(--mdc-list-list-item-supporting-text-color)}.mdc-list-item__secondary-text{font-family:var(--mdc-list-list-item-supporting-text-font);line-height:var(--mdc-list-list-item-supporting-text-line-height);font-size:var(--mdc-list-list-item-supporting-text-size);font-weight:var(--mdc-list-list-item-supporting-text-weight);letter-spacing:var(--mdc-list-list-item-supporting-text-tracking)}.mdc-list-item--with-leading-icon .mdc-list-item__start{color:var(--mdc-list-list-item-leading-icon-color)}.mdc-list-item--with-leading-icon .mdc-list-item__start{width:var(--mdc-list-list-item-leading-icon-size);height:var(--mdc-list-list-item-leading-icon-size)}.mdc-list-item--with-leading-icon .mdc-list-item__start>i{font-size:var(--mdc-list-list-item-leading-icon-size)}.mdc-list-item--with-leading-icon .mdc-list-item__start .mdc-list-item__icon{font-size:var(--mdc-list-list-item-leading-icon-size);width:var(--mdc-list-list-item-leading-icon-size);height:var(--mdc-list-list-item-leading-icon-size)}.mdc-list-item--with-leading-avatar .mdc-list-item__start{width:var(--mdc-list-list-item-leading-avatar-size);height:var(--mdc-list-list-item-leading-avatar-size)}.mdc-list-item.mdc-list-item--with-trailing-meta .mdc-list-item__end{color:var(--mdc-list-list-item-trailing-supporting-text-color)}.mdc-list-item--with-trailing-meta .mdc-list-item__end{font-family:var(--mdc-list-list-item-trailing-supporting-text-font);line-height:var(--mdc-list-list-item-trailing-supporting-text-line-height);font-size:var(--mdc-list-list-item-trailing-supporting-text-size);font-weight:var(--mdc-list-list-item-trailing-supporting-text-weight);letter-spacing:var(--mdc-list-list-item-trailing-supporting-text-tracking)}.mdc-list-item--with-trailing-icon .mdc-list-item__end{color:var(--mdc-list-list-item-trailing-icon-color)}.mdc-list-item--with-trailing-icon .mdc-list-item__end{width:var(--mdc-list-list-item-trailing-icon-size);height:var(--mdc-list-list-item-trailing-icon-size)}.mdc-list-item--with-trailing-icon .mdc-list-item__end>i{font-size:var(--mdc-list-list-item-trailing-icon-size)}.mdc-list-item--with-trailing-icon .mdc-list-item__end .mdc-list-item__icon{font-size:var(--mdc-list-list-item-trailing-icon-size);width:var(--mdc-list-list-item-trailing-icon-size);height:var(--mdc-list-list-item-trailing-icon-size)}.mdc-list-item--selected.mdc-list-item--with-trailing-icon .mdc-list-item__end{color:var(--mdc-list-list-item-selected-trailing-icon-color)}.mdc-list-item--disabled .mdc-list-item__start,.mdc-list-item--disabled .mdc-list-item__content,.mdc-list-item--disabled .mdc-list-item__end{opacity:1}.mdc-list-item--disabled .mdc-list-item__primary-text,.mdc-list-item--disabled .mdc-list-item__secondary-text,.mdc-list-item--disabled .mdc-list-item__overline-text{opacity:var(--mdc-list-list-item-disabled-label-text-opacity)}.mdc-list-item--disabled.mdc-list-item--with-leading-icon .mdc-list-item__start{color:var(--mdc-list-list-item-disabled-leading-icon-color)}.mdc-list-item--disabled.mdc-list-item--with-leading-icon .mdc-list-item__start{opacity:var(--mdc-list-list-item-disabled-leading-icon-opacity)}.mdc-list-item--disabled.mdc-list-item--with-trailing-icon .mdc-list-item__end{color:var(--mdc-list-list-item-disabled-trailing-icon-color)}.mdc-list-item--disabled.mdc-list-item--with-trailing-icon .mdc-list-item__end{opacity:var(--mdc-list-list-item-disabled-trailing-icon-opacity)}.mdc-list-item:hover .mdc-list-item__primary-text{color:var(--mdc-list-list-item-hover-label-text-color)}.mdc-list-item--with-leading-icon:hover .mdc-list-item__start{color:var(--mdc-list-list-item-hover-leading-icon-color)}.mdc-list-item--with-trailing-icon:hover .mdc-list-item__end{color:var(--mdc-list-list-item-hover-trailing-icon-color)}.mdc-list-item:focus .mdc-list-item__primary-text{color:var(--mdc-list-list-item-focus-label-text-color)}.mdc-list-item.mdc-list-item--disabled .mdc-list-item__primary-text{color:var(--mdc-list-list-item-disabled-label-text-color)}.mdc-list-item:hover::before{background-color:var(--mdc-list-list-item-hover-state-layer-color);opacity:var(--mdc-list-list-item-hover-state-layer-opacity)}.mdc-list-item.mdc-list-item--disabled::before{background-color:var(--mdc-list-list-item-disabled-state-layer-color);opacity:var(--mdc-list-list-item-disabled-state-layer-opacity)}.mdc-list-item:focus::before{background-color:var(--mdc-list-list-item-focus-state-layer-color);opacity:var(--mdc-list-list-item-focus-state-layer-opacity)}.mdc-list-item--disabled .mdc-radio,.mdc-list-item--disabled .mdc-checkbox{opacity:var(--mdc-list-list-item-disabled-label-text-opacity)}.mdc-list-item--with-leading-avatar .mat-mdc-list-item-avatar{border-radius:var(--mdc-list-list-item-leading-avatar-shape);background-color:var(--mdc-list-list-item-leading-avatar-color)}.mat-mdc-list-base{--mdc-list-list-item-container-shape:0;--mdc-list-list-item-leading-avatar-shape:50%;--mdc-list-list-item-container-color:transparent;--mdc-list-list-item-selected-container-color:transparent;--mdc-list-list-item-leading-avatar-color:transparent;--mdc-list-list-item-leading-icon-size:24px;--mdc-list-list-item-leading-avatar-size:40px;--mdc-list-list-item-trailing-icon-size:24px;--mdc-list-list-item-disabled-state-layer-color:transparent;--mdc-list-list-item-disabled-state-layer-opacity:0;--mdc-list-list-item-disabled-label-text-opacity:0.38;--mdc-list-list-item-disabled-leading-icon-opacity:0.38;--mdc-list-list-item-disabled-trailing-icon-opacity:0.38}.cdk-high-contrast-active a.mdc-list-item--activated::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active a.mdc-list-item--activated [dir=rtl]::after{right:auto;left:16px}.mat-mdc-list-base{display:block}.mat-mdc-list-base .mdc-list-item__start,.mat-mdc-list-base .mdc-list-item__end,.mat-mdc-list-base .mdc-list-item__content{pointer-events:auto}.mat-mdc-list-item,.mat-mdc-list-option{width:100%;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-list-item:not(.mat-mdc-list-item-interactive),.mat-mdc-list-option:not(.mat-mdc-list-item-interactive){cursor:default}.mat-mdc-list-item .mat-divider-inset,.mat-mdc-list-option .mat-divider-inset{position:absolute;left:0;right:0;bottom:0}.mat-mdc-list-item .mat-mdc-list-item-avatar~.mat-divider-inset,.mat-mdc-list-option .mat-mdc-list-item-avatar~.mat-divider-inset{margin-left:72px}[dir=rtl] .mat-mdc-list-item .mat-mdc-list-item-avatar~.mat-divider-inset,[dir=rtl] .mat-mdc-list-option .mat-mdc-list-item-avatar~.mat-divider-inset{margin-right:72px}.mat-mdc-list-item-interactive::before{top:0;left:0;right:0;bottom:0;position:absolute;content:"";opacity:0;pointer-events:none}.mat-mdc-list-item>.mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-list-item:focus>.mat-mdc-focus-indicator::before{content:""}.mat-mdc-list-item.mdc-list-item--with-three-lines .mat-mdc-list-item-line.mdc-list-item__secondary-text{white-space:nowrap;line-height:normal}.mat-mdc-list-item.mdc-list-item--with-three-lines .mat-mdc-list-item-unscoped-content.mdc-list-item__secondary-text{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}mat-action-list button{background:none;color:inherit;border:none;font:inherit;outline:inherit;-webkit-tap-highlight-color:rgba(0,0,0,0);text-align:left}[dir=rtl] mat-action-list button{text-align:right}mat-action-list button::-moz-focus-inner{border:0}'],encapsulation:2,changeDetection:0}),i})(),k9=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({imports:[BU,Ad,js,F1,j5,t9]}),i})();function R9(i,e){if(1&i&&d._UZ(0,"img",11),2&i){const t=d.oxw();d.s9C("src",null==t.auth||null==t.auth.userDataAuth?null:t.auth.userDataAuth.photoURL,d.LSH)}}function M9(i,e){if(1&i){const t=d.EpF();d.TgZ(0,"button",12),d.NdJ("click",function(){d.CHM(t);const r=d.oxw();return d.KtG(r.auth.loginWithGoogle())}),d._uU(1," Sign In "),d.qZA()}}function O9(i,e){if(1&i){const t=d.EpF();d.TgZ(0,"button",13),d.NdJ("click",function(){d.CHM(t);const r=d.oxw();return d.KtG(r.auth.logout())}),d._uU(1," Sign Out "),d.qZA()}}let P9=(()=>{var i;class e{constructor(n,r,s){this.auth=n,this.afAuth=r,this.breakpointObserver=s,this.isMobileScreen=!1,this.navbarWidth="calc(100vw - 233px)"}login(){this.auth.loginWithGoogle()}ngOnInit(){this.breakpointObserver.observe([vS_Handset,vS_Small]).subscribe(n=>{this.isMobileScreen=n.matches,this.navbarWidth=this.isMobileScreen?"100vw":"calc(100vw - 233px)"})}}return(i=e).\u0275fac=function(n){return new(n||i)(d.Y36(Vm),d.Y36(od),d.Y36(M1))},i.\u0275cmp=d.Xpm({type:i,selectors:[["app-navbar"]],decls:21,vars:10,consts:[[1,"navbar"],[1,"navbar-logo"],["href","/"],["class","wtf","alt","",3,"src",4,"ngIf"],[1,"navbar-menu"],[1,"navbar-item"],["href","/about"],["href","/contact"],[1,"navbar-auth"],["mat-flat-button","","color","accent","color","accent",3,"click",4,"ngIf"],["mat-flat-button","","color","accent","color","primary",3,"click",4,"ngIf"],["alt","",1,"wtf",3,"src"],["mat-flat-button","","color","accent","color","accent",3,"click"],["mat-flat-button","","color","accent","color","primary",3,"click"]],template:function(n,r){1&n&&(d.TgZ(0,"nav",0)(1,"div",1)(2,"a",2),d._uU(3),d.qZA(),d.YNc(4,R9,1,1,"img",3),d.qZA(),d.TgZ(5,"ul",4)(6,"li",5)(7,"a",2),d._uU(8,"Home"),d.qZA()(),d.TgZ(9,"li",5)(10,"a",6),d._uU(11,"About"),d.qZA()(),d.TgZ(12,"li",5)(13,"a",7),d._uU(14,"Contact"),d.qZA()()(),d.TgZ(15,"ul",8)(16,"li",5),d.YNc(17,M9,2,0,"button",9),d.ALo(18,"async"),d.YNc(19,O9,2,0,"button",10),d.ALo(20,"async"),d.qZA()()()),2&n&&(d.Udp("width",r.navbarWidth),d.xp6(3),d.hij(" ",null==r.auth.userDataAuth?null:r.auth.userDataAuth.displayName,""),d.xp6(1),d.Q6J("ngIf",null==r.auth?null:r.auth.userDataAuth),d.xp6(13),d.Q6J("ngIf",null===d.lcZ(18,6,r.afAuth.authState)),d.xp6(2),d.Q6J("ngIf",d.lcZ(20,8,r.afAuth.authState)))},dependencies:[as,G$,cs],styles:['.navbar[_ngcontent-%COMP%]{position:fixed;top:0;right:0;background-color:#4e6b7b;color:#fff;display:flex;justify-content:space-between;align-items:center;height:50px;z-index:999;width:calc(100vw - 233px)}.wtf[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;object-fit:cover}.navbar-logo[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:10px;gap:10px}.navbar-logo[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-weight:500;color:#fff;font-size:16px;text-decoration:none}.navbar-menu[_ngcontent-%COMP%]{list-style:none;padding:0}.navbar-item[_ngcontent-%COMP%]{display:inline-block;margin-right:10px}.navbar-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:none;position:relative;transition:color .2s ease-in-out}.navbar-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before{content:"";position:absolute;bottom:-2px;left:0;width:100%;height:2px;background-color:#fff;transform:scaleX(0);transition:transform .2s ease-in-out}.navbar-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#bbb}.navbar-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:before{transform:scaleX(1)}@media screen and (max-width: 600px){*[_ngcontent-%COMP%]{display:none;background-color:transparent!important}}']}),e})();function L9(i,e){if(1&i&&(d.TgZ(0,"a",2),d._uU(1),d.qZA()),2&i){const t=e.$implicit;d.xp6(1),d.hij(" ",t," ")}}let N9=(()=>{var i;class e{}return(i=e).\u0275fac=function(n){return new(n||i)},i.\u0275cmp=d.Xpm({type:i,selectors:[["app-btn-charthub"]],inputs:{items:"items",activeLocalChannel:"activeLocalChannel"},decls:2,vars:1,consts:[[1,"button"],["matRipple","",4,"ngFor","ngForOf"],["matRipple",""]],template:function(n,r){1&n&&(d.TgZ(0,"div",0),d.YNc(1,L9,2,1,"a",1),d.qZA()),2&n&&(d.xp6(1),d.Q6J("ngForOf",r.items))},dependencies:[ua,xS],styles:[".button[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:13px;scrollbar-width:none;border-radius:10px;width:100%;padding-left:3px}.button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:3px;align-items:start;flex-shrink:0;padding:11px 10px;background-color:#bbd9e9;opacity:.8;transition:opacity .3s;border-radius:10px;width:90%;cursor:pointer;font-weight:500}.button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:1}"]}),e})();const F9=["sidenav"],B9=[{path:"",component:jv,children:[{path:"",redirectTo:"",pathMatch:"full"},{path:"",component:(()=>{var i;class e{constructor(n){this.breakpointObserver=n,this.items=["TV","Movie","Traffic"],this.logoSrc="assets/logo-02.gif"}ngOnInit(){this.breakpointObserver.observe([vS_Handset,vS_Small]).subscribe(n=>{this.isMobileScreen=n.matches,this.isMobileScreen?this.sidenav.close():this.sidenav.open()})}toggleSidenav(){this.isMobileScreen&&this.sidenav.toggle()}disableContextMenu(n){n.preventDefault()}}return(i=e).\u0275fac=function(n){return new(n||i)(d.Y36(M1))},i.\u0275cmp=d.Xpm({type:i,selectors:[["app-sidenav"]],viewQuery:function(n,r){if(1&n&&d.Gf(F9,5),2&n){let s;d.iGM(s=d.CRH())&&(r.sidenav=s.first)}},decls:10,vars:3,consts:[[1,"sidenav-container"],["mode","side",3,"opened"],["sidenav",""],[1,"logo"],["id","logo-image",3,"src","contextmenu"],[3,"items"],[1,"sidenav-content"]],template:function(n,r){1&n&&(d.TgZ(0,"mat-sidenav-container",0)(1,"mat-sidenav",1,2)(3,"div",3)(4,"img",4),d.NdJ("contextmenu",function(o){return r.disableContextMenu(o)}),d.qZA()(),d.TgZ(5,"mat-nav-list"),d._UZ(6,"app-btn-charthub",5),d.qZA()(),d.TgZ(7,"mat-sidenav-content",6),d._UZ(8,"app-navbar")(9,"router-outlet"),d.qZA()()),2&n&&(d.xp6(1),d.Q6J("opened",!r.isMobileScreen),d.xp6(3),d.Q6J("src",r.logoSrc,d.LSH),d.xp6(2),d.Q6J("items",r.items))},dependencies:[gg,q$,Y$,yO,C9,P9,N9],styles:[".sidebar{background-color:#bbd9e9;height:100vh}  .text-a{color:#fff!important}.sidenav-content[_ngcontent-%COMP%]{background-color:#71a4be}.logo[_ngcontent-%COMP%]{display:inline-block;position:relative;width:90px}.logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:200px;transition:transform .3s ease}.logo[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{transform:rotate(180deg)}.toggle-button[_ngcontent-%COMP%]{position:absolute;top:10px;left:10px;z-index:2}.sidenav-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh}.sidenav-content[_ngcontent-%COMP%]{flex-grow:1}@media screen and (max-width: 600px){.sidenav-container[_ngcontent-%COMP%]{justify-content:flex-start}.sidenav-container[_ngcontent-%COMP%] > mat-sidenav[_ngcontent-%COMP%]{display:none}.sidenav-content[_ngcontent-%COMP%] > .content[_ngcontent-%COMP%] > app-navbar[_ngcontent-%COMP%]{display:none}}"]}),e})(),children:[{path:"",redirectTo:"display/default-channel/draftChannel",pathMatch:"full"},{path:"display/:channelName/:index",component:V7}]}]},{path:"redirect",component:$7},{path:"**",redirectTo:"redirect"}];let U9=(()=>{var i;class e{}return(i=e).\u0275fac=function(n){return new(n||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({imports:[dA.forRoot(B9),dA]}),e})();function r3(i){return new d.vHH(3e3,!1)}function bK(){return typeof window<"u"&&typeof window.document<"u"}function vO(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function Rf(i){switch(i.length){case 0:return new Hw;case 1:return i[0];default:return new pV(i)}}function s3(i,e,t,n,r=new Map,s=new Map){const o=[],c=[];let h=-1,m=null;if(n.forEach(g=>{const y=g.get("offset"),E=y==h,x=E&&m||new Map;g.forEach((S,R)=>{let L=R,G=S;if("offset"!==R)switch(L=e.normalizePropertyName(L,o),G){case B1:G=r.get(R);break;case Ed:G=s.get(R);break;default:G=e.normalizeStyleValue(R,L,G,o)}x.set(L,G)}),E||c.push(x),m=x,h=y}),o.length)throw function lK(i){return new d.vHH(3502,!1)}();return c}function bO(i,e,t,n){switch(e){case"start":i.onStart(()=>n(t&&wO(t,"start",i)));break;case"done":i.onDone(()=>n(t&&wO(t,"done",i)));break;case"destroy":i.onDestroy(()=>n(t&&wO(t,"destroy",i)))}}function wO(i,e,t){const s=EO(i.element,i.triggerName,i.fromState,i.toState,e||i.phaseName,t.totalTime??i.totalTime,!!t.disabled),o=i._data;return null!=o&&(s._data=o),s}function EO(i,e,t,n,r="",s=0,o){return{element:i,triggerName:e,fromState:t,toState:n,phaseName:r,totalTime:s,disabled:!!o}}function Ha(i,e,t){let n=i.get(e);return n||i.set(e,n=t),n}function o3(i){const e=i.indexOf(":");return[i.substring(1,e),i.slice(e+1)]}let xO=(i,e)=>!1,a3=(i,e,t)=>[],l3=null;function TO(i){const e=i.parentNode||i.host;return e===l3?null:e}(vO()||typeof Element<"u")&&(bK()?(l3=(()=>document.documentElement)(),xO=(i,e)=>{for(;e;){if(e===i)return!0;e=TO(e)}return!1}):xO=(i,e)=>i.contains(e),a3=(i,e,t)=>{if(t)return Array.from(i.querySelectorAll(e));const n=i.querySelector(e);return n?[n]:[]});let Kp=null,c3=!1;const u3=xO,d3=a3;let h3=(()=>{class i{validateStyleProperty(t){return function EK(i){Kp||(Kp=function xK(){return typeof document<"u"?document.body:null}()||{},c3=!!Kp.style&&"WebkitAppearance"in Kp.style);let e=!0;return Kp.style&&!function wK(i){return"ebkit"==i.substring(1,6)}(i)&&(e=i in Kp.style,!e&&c3&&(e="Webkit"+i.charAt(0).toUpperCase()+i.slice(1)in Kp.style)),e}(t)}matchesElement(t,n){return!1}containsElement(t,n){return u3(t,n)}getParentElement(t){return TO(t)}query(t,n,r){return d3(t,n,r)}computeStyle(t,n,r){return r||""}animate(t,n,r,s,o,c=[],h){return new Hw(r,s)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac}),i})(),IO=(()=>{class i{}return i.NOOP=new h3,i})();const TK=1e3,CO="ng-enter",HS="ng-leave",jS="ng-trigger",GS=".ng-trigger",m3="ng-animating",SO=".ng-animating";function xd(i){if("number"==typeof i)return i;const e=i.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:DO(parseFloat(e[1]),e[2])}function DO(i,e){return"s"===e?i*TK:i}function zS(i,e,t){return i.hasOwnProperty("duration")?i:function CK(i,e,t){let r,s=0,o="";if("string"==typeof i){const c=i.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===c)return e.push(r3()),{duration:0,delay:0,easing:""};r=DO(parseFloat(c[1]),c[2]);const h=c[3];null!=h&&(s=DO(parseFloat(h),c[4]));const m=c[5];m&&(o=m)}else r=i;if(!t){let c=!1,h=e.length;r<0&&(e.push(function V9(){return new d.vHH(3100,!1)}()),c=!0),s<0&&(e.push(function $9(){return new d.vHH(3101,!1)}()),c=!0),c&&e.splice(h,0,r3())}return{duration:r,delay:s,easing:o}}(i,e,t)}function Xw(i,e={}){return Object.keys(i).forEach(t=>{e[t]=i[t]}),e}function p3(i){const e=new Map;return Object.keys(i).forEach(t=>{e.set(t,i[t])}),e}function Mf(i,e=new Map,t){if(t)for(let[n,r]of t)e.set(n,r);for(let[n,r]of i)e.set(n,r);return e}function _3(i,e,t){return t?e+":"+t+";":""}function y3(i){let e="";for(let t=0;t<i.style.length;t++){const n=i.style.item(t);e+=_3(0,n,i.style.getPropertyValue(n))}for(const t in i.style)i.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=_3(0,kK(t),i.style[t]));i.setAttribute("style",e)}function fu(i,e,t){i.style&&(e.forEach((n,r)=>{const s=kO(r);t&&!t.has(r)&&t.set(r,i.style[s]),i.style[s]=n}),vO()&&y3(i))}function qp(i,e){i.style&&(e.forEach((t,n)=>{const r=kO(n);i.style[r]=""}),vO()&&y3(i))}function Qw(i){return Array.isArray(i)?1==i.length?i[0]:dV(i):i}const AO=new RegExp("{{\\s*(.+?)\\s*}}","g");function v3(i){let e=[];if("string"==typeof i){let t;for(;t=AO.exec(i);)e.push(t[1]);AO.lastIndex=0}return e}function Jw(i,e,t){const n=i.toString(),r=n.replace(AO,(s,o)=>{let c=e[o];return null==c&&(t.push(function j9(i){return new d.vHH(3003,!1)}()),c=""),c.toString()});return r==n?i:r}function WS(i){const e=[];let t=i.next();for(;!t.done;)e.push(t.value),t=i.next();return e}const AK=/-+([a-z0-9])/g;function kO(i){return i.replace(AK,(...e)=>e[1].toUpperCase())}function kK(i){return i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function ja(i,e,t){switch(e.type){case 7:return i.visitTrigger(e,t);case 0:return i.visitState(e,t);case 1:return i.visitTransition(e,t);case 2:return i.visitSequence(e,t);case 3:return i.visitGroup(e,t);case 4:return i.visitAnimate(e,t);case 5:return i.visitKeyframes(e,t);case 6:return i.visitStyle(e,t);case 8:return i.visitReference(e,t);case 9:return i.visitAnimateChild(e,t);case 10:return i.visitAnimateRef(e,t);case 11:return i.visitQuery(e,t);case 12:return i.visitStagger(e,t);default:throw function G9(i){return new d.vHH(3004,!1)}()}}function b3(i,e){return window.getComputedStyle(i)[e]}const YS="*";function NK(i,e){const t=[];return"string"==typeof i?i.split(/\s*,\s*/).forEach(n=>function FK(i,e,t){if(":"==i[0]){const h=function BK(i,e){switch(i){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(function rK(i){return new d.vHH(3016,!1)}()),"* => *"}}(i,t);if("function"==typeof h)return void e.push(h);i=h}const n=i.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(function iK(i){return new d.vHH(3015,!1)}()),e;const r=n[1],s=n[2],o=n[3];e.push(w3(r,o));"<"==s[0]&&!(r==YS&&o==YS)&&e.push(w3(o,r))}(n,t,e)):t.push(i),t}const ZS=new Set(["true","1"]),XS=new Set(["false","0"]);function w3(i,e){const t=ZS.has(i)||XS.has(i),n=ZS.has(e)||XS.has(e);return(r,s)=>{let o=i==YS||i==r,c=e==YS||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?ZS.has(i):XS.has(i)),!c&&n&&"boolean"==typeof s&&(c=s?ZS.has(e):XS.has(e)),o&&c}}const UK=new RegExp("s*:selfs*,?","g");function RO(i,e,t,n){return new VK(i).build(e,t,n)}class VK{constructor(e){this._driver=e}build(e,t,n){const r=new jK(t);return this._resetContextStyleTimingState(r),ja(this,Qw(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function W9(){return new d.vHH(3006,!1)}()),e.definitions.forEach(c=>{if(this._resetContextStyleTimingState(t),0==c.type){const h=c,m=h.name;m.toString().split(/\s*,\s*/).forEach(g=>{h.name=g,s.push(this.visitState(h,t))}),h.name=m}else if(1==c.type){const h=this.visitTransition(c,t);n+=h.queryCount,r+=h.depCount,o.push(h)}else t.errors.push(function K9(){return new d.vHH(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:n,depCount:r,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){const s=new Set,o=r||{};n.styles.forEach(c=>{c instanceof Map&&c.forEach(h=>{v3(h).forEach(m=>{o.hasOwnProperty(m)||s.add(m)})})}),s.size&&(WS(s.values()),t.errors.push(function q9(i,e){return new d.vHH(3008,!1)}()))}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=ja(this,Qw(e.animation),t);return{type:1,matchers:NK(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:Yp(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(n=>ja(this,n,t)),options:Yp(e.options)}}visitGroup(e,t){const n=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=n;const c=ja(this,o,t);return r=Math.max(r,t.currentTime),c});return t.currentTime=r,{type:3,steps:s,options:Yp(e.options)}}visitAnimate(e,t){const n=function zK(i,e){if(i.hasOwnProperty("duration"))return i;if("number"==typeof i)return MO(zS(i,e).duration,0,"");const t=i;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=MO(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=zS(t,e);return MO(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let r,s=e.styles?e.styles:Sf({});if(5==s.type)r=this.visitKeyframes(s,t);else{let o=e.styles,c=!1;if(!o){c=!0;const m={};n.easing&&(m.easing=n.easing),o=Sf(m)}t.currentTime+=n.duration+n.delay;const h=this.visitStyle(o,t);h.isEmptyStep=c,r=h}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let c of r)"string"==typeof c?c===Ed?n.push(c):t.errors.push(new d.vHH(3002,!1)):n.push(p3(c));let s=!1,o=null;return n.forEach(c=>{if(c instanceof Map&&(c.has("easing")&&(o=c.get("easing"),c.delete("easing")),!s))for(let h of c.values())if(h.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:n,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;n&&s>0&&(s-=n.duration+n.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((c,h)=>{const m=t.collectedStyles.get(t.currentQuerySelector),g=m.get(h);let y=!0;g&&(s!=r&&s>=g.startTime&&r<=g.endTime&&(t.errors.push(function Z9(i,e,t,n,r){return new d.vHH(3010,!1)}()),y=!1),s=g.startTime),y&&m.set(h,{startTime:s,endTime:r}),t.options&&function DK(i,e,t){const n=e.params||{},r=v3(i);r.length&&r.forEach(s=>{n.hasOwnProperty(s)||t.push(function H9(i){return new d.vHH(3001,!1)}())})}(c,t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function X9(){return new d.vHH(3011,!1)}()),n;let s=0;const o=[];let c=!1,h=!1,m=0;const g=e.steps.map(G=>{const Y=this._makeStyleAst(G,t);let K=null!=Y.offset?Y.offset:function GK(i){if("string"==typeof i)return null;let e=null;if(Array.isArray(i))i.forEach(t=>{if(t instanceof Map&&t.has("offset")){const n=t;e=parseFloat(n.get("offset")),n.delete("offset")}});else if(i instanceof Map&&i.has("offset")){const t=i;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(Y.styles),te=0;return null!=K&&(s++,te=Y.offset=K),h=h||te<0||te>1,c=c||te<m,m=te,o.push(te),Y});h&&t.errors.push(function Q9(){return new d.vHH(3012,!1)}()),c&&t.errors.push(function J9(){return new d.vHH(3200,!1)}());const y=e.steps.length;let E=0;s>0&&s<y?t.errors.push(function eK(){return new d.vHH(3202,!1)}()):0==s&&(E=1/(y-1));const x=y-1,S=t.currentTime,R=t.currentAnimateTimings,L=R.duration;return g.forEach((G,Y)=>{const K=E>0?Y==x?1:E*Y:o[Y],te=K*L;t.currentTime=S+R.delay+te,R.duration=te,this._validateStyleAst(G,t),G.offset=K,n.styles.push(G)}),n}visitReference(e,t){return{type:8,animation:ja(this,Qw(e.animation),t),options:Yp(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Yp(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Yp(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function $K(i){const e=!!i.split(/\s*,\s*/).find(t=>":self"==t);return e&&(i=i.replace(UK,"")),i=i.replace(/@\*/g,GS).replace(/@\w+/g,t=>GS+"-"+t.slice(1)).replace(/:animating/g,SO),[i,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+s:s,Ha(t.collectedStyles,t.currentQuerySelector,new Map);const c=ja(this,Qw(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:c,originalSelector:e.selector,options:Yp(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function tK(){return new d.vHH(3013,!1)}());const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:zS(e.timings,t.errors,!0);return{type:12,animation:ja(this,Qw(e.animation),t),timings:n,options:null}}}class jK{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Yp(i){return i?(i=Xw(i)).params&&(i.params=function HK(i){return i?Xw(i):null}(i.params)):i={},i}function MO(i,e,t){return{duration:i,delay:e,easing:t}}function OO(i,e,t,n,r,s,o=null,c=!1){return{type:1,element:i,keyframes:e,preStyleProps:t,postStyleProps:n,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:c}}class QS{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const qK=new RegExp(":enter","g"),ZK=new RegExp(":leave","g");function PO(i,e,t,n,r,s=new Map,o=new Map,c,h,m=[]){return(new XK).buildKeyframes(i,e,t,n,r,s,o,c,h,m)}class XK{buildKeyframes(e,t,n,r,s,o,c,h,m,g=[]){m=m||new QS;const y=new LO(e,t,m,r,s,g,[]);y.options=h;const E=h.delay?xd(h.delay):0;y.currentTimeline.delayNextStep(E),y.currentTimeline.setStyles([o],null,y.errors,h),ja(this,n,y);const x=y.timelines.filter(S=>S.containsAnimation());if(x.length&&c.size){let S;for(let R=x.length-1;R>=0;R--){const L=x[R];if(L.element===t){S=L;break}}S&&!S.allowOnlyTimelineStyles()&&S.setStyles([c],null,y.errors,h)}return x.length?x.map(S=>S.buildKeyframes()):[OO(t,[],[],[],0,E,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(n,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,n),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,n){for(const r of e){const s=r?.delay;if(s){const o="number"==typeof s?s:xd(Jw(s,r?.params??{},t.errors));n.delayNextStep(o)}}}_visitSubInstructions(e,t,n){let s=t.currentTimeline.currentTime;const o=null!=n.duration?xd(n.duration):null,c=null!=n.delay?xd(n.delay):null;return 0!==o&&e.forEach(h=>{const m=t.appendInstructionToTimeline(h,o,c);s=Math.max(s,m.duration+m.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),ja(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=JS);const o=xd(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>ja(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?xd(e.options.delay):0;e.steps.forEach(o=>{const c=t.createSubContext(e.options);s&&c.delayNextStep(s),ja(this,o,c),r=Math.max(r,c.currentTimeline.currentTime),n.push(c.currentTimeline)}),n.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return zS(t.params?Jw(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(n.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.hasCurrentStyleProperties()&&n.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(s):n.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,r=t.currentTimeline.duration,s=n.duration,c=t.createSubContext().currentTimeline;c.easing=n.easing,e.styles.forEach(h=>{c.forwardTime((h.offset||0)*s),c.setStyles(h.styles,h.easing,t.errors,t.options),c.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(c),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?xd(r.delay):0;s&&(6===t.previousNode.type||0==n&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=JS);let o=n;const c=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=c.length;let h=null;c.forEach((m,g)=>{t.currentQueryIndex=g;const y=t.createSubContext(e.options,m);s&&y.delayNextStep(s),m===t.element&&(h=y.currentTimeline),ja(this,e.animation,y),y.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,y.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),h&&(t.currentTimeline.mergeTimelineCollectedStyles(h),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),c=o*(t.currentQueryTotal-1);let h=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":h=c-h;break;case"full":h=n.currentStaggerTime}const g=t.currentTimeline;h&&g.delayNextStep(h);const y=g.currentTime;ja(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-y+(r.startTime-n.currentTimeline.startTime)}}const JS={};class LO{constructor(e,t,n,r,s,o,c,h){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=c,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=JS,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=h||new eD(this._driver,t,0),c.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let r=this.options;null!=n.duration&&(r.duration=xd(n.duration)),null!=n.delay&&(r.delay=xd(n.delay));const s=n.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(c=>{(!t||!o.hasOwnProperty(c))&&(o[c]=Jw(s[c],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(r=>{n[r]=t[r]})}}return e}createSubContext(e=null,t,n){const r=t||this.element,s=new LO(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=JS,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(n??0)+e.delay,easing:""},s=new QK(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,r,s,o){let c=[];if(r&&c.push(this.element),e.length>0){e=(e=e.replace(qK,"."+this._enterClassName)).replace(ZK,"."+this._leaveClassName);let m=this._driver.query(this.element,e,1!=n);0!==n&&(m=n<0?m.slice(m.length+n,m.length):m.slice(0,n)),c.push(...m)}return!s&&0==c.length&&o.push(function nK(i){return new d.vHH(3014,!1)}()),c}}class eD{constructor(e,t,n,r){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new eD(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,n]of this._globalTimelineStyles)this._backFill.set(t,n||Ed),this._currentKeyframe.set(t,Ed);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},o=function JK(i,e){const t=new Map;let n;return i.forEach(r=>{if("*"===r){n=n||e.keys();for(let s of n)t.set(s,Ed)}else Mf(r,t)}),t}(e,this._globalTimelineStyles);for(let[c,h]of o){const m=Jw(h,s,n);this._pendingStyles.set(c,m),this._localTimelineStyles.has(c)||this._backFill.set(c,this._globalTimelineStyles.get(c)??Ed),this._updateStyle(c,m)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,n)=>{const r=this._styleSummary.get(n);(!r||t.time>r.time)&&this._updateStyle(n,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((c,h)=>{const m=Mf(c,new Map,this._backFill);m.forEach((g,y)=>{g===B1?e.add(y):g===Ed&&t.add(y)}),n||m.set("offset",h/this.duration),r.push(m)});const s=e.size?WS(e.values()):[],o=t.size?WS(t.values()):[];if(n){const c=r[0],h=new Map(c);c.set("offset",0),h.set("offset",1),r=[c,h]}return OO(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class QK extends eD{constructor(e,t,n,r,s,o,c=!1){super(e,t,o.delay),this.keyframes=n,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=c,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=n+t,c=t/o,h=Mf(e[0]);h.set("offset",0),s.push(h);const m=Mf(e[0]);m.set("offset",T3(c)),s.push(m);const g=e.length-1;for(let y=1;y<=g;y++){let E=Mf(e[y]);const x=E.get("offset");E.set("offset",T3((t+x*n)/o)),s.push(E)}n=o,t=0,r="",e=s}return OO(this.element,e,this.preStyleProps,this.postStyleProps,n,t,r,!0)}}function T3(i,e=3){const t=Math.pow(10,e-1);return Math.round(i*t)/t}class NO{}const eq=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class tq extends NO{normalizePropertyName(e,t){return kO(e)}normalizeStyleValue(e,t,n,r){let s="";const o=n.toString().trim();if(eq.has(t)&&0!==n&&"0"!==n)if("number"==typeof n)s="px";else{const c=n.match(/^[+-]?[\d\.]+([a-z]*)$/);c&&0==c[1].length&&r.push(function z9(i,e){return new d.vHH(3005,!1)}())}return o+s}}function I3(i,e,t,n,r,s,o,c,h,m,g,y,E){return{type:0,element:i,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:n,toStyles:o,timelines:c,queriedElements:h,preStyleProps:m,postStyleProps:g,totalTime:y,errors:E}}const FO={};class C3{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,r){return function nq(i,e,t,n,r){return i.some(s=>s(e,t,n,r))}(this.ast.matchers,e,t,n,r)}buildStyles(e,t,n){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,n):new Map}build(e,t,n,r,s,o,c,h,m,g){const y=[],E=this.ast.options&&this.ast.options.params||FO,S=this.buildStyles(n,c&&c.params||FO,y),R=h&&h.params||FO,L=this.buildStyles(r,R,y),G=new Set,Y=new Map,K=new Map,te="void"===r,oe={params:iq(R,E),delay:this.ast.options?.delay},Ae=g?[]:PO(e,t,this.ast.animation,s,o,S,L,oe,m,y);let we=0;if(Ae.forEach(ot=>{we=Math.max(ot.duration+ot.delay,we)}),y.length)return I3(t,this._triggerName,n,r,te,S,L,[],[],Y,K,we,y);Ae.forEach(ot=>{const Le=ot.element,Qt=Ha(Y,Le,new Set);ot.preStyleProps.forEach(Bn=>Qt.add(Bn));const vt=Ha(K,Le,new Set);ot.postStyleProps.forEach(Bn=>vt.add(Bn)),Le!==t&&G.add(Le)});const We=WS(G.values());return I3(t,this._triggerName,n,r,te,S,L,Ae,We,Y,K,we)}}function iq(i,e){const t=Xw(e);for(const n in i)i.hasOwnProperty(n)&&null!=i[n]&&(t[n]=i[n]);return t}class rq{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n=new Map,r=Xw(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(r[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,c)=>{o&&(o=Jw(o,r,t));const h=this.normalizer.normalizePropertyName(c,t);o=this.normalizer.normalizeStyleValue(c,h,o,t),n.set(c,o)})}),n}}class oq{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new rq(r.style,r.options&&r.options.params||{},n))}),S3(this.states,"true","1"),S3(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new C3(e,r,this.states))}),this.fallbackTransition=function aq(i,e,t){return new C3(i,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,c)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,r){return this.transitionFactories.find(o=>o.match(e,t,n,r))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function S3(i,e,t){i.has(e)?i.has(t)||i.set(t,i.get(e)):i.has(t)&&i.set(e,i.get(t))}const lq=new QS;class cq{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const n=[],r=[],s=RO(this._driver,t,n,r);if(n.length)throw function cK(i){return new d.vHH(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,n){const r=e.element,s=s3(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const r=[],s=this._animations.get(e);let o;const c=new Map;if(s?(o=PO(this._driver,t,s,CO,HS,new Map,new Map,n,lq,r),o.forEach(g=>{const y=Ha(c,g.element,new Map);g.postStyleProps.forEach(E=>y.set(E,null))})):(r.push(function uK(){return new d.vHH(3300,!1)}()),o=[]),r.length)throw function dK(i){return new d.vHH(3504,!1)}();c.forEach((g,y)=>{g.forEach((E,x)=>{g.set(x,this._driver.computeStyle(y,x,Ed))})});const m=Rf(o.map(g=>{const y=c.get(g.element);return this._buildPlayer(g,new Map,y)}));return this._playersById.set(e,m),m.onDestroy(()=>this.destroy(e)),this.players.push(m),m}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function hK(i){return new d.vHH(3301,!1)}();return t}listen(e,t,n,r){const s=EO(t,"","","");return bO(this._getPlayer(e),n,s,r),()=>{}}command(e,t,n,r){if("register"==n)return void this.register(e,r[0]);if("create"==n)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(n){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const D3="ng-animate-queued",BO="ng-animate-disabled",mq=[],A3={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},pq={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},bl="__ng_removed";class UO{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function vq(i){return i??null}(n?e.value:e),n){const s=Xw(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(r=>{null==n[r]&&(n[r]=t[r])})}}}const eE="void",VO=new UO(eE);class gq{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,wl(t,this._hostClassName)}listen(e,t,n,r){if(!this._triggers.has(t))throw function fK(i,e){return new d.vHH(3302,!1)}();if(null==n||0==n.length)throw function mK(i){return new d.vHH(3303,!1)}();if(!function bq(i){return"start"==i||"done"==i}(n))throw function pK(i,e){return new d.vHH(3400,!1)}();const s=Ha(this._elementListeners,e,[]),o={name:t,phase:n,callback:r};s.push(o);const c=Ha(this._engine.statesByElement,e,new Map);return c.has(t)||(wl(e,jS),wl(e,jS+"-"+t),c.set(t,VO)),()=>{this._engine.afterFlush(()=>{const h=s.indexOf(o);h>=0&&s.splice(h,1),this._triggers.has(t)||c.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function gK(i){return new d.vHH(3401,!1)}();return t}trigger(e,t,n,r=!0){const s=this._getTrigger(t),o=new $O(this.id,t,e);let c=this._engine.statesByElement.get(e);c||(wl(e,jS),wl(e,jS+"-"+t),this._engine.statesByElement.set(e,c=new Map));let h=c.get(t);const m=new UO(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&h&&m.absorbOptions(h.options),c.set(t,m),h||(h=VO),m.value!==eE&&h.value===m.value){if(!function xq(i,e){const t=Object.keys(i),n=Object.keys(e);if(t.length!=n.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||i[s]!==e[s])return!1}return!0}(h.params,m.params)){const R=[],L=s.matchStyles(h.value,h.params,R),G=s.matchStyles(m.value,m.params,R);R.length?this._engine.reportError(R):this._engine.afterFlush(()=>{qp(e,L),fu(e,G)})}return}const E=Ha(this._engine.playersByElement,e,[]);E.forEach(R=>{R.namespaceId==this.id&&R.triggerName==t&&R.queued&&R.destroy()});let x=s.matchTransition(h.value,m.value,e,m.params),S=!1;if(!x){if(!r)return;x=s.fallbackTransition,S=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:x,fromState:h,toState:m,player:o,isFallbackTransition:S}),S||(wl(e,D3),o.onStart(()=>{Iy(e,D3)})),o.onDone(()=>{let R=this.players.indexOf(o);R>=0&&this.players.splice(R,1);const L=this._engine.playersByElement.get(e);if(L){let G=L.indexOf(o);G>=0&&L.splice(G,1)}}),this.players.push(o),E.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,GS,!0);n.forEach(r=>{if(r[bl])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,n,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const c=[];if(s.forEach((h,m)=>{if(o.set(m,h.value),this._triggers.has(m)){const g=this.trigger(e,m,eE,r);g&&c.push(g)}}),c.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),n&&Rf(c).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const h=this._triggers.get(o).fallbackTransition,m=n.get(o)||VO,g=new UO(eE),y=new $O(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:h,fromState:m,toState:g,player:y,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(n.totalAnimations){const s=n.players.length?n.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(n.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)n.markElementAsRemoved(this.id,e,!1,t);else{const s=e[bl];(!s||s===A3)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){wl(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const s=n.element,o=this._elementListeners.get(s);o&&o.forEach(c=>{if(c.name==n.triggerName){const h=EO(s,n.triggerName,n.fromState.value,n.toState.value);h._data=e,bO(n.player,c.phase,h,c.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(n)}),this._queue=[],t.sort((n,r)=>{const s=n.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(n.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(n=>n.element===e)||t,t}}class _q{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new gq(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList,r=this.namespacesByHostElement;if(n.length-1>=0){let o=!1,c=this.driver.getParentElement(t);for(;c;){const h=r.get(c);if(h){const m=n.indexOf(h);n.splice(m+1,0,e),o=!0;break}c=this.driver.getParentElement(c)}o||n.unshift(e)}else n.push(e);return r.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}destroy(e,t){if(!e)return;const n=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[e];const r=this._namespaceList.indexOf(n);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>n.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n)for(let r of n.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,n,r){if(tD(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,n,r),!0}return!1}insertNode(e,t,n,r){if(!tD(t))return;const s=t[bl];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,n)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),wl(e,BO)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Iy(e,BO))}removeNode(e,t,n,r){if(tD(t)){const s=e?this._fetchNamespace(e):null;if(s?s.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){const o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,n,r,s){this.collectedLeaveElements.push(t),t[bl]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,n,r,s){return tD(t)?this._fetchNamespace(e).listen(t,n,r,s):()=>{}}_buildInstruction(e,t,n,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,GS,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,SO,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Rf(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[bl];if(t&&t.setForRemoval){if(e[bl]=A3,t.namespaceId){this.destroyInnerAnimations(e);const n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(BO)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,r)=>this._balanceNamespaceList(n,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)wl(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let r=0;r<n.length;r++)n[r]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?Rf(t).onDone(()=>{n.forEach(r=>r())}):n.forEach(r=>r())}}reportError(e){throw function _K(i){return new d.vHH(3402,!1)}()}_flushAnimations(e,t){const n=new QS,r=[],s=new Map,o=[],c=new Map,h=new Map,m=new Map,g=new Set;this.disabledNodes.forEach(ct=>{g.add(ct);const _t=this.driver.query(ct,".ng-animate-queued",!0);for(let He=0;He<_t.length;He++)g.add(_t[He])});const y=this.bodyNode,E=Array.from(this.statesByElement.keys()),x=M3(E,this.collectedEnterElements),S=new Map;let R=0;x.forEach((ct,_t)=>{const He=CO+R++;S.set(_t,He),ct.forEach(dt=>wl(dt,He))});const L=[],G=new Set,Y=new Set;for(let ct=0;ct<this.collectedLeaveElements.length;ct++){const _t=this.collectedLeaveElements[ct],He=_t[bl];He&&He.setForRemoval&&(L.push(_t),G.add(_t),He.hasAnimation?this.driver.query(_t,".ng-star-inserted",!0).forEach(dt=>G.add(dt)):Y.add(_t))}const K=new Map,te=M3(E,Array.from(G));te.forEach((ct,_t)=>{const He=HS+R++;K.set(_t,He),ct.forEach(dt=>wl(dt,He))}),e.push(()=>{x.forEach((ct,_t)=>{const He=S.get(_t);ct.forEach(dt=>Iy(dt,He))}),te.forEach((ct,_t)=>{const He=K.get(_t);ct.forEach(dt=>Iy(dt,He))}),L.forEach(ct=>{this.processLeaveNode(ct)})});const oe=[],Ae=[];for(let ct=this._namespaceList.length-1;ct>=0;ct--)this._namespaceList[ct].drainQueuedTransitions(t).forEach(He=>{const dt=He.player,xn=He.element;if(oe.push(dt),this.collectedEnterElements.length){const nr=xn[bl];if(nr&&nr.setForMove){if(nr.previousTriggersValues&&nr.previousTriggersValues.has(He.triggerName)){const hc=nr.previousTriggersValues.get(He.triggerName),El=this.statesByElement.get(He.element);if(El&&El.has(He.triggerName)){const pD=El.get(He.triggerName);pD.value=hc,El.set(He.triggerName,pD)}}return void dt.destroy()}}const $n=!y||!this.driver.containsElement(y,xn),Cn=K.get(xn),_i=S.get(xn),Hn=this._buildInstruction(He,n,_i,Cn,$n);if(Hn.errors&&Hn.errors.length)return void Ae.push(Hn);if($n)return dt.onStart(()=>qp(xn,Hn.fromStyles)),dt.onDestroy(()=>fu(xn,Hn.toStyles)),void r.push(dt);if(He.isFallbackTransition)return dt.onStart(()=>qp(xn,Hn.fromStyles)),dt.onDestroy(()=>fu(xn,Hn.toStyles)),void r.push(dt);const oa=[];Hn.timelines.forEach(nr=>{nr.stretchStartingKeyframe=!0,this.disabledNodes.has(nr.element)||oa.push(nr)}),Hn.timelines=oa,n.append(xn,Hn.timelines),o.push({instruction:Hn,player:dt,element:xn}),Hn.queriedElements.forEach(nr=>Ha(c,nr,[]).push(dt)),Hn.preStyleProps.forEach((nr,hc)=>{if(nr.size){let El=h.get(hc);El||h.set(hc,El=new Set),nr.forEach((pD,yP)=>El.add(yP))}}),Hn.postStyleProps.forEach((nr,hc)=>{let El=m.get(hc);El||m.set(hc,El=new Set),nr.forEach((pD,yP)=>El.add(yP))})});if(Ae.length){const ct=[];Ae.forEach(_t=>{ct.push(function yK(i,e){return new d.vHH(3505,!1)}())}),oe.forEach(_t=>_t.destroy()),this.reportError(ct)}const we=new Map,We=new Map;o.forEach(ct=>{const _t=ct.element;n.has(_t)&&(We.set(_t,_t),this._beforeAnimationBuild(ct.player.namespaceId,ct.instruction,we))}),r.forEach(ct=>{const _t=ct.element;this._getPreviousPlayers(_t,!1,ct.namespaceId,ct.triggerName,null).forEach(dt=>{Ha(we,_t,[]).push(dt),dt.destroy()})});const ot=L.filter(ct=>P3(ct,h,m)),Le=new Map;R3(Le,this.driver,Y,m,Ed).forEach(ct=>{P3(ct,h,m)&&ot.push(ct)});const vt=new Map;x.forEach((ct,_t)=>{R3(vt,this.driver,new Set(ct),h,B1)}),ot.forEach(ct=>{const _t=Le.get(ct),He=vt.get(ct);Le.set(ct,new Map([...Array.from(_t?.entries()??[]),...Array.from(He?.entries()??[])]))});const Bn=[],Or=[],mi={};o.forEach(ct=>{const{element:_t,player:He,instruction:dt}=ct;if(n.has(_t)){if(g.has(_t))return He.onDestroy(()=>fu(_t,dt.toStyles)),He.disabled=!0,He.overrideTotalTime(dt.totalTime),void r.push(He);let xn=mi;if(We.size>1){let Cn=_t;const _i=[];for(;Cn=Cn.parentNode;){const Hn=We.get(Cn);if(Hn){xn=Hn;break}_i.push(Cn)}_i.forEach(Hn=>We.set(Hn,xn))}const $n=this._buildAnimation(He.namespaceId,dt,we,s,vt,Le);if(He.setRealPlayer($n),xn===mi)Bn.push(He);else{const Cn=this.playersByElement.get(xn);Cn&&Cn.length&&(He.parentPlayer=Rf(Cn)),r.push(He)}}else qp(_t,dt.fromStyles),He.onDestroy(()=>fu(_t,dt.toStyles)),Or.push(He),g.has(_t)&&r.push(He)}),Or.forEach(ct=>{const _t=s.get(ct.element);if(_t&&_t.length){const He=Rf(_t);ct.setRealPlayer(He)}}),r.forEach(ct=>{ct.parentPlayer?ct.syncPlayerEvents(ct.parentPlayer):ct.destroy()});for(let ct=0;ct<L.length;ct++){const _t=L[ct],He=_t[bl];if(Iy(_t,HS),He&&He.hasAnimation)continue;let dt=[];if(c.size){let $n=c.get(_t);$n&&$n.length&&dt.push(...$n);let Cn=this.driver.query(_t,SO,!0);for(let _i=0;_i<Cn.length;_i++){let Hn=c.get(Cn[_i]);Hn&&Hn.length&&dt.push(...Hn)}}const xn=dt.filter($n=>!$n.destroyed);xn.length?wq(this,_t,xn):this.processLeaveNode(_t)}return L.length=0,Bn.forEach(ct=>{this.players.push(ct),ct.onDone(()=>{ct.destroy();const _t=this.players.indexOf(ct);this.players.splice(_t,1)}),ct.play()}),Bn}elementContainsData(e,t){let n=!1;const r=t[bl];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,r,s){let o=[];if(t){const c=this.playersByQueriedElement.get(e);c&&(o=c)}else{const c=this.playersByElement.get(e);if(c){const h=!s||s==eE;c.forEach(m=>{m.queued||!h&&m.triggerName!=r||o.push(m)})}}return(n||r)&&(o=o.filter(c=>!(n&&n!=c.namespaceId||r&&r!=c.triggerName))),o}_beforeAnimationBuild(e,t,n){const s=t.element,o=t.isRemovalTransition?void 0:e,c=t.isRemovalTransition?void 0:t.triggerName;for(const h of t.timelines){const m=h.element,g=m!==s,y=Ha(n,m,[]);this._getPreviousPlayers(m,g,o,c,t.toState).forEach(x=>{const S=x.getRealPlayer();S.beforeDestroy&&S.beforeDestroy(),x.destroy(),y.push(x)})}qp(s,t.fromStyles)}_buildAnimation(e,t,n,r,s,o){const c=t.triggerName,h=t.element,m=[],g=new Set,y=new Set,E=t.timelines.map(S=>{const R=S.element;g.add(R);const L=R[bl];if(L&&L.removedBeforeQueried)return new Hw(S.duration,S.delay);const G=R!==h,Y=function Eq(i){const e=[];return O3(i,e),e}((n.get(R)||mq).map(we=>we.getRealPlayer())).filter(we=>!!we.element&&we.element===R),K=s.get(R),te=o.get(R),oe=s3(0,this._normalizer,0,S.keyframes,K,te),Ae=this._buildPlayer(S,oe,Y);if(S.subTimeline&&r&&y.add(R),G){const we=new $O(e,c,R);we.setRealPlayer(Ae),m.push(we)}return Ae});m.forEach(S=>{Ha(this.playersByQueriedElement,S.element,[]).push(S),S.onDone(()=>function yq(i,e,t){let n=i.get(e);if(n){if(n.length){const r=n.indexOf(t);n.splice(r,1)}0==n.length&&i.delete(e)}return n}(this.playersByQueriedElement,S.element,S))}),g.forEach(S=>wl(S,m3));const x=Rf(E);return x.onDestroy(()=>{g.forEach(S=>Iy(S,m3)),fu(h,t.toStyles)}),y.forEach(S=>{Ha(r,S,[]).push(x)}),x}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new Hw(e.duration,e.delay)}}class $O{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new Hw,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,n)=>{t.forEach(r=>bO(e,n,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Ha(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function tD(i){return i&&1===i.nodeType}function k3(i,e){const t=i.style.display;return i.style.display=e??"none",t}function R3(i,e,t,n,r){const s=[];t.forEach(h=>s.push(k3(h)));const o=[];n.forEach((h,m)=>{const g=new Map;h.forEach(y=>{const E=e.computeStyle(m,y,r);g.set(y,E),(!E||0==E.length)&&(m[bl]=pq,o.push(m))}),i.set(m,g)});let c=0;return t.forEach(h=>k3(h,s[c++])),o}function M3(i,e){const t=new Map;if(i.forEach(c=>t.set(c,[])),0==e.length)return t;const n=1,r=new Set(e),s=new Map;function o(c){if(!c)return n;let h=s.get(c);if(h)return h;const m=c.parentNode;return h=t.has(m)?m:r.has(m)?n:o(m),s.set(c,h),h}return e.forEach(c=>{const h=o(c);h!==n&&t.get(h).push(c)}),t}function wl(i,e){i.classList?.add(e)}function Iy(i,e){i.classList?.remove(e)}function wq(i,e,t){Rf(t).onDone(()=>i.processLeaveNode(e))}function O3(i,e){for(let t=0;t<i.length;t++){const n=i[t];n instanceof pV?O3(n.players,e):e.push(n)}}function P3(i,e,t){const n=t.get(i);if(!n)return!1;let r=e.get(i);return r?n.forEach(s=>r.add(s)):e.set(i,n),t.delete(i),!0}class nD{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new _q(e,t,n),this._timelineEngine=new cq(e,t,n),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,n,r,s){const o=e+"-"+r;let c=this._triggerCache[o];if(!c){const h=[],m=[],g=RO(this._driver,s,h,m);if(h.length)throw function aK(i,e){return new d.vHH(3404,!1)}();c=function sq(i,e,t){return new oq(i,e,t)}(r,g,this._normalizer),this._triggerCache[o]=c}this._transitionEngine.registerTrigger(t,r,c)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}onRemove(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,r){if("@"==n.charAt(0)){const[s,o]=o3(n);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,n,r)}listen(e,t,n,r,s){if("@"==n.charAt(0)){const[o,c]=o3(n);return this._timelineEngine.listen(o,t,c,s)}return this._transitionEngine.listen(e,t,n,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let Iq=(()=>{class i{constructor(t,n,r){this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;let s=i.initialStylesByElement.get(t);s||i.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&fu(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(fu(this._element,this._initialStyles),this._endStyles&&(fu(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(i.initialStylesByElement.delete(this._element),this._startStyles&&(qp(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(qp(this._element,this._endStyles),this._endStyles=null),fu(this._element,this._initialStyles),this._state=3)}}return i.initialStylesByElement=new WeakMap,i})();function HO(i){let e=null;return i.forEach((t,n)=>{(function Cq(i){return"display"===i||"position"===i})(n)&&(e=e||new Map,e.set(n,t))}),e}class L3{constructor(e,t,n,r){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(n=>{t.push(Object.fromEntries(n))}),t}_triggerWebAnimation(e,t,n){return e.animate(this._convertKeyframesToObject(t),n)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,r)=>{"offset"!==r&&e.set(r,this._finished?n:b3(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class Sq{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return u3(e,t)}getParentElement(e){return TO(e)}query(e,t,n){return d3(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}animate(e,t,n,r,s,o=[]){const h={duration:n,delay:r,fill:0==r?"both":"forwards"};s&&(h.easing=s);const m=new Map,g=o.filter(x=>x instanceof L3);(function RK(i,e){return 0===i||0===e})(n,r)&&g.forEach(x=>{x.currentSnapshot.forEach((S,R)=>m.set(R,S))});let y=function SK(i){return i.length?i[0]instanceof Map?i:i.map(e=>p3(e)):[]}(t).map(x=>Mf(x));y=function MK(i,e,t){if(t.size&&e.length){let n=e[0],r=[];if(t.forEach((s,o)=>{n.has(o)||r.push(o),n.set(o,s)}),r.length)for(let s=1;s<e.length;s++){let o=e[s];r.forEach(c=>o.set(c,b3(i,c)))}}return e}(e,y,m);const E=function Tq(i,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=HO(e[0]),e.length>1&&(n=HO(e[e.length-1]))):e instanceof Map&&(t=HO(e)),t||n?new Iq(i,t,n):null}(e,y);return new L3(e,y,h,E)}}let Dq=(()=>{class i extends lV{constructor(t,n){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(n.body,{id:"0",encapsulation:d.ifc.None,styles:[],data:{animation:[]}})}build(t){const n=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?dV(t):t;return N3(this._renderer,null,n,"register",[r]),new Aq(n,this._renderer)}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(d.FYo),d.LFG(ue))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac}),i})();class Aq extends G5{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new kq(this._id,e,t||{},this._renderer)}}class kq{constructor(e,t,n,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return N3(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function N3(i,e,t,n,r){return i.setProperty(e,`@@${t}:${n}`,r)}const F3="@.disabled";let Rq=(()=>{class i{constructor(t,n,r){this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=(s,o)=>{const c=o?.parentNode(s);c&&o.removeChild(c,s)}}createRenderer(t,n){const s=this.delegate.createRenderer(t,n);if(!(t&&n&&n.data&&n.data.animation)){let g=this._rendererCache.get(s);return g||(g=new B3("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,g)),g}const o=n.id,c=n.id+"-"+this._currentId;this._currentId++,this.engine.register(c,t);const h=g=>{Array.isArray(g)?g.forEach(h):this.engine.registerTrigger(o,c,t,g.name,g)};return n.data.animation.forEach(h),new Mq(this,c,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,n,r){t>=0&&t<this._microtaskId?this._zone.run(()=>n(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,c]=s;o(c)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([n,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(d.FYo),d.LFG(nD),d.LFG(d.R0b))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac}),i})();class B3{constructor(e,t,n,r){this.namespaceId=e,this.delegate=t,this.engine=n,this._onDestroy=r,this.destroyNode=this.delegate.destroyNode?s=>t.destroyNode(s):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,r=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,r){this.delegate.setStyle(e,t,n,r)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==F3?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Mq extends B3{constructor(e,t,n,r,s){super(t,n,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==F3?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.slice(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const r=function Oq(i){switch(i){case"body":return document.body;case"document":return document;case"window":return window;default:return i}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function Pq(i){const e=i.indexOf(".");return[i.substring(0,e),i.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,c=>{this.factory.scheduleListenerCallback(c._data||-1,n,c)})}return this.delegate.listen(e,t,n)}}let Lq=(()=>{class i extends nD{constructor(t,n,r,s){super(t.body,n,r)}ngOnDestroy(){this.flush()}}return i.\u0275fac=function(t){return new(t||i)(d.LFG(ue),d.LFG(IO),d.LFG(NO),d.LFG(d.z2F))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac}),i})();const U3=[{provide:lV,useClass:Dq},{provide:NO,useFactory:function Nq(){return new tq}},{provide:nD,useClass:Lq},{provide:d.FYo,useFactory:function Fq(i,e,t){return new Rq(i,e,t)},deps:[fs,nD,d.R0b]}],jO=[{provide:IO,useFactory:()=>new Sq},{provide:d.QbO,useValue:"BrowserAnimations"},...U3],V3=[{provide:IO,useClass:h3},{provide:d.QbO,useValue:"NoopAnimations"},...U3];let Bq=(()=>{class i{static withConfig(t){return{ngModule:i,providers:t.disableAnimations?V3:jO}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({providers:jO,imports:[bo]}),i})();class GO{constructor(e){return e}}class rD{constructor(){return(0,In.vb)("auth")}}const zO=new d.OlP("angularfire2.auth-instances");function Vq(i){return(e,t)=>{const n=e.runOutsideAngular(()=>i(t));return new GO(n)}}const $q={provide:rD,deps:[[new d.FiY,zO]]},Hq={provide:GO,useFactory:function Uq(i,e){const t=(0,In.JM)("auth",i,e);return t&&new GO(t)},deps:[[new d.FiY,zO],Xc]};let jq=(()=>{class i{constructor(){(0,qo.KN)("angularfire",In.q4.full,"auth")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({providers:[Hq,$q]}),i})();function Gq(i,...e){return{ngModule:jq,providers:[{provide:zO,useFactory:Vq(i),multi:!0,deps:[d.R0b,d.zs3,In.HU,Rm,[new d.FiY,ec],...e]}]}}const zq=(0,In.u3)(Sg.o,!0);class WO{constructor(e){return e}}const H3="firestore",KO=new d.OlP("angularfire2.firestore-instances");function qq(i){return(e,t)=>{const n=e.runOutsideAngular(()=>i(t));return new WO(n)}}const Yq={provide:class Wq{constructor(){return(0,In.vb)(H3)}},deps:[[new d.FiY,KO]]},Zq={provide:WO,useFactory:function Kq(i,e){const t=(0,In.JM)(H3,i,e);return t&&new WO(t)},deps:[[new d.FiY,KO],Xc]};let Xq=(()=>{class i{constructor(){(0,qo.KN)("angularfire",In.q4.full,"fst")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({providers:[Zq,Yq]}),i})();function Qq(i,...e){return{ngModule:Xq,providers:[{provide:KO,useFactory:qq(i),multi:!0,deps:[d.R0b,d.zs3,In.HU,Rm,[new d.FiY,rD],[new d.FiY,ec],...e]}]}}const Jq=(0,In.u3)(qB,!0),G3="firebasestorage.googleapis.com",z3="storageBucket";class hr extends bn.ZR{constructor(e,t,n=0){super(qO(e),`Firebase Storage: ${t} (${qO(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,hr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return qO(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var Ai=(()=>(function(i){i.UNKNOWN="unknown",i.OBJECT_NOT_FOUND="object-not-found",i.BUCKET_NOT_FOUND="bucket-not-found",i.PROJECT_NOT_FOUND="project-not-found",i.QUOTA_EXCEEDED="quota-exceeded",i.UNAUTHENTICATED="unauthenticated",i.UNAUTHORIZED="unauthorized",i.UNAUTHORIZED_APP="unauthorized-app",i.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",i.INVALID_CHECKSUM="invalid-checksum",i.CANCELED="canceled",i.INVALID_EVENT_NAME="invalid-event-name",i.INVALID_URL="invalid-url",i.INVALID_DEFAULT_BUCKET="invalid-default-bucket",i.NO_DEFAULT_BUCKET="no-default-bucket",i.CANNOT_SLICE_BLOB="cannot-slice-blob",i.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",i.NO_DOWNLOAD_URL="no-download-url",i.INVALID_ARGUMENT="invalid-argument",i.INVALID_ARGUMENT_COUNT="invalid-argument-count",i.APP_DELETED="app-deleted",i.INVALID_ROOT_OPERATION="invalid-root-operation",i.INVALID_FORMAT="invalid-format",i.INTERNAL_ERROR="internal-error",i.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(Ai||(Ai={})),Ai))();function qO(i){return"storage/"+i}function ZO(i){return new hr(Ai.INVALID_ARGUMENT,i)}function Y3(){return new hr(Ai.APP_DELETED,"The Firebase app was deleted.")}class Oo{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=Oo.makeFromUrl(e,t)}catch{return new Oo(e,"")}if(""===n.path)return n;throw function cY(i){return new hr(Ai.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.")}(e)}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)",c=new RegExp("^gs://"+r+"(/(.*))?$","i");function m(te){te.path_=decodeURIComponent(te.path)}const y=t.replace(/[.]/g,"\\."),K=[{regex:c,indices:{bucket:1,path:3},postModify:function s(te){"/"===te.path.charAt(te.path.length-1)&&(te.path_=te.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${y}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:m},{regex:new RegExp(`^https?://${t===G3?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:m}];for(let te=0;te<K.length;te++){const oe=K[te],Ae=oe.regex.exec(e);if(Ae){let We=Ae[oe.indices.path];We||(We=""),n=new Oo(Ae[oe.indices.bucket],We),oe.postModify(n);break}}if(null==n)throw function lY(i){return new hr(Ai.INVALID_URL,"Invalid URL '"+i+"'.")}(e);return n}}class pY{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function QO(i,e,t,n){if(n<e)throw ZO(`Invalid value for '${i}'. Expected ${e} or greater.`);if(n>t)throw ZO(`Invalid value for '${i}'. Expected ${t} or less.`)}var Of=(()=>(function(i){i[i.NO_ERROR=0]="NO_ERROR",i[i.NETWORK_ERROR=1]="NETWORK_ERROR",i[i.ABORT=2]="ABORT"}(Of||(Of={})),Of))();class wY{constructor(e,t,n,r,s,o,c,h,m,g,y,E=!0){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=c,this.errorCallback_=h,this.timeout_=m,this.progressCallback_=g,this.connectionFactory_=y,this.retry=E,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,S)=>{this.resolve_=x,this.reject_=S,this.start_()})}start_(){const t=(n,r)=>{const s=this.resolve_,o=this.reject_,c=r.connection;if(r.wasSuccessCode)try{const h=this.callback_(c,c.getResponse());!function yY(i){return void 0!==i}(h)?s():s(h)}catch(h){o(h)}else if(null!==c){const h=function YO(){return new hr(Ai.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}();h.serverResponse=c.getErrorText(),o(this.errorCallback_?this.errorCallback_(c,h):h)}else o(r.canceled?this.appDelete_?Y3():function K3(){return new hr(Ai.CANCELED,"User canceled the upload/download.")}():function W3(){return new hr(Ai.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}())};this.canceled_?t(0,new oD(!1,null,!0)):this.backoffId_=function gY(i,e,t){let n=1,r=null,s=null,o=!1,c=0;function h(){return 2===c}let m=!1;function g(...L){m||(m=!0,e.apply(null,L))}function y(L){r=setTimeout(()=>{r=null,i(x,h())},L)}function E(){s&&clearTimeout(s)}function x(L,...G){if(m)return void E();if(L)return E(),void g.call(null,L,...G);if(h()||o)return E(),void g.call(null,L,...G);let K;n<64&&(n*=2),1===c?(c=2,K=0):K=1e3*(n+Math.random()),y(K)}let S=!1;function R(L){S||(S=!0,E(),!m&&(null!==r?(L||(c=2),clearTimeout(r),y(0)):L||(c=1)))}return y(0),s=setTimeout(()=>{o=!0,R(!0)},t),R}((n,r)=>{if(r)return void n(!1,new oD(!1,null,!0));const s=this.connectionFactory_();this.pendingConnection_=s;const o=c=>{null!==this.progressCallback_&&this.progressCallback_(c.loaded,c.lengthComputable?c.total:-1)};null!==this.progressCallback_&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const c=s.getErrorCode()===Of.NO_ERROR,h=s.getStatus();if(!c||function Q3(i,e){const t=i>=500&&i<600,r=-1!==[408,429].indexOf(i),s=-1!==e.indexOf(i);return t||r||s}(h,this.additionalRetryCodes_)&&this.retry){const g=s.getErrorCode()===Of.ABORT;return void n(!1,new oD(!1,null,g))}const m=-1!==this.successCodes_.indexOf(h);n(!0,new oD(m,s))})},t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function _Y(i){i(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class oD{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}class Zp{constructor(e,t){this._service=e,this._location=t instanceof Oo?t:Oo.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Zp(e,t)}get root(){const e=new Oo(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return function iH(i){const e=i.lastIndexOf("/",i.length-2);return-1===e?i:i.slice(e+1)}(this._location.path)}get storage(){return this._service}get parent(){const e=function LY(i){if(0===i.length)return null;const e=i.lastIndexOf("/");return-1===e?"":i.slice(0,e)}(this._location.path);if(null===e)return null;const t=new Oo(this._location.bucket,e);return new Zp(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function mY(i){return new hr(Ai.INVALID_ROOT_OPERATION,"The operation '"+i+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function yH(i,e){const t=e?.[z3];return null==t?null:Oo.makeFromBucketSpec(t,i)}class rP{constructor(e,t,n,r,s){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=s,this._bucket=null,this._host=G3,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?Oo.makeFromBucketSpec(r,this._host):yH(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?Oo.makeFromBucketSpec(this._url,e):yH(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){QO("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){QO("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,Ie.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const t=e._authProvider.getImmediate({optional:!0});if(t){const n=yield t.getToken();if(null!==n)return n.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,Ie.Z)(function*(){const t=e._appCheckProvider.getImmediate({optional:!0});return t?(yield t.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Zp(this,e)}_makeRequest(e,t,n,r,s=!0){if(this._deleted)return new pY(Y3());{const o=function CY(i,e,t,n,r,s,o=!0){const c=function X3(i){const e=encodeURIComponent;let t="?";for(const n in i)i.hasOwnProperty(n)&&(t=t+(e(n)+"=")+e(i[n])+"&");return t=t.slice(0,-1),t}(i.urlParams),h=i.url+c,m=Object.assign({},i.headers);return function TY(i,e){e&&(i["X-Firebase-GMPID"]=e)}(m,e),function EY(i,e){null!==e&&e.length>0&&(i.Authorization="Firebase "+e)}(m,t),function xY(i,e){i["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}(m,s),function IY(i,e){null!==e&&(i["X-Firebase-AppCheck"]=e)}(m,n),new wY(h,i.method,m,i.body,i.successCodes,i.additionalRetryCodes,i.handler,i.errorHandler,i.timeout,i.progressCallback,r,o)}(e,this._appId,n,r,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){var n=this;return(0,Ie.Z)(function*(){const[r,s]=yield Promise.all([n._getAuthToken(),n._getAppCheckToken()]);return n._makeRequest(e,t,r,s).getPromise()})()}}const vH="@firebase/storage",wH="storage";function bZ(i=(0,Qi.getApp)(),e){i=(0,bn.m9)(i);const n=(0,Qi._getProvider)(i,wH).getImmediate({identifier:e}),r=(0,bn.P0)("storage");return r&&function wZ(i,e,t,n={}){!function vZ(i,e,t,n={}){i.host=`${e}:${t}`,i._protocol="http";const{mockUserToken:r}=n;r&&(i._overrideAuthToken="string"==typeof r?r:(0,bn.Sg)(r,i.app.options.projectId))}(i,e,t,n)}(n,...r),n}function EZ(i,{instanceIdentifier:e}){const t=i.getProvider("app").getImmediate(),n=i.getProvider("auth-internal"),r=i.getProvider("app-check-internal");return new rP(t,n,r,e,Qi.SDK_VERSION)}!function xZ(){(0,Qi._registerComponent)(new Xu.wA(wH,EZ,"PUBLIC").setMultipleInstances(!0)),(0,Qi.registerVersion)(vH,"0.11.2",""),(0,Qi.registerVersion)(vH,"0.11.2","esm2017")}();class sP{constructor(e){return e}}const EH="storage",oP=new d.OlP("angularfire2.storage-instances");function CZ(i){return(e,t)=>{const n=e.runOutsideAngular(()=>i(t));return new sP(n)}}const SZ={provide:class TZ{constructor(){return(0,In.vb)(EH)}},deps:[[new d.FiY,oP]]},DZ={provide:sP,useFactory:function IZ(i,e){const t=(0,In.JM)(EH,i,e);return t&&new sP(t)},deps:[[new d.FiY,oP],Xc]};let AZ=(()=>{class i{constructor(){(0,qo.KN)("angularfire",In.q4.full,"gcs")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({providers:[DZ,SZ]}),i})();function kZ(i,...e){return{ngModule:AZ,providers:[{provide:oP,useFactory:CZ(i),multi:!0,deps:[d.R0b,d.zs3,In.HU,Rm,[new d.FiY,rD],[new d.FiY,ec],...e]}]}}const RZ=(0,In.u3)(bZ,!0),lP="functions";class NZ{constructor(e,t,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then(r=>this.auth=r,()=>{}),this.messaging||t.get().then(r=>this.messaging=r,()=>{}),this.appCheck||n.get().then(r=>this.appCheck=r,()=>{})}getAuthToken(){var e=this;return(0,Ie.Z)(function*(){if(e.auth)try{return(yield e.auth.getToken())?.accessToken}catch{return}})()}getMessagingToken(){var e=this;return(0,Ie.Z)(function*(){if(e.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return yield e.messaging.getToken()}catch{return}})()}getAppCheckToken(e){var t=this;return(0,Ie.Z)(function*(){if(t.appCheck){const n=e?yield t.appCheck.getLimitedUseToken():yield t.appCheck.getToken();return n.error?null:n.token}return null})()}getContext(e){var t=this;return(0,Ie.Z)(function*(){return{authToken:yield t.getAuthToken(),messagingToken:yield t.getMessagingToken(),appCheckToken:yield t.getAppCheckToken(e)}})()}}const cP="us-central1";class BZ{constructor(e,t,n,r,s=cP,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new NZ(t,n,r),this.cancelAllRequests=new Promise(c=>{this.deleteService=()=>Promise.resolve(c())});try{const c=new URL(s);this.customDomain=c.origin,this.region=cP}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return null!==this.emulatorOrigin?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:null!==this.customDomain?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}const DH="@firebase/functions";function qZ(i=(0,Qi.getApp)(),e=cP){const n=(0,Qi._getProvider)((0,bn.m9)(i),lP).getImmediate({identifier:e}),r=(0,bn.P0)("functions");return r&&function YZ(i,e,t){!function UZ(i,e,t){i.emulatorOrigin=`http://${e}:${t}`}((0,bn.m9)(i),e,t)}(n,...r),n}!function KZ(i,e){(0,Qi._registerComponent)(new Xu.wA(lP,(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),o=n.getProvider("auth-internal"),c=n.getProvider("messaging-internal"),h=n.getProvider("app-check-internal");return new BZ(s,o,c,h,r,i)},"PUBLIC").setMultipleInstances(!0)),(0,Qi.registerVersion)(DH,"0.10.0",e),(0,Qi.registerVersion)(DH,"0.10.0","esm2017")}(fetch.bind(self));class uP{constructor(e){return e}}const kH="functions",dP=new d.OlP("angularfire2.functions-instances");function QZ(i){return(e,t)=>{const n=e.runOutsideAngular(()=>i(t));return new uP(n)}}const JZ={provide:class ZZ{constructor(){return(0,In.vb)(kH)}},deps:[[new d.FiY,dP]]},eX={provide:uP,useFactory:function XZ(i,e){const t=(0,In.JM)(kH,i,e);return t&&new uP(t)},deps:[[new d.FiY,dP],Xc]};let tX=(()=>{class i{constructor(){(0,qo.KN)("angularfire",In.q4.full,"fn")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({providers:[eX,JZ]}),i})();function nX(i,...e){return{ngModule:tX,providers:[{provide:dP,useFactory:QZ(i),multi:!0,deps:[d.R0b,d.zs3,In.HU,Rm,[new d.FiY,rD],[new d.FiY,ec],...e]}]}}const iX=(0,In.u3)(qZ,!0);let AX=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({imports:[js,js]}),i})(),kX=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({imports:[js,js]}),i})(),MX=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=d.oAB({type:i}),i.\u0275inj=d.cJS({imports:[js]}),i})();const KH_firebaseConfig={apiKey:"AIzaSyAmG52vP8RvmwchQ71fQggTMu0eRdUz0Bc",authDomain:"tv-project-ffd44.firebaseapp.com",databaseURL:"https://tv-project-ffd44-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"tv-project-ffd44",storageBucket:"tv-project-ffd44.appspot.com",messagingSenderId:"711946849087",appId:"1:711946849087:web:0079a3cd80b97cea04e18a",measurementId:"G-0GRY2RNYRQ"};let OX=(()=>{var i;class e{}return(i=e).\u0275fac=function(n){return new(n||i)},i.\u0275mod=d.oAB({type:i,bootstrap:[jv]}),i.\u0275inj=d.cJS({imports:[nW,bo,U9,O7,Bq,r7,e9,k9,MX,AX,F1,kX,Ko.hO.initializeApp(KH_firebaseConfig),T7,gA(()=>_A(KH_firebaseConfig)),Gq(()=>zq()),Qq(()=>Jq()),kZ(()=>RZ()),nX(()=>iX(ax(),"asia-east2"))]}),e})();Jd().bootstrapModule(OX).catch(i=>console.error(i))},9751:(Ft,Be,z)=>{z.d(Be,{y:()=>Me});var d=z(930),Q=z(727),V=z(8822),he=z(9635),ye=z(2416),ue=z(576),Oe=z(2806);let Me=(()=>{class ce{constructor(Ue){Ue&&(this._subscribe=Ue)}lift(Ue){const lt=new ce;return lt.source=this,lt.operator=Ue,lt}subscribe(Ue,lt,xt){const Ce=function J(ce){return ce&&ce instanceof d.Lv||function ee(ce){return ce&&(0,ue.m)(ce.next)&&(0,ue.m)(ce.error)&&(0,ue.m)(ce.complete)}(ce)&&(0,Q.Nn)(ce)}(Ue)?Ue:new d.Hp(Ue,lt,xt);return(0,Oe.x)(()=>{const{operator:Ke,source:qe}=this;Ce.add(Ke?Ke.call(Ce,qe):qe?this._subscribe(Ce):this._trySubscribe(Ce))}),Ce}_trySubscribe(Ue){try{return this._subscribe(Ue)}catch(lt){Ue.error(lt)}}forEach(Ue,lt){return new(lt=Se(lt))((xt,Ce)=>{const Ke=new d.Hp({next:qe=>{try{Ue(qe)}catch(it){Ce(it),Ke.unsubscribe()}},error:Ce,complete:xt});this.subscribe(Ke)})}_subscribe(Ue){var lt;return null===(lt=this.source)||void 0===lt?void 0:lt.subscribe(Ue)}[V.L](){return this}pipe(...Ue){return(0,he.U)(Ue)(this)}toPromise(Ue){return new(Ue=Se(Ue))((lt,xt)=>{let Ce;this.subscribe(Ke=>Ce=Ke,Ke=>xt(Ke),()=>lt(Ce))})}}return ce.create=tt=>new ce(tt),ce})();function Se(ce){var tt;return null!==(tt=ce??ye.v.Promise)&&void 0!==tt?tt:Promise}},7579:(Ft,Be,z)=>{z.d(Be,{x:()=>Oe});var d=z(9751),Q=z(727);const he=(0,z(3888).d)(Se=>function(){Se(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ye=z(8737),ue=z(2806);let Oe=(()=>{class Se extends d.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(J){const ce=new Me(this,this);return ce.operator=J,ce}_throwIfClosed(){if(this.closed)throw new he}next(J){(0,ue.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const ce of this.currentObservers)ce.next(J)}})}error(J){(0,ue.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=J;const{observers:ce}=this;for(;ce.length;)ce.shift().error(J)}})}complete(){(0,ue.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:J}=this;for(;J.length;)J.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var J;return(null===(J=this.observers)||void 0===J?void 0:J.length)>0}_trySubscribe(J){return this._throwIfClosed(),super._trySubscribe(J)}_subscribe(J){return this._throwIfClosed(),this._checkFinalizedStatuses(J),this._innerSubscribe(J)}_innerSubscribe(J){const{hasError:ce,isStopped:tt,observers:Ue}=this;return ce||tt?Q.Lc:(this.currentObservers=null,Ue.push(J),new Q.w0(()=>{this.currentObservers=null,(0,ye.P)(Ue,J)}))}_checkFinalizedStatuses(J){const{hasError:ce,thrownError:tt,isStopped:Ue}=this;ce?J.error(tt):Ue&&J.complete()}asObservable(){const J=new d.y;return J.source=this,J}}return Se.create=(ee,J)=>new Me(ee,J),Se})();class Me extends Oe{constructor(ee,J){super(),this.destination=ee,this.source=J}next(ee){var J,ce;null===(ce=null===(J=this.destination)||void 0===J?void 0:J.next)||void 0===ce||ce.call(J,ee)}error(ee){var J,ce;null===(ce=null===(J=this.destination)||void 0===J?void 0:J.error)||void 0===ce||ce.call(J,ee)}complete(){var ee,J;null===(J=null===(ee=this.destination)||void 0===ee?void 0:ee.complete)||void 0===J||J.call(ee)}_subscribe(ee){var J,ce;return null!==(ce=null===(J=this.source)||void 0===J?void 0:J.subscribe(ee))&&void 0!==ce?ce:Q.Lc}}},930:(Ft,Be,z)=>{z.d(Be,{Hp:()=>xt,Lv:()=>ce});var d=z(576),Q=z(727),V=z(2416),he=z(7849),ye=z(5032);const ue=Se("C",void 0,void 0);function Se(Ye,je,Ge){return{kind:Ye,value:je,error:Ge}}var ee=z(3410),J=z(2806);class ce extends Q.w0{constructor(je){super(),this.isStopped=!1,je?(this.destination=je,(0,Q.Nn)(je)&&je.add(this)):this.destination=it}static create(je,Ge,at){return new xt(je,Ge,at)}next(je){this.isStopped?qe(function Me(Ye){return Se("N",Ye,void 0)}(je),this):this._next(je)}error(je){this.isStopped?qe(function Oe(Ye){return Se("E",void 0,Ye)}(je),this):(this.isStopped=!0,this._error(je))}complete(){this.isStopped?qe(ue,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(je){this.destination.next(je)}_error(je){try{this.destination.error(je)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const tt=Function.prototype.bind;function Ue(Ye,je){return tt.call(Ye,je)}class lt{constructor(je){this.partialObserver=je}next(je){const{partialObserver:Ge}=this;if(Ge.next)try{Ge.next(je)}catch(at){Ce(at)}}error(je){const{partialObserver:Ge}=this;if(Ge.error)try{Ge.error(je)}catch(at){Ce(at)}else Ce(je)}complete(){const{partialObserver:je}=this;if(je.complete)try{je.complete()}catch(Ge){Ce(Ge)}}}class xt extends ce{constructor(je,Ge,at){let Je;if(super(),(0,d.m)(je)||!je)Je={next:je??void 0,error:Ge??void 0,complete:at??void 0};else{let Et;this&&V.v.useDeprecatedNextContext?(Et=Object.create(je),Et.unsubscribe=()=>this.unsubscribe(),Je={next:je.next&&Ue(je.next,Et),error:je.error&&Ue(je.error,Et),complete:je.complete&&Ue(je.complete,Et)}):Je=je}this.destination=new lt(Je)}}function Ce(Ye){V.v.useDeprecatedSynchronousErrorHandling?(0,J.O)(Ye):(0,he.h)(Ye)}function qe(Ye,je){const{onStoppedNotification:Ge}=V.v;Ge&&ee.z.setTimeout(()=>Ge(Ye,je))}const it={closed:!0,next:ye.Z,error:function Ke(Ye){throw Ye},complete:ye.Z}},727:(Ft,Be,z)=>{z.d(Be,{Lc:()=>ue,w0:()=>ye,Nn:()=>Oe});var d=z(576);const V=(0,z(3888).d)(Se=>function(J){Se(this),this.message=J?`${J.length} errors occurred during unsubscription:\n${J.map((ce,tt)=>`${tt+1}) ${ce.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=J});var he=z(8737);class ye{constructor(ee){this.initialTeardown=ee,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let ee;if(!this.closed){this.closed=!0;const{_parentage:J}=this;if(J)if(this._parentage=null,Array.isArray(J))for(const Ue of J)Ue.remove(this);else J.remove(this);const{initialTeardown:ce}=this;if((0,d.m)(ce))try{ce()}catch(Ue){ee=Ue instanceof V?Ue.errors:[Ue]}const{_finalizers:tt}=this;if(tt){this._finalizers=null;for(const Ue of tt)try{Me(Ue)}catch(lt){ee=ee??[],lt instanceof V?ee=[...ee,...lt.errors]:ee.push(lt)}}if(ee)throw new V(ee)}}add(ee){var J;if(ee&&ee!==this)if(this.closed)Me(ee);else{if(ee instanceof ye){if(ee.closed||ee._hasParent(this))return;ee._addParent(this)}(this._finalizers=null!==(J=this._finalizers)&&void 0!==J?J:[]).push(ee)}}_hasParent(ee){const{_parentage:J}=this;return J===ee||Array.isArray(J)&&J.includes(ee)}_addParent(ee){const{_parentage:J}=this;this._parentage=Array.isArray(J)?(J.push(ee),J):J?[J,ee]:ee}_removeParent(ee){const{_parentage:J}=this;J===ee?this._parentage=null:Array.isArray(J)&&(0,he.P)(J,ee)}remove(ee){const{_finalizers:J}=this;J&&(0,he.P)(J,ee),ee instanceof ye&&ee._removeParent(this)}}ye.EMPTY=(()=>{const Se=new ye;return Se.closed=!0,Se})();const ue=ye.EMPTY;function Oe(Se){return Se instanceof ye||Se&&"closed"in Se&&(0,d.m)(Se.remove)&&(0,d.m)(Se.add)&&(0,d.m)(Se.unsubscribe)}function Me(Se){(0,d.m)(Se)?Se():Se.unsubscribe()}},2416:(Ft,Be,z)=>{z.d(Be,{v:()=>d});const d={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(Ft,Be,z)=>{z.d(Be,{E:()=>Q});const Q=new(z(9751).y)(ye=>ye.complete())},8996:(Ft,Be,z)=>{z.d(Be,{D:()=>je});var d=z(8421),Q=z(5363),V=z(9468),ue=z(9751),Me=z(2202),Se=z(576),ee=z(9672);function ce(Ge,at){if(!Ge)throw new Error("Iterable cannot be null");return new ue.y(Je=>{(0,ee.f)(Je,at,()=>{const Et=Ge[Symbol.asyncIterator]();(0,ee.f)(Je,at,()=>{Et.next().then(kt=>{kt.done?Je.complete():Je.next(kt.value)})},0,!0)})})}var tt=z(3670),Ue=z(8239),lt=z(1144),xt=z(6495),Ce=z(2206),Ke=z(4532),qe=z(3260);function je(Ge,at){return at?function Ye(Ge,at){if(null!=Ge){if((0,tt.c)(Ge))return function he(Ge,at){return(0,d.Xf)(Ge).pipe((0,V.R)(at),(0,Q.Q)(at))}(Ge,at);if((0,lt.z)(Ge))return function Oe(Ge,at){return new ue.y(Je=>{let Et=0;return at.schedule(function(){Et===Ge.length?Je.complete():(Je.next(Ge[Et++]),Je.closed||this.schedule())})})}(Ge,at);if((0,Ue.t)(Ge))return function ye(Ge,at){return(0,d.Xf)(Ge).pipe((0,V.R)(at),(0,Q.Q)(at))}(Ge,at);if((0,Ce.D)(Ge))return ce(Ge,at);if((0,xt.T)(Ge))return function J(Ge,at){return new ue.y(Je=>{let Et;return(0,ee.f)(Je,at,()=>{Et=Ge[Me.h](),(0,ee.f)(Je,at,()=>{let kt,cn;try{({value:kt,done:cn}=Et.next())}catch(Tt){return void Je.error(Tt)}cn?Je.complete():Je.next(kt)},0,!0)}),()=>(0,Se.m)(Et?.return)&&Et.return()})}(Ge,at);if((0,qe.L)(Ge))return function it(Ge,at){return ce((0,qe.Q)(Ge),at)}(Ge,at)}throw(0,Ke.z)(Ge)}(Ge,at):(0,d.Xf)(Ge)}},8421:(Ft,Be,z)=>{z.d(Be,{Xf:()=>tt});var d=z(7582),Q=z(1144),V=z(8239),he=z(9751),ye=z(3670),ue=z(2206),Oe=z(4532),Me=z(6495),Se=z(3260),ee=z(576),J=z(7849),ce=z(8822);function tt(Ye){if(Ye instanceof he.y)return Ye;if(null!=Ye){if((0,ye.c)(Ye))return function Ue(Ye){return new he.y(je=>{const Ge=Ye[ce.L]();if((0,ee.m)(Ge.subscribe))return Ge.subscribe(je);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Ye);if((0,Q.z)(Ye))return function lt(Ye){return new he.y(je=>{for(let Ge=0;Ge<Ye.length&&!je.closed;Ge++)je.next(Ye[Ge]);je.complete()})}(Ye);if((0,V.t)(Ye))return function xt(Ye){return new he.y(je=>{Ye.then(Ge=>{je.closed||(je.next(Ge),je.complete())},Ge=>je.error(Ge)).then(null,J.h)})}(Ye);if((0,ue.D)(Ye))return Ke(Ye);if((0,Me.T)(Ye))return function Ce(Ye){return new he.y(je=>{for(const Ge of Ye)if(je.next(Ge),je.closed)return;je.complete()})}(Ye);if((0,Se.L)(Ye))return function qe(Ye){return Ke((0,Se.Q)(Ye))}(Ye)}throw(0,Oe.z)(Ye)}function Ke(Ye){return new he.y(je=>{(function it(Ye,je){var Ge,at,Je,Et;return(0,d.mG)(this,void 0,void 0,function*(){try{for(Ge=(0,d.KL)(Ye);!(at=yield Ge.next()).done;)if(je.next(at.value),je.closed)return}catch(kt){Je={error:kt}}finally{try{at&&!at.done&&(Et=Ge.return)&&(yield Et.call(Ge))}finally{if(Je)throw Je.error}}je.complete()})})(Ye,je).catch(Ge=>je.error(Ge))})}},6451:(Ft,Be,z)=>{z.d(Be,{T:()=>ue});var d=z(8189),Q=z(8421),V=z(515),he=z(3269),ye=z(8996);function ue(...Oe){const Me=(0,he.yG)(Oe),Se=(0,he._6)(Oe,1/0),ee=Oe;return ee.length?1===ee.length?(0,Q.Xf)(ee[0]):(0,d.J)(Se)((0,ye.D)(ee,Me)):V.E}},5403:(Ft,Be,z)=>{z.d(Be,{x:()=>Q});var d=z(930);function Q(he,ye,ue,Oe,Me){return new V(he,ye,ue,Oe,Me)}class V extends d.Lv{constructor(ye,ue,Oe,Me,Se,ee){super(ye),this.onFinalize=Se,this.shouldUnsubscribe=ee,this._next=ue?function(J){try{ue(J)}catch(ce){ye.error(ce)}}:super._next,this._error=Me?function(J){try{Me(J)}catch(ce){ye.error(ce)}finally{this.unsubscribe()}}:super._error,this._complete=Oe?function(){try{Oe()}catch(J){ye.error(J)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var ye;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:ue}=this;super.unsubscribe(),!ue&&(null===(ye=this.onFinalize)||void 0===ye||ye.call(this))}}}},4004:(Ft,Be,z)=>{z.d(Be,{U:()=>V});var d=z(4482),Q=z(5403);function V(he,ye){return(0,d.e)((ue,Oe)=>{let Me=0;ue.subscribe((0,Q.x)(Oe,Se=>{Oe.next(he.call(ye,Se,Me++))}))})}},8189:(Ft,Be,z)=>{z.d(Be,{J:()=>V});var d=z(5577),Q=z(4671);function V(he=1/0){return(0,d.z)(Q.y,he)}},5577:(Ft,Be,z)=>{z.d(Be,{z:()=>Me});var d=z(4004),Q=z(8421),V=z(4482),he=z(9672),ye=z(5403),Oe=z(576);function Me(Se,ee,J=1/0){return(0,Oe.m)(ee)?Me((ce,tt)=>(0,d.U)((Ue,lt)=>ee(ce,Ue,tt,lt))((0,Q.Xf)(Se(ce,tt))),J):("number"==typeof ee&&(J=ee),(0,V.e)((ce,tt)=>function ue(Se,ee,J,ce,tt,Ue,lt,xt){const Ce=[];let Ke=0,qe=0,it=!1;const Ye=()=>{it&&!Ce.length&&!Ke&&ee.complete()},je=at=>Ke<ce?Ge(at):Ce.push(at),Ge=at=>{Ue&&ee.next(at),Ke++;let Je=!1;(0,Q.Xf)(J(at,qe++)).subscribe((0,ye.x)(ee,Et=>{tt?.(Et),Ue?je(Et):ee.next(Et)},()=>{Je=!0},void 0,()=>{if(Je)try{for(Ke--;Ce.length&&Ke<ce;){const Et=Ce.shift();lt?(0,he.f)(ee,lt,()=>Ge(Et)):Ge(Et)}Ye()}catch(Et){ee.error(Et)}}))};return Se.subscribe((0,ye.x)(ee,je,()=>{it=!0,Ye()})),()=>{xt?.()}}(ce,tt,Se,J)))}},5363:(Ft,Be,z)=>{z.d(Be,{Q:()=>he});var d=z(9672),Q=z(4482),V=z(5403);function he(ye,ue=0){return(0,Q.e)((Oe,Me)=>{Oe.subscribe((0,V.x)(Me,Se=>(0,d.f)(Me,ye,()=>Me.next(Se),ue),()=>(0,d.f)(Me,ye,()=>Me.complete(),ue),Se=>(0,d.f)(Me,ye,()=>Me.error(Se),ue)))})}},3099:(Ft,Be,z)=>{z.d(Be,{B:()=>ye});var d=z(8421),Q=z(7579),V=z(930),he=z(4482);function ye(Oe={}){const{connector:Me=(()=>new Q.x),resetOnError:Se=!0,resetOnComplete:ee=!0,resetOnRefCountZero:J=!0}=Oe;return ce=>{let tt,Ue,lt,xt=0,Ce=!1,Ke=!1;const qe=()=>{Ue?.unsubscribe(),Ue=void 0},it=()=>{qe(),tt=lt=void 0,Ce=Ke=!1},Ye=()=>{const je=tt;it(),je?.unsubscribe()};return(0,he.e)((je,Ge)=>{xt++,!Ke&&!Ce&&qe();const at=lt=lt??Me();Ge.add(()=>{xt--,0===xt&&!Ke&&!Ce&&(Ue=ue(Ye,J))}),at.subscribe(Ge),!tt&&xt>0&&(tt=new V.Hp({next:Je=>at.next(Je),error:Je=>{Ke=!0,qe(),Ue=ue(it,Se,Je),at.error(Je)},complete:()=>{Ce=!0,qe(),Ue=ue(it,ee),at.complete()}}),(0,d.Xf)(je).subscribe(tt))})(ce)}}function ue(Oe,Me,...Se){if(!0===Me)return void Oe();if(!1===Me)return;const ee=new V.Hp({next:()=>{ee.unsubscribe(),Oe()}});return(0,d.Xf)(Me(...Se)).subscribe(ee)}},9468:(Ft,Be,z)=>{z.d(Be,{R:()=>Q});var d=z(4482);function Q(V,he=0){return(0,d.e)((ye,ue)=>{ue.add(V.schedule(()=>ye.subscribe(ue),he))})}},8505:(Ft,Be,z)=>{z.d(Be,{b:()=>ye});var d=z(576),Q=z(4482),V=z(5403),he=z(4671);function ye(ue,Oe,Me){const Se=(0,d.m)(ue)||Oe||Me?{next:ue,error:Oe,complete:Me}:ue;return Se?(0,Q.e)((ee,J)=>{var ce;null===(ce=Se.subscribe)||void 0===ce||ce.call(Se);let tt=!0;ee.subscribe((0,V.x)(J,Ue=>{var lt;null===(lt=Se.next)||void 0===lt||lt.call(Se,Ue),J.next(Ue)},()=>{var Ue;tt=!1,null===(Ue=Se.complete)||void 0===Ue||Ue.call(Se),J.complete()},Ue=>{var lt;tt=!1,null===(lt=Se.error)||void 0===lt||lt.call(Se,Ue),J.error(Ue)},()=>{var Ue,lt;tt&&(null===(Ue=Se.unsubscribe)||void 0===Ue||Ue.call(Se)),null===(lt=Se.finalize)||void 0===lt||lt.call(Se)}))}):he.y}},4408:(Ft,Be,z)=>{z.d(Be,{o:()=>ye});var d=z(727);class Q extends d.w0{constructor(Oe,Me){super()}schedule(Oe,Me=0){return this}}const V={setInterval(ue,Oe,...Me){const{delegate:Se}=V;return Se?.setInterval?Se.setInterval(ue,Oe,...Me):setInterval(ue,Oe,...Me)},clearInterval(ue){const{delegate:Oe}=V;return(Oe?.clearInterval||clearInterval)(ue)},delegate:void 0};var he=z(8737);class ye extends Q{constructor(Oe,Me){super(Oe,Me),this.scheduler=Oe,this.work=Me,this.pending=!1}schedule(Oe,Me=0){var Se;if(this.closed)return this;this.state=Oe;const ee=this.id,J=this.scheduler;return null!=ee&&(this.id=this.recycleAsyncId(J,ee,Me)),this.pending=!0,this.delay=Me,this.id=null!==(Se=this.id)&&void 0!==Se?Se:this.requestAsyncId(J,this.id,Me),this}requestAsyncId(Oe,Me,Se=0){return V.setInterval(Oe.flush.bind(Oe,this),Se)}recycleAsyncId(Oe,Me,Se=0){if(null!=Se&&this.delay===Se&&!1===this.pending)return Me;null!=Me&&V.clearInterval(Me)}execute(Oe,Me){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const Se=this._execute(Oe,Me);if(Se)return Se;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(Oe,Me){let ee,Se=!1;try{this.work(Oe)}catch(J){Se=!0,ee=J||new Error("Scheduled action threw falsy error")}if(Se)return this.unsubscribe(),ee}unsubscribe(){if(!this.closed){const{id:Oe,scheduler:Me}=this,{actions:Se}=Me;this.work=this.state=this.scheduler=null,this.pending=!1,(0,he.P)(Se,this),null!=Oe&&(this.id=this.recycleAsyncId(Me,Oe,null)),this.delay=null,super.unsubscribe()}}}},7565:(Ft,Be,z)=>{z.d(Be,{v:()=>V});var d=z(6063);class Q{constructor(ye,ue=Q.now){this.schedulerActionCtor=ye,this.now=ue}schedule(ye,ue=0,Oe){return new this.schedulerActionCtor(this,ye).schedule(Oe,ue)}}Q.now=d.l.now;class V extends Q{constructor(ye,ue=Q.now){super(ye,ue),this.actions=[],this._active=!1}flush(ye){const{actions:ue}=this;if(this._active)return void ue.push(ye);let Oe;this._active=!0;do{if(Oe=ye.execute(ye.state,ye.delay))break}while(ye=ue.shift());if(this._active=!1,Oe){for(;ye=ue.shift();)ye.unsubscribe();throw Oe}}}},4986:(Ft,Be,z)=>{z.d(Be,{P:()=>he,z:()=>V});var d=z(4408);const V=new(z(7565).v)(d.o),he=V},6063:(Ft,Be,z)=>{z.d(Be,{l:()=>d});const d={now:()=>(d.delegate||Date).now(),delegate:void 0}},3410:(Ft,Be,z)=>{z.d(Be,{z:()=>d});const d={setTimeout(Q,V,...he){const{delegate:ye}=d;return ye?.setTimeout?ye.setTimeout(Q,V,...he):setTimeout(Q,V,...he)},clearTimeout(Q){const{delegate:V}=d;return(V?.clearTimeout||clearTimeout)(Q)},delegate:void 0}},2202:(Ft,Be,z)=>{z.d(Be,{h:()=>Q});const Q=function d(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(Ft,Be,z)=>{z.d(Be,{L:()=>d});const d="function"==typeof Symbol&&Symbol.observable||"@@observable"},3269:(Ft,Be,z)=>{z.d(Be,{_6:()=>ue,jO:()=>he,yG:()=>ye});var d=z(576),Q=z(3532);function V(Oe){return Oe[Oe.length-1]}function he(Oe){return(0,d.m)(V(Oe))?Oe.pop():void 0}function ye(Oe){return(0,Q.K)(V(Oe))?Oe.pop():void 0}function ue(Oe,Me){return"number"==typeof V(Oe)?Oe.pop():Me}},8737:(Ft,Be,z)=>{function d(Q,V){if(Q){const he=Q.indexOf(V);0<=he&&Q.splice(he,1)}}z.d(Be,{P:()=>d})},3888:(Ft,Be,z)=>{function d(Q){const he=Q(ye=>{Error.call(ye),ye.stack=(new Error).stack});return he.prototype=Object.create(Error.prototype),he.prototype.constructor=he,he}z.d(Be,{d:()=>d})},2806:(Ft,Be,z)=>{z.d(Be,{O:()=>he,x:()=>V});var d=z(2416);let Q=null;function V(ye){if(d.v.useDeprecatedSynchronousErrorHandling){const ue=!Q;if(ue&&(Q={errorThrown:!1,error:null}),ye(),ue){const{errorThrown:Oe,error:Me}=Q;if(Q=null,Oe)throw Me}}else ye()}function he(ye){d.v.useDeprecatedSynchronousErrorHandling&&Q&&(Q.errorThrown=!0,Q.error=ye)}},9672:(Ft,Be,z)=>{function d(Q,V,he,ye=0,ue=!1){const Oe=V.schedule(function(){he(),ue?Q.add(this.schedule(null,ye)):this.unsubscribe()},ye);if(Q.add(Oe),!ue)return Oe}z.d(Be,{f:()=>d})},4671:(Ft,Be,z)=>{function d(Q){return Q}z.d(Be,{y:()=>d})},1144:(Ft,Be,z)=>{z.d(Be,{z:()=>d});const d=Q=>Q&&"number"==typeof Q.length&&"function"!=typeof Q},2206:(Ft,Be,z)=>{z.d(Be,{D:()=>Q});var d=z(576);function Q(V){return Symbol.asyncIterator&&(0,d.m)(V?.[Symbol.asyncIterator])}},576:(Ft,Be,z)=>{function d(Q){return"function"==typeof Q}z.d(Be,{m:()=>d})},3670:(Ft,Be,z)=>{z.d(Be,{c:()=>V});var d=z(8822),Q=z(576);function V(he){return(0,Q.m)(he[d.L])}},6495:(Ft,Be,z)=>{z.d(Be,{T:()=>V});var d=z(2202),Q=z(576);function V(he){return(0,Q.m)(he?.[d.h])}},8239:(Ft,Be,z)=>{z.d(Be,{t:()=>Q});var d=z(576);function Q(V){return(0,d.m)(V?.then)}},3260:(Ft,Be,z)=>{z.d(Be,{L:()=>he,Q:()=>V});var d=z(7582),Q=z(576);function V(ye){return(0,d.FC)(this,arguments,function*(){const Oe=ye.getReader();try{for(;;){const{value:Me,done:Se}=yield(0,d.qq)(Oe.read());if(Se)return yield(0,d.qq)(void 0);yield yield(0,d.qq)(Me)}}finally{Oe.releaseLock()}})}function he(ye){return(0,Q.m)(ye?.getReader)}},3532:(Ft,Be,z)=>{z.d(Be,{K:()=>Q});var d=z(576);function Q(V){return V&&(0,d.m)(V.schedule)}},4482:(Ft,Be,z)=>{z.d(Be,{A:()=>Q,e:()=>V});var d=z(576);function Q(he){return(0,d.m)(he?.lift)}function V(he){return ye=>{if(Q(ye))return ye.lift(function(ue){try{return he(ue,this)}catch(Oe){this.error(Oe)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(Ft,Be,z)=>{function d(){}z.d(Be,{Z:()=>d})},9635:(Ft,Be,z)=>{z.d(Be,{U:()=>V,z:()=>Q});var d=z(4671);function Q(...he){return V(he)}function V(he){return 0===he.length?d.y:1===he.length?he[0]:function(ue){return he.reduce((Oe,Me)=>Me(Oe),ue)}}},7849:(Ft,Be,z)=>{z.d(Be,{h:()=>V});var d=z(2416),Q=z(3410);function V(he){Q.z.setTimeout(()=>{const{onUnhandledError:ye}=d.v;if(!ye)throw he;ye(he)})}},4532:(Ft,Be,z)=>{function d(Q){return new TypeError(`You provided ${null!==Q&&"object"==typeof Q?"an invalid object":`'${Q}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}z.d(Be,{z:()=>d})},4650:(Ft,Be,z)=>{z.d(Be,{$8M:()=>Ja,$WT:()=>Qe,$Z:()=>ex,AFp:()=>b_,ALo:()=>zT,AaK:()=>Me,AsE:()=>t0,CHM:()=>Fd,CRH:()=>W0,CZH:()=>v_,CqO:()=>UA,D6c:()=>CR,DdM:()=>VT,EJc:()=>aR,EiD:()=>DD,EpF:()=>FA,F$t:()=>$v,F4k:()=>BA,FYo:()=>iv,FiY:()=>Ta,Gf:()=>h_,GfV:()=>OE,Gpc:()=>J,Hsn:()=>Hv,Ikx:()=>a0,JOm:()=>Xt,JVY:()=>fE,JZr:()=>xt,Jf7:()=>NE,KtG:()=>Bd,L6k:()=>mE,LAX:()=>Ku,LFG:()=>Tn,LSH:()=>zy,Lbi:()=>pI,Lck:()=>LT,MAs:()=>Ov,MMx:()=>R0,NdJ:()=>Rx,O4$:()=>qf,OlP:()=>Pn,Oqu:()=>e0,P3R:()=>TE,PXZ:()=>lp,Q6J:()=>Um,QGY:()=>Bv,QbO:()=>rR,Qsj:()=>VD,R0b:()=>na,RDi:()=>vD,Rgc:()=>Qh,SBq:()=>Sh,Sil:()=>cR,Suo:()=>f_,TTD:()=>kd,TgZ:()=>Vh,Udp:()=>Yv,W1O:()=>eI,WFA:()=>Mx,X6Q:()=>gb,XFs:()=>Bt,Xpm:()=>Ln,Xts:()=>Ky,Y36:()=>Mh,YKP:()=>t_,YNc:()=>Mv,Yjl:()=>$t,Yz7:()=>At,Z0I:()=>si,ZZ4:()=>pp,_Bn:()=>PT,_UZ:()=>Lv,_Vd:()=>Ch,_c5:()=>IR,_uU:()=>Jx,aQg:()=>Ar,c2e:()=>sR,cJS:()=>Vt,cg1:()=>jh,d8E:()=>zg,dDg:()=>gR,dqk:()=>ni,eBb:()=>xD,eFA:()=>SI,eJc:()=>q0,ekj:()=>Zv,eoX:()=>TI,f3M:()=>Ki,g9A:()=>w_,h0i:()=>Ve,hGG:()=>HI,hij:()=>jg,iGM:()=>XT,ifc:()=>j,ip1:()=>lb,jDz:()=>M0,kL8:()=>c0,kcU:()=>Ll,lG2:()=>Ct,lcZ:()=>Yh,lqb:()=>Yu,lri:()=>EI,mCW:()=>bh,n5z:()=>Bu,n_E:()=>o_,oAB:()=>fe,oxw:()=>Vv,pB0:()=>pE,q3G:()=>Ni,q4F:()=>PE,qLn:()=>Tm,qOj:()=>Og,qZA:()=>Pv,qzn:()=>Js,rWj:()=>xI,s9C:()=>Bg,sBO:()=>yb,s_b:()=>Fs,soG:()=>E_,tBr:()=>Br,tb:()=>gt,tp0:()=>wt,uIk:()=>Sv,vHH:()=>Ce,vpe:()=>to,wAp:()=>en,xi3:()=>WT,xp6:()=>WE,z2F:()=>D_,z3N:()=>Da,zSh:()=>Zc,zs3:()=>Ah});var d=z(7579),Q=z(727),V=z(9751),he=z(6451),ye=z(3099);function ue(a){for(let l in a)if(a[l]===ue)return l;throw Error("Could not find renamed property on target object.")}function Oe(a,l){for(const u in l)l.hasOwnProperty(u)&&!a.hasOwnProperty(u)&&(a[u]=l[u])}function Me(a){if("string"==typeof a)return a;if(Array.isArray(a))return"["+a.map(Me).join(", ")+"]";if(null==a)return""+a;if(a.overriddenName)return`${a.overriddenName}`;if(a.name)return`${a.name}`;const l=a.toString();if(null==l)return""+l;const u=l.indexOf("\n");return-1===u?l:l.substring(0,u)}function Se(a,l){return null==a||""===a?null===l?"":l:null==l||""===l?a:a+" "+l}const ee=ue({__forward_ref__:ue});function J(a){return a.__forward_ref__=J,a.toString=function(){return Me(this())},a}function ce(a){return tt(a)?a():a}function tt(a){return"function"==typeof a&&a.hasOwnProperty(ee)&&a.__forward_ref__===J}function Ue(a){return a&&!!a.\u0275providers}const xt="https://g.co/ng/security#xss";class Ce extends Error{constructor(l,u){super(Ke(l,u)),this.code=l}}function Ke(a,l){return`NG0${Math.abs(a)}${l?": "+l.trim():""}`}function qe(a){return"string"==typeof a?a:null==a?"":String(a)}function at(a,l){throw new Ce(-201,!1)}function Te(a,l){null==a&&function pe(a,l,u,f){throw new Error(`ASSERTION ERROR: ${a}`+(null==f?"":` [Expected=> ${u} ${f} ${l} <=Actual]`))}(l,a,null,"!=")}function At(a){return{token:a.token,providedIn:a.providedIn||null,factory:a.factory,value:void 0}}function Vt(a){return{providers:a.providers||[],imports:a.imports||[]}}function Sn(a){return jn(a,pi)||jn(a,ir)}function si(a){return null!==Sn(a)}function jn(a,l){return a.hasOwnProperty(l)?a[l]:null}function Ri(a){return a&&(a.hasOwnProperty(Mi)||a.hasOwnProperty(yi))?a[Mi]:null}const pi=ue({\u0275prov:ue}),Mi=ue({\u0275inj:ue}),ir=ue({ngInjectableDef:ue}),yi=ue({ngInjectorDef:ue});var Bt=(()=>((Bt=Bt||{})[Bt.Default=0]="Default",Bt[Bt.Host=1]="Host",Bt[Bt.Self=2]="Self",Bt[Bt.SkipSelf=4]="SkipSelf",Bt[Bt.Optional=8]="Optional",Bt))();let Ts;function Nn(a){const l=Ts;return Ts=a,l}function Hr(a,l,u){const f=Sn(a);return f&&"root"==f.providedIn?void 0===f.value?f.value=f.factory():f.value:u&Bt.Optional?null:void 0!==l?l:void at(Me(a))}const ni=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),rr={},ci="__NG_DI_FLAG__",vi="ngTempTokenPath",fr="ngTokenPath",Wi=/\n/gm,ca="\u0275",Gn="__source";let ui;function sn(a){const l=ui;return ui=a,l}function uo(a,l=Bt.Default){if(void 0===ui)throw new Ce(-203,!1);return null===ui?Hr(a,void 0,l):ui.get(a,l&Bt.Optional?null:void 0,l)}function Tn(a,l=Bt.Default){return(function la(){return Ts}()||uo)(ce(a),l)}function Ki(a,l=Bt.Default){return Tn(a,sr(l))}function sr(a){return typeof a>"u"||"number"==typeof a?a:0|(a.optional&&8)|(a.host&&1)|(a.self&&2)|(a.skipSelf&&4)}function rs(a){const l=[];for(let u=0;u<a.length;u++){const f=ce(a[u]);if(Array.isArray(f)){if(0===f.length)throw new Ce(900,!1);let p,_=Bt.Default;for(let w=0;w<f.length;w++){const I=f[w],C=Is(I);"number"==typeof C?-1===C?p=I.token:_|=C:p=I}l.push(Tn(p,_))}else l.push(Tn(f))}return l}function qi(a,l){return a[ci]=l,a.prototype[ci]=l,a}function Is(a){return a[ci]}function Z(a){return{toString:a}.toString()}var $=(()=>(($=$||{})[$.OnPush=0]="OnPush",$[$.Default=1]="Default",$))(),j=(()=>{return(a=j||(j={}))[a.Emulated=0]="Emulated",a[a.None=2]="None",a[a.ShadowDom=3]="ShadowDom",j;var a})();const U={},ie=[],ke=ue({\u0275cmp:ue}),ut=ue({\u0275dir:ue}),tn=ue({\u0275pipe:ue}),Zt=ue({\u0275mod:ue}),hn=ue({\u0275fac:ue}),Ut=ue({__NG_ELEMENT_ID__:ue});let Yn=0;function Ln(a){return Z(()=>{const l=Lr(a),u={...l,decls:a.decls,vars:a.vars,template:a.template,consts:a.consts||null,ngContentSelectors:a.ngContentSelectors,onPush:a.changeDetection===$.OnPush,directiveDefs:null,pipeDefs:null,dependencies:l.standalone&&a.dependencies||null,getStandaloneInjector:null,data:a.data||{},encapsulation:a.encapsulation||j.Emulated,id:"c"+Yn++,styles:a.styles||ie,_:null,schemas:a.schemas||null,tView:null};ho(u);const f=a.dependencies;return u.directiveDefs=Ga(f,!1),u.pipeDefs=Ga(f,!0),u})}function ss(a){return Pt(a)||Rn(a)}function xe(a){return null!==a}function fe(a){return Z(()=>({type:a.type,bootstrap:a.bootstrap||ie,declarations:a.declarations||ie,imports:a.imports||ie,exports:a.exports||ie,transitiveCompileScopes:null,schemas:a.schemas||null,id:a.id||null}))}function It(a,l){if(null==a)return U;const u={};for(const f in a)if(a.hasOwnProperty(f)){let p=a[f],_=p;Array.isArray(p)&&(_=p[1],p=p[0]),u[p]=f,l&&(l[p]=_)}return u}function Ct(a){return Z(()=>{const l=Lr(a);return ho(l),l})}function $t(a){return{type:a.type,name:a.name,factory:null,pure:!1!==a.pure,standalone:!0===a.standalone,onDestroy:a.type.prototype.ngOnDestroy||null}}function Pt(a){return a[ke]||null}function Rn(a){return a[ut]||null}function Mn(a){return a[tn]||null}function Qe(a){const l=Pt(a)||Rn(a)||Mn(a);return null!==l&&l.standalone}function Jn(a,l){const u=a[Zt]||null;if(!u&&!0===l)throw new Error(`Type ${Me(a)} does not have '\u0275mod' property.`);return u}function Lr(a){const l={};return{type:a.type,providersResolver:null,factory:null,hostBindings:a.hostBindings||null,hostVars:a.hostVars||0,hostAttrs:a.hostAttrs||null,contentQueries:a.contentQueries||null,declaredInputs:l,exportAs:a.exportAs||null,standalone:!0===a.standalone,selectors:a.selectors||ie,viewQuery:a.viewQuery||null,features:a.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:It(a.inputs,l),outputs:It(a.outputs)}}function ho(a){a.features?.forEach(l=>l(a))}function Ga(a,l){if(!a)return null;const u=l?Mn:ss;return()=>("function"==typeof a?a():a).map(f=>u(f)).filter(xe)}const os=0,bt=1,vn=2,ii=3,Nr=4,fo=5,Er=6,ua=7,fn=8,oi=9,as=10,Jt=11,xl=12,da=13,Lo=14,za=15,or=16,Tl=17,ls=18,Ws=19,ha=20,Wa=21,ei=22,Ds=1,xr=2,fc=7,Il=8,cs=9,mr=10;function Tr(a){return Array.isArray(a)&&"object"==typeof a[Ds]}function Ks(a){return Array.isArray(a)&&!0===a[Ds]}function fa(a){return 0!=(4&a.flags)}function us(a){return a.componentOffset>-1}function qs(a){return 1==(1&a.flags)}function ds(a){return!!a.template}function mo(a){return 0!=(256&a[vn])}function ma(a,l){return a.hasOwnProperty(hn)?a[hn]:null}class $f{constructor(l,u,f){this.previousValue=l,this.currentValue=u,this.firstChange=f}isFirstChange(){return this.firstChange}}function kd(){return vu}function vu(a){return a.type.prototype.ngOnChanges&&(a.setInput=Cl),Hf}function Hf(){const a=jf(this),l=a?.current;if(l){const u=a.previous;if(u===U)a.previous=l;else for(let f in l)u[f]=l[f];a.current=null,this.ngOnChanges(l)}}function Cl(a,l,u,f){const p=this.declaredInputs[u],_=jf(a)||function Gf(a,l){return a[_c]=l}(a,{previous:U,current:null}),w=_.current||(_.current={}),I=_.previous,C=I[p];w[p]=new $f(C&&C.currentValue,l,I===U),a[f]=l}kd.ngInherit=!0;const _c="__ngSimpleChanges__";function jf(a){return a[_c]||null}const Oi=function(a,l,u){},yc="svg";function Dn(a){for(;Array.isArray(a);)a=a[os];return a}function qa(a,l){return Dn(l[a])}function pr(a,l){return Dn(l[a.index])}function wu(a,l){return a.data[l]}function Gr(a,l){return a[l]}function ar(a,l){const u=l[a];return Tr(u)?u:u[os]}function As(a){return 64==(64&a[vn])}function Bo(a,l){return null==l?null:a[l]}function bc(a){a[ls]=0}function Ya(a,l){a[fo]+=l;let u=a,f=a[ii];for(;null!==f&&(1===l&&1===u[fo]||-1===l&&0===u[fo]);)f[fo]+=l,u=f,f=f[ii]}const nn={lFrame:jd(null),bindingsEnabled:!0};function xu(){return nn.bindingsEnabled}function De(){return nn.lFrame.lView}function mn(){return nn.lFrame.tView}function Fd(a){return nn.lFrame.contextLView=a,a[fn]}function Bd(a){return nn.lFrame.contextLView=null,a}function lr(){let a=Ud();for(;null!==a&&64===a.type;)a=a.parent;return a}function Ud(){return nn.lFrame.currentTNode}function cr(a,l){const u=nn.lFrame;u.currentTNode=a,u.isParent=l}function Tu(){return nn.lFrame.isParent}function Iu(){nn.lFrame.isParent=!1}function di(){const a=nn.lFrame;let l=a.bindingRootIndex;return-1===l&&(l=a.bindingRootIndex=a.tView.bindingStartIndex),l}function Ml(){return nn.lFrame.bindingIndex++}function po(a){const l=nn.lFrame,u=l.bindingIndex;return l.bindingIndex=l.bindingIndex+a,u}function Ol(a,l){const u=nn.lFrame;u.bindingIndex=u.bindingRootIndex=a,Rs(l)}function Rs(a){nn.lFrame.currentDirectiveIndex=a}function hs(a){const l=nn.lFrame.currentDirectiveIndex;return-1===l?null:a[l]}function Ec(){return nn.lFrame.currentQueryIndex}function Ir(a){nn.lFrame.currentQueryIndex=a}function Wf(a){const l=a[bt];return 2===l.type?l.declTNode:1===l.type?a[Er]:null}function $d(a,l,u){if(u&Bt.SkipSelf){let p=l,_=a;for(;!(p=p.parent,null!==p||u&Bt.Host||(p=Wf(_),null===p||(_=_[za],10&p.type))););if(null===p)return!1;l=p,a=_}const f=nn.lFrame=Hd();return f.currentTNode=l,f.lView=a,!0}function Pl(a){const l=Hd(),u=a[bt];nn.lFrame=l,l.currentTNode=u.firstChild,l.lView=a,l.tView=u,l.contextLView=a,l.bindingIndex=u.bindingStartIndex,l.inI18n=!1}function Hd(){const a=nn.lFrame,l=null===a?null:a.child;return null===l?jd(a):l}function jd(a){const l={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:a,child:null,inI18n:!1};return null!==a&&(a.child=l),l}function Kf(){const a=nn.lFrame;return nn.lFrame=a.parent,a.currentTNode=null,a.lView=null,a}const go=Kf;function pa(){const a=Kf();a.isParent=!0,a.tView=null,a.selectedIndex=-1,a.contextLView=null,a.elementDepthCount=0,a.currentDirectiveIndex=-1,a.currentNamespace=null,a.bindingRootIndex=-1,a.bindingIndex=-1,a.currentQueryIndex=0}function Ii(){return nn.lFrame.selectedIndex}function Uo(a){nn.lFrame.selectedIndex=a}function ai(){const a=nn.lFrame;return wu(a.tView,a.selectedIndex)}function qf(){nn.lFrame.currentNamespace=yc}function Ll(){!function zd(){nn.lFrame.currentNamespace=null}()}function Nl(a,l){for(let u=l.directiveStart,f=l.directiveEnd;u<f;u++){const _=a.data[u].type.prototype,{ngAfterContentInit:w,ngAfterContentChecked:I,ngAfterViewInit:C,ngAfterViewChecked:M,ngOnDestroy:B}=_;w&&(a.contentHooks??(a.contentHooks=[])).push(-u,w),I&&((a.contentHooks??(a.contentHooks=[])).push(u,I),(a.contentCheckHooks??(a.contentCheckHooks=[])).push(u,I)),C&&(a.viewHooks??(a.viewHooks=[])).push(-u,C),M&&((a.viewHooks??(a.viewHooks=[])).push(u,M),(a.viewCheckHooks??(a.viewCheckHooks=[])).push(u,M)),null!=B&&(a.destroyHooks??(a.destroyHooks=[])).push(u,B)}}function Tc(a,l,u){Fl(a,l,3,u)}function Du(a,l,u,f){(3&a[vn])===u&&Fl(a,l,u,f)}function Ic(a,l){let u=a[vn];(3&u)===l&&(u&=2047,u+=1,a[vn]=u)}function Fl(a,l,u,f){const _=f??-1,w=l.length-1;let I=0;for(let C=void 0!==f?65535&a[ls]:0;C<w;C++)if("number"==typeof l[C+1]){if(I=l[C],null!=f&&I>=f)break}else l[C]<0&&(a[ls]+=65536),(I<_||-1==_)&&(Bl(a,u,l,C),a[ls]=(4294901760&a[ls])+C+2),C++}function Bl(a,l,u,f){const p=u[f]<0,_=u[f+1],I=a[p?-u[f]:u[f]];if(p){if(a[vn]>>11<a[ls]>>16&&(3&a[vn])===l){a[vn]+=2048,Oi(4,I,_);try{_.call(I)}finally{Oi(5,I,_)}}}else{Oi(4,I,_);try{_.call(I)}finally{Oi(5,I,_)}}}const _a=-1;class Vo{constructor(l,u,f){this.factory=l,this.resolving=!1,this.canSeeViewProviders=u,this.injectImpl=f}}function Za(a,l,u){let f=0;for(;f<u.length;){const p=u[f];if("number"==typeof p){if(0!==p)break;f++;const _=u[f++],w=u[f++],I=u[f++];a.setAttribute(l,w,I,_)}else{const _=p,w=u[++f];$o(_)?a.setProperty(l,_,w):a.setAttribute(l,_,w),f++}}return f}function Ru(a){return 3===a||4===a||6===a}function $o(a){return 64===a.charCodeAt(0)}function ya(a,l){if(null!==l&&0!==l.length)if(null===a||0===a.length)a=l.slice();else{let u=-1;for(let f=0;f<l.length;f++){const p=l[f];"number"==typeof p?u=p:0===u||_o(a,u,p,null,-1===u||2===u?l[++f]:null)}}return a}function _o(a,l,u,f,p){let _=0,w=a.length;if(-1===l)w=-1;else for(;_<a.length;){const I=a[_++];if("number"==typeof I){if(I===l){w=-1;break}if(I>l){w=_-1;break}}}for(;_<a.length;){const I=a[_];if("number"==typeof I)break;if(I===u){if(null===f)return void(null!==p&&(a[_+1]=p));if(f===a[_+1])return void(a[_+2]=p)}_++,null!==f&&_++,null!==p&&_++}-1!==w&&(a.splice(w,0,l),_=w+1),a.splice(_++,0,u),null!==f&&a.splice(_++,0,f),null!==p&&a.splice(_++,0,p)}function Ul(a){return a!==_a}function Vl(a){return 32767&a}function Sc(a,l){let u=function Qf(a){return a>>16}(a),f=l;for(;u>0;)f=f[za],u--;return f}let Dc=!0;function Xa(a){const l=Dc;return Dc=a,l}const Jf=255,Mu=5;let Ou=0;const fs={};function qd(a,l){const u=em(a,l);if(-1!==u)return u;const f=l[bt];f.firstCreatePass&&(a.injectorIndex=l.length,Yd(f.data,a),Yd(l,null),Yd(f.blueprint,null));const p=Ho(a,l),_=a.injectorIndex;if(Ul(p)){const w=Vl(p),I=Sc(p,l),C=I[bt].data;for(let M=0;M<8;M++)l[_+M]=I[w+M]|C[w+M]}return l[_+8]=p,_}function Yd(a,l){a.push(0,0,0,0,0,0,0,0,l)}function em(a,l){return-1===a.injectorIndex||a.parent&&a.parent.injectorIndex===a.injectorIndex||null===l[a.injectorIndex+8]?-1:a.injectorIndex}function Ho(a,l){if(a.parent&&-1!==a.parent.injectorIndex)return a.parent.injectorIndex;let u=0,f=null,p=l;for(;null!==p;){if(f=eh(p),null===f)return _a;if(u++,p=p[za],-1!==f.injectorIndex)return f.injectorIndex|u<<16}return _a}function jo(a,l,u){!function Kd(a,l,u){let f;"string"==typeof u?f=u.charCodeAt(0)||0:u.hasOwnProperty(Ut)&&(f=u[Ut]),null==f&&(f=u[Ut]=Ou++);const p=f&Jf;l.data[a+(p>>Mu)]|=1<<p}(a,l,u)}function Lu(a,l,u){if(u&Bt.Optional||void 0!==a)return a;at()}function Ac(a,l,u,f){if(u&Bt.Optional&&void 0===f&&(f=null),!(u&(Bt.Self|Bt.Host))){const p=a[oi],_=Nn(void 0);try{return p?p.get(l,f,u&Bt.Optional):Hr(l,f,u&Bt.Optional)}finally{Nn(_)}}return Lu(f,0,u)}function Zd(a,l,u,f=Bt.Default,p){if(null!==a){if(1024&l[vn]){const w=function Jd(a,l,u,f,p){let _=a,w=l;for(;null!==_&&null!==w&&1024&w[vn]&&!(256&w[vn]);){const I=Nu(_,w,u,f|Bt.Self,fs);if(I!==fs)return I;let C=_.parent;if(!C){const M=w[Wa];if(M){const B=M.get(u,fs,f);if(B!==fs)return B}C=eh(w),w=w[za]}_=C}return p}(a,l,u,f,fs);if(w!==fs)return w}const _=Nu(a,l,u,f,fs);if(_!==fs)return _}return Ac(l,u,f,p)}function Nu(a,l,u,f,p){const _=function tm(a){if("string"==typeof a)return a.charCodeAt(0)||0;const l=a.hasOwnProperty(Ut)?a[Ut]:void 0;return"number"==typeof l?l>=0?l&Jf:Qd:l}(u);if("function"==typeof _){if(!$d(l,a,f))return f&Bt.Host?Lu(p,0,f):Ac(l,u,f,p);try{const w=_(f);if(null!=w||f&Bt.Optional)return w;at()}finally{go()}}else if("number"==typeof _){let w=null,I=em(a,l),C=_a,M=f&Bt.Host?l[or][Er]:null;for((-1===I||f&Bt.SkipSelf)&&(C=-1===I?Ho(a,l):l[I+8],C!==_a&&Fu(f,!1)?(w=l[bt],I=Vl(C),l=Sc(C,l)):I=-1);-1!==I;){const B=l[bt];if(va(_,I,B.data)){const W=Xd(I,l,u,w,f,M);if(W!==fs)return W}C=l[I+8],C!==_a&&Fu(f,l[bt].data[I+8]===M)&&va(_,I,l)?(w=B,I=Vl(C),l=Sc(C,l)):I=-1}}return p}function Xd(a,l,u,f,p,_){const w=l[bt],I=w.data[a+8],B=yo(I,w,u,null==f?us(I)&&Dc:f!=w&&0!=(3&I.type),p&Bt.Host&&_===I);return null!==B?vo(l,w,B,I):fs}function yo(a,l,u,f,p){const _=a.providerIndexes,w=l.data,I=1048575&_,C=a.directiveStart,B=_>>20,se=p?I+B:a.directiveEnd;for(let de=f?I:I+B;de<se;de++){const Pe=w[de];if(de<C&&u===Pe||de>=C&&Pe.type===u)return de}if(p){const de=w[C];if(de&&ds(de)&&de.type===u)return C}return null}function vo(a,l,u,f){let p=a[u];const _=l.data;if(function Yf(a){return a instanceof Vo}(p)){const w=p;w.resolving&&function Ye(a,l){const u=l?`. Dependency path: ${l.join(" > ")} > ${a}`:"";throw new Ce(-200,`Circular dependency in DI detected for ${a}${u}`)}(function it(a){return"function"==typeof a?a.name||a.toString():"object"==typeof a&&null!=a&&"function"==typeof a.type?a.type.name||a.type.toString():qe(a)}(_[u]));const I=Xa(w.canSeeViewProviders);w.resolving=!0;const C=w.injectImpl?Nn(w.injectImpl):null;$d(a,f,Bt.Default);try{p=a[u]=w.factory(void 0,_,a,f),l.firstCreatePass&&u>=f.directiveStart&&function ga(a,l,u){const{ngOnChanges:f,ngOnInit:p,ngDoCheck:_}=l.type.prototype;if(f){const w=vu(l);(u.preOrderHooks??(u.preOrderHooks=[])).push(a,w),(u.preOrderCheckHooks??(u.preOrderCheckHooks=[])).push(a,w)}p&&(u.preOrderHooks??(u.preOrderHooks=[])).push(0-a,p),_&&((u.preOrderHooks??(u.preOrderHooks=[])).push(a,_),(u.preOrderCheckHooks??(u.preOrderCheckHooks=[])).push(a,_))}(u,_[u],l)}finally{null!==C&&Nn(C),Xa(I),w.resolving=!1,go()}}return p}function va(a,l,u){return!!(u[l+(a>>Mu)]&1<<a)}function Fu(a,l){return!(a&Bt.Self||a&Bt.Host&&l)}class ba{constructor(l,u){this._tNode=l,this._lView=u}get(l,u,f){return Zd(this._tNode,this._lView,l,sr(f),u)}}function Qd(){return new ba(lr(),De())}function Bu(a){return Z(()=>{const l=a.prototype.constructor,u=l[hn]||Qa(l),f=Object.prototype;let p=Object.getPrototypeOf(a.prototype).constructor;for(;p&&p!==f;){const _=p[hn]||Qa(p);if(_&&_!==u)return _;p=Object.getPrototypeOf(p)}return _=>new _})}function Qa(a){return tt(a)?()=>{const l=Qa(ce(a));return l&&l()}:ma(a)}function eh(a){const l=a[bt],u=l.type;return 2===u?l.declTNode:1===u?a[Er]:null}function Ja(a){return function Pu(a,l){if("class"===l)return a.classes;if("style"===l)return a.styles;const u=a.attrs;if(u){const f=u.length;let p=0;for(;p<f;){const _=u[p];if(Ru(_))break;if(0===_)p+=2;else if("number"==typeof _)for(p++;p<f&&"string"==typeof u[p];)p++;else{if(_===l)return u[p+1];p+=2}}}return null}(lr(),a)}const bo="__parameters__";function el(a,l,u){return Z(()=>{const f=function kn(a){return function(...u){if(a){const f=a(...u);for(const p in f)this[p]=f[p]}}}(l);function p(..._){if(this instanceof p)return f.apply(this,_),this;const w=new p(..._);return I.annotation=w,I;function I(C,M,B){const W=C.hasOwnProperty(bo)?C[bo]:Object.defineProperty(C,bo,{value:[]})[bo];for(;W.length<=B;)W.push(null);return(W[B]=W[B]||[]).push(w),C}}return u&&(p.prototype=Object.create(u.prototype)),p.prototype.ngMetadataName=a,p.annotationCls=p,p})}class Pn{constructor(l,u){this._desc=l,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof u?this.__NG_ELEMENT_ID__=u:void 0!==u&&(this.\u0275prov=At({token:this,providedIn:u.providedIn||"root",factory:u.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Ea(a,l){a.forEach(u=>Array.isArray(u)?Ea(u,l):l(u))}function sm(a,l,u){l>=a.length?a.push(u):a.splice(l,0,u)}function Hl(a,l){return l>=a.length-1?a.pop():a.splice(l,1)[0]}function Oc(a,l){const u=[];for(let f=0;f<a;f++)u.push(l);return u}function ms(a,l,u){let f=Fr(a,l);return f>=0?a[1|f]=u:(f=~f,function Pc(a,l,u,f){let p=a.length;if(p==l)a.push(u,f);else if(1===p)a.push(f,a[0]),a[0]=u;else{for(p--,a.push(a[p-1],a[p]);p>l;)a[p]=a[p-2],p--;a[l]=u,a[l+1]=f}}(a,f,l,u)),f}function zn(a,l){const u=Fr(a,l);if(u>=0)return a[1|u]}function Fr(a,l){return function pn(a,l,u){let f=0,p=a.length>>u;for(;p!==f;){const _=f+(p-f>>1),w=a[_<<u];if(l===w)return _<<u;w>l?p=_:f=_+1}return~(p<<u)}(a,l,1)}const Br=qi(el("Inject",a=>({token:a})),-1),Ta=qi(el("Optional"),8),wt=qi(el("SkipSelf"),4);var Xt=(()=>((Xt=Xt||{})[Xt.Important=1]="Important",Xt[Xt.DashCase=2]="DashCase",Xt))();const dh=new Map;let Io=0;const X="__ngContext__";function le(a,l){Tr(l)?(a[X]=l[ha],function hh(a){dh.set(a[ha],a)}(l)):a[X]=l}let on;function Li(a,l){return on(a,l)}function Ls(a){const l=a[ii];return Ks(l)?l[ii]:l}function Kl(a){return um(a[da])}function ql(a){return um(a[Nr])}function um(a){for(;null!==a&&!Ks(a);)a=a[Nr];return a}function sl(a,l,u,f,p){if(null!=f){let _,w=!1;Ks(f)?_=f:Tr(f)&&(w=!0,f=f[os]);const I=Dn(f);0===a&&null!==u?null==p?Kt(l,u,I):Mt(l,u,I,p||null,!0):1===a&&null!==u?Mt(l,u,I,p||null,!0):2===a?function Py(a,l,u){const f=dr(a,l);f&&function ur(a,l,u,f){a.removeChild(l,u,f)}(a,f,l,u)}(l,I,w):3===a&&l.destroyNode(I),null!=_&&function pm(a,l,u,f,p){const _=u[fc];_!==Dn(u)&&sl(l,a,f,_,p);for(let I=mr;I<u.length;I++){const C=u[I];mm(C[bt],C,a,l,f,_)}}(l,a,_,u,p)}}function hm(a,l,u){return a.createElement(l,u)}function T(a,l){const u=a[cs],f=u.indexOf(l),p=l[ii];512&l[vn]&&(l[vn]&=-513,Ya(p,-1)),u.splice(f,1)}function P(a,l){if(a.length<=mr)return;const u=mr+l,f=a[u];if(f){const p=f[Tl];null!==p&&p!==a&&T(p,f),l>0&&(a[u-1][Nr]=f[Nr]);const _=Hl(a,mr+l);!function ug(a,l){mm(a,l,l[Jt],2,null,null),l[os]=null,l[Er]=null}(f[bt],f);const w=_[Ws];null!==w&&w.detachView(_[bt]),f[ii]=null,f[Nr]=null,f[vn]&=-65}return f}function F(a,l){if(!(128&l[vn])){const u=l[Jt];u.destroyNode&&mm(a,l,u,3,null,null),function k(a){let l=a[da];if(!l)return q(a[bt],a);for(;l;){let u=null;if(Tr(l))u=l[da];else{const f=l[mr];f&&(u=f)}if(!u){for(;l&&!l[Nr]&&l!==a;)Tr(l)&&q(l[bt],l),l=l[ii];null===l&&(l=a),Tr(l)&&q(l[bt],l),u=l&&l[Nr]}l=u}}(l)}}function q(a,l){if(!(128&l[vn])){l[vn]&=-65,l[vn]|=128,function me(a,l){let u;if(null!=a&&null!=(u=a.destroyHooks))for(let f=0;f<u.length;f+=2){const p=l[u[f]];if(!(p instanceof Vo)){const _=u[f+1];if(Array.isArray(_))for(let w=0;w<_.length;w+=2){const I=p[_[w]],C=_[w+1];Oi(4,I,C);try{C.call(I)}finally{Oi(5,I,C)}}else{Oi(4,p,_);try{_.call(p)}finally{Oi(5,p,_)}}}}}(a,l),function re(a,l){const u=a.cleanup,f=l[ua];let p=-1;if(null!==u)for(let _=0;_<u.length-1;_+=2)if("string"==typeof u[_]){const w=u[_+3];w>=0?f[p=w]():f[p=-w].unsubscribe(),_+=2}else{const w=f[p=u[_+1]];u[_].call(w)}if(null!==f){for(let _=p+1;_<f.length;_++)(0,f[_])();l[ua]=null}}(a,l),1===l[bt].type&&l[Jt].destroy();const u=l[Tl];if(null!==u&&Ks(l[ii])){u!==l[ii]&&T(u,l);const f=l[Ws];null!==f&&f.detachView(a)}!function lg(a){dh.delete(a[ha])}(l)}}function Fe(a,l,u){return function Ht(a,l,u){let f=l;for(;null!==f&&40&f.type;)f=(l=f).parent;if(null===f)return u[os];{const{componentOffset:p}=f;if(p>-1){const{encapsulation:_}=a.data[f.directiveStart+p];if(_===j.None||_===j.Emulated)return null}return pr(f,u)}}(a,l.parent,u)}function Mt(a,l,u,f,p){a.insertBefore(l,u,f,p)}function Kt(a,l,u){a.appendChild(l,u)}function Fn(a,l,u,f,p){null!==f?Mt(a,l,u,f,p):Kt(a,l,u)}function dr(a,l){return a.parentNode(l)}function mh(a,l,u){return ol(a,l,u)}let ph,zu,Fy,dg,ol=function Gu(a,l,u){return 40&a.type?pr(a,u):null};function Kc(a,l,u,f){const p=Fe(a,f,l),_=l[Jt],I=mh(f.parent||l[Er],f,l);if(null!=p)if(Array.isArray(u))for(let C=0;C<u.length;C++)Fn(_,p,u[C],I,!1);else Fn(_,p,u,I,!1);void 0!==ph&&ph(_,f,l,u,p)}function _h(a,l){if(null!==l){const u=l.type;if(3&u)return pr(l,a);if(4&u)return al(-1,a[l.index]);if(8&u){const f=l.child;if(null!==f)return _h(a,f);{const p=a[l.index];return Ks(p)?al(-1,p):Dn(p)}}if(32&u)return Li(l,a)()||Dn(a[l.index]);{const f=qc(a,l);return null!==f?Array.isArray(f)?f[0]:_h(Ls(a[or]),f):_h(a,l.next)}}return null}function qc(a,l){return null!==l?a[or][Er].projection[l.projection]:null}function al(a,l){const u=mr+a+1;if(u<l.length){const f=l[u],p=f[bt].firstChild;if(null!==p)return _h(f,p)}return l[fc]}function fm(a,l,u,f,p,_,w){for(;null!=u;){const I=f[u.index],C=u.type;if(w&&0===l&&(I&&le(Dn(I),f),u.flags|=2),32!=(32&u.flags))if(8&C)fm(a,l,u.child,f,p,_,!1),sl(l,a,p,I,_);else if(32&C){const M=Li(u,f);let B;for(;B=M();)sl(l,a,p,B,_);sl(l,a,p,I,_)}else 16&C?Ly(a,l,f,u,p,_):sl(l,a,p,I,_);u=w?u.projectionNext:u.next}}function mm(a,l,u,f,p,_){fm(u,f,a.firstChild,l,p,_,!1)}function Ly(a,l,u,f,p,_){const w=u[or],C=w[Er].projection[f.projection];if(Array.isArray(C))for(let M=0;M<C.length;M++)sl(l,a,p,C[M],_);else fm(a,l,C,w[ii],p,_,!0)}function Yc(a,l,u){""===u?a.removeAttribute(l,"class"):a.setAttribute(l,"class",u)}function gm(a,l,u){const{mergedAttrs:f,classes:p,styles:_}=u;null!==f&&Za(a,l,f),null!==p&&Yc(a,l,p),null!==_&&function Ny(a,l,u){a.setAttribute(l,"style",u)}(a,l,_)}function yh(a){return function _m(){if(void 0===zu&&(zu=null,ni.trustedTypes))try{zu=ni.trustedTypes.createPolicy("angular",{createHTML:a=>a,createScript:a=>a,createScriptURL:a=>a})}catch{}return zu}()?.createHTML(a)||a}function vD(a){Fy=a}function dE(a){return function By(){if(void 0===dg&&(dg=null,ni.trustedTypes))try{dg=ni.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:a=>a,createScript:a=>a,createScriptURL:a=>a})}catch{}return dg}()?.createScriptURL(a)||a}class Wu{constructor(l){this.changingThisBreaksApplicationSecurity=l}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${xt})`}}class bD extends Wu{getTypeName(){return"HTML"}}class wD extends Wu{getTypeName(){return"Style"}}class ED extends Wu{getTypeName(){return"Script"}}class hE extends Wu{getTypeName(){return"URL"}}class Vy extends Wu{getTypeName(){return"ResourceURL"}}function Da(a){return a instanceof Wu?a.changingThisBreaksApplicationSecurity:a}function Js(a,l){const u=function vh(a){return a instanceof Wu&&a.getTypeName()||null}(a);if(null!=u&&u!==l){if("ResourceURL"===u&&"URL"===l)return!0;throw new Error(`Required a safe ${l}, got a ${u} (see ${xt})`)}return u===l}function fE(a){return new bD(a)}function mE(a){return new wD(a)}function xD(a){return new ED(a)}function Ku(a){return new hE(a)}function pE(a){return new Vy(a)}class hg{constructor(l){this.inertDocumentHelper=l}getInertBodyElement(l){l="<body><remove></remove>"+l;try{const u=(new window.DOMParser).parseFromString(yh(l),"text/html").body;return null===u?this.inertDocumentHelper.getInertBodyElement(l):(u.removeChild(u.firstChild),u)}catch{return null}}}class _E{constructor(l){this.defaultDoc=l,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(l){const u=this.inertDocument.createElement("template");return u.innerHTML=yh(l),u}}const yE=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function bh(a){return(a=String(a)).match(yE)?a:"unsafe:"+a}function Aa(a){const l={};for(const u of a.split(","))l[u]=!0;return l}function ym(...a){const l={};for(const u of a)for(const f in u)u.hasOwnProperty(f)&&(l[f]=!0);return l}const wh=Aa("area,br,col,hr,img,wbr"),vE=Aa("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),bE=Aa("rp,rt"),fg=ym(wh,ym(vE,Aa("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),ym(bE,Aa("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ym(bE,vE)),mg=Aa("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),vm=ym(mg,Aa("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Aa("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),gg=Aa("script,style,template");class CD{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(l){let u=l.firstChild,f=!0;for(;u;)if(u.nodeType===Node.ELEMENT_NODE?f=this.startElement(u):u.nodeType===Node.TEXT_NODE?this.chars(u.nodeValue):this.sanitizedSomething=!0,f&&u.firstChild)u=u.firstChild;else for(;u;){u.nodeType===Node.ELEMENT_NODE&&this.endElement(u);let p=this.checkClobberedElement(u,u.nextSibling);if(p){u=p;break}u=this.checkClobberedElement(u,u.parentNode)}return this.buf.join("")}startElement(l){const u=l.nodeName.toLowerCase();if(!fg.hasOwnProperty(u))return this.sanitizedSomething=!0,!gg.hasOwnProperty(u);this.buf.push("<"),this.buf.push(u);const f=l.attributes;for(let p=0;p<f.length;p++){const _=f.item(p),w=_.name,I=w.toLowerCase();if(!vm.hasOwnProperty(I)){this.sanitizedSomething=!0;continue}let C=_.value;mg[I]&&(C=bh(C)),this.buf.push(" ",w,'="',jy(C),'"')}return this.buf.push(">"),!0}endElement(l){const u=l.nodeName.toLowerCase();fg.hasOwnProperty(u)&&!wh.hasOwnProperty(u)&&(this.buf.push("</"),this.buf.push(u),this.buf.push(">"))}chars(l){this.buf.push(jy(l))}checkClobberedElement(l,u){if(u&&(l.compareDocumentPosition(u)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${l.outerHTML}`);return u}}const SD=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Hy=/([^\#-~ |!])/g;function jy(a){return a.replace(/&/g,"&amp;").replace(SD,function(l){return"&#"+(1024*(l.charCodeAt(0)-55296)+(l.charCodeAt(1)-56320)+65536)+";"}).replace(Hy,function(l){return"&#"+l.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Gy;function DD(a,l){let u=null;try{Gy=Gy||function gE(a){const l=new _E(a);return function $y(){try{return!!(new window.DOMParser).parseFromString(yh(""),"text/html")}catch{return!1}}()?new hg(l):l}(a);let f=l?String(l):"";u=Gy.getInertBodyElement(f);let p=5,_=f;do{if(0===p)throw new Error("Failed to sanitize html because the input is unstable");p--,f=_,_=u.innerHTML,u=Gy.getInertBodyElement(f)}while(f!==_);return yh((new CD).sanitizeChildren(EE(u)||u))}finally{if(u){const f=EE(u)||u;for(;f.firstChild;)f.removeChild(f.firstChild)}}}function EE(a){return"content"in a&&function wP(a){return a.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===a.nodeName}(a)?a.content:null}var Ni=(()=>((Ni=Ni||{})[Ni.NONE=0]="NONE",Ni[Ni.HTML=1]="HTML",Ni[Ni.STYLE=2]="STYLE",Ni[Ni.SCRIPT=3]="SCRIPT",Ni[Ni.URL=4]="URL",Ni[Ni.RESOURCE_URL=5]="RESOURCE_URL",Ni))();function zy(a){const l=wm();return l?l.sanitize(Ni.URL,a)||"":Js(a,"URL")?Da(a):bh(qe(a))}function _g(a){const l=wm();if(l)return dE(l.sanitize(Ni.RESOURCE_URL,a)||"");if(Js(a,"ResourceURL"))return dE(Da(a));throw new Ce(904,!1)}function TE(a,l,u){return function RD(a,l){return"src"===l&&("embed"===a||"frame"===a||"iframe"===a||"media"===a||"script"===a)||"href"===l&&("base"===a||"link"===a)?_g:zy}(l,u)(a)}function wm(){const a=De();return a&&a[xl]}const Ky=new Pn("ENVIRONMENT_INITIALIZER"),qu=new Pn("INJECTOR",-1),Eh=new Pn("INJECTOR_DEF_TYPES");class IE{get(l,u=rr){if(u===rr){const f=new Error(`NullInjectorError: No provider for ${Me(l)}!`);throw f.name="NullInjectorError",f}return u}}function Em(...a){return{\u0275providers:xh(0,a),\u0275fromNgModule:!0}}function xh(a,...l){const u=[],f=new Set;let p;return Ea(l,_=>{const w=_;qy(w,u,[],f)&&(p||(p=[]),p.push(w))}),void 0!==p&&CE(p,u),u}function CE(a,l){for(let u=0;u<a.length;u++){const{providers:p}=a[u];Yy(p,_=>{l.push(_)})}}function qy(a,l,u,f){if(!(a=ce(a)))return!1;let p=null,_=Ri(a);const w=!_&&Pt(a);if(_||w){if(w&&!w.standalone)return!1;p=a}else{const C=a.ngModule;if(_=Ri(C),!_)return!1;p=C}const I=f.has(p);if(w){if(I)return!1;if(f.add(p),w.dependencies){const C="function"==typeof w.dependencies?w.dependencies():w.dependencies;for(const M of C)qy(M,l,u,f)}}else{if(!_)return!1;{if(null!=_.imports&&!I){let M;f.add(p);try{Ea(_.imports,B=>{qy(B,l,u,f)&&(M||(M=[]),M.push(B))})}finally{}void 0!==M&&CE(M,l)}if(!I){const M=ma(p)||(()=>new p);l.push({provide:p,useFactory:M,deps:ie},{provide:Eh,useValue:p,multi:!0},{provide:Ky,useValue:()=>Tn(p),multi:!0})}const C=_.providers;null==C||I||Yy(C,B=>{l.push(B)})}}return p!==a&&void 0!==a.providers}function Yy(a,l){for(let u of a)Ue(u)&&(u=u.\u0275providers),Array.isArray(u)?Yy(u,l):l(u)}const OD=ue({provide:String,useValue:ue});function Zy(a){return null!==a&&"object"==typeof a&&OD in a}function Zl(a){return"function"==typeof a}const Zc=new Pn("Set Injector scope."),vg={},LD={};let Xy;function bg(){return void 0===Xy&&(Xy=new IE),Xy}class Yu{}class DE extends Yu{get destroyed(){return this._destroyed}constructor(l,u,f,p){super(),this.parent=u,this.source=f,this.scopes=p,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Ih(l,w=>this.processProvider(w)),this.records.set(qu,Th(void 0,this)),p.has("environment")&&this.records.set(Yu,Th(void 0,this));const _=this.records.get(Zc);null!=_&&"string"==typeof _.value&&this.scopes.add(_.value),this.injectorDefTypes=new Set(this.get(Eh.multi,ie,Bt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const l of this._ngOnDestroyHooks)l.ngOnDestroy();for(const l of this._onDestroyHooks)l()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(l){this._onDestroyHooks.push(l)}runInContext(l){this.assertNotDestroyed();const u=sn(this),f=Nn(void 0);try{return l()}finally{sn(u),Nn(f)}}get(l,u=rr,f=Bt.Default){this.assertNotDestroyed(),f=sr(f);const p=sn(this),_=Nn(void 0);try{if(!(f&Bt.SkipSelf)){let I=this.records.get(l);if(void 0===I){const C=function tv(a){return"function"==typeof a||"object"==typeof a&&a instanceof Pn}(l)&&Sn(l);I=C&&this.injectableDefInScope(C)?Th(Qy(l),vg):null,this.records.set(l,I)}if(null!=I)return this.hydrate(l,I)}return(f&Bt.Self?bg():this.parent).get(l,u=f&Bt.Optional&&u===rr?null:u)}catch(w){if("NullInjectorError"===w.name){if((w[vi]=w[vi]||[]).unshift(Me(l)),p)throw w;return function Cs(a,l,u,f){const p=a[vi];throw l[Gn]&&p.unshift(l[Gn]),a.message=function ne(a,l,u,f=null){a=a&&"\n"===a.charAt(0)&&a.charAt(1)==ca?a.slice(2):a;let p=Me(l);if(Array.isArray(l))p=l.map(Me).join(" -> ");else if("object"==typeof l){let _=[];for(let w in l)if(l.hasOwnProperty(w)){let I=l[w];_.push(w+":"+("string"==typeof I?JSON.stringify(I):Me(I)))}p=`{${_.join(", ")}}`}return`${u}${f?"("+f+")":""}[${p}]: ${a.replace(Wi,"\n  ")}`}("\n"+a.message,p,u,f),a[fr]=p,a[vi]=null,a}(w,l,"R3InjectorError",this.source)}throw w}finally{Nn(_),sn(p)}}resolveInjectorInitializers(){const l=sn(this),u=Nn(void 0);try{const f=this.get(Ky.multi,ie,Bt.Self);for(const p of f)p()}finally{sn(l),Nn(u)}}toString(){const l=[],u=this.records;for(const f of u.keys())l.push(Me(f));return`R3Injector[${l.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ce(205,!1)}processProvider(l){let u=Zl(l=ce(l))?l:ce(l&&l.provide);const f=function FD(a){return Zy(a)?Th(void 0,a.useValue):Th(Jy(a),vg)}(l);if(Zl(l)||!0!==l.multi)this.records.get(u);else{let p=this.records.get(u);p||(p=Th(void 0,vg,!0),p.factory=()=>rs(p.multi),this.records.set(u,p)),u=l,p.multi.push(l)}this.records.set(u,f)}hydrate(l,u){return u.value===vg&&(u.value=LD,u.value=u.factory()),"object"==typeof u.value&&u.value&&function AE(a){return null!==a&&"object"==typeof a&&"function"==typeof a.ngOnDestroy}(u.value)&&this._ngOnDestroyHooks.add(u.value),u.value}injectableDefInScope(l){if(!l.providedIn)return!1;const u=ce(l.providedIn);return"string"==typeof u?"any"===u||this.scopes.has(u):this.injectorDefTypes.has(u)}}function Qy(a){const l=Sn(a),u=null!==l?l.factory:ma(a);if(null!==u)return u;if(a instanceof Pn)throw new Ce(204,!1);if(a instanceof Function)return function ND(a){const l=a.length;if(l>0)throw Oc(l,"?"),new Ce(204,!1);const u=function ki(a){return a&&(a[pi]||a[ir])||null}(a);return null!==u?()=>u.factory(a):()=>new a}(a);throw new Ce(204,!1)}function Jy(a,l,u){let f;if(Zl(a)){const p=ce(a);return ma(p)||Qy(p)}if(Zy(a))f=()=>ce(a.useValue);else if(function SE(a){return!(!a||!a.useFactory)}(a))f=()=>a.useFactory(...rs(a.deps||[]));else if(function PD(a){return!(!a||!a.useExisting)}(a))f=()=>Tn(ce(a.useExisting));else{const p=ce(a&&(a.useClass||a.provide));if(!function ev(a){return!!a.deps}(a))return ma(p)||Qy(p);f=()=>new p(...rs(a.deps))}return f}function Th(a,l,u=!1){return{factory:a,value:l,multi:u?[]:void 0}}function Ih(a,l){for(const u of a)Array.isArray(u)?Ih(u,l):u&&Ue(u)?Ih(u.\u0275providers,l):l(u)}class BD{}class kE{}class ME{resolveComponentFactory(l){throw function UD(a){const l=Error(`No component factory found for ${Me(a)}. Did you add it to @NgModule.entryComponents?`);return l.ngComponent=a,l}(l)}}let Ch=(()=>{class a{}return a.NULL=new ME,a})();function wg(){return Xl(lr(),De())}function Xl(a,l){return new Sh(pr(a,l))}let Sh=(()=>{class a{constructor(u){this.nativeElement=u}}return a.__NG_ELEMENT_ID__=wg,a})();function xm(a){return a instanceof Sh?a.nativeElement:a}class iv{}let VD=(()=>{class a{}return a.__NG_ELEMENT_ID__=()=>function $D(){const a=De(),u=ar(lr().index,a);return(Tr(u)?u:a)[Jt]}(),a})(),HD=(()=>{class a{}return a.\u0275prov=At({token:a,providedIn:"root",factory:()=>null}),a})();class OE{constructor(l){this.full=l,this.major=l.split(".")[0],this.minor=l.split(".")[1],this.patch=l.split(".").slice(2).join(".")}}const PE=new OE("15.2.9"),Eg={},rv="ngOriginalError";function sv(a){return a[rv]}class Tm{constructor(){this._console=console}handleError(l){const u=this._findOriginalError(l);this._console.error("ERROR",l),u&&this._console.error("ORIGINAL ERROR",u)}_findOriginalError(l){let u=l&&sv(l);for(;u&&sv(u);)u=sv(u);return u||null}}function NE(a){return a.ownerDocument.defaultView}function cl(a){return a instanceof Function?a():a}function $E(a,l,u){let f=a.length;for(;;){const p=a.indexOf(l,u);if(-1===p)return p;if(0===p||a.charCodeAt(p-1)<=32){const _=l.length;if(p+_===f||a.charCodeAt(p+_)<=32)return p}u=p+1}}const ov="ng-template";function av(a,l,u){let f=0,p=!0;for(;f<a.length;){let _=a[f++];if("string"==typeof _&&p){const w=a[f++];if(u&&"class"===_&&-1!==$E(w.toLowerCase(),l,0))return!0}else{if(1===_){for(;f<a.length&&"string"==typeof(_=a[f++]);)if(_.toLowerCase()===l)return!0;return!1}"number"==typeof _&&(p=!1)}}return!1}function lv(a){return 4===a.type&&a.value!==ov}function Dh(a,l,u){return l===(4!==a.type||u?a.value:ov)}function cv(a,l,u){let f=4;const p=a.attrs||[],_=function jE(a){for(let l=0;l<a.length;l++)if(Ru(a[l]))return l;return a.length}(p);let w=!1;for(let I=0;I<l.length;I++){const C=l[I];if("number"!=typeof C){if(!w)if(4&f){if(f=2|1&f,""!==C&&!Dh(a,C,u)||""===C&&1===l.length){if(ka(f))return!1;w=!0}}else{const M=8&f?C:l[++I];if(8&f&&null!==a.attrs){if(!av(a.attrs,M,u)){if(ka(f))return!1;w=!0}continue}const W=HE(8&f?"class":C,p,lv(a),u);if(-1===W){if(ka(f))return!1;w=!0;continue}if(""!==M){let se;se=W>_?"":p[W+1].toLowerCase();const de=8&f?se:null;if(de&&-1!==$E(de,M,0)||2&f&&M!==se){if(ka(f))return!1;w=!0}}}}else{if(!w&&!ka(f)&&!ka(C))return!1;if(w&&ka(C))continue;w=!1,f=C|1&f}}return ka(f)||w}function ka(a){return 0==(1&a)}function HE(a,l,u,f){if(null===l)return-1;let p=0;if(f||!u){let _=!1;for(;p<l.length;){const w=l[p];if(w===a)return p;if(3===w||6===w)_=!0;else{if(1===w||2===w){let I=l[++p];for(;"string"==typeof I;)I=l[++p];continue}if(4===w)break;if(0===w){p+=4;continue}}p+=_?1:2}return-1}return function GE(a,l){let u=a.indexOf(4);if(u>-1)for(u++;u<a.length;){const f=a[u];if("number"==typeof f)return-1;if(f===l)return u;u++}return-1}(l,a)}function Cm(a,l,u=!1){for(let f=0;f<l.length;f++)if(cv(a,l[f],u))return!0;return!1}function qD(a,l){e:for(let u=0;u<l.length;u++){const f=l[u];if(a.length===f.length){for(let p=0;p<a.length;p++)if(a[p]!==f[p])continue e;return!0}}return!1}function zE(a,l){return a?":not("+l.trim()+")":l}function YD(a){let l=a[0],u=1,f=2,p="",_=!1;for(;u<a.length;){let w=a[u];if("string"==typeof w)if(2&f){const I=a[++u];p+="["+w+(I.length>0?'="'+I+'"':"")+"]"}else 8&f?p+="."+w:4&f&&(p+=" "+w);else""!==p&&!ka(w)&&(l+=zE(_,p),p=""),f=w,_=_||!ka(f);u++}return""!==p&&(l+=zE(_,p)),l}const gn={};function WE(a){KE(mn(),De(),Ii()+a,!1)}function KE(a,l,u,f){if(!f)if(3==(3&l[vn])){const _=a.preOrderCheckHooks;null!==_&&Tc(l,_,u)}else{const _=a.preOrderHooks;null!==_&&Du(l,_,0,u)}Uo(u)}function YE(a,l=null,u=null,f){const p=dv(a,l,u,f);return p.resolveInjectorInitializers(),p}function dv(a,l=null,u=null,f,p=new Set){const _=[u||ie,Em(a)];return f=f||("object"==typeof a?void 0:Me(a)),new DE(_,l||bg(),f||null,p)}let Ah=(()=>{class a{static create(u,f){if(Array.isArray(u))return YE({name:""},f,u,"");{const p=u.name??"";return YE({name:p},u.parent,u.providers,p)}}}return a.THROW_IF_NOT_FOUND=rr,a.NULL=new IE,a.\u0275prov=At({token:a,providedIn:"any",factory:()=>Tn(qu)}),a.__NG_ELEMENT_ID__=-1,a})();function Mh(a,l=Bt.Default){const u=De();return null===u?Tn(a,l):Zd(lr(),u,ce(a),l)}function ex(){throw new Error("invalid")}function tx(a,l){const u=a.contentQueries;if(null!==u)for(let f=0;f<u.length;f+=2){const _=u[f+1];if(-1!==_){const w=a.data[_];Ir(u[f]),w.contentQueries(2,l[_],_)}}}function Cg(a,l,u,f,p,_,w,I,C,M,B){const W=l.blueprint.slice();return W[os]=p,W[vn]=76|f,(null!==B||a&&1024&a[vn])&&(W[vn]|=1024),bc(W),W[ii]=W[za]=a,W[fn]=u,W[as]=w||a&&a[as],W[Jt]=I||a&&a[Jt],W[xl]=C||a&&a[xl]||null,W[oi]=M||a&&a[oi]||null,W[Er]=_,W[ha]=function Hu(){return Io++}(),W[Wa]=B,W[or]=2==l.type?a[or]:W,W}function km(a,l,u,f,p){let _=a.data[l];if(null===_)_=function Sg(a,l,u,f,p){const _=Ud(),w=Tu(),C=a.data[l]=function In(a,l,u,f,p,_){return{type:u,index:f,insertBeforeIndex:null,injectorIndex:l?l.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:p,attrs:_,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:l,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,w?_:_&&_.parent,u,l,f,p);return null===a.firstChild&&(a.firstChild=C),null!==_&&(w?null==_.child&&null!==C.parent&&(_.child=C):null===_.next&&(_.next=C,C.prev=_)),C}(a,l,u,f,p),function Vd(){return nn.lFrame.inI18n}()&&(_.flags|=32);else if(64&_.type){_.type=u,_.value=f,_.attrs=p;const w=function Al(){const a=nn.lFrame,l=a.currentTNode;return a.isParent?l:l.parent}();_.injectorIndex=null===w?-1:w.injectorIndex}return cr(_,!0),_}function bn(a,l,u,f){if(0===u)return-1;const p=l.length;for(let _=0;_<u;_++)l.push(f),a.blueprint.push(f),a.data.push(null);return p}function Qi(a,l,u){Pl(l);try{const f=a.viewQuery;null!==f&&bv(1,f,u);const p=a.template;null!==p&&Xu(a,l,p,1,u),a.firstCreatePass&&(a.firstCreatePass=!1),a.staticContentQueries&&tx(a,l),a.staticViewQueries&&bv(2,a.viewQuery,u);const _=a.components;null!==_&&function nx(a,l){for(let u=0;u<l.length;u++)gx(a,l[u])}(l,_)}catch(f){throw a.firstCreatePass&&(a.incompleteFirstPass=!0,a.firstCreatePass=!1),f}finally{l[vn]&=-5,pa()}}function Ra(a,l,u,f){const p=l[vn];if(128!=(128&p)){Pl(l);try{bc(l),function ks(a){return nn.lFrame.bindingIndex=a}(a.bindingStartIndex),null!==u&&Xu(a,l,u,2,f);const w=3==(3&p);if(w){const M=a.preOrderCheckHooks;null!==M&&Tc(l,M,null)}else{const M=a.preOrderHooks;null!==M&&Du(l,M,0,null),Ic(l,0)}if(function mx(a){for(let l=Kl(a);null!==l;l=ql(l)){if(!l[xr])continue;const u=l[cs];for(let f=0;f<u.length;f++){const p=u[f];512&p[vn]||Ya(p[ii],1),p[vn]|=512}}}(l),function fx(a){for(let l=Kl(a);null!==l;l=ql(l))for(let u=mr;u<l.length;u++){const f=l[u],p=f[bt];As(f)&&Ra(p,f,p.template,f[fn])}}(l),null!==a.contentQueries&&tx(a,l),w){const M=a.contentCheckHooks;null!==M&&Tc(l,M)}else{const M=a.contentHooks;null!==M&&Du(l,M,1),Ic(l,1)}!function hA(a,l){const u=a.hostBindingOpCodes;if(null!==u)try{for(let f=0;f<u.length;f++){const p=u[f];if(p<0)Uo(~p);else{const _=p,w=u[++f],I=u[++f];Ol(w,_),I(2,l[_])}}}finally{Uo(-1)}}(a,l);const I=a.components;null!==I&&function fA(a,l){for(let u=0;u<l.length;u++)px(a,l[u])}(l,I);const C=a.viewQuery;if(null!==C&&bv(2,C,f),w){const M=a.viewCheckHooks;null!==M&&Tc(l,M)}else{const M=a.viewHooks;null!==M&&Du(l,M,2),Ic(l,2)}!0===a.firstUpdatePass&&(a.firstUpdatePass=!1),l[vn]&=-41,512&l[vn]&&(l[vn]&=-513,Ya(l[ii],-1))}finally{pa()}}}function Xu(a,l,u,f,p){const _=Ii(),w=2&f;try{Uo(-1),w&&l.length>ei&&KE(a,l,ei,!1),Oi(w?2:0,p),u(f,p)}finally{Uo(_),Oi(w?3:1,p)}}function Qu(a,l,u){if(fa(l)){const p=l.directiveEnd;for(let _=l.directiveStart;_<p;_++){const w=a.data[_];w.contentQueries&&w.contentQueries(1,u[_],_)}}}function Oh(a,l,u){xu()&&(function PP(a,l,u,f){const p=u.directiveStart,_=u.directiveEnd;us(u)&&function ux(a,l,u){const f=pr(l,a),p=ix(u),_=a[as],w=wi(a,Cg(a,p,null,u.onPush?32:16,f,l,_,_.createRenderer(f,u),null,null,null));a[l.index]=w}(l,u,a.data[p+u.componentOffset]),a.firstCreatePass||qd(u,l),le(f,l);const w=u.initialInputs;for(let I=p;I<_;I++){const C=a.data[I],M=vo(l,a,I,u);le(M,l),null!==w&&dx(0,I-p,M,C,0,w),ds(C)&&(ar(u.index,l)[fn]=vo(l,a,I,u))}}(a,l,u,pr(u,l)),64==(64&u.flags)&&ax(a,l,u))}function gv(a,l,u=pr){const f=l.localNames;if(null!==f){let p=l.index+1;for(let _=0;_<f.length;_+=2){const w=f[_+1],I=-1===w?u(l,a):a[w];a[p++]=I}}}function ix(a){const l=a.tView;return null===l||l.incompleteFirstPass?a.tView=Dg(1,null,a.template,a.decls,a.vars,a.directiveDefs,a.pipeDefs,a.viewQuery,a.schemas,a.consts):l}function Dg(a,l,u,f,p,_,w,I,C,M){const B=ei+f,W=B+p,se=function rx(a,l){const u=[];for(let f=0;f<l;f++)u.push(f<a?null:gn);return u}(B,W),de="function"==typeof M?M():M;return se[bt]={type:a,blueprint:se,template:u,queries:null,viewQuery:I,declTNode:l,data:se.slice().fill(null,B),bindingStartIndex:B,expandoStartIndex:W,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof _?_():_,pipeRegistry:"function"==typeof w?w():w,firstChild:null,schemas:C,consts:de,incompleteFirstPass:!1}}function Ag(a,l,u,f){const p=yx(l);null===u?p.push(f):(p.push(u),a.firstCreatePass&&wv(a).push(f,p.length-1))}function Ko(a,l,u,f){for(let p in a)if(a.hasOwnProperty(p)){u=null===u?{}:u;const _=a[p];null===f?qo(u,l,p,_):f.hasOwnProperty(p)&&qo(u,l,f[p],_)}return u}function qo(a,l,u,f){a.hasOwnProperty(u)?a[u].push(l,f):a[u]=[l,f]}function Yo(a,l,u,f,p,_,w,I){const C=pr(l,u);let B,M=l.inputs;!I&&null!=M&&(B=M[f])?(Ev(a,u,B,f,p),us(l)&&function mA(a,l){const u=ar(l,a);16&u[vn]||(u[vn]|=32)}(u,l.index)):3&l.type&&(f=function Rm(a){return"class"===a?"className":"for"===a?"htmlFor":"formaction"===a?"formAction":"innerHtml"===a?"innerHTML":"readonly"===a?"readOnly":"tabindex"===a?"tabIndex":a}(f),p=null!=w?w(p,l.value||"",f):p,_.setProperty(C,f,p))}function yv(a,l,u,f){if(xu()){const p=null===f?null:{"":-1},_=function _A(a,l){const u=a.directiveRegistry;let f=null,p=null;if(u)for(let _=0;_<u.length;_++){const w=u[_];if(Cm(l,w.selectors,!1))if(f||(f=[]),ds(w))if(null!==w.findHostDirectiveDefs){const I=[];p=p||new Map,w.findHostDirectiveDefs(w,I,p),f.unshift(...I,w),lx(a,l,I.length)}else f.unshift(w),lx(a,l,0);else p=p||new Map,w.findHostDirectiveDefs?.(w,f,p),f.push(w)}return null===f?null:[f,p]}(a,u);let w,I;null===_?w=I=null:[w,I]=_,null!==w&&ox(a,l,u,w,p,I),p&&function NP(a,l,u){if(l){const f=a.localNames=[];for(let p=0;p<l.length;p+=2){const _=u[l[p+1]];if(null==_)throw new Ce(-301,!1);f.push(l[p],_)}}}(u,f,p)}u.mergedAttrs=ya(u.mergedAttrs,u.attrs)}function ox(a,l,u,f,p,_){for(let M=0;M<f.length;M++)jo(qd(u,l),a,f[M].type);!function Ie(a,l,u){a.flags|=1,a.directiveStart=l,a.directiveEnd=l+u,a.providerIndexes=l}(u,a.data.length,f.length);for(let M=0;M<f.length;M++){const B=f[M];B.providersResolver&&B.providersResolver(B)}let w=!1,I=!1,C=bn(a,l,f.length,null);for(let M=0;M<f.length;M++){const B=f[M];u.mergedAttrs=ya(u.mergedAttrs,B.hostAttrs),cx(a,u,l,C,B),FP(C,B,p),null!==B.contentQueries&&(u.flags|=4),(null!==B.hostBindings||null!==B.hostAttrs||0!==B.hostVars)&&(u.flags|=64);const W=B.type.prototype;!w&&(W.ngOnChanges||W.ngOnInit||W.ngDoCheck)&&((a.preOrderHooks??(a.preOrderHooks=[])).push(u.index),w=!0),!I&&(W.ngOnChanges||W.ngDoCheck)&&((a.preOrderCheckHooks??(a.preOrderCheckHooks=[])).push(u.index),I=!0),C++}!function Xc(a,l,u){const p=l.directiveEnd,_=a.data,w=l.attrs,I=[];let C=null,M=null;for(let B=l.directiveStart;B<p;B++){const W=_[B],se=u?u.get(W):null,Pe=se?se.outputs:null;C=Ko(W.inputs,B,C,se?se.inputs:null),M=Ko(W.outputs,B,M,Pe);const st=null===C||null===w||lv(l)?null:hx(C,B,w);I.push(st)}null!==C&&(C.hasOwnProperty("class")&&(l.flags|=8),C.hasOwnProperty("style")&&(l.flags|=16)),l.initialInputs=I,l.inputs=C,l.outputs=M}(a,u,_)}function ax(a,l,u){const f=u.directiveStart,p=u.directiveEnd,_=u.index,w=function Ry(){return nn.lFrame.currentDirectiveIndex}();try{Uo(_);for(let I=f;I<p;I++){const C=a.data[I],M=l[I];Rs(I),(null!==C.hostBindings||0!==C.hostVars||null!==C.hostAttrs)&&LP(C,M)}}finally{Uo(-1),Rs(w)}}function LP(a,l){null!==a.hostBindings&&a.hostBindings(1,l)}function lx(a,l,u){l.componentOffset=u,(a.components??(a.components=[])).push(l.index)}function FP(a,l,u){if(u){if(l.exportAs)for(let f=0;f<l.exportAs.length;f++)u[l.exportAs[f]]=a;ds(l)&&(u[""]=a)}}function cx(a,l,u,f,p){a.data[f]=p;const _=p.factory||(p.factory=ma(p.type)),w=new Vo(_,ds(p),Mh);a.blueprint[f]=w,u[f]=w,function pA(a,l,u,f,p){const _=p.hostBindings;if(_){let w=a.hostBindingOpCodes;null===w&&(w=a.hostBindingOpCodes=[]);const I=~l.index;(function gA(a){let l=a.length;for(;l>0;){const u=a[--l];if("number"==typeof u&&u<0)return u}return 0})(w)!=I&&w.push(I),w.push(u,f,_)}}(a,l,f,bn(a,u,p.hostVars,gn),p)}function Ma(a,l,u,f,p,_){const w=pr(a,l);!function kg(a,l,u,f,p,_,w){if(null==_)a.removeAttribute(l,p,u);else{const I=null==w?qe(_):w(_,f||"",p);a.setAttribute(l,p,I,u)}}(l[Jt],w,_,a.value,u,f,p)}function dx(a,l,u,f,p,_){const w=_[l];if(null!==w){const I=f.setInput;for(let C=0;C<w.length;){const M=w[C++],B=w[C++],W=w[C++];null!==I?f.setInput(u,W,M,B):u[B]=W}}}function hx(a,l,u){let f=null,p=0;for(;p<u.length;){const _=u[p];if(0!==_)if(5!==_){if("number"==typeof _)break;if(a.hasOwnProperty(_)){null===f&&(f=[]);const w=a[_];for(let I=0;I<w.length;I+=2)if(w[I]===l){f.push(_,w[I+1],u[p+1]);break}}p+=2}else p+=2;else p+=4}return f}function vv(a,l,u,f){return[a,!0,!1,l,null,0,f,u,null,null]}function px(a,l){const u=ar(l,a);if(As(u)){const f=u[bt];48&u[vn]?Ra(f,u,f.template,u[fn]):u[fo]>0&&Mm(u)}}function Mm(a){for(let f=Kl(a);null!==f;f=ql(f))for(let p=mr;p<f.length;p++){const _=f[p];if(As(_))if(512&_[vn]){const w=_[bt];Ra(w,_,w.template,_[fn])}else _[fo]>0&&Mm(_)}const u=a[bt].components;if(null!==u)for(let f=0;f<u.length;f++){const p=ar(u[f],a);As(p)&&p[fo]>0&&Mm(p)}}function gx(a,l){const u=ar(l,a),f=u[bt];(function yA(a,l){for(let u=l.length;u<a.blueprint.length;u++)l.push(a.blueprint[u])})(f,u),Qi(f,u,u[fn])}function wi(a,l){return a[da]?a[Lo][Nr]=l:a[da]=l,a[Lo]=l,l}function Rg(a){for(;a;){a[vn]|=32;const l=Ls(a);if(mo(a)&&!l)return a;a=l}return null}function Ju(a,l,u,f=!0){const p=l[as];p.begin&&p.begin();try{Ra(a,l,a.template,u)}catch(w){throw f&&bx(l,w),w}finally{p.end&&p.end()}}function bv(a,l,u){Ir(0),l(a,u)}function yx(a){return a[ua]||(a[ua]=[])}function wv(a){return a.cleanup||(a.cleanup=[])}function vx(a,l,u){return(null===a||ds(a))&&(u=function Sl(a){for(;Array.isArray(a);){if("object"==typeof a[Ds])return a;a=a[os]}return null}(u[l.index])),u[Jt]}function bx(a,l){const u=a[oi],f=u?u.get(Tm,null):null;f&&f.handleError(l)}function Ev(a,l,u,f,p){for(let _=0;_<u.length;){const w=u[_++],I=u[_++],C=l[w],M=a.data[w];null!==M.setInput?M.setInput(C,p,f,I):C[I]=p}}function Ql(a,l,u){const f=qa(l,a);!function dm(a,l,u){a.setValue(l,u)}(a[Jt],f,u)}function yr(a,l,u){let f=u?a.styles:null,p=u?a.classes:null,_=0;if(null!==l)for(let w=0;w<l.length;w++){const I=l[w];"number"==typeof I?_=I:1==_?p=Se(p,I):2==_&&(f=Se(f,I+": "+l[++w]+";"))}u?a.styles=f:a.stylesWithoutHost=f,u?a.classes=p:a.classesWithoutHost=p}function ed(a,l,u,f,p=!1){for(;null!==u;){const _=l[u.index];if(null!==_&&f.push(Dn(_)),Ks(_))for(let I=mr;I<_.length;I++){const C=_[I],M=C[bt].firstChild;null!==M&&ed(C[bt],C,M,f)}const w=u.type;if(8&w)ed(a,l,u.child,f);else if(32&w){const I=Li(u,l);let C;for(;C=I();)f.push(C)}else if(16&w){const I=qc(l,u);if(Array.isArray(I))f.push(...I);else{const C=Ls(l[or]);ed(C[bt],C,I,f,!0)}}u=p?u.projectionNext:u.next}return f}class td{get rootNodes(){const l=this._lView,u=l[bt];return ed(u,l,u.firstChild,[])}constructor(l,u){this._lView=l,this._cdRefInjectingView=u,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[fn]}set context(l){this._lView[fn]=l}get destroyed(){return 128==(128&this._lView[vn])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const l=this._lView[ii];if(Ks(l)){const u=l[Il],f=u?u.indexOf(this):-1;f>-1&&(P(l,f),Hl(u,f))}this._attachedToViewContainer=!1}F(this._lView[bt],this._lView)}onDestroy(l){Ag(this._lView[bt],this._lView,null,l)}markForCheck(){Rg(this._cdRefInjectingView||this._lView)}detach(){this._lView[vn]&=-65}reattach(){this._lView[vn]|=64}detectChanges(){Ju(this._lView[bt],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ce(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function fh(a,l){mm(a,l,l[Jt],2,null,null)}(this._lView[bt],this._lView)}attachToAppRef(l){if(this._attachedToViewContainer)throw new Ce(902,!1);this._appRef=l}}class xv extends td{constructor(l){super(l),this._view=l}detectChanges(){const l=this._view;Ju(l[bt],l,l[fn],!1)}checkNoChanges(){}get context(){return null}}class Om extends Ch{constructor(l){super(),this.ngModule=l}resolveComponentFactory(l){const u=Pt(l);return new Ph(u,this.ngModule)}}function Pm(a){const l=[];for(let u in a)a.hasOwnProperty(u)&&l.push({propName:a[u],templateName:u});return l}class bA{constructor(l,u){this.injector=l,this.parentInjector=u}get(l,u,f){f=sr(f);const p=this.injector.get(l,Eg,f);return p!==Eg||u===Eg?p:this.parentInjector.get(l,u,f)}}class Ph extends kE{get inputs(){return Pm(this.componentDef.inputs)}get outputs(){return Pm(this.componentDef.outputs)}constructor(l,u){super(),this.componentDef=l,this.ngModule=u,this.componentType=l.type,this.selector=function ZD(a){return a.map(YD).join(",")}(l.selectors),this.ngContentSelectors=l.ngContentSelectors?l.ngContentSelectors:[],this.isBoundToModule=!!u}create(l,u,f,p){let _=(p=p||this.ngModule)instanceof Yu?p:p?.injector;_&&null!==this.componentDef.getStandaloneInjector&&(_=this.componentDef.getStandaloneInjector(_)||_);const w=_?new bA(l,_):l,I=w.get(iv,null);if(null===I)throw new Ce(407,!1);const C=w.get(HD,null),M=I.createRenderer(null,this.componentDef),B=this.componentDef.selectors[0][0]||"div",W=f?function sx(a,l,u){return a.selectRootElement(l,u===j.ShadowDom)}(M,f,this.componentDef.encapsulation):hm(M,B,function vA(a){const l=a.toLowerCase();return"svg"===l?yc:"math"===l?"math":null}(B)),se=this.componentDef.onPush?288:272,de=Dg(0,null,null,1,0,null,null,null,null,null),Pe=Cg(null,de,null,se,null,null,I,M,C,w,null);let st,mt;Pl(Pe);try{const ht=this.componentDef;let rn,ze=null;ht.findHostDirectiveDefs?(rn=[],ze=new Map,ht.findHostDirectiveDefs(ht,rn,ze),rn.push(ht)):rn=[ht];const dn=function Lm(a,l){const u=a[bt],f=ei;return a[f]=l,km(u,f,2,"#host",null)}(Pe,W),xi=function wx(a,l,u,f,p,_,w,I){const C=p[bt];!function Mg(a,l,u,f){for(const p of a)l.mergedAttrs=ya(l.mergedAttrs,p.hostAttrs);null!==l.mergedAttrs&&(yr(l,l.mergedAttrs,!0),null!==u&&gm(f,u,l))}(f,a,l,w);const M=_.createRenderer(l,u),B=Cg(p,ix(u),null,u.onPush?32:16,p[a.index],a,_,M,I||null,null,null);return C.firstCreatePass&&lx(C,a,f.length-1),wi(p,B),p[a.index]=B}(dn,W,ht,rn,Pe,I,M);mt=wu(de,ei),W&&function EA(a,l,u,f){if(f)Za(a,u,["ng-version",PE.full]);else{const{attrs:p,classes:_}=function XD(a){const l=[],u=[];let f=1,p=2;for(;f<a.length;){let _=a[f];if("string"==typeof _)2===p?""!==_&&l.push(_,a[++f]):8===p&&u.push(_);else{if(!ka(p))break;p=_}f++}return{attrs:l,classes:u}}(l.selectors[0]);p&&Za(a,u,p),_&&_.length>0&&Yc(a,u,_.join(" "))}}(M,ht,W,f),void 0!==u&&function xA(a,l,u){const f=a.projection=[];for(let p=0;p<l.length;p++){const _=u[p];f.push(null!=_?Array.from(_):null)}}(mt,this.ngContentSelectors,u),st=function Ex(a,l,u,f,p,_){const w=lr(),I=p[bt],C=pr(w,p);ox(I,p,w,u,null,f);for(let B=0;B<u.length;B++)le(vo(p,I,w.directiveStart+B,w),p);ax(I,p,w),C&&le(C,p);const M=vo(p,I,w.directiveStart+w.componentOffset,w);if(a[fn]=p[fn]=M,null!==_)for(const B of _)B(M,l);return Qu(I,w,a),M}(xi,ht,rn,ze,Pe,[TA]),Qi(de,Pe,null)}finally{pa()}return new wA(this.componentType,st,Xl(mt,Pe),Pe,mt)}}class wA extends BD{constructor(l,u,f,p,_){super(),this.location=f,this._rootLView=p,this._tNode=_,this.instance=u,this.hostView=this.changeDetectorRef=new xv(p),this.componentType=l}setInput(l,u){const f=this._tNode.inputs;let p;if(null!==f&&(p=f[l])){const _=this._rootLView;Ev(_[bt],_,p,l,u),Rg(ar(this._tNode.index,_))}}get injector(){return new ba(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(l){this.hostView.onDestroy(l)}}function TA(){const a=lr();Nl(De()[bt],a)}function Og(a){let l=function xx(a){return Object.getPrototypeOf(a.prototype).constructor}(a.type),u=!0;const f=[a];for(;l;){let p;if(ds(a))p=l.\u0275cmp||l.\u0275dir;else{if(l.\u0275cmp)throw new Ce(903,!1);p=l.\u0275dir}if(p){if(u){f.push(p);const w=a;w.inputs=Pg(a.inputs),w.declaredInputs=Pg(a.declaredInputs),w.outputs=Pg(a.outputs);const I=p.hostBindings;I&&Tv(a,I);const C=p.viewQuery,M=p.contentQueries;if(C&&Nm(a,C),M&&IA(a,M),Oe(a.inputs,p.inputs),Oe(a.declaredInputs,p.declaredInputs),Oe(a.outputs,p.outputs),ds(p)&&p.data.animation){const B=a.data;B.animation=(B.animation||[]).concat(p.data.animation)}}const _=p.features;if(_)for(let w=0;w<_.length;w++){const I=_[w];I&&I.ngInherit&&I(a),I===Og&&(u=!1)}}l=Object.getPrototypeOf(l)}!function Tx(a){let l=0,u=null;for(let f=a.length-1;f>=0;f--){const p=a[f];p.hostVars=l+=p.hostVars,p.hostAttrs=ya(p.hostAttrs,u=ya(u,p.hostAttrs))}}(f)}function Pg(a){return a===U?{}:a===ie?[]:a}function Nm(a,l){const u=a.viewQuery;a.viewQuery=u?(f,p)=>{l(f,p),u(f,p)}:l}function IA(a,l){const u=a.contentQueries;a.contentQueries=u?(f,p,_)=>{l(f,p,_),u(f,p,_)}:l}function Tv(a,l){const u=a.hostBindings;a.hostBindings=u?(f,p)=>{l(f,p),u(f,p)}:l}function Fm(a){return!!Qc(a)&&(Array.isArray(a)||!(a instanceof Map)&&Symbol.iterator in a)}function Qc(a){return null!==a&&("function"==typeof a||"object"==typeof a)}function ul(a,l,u){return a[l]=u}function _s(a,l,u){return!Object.is(a[l],u)&&(a[l]=u,!0)}function nd(a,l,u,f){const p=_s(a,l,u);return _s(a,l+1,f)||p}function Sv(a,l,u,f){const p=De();return _s(p,Ml(),l)&&(mn(),Ma(ai(),p,a,l,u,f)),Sv}function Nh(a,l,u,f){return _s(a,Ml(),u)?l+qe(u)+f:gn}function Jl(a,l,u,f,p,_){const I=nd(a,function gr(){return nn.lFrame.bindingIndex}(),u,p);return po(2),I?l+qe(u)+f+qe(p)+_:gn}function Mv(a,l,u,f,p,_,w,I){const C=De(),M=mn(),B=a+ei,W=M.firstCreatePass?function PA(a,l,u,f,p,_,w,I,C){const M=l.consts,B=km(l,a,4,w||null,Bo(M,I));yv(l,u,B,Bo(M,C)),Nl(l,B);const W=B.tView=Dg(2,B,f,p,_,l.directiveRegistry,l.pipeRegistry,null,l.schemas,M);return null!==l.queries&&(l.queries.template(l,B),W.queries=l.queries.embeddedTView(B)),B}(B,M,C,l,u,f,p,_,w):M.data[B];cr(W,!1);const se=C[Jt].createComment("");Kc(M,C,se,W),le(se,C),wi(C,C[B]=vv(se,C,se,W)),qs(W)&&Oh(M,C,W),null!=w&&gv(C,W,I)}function Ov(a){return Gr(function kl(){return nn.lFrame.contextLView}(),ei+a)}function Um(a,l,u){const f=De();return _s(f,Ml(),l)&&Yo(mn(),ai(),f,a,l,f[Jt],u,!1),Um}function ec(a,l,u,f,p){const w=p?"class":"style";Ev(a,u,l.inputs[w],w,f)}function Vh(a,l,u,f){const p=De(),_=mn(),w=ei+a,I=p[Jt],C=_.firstCreatePass?function $P(a,l,u,f,p,_){const w=l.consts,C=km(l,a,2,f,Bo(w,p));return yv(l,u,C,Bo(w,_)),null!==C.attrs&&yr(C,C.attrs,!1),null!==C.mergedAttrs&&yr(C,C.mergedAttrs,!0),null!==l.queries&&l.queries.elementStart(l,C),C}(w,_,p,l,u,f):_.data[w],M=p[w]=hm(I,l,function Su(){return nn.lFrame.currentNamespace}()),B=qs(C);return cr(C,!0),gm(I,M,C),32!=(32&C.flags)&&Kc(_,p,M,C),0===function wc(){return nn.lFrame.elementDepthCount}()&&le(M,p),function Ld(){nn.lFrame.elementDepthCount++}(),B&&(Oh(_,p,C),Qu(_,C,p)),null!==f&&gv(p,C),Vh}function Pv(){let a=lr();Tu()?Iu():(a=a.parent,cr(a,!1));const l=a;!function Nd(){nn.lFrame.elementDepthCount--}();const u=mn();return u.firstCreatePass&&(Nl(u,a),fa(a)&&u.queries.elementEnd(a)),null!=l.classesWithoutHost&&function Zf(a){return 0!=(8&a.flags)}(l)&&ec(u,l,De(),l.classesWithoutHost,!0),null!=l.stylesWithoutHost&&function Xf(a){return 0!=(16&a.flags)}(l)&&ec(u,l,De(),l.stylesWithoutHost,!1),Pv}function Lv(a,l,u,f){return Vh(a,l,u,f),Pv(),Lv}function FA(){return De()}function Bv(a){return!!a&&"function"==typeof a.then}function BA(a){return!!a&&"function"==typeof a.subscribe}const UA=BA;function Rx(a,l,u,f){const p=De(),_=mn(),w=lr();return Ox(_,p,p[Jt],w,a,l,f),Rx}function Mx(a,l){const u=lr(),f=De(),p=mn();return Ox(p,f,vx(hs(p.data),u,f),u,a,l),Mx}function Ox(a,l,u,f,p,_,w){const I=qs(f),M=a.firstCreatePass&&wv(a),B=l[fn],W=yx(l);let se=!0;if(3&f.type||w){const st=pr(f,l),mt=w?w(st):st,ht=W.length,rn=w?dn=>w(Dn(dn[f.index])):f.index;let ze=null;if(!w&&I&&(ze=function jP(a,l,u,f){const p=a.cleanup;if(null!=p)for(let _=0;_<p.length-1;_+=2){const w=p[_];if(w===u&&p[_+1]===f){const I=l[ua],C=p[_+2];return I.length>C?I[C]:null}"string"==typeof w&&(_+=2)}return null}(a,l,p,f.index)),null!==ze)(ze.__ngLastListenerFn__||ze).__ngNextListenerFn__=_,ze.__ngLastListenerFn__=_,se=!1;else{_=Uv(f,l,B,_,!1);const dn=u.listen(mt,p,_);W.push(_,dn),M&&M.push(p,rn,ht,ht+1)}}else _=Uv(f,l,B,_,!1);const de=f.outputs;let Pe;if(se&&null!==de&&(Pe=de[p])){const st=Pe.length;if(st)for(let mt=0;mt<st;mt+=2){const xi=l[Pe[mt]][Pe[mt+1]].subscribe(_),Vi=W.length;W.push(_,xi),M&&M.push(p,f.index,Vi,-(Vi+1))}}}function Px(a,l,u,f){try{return Oi(6,l,u),!1!==u(f)}catch(p){return bx(a,p),!1}finally{Oi(7,l,u)}}function Uv(a,l,u,f,p){return function _(w){if(w===Function)return f;Rg(a.componentOffset>-1?ar(a.index,l):l);let C=Px(l,u,f,w),M=_.__ngNextListenerFn__;for(;M;)C=Px(l,u,M,w)&&C,M=M.__ngNextListenerFn__;return p&&!1===C&&(w.preventDefault(),w.returnValue=!1),C}}function Vv(a=1){return function xc(a){return(nn.lFrame.contextLView=function Gd(a,l){for(;a>0;)l=l[za],a--;return l}(a,nn.lFrame.contextLView))[fn]}(a)}function Lx(a,l){let u=null;const f=function xg(a){const l=a.attrs;if(null!=l){const u=l.indexOf(5);if(!(1&u))return l[u+1]}return null}(a);for(let p=0;p<l.length;p++){const _=l[p];if("*"!==_){if(null===f?Cm(a,_,!0):qD(f,_))return p}else u=p}return u}function $v(a){const l=De()[or][Er];if(!l.projection){const f=l.projection=Oc(a?a.length:1,null),p=f.slice();let _=l.child;for(;null!==_;){const w=a?Lx(_,a):0;null!==w&&(p[w]?p[w].projectionNext=_:f[w]=_,p[w]=_),_=_.next}}}function Hv(a,l=0,u){const f=De(),p=mn(),_=km(p,ei+a,16,null,u||null);null===_.projection&&(_.projection=l),Iu(),32!=(32&_.flags)&&function lE(a,l,u){Ly(l[Jt],0,l,u,Fe(a,u,l),mh(u.parent||l[Er],u,l))}(p,f,_)}function Bg(a,l,u){return Ug(a,"",l,"",u),Bg}function Ug(a,l,u,f,p){const _=De(),w=Nh(_,l,u,f);return w!==gn&&Yo(mn(),ai(),_,a,w,_[Jt],p,!1),Ug}function Yr(a,l){return a<<17|l<<2}function Jc(a){return a>>17&32767}function Wv(a){return 2|a}function Wt(a){return(131068&a)>>2}function N(a,l){return-131069&a|l<<2}function Re(a){return 1|a}function Bx(a,l,u,f,p){const _=a[u+1],w=null===l;let I=f?Jc(_):Wt(_),C=!1;for(;0!==I&&(!1===C||w);){const B=a[I+1];jA(a[I],l)&&(C=!0,a[I+1]=f?Re(B):Wv(B)),I=f?Jc(B):Wt(B)}C&&(a[u+1]=f?Wv(_):Re(_))}function jA(a,l){return null===a||null==l||(Array.isArray(a)?a[1]:a)===l||!(!Array.isArray(a)||"string"!=typeof l)&&Fr(a,l)>=0}function Yv(a,l,u){return Xo(a,l,u,!1),Yv}function Zv(a,l){return Xo(a,l,null,!0),Zv}function Xo(a,l,u,f){const p=De(),_=mn(),w=po(2);_.firstUpdatePass&&function Xv(a,l,u,f){const p=a.data;if(null===p[u+1]){const _=p[Ii()],w=function Kx(a,l){return l>=a.expandoStartIndex}(a,u);(function Qx(a,l){return 0!=(a.flags&(l?8:16))})(_,f)&&null===l&&!w&&(l=!1),l=function Qv(a,l,u,f){const p=hs(a);let _=f?l.residualClasses:l.residualStyles;if(null===p)0===(f?l.classBindings:l.styleBindings)&&(u=ad(u=tc(null,a,l,u,f),l.attrs,f),_=null);else{const w=l.directiveStylingLast;if(-1===w||a[w]!==p)if(u=tc(p,a,l,u,f),null===_){let C=function qx(a,l,u){const f=u?l.classBindings:l.styleBindings;if(0!==Wt(f))return a[Jc(f)]}(a,l,f);void 0!==C&&Array.isArray(C)&&(C=tc(null,a,l,C[1],f),C=ad(C,l.attrs,f),function WA(a,l,u,f){a[Jc(u?l.classBindings:l.styleBindings)]=f}(a,l,f,C))}else _=function KA(a,l,u){let f;const p=l.directiveEnd;for(let _=1+l.directiveStylingLast;_<p;_++)f=ad(f,a[_].hostAttrs,u);return ad(f,l.attrs,u)}(a,l,f)}return void 0!==_&&(f?l.residualClasses=_:l.residualStyles=_),u}(p,_,l,f),function $m(a,l,u,f,p,_){let w=_?l.classBindings:l.styleBindings,I=Jc(w),C=Wt(w);a[f]=u;let B,M=!1;if(Array.isArray(u)?(B=u[1],(null===B||Fr(u,B)>0)&&(M=!0)):B=u,p)if(0!==C){const se=Jc(a[I+1]);a[f+1]=Yr(se,I),0!==se&&(a[se+1]=N(a[se+1],f)),a[I+1]=function $A(a,l){return 131071&a|l<<17}(a[I+1],f)}else a[f+1]=Yr(I,0),0!==I&&(a[I+1]=N(a[I+1],f)),I=f;else a[f+1]=Yr(C,0),0===I?I=f:a[C+1]=N(a[C+1],f),C=f;M&&(a[f+1]=Wv(a[f+1])),Bx(a,B,f,!0),Bx(a,B,f,!1),function HA(a,l,u,f,p){const _=p?a.residualClasses:a.residualStyles;null!=_&&"string"==typeof l&&Fr(_,l)>=0&&(u[f+1]=Re(u[f+1]))}(l,B,a,f,_),w=Yr(I,C),_?l.classBindings=w:l.styleBindings=w}(p,_,l,u,w,f)}}(_,a,w,f),l!==gn&&_s(p,w,l)&&function Zx(a,l,u,f,p,_,w,I){if(!(3&l.type))return;const C=a.data,M=C[I+1],B=function an(a){return 1==(1&a)}(M)?Jv(C,l,u,p,Wt(M),w):void 0;Hg(B)||(Hg(_)||function Sr(a){return 2==(2&a)}(M)&&(_=Jv(C,null,u,p,I,w)),function ll(a,l,u,f,p){if(l)p?a.addClass(u,f):a.removeClass(u,f);else{let _=-1===f.indexOf("-")?void 0:Xt.DashCase;null==p?a.removeStyle(u,f,_):("string"==typeof p&&p.endsWith("!important")&&(p=p.slice(0,-10),_|=Xt.Important),a.setStyle(u,f,p,_))}}(f,w,qa(Ii(),u),p,_))}(_,_.data[Ii()],p,p[Jt],a,p[w+1]=function Xx(a,l){return null==a||""===a||("string"==typeof l?a+=l:"object"==typeof a&&(a=Me(Da(a)))),a}(l,u),f,w)}function tc(a,l,u,f,p){let _=null;const w=u.directiveEnd;let I=u.directiveStylingLast;for(-1===I?I=u.directiveStart:I++;I<w&&(_=l[I],f=ad(f,_.hostAttrs,p),_!==a);)I++;return null!==a&&(u.directiveStylingLast=I),f}function ad(a,l,u){const f=u?1:2;let p=-1;if(null!==l)for(let _=0;_<l.length;_++){const w=l[_];"number"==typeof w?p=w:p===f&&(Array.isArray(a)||(a=void 0===a?[]:["",a]),ms(a,w,!!u||l[++_]))}return void 0===a?null:a}function Jv(a,l,u,f,p,_){const w=null===l;let I;for(;p>0;){const C=a[p],M=Array.isArray(C),B=M?C[1]:C,W=null===B;let se=u[p+1];se===gn&&(se=W?ie:void 0);let de=W?zn(se,f):B===f?se:void 0;if(M&&!Hg(de)&&(de=zn(C,f)),Hg(de)&&(I=de,w))return I;const Pe=a[p+1];p=w?Jc(Pe):Wt(Pe)}if(null!==l){let C=_?l.residualClasses:l.residualStyles;null!=C&&(I=zn(C,f))}return I}function Hg(a){return void 0!==a}function Jx(a,l=""){const u=De(),f=mn(),p=a+ei,_=f.firstCreatePass?km(f,p,1,l,null):f.data[p],w=u[p]=function Wc(a,l){return a.createText(l)}(u[Jt],l);Kc(f,u,w,_),cr(_,!1)}function e0(a){return jg("",a,""),e0}function jg(a,l,u){const f=De(),p=Nh(f,a,l,u);return p!==gn&&Ql(f,Ii(),p),jg}function t0(a,l,u,f,p){const _=De(),w=Jl(_,a,l,u,f,p);return w!==gn&&Ql(_,Ii(),w),t0}function a0(a,l,u){const f=De();return _s(f,Ml(),l)&&Yo(mn(),ai(),f,a,l,f[Jt],u,!0),a0}function zg(a,l,u){const f=De();if(_s(f,Ml(),l)){const _=mn(),w=ai();Yo(_,w,f,a,l,vx(hs(_.data),w,f),u,!0)}return zg}const eu=void 0;var l0=["en",[["a","p"],["AM","PM"],eu],[["AM","PM"],eu,eu],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],eu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],eu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",eu,"{1} 'at' {0}",eu],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function eo(a){const u=Math.floor(Math.abs(a)),f=a.toString().replace(/^[^.]*\.?/,"").length;return 1===u&&0===f?1:5}];let cd={};function jh(a){const l=function mT(a){return a.toLowerCase().replace(/_/g,"-")}(a);let u=hT(l);if(u)return u;const f=l.split("-")[0];if(u=hT(f),u)return u;if("en"===f)return l0;throw new Ce(701,!1)}function c0(a){return jh(a)[en.PluralCase]}function hT(a){return a in cd||(cd[a]=ni.ng&&ni.ng.common&&ni.ng.common.locales&&ni.ng.common.locales[a]),cd[a]}var en=(()=>((en=en||{})[en.LocaleId=0]="LocaleId",en[en.DayPeriodsFormat=1]="DayPeriodsFormat",en[en.DayPeriodsStandalone=2]="DayPeriodsStandalone",en[en.DaysFormat=3]="DaysFormat",en[en.DaysStandalone=4]="DaysStandalone",en[en.MonthsFormat=5]="MonthsFormat",en[en.MonthsStandalone=6]="MonthsStandalone",en[en.Eras=7]="Eras",en[en.FirstDayOfWeek=8]="FirstDayOfWeek",en[en.WeekendRange=9]="WeekendRange",en[en.DateFormat=10]="DateFormat",en[en.TimeFormat=11]="TimeFormat",en[en.DateTimeFormat=12]="DateTimeFormat",en[en.NumberSymbols=13]="NumberSymbols",en[en.NumberFormats=14]="NumberFormats",en[en.CurrencyCode=15]="CurrencyCode",en[en.CurrencySymbol=16]="CurrencySymbol",en[en.CurrencyName=17]="CurrencyName",en[en.Currencies=18]="Currencies",en[en.Directionality=19]="Directionality",en[en.PluralCase=20]="PluralCase",en[en.ExtraData=21]="ExtraData",en))();const Gh="en-US";let gT=Gh;function C0(a,l,u,f,p){if(a=ce(a),Array.isArray(a))for(let _=0;_<a.length;_++)C0(a[_],l,u,f,p);else{const _=mn(),w=De();let I=Zl(a)?a:ce(a.provide),C=Jy(a);const M=lr(),B=1048575&M.providerIndexes,W=M.directiveStart,se=M.providerIndexes>>20;if(Zl(a)||!a.multi){const de=new Vo(C,p,Mh),Pe=S0(I,l,p?B:B+se,W);-1===Pe?(jo(qd(M,w),_,I),e_(_,a,l.length),l.push(I),M.directiveStart++,M.directiveEnd++,p&&(M.providerIndexes+=1048576),u.push(de),w.push(de)):(u[Pe]=de,w[Pe]=de)}else{const de=S0(I,l,B+se,W),Pe=S0(I,l,B,B+se),mt=Pe>=0&&u[Pe];if(p&&!mt||!p&&!(de>=0&&u[de])){jo(qd(M,w),_,I);const ht=function A0(a,l,u,f,p){const _=new Vo(a,u,Mh);return _.multi=[],_.index=l,_.componentProviders=0,OT(_,p,f&&!u),_}(p?Tk:xk,u.length,p,f,C);!p&&mt&&(u[Pe].providerFactory=ht),e_(_,a,l.length,0),l.push(I),M.directiveStart++,M.directiveEnd++,p&&(M.providerIndexes+=1048576),u.push(ht),w.push(ht)}else e_(_,a,de>-1?de:Pe,OT(u[p?Pe:de],C,!p&&f));!p&&f&&mt&&u[Pe].componentProviders++}}}function e_(a,l,u,f){const p=Zl(l),_=function yg(a){return!!a.useClass}(l);if(p||_){const C=(_?ce(l.useClass):l).prototype.ngOnDestroy;if(C){const M=a.destroyHooks||(a.destroyHooks=[]);if(!p&&l.multi){const B=M.indexOf(u);-1===B?M.push(u,[f,C]):M[B+1].push(f,C)}else M.push(u,C)}}}function OT(a,l,u){return u&&a.componentProviders++,a.multi.push(l)-1}function S0(a,l,u,f){for(let p=u;p<f;p++)if(l[p]===a)return p;return-1}function xk(a,l,u,f){return D0(this.multi,[])}function Tk(a,l,u,f){const p=this.multi;let _;if(this.providerFactory){const w=this.providerFactory.componentProviders,I=vo(u,u[bt],this.providerFactory.index,f);_=I.slice(0,w),D0(p,_);for(let C=w;C<I.length;C++)_.push(I[C])}else _=[],D0(p,_);return _}function D0(a,l){for(let u=0;u<a.length;u++)l.push((0,a[u])());return l}function PT(a,l=[]){return u=>{u.providersResolver=(f,p)=>function Ek(a,l,u){const f=mn();if(f.firstCreatePass){const p=ds(a);C0(u,f.data,f.blueprint,p,!0),C0(l,f.data,f.blueprint,p,!1)}}(f,p?p(a):a,l)}}class Ve{}class t_{}function LT(a,l){return new NT(a,l??null)}class NT extends Ve{constructor(l,u){super(),this._parent=u,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Om(this);const f=Jn(l);this._bootstrapComponents=cl(f.bootstrap),this._r3Injector=dv(l,u,[{provide:Ve,useValue:this},{provide:Ch,useValue:this.componentFactoryResolver}],Me(l),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(l)}get injector(){return this._r3Injector}destroy(){const l=this._r3Injector;!l.destroyed&&l.destroy(),this.destroyCbs.forEach(u=>u()),this.destroyCbs=null}onDestroy(l){this.destroyCbs.push(l)}}class k0 extends t_{constructor(l){super(),this.moduleType=l}create(l){return new NT(this.moduleType,l)}}class Ik extends Ve{constructor(l,u,f){super(),this.componentFactoryResolver=new Om(this),this.instance=null;const p=new DE([...l,{provide:Ve,useValue:this},{provide:Ch,useValue:this.componentFactoryResolver}],u||bg(),f,new Set(["environment"]));this.injector=p,p.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(l){this.injector.onDestroy(l)}}function R0(a,l,u=null){return new Ik(a,l,u).injector}let hl=(()=>{class a{constructor(u){this._injector=u,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(u){if(!u.standalone)return null;if(!this.cachedInjectors.has(u.id)){const f=xh(0,u.type),p=f.length>0?R0([f],this._injector,`Standalone[${u.type.name}]`):null;this.cachedInjectors.set(u.id,p)}return this.cachedInjectors.get(u.id)}ngOnDestroy(){try{for(const u of this.cachedInjectors.values())null!==u&&u.destroy()}finally{this.cachedInjectors.clear()}}}return a.\u0275prov=At({token:a,providedIn:"environment",factory:()=>new a(Tn(Yu))}),a})();function M0(a){a.getStandaloneInjector=l=>l.get(hl).getOrCreateStandaloneInjector(a)}function VT(a,l,u){const f=di()+a,p=De();return p[f]===gn?ul(p,f,u?l.call(u):l()):function Bm(a,l){return a[l]}(p,f)}function qh(a,l){const u=a[l];return u===gn?void 0:u}function zT(a,l){const u=mn();let f;const p=a+ei;u.firstCreatePass?(f=function Fk(a,l){if(l)for(let u=l.length-1;u>=0;u--){const f=l[u];if(a===f.name)return f}}(l,u.pipeRegistry),u.data[p]=f,f.onDestroy&&(u.destroyHooks??(u.destroyHooks=[])).push(p,f.onDestroy)):f=u.data[p];const _=f.factory||(f.factory=ma(f.type)),w=Nn(Mh);try{const I=Xa(!1),C=_();return Xa(I),function LA(a,l,u,f){u>=a.data.length&&(a.data[u]=null,a.blueprint[u]=null),l[u]=f}(u,De(),p,C),C}finally{Nn(w)}}function Yh(a,l,u){const f=a+ei,p=De(),_=Gr(p,f);return Xh(p,f)?function GT(a,l,u,f,p,_){const w=l+u;return _s(a,w,p)?ul(a,w+1,_?f.call(_,p):f(p)):qh(a,w+1)}(p,di(),l,_.transform,u,_):_.transform(u)}function WT(a,l,u,f){const p=a+ei,_=De(),w=Gr(_,p);return Xh(_,p)?function Xr(a,l,u,f,p,_,w){const I=l+u;return nd(a,I,p,_)?ul(a,I+2,w?f.call(w,p,_):f(p,_)):qh(a,I+2)}(_,di(),l,w.transform,u,f,w):w.transform(u,f)}function Xh(a,l){return a[bt].data[l].pure}function U0(a){return l=>{setTimeout(a,void 0,l)}}const to=class B0 extends d.x{constructor(l=!1){super(),this.__isAsync=l}emit(l){super.next(l)}subscribe(l,u,f){let p=l,_=u||(()=>null),w=f;if(l&&"object"==typeof l){const C=l;p=C.next?.bind(C),_=C.error?.bind(C),w=C.complete?.bind(C)}this.__isAsync&&(_=U0(_),p&&(p=U0(p)),w&&(w=U0(w)));const I=super.subscribe({next:p,error:_,complete:w});return l instanceof Q.w0&&l.add(I),I}};function Bk(){return this._results[Symbol.iterator]()}class o_{get changes(){return this._changes||(this._changes=new to)}constructor(l=!1){this._emitDistinctChangesOnly=l,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const u=o_.prototype;u[Symbol.iterator]||(u[Symbol.iterator]=Bk)}get(l){return this._results[l]}map(l){return this._results.map(l)}filter(l){return this._results.filter(l)}find(l){return this._results.find(l)}reduce(l,u){return this._results.reduce(l,u)}forEach(l){this._results.forEach(l)}some(l){return this._results.some(l)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(l,u){const f=this;f.dirty=!1;const p=function Zs(a){return a.flat(Number.POSITIVE_INFINITY)}(l);(this._changesDetected=!function sh(a,l,u){if(a.length!==l.length)return!1;for(let f=0;f<a.length;f++){let p=a[f],_=l[f];if(u&&(p=u(p),_=u(_)),_!==p)return!1}return!0}(f._results,p,u))&&(f._results=p,f.length=p.length,f.last=p[this.length-1],f.first=p[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Qh=(()=>{class a{}return a.__NG_ELEMENT_ID__=V0,a})();const Uk=Qh,a_=class extends Uk{constructor(l,u,f){super(),this._declarationLView=l,this._declarationTContainer=u,this.elementRef=f}createEmbeddedView(l,u){const f=this._declarationTContainer.tView,p=Cg(this._declarationLView,f,l,16,null,f.declTNode,null,null,null,null,u||null);p[Tl]=this._declarationLView[this._declarationTContainer.index];const w=this._declarationLView[Ws];return null!==w&&(p[Ws]=w.createEmbeddedView(f)),Qi(f,p,l),new td(p)}};function V0(){return Jh(lr(),De())}function Jh(a,l){return 4&a.type?new a_(l,a,Xl(a,l)):null}let Fs=(()=>{class a{}return a.__NG_ELEMENT_ID__=Vk,a})();function Vk(){return YT(lr(),De())}const qT=Fs,$0=class extends qT{constructor(l,u,f){super(),this._lContainer=l,this._hostTNode=u,this._hostLView=f}get element(){return Xl(this._hostTNode,this._hostLView)}get injector(){return new ba(this._hostTNode,this._hostLView)}get parentInjector(){const l=Ho(this._hostTNode,this._hostLView);if(Ul(l)){const u=Sc(l,this._hostLView),f=Vl(l);return new ba(u[bt].data[f+8],u)}return new ba(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(l){const u=H0(this._lContainer);return null!==u&&u[l]||null}get length(){return this._lContainer.length-mr}createEmbeddedView(l,u,f){let p,_;"number"==typeof f?p=f:null!=f&&(p=f.index,_=f.injector);const w=l.createEmbeddedView(u||{},_);return this.insert(w,p),w}createComponent(l,u,f,p,_){const w=l&&!function Mc(a){return"function"==typeof a}(l);let I;if(w)I=u;else{const W=u||{};I=W.index,f=W.injector,p=W.projectableNodes,_=W.environmentInjector||W.ngModuleRef}const C=w?l:new Ph(Pt(l)),M=f||this.parentInjector;if(!_&&null==C.ngModule){const se=(w?M:this.parentInjector).get(Yu,null);se&&(_=se)}const B=C.create(M,p,void 0,_);return this.insert(B.hostView,I),B}insert(l,u){const f=l._lView,p=f[bt];if(function Od(a){return Ks(a[ii])}(f)){const B=this.indexOf(l);if(-1!==B)this.detach(B);else{const W=f[ii],se=new $0(W,W[Er],W[ii]);se.detach(se.indexOf(l))}}const _=this._adjustIndex(u),w=this._lContainer;!function v(a,l,u,f){const p=mr+f,_=u.length;f>0&&(u[p-1][Nr]=l),f<_-mr?(l[Nr]=u[p],sm(u,mr+f,l)):(u.push(l),l[Nr]=null),l[ii]=u;const w=l[Tl];null!==w&&u!==w&&function b(a,l){const u=a[cs];l[or]!==l[ii][ii][or]&&(a[xr]=!0),null===u?a[cs]=[l]:u.push(l)}(w,l);const I=l[Ws];null!==I&&I.insertView(a),l[vn]|=64}(p,f,w,_);const I=al(_,w),C=f[Jt],M=dr(C,w[fc]);return null!==M&&function Oy(a,l,u,f,p,_){f[os]=p,f[Er]=l,mm(a,f,u,1,p,_)}(p,w[Er],C,f,M,I),l.attachToViewContainerRef(),sm(j0(w),_,l),l}move(l,u){return this.insert(l,u)}indexOf(l){const u=H0(this._lContainer);return null!==u?u.indexOf(l):-1}remove(l){const u=this._adjustIndex(l,-1),f=P(this._lContainer,u);f&&(Hl(j0(this._lContainer),u),F(f[bt],f))}detach(l){const u=this._adjustIndex(l,-1),f=P(this._lContainer,u);return f&&null!=Hl(j0(this._lContainer),u)?new td(f):null}_adjustIndex(l,u=0){return l??this.length+u}};function H0(a){return a[Il]}function j0(a){return a[Il]||(a[Il]=[])}function YT(a,l){let u;const f=l[a.index];if(Ks(f))u=f;else{let p;if(8&a.type)p=Dn(f);else{const _=l[Jt];p=_.createComment("");const w=pr(a,l);Mt(_,dr(_,w),p,function Yl(a,l){return a.nextSibling(l)}(_,w),!1)}l[a.index]=u=vv(f,l,p,a),wi(l,u)}return new $0(u,a,l)}class G0{constructor(l){this.queryList=l,this.matches=null}clone(){return new G0(this.queryList)}setDirty(){this.queryList.setDirty()}}class l_{constructor(l=[]){this.queries=l}createEmbeddedView(l){const u=l.queries;if(null!==u){const f=null!==l.contentQueries?l.contentQueries[0]:u.length,p=[];for(let _=0;_<f;_++){const w=u.getByIndex(_);p.push(this.queries[w.indexInDeclarationView].clone())}return new l_(p)}return null}insertView(l){this.dirtyQueriesWithMatches(l)}detachView(l){this.dirtyQueriesWithMatches(l)}dirtyQueriesWithMatches(l){for(let u=0;u<this.queries.length;u++)null!==JT(l,u).matches&&this.queries[u].setDirty()}}class fl{constructor(l,u,f=null){this.predicate=l,this.flags=u,this.read=f}}class ip{constructor(l=[]){this.queries=l}elementStart(l,u){for(let f=0;f<this.queries.length;f++)this.queries[f].elementStart(l,u)}elementEnd(l){for(let u=0;u<this.queries.length;u++)this.queries[u].elementEnd(l)}embeddedTView(l){let u=null;for(let f=0;f<this.length;f++){const p=null!==u?u.length:0,_=this.getByIndex(f).embeddedTView(l,p);_&&(_.indexInDeclarationView=f,null!==u?u.push(_):u=[_])}return null!==u?new ip(u):null}template(l,u){for(let f=0;f<this.queries.length;f++)this.queries[f].template(l,u)}getByIndex(l){return this.queries[l]}get length(){return this.queries.length}track(l){this.queries.push(l)}}class c_{constructor(l,u=-1){this.metadata=l,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=u}elementStart(l,u){this.isApplyingToNode(u)&&this.matchTNode(l,u)}elementEnd(l){this._declarationNodeIndex===l.index&&(this._appliesToNextNode=!1)}template(l,u){this.elementStart(l,u)}embeddedTView(l,u){return this.isApplyingToNode(l)?(this.crossesNgTemplate=!0,this.addMatch(-l.index,u),new c_(this.metadata)):null}isApplyingToNode(l){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const u=this._declarationNodeIndex;let f=l.parent;for(;null!==f&&8&f.type&&f.index!==u;)f=f.parent;return u===(null!==f?f.index:-1)}return this._appliesToNextNode}matchTNode(l,u){const f=this.metadata.predicate;if(Array.isArray(f))for(let p=0;p<f.length;p++){const _=f[p];this.matchTNodeWithReadOption(l,u,$k(u,_)),this.matchTNodeWithReadOption(l,u,yo(u,l,_,!1,!1))}else f===Qh?4&u.type&&this.matchTNodeWithReadOption(l,u,-1):this.matchTNodeWithReadOption(l,u,yo(u,l,f,!1,!1))}matchTNodeWithReadOption(l,u,f){if(null!==f){const p=this.metadata.read;if(null!==p)if(p===Sh||p===Fs||p===Qh&&4&u.type)this.addMatch(u.index,-2);else{const _=yo(u,l,p,!1,!1);null!==_&&this.addMatch(u.index,_)}else this.addMatch(u.index,f)}}addMatch(l,u){null===this.matches?this.matches=[l,u]:this.matches.push(l,u)}}function $k(a,l){const u=a.localNames;if(null!==u)for(let f=0;f<u.length;f+=2)if(u[f]===l)return u[f+1];return null}function u_(a,l,u,f){return-1===u?function z0(a,l){return 11&a.type?Xl(a,l):4&a.type?Jh(a,l):null}(l,a):-2===u?function Hk(a,l,u){return u===Sh?Xl(l,a):u===Qh?Jh(l,a):u===Fs?YT(l,a):void 0}(a,l,f):vo(a,a[bt],u,l)}function ZT(a,l,u,f){const p=l[Ws].queries[f];if(null===p.matches){const _=a.data,w=u.matches,I=[];for(let C=0;C<w.length;C+=2){const M=w[C];I.push(M<0?null:u_(l,_[M],w[C+1],u.metadata.read))}p.matches=I}return p.matches}function d_(a,l,u,f){const p=a.queries.getByIndex(u),_=p.matches;if(null!==_){const w=ZT(a,l,p,u);for(let I=0;I<_.length;I+=2){const C=_[I];if(C>0)f.push(w[I/2]);else{const M=_[I+1],B=l[-C];for(let W=mr;W<B.length;W++){const se=B[W];se[Tl]===se[ii]&&d_(se[bt],se,M,f)}if(null!==B[cs]){const W=B[cs];for(let se=0;se<W.length;se++){const de=W[se];d_(de[bt],de,M,f)}}}}}return f}function XT(a){const l=De(),u=mn(),f=Ec();Ir(f+1);const p=JT(u,f);if(a.dirty&&function Md(a){return 4==(4&a[vn])}(l)===(2==(2&p.metadata.flags))){if(null===p.matches)a.reset([]);else{const _=p.crossesNgTemplate?d_(u,l,f,[]):ZT(u,l,p,f);a.reset(_,xm),a.notifyOnChanges()}return!0}return!1}function h_(a,l,u){const f=mn();f.firstCreatePass&&(QT(f,new fl(a,l,u),-1),2==(2&l)&&(f.staticViewQueries=!0)),m_(f,De(),l)}function f_(a,l,u,f){const p=mn();if(p.firstCreatePass){const _=lr();QT(p,new fl(l,u,f),_.index),function Gk(a,l){const u=a.contentQueries||(a.contentQueries=[]);l!==(u.length?u[u.length-1]:-1)&&u.push(a.queries.length-1,l)}(p,a),2==(2&u)&&(p.staticContentQueries=!0)}m_(p,De(),u)}function W0(){return function jk(a,l){return a[Ws].queries[l].queryList}(De(),Ec())}function m_(a,l,u){const f=new o_(4==(4&u));Ag(a,l,f,f.destroy),null===l[Ws]&&(l[Ws]=new l_),l[Ws].queries.push(new G0(f))}function QT(a,l,u){null===a.queries&&(a.queries=new ip),a.queries.track(new c_(l,u))}function JT(a,l){return a.queries.getByIndex(l)}function eI(a,l){return Jh(a,l)}function q0(a){return!!Jn(a)}function op(...a){}const lb=new Pn("Application Initializer");let v_=(()=>{class a{constructor(u){this.appInits=u,this.resolve=op,this.reject=op,this.initialized=!1,this.done=!1,this.donePromise=new Promise((f,p)=>{this.resolve=f,this.reject=p})}runInitializers(){if(this.initialized)return;const u=[],f=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let p=0;p<this.appInits.length;p++){const _=this.appInits[p]();if(Bv(_))u.push(_);else if(UA(_)){const w=new Promise((I,C)=>{_.subscribe({complete:I,error:C})});u.push(w)}}Promise.all(u).then(()=>{f()}).catch(p=>{this.reject(p)}),0===u.length&&f(),this.initialized=!0}}return a.\u0275fac=function(u){return new(u||a)(Tn(lb,8))},a.\u0275prov=At({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();const b_=new Pn("AppId",{providedIn:"root",factory:function cb(){return`${ub()}${ub()}${ub()}`}});function ub(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const w_=new Pn("Platform Initializer"),pI=new Pn("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),rR=new Pn("AnimationModuleType");let sR=(()=>{class a{log(u){console.log(u)}warn(u){console.warn(u)}}return a.\u0275fac=function(u){return new(u||a)},a.\u0275prov=At({token:a,factory:a.\u0275fac,providedIn:"platform"}),a})();const E_=new Pn("LocaleId",{providedIn:"root",factory:()=>Ki(E_,Bt.Optional|Bt.SkipSelf)||function oR(){return typeof $localize<"u"&&$localize.locale||Gh}()}),aR=new Pn("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class x_{constructor(l,u){this.ngModuleFactory=l,this.componentFactories=u}}let cR=(()=>{class a{compileModuleSync(u){return new k0(u)}compileModuleAsync(u){return Promise.resolve(this.compileModuleSync(u))}compileModuleAndAllComponentsSync(u){const f=this.compileModuleSync(u),_=cl(Jn(u).declarations).reduce((w,I)=>{const C=Pt(I);return C&&w.push(new Ph(C)),w},[]);return new x_(f,_)}compileModuleAndAllComponentsAsync(u){return Promise.resolve(this.compileModuleAndAllComponentsSync(u))}clearCache(){}clearCacheFor(u){}getModuleId(u){}}return a.\u0275fac=function(u){return new(u||a)},a.\u0275prov=At({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();const vI=(()=>Promise.resolve(0))();function T_(a){typeof Zone>"u"?vI.then(()=>{a&&a.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",a)}class na{constructor({enableLongStackTrace:l=!1,shouldCoalesceEventChangeDetection:u=!1,shouldCoalesceRunChangeDetection:f=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new to(!1),this.onMicrotaskEmpty=new to(!1),this.onStable=new to(!1),this.onError=new to(!1),typeof Zone>"u")throw new Ce(908,!1);Zone.assertZonePatched();const p=this;p._nesting=0,p._outer=p._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(p._inner=p._inner.fork(new Zone.TaskTrackingZoneSpec)),l&&Zone.longStackTraceZoneSpec&&(p._inner=p._inner.fork(Zone.longStackTraceZoneSpec)),p.shouldCoalesceEventChangeDetection=!f&&u,p.shouldCoalesceRunChangeDetection=f,p.lastRequestAnimationFrameId=-1,p.nativeRequestAnimationFrame=function uR(){let a=ni.requestAnimationFrame,l=ni.cancelAnimationFrame;if(typeof Zone<"u"&&a&&l){const u=a[Zone.__symbol__("OriginalDelegate")];u&&(a=u);const f=l[Zone.__symbol__("OriginalDelegate")];f&&(l=f)}return{nativeRequestAnimationFrame:a,nativeCancelAnimationFrame:l}}().nativeRequestAnimationFrame,function mR(a){const l=()=>{!function fR(a){a.isCheckStableRunning||-1!==a.lastRequestAnimationFrameId||(a.lastRequestAnimationFrameId=a.nativeRequestAnimationFrame.call(ni,()=>{a.fakeTopEventTask||(a.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{a.lastRequestAnimationFrameId=-1,db(a),a.isCheckStableRunning=!0,I_(a),a.isCheckStableRunning=!1},void 0,()=>{},()=>{})),a.fakeTopEventTask.invoke()}),db(a))}(a)};a._inner=a._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(u,f,p,_,w,I)=>{try{return bI(a),u.invokeTask(p,_,w,I)}finally{(a.shouldCoalesceEventChangeDetection&&"eventTask"===_.type||a.shouldCoalesceRunChangeDetection)&&l(),wI(a)}},onInvoke:(u,f,p,_,w,I,C)=>{try{return bI(a),u.invoke(p,_,w,I,C)}finally{a.shouldCoalesceRunChangeDetection&&l(),wI(a)}},onHasTask:(u,f,p,_)=>{u.hasTask(p,_),f===p&&("microTask"==_.change?(a._hasPendingMicrotasks=_.microTask,db(a),I_(a)):"macroTask"==_.change&&(a.hasPendingMacrotasks=_.macroTask))},onHandleError:(u,f,p,_)=>(u.handleError(p,_),a.runOutsideAngular(()=>a.onError.emit(_)),!1)})}(p)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!na.isInAngularZone())throw new Ce(909,!1)}static assertNotInAngularZone(){if(na.isInAngularZone())throw new Ce(909,!1)}run(l,u,f){return this._inner.run(l,u,f)}runTask(l,u,f,p){const _=this._inner,w=_.scheduleEventTask("NgZoneEvent: "+p,l,hR,op,op);try{return _.runTask(w,u,f)}finally{_.cancelTask(w)}}runGuarded(l,u,f){return this._inner.runGuarded(l,u,f)}runOutsideAngular(l){return this._outer.run(l)}}const hR={};function I_(a){if(0==a._nesting&&!a.hasPendingMicrotasks&&!a.isStable)try{a._nesting++,a.onMicrotaskEmpty.emit(null)}finally{if(a._nesting--,!a.hasPendingMicrotasks)try{a.runOutsideAngular(()=>a.onStable.emit(null))}finally{a.isStable=!0}}}function db(a){a.hasPendingMicrotasks=!!(a._hasPendingMicrotasks||(a.shouldCoalesceEventChangeDetection||a.shouldCoalesceRunChangeDetection)&&-1!==a.lastRequestAnimationFrameId)}function bI(a){a._nesting++,a.isStable&&(a.isStable=!1,a.onUnstable.emit(null))}function wI(a){a._nesting--,I_(a)}class pR{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new to,this.onMicrotaskEmpty=new to,this.onStable=new to,this.onError=new to}run(l,u,f){return l.apply(u,f)}runGuarded(l,u,f){return l.apply(u,f)}runOutsideAngular(l){return l()}runTask(l,u,f,p){return l.apply(u,f)}}const EI=new Pn(""),xI=new Pn("");let ap,gR=(()=>{class a{constructor(u,f,p){this._ngZone=u,this.registry=f,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,ap||(function _R(a){ap=a}(p),p.addToWindow(f)),this._watchAngularEvents(),u.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{na.assertNotInAngularZone(),T_(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())T_(()=>{for(;0!==this._callbacks.length;){let u=this._callbacks.pop();clearTimeout(u.timeoutId),u.doneCb(this._didWork)}this._didWork=!1});else{let u=this.getPendingTasks();this._callbacks=this._callbacks.filter(f=>!f.updateCb||!f.updateCb(u)||(clearTimeout(f.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(u=>({source:u.source,creationLocation:u.creationLocation,data:u.data})):[]}addCallback(u,f,p){let _=-1;f&&f>0&&(_=setTimeout(()=>{this._callbacks=this._callbacks.filter(w=>w.timeoutId!==_),u(this._didWork,this.getPendingTasks())},f)),this._callbacks.push({doneCb:u,timeoutId:_,updateCb:p})}whenStable(u,f,p){if(p&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(u,f,p),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(u){this.registry.registerApplication(u,this)}unregisterApplication(u){this.registry.unregisterApplication(u)}findProviders(u,f,p){return[]}}return a.\u0275fac=function(u){return new(u||a)(Tn(na),Tn(TI),Tn(xI))},a.\u0275prov=At({token:a,factory:a.\u0275fac}),a})(),TI=(()=>{class a{constructor(){this._applications=new Map}registerApplication(u,f){this._applications.set(u,f)}unregisterApplication(u){this._applications.delete(u)}unregisterAllApplications(){this._applications.clear()}getTestability(u){return this._applications.get(u)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(u,f=!0){return ap?.findTestabilityInTree(this,u,f)??null}}return a.\u0275fac=function(u){return new(u||a)},a.\u0275prov=At({token:a,factory:a.\u0275fac,providedIn:"platform"}),a})();const oc=!1;let ml=null;const II=new Pn("AllowMultipleToken"),Do=new Pn("PlatformDestroyListeners"),gt=new Pn("appBootstrapListener");class lp{constructor(l,u){this.name=l,this.token=u}}function SI(a,l,u=[]){const f=`Platform: ${l}`,p=new Pn(f);return(_=[])=>{let w=pl();if(!w||w.injector.get(II,!1)){const I=[...u,..._,{provide:p,useValue:!0}];a?a(I):function yR(a){if(ml&&!ml.get(II,!1))throw new Ce(400,!1);ml=a;const l=a.get(DI);(function CI(a){const l=a.get(w_,null);l&&l.forEach(u=>u())})(a)}(function cp(a=[],l){return Ah.create({name:l,providers:[{provide:Zc,useValue:"platform"},{provide:Do,useValue:new Set([()=>ml=null])},...a]})}(I,f))}return function vs(a){const l=pl();if(!l)throw new Ce(401,!1);return l}()}}function pl(){return ml?.get(DI)??null}let DI=(()=>{class a{constructor(u){this._injector=u,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(u,f){const p=function S_(a,l){let u;return u="noop"===a?new pR:("zone.js"===a?void 0:a)||new na(l),u}(f?.ngZone,function mb(a){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!a||!a.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!a||!a.ngZoneRunCoalescing)||!1}}(f)),_=[{provide:na,useValue:p}];return p.run(()=>{const w=Ah.create({providers:_,parent:this.injector,name:u.moduleType.name}),I=u.create(w),C=I.injector.get(Tm,null);if(!C)throw new Ce(402,!1);return p.runOutsideAngular(()=>{const M=p.onError.subscribe({next:B=>{C.handleError(B)}});I.onDestroy(()=>{ru(this._modules,I),M.unsubscribe()})}),function pb(a,l,u){try{const f=u();return Bv(f)?f.catch(p=>{throw l.runOutsideAngular(()=>a.handleError(p)),p}):f}catch(f){throw l.runOutsideAngular(()=>a.handleError(f)),f}}(C,p,()=>{const M=I.injector.get(v_);return M.runInitializers(),M.donePromise.then(()=>(function u0(a){Te(a,"Expected localeId to be defined"),"string"==typeof a&&(gT=a.toLowerCase().replace(/_/g,"-"))}(I.injector.get(E_,Gh)||Gh),this._moduleDoBootstrap(I),I))})})}bootstrapModule(u,f=[]){const p=Jr({},f);return function hb(a,l,u){const f=new k0(u);return Promise.resolve(f)}(0,0,u).then(_=>this.bootstrapModuleFactory(_,p))}_moduleDoBootstrap(u){const f=u.injector.get(D_);if(u._bootstrapComponents.length>0)u._bootstrapComponents.forEach(p=>f.bootstrap(p));else{if(!u.instance.ngDoBootstrap)throw new Ce(-403,!1);u.instance.ngDoBootstrap(f)}this._modules.push(u)}onDestroy(u){this._destroyListeners.push(u)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ce(404,!1);this._modules.slice().forEach(f=>f.destroy()),this._destroyListeners.forEach(f=>f());const u=this._injector.get(Do,null);u&&(u.forEach(f=>f()),u.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return a.\u0275fac=function(u){return new(u||a)(Tn(Ah))},a.\u0275prov=At({token:a,factory:a.\u0275fac,providedIn:"platform"}),a})();function Jr(a,l){return Array.isArray(l)?l.reduce(Jr,a):{...a,...l}}let D_=(()=>{class a{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(u,f,p){this._zone=u,this._injector=f,this._exceptionHandler=p,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const _=new V.y(I=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{I.next(this._stable),I.complete()})}),w=new V.y(I=>{let C;this._zone.runOutsideAngular(()=>{C=this._zone.onStable.subscribe(()=>{na.assertNotInAngularZone(),T_(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,I.next(!0))})})});const M=this._zone.onUnstable.subscribe(()=>{na.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{I.next(!1)}))});return()=>{C.unsubscribe(),M.unsubscribe()}});this.isStable=(0,he.T)(_,w.pipe((0,ye.B)()))}bootstrap(u,f){const p=u instanceof kE;if(!this._injector.get(v_).done){!p&&Qe(u);throw new Ce(405,oc)}let w;w=p?u:this._injector.get(Ch).resolveComponentFactory(u),this.componentTypes.push(w.componentType);const I=function C_(a){return a.isBoundToModule}(w)?void 0:this._injector.get(Ve),M=w.create(Ah.NULL,[],f||w.selector,I),B=M.location.nativeElement,W=M.injector.get(EI,null);return W?.registerApplication(B),M.onDestroy(()=>{this.detachView(M.hostView),ru(this.components,M),W?.unregisterApplication(B)}),this._loadComponent(M),M}tick(){if(this._runningTick)throw new Ce(101,!1);try{this._runningTick=!0;for(let u of this._views)u.detectChanges()}catch(u){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(u))}finally{this._runningTick=!1}}attachView(u){const f=u;this._views.push(f),f.attachToAppRef(this)}detachView(u){const f=u;ru(this._views,f),f.detachFromAppRef()}_loadComponent(u){this.attachView(u.hostView),this.tick(),this.components.push(u);const f=this._injector.get(gt,[]);f.push(...this._bootstrapListeners),f.forEach(p=>p(u))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(u=>u()),this._views.slice().forEach(u=>u.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(u){return this._destroyListeners.push(u),()=>ru(this._destroyListeners,u)}destroy(){if(this._destroyed)throw new Ce(406,!1);const u=this._injector;u.destroy&&!u.destroyed&&u.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return a.\u0275fac=function(u){return new(u||a)(Tn(na),Tn(Yu),Tn(Tm))},a.\u0275prov=At({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();function ru(a,l){const u=a.indexOf(l);u>-1&&a.splice(u,1)}function gb(){return!1}let yb=(()=>{class a{}return a.__NG_ELEMENT_ID__=AI,a})();function AI(a){return function vR(a,l,u){if(us(a)&&!u){const f=ar(a.index,l);return new td(f,f)}return 47&a.type?new td(l[or],l):null}(lr(),De(),16==(16&a))}class k_{constructor(){}supports(l){return Fm(l)}create(l){return new BI(l)}}const Tb=(a,l)=>l;class BI{constructor(l){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=l||Tb}forEachItem(l){let u;for(u=this._itHead;null!==u;u=u._next)l(u)}forEachOperation(l){let u=this._itHead,f=this._removalsHead,p=0,_=null;for(;u||f;){const w=!f||u&&u.currentIndex<Cb(f,p,_)?u:f,I=Cb(w,p,_),C=w.currentIndex;if(w===f)p--,f=f._nextRemoved;else if(u=u._next,null==w.previousIndex)p++;else{_||(_=[]);const M=I-p,B=C-p;if(M!=B){for(let se=0;se<M;se++){const de=se<_.length?_[se]:_[se]=0,Pe=de+se;B<=Pe&&Pe<M&&(_[se]=de+1)}_[w.previousIndex]=B-M}}I!==C&&l(w,I,C)}}forEachPreviousItem(l){let u;for(u=this._previousItHead;null!==u;u=u._nextPrevious)l(u)}forEachAddedItem(l){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)l(u)}forEachMovedItem(l){let u;for(u=this._movesHead;null!==u;u=u._nextMoved)l(u)}forEachRemovedItem(l){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)l(u)}forEachIdentityChange(l){let u;for(u=this._identityChangesHead;null!==u;u=u._nextIdentityChange)l(u)}diff(l){if(null==l&&(l=[]),!Fm(l))throw new Ce(900,!1);return this.check(l)?this:null}onDestroy(){}check(l){this._reset();let p,_,w,u=this._itHead,f=!1;if(Array.isArray(l)){this.length=l.length;for(let I=0;I<this.length;I++)_=l[I],w=this._trackByFn(I,_),null!==u&&Object.is(u.trackById,w)?(f&&(u=this._verifyReinsertion(u,_,w,I)),Object.is(u.item,_)||this._addIdentityChange(u,_)):(u=this._mismatch(u,_,w,I),f=!0),u=u._next}else p=0,function Dx(a,l){if(Array.isArray(a))for(let u=0;u<a.length;u++)l(a[u]);else{const u=a[Symbol.iterator]();let f;for(;!(f=u.next()).done;)l(f.value)}}(l,I=>{w=this._trackByFn(p,I),null!==u&&Object.is(u.trackById,w)?(f&&(u=this._verifyReinsertion(u,I,w,p)),Object.is(u.item,I)||this._addIdentityChange(u,I)):(u=this._mismatch(u,I,w,p),f=!0),u=u._next,p++}),this.length=p;return this._truncate(u),this.collection=l,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let l;for(l=this._previousItHead=this._itHead;null!==l;l=l._next)l._nextPrevious=l._next;for(l=this._additionsHead;null!==l;l=l._nextAdded)l.previousIndex=l.currentIndex;for(this._additionsHead=this._additionsTail=null,l=this._movesHead;null!==l;l=l._nextMoved)l.previousIndex=l.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(l,u,f,p){let _;return null===l?_=this._itTail:(_=l._prev,this._remove(l)),null!==(l=null===this._unlinkedRecords?null:this._unlinkedRecords.get(f,null))?(Object.is(l.item,u)||this._addIdentityChange(l,u),this._reinsertAfter(l,_,p)):null!==(l=null===this._linkedRecords?null:this._linkedRecords.get(f,p))?(Object.is(l.item,u)||this._addIdentityChange(l,u),this._moveAfter(l,_,p)):l=this._addAfter(new UI(u,f),_,p),l}_verifyReinsertion(l,u,f,p){let _=null===this._unlinkedRecords?null:this._unlinkedRecords.get(f,null);return null!==_?l=this._reinsertAfter(_,l._prev,p):l.currentIndex!=p&&(l.currentIndex=p,this._addToMoves(l,p)),l}_truncate(l){for(;null!==l;){const u=l._next;this._addToRemovals(this._unlink(l)),l=u}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(l,u,f){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(l);const p=l._prevRemoved,_=l._nextRemoved;return null===p?this._removalsHead=_:p._nextRemoved=_,null===_?this._removalsTail=p:_._prevRemoved=p,this._insertAfter(l,u,f),this._addToMoves(l,f),l}_moveAfter(l,u,f){return this._unlink(l),this._insertAfter(l,u,f),this._addToMoves(l,f),l}_addAfter(l,u,f){return this._insertAfter(l,u,f),this._additionsTail=null===this._additionsTail?this._additionsHead=l:this._additionsTail._nextAdded=l,l}_insertAfter(l,u,f){const p=null===u?this._itHead:u._next;return l._next=p,l._prev=u,null===p?this._itTail=l:p._prev=l,null===u?this._itHead=l:u._next=l,null===this._linkedRecords&&(this._linkedRecords=new Ib),this._linkedRecords.put(l),l.currentIndex=f,l}_remove(l){return this._addToRemovals(this._unlink(l))}_unlink(l){null!==this._linkedRecords&&this._linkedRecords.remove(l);const u=l._prev,f=l._next;return null===u?this._itHead=f:u._next=f,null===f?this._itTail=u:f._prev=u,l}_addToMoves(l,u){return l.previousIndex===u||(this._movesTail=null===this._movesTail?this._movesHead=l:this._movesTail._nextMoved=l),l}_addToRemovals(l){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Ib),this._unlinkedRecords.put(l),l.currentIndex=null,l._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=l,l._prevRemoved=null):(l._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=l),l}_addIdentityChange(l,u){return l.item=u,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=l:this._identityChangesTail._nextIdentityChange=l,l}}class UI{constructor(l,u){this.item=l,this.trackById=u,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class xR{constructor(){this._head=null,this._tail=null}add(l){null===this._head?(this._head=this._tail=l,l._nextDup=null,l._prevDup=null):(this._tail._nextDup=l,l._prevDup=this._tail,l._nextDup=null,this._tail=l)}get(l,u){let f;for(f=this._head;null!==f;f=f._nextDup)if((null===u||u<=f.currentIndex)&&Object.is(f.trackById,l))return f;return null}remove(l){const u=l._prevDup,f=l._nextDup;return null===u?this._head=f:u._nextDup=f,null===f?this._tail=u:f._prevDup=u,null===this._head}}class Ib{constructor(){this.map=new Map}put(l){const u=l.trackById;let f=this.map.get(u);f||(f=new xR,this.map.set(u,f)),f.add(l)}get(l,u){const p=this.map.get(l);return p?p.get(l,u):null}remove(l){const u=l.trackById;return this.map.get(u).remove(l)&&this.map.delete(u),l}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Cb(a,l,u){const f=a.previousIndex;if(null===f)return f;let p=0;return u&&f<u.length&&(p=u[f]),f+l+p}class R_{constructor(){}supports(l){return l instanceof Map||Qc(l)}create(){return new VI}}class VI{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(l){let u;for(u=this._mapHead;null!==u;u=u._next)l(u)}forEachPreviousItem(l){let u;for(u=this._previousMapHead;null!==u;u=u._nextPrevious)l(u)}forEachChangedItem(l){let u;for(u=this._changesHead;null!==u;u=u._nextChanged)l(u)}forEachAddedItem(l){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)l(u)}forEachRemovedItem(l){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)l(u)}diff(l){if(l){if(!(l instanceof Map||Qc(l)))throw new Ce(900,!1)}else l=new Map;return this.check(l)?this:null}onDestroy(){}check(l){this._reset();let u=this._mapHead;if(this._appendAfter=null,this._forEach(l,(f,p)=>{if(u&&u.key===p)this._maybeAddToChanges(u,f),this._appendAfter=u,u=u._next;else{const _=this._getOrCreateRecordForKey(p,f);u=this._insertBeforeOrAppend(u,_)}}),u){u._prev&&(u._prev._next=null),this._removalsHead=u;for(let f=u;null!==f;f=f._nextRemoved)f===this._mapHead&&(this._mapHead=null),this._records.delete(f.key),f._nextRemoved=f._next,f.previousValue=f.currentValue,f.currentValue=null,f._prev=null,f._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(l,u){if(l){const f=l._prev;return u._next=l,u._prev=f,l._prev=u,f&&(f._next=u),l===this._mapHead&&(this._mapHead=u),this._appendAfter=l,l}return this._appendAfter?(this._appendAfter._next=u,u._prev=this._appendAfter):this._mapHead=u,this._appendAfter=u,null}_getOrCreateRecordForKey(l,u){if(this._records.has(l)){const p=this._records.get(l);this._maybeAddToChanges(p,u);const _=p._prev,w=p._next;return _&&(_._next=w),w&&(w._prev=_),p._next=null,p._prev=null,p}const f=new TR(l);return this._records.set(l,f),f.currentValue=u,this._addToAdditions(f),f}_reset(){if(this.isDirty){let l;for(this._previousMapHead=this._mapHead,l=this._previousMapHead;null!==l;l=l._next)l._nextPrevious=l._next;for(l=this._changesHead;null!==l;l=l._nextChanged)l.previousValue=l.currentValue;for(l=this._additionsHead;null!=l;l=l._nextAdded)l.previousValue=l.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(l,u){Object.is(u,l.currentValue)||(l.previousValue=l.currentValue,l.currentValue=u,this._addToChanges(l))}_addToAdditions(l){null===this._additionsHead?this._additionsHead=this._additionsTail=l:(this._additionsTail._nextAdded=l,this._additionsTail=l)}_addToChanges(l){null===this._changesHead?this._changesHead=this._changesTail=l:(this._changesTail._nextChanged=l,this._changesTail=l)}_forEach(l,u){l instanceof Map?l.forEach(u):Object.keys(l).forEach(f=>u(l[f],f))}}class TR{constructor(l){this.key=l,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function M_(){return new pp([new k_])}let pp=(()=>{class a{constructor(u){this.factories=u}static create(u,f){if(null!=f){const p=f.factories.slice();u=u.concat(p)}return new a(u)}static extend(u){return{provide:a,useFactory:f=>a.create(u,f||M_()),deps:[[a,new wt,new Ta]]}}find(u){const f=this.factories.find(p=>p.supports(u));if(null!=f)return f;throw new Ce(901,!1)}}return a.\u0275prov=At({token:a,providedIn:"root",factory:M_}),a})();function Dr(){return new Ar([new R_])}let Ar=(()=>{class a{constructor(u){this.factories=u}static create(u,f){if(f){const p=f.factories.slice();u=u.concat(p)}return new a(u)}static extend(u){return{provide:a,useFactory:f=>a.create(u,f||Dr()),deps:[[a,new wt,new Ta]]}}find(u){const f=this.factories.find(p=>p.supports(u));if(f)return f;throw new Ce(901,!1)}}return a.\u0275prov=At({token:a,providedIn:"root",factory:Dr}),a})();const IR=SI(null,"core",[]);let HI=(()=>{class a{constructor(u){}}return a.\u0275fac=function(u){return new(u||a)(Tn(D_))},a.\u0275mod=fe({type:a}),a.\u0275inj=Vt({}),a})();function CR(a){return"boolean"==typeof a?a:null!=a&&"false"!==a}},3942:(Ft,Be,z)=>{z.d(Be,{Z:()=>lt});var d=z(2090),Q=z(4859),V=z(6881),he=z(1877);class ye{constructor(Ce,Ke){this._delegate=Ce,this.firebase=Ke,(0,V._addComponent)(Ce,new Q.wA("app-compat",()=>this,"PUBLIC")),this.container=Ce.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Ce){this._delegate.automaticDataCollectionEnabled=Ce}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(Ce=>{this._delegate.checkDestroyed(),Ce()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,V.deleteApp)(this._delegate)))}_getService(Ce,Ke=V._DEFAULT_ENTRY_NAME){var qe;this._delegate.checkDestroyed();const it=this._delegate.container.getProvider(Ce);return!it.isInitialized()&&"EXPLICIT"===(null===(qe=it.getComponent())||void 0===qe?void 0:qe.instantiationMode)&&it.initialize(),it.getImmediate({identifier:Ke})}_removeServiceInstance(Ce,Ke=V._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(Ce).clearInstance(Ke)}_addComponent(Ce){(0,V._addComponent)(this._delegate,Ce)}_addOrOverwriteComponent(Ce){(0,V._addOrOverwriteComponent)(this._delegate,Ce)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Oe=new d.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),ee=function Se(){const xt=function Me(xt){const Ce={},Ke={__esModule:!0,initializeApp:function Ye(Je,Et={}){const kt=V.initializeApp(Je,Et);if((0,d.r3)(Ce,kt.name))return Ce[kt.name];const cn=new xt(kt,Ke);return Ce[kt.name]=cn,cn},app:it,registerVersion:V.registerVersion,setLogLevel:V.setLogLevel,onLog:V.onLog,apps:null,SDK_VERSION:V.SDK_VERSION,INTERNAL:{registerComponent:function Ge(Je){const Et=Je.name,kt=Et.replace("-compat","");if(V._registerComponent(Je)&&"PUBLIC"===Je.type){const cn=(Tt=it())=>{if("function"!=typeof Tt[kt])throw Oe.create("invalid-app-argument",{appName:Et});return Tt[kt]()};void 0!==Je.serviceProps&&(0,d.ZB)(cn,Je.serviceProps),Ke[kt]=cn,xt.prototype[kt]=function(...Tt){return this._getService.bind(this,Et).apply(this,Je.multipleInstances?Tt:[])}}return"PUBLIC"===Je.type?Ke[kt]:null},removeApp:function qe(Je){delete Ce[Je]},useAsService:function at(Je,Et){return"serverAuth"===Et?null:Et},modularAPIs:V}};function it(Je){if(!(0,d.r3)(Ce,Je=Je||V._DEFAULT_ENTRY_NAME))throw Oe.create("no-app",{appName:Je});return Ce[Je]}return Ke.default=Ke,Object.defineProperty(Ke,"apps",{get:function je(){return Object.keys(Ce).map(Je=>Ce[Je])}}),it.App=xt,Ke}(ye);return xt.INTERNAL=Object.assign(Object.assign({},xt.INTERNAL),{createFirebaseNamespace:Se,extendNamespace:function Ce(Ke){(0,d.ZB)(xt,Ke)},createSubscribe:d.ne,ErrorFactory:d.LL,deepExtend:d.ZB}),xt}(),J=new he.Yd("@firebase/app-compat");if((0,d.jU)()&&void 0!==self.firebase){J.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const xt=self.firebase.SDK_VERSION;xt&&xt.indexOf("LITE")>=0&&J.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const lt=ee;!function Ue(xt){(0,V.registerVersion)("@firebase/app-compat","0.2.13",xt)}()},6881:(Ft,Be,z)=>{z.r(Be),z.d(Be,{FirebaseError:()=>he.ZR,SDK_VERSION:()=>Tn,_DEFAULT_ENTRY_NAME:()=>On,_addComponent:()=>ci,_addOrOverwriteComponent:()=>vi,_apps:()=>zt,_clearComponents:()=>Gn,_components:()=>rr,_getProvider:()=>Wi,_registerComponent:()=>fr,_removeServiceInstance:()=>ca,deleteApp:()=>rs,getApp:()=>Ki,getApps:()=>sr,initializeApp:()=>Pr,onLog:()=>Is,registerVersion:()=>qi,setLogLevel:()=>Cs});var d=z(5861),Q=z(4859),V=z(1877),he=z(2090);const ye=(xe,fe)=>fe.some(Xe=>xe instanceof Xe);let ue,Oe;const ee=new WeakMap,J=new WeakMap,ce=new WeakMap,tt=new WeakMap,Ue=new WeakMap;let Ce={get(xe,fe,Xe){if(xe instanceof IDBTransaction){if("done"===fe)return J.get(xe);if("objectStoreNames"===fe)return xe.objectStoreNames||ce.get(xe);if("store"===fe)return Xe.objectStoreNames[1]?void 0:Xe.objectStore(Xe.objectStoreNames[0])}return Ye(xe[fe])},set:(xe,fe,Xe)=>(xe[fe]=Xe,!0),has:(xe,fe)=>xe instanceof IDBTransaction&&("done"===fe||"store"===fe)||fe in xe};function it(xe){return"function"==typeof xe?function qe(xe){return xe!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Se(){return Oe||(Oe=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(xe)?function(...fe){return xe.apply(je(this),fe),Ye(ee.get(this))}:function(...fe){return Ye(xe.apply(je(this),fe))}:function(fe,...Xe){const It=xe.call(je(this),fe,...Xe);return ce.set(It,fe.sort?fe.sort():[fe]),Ye(It)}}(xe):(xe instanceof IDBTransaction&&function xt(xe){if(J.has(xe))return;const fe=new Promise((Xe,It)=>{const Ct=()=>{xe.removeEventListener("complete",$t),xe.removeEventListener("error",Pt),xe.removeEventListener("abort",Pt)},$t=()=>{Xe(),Ct()},Pt=()=>{It(xe.error||new DOMException("AbortError","AbortError")),Ct()};xe.addEventListener("complete",$t),xe.addEventListener("error",Pt),xe.addEventListener("abort",Pt)});J.set(xe,fe)}(xe),ye(xe,function Me(){return ue||(ue=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(xe,Ce):xe)}function Ye(xe){if(xe instanceof IDBRequest)return function lt(xe){const fe=new Promise((Xe,It)=>{const Ct=()=>{xe.removeEventListener("success",$t),xe.removeEventListener("error",Pt)},$t=()=>{Xe(Ye(xe.result)),Ct()},Pt=()=>{It(xe.error),Ct()};xe.addEventListener("success",$t),xe.addEventListener("error",Pt)});return fe.then(Xe=>{Xe instanceof IDBCursor&&ee.set(Xe,xe)}).catch(()=>{}),Ue.set(fe,xe),fe}(xe);if(tt.has(xe))return tt.get(xe);const fe=it(xe);return fe!==xe&&(tt.set(xe,fe),Ue.set(fe,xe)),fe}const je=xe=>Ue.get(xe),Je=["get","getKey","getAll","getAllKeys","count"],Et=["put","add","delete","clear"],kt=new Map;function cn(xe,fe){var Xe;if(!(xe instanceof IDBDatabase)||fe in xe||"string"!=typeof fe)return;if(kt.get(fe))return kt.get(fe);const It=fe.replace(/FromIndex$/,""),Ct=fe!==It,$t=Et.includes(It);if(!(It in(Ct?IDBIndex:IDBObjectStore).prototype)||!$t&&!Je.includes(It))return;const Pt=function(Mn){return(Xe=Xe||(0,d.Z)(function*(Qe,...Jn){const Lr=this.transaction(Qe,$t?"readwrite":"readonly");let ho=Lr.store;return Ct&&(ho=ho.index(Jn.shift())),(yield Promise.all([ho[It](...Jn),$t&&Lr.done]))[0]})).apply(this,arguments)};return kt.set(fe,Pt),Pt}var Tt,yn,Rt;!function Ke(xe){Ce=xe(Ce)}(xe=>({...xe,get:(fe,Xe,It)=>cn(fe,Xe)||xe.get(fe,Xe,It),has:(fe,Xe)=>!!cn(fe,Xe)||xe.has(fe,Xe)}));class co{constructor(fe){this.container=fe}getPlatformInfoString(){return this.container.getProviders().map(Xe=>{if(function ns(xe){return"VERSION"===xe.getComponent()?.type}(Xe)){const It=Xe.getImmediate();return`${It.library}/${It.version}`}return null}).filter(Xe=>Xe).join(" ")}}const is="@firebase/app",_e=new V.Yd("@firebase/app"),On="[DEFAULT]",Gt={[is]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},zt=new Map,rr=new Map;function ci(xe,fe){try{xe.container.addComponent(fe)}catch(Xe){_e.debug(`Component ${fe.name} failed to register with FirebaseApp ${xe.name}`,Xe)}}function vi(xe,fe){xe.container.addOrOverwriteComponent(fe)}function fr(xe){const fe=xe.name;if(rr.has(fe))return _e.debug(`There were multiple attempts to register component ${fe}.`),!1;rr.set(fe,xe);for(const Xe of zt.values())ci(Xe,xe);return!0}function Wi(xe,fe){const Xe=xe.container.getProvider("heartbeat").getImmediate({optional:!0});return Xe&&Xe.triggerHeartbeat(),xe.container.getProvider(fe)}function ca(xe,fe,Xe=On){Wi(xe,fe).clearInstance(Xe)}function Gn(){rr.clear()}const sn=new he.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class uo{constructor(fe,Xe,It){this._isDeleted=!1,this._options=Object.assign({},fe),this._config=Object.assign({},Xe),this._name=Xe.name,this._automaticDataCollectionEnabled=Xe.automaticDataCollectionEnabled,this._container=It,this.container.addComponent(new Q.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(fe){this.checkDestroyed(),this._automaticDataCollectionEnabled=fe}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(fe){this._isDeleted=fe}checkDestroyed(){if(this.isDeleted)throw sn.create("app-deleted",{appName:this._name})}}const Tn="9.23.0";function Pr(xe,fe={}){let Xe=xe;"object"!=typeof fe&&(fe={name:fe});const It=Object.assign({name:On,automaticDataCollectionEnabled:!1},fe),Ct=It.name;if("string"!=typeof Ct||!Ct)throw sn.create("bad-app-name",{appName:String(Ct)});if(Xe||(Xe=(0,he.aH)()),!Xe)throw sn.create("no-options");const $t=zt.get(Ct);if($t){if((0,he.vZ)(Xe,$t.options)&&(0,he.vZ)(It,$t.config))return $t;throw sn.create("duplicate-app",{appName:Ct})}const Pt=new Q.H0(Ct);for(const Mn of rr.values())Pt.addComponent(Mn);const Rn=new uo(Xe,It,Pt);return zt.set(Ct,Rn),Rn}function Ki(xe=On){const fe=zt.get(xe);if(!fe&&xe===On&&(0,he.aH)())return Pr();if(!fe)throw sn.create("no-app",{appName:xe});return fe}function sr(){return Array.from(zt.values())}function rs(xe){return(Tt=Tt||(0,d.Z)(function*(fe){const Xe=fe.name;zt.has(Xe)&&(zt.delete(Xe),yield Promise.all(fe.container.getProviders().map(It=>It.delete())),fe.isDeleted=!0)})).apply(this,arguments)}function qi(xe,fe,Xe){var It;let Ct=null!==(It=Gt[xe])&&void 0!==It?It:xe;Xe&&(Ct+=`-${Xe}`);const $t=Ct.match(/\s|\//),Pt=fe.match(/\s|\//);if($t||Pt){const Rn=[`Unable to register library "${Ct}" with version "${fe}":`];return $t&&Rn.push(`library name "${Ct}" contains illegal characters (whitespace or "/")`),$t&&Pt&&Rn.push("and"),Pt&&Rn.push(`version name "${fe}" contains illegal characters (whitespace or "/")`),void _e.warn(Rn.join(" "))}fr(new Q.wA(`${Ct}-version`,()=>({library:Ct,version:fe}),"VERSION"))}function Is(xe,fe){if(null!==xe&&"function"!=typeof xe)throw sn.create("invalid-log-argument");(0,V.Am)(xe,fe)}function Cs(xe){(0,V.Ub)(xe)}const ne="firebase-heartbeat-database",Z=1,$="firebase-heartbeat-store";let j=null;function U(){return j||(j=function Ge(xe,fe,{blocked:Xe,upgrade:It,blocking:Ct,terminated:$t}={}){const Pt=indexedDB.open(xe,fe),Rn=Ye(Pt);return It&&Pt.addEventListener("upgradeneeded",Mn=>{It(Ye(Pt.result),Mn.oldVersion,Mn.newVersion,Ye(Pt.transaction),Mn)}),Xe&&Pt.addEventListener("blocked",Mn=>Xe(Mn.oldVersion,Mn.newVersion,Mn)),Rn.then(Mn=>{$t&&Mn.addEventListener("close",()=>$t()),Ct&&Mn.addEventListener("versionchange",Qe=>Ct(Qe.oldVersion,Qe.newVersion,Qe))}).catch(()=>{}),Rn}(ne,Z,{upgrade:(xe,fe)=>{0===fe&&xe.createObjectStore($)}}).catch(xe=>{throw sn.create("idb-open",{originalErrorMessage:xe.message})})),j}function ke(xe,fe){return(Rt=Rt||(0,d.Z)(function*(Xe,It){try{const $t=(yield U()).transaction($,"readwrite");yield $t.objectStore($).put(It,ut(Xe)),yield $t.done}catch(Ct){if(Ct instanceof he.ZR)_e.warn(Ct.message);else{const $t=sn.create("idb-set",{originalErrorMessage:Ct?.message});_e.warn($t.message)}}})).apply(this,arguments)}function ut(xe){return`${xe.name}!${xe.options.appId}`}class hn{constructor(fe){this.container=fe,this._heartbeatsCache=null;const Xe=this.container.getProvider("app").getImmediate();this._storage=new Ln(Xe),this._heartbeatsCachePromise=this._storage.read().then(It=>(this._heartbeatsCache=It,It))}triggerHeartbeat(){var fe=this;return(0,d.Z)(function*(){const It=fe.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),Ct=Ut();if(null===fe._heartbeatsCache&&(fe._heartbeatsCache=yield fe._heartbeatsCachePromise),fe._heartbeatsCache.lastSentHeartbeatDate!==Ct&&!fe._heartbeatsCache.heartbeats.some($t=>$t.date===Ct))return fe._heartbeatsCache.heartbeats.push({date:Ct,agent:It}),fe._heartbeatsCache.heartbeats=fe._heartbeatsCache.heartbeats.filter($t=>{const Pt=new Date($t.date).valueOf();return Date.now()-Pt<=2592e6}),fe._storage.overwrite(fe._heartbeatsCache)})()}getHeartbeatsHeader(){var fe=this;return(0,d.Z)(function*(){if(null===fe._heartbeatsCache&&(yield fe._heartbeatsCachePromise),null===fe._heartbeatsCache||0===fe._heartbeatsCache.heartbeats.length)return"";const Xe=Ut(),{heartbeatsToSend:It,unsentEntries:Ct}=function Yn(xe,fe=1024){const Xe=[];let It=xe.slice();for(const Ct of xe){const $t=Xe.find(Pt=>Pt.agent===Ct.agent);if($t){if($t.dates.push(Ct.date),jr(Xe)>fe){$t.dates.pop();break}}else if(Xe.push({agent:Ct.agent,dates:[Ct.date]}),jr(Xe)>fe){Xe.pop();break}It=It.slice(1)}return{heartbeatsToSend:Xe,unsentEntries:It}}(fe._heartbeatsCache.heartbeats),$t=(0,he.L)(JSON.stringify({version:2,heartbeats:It}));return fe._heartbeatsCache.lastSentHeartbeatDate=Xe,Ct.length>0?(fe._heartbeatsCache.heartbeats=Ct,yield fe._storage.overwrite(fe._heartbeatsCache)):(fe._heartbeatsCache.heartbeats=[],fe._storage.overwrite(fe._heartbeatsCache)),$t})()}}function Ut(){return(new Date).toISOString().substring(0,10)}class Ln{constructor(fe){this.app=fe,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,d.Z)(function*(){return!!(0,he.hl)()&&(0,he.eu)().then(()=>!0).catch(()=>!1)})()}read(){var fe=this;return(0,d.Z)(function*(){return(yield fe._canUseIndexedDBPromise)&&(yield function ie(xe){return(yn=yn||(0,d.Z)(function*(fe){try{return yield(yield U()).transaction($).objectStore($).get(ut(fe))}catch(Xe){if(Xe instanceof he.ZR)_e.warn(Xe.message);else{const It=sn.create("idb-get",{originalErrorMessage:Xe?.message});_e.warn(It.message)}}})).apply(this,arguments)}(fe.app))||{heartbeats:[]}})()}overwrite(fe){var Xe=this;return(0,d.Z)(function*(){var It;if(yield Xe._canUseIndexedDBPromise){const $t=yield Xe.read();return ke(Xe.app,{lastSentHeartbeatDate:null!==(It=fe.lastSentHeartbeatDate)&&void 0!==It?It:$t.lastSentHeartbeatDate,heartbeats:fe.heartbeats})}})()}add(fe){var Xe=this;return(0,d.Z)(function*(){var It;if(yield Xe._canUseIndexedDBPromise){const $t=yield Xe.read();return ke(Xe.app,{lastSentHeartbeatDate:null!==(It=fe.lastSentHeartbeatDate)&&void 0!==It?It:$t.lastSentHeartbeatDate,heartbeats:[...$t.heartbeats,...fe.heartbeats]})}})()}}function jr(xe){return(0,he.L)(JSON.stringify({version:2,heartbeats:xe})).length}!function ss(xe){fr(new Q.wA("platform-logger",fe=>new co(fe),"PRIVATE")),fr(new Q.wA("heartbeat",fe=>new hn(fe),"PRIVATE")),qi(is,"0.9.13",xe),qi(is,"0.9.13","esm2017"),qi("fire-js","")}("")},4859:(Ft,Be,z)=>{z.d(Be,{H0:()=>Me,wA:()=>V});var d=z(5861),Q=z(2090);class V{constructor(ee,J,ce){this.name=ee,this.instanceFactory=J,this.type=ce,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(ee){return this.instantiationMode=ee,this}setMultipleInstances(ee){return this.multipleInstances=ee,this}setServiceProps(ee){return this.serviceProps=ee,this}setInstanceCreatedCallback(ee){return this.onInstanceCreated=ee,this}}const he="[DEFAULT]";class ye{constructor(ee,J){this.name=ee,this.container=J,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(ee){const J=this.normalizeInstanceIdentifier(ee);if(!this.instancesDeferred.has(J)){const ce=new Q.BH;if(this.instancesDeferred.set(J,ce),this.isInitialized(J)||this.shouldAutoInitialize())try{const tt=this.getOrInitializeService({instanceIdentifier:J});tt&&ce.resolve(tt)}catch{}}return this.instancesDeferred.get(J).promise}getImmediate(ee){var J;const ce=this.normalizeInstanceIdentifier(ee?.identifier),tt=null!==(J=ee?.optional)&&void 0!==J&&J;if(!this.isInitialized(ce)&&!this.shouldAutoInitialize()){if(tt)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:ce})}catch(Ue){if(tt)return null;throw Ue}}getComponent(){return this.component}setComponent(ee){if(ee.name!==this.name)throw Error(`Mismatching Component ${ee.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=ee,this.shouldAutoInitialize()){if(function Oe(Se){return"EAGER"===Se.instantiationMode}(ee))try{this.getOrInitializeService({instanceIdentifier:he})}catch{}for(const[J,ce]of this.instancesDeferred.entries()){const tt=this.normalizeInstanceIdentifier(J);try{const Ue=this.getOrInitializeService({instanceIdentifier:tt});ce.resolve(Ue)}catch{}}}}clearInstance(ee=he){this.instancesDeferred.delete(ee),this.instancesOptions.delete(ee),this.instances.delete(ee)}delete(){var ee=this;return(0,d.Z)(function*(){const J=Array.from(ee.instances.values());yield Promise.all([...J.filter(ce=>"INTERNAL"in ce).map(ce=>ce.INTERNAL.delete()),...J.filter(ce=>"_delete"in ce).map(ce=>ce._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(ee=he){return this.instances.has(ee)}getOptions(ee=he){return this.instancesOptions.get(ee)||{}}initialize(ee={}){const{options:J={}}=ee,ce=this.normalizeInstanceIdentifier(ee.instanceIdentifier);if(this.isInitialized(ce))throw Error(`${this.name}(${ce}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const tt=this.getOrInitializeService({instanceIdentifier:ce,options:J});for(const[Ue,lt]of this.instancesDeferred.entries())ce===this.normalizeInstanceIdentifier(Ue)&&lt.resolve(tt);return tt}onInit(ee,J){var ce;const tt=this.normalizeInstanceIdentifier(J),Ue=null!==(ce=this.onInitCallbacks.get(tt))&&void 0!==ce?ce:new Set;Ue.add(ee),this.onInitCallbacks.set(tt,Ue);const lt=this.instances.get(tt);return lt&&ee(lt,tt),()=>{Ue.delete(ee)}}invokeOnInitCallbacks(ee,J){const ce=this.onInitCallbacks.get(J);if(ce)for(const tt of ce)try{tt(ee,J)}catch{}}getOrInitializeService({instanceIdentifier:ee,options:J={}}){let ce=this.instances.get(ee);if(!ce&&this.component&&(ce=this.component.instanceFactory(this.container,{instanceIdentifier:(Se=ee,Se===he?void 0:Se),options:J}),this.instances.set(ee,ce),this.instancesOptions.set(ee,J),this.invokeOnInitCallbacks(ce,ee),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,ee,ce)}catch{}var Se;return ce||null}normalizeInstanceIdentifier(ee=he){return this.component?this.component.multipleInstances?ee:he:ee}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Me{constructor(ee){this.name=ee,this.providers=new Map}addComponent(ee){const J=this.getProvider(ee.name);if(J.isComponentSet())throw new Error(`Component ${ee.name} has already been registered with ${this.name}`);J.setComponent(ee)}addOrOverwriteComponent(ee){this.getProvider(ee.name).isComponentSet()&&this.providers.delete(ee.name),this.addComponent(ee)}getProvider(ee){if(this.providers.has(ee))return this.providers.get(ee);const J=new ye(ee,this);return this.providers.set(ee,J),J}getProviders(){return Array.from(this.providers.values())}}},1877:(Ft,Be,z)=>{z.d(Be,{Am:()=>Se,Ub:()=>Me,Yd:()=>Oe,in:()=>Q});const d=[];var Q=(()=>{return(ee=Q||(Q={}))[ee.DEBUG=0]="DEBUG",ee[ee.VERBOSE=1]="VERBOSE",ee[ee.INFO=2]="INFO",ee[ee.WARN=3]="WARN",ee[ee.ERROR=4]="ERROR",ee[ee.SILENT=5]="SILENT",Q;var ee})();const V={debug:Q.DEBUG,verbose:Q.VERBOSE,info:Q.INFO,warn:Q.WARN,error:Q.ERROR,silent:Q.SILENT},he=Q.INFO,ye={[Q.DEBUG]:"log",[Q.VERBOSE]:"log",[Q.INFO]:"info",[Q.WARN]:"warn",[Q.ERROR]:"error"},ue=(ee,J,...ce)=>{if(J<ee.logLevel)return;const tt=(new Date).toISOString(),Ue=ye[J];if(!Ue)throw new Error(`Attempted to log a message with an invalid logType (value: ${J})`);console[Ue](`[${tt}]  ${ee.name}:`,...ce)};class Oe{constructor(J){this.name=J,this._logLevel=he,this._logHandler=ue,this._userLogHandler=null,d.push(this)}get logLevel(){return this._logLevel}set logLevel(J){if(!(J in Q))throw new TypeError(`Invalid value "${J}" assigned to \`logLevel\``);this._logLevel=J}setLogLevel(J){this._logLevel="string"==typeof J?V[J]:J}get logHandler(){return this._logHandler}set logHandler(J){if("function"!=typeof J)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=J}get userLogHandler(){return this._userLogHandler}set userLogHandler(J){this._userLogHandler=J}debug(...J){this._userLogHandler&&this._userLogHandler(this,Q.DEBUG,...J),this._logHandler(this,Q.DEBUG,...J)}log(...J){this._userLogHandler&&this._userLogHandler(this,Q.VERBOSE,...J),this._logHandler(this,Q.VERBOSE,...J)}info(...J){this._userLogHandler&&this._userLogHandler(this,Q.INFO,...J),this._logHandler(this,Q.INFO,...J)}warn(...J){this._userLogHandler&&this._userLogHandler(this,Q.WARN,...J),this._logHandler(this,Q.WARN,...J)}error(...J){this._userLogHandler&&this._userLogHandler(this,Q.ERROR,...J),this._logHandler(this,Q.ERROR,...J)}}function Me(ee){d.forEach(J=>{J.setLogLevel(ee)})}function Se(ee,J){for(const ce of d){let tt=null;J&&J.level&&(tt=V[J.level]),ce.userLogHandler=null===ee?null:(Ue,lt,...xt)=>{const Ce=xt.map(Ke=>{if(null==Ke)return null;if("string"==typeof Ke)return Ke;if("number"==typeof Ke||"boolean"==typeof Ke)return Ke.toString();if(Ke instanceof Error)return Ke.message;try{return JSON.stringify(Ke)}catch{return null}}).filter(Ke=>Ke).join(" ");lt>=(tt??Ue.logLevel)&&ee({level:Q[lt].toLowerCase(),message:Ce,args:xt,type:Ue.name})}}}},259:(Ft,Be,z)=>{z.d(Be,{C6:()=>d.getApps,KN:()=>d.registerVersion,Mq:()=>d.getApp,ZF:()=>d.initializeApp});var d=z(6881);(0,d.registerVersion)("firebase","9.23.0","app")},9260:(Ft,Be,z)=>{z.d(Be,{Z:()=>d.Z});var d=z(3942);d.Z.registerVersion("firebase","9.23.0","app-compat")},9568:(Ft,Be,z)=>{z.r(Be);var Me,Se,ee,J,ce,d=z(5861),Q=z(3942),V=z(1389),he=z(2090),Oe=(z(6881),z(1877),z(4859));function tt(){return window}const Ue=2e3;const je=20;class Ge extends V.aB{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(j=>{this.resolveInialized=j})}addPassiveListener(j){this.passiveListeners.add(j)}removePassiveListener(j){this.passiveListeners.delete(j)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(j){return this.resolveInialized(),this.passiveListeners.forEach(U=>U(j)),super.onEvent(j)}initialized(){var j=this;return(0,d.Z)(function*(){yield j.initPromise})()}}function Et($){return(ce=ce||(0,d.Z)(function*(j){const U=yield Tt()._get(yn(j));return U&&(yield Tt()._remove(yn(j))),U})).apply(this,arguments)}function cn(){const $=[],j="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let U=0;U<je;U++){const ie=Math.floor(Math.random()*j.length);$.push(j.charAt(ie))}return $.join("")}function Tt(){return(0,V.aC)(V.b)}function yn($){return(0,V.aD)("authEvent",$.config.apiKey,$.name)}function ns($){if(!$?.includes("?"))return{};const[j,...U]=$.split("?");return(0,he.zd)(U.join("?"))}const _e=class zs{constructor(){this._redirectPersistence=V.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=V.aE,this._overrideRedirectResult=V.aF}_initialize(j){var U=this;return(0,d.Z)(function*(){const ie=j._key();let ke=U.eventManagers.get(ie);return ke||(ke=new Ge(j),U.eventManagers.set(ie,ke),U.attachCallbackListeners(j,ke)),ke})()}_openPopup(j){(0,V.av)(j,"operation-not-supported-in-this-environment")}_openRedirect(j,U,ie,ke){var ut=this;return(0,d.Z)(function*(){!function qe($){var j,U,ie,ke,ut,tn,Zt,hn,Ut,Yn;const Ln=tt();(0,V.aA)("function"==typeof(null===(j=Ln?.universalLinks)||void 0===j?void 0:j.subscribe),$,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,V.aA)(typeof(null===(U=Ln?.BuildInfo)||void 0===U?void 0:U.packageName)<"u",$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,V.aA)("function"==typeof(null===(ut=null===(ke=null===(ie=Ln?.cordova)||void 0===ie?void 0:ie.plugins)||void 0===ke?void 0:ke.browsertab)||void 0===ut?void 0:ut.openUrl),$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,V.aA)("function"==typeof(null===(hn=null===(Zt=null===(tn=Ln?.cordova)||void 0===tn?void 0:tn.plugins)||void 0===Zt?void 0:Zt.browsertab)||void 0===hn?void 0:hn.isAvailable),$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,V.aA)("function"==typeof(null===(Yn=null===(Ut=Ln?.cordova)||void 0===Ut?void 0:Ut.InAppBrowser)||void 0===Yn?void 0:Yn.open),$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(j);const tn=yield ut._initialize(j);yield tn.initialized(),tn.resetRedirect(),(0,V.aG)(),yield ut._originValidation(j);const Zt=function at($,j,U=null){return{type:j,eventId:U,urlResponse:null,sessionId:cn(),postBody:null,tenantId:$.tenantId,error:(0,V.az)($,"no-auth-event")}}(j,ie,ke);yield function Je($,j){return Tt()._set(yn($),j)}(j,Zt);const hn=yield function lt($,j,U){return(Me=Me||(0,d.Z)(function*(ie,ke,ut){var tn;const{BuildInfo:Zt}=tt();(0,V.as)(ke.sessionId,"AuthEvent did not contain a session ID");const hn=yield function it($){return(J=J||(0,d.Z)(function*(j){const U=function Ye($){if((0,V.as)(/[0-9a-zA-Z]+/.test($),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode($);const j=new ArrayBuffer($.length),U=new Uint8Array(j);for(let ie=0;ie<$.length;ie++)U[ie]=$.charCodeAt(ie);return U}(j),ie=yield crypto.subtle.digest("SHA-256",U);return Array.from(new Uint8Array(ie)).map(ut=>ut.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}(ke.sessionId),Ut={};return(0,V.at)()?Ut.ibi=Zt.packageName:(0,V.au)()?Ut.apn=Zt.packageName:(0,V.av)(ie,"operation-not-supported-in-this-environment"),Zt.displayName&&(Ut.appDisplayName=Zt.displayName),Ut.sessionId=hn,(0,V.aw)(ie,ut,ke.type,void 0,null!==(tn=ke.eventId)&&void 0!==tn?tn:void 0,Ut)})).apply(this,arguments)}(j,Zt,U),Ut=yield function Ce($){const{cordova:j}=tt();return new Promise(U=>{j.plugins.browsertab.isAvailable(ie=>{let ke=null;ie?j.plugins.browsertab.openUrl($):ke=j.InAppBrowser.open($,(0,V.ay)()?"_blank":"_system","location=yes"),U(ke)})})}(hn);return function Ke($,j,U){return(ee=ee||(0,d.Z)(function*(ie,ke,ut){const{cordova:tn}=tt();let Zt=()=>{};try{yield new Promise((hn,Ut)=>{let Yn=null;function Ln(){var xe;hn();const fe=null===(xe=tn.plugins.browsertab)||void 0===xe?void 0:xe.close;"function"==typeof fe&&fe(),"function"==typeof ut?.close&&ut.close()}function jr(){Yn||(Yn=window.setTimeout(()=>{Ut((0,V.az)(ie,"redirect-cancelled-by-user"))},Ue))}function ss(){"visible"===document?.visibilityState&&jr()}ke.addPassiveListener(Ln),document.addEventListener("resume",jr,!1),(0,V.au)()&&document.addEventListener("visibilitychange",ss,!1),Zt=()=>{ke.removePassiveListener(Ln),document.removeEventListener("resume",jr,!1),document.removeEventListener("visibilitychange",ss,!1),Yn&&window.clearTimeout(Yn)}})}finally{Zt()}})).apply(this,arguments)}(j,tn,Ut)})()}_isIframeWebStorageSupported(j,U){throw new Error("Method not implemented.")}_originValidation(j){const U=j._key();return this.originValidationPromises[U]||(this.originValidationPromises[U]=function xt($){return(Se=Se||(0,d.Z)(function*(j){const{BuildInfo:U}=tt(),ie={};(0,V.at)()?ie.iosBundleId=U.packageName:(0,V.au)()?ie.androidPackageName=U.packageName:(0,V.av)(j,"operation-not-supported-in-this-environment"),yield(0,V.ax)(j,ie)})).apply(this,arguments)}(j)),this.originValidationPromises[U]}attachCallbackListeners(j,U){var ie,ke;const{universalLinks:ut,handleOpenURL:tn,BuildInfo:Zt}=tt(),hn=setTimeout((0,d.Z)(function*(){yield Et(j),U.onEvent(Ee())}),500),Ut=function(ss){return(ie=ie||(0,d.Z)(function*(xe){clearTimeout(hn);const fe=yield Et(j);let Xe=null;fe&&xe?.url&&(Xe=function kt($,j){var U,ie;const ke=function co($){const j=ns($),U=j.link?decodeURIComponent(j.link):void 0,ie=ns(U).link,ke=j.deep_link_id?decodeURIComponent(j.deep_link_id):void 0;return ns(ke).link||ke||ie||U||$}(j);if(ke.includes("/__/auth/callback")){const ut=ns(ke),tn=ut.firebaseError?function Rt($){try{return JSON.parse($)}catch{return null}}(decodeURIComponent(ut.firebaseError)):null,Zt=null===(ie=null===(U=tn?.code)||void 0===U?void 0:U.split("auth/"))||void 0===ie?void 0:ie[1],hn=Zt?(0,V.az)(Zt):null;return hn?{type:$.type,eventId:$.eventId,tenantId:$.tenantId,error:hn,urlResponse:null,sessionId:null,postBody:null}:{type:$.type,eventId:$.eventId,tenantId:$.tenantId,sessionId:$.sessionId,urlResponse:ke,postBody:null}}return null}(fe,xe.url)),U.onEvent(Xe||Ee())})).apply(this,arguments)};typeof ut<"u"&&"function"==typeof ut.subscribe&&ut.subscribe(null,Ut);const Yn=tn,Ln=`${Zt.packageName.toLowerCase()}://`;tt().handleOpenURL=function(jr){return(ke=ke||(0,d.Z)(function*(ss){if(ss.toLowerCase().startsWith(Ln)&&Ut({url:ss}),"function"==typeof Yn)try{Yn(ss)}catch(xe){console.error(xe)}})).apply(this,arguments)}}};function Ee(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,V.az)("no-auth-event")}}var pe,rt,Ze;const li=1e3;function Vt(){var $;return(null===($=self?.location)||void 0===$?void 0:$.protocol)||null}function si($=(0,he.z$)()){return!("file:"!==Vt()&&"ionic:"!==Vt()&&"capacitor:"!==Vt()||!$.toLowerCase().match(/iphone|ipad|ipod|android/))}function Mi(){try{const $=self.localStorage,j=V.aL();if($)return $.setItem(j,"1"),$.removeItem(j),!function pi($=(0,he.z$)()){return function ki(){return(0,he.w1)()&&11===document?.documentMode}()||function Ri($=(0,he.z$)()){return/Edge\/\d+/.test($)}($)}()||(0,he.hl)()}catch{return ir()&&(0,he.hl)()}return!1}function ir(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function yi(){return(function Sn(){return"http:"===Vt()||"https:"===Vt()}()||(0,he.ru)()||si())&&!function jn(){return(0,he.b$)()||(0,he.UG)()}()&&Mi()&&!ir()}function Bt(){return si()&&typeof document<"u"}const Nn={LOCAL:"local",NONE:"none",SESSION:"session"},Hr=V.aA,Ti="persistence";function On($){return(rt=rt||(0,d.Z)(function*(j){yield j._initializationPromise;const U=zt(),ie=V.aD(Ti,j.config.apiKey,j.name);U&&U.setItem(ie,j._getPersistence())})).apply(this,arguments)}function zt(){var $;try{return(null===($=function la(){return typeof window<"u"?window:null}())||void 0===$?void 0:$.sessionStorage)||null}catch{return null}}const rr=V.aA;class ci{constructor(){this.browserResolver=V.aC(V.k),this.cordovaResolver=V.aC(_e),this.underlyingResolver=null,this._redirectPersistence=V.a,this._completeRedirectFn=V.aE,this._overrideRedirectResult=V.aF}_initialize(j){var U=this;return(0,d.Z)(function*(){return yield U.selectUnderlyingResolver(),U.assertedUnderlyingResolver._initialize(j)})()}_openPopup(j,U,ie,ke){var ut=this;return(0,d.Z)(function*(){return yield ut.selectUnderlyingResolver(),ut.assertedUnderlyingResolver._openPopup(j,U,ie,ke)})()}_openRedirect(j,U,ie,ke){var ut=this;return(0,d.Z)(function*(){return yield ut.selectUnderlyingResolver(),ut.assertedUnderlyingResolver._openRedirect(j,U,ie,ke)})()}_isIframeWebStorageSupported(j,U){this.assertedUnderlyingResolver._isIframeWebStorageSupported(j,U)}_originValidation(j){return this.assertedUnderlyingResolver._originValidation(j)}get _shouldInitProactively(){return Bt()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return rr(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var j=this;return(0,d.Z)(function*(){if(j.underlyingResolver)return;const U=yield function Ts(){return(pe=pe||(0,d.Z)(function*(){return!!Bt()&&new Promise($=>{const j=setTimeout(()=>{$(!1)},li);document.addEventListener("deviceready",()=>{clearTimeout(j),$(!0)})})})).apply(this,arguments)}();j.underlyingResolver=U?j.cordovaResolver:j.browserResolver})()}}function vi($){return $.unwrap()}function Wi($){return Gn($)}function Gn($){const{_tokenResponse:j}=$ instanceof he.ZR?$.customData:$;if(!j)return null;if(!($ instanceof he.ZR)&&"temporaryProof"in j&&"phoneNumber"in j)return V.P.credentialFromResult($);const U=j.providerId;if(!U||U===V.p.PASSWORD)return null;let ie;switch(U){case V.p.GOOGLE:ie=V.V;break;case V.p.FACEBOOK:ie=V.U;break;case V.p.GITHUB:ie=V.W;break;case V.p.TWITTER:ie=V.Z;break;default:const{oauthIdToken:ke,oauthAccessToken:ut,oauthTokenSecret:tn,pendingToken:Zt,nonce:hn}=j;return ut||tn||ke||Zt?Zt?U.startsWith("saml.")?V.aO._create(U,Zt):V.L._fromParams({providerId:U,signInMethod:U,pendingToken:Zt,idToken:ke,accessToken:ut}):new V.X(U).credential({idToken:ke,accessToken:ut,rawNonce:hn}):null}return $ instanceof he.ZR?ie.credentialFromError($):ie.credentialFromResult($)}function ui($,j){return j.catch(U=>{throw U instanceof he.ZR&&function ca($,j){var U;const ie=null===(U=j.customData)||void 0===U?void 0:U._tokenResponse;if("auth/multi-factor-auth-required"===j?.code)j.resolver=new uo($,V.aq($,j));else if(ie){const ke=Gn(j),ut=j;ke&&(ut.credential=ke,ut.tenantId=ie.tenantId||void 0,ut.email=ie.email||void 0,ut.phoneNumber=ie.phoneNumber||void 0)}}($,U),U}).then(U=>{const ke=U.user;return{operationType:U.operationType,credential:Wi(U),additionalUserInfo:V.ao(U),user:Tn.getOrCreate(ke)}})}function sn($,j){return(Ze=Ze||(0,d.Z)(function*(U,ie){const ke=yield ie;return{verificationId:ke.verificationId,confirm:ut=>ui(U,ke.confirm(ut))}})).apply(this,arguments)}class uo{constructor(j,U){this.resolver=U,this.auth=function fr($){return $.wrapped()}(j)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(j){return ui(vi(this.auth),this.resolver.resolveSignIn(j))}}class Tn{constructor(j){this._delegate=j,this.multiFactor=V.ar(j)}static getOrCreate(j){return Tn.USER_MAP.has(j)||Tn.USER_MAP.set(j,new Tn(j)),Tn.USER_MAP.get(j)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(j){return this._delegate.getIdTokenResult(j)}getIdToken(j){return this._delegate.getIdToken(j)}linkAndRetrieveDataWithCredential(j){return this.linkWithCredential(j)}linkWithCredential(j){var U=this;return(0,d.Z)(function*(){return ui(U.auth,V.a0(U._delegate,j))})()}linkWithPhoneNumber(j,U){var ie=this;return(0,d.Z)(function*(){return sn(ie.auth,V.l(ie._delegate,j,U))})()}linkWithPopup(j){var U=this;return(0,d.Z)(function*(){return ui(U.auth,V.d(U._delegate,j,ci))})()}linkWithRedirect(j){var U=this;return(0,d.Z)(function*(){return yield On(V.aH(U.auth)),V.g(U._delegate,j,ci)})()}reauthenticateAndRetrieveDataWithCredential(j){return this.reauthenticateWithCredential(j)}reauthenticateWithCredential(j){var U=this;return(0,d.Z)(function*(){return ui(U.auth,V.a1(U._delegate,j))})()}reauthenticateWithPhoneNumber(j,U){return sn(this.auth,V.r(this._delegate,j,U))}reauthenticateWithPopup(j){return ui(this.auth,V.e(this._delegate,j,ci))}reauthenticateWithRedirect(j){var U=this;return(0,d.Z)(function*(){return yield On(V.aH(U.auth)),V.h(U._delegate,j,ci)})()}sendEmailVerification(j){return V.ae(this._delegate,j)}unlink(j){var U=this;return(0,d.Z)(function*(){return yield V.an(U._delegate,j),U})()}updateEmail(j){return V.aj(this._delegate,j)}updatePassword(j){return V.ak(this._delegate,j)}updatePhoneNumber(j){return V.u(this._delegate,j)}updateProfile(j){return V.ai(this._delegate,j)}verifyBeforeUpdateEmail(j,U){return V.af(this._delegate,j,U)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Tn.USER_MAP=new WeakMap;const Pr=V.aA;let Ki=(()=>{class ${constructor(U,ie){if(this.app=U,ie.isInitialized())return this._delegate=ie.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:ke}=U.options;Pr(ke,"invalid-api-key",{appName:U.name}),Pr(ke,"invalid-api-key",{appName:U.name});const ut=typeof window<"u"?ci:void 0;this._delegate=ie.initialize({options:{persistence:rs(ke,U.name),popupRedirectResolver:ut}}),this._delegate._updateErrorMap(V.D),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Tn.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(U){this._delegate.languageCode=U}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(U){this._delegate.tenantId=U}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(U,ie){V.I(this._delegate,U,ie)}applyActionCode(U){return V.a5(this._delegate,U)}checkActionCode(U){return V.a6(this._delegate,U)}confirmPasswordReset(U,ie){return V.a4(this._delegate,U,ie)}createUserWithEmailAndPassword(U,ie){var ke=this;return(0,d.Z)(function*(){return ui(ke._delegate,V.a8(ke._delegate,U,ie))})()}fetchProvidersForEmail(U){return this.fetchSignInMethodsForEmail(U)}fetchSignInMethodsForEmail(U){return V.ad(this._delegate,U)}isSignInWithEmailLink(U){return V.ab(this._delegate,U)}getRedirectResult(){var U=this;return(0,d.Z)(function*(){Pr(yi(),U._delegate,"operation-not-supported-in-this-environment");const ie=yield V.j(U._delegate,ci);return ie?ui(U._delegate,Promise.resolve(ie)):{credential:null,user:null}})()}addFrameworkForLogging(U){!function Te($,j){(0,V.aH)($)._logFramework(j)}(this._delegate,U)}onAuthStateChanged(U,ie,ke){const{next:ut,error:tn,complete:Zt}=sr(U,ie,ke);return this._delegate.onAuthStateChanged(ut,tn,Zt)}onIdTokenChanged(U,ie,ke){const{next:ut,error:tn,complete:Zt}=sr(U,ie,ke);return this._delegate.onIdTokenChanged(ut,tn,Zt)}sendSignInLinkToEmail(U,ie){return V.aa(this._delegate,U,ie)}sendPasswordResetEmail(U,ie){return V.a3(this._delegate,U,ie||void 0)}setPersistence(U){var ie=this;return(0,d.Z)(function*(){let ke;switch(function ni($,j){Hr(Object.values(Nn).includes(j),$,"invalid-persistence-type"),(0,he.b$)()?Hr(j!==Nn.SESSION,$,"unsupported-persistence-type"):(0,he.UG)()?Hr(j===Nn.NONE,$,"unsupported-persistence-type"):ir()?Hr(j===Nn.NONE||j===Nn.LOCAL&&(0,he.hl)(),$,"unsupported-persistence-type"):Hr(j===Nn.NONE||Mi(),$,"unsupported-persistence-type")}(ie._delegate,U),U){case Nn.SESSION:ke=V.a;break;case Nn.LOCAL:ke=(yield V.aC(V.i)._isAvailable())?V.i:V.b;break;case Nn.NONE:ke=V.N;break;default:return V.av("argument-error",{appName:ie._delegate.name})}return ie._delegate.setPersistence(ke)})()}signInAndRetrieveDataWithCredential(U){return this.signInWithCredential(U)}signInAnonymously(){return ui(this._delegate,V._(this._delegate))}signInWithCredential(U){return ui(this._delegate,V.$(this._delegate,U))}signInWithCustomToken(U){return ui(this._delegate,V.a2(this._delegate,U))}signInWithEmailAndPassword(U,ie){return ui(this._delegate,V.a9(this._delegate,U,ie))}signInWithEmailLink(U,ie){return ui(this._delegate,V.ac(this._delegate,U,ie))}signInWithPhoneNumber(U,ie){return sn(this._delegate,V.s(this._delegate,U,ie))}signInWithPopup(U){var ie=this;return(0,d.Z)(function*(){return Pr(yi(),ie._delegate,"operation-not-supported-in-this-environment"),ui(ie._delegate,V.c(ie._delegate,U,ci))})()}signInWithRedirect(U){var ie=this;return(0,d.Z)(function*(){return Pr(yi(),ie._delegate,"operation-not-supported-in-this-environment"),yield On(ie._delegate),V.f(ie._delegate,U,ci)})()}updateCurrentUser(U){return this._delegate.updateCurrentUser(U)}verifyPasswordResetCode(U){return V.a7(this._delegate,U)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return $.Persistence=Nn,$})();function sr($,j,U){let ie=$;"function"!=typeof $&&({next:ie,error:j,complete:U}=$);const ke=ie;return{next:tn=>ke(tn&&Tn.getOrCreate(tn)),error:j,complete:U}}function rs($,j){const U=function Gt($,j){const U=zt();if(!U)return[];const ie=V.aD(Ti,$,j);switch(U.getItem(ie)){case Nn.NONE:return[V.N];case Nn.LOCAL:return[V.i,V.a];case Nn.SESSION:return[V.a];default:return[]}}($,j);if(typeof self<"u"&&!U.includes(V.i)&&U.push(V.i),typeof window<"u")for(const ie of[V.b,V.a])U.includes(ie)||U.push(ie);return U.includes(V.N)||U.push(V.N),U}class qi{constructor(){this.providerId="phone",this._delegate=new V.P(vi(Q.Z.auth()))}static credential(j,U){return V.P.credential(j,U)}verifyPhoneNumber(j,U){return this._delegate.verifyPhoneNumber(j,U)}unwrap(){return this._delegate}}qi.PHONE_SIGN_IN_METHOD=V.P.PHONE_SIGN_IN_METHOD,qi.PROVIDER_ID=V.P.PROVIDER_ID;const Is=V.aA;class Cs{constructor(j,U,ie=Q.Z.app()){var ke;Is(null===(ke=ie.options)||void 0===ke?void 0:ke.apiKey,"invalid-api-key",{appName:ie.name}),this._delegate=new V.R(j,U,ie.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function Z($){$.INTERNAL.registerComponent(new Oe.wA("auth-compat",j=>{const U=j.getProvider("app-compat").getImmediate(),ie=j.getProvider("auth");return new Ki(U,ie)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:V.A.EMAIL_SIGNIN,PASSWORD_RESET:V.A.PASSWORD_RESET,RECOVER_EMAIL:V.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:V.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:V.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:V.A.VERIFY_EMAIL}},EmailAuthProvider:V.Q,FacebookAuthProvider:V.U,GithubAuthProvider:V.W,GoogleAuthProvider:V.V,OAuthProvider:V.X,SAMLAuthProvider:V.Y,PhoneAuthProvider:qi,PhoneMultiFactorGenerator:V.m,RecaptchaVerifier:Cs,TwitterAuthProvider:V.Z,Auth:Ki,AuthCredential:V.J,Error:he.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),$.registerVersion("@firebase/auth-compat","0.4.2")}(Q.Z)},5861:(Ft,Be,z)=>{function d(V,he,ye,ue,Oe,Me,Se){try{var ee=V[Me](Se),J=ee.value}catch(ce){return void ye(ce)}ee.done?he(J):Promise.resolve(J).then(ue,Oe)}function Q(V){return function(){var he=this,ye=arguments;return new Promise(function(ue,Oe){var Me=V.apply(he,ye);function Se(J){d(Me,ue,Oe,Se,ee,"next",J)}function ee(J){d(Me,ue,Oe,Se,ee,"throw",J)}Se(void 0)})}}z.d(Be,{Z:()=>Q})},7582:(Ft,Be,z)=>{function he(_e,Ee){var Te={};for(var pe in _e)Object.prototype.hasOwnProperty.call(_e,pe)&&Ee.indexOf(pe)<0&&(Te[pe]=_e[pe]);if(null!=_e&&"function"==typeof Object.getOwnPropertySymbols){var rt=0;for(pe=Object.getOwnPropertySymbols(_e);rt<pe.length;rt++)Ee.indexOf(pe[rt])<0&&Object.prototype.propertyIsEnumerable.call(_e,pe[rt])&&(Te[pe[rt]]=_e[pe[rt]])}return Te}function ce(_e,Ee,Te,pe){return new(Te||(Te=Promise))(function(Ze,jt){function At(Sn){try{Vt(pe.next(Sn))}catch(si){jt(si)}}function li(Sn){try{Vt(pe.throw(Sn))}catch(si){jt(si)}}function Vt(Sn){Sn.done?Ze(Sn.value):function rt(Ze){return Ze instanceof Te?Ze:new Te(function(jt){jt(Ze)})}(Sn.value).then(At,li)}Vt((pe=pe.apply(_e,Ee||[])).next())})}function Ye(_e){return this instanceof Ye?(this.v=_e,this):new Ye(_e)}function je(_e,Ee,Te){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var rt,pe=Te.apply(_e,Ee||[]),Ze=[];return rt={},jt("next"),jt("throw"),jt("return"),rt[Symbol.asyncIterator]=function(){return this},rt;function jt(jn){pe[jn]&&(rt[jn]=function(ki){return new Promise(function(Ri,pi){Ze.push([jn,ki,Ri,pi])>1||At(jn,ki)})})}function At(jn,ki){try{!function li(jn){jn.value instanceof Ye?Promise.resolve(jn.value.v).then(Vt,Sn):si(Ze[0][2],jn)}(pe[jn](ki))}catch(Ri){si(Ze[0][3],Ri)}}function Vt(jn){At("next",jn)}function Sn(jn){At("throw",jn)}function si(jn,ki){jn(ki),Ze.shift(),Ze.length&&At(Ze[0][0],Ze[0][1])}}function at(_e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Te,Ee=_e[Symbol.asyncIterator];return Ee?Ee.call(_e):(_e=function xt(_e){var Ee="function"==typeof Symbol&&Symbol.iterator,Te=Ee&&_e[Ee],pe=0;if(Te)return Te.call(_e);if(_e&&"number"==typeof _e.length)return{next:function(){return _e&&pe>=_e.length&&(_e=void 0),{value:_e&&_e[pe++],done:!_e}}};throw new TypeError(Ee?"Object is not iterable.":"Symbol.iterator is not defined.")}(_e),Te={},pe("next"),pe("throw"),pe("return"),Te[Symbol.asyncIterator]=function(){return this},Te);function pe(Ze){Te[Ze]=_e[Ze]&&function(jt){return new Promise(function(At,li){!function rt(Ze,jt,At,li){Promise.resolve(li).then(function(Vt){Ze({value:Vt,done:At})},jt)}(At,li,(jt=_e[Ze](jt)).done,jt.value)})}}}z.d(Be,{FC:()=>je,KL:()=>at,_T:()=>he,mG:()=>ce,qq:()=>Ye}),"function"==typeof SuppressedError&&SuppressedError}},Ft=>{Ft(Ft.s=6413)}]);